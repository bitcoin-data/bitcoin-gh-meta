{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "While testing external signers in `22.0rc2`, I noticed that I can create many watch only wallets with the external signer option, each with a different name, but they will all be tied to the same external signer. Not sure if this should be a bug, but it is definitely unexpected and leads to misleading information in the GUI/RPC commands. At the very least, perhaps all that's needed is better documentation on how external signers work with Bitcoin Core to avoid confusion, which I'd be happy to write.\r\n\r\n**Expected behavior**\r\n\r\nIf createwallet allows me to create 3 different wallets with different names, I expect them to be different wallets:\r\n\r\n```bash\r\n./src/bitcoin-cli -datadir=$DATA_DIR -signet listwallets\r\n[\r\n  \"trezor_1\",\r\n  \"trezor_2\",\r\n  \"trezor_3\"\r\n]\r\n```\r\n\r\nIf a wallet has already been created with the existing external signer, I would expect new wallet creation to fail, even if the wallet name is different, or create a new wallet on the same external signer but be under a different account (derviation path)\r\n\r\n**Actual behavior\r\n\r\nThe three wallets above are all attached to the same external signer and account, even tho they are shown as separate wallets in the cli and the gui.\r\n\r\n```bash\r\n./src/bitcoin-cli -datadir=$DATA_DIR -signet -rpcwallet=trezor_1 getwalletinfo\r\n{\r\n  \"walletname\": \"trezor_1\",\r\n  \"walletversion\": 169900,\r\n  \"format\": \"sqlite\",\r\n  \"balance\": 0.01799890,\r\n  \"unconfirmed_balance\": 0.00000000,\r\n  \"immature_balance\": 0.00000000,\r\n  \"txcount\": 7,\r\n  \"keypoolsize\": 3000,\r\n  \"keypoolsize_hd_internal\": 3000,\r\n  \"paytxfee\": 0.00000000,\r\n  \"private_keys_enabled\": false,\r\n  \"avoid_reuse\": true,\r\n  \"scanning\": false,\r\n  \"descriptors\": true\r\n}\r\n```\r\n\r\nand\r\n\r\n```bash\r\n./src/bitcoin-cli -datadir=$DATA_DIR -signet -rpcwallet=trezor_2 getwalletinfo\r\n{\r\n  \"walletname\": \"trezor_2\",\r\n  \"walletversion\": 169900,\r\n  \"format\": \"sqlite\",\r\n  \"balance\": 0.01799890,\r\n  \"unconfirmed_balance\": 0.00000000,\r\n  \"immature_balance\": 0.00000000,\r\n  \"txcount\": 7,\r\n  \"keypoolsize\": 3000,\r\n  \"keypoolsize_hd_internal\": 3000,\r\n  \"paytxfee\": 0.00000000,\r\n  \"private_keys_enabled\": false,\r\n  \"avoid_reuse\": true,\r\n  \"scanning\": false,\r\n  \"descriptors\": true\r\n}\r\n```\r\n\r\n**To reproduce**\r\n\r\n1. Setup HW wallet using an external signer. The steps I followed are here: https://gist.github.com/josibake/9799b348e261e81881fa621d0c9d8dfb#testing-wallet-changes\r\n\r\n2. Create two separate wallets with the same external signer\r\n\r\n```bash\r\n./src/bitcoin-cli -datadir=$DATA_DIR -signet createwallet \"trezor_1\" true true \"\" true true true true\r\n./src/bitcoin-cli -datadir=$DATA_DIR -signet createwallet \"trezor_2\" true true \"\" true true true true\r\n```\r\n3. Send a transaction to one of the wallets\r\n4. Verify both wallets have the same transaction listed using `getwalletinfo`\r\n5. If you have previous transactions on the external signer, you will need to run `rescanblockchain` for each and you can also verify they have exactly the same information\r\n\r\n**System information**\r\n\r\nUsing https://github.com/bitcoin/bitcoin/releases/tag/v22.0rc2 (self compiled) on:\r\n\r\nOS: Pop!_OS 20.10 (Ubuntu 20.10)\r\nOS Type: 64 bit\r\nGNOME: 3.83.3\r\n",
   "closed_at" : "2021-08-10T18:05:51Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/7444140?v=4",
      "events_url" : "https://api.github.com/users/josibake/events{/privacy}",
      "followers_url" : "https://api.github.com/users/josibake/followers",
      "following_url" : "https://api.github.com/users/josibake/following{/other_user}",
      "gists_url" : "https://api.github.com/users/josibake/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/josibake",
      "id" : 7444140,
      "login" : "josibake",
      "node_id" : "MDQ6VXNlcjc0NDQxNDA=",
      "organizations_url" : "https://api.github.com/users/josibake/orgs",
      "received_events_url" : "https://api.github.com/users/josibake/received_events",
      "repos_url" : "https://api.github.com/users/josibake/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/josibake/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/josibake/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/josibake"
   },
   "comments" : 9,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22635/comments",
   "created_at" : "2021-08-05T16:59:04Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22635/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/22635",
   "id" : 962019168,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "description" : null,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22635/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU5NjIwMTkxNjg=",
   "number" : 22635,
   "performed_via_github_app" : null,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "createwallet allows you to create many wallets for the same external signer",
   "updated_at" : "2021-08-10T18:05:52Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22635",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/7444140?v=4",
      "events_url" : "https://api.github.com/users/josibake/events{/privacy}",
      "followers_url" : "https://api.github.com/users/josibake/followers",
      "following_url" : "https://api.github.com/users/josibake/following{/other_user}",
      "gists_url" : "https://api.github.com/users/josibake/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/josibake",
      "id" : 7444140,
      "login" : "josibake",
      "node_id" : "MDQ6VXNlcjc0NDQxNDA=",
      "organizations_url" : "https://api.github.com/users/josibake/orgs",
      "received_events_url" : "https://api.github.com/users/josibake/received_events",
      "repos_url" : "https://api.github.com/users/josibake/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/josibake/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/josibake/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/josibake"
   }
}
