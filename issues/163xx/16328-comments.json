[
   {
      "author_association" : "MEMBER",
      "body" : "utACK fa3d0199a8a03cc7e14b0242d672af0328f201f8\r\n\r\nI've read the code and it looks good to me.",
      "created_at" : "2019-07-02T18:22:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#issuecomment-507791592",
      "id" : 507791592,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNzc5MTU5Mg==",
      "updated_at" : "2019-07-02T18:22:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/507791592",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "How does this fit in with buried softfork changes like  #16060?",
      "created_at" : "2019-07-02T18:22:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#issuecomment-507791825",
      "id" : 507791825,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNzc5MTgyNQ==",
      "updated_at" : "2019-07-02T18:22:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/507791825",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> How does this fit in with buried softfork changes like\r\n\r\nThis is the first commit from #16060, with some changes to the tests and release notes.",
      "created_at" : "2019-07-02T18:35:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#issuecomment-507796042",
      "id" : 507796042,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNzc5NjA0Mg==",
      "updated_at" : "2019-07-02T18:35:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/507796042",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16365](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16365.html) (Log RPC parameters (arguments) if -debug=rpcparams by LarryRuane)\n* [#16229](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16229.html) (Standardise deployment handling by ajtowns)\n* [#16060](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16060.html) (Bury bip9 deployments by jnewbery)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-07-02T19:29:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#issuecomment-507813785",
      "id" : 507813785,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNzgxMzc4NQ==",
      "updated_at" : "2019-07-22T22:59:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/507813785",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  This is the first commit from #16060, with some changes to the tests and release notes.\r\n\r\nThanks. Yes, probably makes sense to split this off from the burying itself.",
      "created_at" : "2019-07-03T08:42:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#issuecomment-507999874",
      "id" : 507999874,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNzk5OTg3NA==",
      "updated_at" : "2019-07-03T08:42:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/507999874",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300187969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300187969"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "why drop the \"only for started\" note?",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-03T23:42:56Z",
      "diff_hunk" : "@@ -1318,29 +1309,25 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n             \"  \\\"pruneheight\\\": xxxxxx,        (numeric) lowest-height complete block stored (only present if pruning is enabled)\\n\"\n             \"  \\\"automatic_pruning\\\": xx,      (boolean) whether automatic pruning is enabled (only present if pruning is enabled)\\n\"\n             \"  \\\"prune_target_size\\\": xxxxxx,  (numeric) the target size used by pruning (only present if automatic pruning is enabled)\\n\"\n-            \"  \\\"softforks\\\": [                (array) status of softforks in progress\\n\"\n-            \"     {\\n\"\n-            \"        \\\"id\\\": \\\"xxxx\\\",           (string) name of softfork\\n\"\n-            \"        \\\"version\\\": xx,          (numeric) block version\\n\"\n-            \"        \\\"reject\\\": {             (object) progress toward rejecting pre-softfork blocks\\n\"\n-            \"           \\\"status\\\": xx,        (boolean) true if threshold reached\\n\"\n-            \"        },\\n\"\n-            \"     }, ...\\n\"\n-            \"  ],\\n\"\n-            \"  \\\"bip9_softforks\\\": {           (object) status of BIP9 softforks in progress\\n\"\n+            \"  \\\"softforks\\\": {                (object) status of softforks\\n\"\n             \"     \\\"xxxx\\\" : {                 (string) name of the softfork\\n\"\n+            \"      \\\"type\\\": \\\"xxxx\\\",           (string) one of \\\"buried\\\", \\\"bip9\\\"\\n\"\n+            \"      \\\"bip9\\\": {                 (object) status of bip9 softforks (only for \\\"bip9\\\" type)\\n\"\n             \"        \\\"status\\\": \\\"xxxx\\\",       (string) one of \\\"defined\\\", \\\"started\\\", \\\"locked_in\\\", \\\"active\\\", \\\"failed\\\"\\n\"\n             \"        \\\"bit\\\": xx,              (numeric) the bit (0-28) in the block version field used to signal this softfork (only for \\\"started\\\" status)\\n\"\n             \"        \\\"startTime\\\": xx,        (numeric) the minimum median time past of a block at which the bit gains its meaning\\n\"\n             \"        \\\"timeout\\\": xx,          (numeric) the median time past of a block at which the deployment is considered failed if not yet locked in\\n\"\n             \"        \\\"since\\\": xx,            (numeric) height of the first block to which the status applies\\n\"\n-            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork (only for \\\"started\\\" status)\\n\"\n+            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300187969",
      "id" : 300187969,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDE4Nzk2OQ==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 116,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 257777634,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300187969",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300235076"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300235076"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I believe `tip->nHeight >= BIPxxHeight` tells you if the rules were enforced in the current block, while `ThresholdState::ACTIVE == thresholdState` tells you if the rules should be enforced in the next block, so I think the value of this field is currently inconsistent. I think jnewbery's original patch consistently reported whether the rules should be enforced in the next block, by checking `tip->nHeight+1 >= BIPxxHeight`.\r\n\r\nYou can test this by changing the BIP66 height for regtest to 1152, and signalling for \"csv\" between blocks 864 and 1008; you get:\r\n\r\n    $ bitcoin-cli -regtest getblockchaininfo\r\n    {\r\n      \"chain\": \"regtest\",\r\n      \"blocks\": 1151,\r\n      \"headers\": 1151,\r\n      ...\r\n      \"softforks\": {\r\n        ...\r\n        \"bip66\": {\r\n          \"type\": \"buried\",\r\n          \"active\": false,\r\n          \"height\": 1152\r\n        },\r\n        ...\r\n        \"csv\": {\r\n          \"type\": \"bip9\",\r\n          \"bip9\": {\r\n            \"status\": \"active\",\r\n            \"startTime\": 0,\r\n            \"timeout\": 9223372036854775807,\r\n            \"since\": 1152\r\n          },\r\n          \"height\": 1152,\r\n          \"active\": true\r\n        },\r\n        ...\r\n      },\r\n      ...\r\n    }\r\n\r\nwith csv.height == bip66.height, but csv.active != bip66.active.\r\n\r\nI think my preference would be to report whether the next block needs to comply with the soft-fork rather than whether the current block did comply with it.",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-04T05:40:08Z",
      "diff_hunk" : "@@ -1318,29 +1309,25 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n             \"  \\\"pruneheight\\\": xxxxxx,        (numeric) lowest-height complete block stored (only present if pruning is enabled)\\n\"\n             \"  \\\"automatic_pruning\\\": xx,      (boolean) whether automatic pruning is enabled (only present if pruning is enabled)\\n\"\n             \"  \\\"prune_target_size\\\": xxxxxx,  (numeric) the target size used by pruning (only present if automatic pruning is enabled)\\n\"\n-            \"  \\\"softforks\\\": [                (array) status of softforks in progress\\n\"\n-            \"     {\\n\"\n-            \"        \\\"id\\\": \\\"xxxx\\\",           (string) name of softfork\\n\"\n-            \"        \\\"version\\\": xx,          (numeric) block version\\n\"\n-            \"        \\\"reject\\\": {             (object) progress toward rejecting pre-softfork blocks\\n\"\n-            \"           \\\"status\\\": xx,        (boolean) true if threshold reached\\n\"\n-            \"        },\\n\"\n-            \"     }, ...\\n\"\n-            \"  ],\\n\"\n-            \"  \\\"bip9_softforks\\\": {           (object) status of BIP9 softforks in progress\\n\"\n+            \"  \\\"softforks\\\": {                (object) status of softforks\\n\"\n             \"     \\\"xxxx\\\" : {                 (string) name of the softfork\\n\"\n+            \"      \\\"type\\\": \\\"xxxx\\\",           (string) one of \\\"buried\\\", \\\"bip9\\\"\\n\"\n+            \"      \\\"bip9\\\": {                 (object) status of bip9 softforks (only for \\\"bip9\\\" type)\\n\"\n             \"        \\\"status\\\": \\\"xxxx\\\",       (string) one of \\\"defined\\\", \\\"started\\\", \\\"locked_in\\\", \\\"active\\\", \\\"failed\\\"\\n\"\n             \"        \\\"bit\\\": xx,              (numeric) the bit (0-28) in the block version field used to signal this softfork (only for \\\"started\\\" status)\\n\"\n             \"        \\\"startTime\\\": xx,        (numeric) the minimum median time past of a block at which the bit gains its meaning\\n\"\n             \"        \\\"timeout\\\": xx,          (numeric) the median time past of a block at which the deployment is considered failed if not yet locked in\\n\"\n             \"        \\\"since\\\": xx,            (numeric) height of the first block to which the status applies\\n\"\n-            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork (only for \\\"started\\\" status)\\n\"\n+            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork\\n\"\n             \"           \\\"period\\\": xx,        (numeric) the length in blocks of the BIP9 signalling period \\n\"\n             \"           \\\"threshold\\\": xx,     (numeric) the number of blocks with the version bit set required to activate the feature \\n\"\n             \"           \\\"elapsed\\\": xx,       (numeric) the number of blocks elapsed since the beginning of the current period \\n\"\n             \"           \\\"count\\\": xx,         (numeric) the number of blocks with the version bit set in the current period \\n\"\n             \"           \\\"possible\\\": xx       (boolean) returns false if there are not enough blocks left in this period to pass activation threshold \\n\"\n             \"        }\\n\"\n+            \"      },\\n\"\n+            \"      \\\"height\\\": \\\"xxxxxx\\\",       (numeric) height of the first block which the rules are enforced (only for \\\"buried\\\" type, or \\\"bip9\\\" type with \\\"locked_in\\\" or \\\"active\\\" status)\\n\"\n+            \"      \\\"active\\\": xx,             (boolean) true if the rules are enforced at the current chain tip\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300235076",
      "id" : 300235076,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDIzNTA3Ng==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 125,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 257777634,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300235076",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300235282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300235282"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: should be height then active, to match order of bip9 object",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-04T05:41:25Z",
      "diff_hunk" : "@@ -1224,54 +1224,34 @@ static UniValue verifychain(const JSONRPCRequest& request)\n     return CVerifyDB().VerifyDB(Params(), pcoinsTip.get(), nCheckLevel, nCheckDepth);\n }\n \n-/** Implementation of IsSuperMajority with better feedback */\n-static UniValue SoftForkMajorityDesc(int version, const CBlockIndex* pindex, const Consensus::Params& consensusParams)\n+static void BuriedForkDescPushBack(UniValue& softforks, const std::string& name, int height, const CBlockIndex& tip)\n {\n     UniValue rv(UniValue::VOBJ);\n-    bool activated = false;\n-    switch(version)\n-    {\n-        case 2:\n-            activated = pindex->nHeight >= consensusParams.BIP34Height;\n-            break;\n-        case 3:\n-            activated = pindex->nHeight >= consensusParams.BIP66Height;\n-            break;\n-        case 4:\n-            activated = pindex->nHeight >= consensusParams.BIP65Height;\n-            break;\n-    }\n-    rv.pushKV(\"status\", activated);\n-    return rv;\n-}\n-\n-static UniValue SoftForkDesc(const std::string &name, int version, const CBlockIndex* pindex, const Consensus::Params& consensusParams)\n-{\n-    UniValue rv(UniValue::VOBJ);\n-    rv.pushKV(\"id\", name);\n-    rv.pushKV(\"version\", version);\n-    rv.pushKV(\"reject\", SoftForkMajorityDesc(version, pindex, consensusParams));\n-    return rv;\n+    rv.pushKV(\"type\", \"buried\");\n+    rv.pushKV(\"active\", tip.nHeight >= height);\n+    rv.pushKV(\"height\", height);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300235282",
      "id" : 300235282,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDIzNTI4Mg==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 35,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 26,
      "pull_request_review_id" : 257777634,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300235282",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300386011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300386011"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think reverting this to a for loop makes things any clearer. There are just three bip9 softforks currently, so listing them out explicitly seems clearer to me.",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-04T12:54:29Z",
      "diff_hunk" : "@@ -1385,16 +1372,14 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n     }\n \n     const Consensus::Params& consensusParams = Params().GetConsensus();\n-    UniValue softforks(UniValue::VARR);\n-    UniValue bip9_softforks(UniValue::VOBJ);\n-    softforks.push_back(SoftForkDesc(\"bip34\", 2, tip, consensusParams));\n-    softforks.push_back(SoftForkDesc(\"bip66\", 3, tip, consensusParams));\n-    softforks.push_back(SoftForkDesc(\"bip65\", 4, tip, consensusParams));\n+    UniValue softforks(UniValue::VOBJ);\n+    BuriedForkDescPushBack(softforks, \"bip34\", consensusParams.BIP34Height, *tip);\n+    BuriedForkDescPushBack(softforks, \"bip66\", consensusParams.BIP66Height, *tip);\n+    BuriedForkDescPushBack(softforks, \"bip65\", consensusParams.BIP65Height, *tip);\n     for (int pos = Consensus::DEPLOYMENT_CSV; pos != Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++pos) {\n-        BIP9SoftForkDescPushBack(bip9_softforks, consensusParams, static_cast<Consensus::DeploymentPos>(pos));\n+        BIP9SoftForkDescPushBack(softforks, consensusParams, static_cast<Consensus::DeploymentPos>(pos));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300386011",
      "id" : 300386011,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDM4NjAxMQ==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 144,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 258026832,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300386011",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300386777"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300386777"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Again, I don't understand why you've reverted this from the tidier code in 16060",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-04T12:56:40Z",
      "diff_hunk" : "@@ -1224,54 +1224,34 @@ static UniValue verifychain(const JSONRPCRequest& request)\n     return CVerifyDB().VerifyDB(Params(), pcoinsTip.get(), nCheckLevel, nCheckDepth);\n }\n \n-/** Implementation of IsSuperMajority with better feedback */\n-static UniValue SoftForkMajorityDesc(int version, const CBlockIndex* pindex, const Consensus::Params& consensusParams)\n+static void BuriedForkDescPushBack(UniValue& softforks, const std::string& name, int height, const CBlockIndex& tip)\n {\n     UniValue rv(UniValue::VOBJ);\n-    bool activated = false;\n-    switch(version)\n-    {\n-        case 2:\n-            activated = pindex->nHeight >= consensusParams.BIP34Height;\n-            break;\n-        case 3:\n-            activated = pindex->nHeight >= consensusParams.BIP66Height;\n-            break;\n-        case 4:\n-            activated = pindex->nHeight >= consensusParams.BIP65Height;\n-            break;\n-    }\n-    rv.pushKV(\"status\", activated);\n-    return rv;\n-}\n-\n-static UniValue SoftForkDesc(const std::string &name, int version, const CBlockIndex* pindex, const Consensus::Params& consensusParams)\n-{\n-    UniValue rv(UniValue::VOBJ);\n-    rv.pushKV(\"id\", name);\n-    rv.pushKV(\"version\", version);\n-    rv.pushKV(\"reject\", SoftForkMajorityDesc(version, pindex, consensusParams));\n-    return rv;\n+    rv.pushKV(\"type\", \"buried\");\n+    rv.pushKV(\"active\", tip.nHeight >= height);\n+    rv.pushKV(\"height\", height);\n+    softforks.pushKV(name, rv);\n }\n \n static UniValue BIP9SoftForkDesc(const Consensus::Params& consensusParams, Consensus::DeploymentPos id)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300386777",
      "id" : 300386777,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDM4Njc3Nw==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 39,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 258026832,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300386777",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300512672"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300512672"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "After sleeping on it, I think I've changed my mind -- it's probably less confusing to have \"active=true\" tell you whether the rules were enforced on the current block, and you can use the \"height=N\" output to tell you whether it needs to be enforced on the next block.\r\n\r\nIn that case, I think you'd want `nHeight >= BIPxxHeight` and to use `tip->pprev` instead of `tip` for the versionbits state. The versionbits statistics function might need some more tweaking to make sense though.",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-05T00:22:13Z",
      "diff_hunk" : "@@ -1318,29 +1309,25 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n             \"  \\\"pruneheight\\\": xxxxxx,        (numeric) lowest-height complete block stored (only present if pruning is enabled)\\n\"\n             \"  \\\"automatic_pruning\\\": xx,      (boolean) whether automatic pruning is enabled (only present if pruning is enabled)\\n\"\n             \"  \\\"prune_target_size\\\": xxxxxx,  (numeric) the target size used by pruning (only present if automatic pruning is enabled)\\n\"\n-            \"  \\\"softforks\\\": [                (array) status of softforks in progress\\n\"\n-            \"     {\\n\"\n-            \"        \\\"id\\\": \\\"xxxx\\\",           (string) name of softfork\\n\"\n-            \"        \\\"version\\\": xx,          (numeric) block version\\n\"\n-            \"        \\\"reject\\\": {             (object) progress toward rejecting pre-softfork blocks\\n\"\n-            \"           \\\"status\\\": xx,        (boolean) true if threshold reached\\n\"\n-            \"        },\\n\"\n-            \"     }, ...\\n\"\n-            \"  ],\\n\"\n-            \"  \\\"bip9_softforks\\\": {           (object) status of BIP9 softforks in progress\\n\"\n+            \"  \\\"softforks\\\": {                (object) status of softforks\\n\"\n             \"     \\\"xxxx\\\" : {                 (string) name of the softfork\\n\"\n+            \"      \\\"type\\\": \\\"xxxx\\\",           (string) one of \\\"buried\\\", \\\"bip9\\\"\\n\"\n+            \"      \\\"bip9\\\": {                 (object) status of bip9 softforks (only for \\\"bip9\\\" type)\\n\"\n             \"        \\\"status\\\": \\\"xxxx\\\",       (string) one of \\\"defined\\\", \\\"started\\\", \\\"locked_in\\\", \\\"active\\\", \\\"failed\\\"\\n\"\n             \"        \\\"bit\\\": xx,              (numeric) the bit (0-28) in the block version field used to signal this softfork (only for \\\"started\\\" status)\\n\"\n             \"        \\\"startTime\\\": xx,        (numeric) the minimum median time past of a block at which the bit gains its meaning\\n\"\n             \"        \\\"timeout\\\": xx,          (numeric) the median time past of a block at which the deployment is considered failed if not yet locked in\\n\"\n             \"        \\\"since\\\": xx,            (numeric) height of the first block to which the status applies\\n\"\n-            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork (only for \\\"started\\\" status)\\n\"\n+            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork\\n\"\n             \"           \\\"period\\\": xx,        (numeric) the length in blocks of the BIP9 signalling period \\n\"\n             \"           \\\"threshold\\\": xx,     (numeric) the number of blocks with the version bit set required to activate the feature \\n\"\n             \"           \\\"elapsed\\\": xx,       (numeric) the number of blocks elapsed since the beginning of the current period \\n\"\n             \"           \\\"count\\\": xx,         (numeric) the number of blocks with the version bit set in the current period \\n\"\n             \"           \\\"possible\\\": xx       (boolean) returns false if there are not enough blocks left in this period to pass activation threshold \\n\"\n             \"        }\\n\"\n+            \"      },\\n\"\n+            \"      \\\"height\\\": \\\"xxxxxx\\\",       (numeric) height of the first block which the rules are enforced (only for \\\"buried\\\" type, or \\\"bip9\\\" type with \\\"locked_in\\\" or \\\"active\\\" status)\\n\"\n+            \"      \\\"active\\\": xx,             (boolean) true if the rules are enforced at the current chain tip\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300512672",
      "id" : 300512672,
      "in_reply_to_id" : 300235076,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDUxMjY3Mg==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 125,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 258186473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300512672",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300530913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300530913"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I've pushed an update to https://github.com/ajtowns/bitcoin/commits/201907-getforkinfo that implements the latter in a way I think makes sense, including changes to versionist statistics. Can check the output makes sense with something like (assuming the \"csv\" softfork activates at block 1152 and you have jshon available):\r\n\r\n    $ for a in 863 864 865 1006 1007 1008 1009 1010 1150 1151 1152; do echo $a; bitcoin-cli -regtest getforkinfo $(bitcoin-cli -regtest getblockhash $a)  | jshon -e csv; echo ======; done | less\r\n",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-05T03:26:32Z",
      "diff_hunk" : "@@ -1318,29 +1309,25 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n             \"  \\\"pruneheight\\\": xxxxxx,        (numeric) lowest-height complete block stored (only present if pruning is enabled)\\n\"\n             \"  \\\"automatic_pruning\\\": xx,      (boolean) whether automatic pruning is enabled (only present if pruning is enabled)\\n\"\n             \"  \\\"prune_target_size\\\": xxxxxx,  (numeric) the target size used by pruning (only present if automatic pruning is enabled)\\n\"\n-            \"  \\\"softforks\\\": [                (array) status of softforks in progress\\n\"\n-            \"     {\\n\"\n-            \"        \\\"id\\\": \\\"xxxx\\\",           (string) name of softfork\\n\"\n-            \"        \\\"version\\\": xx,          (numeric) block version\\n\"\n-            \"        \\\"reject\\\": {             (object) progress toward rejecting pre-softfork blocks\\n\"\n-            \"           \\\"status\\\": xx,        (boolean) true if threshold reached\\n\"\n-            \"        },\\n\"\n-            \"     }, ...\\n\"\n-            \"  ],\\n\"\n-            \"  \\\"bip9_softforks\\\": {           (object) status of BIP9 softforks in progress\\n\"\n+            \"  \\\"softforks\\\": {                (object) status of softforks\\n\"\n             \"     \\\"xxxx\\\" : {                 (string) name of the softfork\\n\"\n+            \"      \\\"type\\\": \\\"xxxx\\\",           (string) one of \\\"buried\\\", \\\"bip9\\\"\\n\"\n+            \"      \\\"bip9\\\": {                 (object) status of bip9 softforks (only for \\\"bip9\\\" type)\\n\"\n             \"        \\\"status\\\": \\\"xxxx\\\",       (string) one of \\\"defined\\\", \\\"started\\\", \\\"locked_in\\\", \\\"active\\\", \\\"failed\\\"\\n\"\n             \"        \\\"bit\\\": xx,              (numeric) the bit (0-28) in the block version field used to signal this softfork (only for \\\"started\\\" status)\\n\"\n             \"        \\\"startTime\\\": xx,        (numeric) the minimum median time past of a block at which the bit gains its meaning\\n\"\n             \"        \\\"timeout\\\": xx,          (numeric) the median time past of a block at which the deployment is considered failed if not yet locked in\\n\"\n             \"        \\\"since\\\": xx,            (numeric) height of the first block to which the status applies\\n\"\n-            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork (only for \\\"started\\\" status)\\n\"\n+            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork\\n\"\n             \"           \\\"period\\\": xx,        (numeric) the length in blocks of the BIP9 signalling period \\n\"\n             \"           \\\"threshold\\\": xx,     (numeric) the number of blocks with the version bit set required to activate the feature \\n\"\n             \"           \\\"elapsed\\\": xx,       (numeric) the number of blocks elapsed since the beginning of the current period \\n\"\n             \"           \\\"count\\\": xx,         (numeric) the number of blocks with the version bit set in the current period \\n\"\n             \"           \\\"possible\\\": xx       (boolean) returns false if there are not enough blocks left in this period to pass activation threshold \\n\"\n             \"        }\\n\"\n+            \"      },\\n\"\n+            \"      \\\"height\\\": \\\"xxxxxx\\\",       (numeric) height of the first block which the rules are enforced (only for \\\"buried\\\" type, or \\\"bip9\\\" type with \\\"locked_in\\\" or \\\"active\\\" status)\\n\"\n+            \"      \\\"active\\\": xx,             (boolean) true if the rules are enforced at the current chain tip\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r300530913",
      "id" : 300530913,
      "in_reply_to_id" : 300235076,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDUzMDkxMw==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 125,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 258209047,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300530913",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r301296321"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301296321"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Refactoring changes should (if possible) be in a separate commit from behaviour changes. This can be done in a separate pull request",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-08T20:57:18Z",
      "diff_hunk" : "@@ -1385,16 +1372,14 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n     }\n \n     const Consensus::Params& consensusParams = Params().GetConsensus();\n-    UniValue softforks(UniValue::VARR);\n-    UniValue bip9_softforks(UniValue::VOBJ);\n-    softforks.push_back(SoftForkDesc(\"bip34\", 2, tip, consensusParams));\n-    softforks.push_back(SoftForkDesc(\"bip66\", 3, tip, consensusParams));\n-    softforks.push_back(SoftForkDesc(\"bip65\", 4, tip, consensusParams));\n+    UniValue softforks(UniValue::VOBJ);\n+    BuriedForkDescPushBack(softforks, \"bip34\", consensusParams.BIP34Height, *tip);\n+    BuriedForkDescPushBack(softforks, \"bip66\", consensusParams.BIP66Height, *tip);\n+    BuriedForkDescPushBack(softforks, \"bip65\", consensusParams.BIP65Height, *tip);\n     for (int pos = Consensus::DEPLOYMENT_CSV; pos != Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++pos) {\n-        BIP9SoftForkDescPushBack(bip9_softforks, consensusParams, static_cast<Consensus::DeploymentPos>(pos));\n+        BIP9SoftForkDescPushBack(softforks, consensusParams, static_cast<Consensus::DeploymentPos>(pos));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r301296321",
      "id" : 301296321,
      "in_reply_to_id" : 300386011,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTI5NjMyMQ==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 144,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 259152505,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301296321",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r301296390"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301296390"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Refactoring changes should (if possible) be in a separate commit from behaviour changes. This can be done in a separate pull request",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-08T20:57:27Z",
      "diff_hunk" : "@@ -1224,54 +1224,34 @@ static UniValue verifychain(const JSONRPCRequest& request)\n     return CVerifyDB().VerifyDB(Params(), pcoinsTip.get(), nCheckLevel, nCheckDepth);\n }\n \n-/** Implementation of IsSuperMajority with better feedback */\n-static UniValue SoftForkMajorityDesc(int version, const CBlockIndex* pindex, const Consensus::Params& consensusParams)\n+static void BuriedForkDescPushBack(UniValue& softforks, const std::string& name, int height, const CBlockIndex& tip)\n {\n     UniValue rv(UniValue::VOBJ);\n-    bool activated = false;\n-    switch(version)\n-    {\n-        case 2:\n-            activated = pindex->nHeight >= consensusParams.BIP34Height;\n-            break;\n-        case 3:\n-            activated = pindex->nHeight >= consensusParams.BIP66Height;\n-            break;\n-        case 4:\n-            activated = pindex->nHeight >= consensusParams.BIP65Height;\n-            break;\n-    }\n-    rv.pushKV(\"status\", activated);\n-    return rv;\n-}\n-\n-static UniValue SoftForkDesc(const std::string &name, int version, const CBlockIndex* pindex, const Consensus::Params& consensusParams)\n-{\n-    UniValue rv(UniValue::VOBJ);\n-    rv.pushKV(\"id\", name);\n-    rv.pushKV(\"version\", version);\n-    rv.pushKV(\"reject\", SoftForkMajorityDesc(version, pindex, consensusParams));\n-    return rv;\n+    rv.pushKV(\"type\", \"buried\");\n+    rv.pushKV(\"active\", tip.nHeight >= height);\n+    rv.pushKV(\"height\", height);\n+    softforks.pushKV(name, rv);\n }\n \n static UniValue BIP9SoftForkDesc(const Consensus::Params& consensusParams, Consensus::DeploymentPos id)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r301296390",
      "id" : 301296390,
      "in_reply_to_id" : 300386777,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTI5NjM5MA==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 39,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 259152594,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301296390",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r301978697"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301978697"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should be \"further\" :-)",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-10T09:49:03Z",
      "diff_hunk" : "@@ -0,0 +1,9 @@\n+Low-level changes\n+=================\n+\n+RPC\n+---\n+\n+- The array `softforks` and object `bip9_softforks` in the `getblockchaininfo`\n+  RPC are combined into a single `softforks` object. Refer to the RPC help for\n+  futher details.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r301978697",
      "id" : 301978697,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTk3ODY5Nw==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 9,
      "path" : "doc/release-notes-16328.md",
      "position" : null,
      "pull_request_review_id" : 259984962,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301978697",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Addressed review from @practicalswift and @ajtowns (excellent stuff, thanks!)\r\n\r\nIn particular:\r\n* Moved it to a new rpc to not clutter exiting rpcs\r\n* Made the resulting dict atomic (by acquiring `cs_main`, to avoid races with incoming blocks)\r\n* Made both types consistent (by reintroducing the \"off-by-one\")\r\n* Renamed \"bip9\" to \"vb\", since BIP 8 is also a version bits deployment mechanism\r\n\r\nI left out (from @ajtowns branch):\r\n* 70f425e84c8d6724099a1e5f63ea309875f34848 because I didn't like the non-rpc changes. Feel free to submit as a follow up pull request\r\n* 83709e74672d542ab58b0c70a76a32301236e0d4 because of the additional changes. Feel free to submit as follow up",
      "created_at" : "2019-07-19T17:51:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#issuecomment-513318610",
      "id" : 513318610,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMzMxODYxMA==",
      "updated_at" : "2019-07-19T17:51:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/513318610",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r305463495"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/305463495"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Restored",
      "commit_id" : "4a4178b61c4352d72677b6f0c7a11bd809e153f5",
      "created_at" : "2019-07-19T17:55:47Z",
      "diff_hunk" : "@@ -1318,29 +1309,25 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n             \"  \\\"pruneheight\\\": xxxxxx,        (numeric) lowest-height complete block stored (only present if pruning is enabled)\\n\"\n             \"  \\\"automatic_pruning\\\": xx,      (boolean) whether automatic pruning is enabled (only present if pruning is enabled)\\n\"\n             \"  \\\"prune_target_size\\\": xxxxxx,  (numeric) the target size used by pruning (only present if automatic pruning is enabled)\\n\"\n-            \"  \\\"softforks\\\": [                (array) status of softforks in progress\\n\"\n-            \"     {\\n\"\n-            \"        \\\"id\\\": \\\"xxxx\\\",           (string) name of softfork\\n\"\n-            \"        \\\"version\\\": xx,          (numeric) block version\\n\"\n-            \"        \\\"reject\\\": {             (object) progress toward rejecting pre-softfork blocks\\n\"\n-            \"           \\\"status\\\": xx,        (boolean) true if threshold reached\\n\"\n-            \"        },\\n\"\n-            \"     }, ...\\n\"\n-            \"  ],\\n\"\n-            \"  \\\"bip9_softforks\\\": {           (object) status of BIP9 softforks in progress\\n\"\n+            \"  \\\"softforks\\\": {                (object) status of softforks\\n\"\n             \"     \\\"xxxx\\\" : {                 (string) name of the softfork\\n\"\n+            \"      \\\"type\\\": \\\"xxxx\\\",           (string) one of \\\"buried\\\", \\\"bip9\\\"\\n\"\n+            \"      \\\"bip9\\\": {                 (object) status of bip9 softforks (only for \\\"bip9\\\" type)\\n\"\n             \"        \\\"status\\\": \\\"xxxx\\\",       (string) one of \\\"defined\\\", \\\"started\\\", \\\"locked_in\\\", \\\"active\\\", \\\"failed\\\"\\n\"\n             \"        \\\"bit\\\": xx,              (numeric) the bit (0-28) in the block version field used to signal this softfork (only for \\\"started\\\" status)\\n\"\n             \"        \\\"startTime\\\": xx,        (numeric) the minimum median time past of a block at which the bit gains its meaning\\n\"\n             \"        \\\"timeout\\\": xx,          (numeric) the median time past of a block at which the deployment is considered failed if not yet locked in\\n\"\n             \"        \\\"since\\\": xx,            (numeric) height of the first block to which the status applies\\n\"\n-            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork (only for \\\"started\\\" status)\\n\"\n+            \"        \\\"statistics\\\": {         (object) numeric statistics about BIP9 signalling for a softfork\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#discussion_r305463495",
      "id" : 305463495,
      "in_reply_to_id" : 300187969,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwNTQ2MzQ5NQ==",
      "original_commit_id" : "fae687c6bd775a406e3f41dcafd4146c7099baad",
      "original_position" : 116,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 264351607,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16328",
      "updated_at" : "2019-07-19T18:49:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/305463495",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Not sure why I didn't think of it earlier, but there's a much easier way of fixing the off-by-one issue with \"active\" that doesn't need changes to versionbits, given we do the \"height\" calculation anyway:\r\n\r\n```diff\r\n@@ -1189,6 +1189,7 @@ static void BuriedForkDescPushBack(UniValue& softforks, const std::string& name,\r\n     rv.pushKV(\"type\", \"buried\");\r\n     rv.pushKV(\"height\", height);\r\n     rv.pushKV(\"active\", tip.nHeight + 1 >= height);\r\n+    rv.pushKV(\"enforced\", tip.nHeight >= height);\r\n \r\n     softforks.pushKV(name, rv);\r\n }\r\n@@ -1227,12 +1228,15 @@ static UniValue BIP9SoftForkDesc(const CBlockIndex* pindex, const Consensus::Par\r\n     UniValue rv(UniValue::VOBJ);\r\n     rv.pushKV(\"type\", \"vb\");\r\n     rv.pushKV(\"vb\", bip9);\r\n+    int height = -1;\r\n     if (ThresholdState::LOCKED_IN == thresholdState) {\r\n-        rv.pushKV(\"height\", since_height + consensusParams.nMinerConfirmationWindow);\r\n+        height = since_height + consensusParams.nMinerConfirmationWindow;\r\n     } else if (ThresholdState::ACTIVE == thresholdState) {\r\n-        rv.pushKV(\"height\", since_height);\r\n+        height = since_height;\r\n     }\r\n+    if (height >= 0) rv.pushKV(\"height\", height);\r\n     rv.pushKV(\"active\", ThresholdState::ACTIVE == thresholdState);\r\n+    rv.pushKV(\"enforced\", (height >= 0 && pindex->nHeight >= height));\r\n \r\n     return rv;\r\n }\r\n```\r\n\r\n(I added a differently named field to make sure `\"active\": True` matches up with `\"vb\": { \"status\": \"active\", .. }`, since bumping the info in the \"vb\" field really needs changes to versionbits.cpp to make much sense.\r\n\r\nAlso, you've got a typo in the commit message, \"Renam**b**e bip9..\".",
      "created_at" : "2019-07-21T23:51:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16328#issuecomment-513598332",
      "id" : 513598332,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMzU5ODMzMg==",
      "updated_at" : "2019-07-21T23:51:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/513598332",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
