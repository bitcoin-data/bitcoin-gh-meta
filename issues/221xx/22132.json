{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "Here's a comparison of the Bitcoin Core GUI cross-compiled from linux to Windows between `master` and `0.21`:\r\n\r\n| Master     | 0.21         |\r\n| ------------- | ------------- |\r\n| ![master-cross](https://user-images.githubusercontent.com/23396902/120451507-81af7080-c35f-11eb-825b-3bab15409c0b.png) | ![021-cross](https://user-images.githubusercontent.com/23396902/120453344-f3d48500-c360-11eb-8b97-c240f2ae7b7f.png) |\r\n\r\n\r\nYep, there's something wrong here. We can gain some insight into what's going on with the style by leveraging the logging of static plugins introduced in 957895c715f86feaa26c806e5fa8ebb77430a926. The `master` branch already includes this commit. I cherry-picked it on top of the `0.21` branch [here](https://github.com/jarolrod/bitcoin/tree/021-static). Now if we take a look at the `debug.log` for each, we'll see the following\r\n\r\n*0.21 Branch:*\r\n```\r\n2021-06-02T07:23:59Z Qt 5.9.8 (static), plugin=windows (static)\r\n2021-06-02T07:23:59Z Static plugins:\r\n2021-06-02T07:23:59Z  QWindowsIntegrationPlugin, version 329992\r\n2021-06-02T07:23:59Z Style: windowsvista / QWindowsVistaStyle\r\n```\r\n\r\n*Master Branch:*\r\n```\r\n2021-06-02T04:16:06Z Qt 5.12.10 (static), plugin=windows (static)\r\n2021-06-02T04:16:06Z Static plugins:\r\n2021-06-02T04:16:06Z  QWindowsIntegrationPlugin, version 330752\r\n2021-06-02T04:16:06Z Style: windows / QWindowsStyle\r\n```\r\n\r\nWe notice that the `master` branch's style is set to `windows` while the `0.21` branch is set to `windowsvista` style. Looking at the [Qt Widgets Gallery](https://doc.qt.io/qt-5/gallery.html), you can observe that `windows` style looks like Windows 95 while `windowsvista` is the \"sleeker\"/\"modern\" [QStyle](https://doc.qt.io/qt-5/qstyle.html) for the Windows platform.\r\n\r\nThis is what has changed between `master` and `0.21` and what is causing the GUI to look straight out of the 90's (maybe this is a retro release? ðº). \r\n\r\nNow, what is causing this change? Well, I'm not completely sure. Otherwise I'd open up a PR. I do have some findings:\r\n\r\n#### Different available QStyle Keys between Qt 5.9.8 and Qt 5.12 at runtime:\r\n\r\nLooking at the `Qt Widgets` section of the depends Qt configuration output, we can see the following styles are available:\r\n\r\n*0.21 Branch:*\r\n```\r\nQt Widgets:\r\n  GTK+ ................................... no\r\n  Styles ................................. Fusion Windows WindowsXP WindowsVista\r\n```\r\n\r\n*Master Branch:*\r\n```\r\nQt Widgets:\r\n  GTK+ ................................... no\r\n  Styles ................................. Fusion Windows WindowsVista\r\n```\r\n\r\nSo while it seems that in regards to how Qt is configured, `WindowsVista` style is available in both cases,  If we apply the patch below to see the available [QStyle Keys](https://doc.qt.io/qt-5/qstylefactory.html#keys) at runtime, we don't see `windowsvista` as an available key on `master`: \r\n```\r\nqInfo() << QStyleFactory::keys().join(\",\");\r\n```\r\n\r\n*0.21 Branch:*\r\n```\r\n2021-06-02T17:43:35Z GUI: \"Windows,WindowsXP,WindowsVista,Fusion\"\r\n```\r\n\r\n*Master Branch:*\r\n```\r\n2021-06-02T17:03:11Z GUI: \"Windows,Fusion\"\r\n```\r\n\r\nThis means that we can't use the line below to fix the issue, and so a fix would involve changes to our build system: \r\n```\r\nQApplication::setStyle(\"windowsvista\");\r\n```\r\n\r\n**Windows Vista Style moved to a Plugin in Qt 5.10:**\r\n\r\nThis is based off what I found while looking for this issue online:\r\n\r\n[Source A](https://trac.videolan.org/vlc/ticket/20780)\r\n\r\n> I have also ran into this issue with Qt 5.11.1. Qt's Windows Vista style has been moved out to a separate DLL, which is styles\\qwindowsvistastyle.dll. If you add this to the package, standard windows will get back their modern look. \r\n\r\n[Source B](https://stackoverflow.com/questions/49587418/qt-application-becomes-windows-old-styled-after-build-on-a-buildbot)\r\n\r\n> I found a problem. After Qt5.10.1 the \"windowsvista\" style becomes a plugin. So in the final deploy file windowsvistastyle.dll schould exists. I add a folder \"/styles\" with this .dll and a problem is gone.\r\n\r\n[Source C](https://github.com/Ruin0x11/tiled/commit/7537fd06187591ec4d2feecbdb1fe8da88ccf5a7)\r\n\r\n> Ship style plugins, since native styles were moved into plugins as of Qt 5.10. This includes Windows Vista style on Windows and Adwaita on Linux.\r\n\r\nIf we figure out what needs to be done on the build side to link to this plugin, then we can use a similar patch as [vlc](http://git.videolan.org/?p=vlc.git;a=blobdiff;f=modules/gui/qt/qt.cpp;h=6fdbda06fa8f8aba4c9d43eef29543b28fdeedea;hp=1128633386a3fa43fe9a59ea5f633557a9596483;hb=0630bfa0436105ae7e24051cc16031c8ce2d77f5;hpb=07c35dcde98e25fba642085ea89080d94a0698d8) to fix this and so the following is a solution:\r\n\r\n```\r\n Q_IMPORT_PLUGIN(QWindowsVistaStylePlugin)\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
   "closed_at" : "2021-06-03T12:40:30Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
      "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
      "followers_url" : "https://api.github.com/users/fanquake/followers",
      "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/fanquake",
      "id" : 863730,
      "login" : "fanquake",
      "node_id" : "MDQ6VXNlcjg2MzczMA==",
      "organizations_url" : "https://api.github.com/users/fanquake/orgs",
      "received_events_url" : "https://api.github.com/users/fanquake/received_events",
      "repos_url" : "https://api.github.com/users/fanquake/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/fanquake"
   },
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22132/comments",
   "created_at" : "2021-06-02T17:57:38Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22132/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/22132",
   "id" : 909748654,
   "labels" : [
      {
         "color" : "02d7e1",
         "default" : false,
         "description" : null,
         "id" : 135946,
         "name" : "GUI",
         "node_id" : "MDU6TGFiZWwxMzU5NDY=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/GUI"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22132/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU5MDk3NDg2NTQ=",
   "number" : 22132,
   "performed_via_github_app" : null,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Missing windowsvista style plugin for Windows",
   "updated_at" : "2021-06-03T12:40:30Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22132",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/23396902?v=4",
      "events_url" : "https://api.github.com/users/jarolrod/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jarolrod/followers",
      "following_url" : "https://api.github.com/users/jarolrod/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jarolrod/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jarolrod",
      "id" : 23396902,
      "login" : "jarolrod",
      "node_id" : "MDQ6VXNlcjIzMzk2OTAy",
      "organizations_url" : "https://api.github.com/users/jarolrod/orgs",
      "received_events_url" : "https://api.github.com/users/jarolrod/received_events",
      "repos_url" : "https://api.github.com/users/jarolrod/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jarolrod/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jarolrod/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jarolrod"
   }
}
