[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428235753"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428235753"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit 3fc67497b85b1f465beb5c3d52303a7828c8cacc:\r\n\r\nWhy change the documentation?\r\n\r\n```suggestion\r\n            /* flag as external address if we can't read the m_pre_split boolean\r\n```",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-20T18:49:23Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n         int nVersion = s.GetVersion();\n-        if (!(s.GetType() & SER_GETHASH))\n-            READWRITE(nVersion);\n-        READWRITE(nTime);\n-        READWRITE(vchPubKey);\n-        if (ser_action.ForRead()) {\n-            try {\n-                READWRITE(fInternal);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as external address if we can't read the internal boolean\n-                   (this will be the case for any wallet before the HD chain split version) */\n-                fInternal = false;\n-            }\n-            try {\n-                READWRITE(m_pre_split);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as postsplit address if we can't read the m_pre_split boolean\n-                   (this will be the case for any wallet that upgrades to HD chain split)*/\n-                m_pre_split = false;\n-            }\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n+\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n+        int nVersion;\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s >> nVersion;\n+        }\n+        s >> nTime >> vchPubKey;\n+        try {\n+            s >> fInternal;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the internal boolean\n+               (this will be the case for any wallet before the HD chain split version) */\n+            fInternal = false;\n         }\n-        else {\n-            READWRITE(fInternal);\n-            READWRITE(m_pre_split);\n+        try {\n+            s >> m_pre_split;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the internal boolean",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428235753",
      "id" : 428235753,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIzNTc1Mw==",
      "original_commit_id" : "3fc67497b85b1f465beb5c3d52303a7828c8cacc",
      "original_line" : 141,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : null,
      "pull_request_review_id" : 415622687,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428235753",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428236072"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428236072"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n               (this will be the case for any wallet that upgrades to HD chain split)*/\r\n```\r\n\r\nSame",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-20T18:49:56Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n         int nVersion = s.GetVersion();\n-        if (!(s.GetType() & SER_GETHASH))\n-            READWRITE(nVersion);\n-        READWRITE(nTime);\n-        READWRITE(vchPubKey);\n-        if (ser_action.ForRead()) {\n-            try {\n-                READWRITE(fInternal);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as external address if we can't read the internal boolean\n-                   (this will be the case for any wallet before the HD chain split version) */\n-                fInternal = false;\n-            }\n-            try {\n-                READWRITE(m_pre_split);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as postsplit address if we can't read the m_pre_split boolean\n-                   (this will be the case for any wallet that upgrades to HD chain split)*/\n-                m_pre_split = false;\n-            }\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n+\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n+        int nVersion;\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s >> nVersion;\n+        }\n+        s >> nTime >> vchPubKey;\n+        try {\n+            s >> fInternal;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the internal boolean\n+               (this will be the case for any wallet before the HD chain split version) */\n+            fInternal = false;\n         }\n-        else {\n-            READWRITE(fInternal);\n-            READWRITE(m_pre_split);\n+        try {\n+            s >> m_pre_split;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the internal boolean\n+               (this will be the case for any wallet before the HD chain split version) */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428236072",
      "id" : 428236072,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIzNjA3Mg==",
      "original_commit_id" : "3fc67497b85b1f465beb5c3d52303a7828c8cacc",
      "original_line" : 142,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : null,
      "pull_request_review_id" : 415622687,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428236072",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428237089"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428237089"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit 3fc67497b85b1f465beb5c3d52303a7828c8cacc:\r\n\r\nLooks like the change in this file isn't needed? I don't mind either way, just noting.",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-20T18:51:48Z",
      "diff_hunk" : "@@ -247,15 +247,13 @@ struct COutputEntry\n class CMerkleTx\n {\n public:\n-    template<typename Stream>\n-    void Unserialize(Stream& s)\n+    SERIALIZE_METHODS(CMerkleTx, obj)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428237089",
      "id" : 428237089,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIzNzA4OQ==",
      "original_commit_id" : "3fc67497b85b1f465beb5c3d52303a7828c8cacc",
      "original_line" : 250,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 415622687,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428237089",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The fuzz tests are complaining:\r\n```\r\ntest/fuzz/string.cpp:111:15: error: no template named 'LimitedString'\r\n\r\n        const LimitedString<10> limited_string = LIMITED_STRING(random_string_1, 10);",
      "created_at" : "2020-05-20T19:15:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#issuecomment-631671836",
      "id" : 631671836,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19032",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMTY3MTgzNg==",
      "updated_at" : "2020-05-20T19:15:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631671836",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\nThe new serialization code is clearer and thus much easier to reason about.",
      "created_at" : "2020-05-21T07:14:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#issuecomment-631926143",
      "id" : 631926143,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19032",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMTkyNjE0Mw==",
      "updated_at" : "2020-05-21T07:14:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631926143",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428962263"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428962263"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You're right. I think this code was originally written before the Serialize method was removed here, and through rebases now reintroduces it. I'm happy to remove it, but perhaps it's desirable for consistency reasons.",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-21T23:09:31Z",
      "diff_hunk" : "@@ -247,15 +247,13 @@ struct COutputEntry\n class CMerkleTx\n {\n public:\n-    template<typename Stream>\n-    void Unserialize(Stream& s)\n+    SERIALIZE_METHODS(CMerkleTx, obj)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428962263",
      "id" : 428962263,
      "in_reply_to_id" : 428237089,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk2MjI2Mw==",
      "original_commit_id" : "3fc67497b85b1f465beb5c3d52303a7828c8cacc",
      "original_line" : 250,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 416551349,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428962263",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428970248"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428970248"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The serialization code has been removed in 05b56d1c937b7667ad51400d2f9fb674af72953f, just for reference.",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-21T23:38:39Z",
      "diff_hunk" : "@@ -247,15 +247,13 @@ struct COutputEntry\n class CMerkleTx\n {\n public:\n-    template<typename Stream>\n-    void Unserialize(Stream& s)\n+    SERIALIZE_METHODS(CMerkleTx, obj)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r428970248",
      "id" : 428970248,
      "in_reply_to_id" : 428237089,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk3MDI0OA==",
      "original_commit_id" : "3fc67497b85b1f465beb5c3d52303a7828c8cacc",
      "original_line" : 250,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 416560983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428970248",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429606219"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429606219"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok, removed here. No need to effectively revert that change.",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-24T07:00:28Z",
      "diff_hunk" : "@@ -247,15 +247,13 @@ struct COutputEntry\n class CMerkleTx\n {\n public:\n-    template<typename Stream>\n-    void Unserialize(Stream& s)\n+    SERIALIZE_METHODS(CMerkleTx, obj)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429606219",
      "id" : 429606219,
      "in_reply_to_id" : 428237089,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwNjIxOQ==",
      "original_commit_id" : "3fc67497b85b1f465beb5c3d52303a7828c8cacc",
      "original_line" : 250,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 417332428,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429606219",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-ACK 81caf8a869 only changes since previous review ðº\r\n\r\n* Change author email address in one commit\r\n* Restore uncorrupted documentation for m_pre_split\r\n* Remove one overly eager hunk in CMerkleTx to minimize the diff\r\n* Make the fuzz tests compile again\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nre-ACK 81caf8a869 only changes since previous review ðº\r\n\r\n* Change author email address in one commit\r\n* Restore uncorrupted documentation for m_pre_split\r\n* Remove one overly eager hunk in CMerkleTx to minimize the diff\r\n* Make the fuzz tests compile again\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUiyqQv/WKvoztimli1L/+qEb2zHJmcLmfgAQoCzC3GOh9Hi2Px9fK4Zsp691OsA\r\n2T937ZSmwdWHpbVCzW+mDAQnGX9qN6h6ysISSsu3jUOWtBwCkHHUmAiZIItrDrsQ\r\nAl44fOPEDW84S1RMm1cL71Sn+rt4qWQCAJ028cx37Wpp2zhGCBjBvZx+IY1BKJ4o\r\n8L1TdkhoRSpDz6KFS5vpFGzePxwBl3LVFP/Q5Fx8Ijz0qFXn7Ewg8NtMXtuW8D0I\r\nV32JuWT5qo4qFO0/lBdNrb8icN7tpfkH/VVZ9nKMp3RXiTdsGvJeC4iwLiEzOPJU\r\nopQNWpkpJ79we9lS9Hw35BLMgDz9jRpcckImYceM46HrDrDG7kyKV+iCDsn4Edyj\r\nU5JY835uzcKDXxWXyW6GijCX6why4qKwFUNdmB3HIpa269IaOy9cjaM4ZpGzzK1R\r\nBEVlwsY9eo8YyOssR3gscZoBHMsJrTqId5oU6q9PodfewntD0O4h579bD1181iZ+\r\nTkr4vdOA\r\n=IsD3\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `f7b948dcd680ca3ad0d8ba39d18536d69a5d93ae4b678d5c0fb27d54153de077  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e892940108f7b948dcd680ca3ad0d8ba39d18536d69a5d93ae4b678d5c0fb27d54153de077f010fd7bee5dfbc8aa2e621cae9dd375cec908fff0100128ca79bc7bf1553597796ca84a619608f1045eca6b8df008234bc8e5dc4001800083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff010325cf0ccbe545d9bd54d6aaaa6eea39b08f1045eca6b8df008eb8927bc0292c9510083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff0105eb030e6f22bb1a07e1c4c0be42bd15008f1045eca6b8ef0080da53cb3707b42b40083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6df0108c69e6dc6682c1a643c732ae0ce4349608f1045eca6b8ef00886b456e93aca3c110083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6d)\r\n\r\n</details>\r\n",
      "created_at" : "2020-05-24T12:42:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#issuecomment-633225390",
      "id" : 633225390,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19032",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMzIyNTM5MA==",
      "updated_at" : "2020-05-24T12:42:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633225390",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429632989"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429632989"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            /* flag as postsplit address if we can't read the m_pre_split boolean\r\n```\r\n\r\nI think this is still wrong",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-24T12:45:18Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n         int nVersion = s.GetVersion();\n-        if (!(s.GetType() & SER_GETHASH))\n-            READWRITE(nVersion);\n-        READWRITE(nTime);\n-        READWRITE(vchPubKey);\n-        if (ser_action.ForRead()) {\n-            try {\n-                READWRITE(fInternal);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as external address if we can't read the internal boolean\n-                   (this will be the case for any wallet before the HD chain split version) */\n-                fInternal = false;\n-            }\n-            try {\n-                READWRITE(m_pre_split);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as postsplit address if we can't read the m_pre_split boolean\n-                   (this will be the case for any wallet that upgrades to HD chain split)*/\n-                m_pre_split = false;\n-            }\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n+\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n+        int nVersion;\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s >> nVersion;\n+        }\n+        s >> nTime >> vchPubKey;\n+        try {\n+            s >> fInternal;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the internal boolean\n+               (this will be the case for any wallet before the HD chain split version) */\n+            fInternal = false;\n         }\n-        else {\n-            READWRITE(fInternal);\n-            READWRITE(m_pre_split);\n+        try {\n+            s >> m_pre_split;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the m_pre_split boolean",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429632989",
      "id" : 429632989,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYzMjk4OQ==",
      "original_commit_id" : "81caf8a86952c90c0ff73e6442ed6045213a0d9c",
      "original_line" : 141,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : null,
      "pull_request_review_id" : 417355437,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429632989",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429641302"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429641302"
         }
      },
      "author_association" : "MEMBER",
      "body" : "309a653 s/external/postsplit/?\r\n\r\n```diff\r\n-            /* flag as external address if we can't read the m_pre_split boolean\r\n+            /* flag as postsplit address if we can't read the m_pre_split boolean\r\n```",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-24T14:16:15Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n         int nVersion = s.GetVersion();\n-        if (!(s.GetType() & SER_GETHASH))\n-            READWRITE(nVersion);\n-        READWRITE(nTime);\n-        READWRITE(vchPubKey);\n-        if (ser_action.ForRead()) {\n-            try {\n-                READWRITE(fInternal);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as external address if we can't read the internal boolean\n-                   (this will be the case for any wallet before the HD chain split version) */\n-                fInternal = false;\n-            }\n-            try {\n-                READWRITE(m_pre_split);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as postsplit address if we can't read the m_pre_split boolean\n-                   (this will be the case for any wallet that upgrades to HD chain split)*/\n-                m_pre_split = false;\n-            }\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n+\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n+        int nVersion;\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s >> nVersion;\n+        }\n+        s >> nTime >> vchPubKey;\n+        try {\n+            s >> fInternal;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the internal boolean\n+               (this will be the case for any wallet before the HD chain split version) */\n+            fInternal = false;\n         }\n-        else {\n-            READWRITE(fInternal);\n-            READWRITE(m_pre_split);\n+        try {\n+            s >> m_pre_split;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the m_pre_split boolean",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429641302",
      "id" : 429641302,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY0MTMwMg==",
      "original_commit_id" : "81caf8a86952c90c0ff73e6442ed6045213a0d9c",
      "original_line" : 141,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : null,
      "pull_request_review_id" : 417362731,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429641302",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429658655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429658655"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-24T17:38:04Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n         int nVersion = s.GetVersion();\n-        if (!(s.GetType() & SER_GETHASH))\n-            READWRITE(nVersion);\n-        READWRITE(nTime);\n-        READWRITE(vchPubKey);\n-        if (ser_action.ForRead()) {\n-            try {\n-                READWRITE(fInternal);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as external address if we can't read the internal boolean\n-                   (this will be the case for any wallet before the HD chain split version) */\n-                fInternal = false;\n-            }\n-            try {\n-                READWRITE(m_pre_split);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as postsplit address if we can't read the m_pre_split boolean\n-                   (this will be the case for any wallet that upgrades to HD chain split)*/\n-                m_pre_split = false;\n-            }\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n+\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n+        int nVersion;\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s >> nVersion;\n+        }\n+        s >> nTime >> vchPubKey;\n+        try {\n+            s >> fInternal;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the internal boolean\n+               (this will be the case for any wallet before the HD chain split version) */\n+            fInternal = false;\n         }\n-        else {\n-            READWRITE(fInternal);\n-            READWRITE(m_pre_split);\n+        try {\n+            s >> m_pre_split;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the m_pre_split boolean",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429658655",
      "id" : 429658655,
      "in_reply_to_id" : 429641302,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1ODY1NQ==",
      "original_commit_id" : "81caf8a86952c90c0ff73e6442ed6045213a0d9c",
      "original_line" : 141,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : null,
      "pull_request_review_id" : 417377351,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:38:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429658655",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429658667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429658667"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-24T17:38:13Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n         int nVersion = s.GetVersion();\n-        if (!(s.GetType() & SER_GETHASH))\n-            READWRITE(nVersion);\n-        READWRITE(nTime);\n-        READWRITE(vchPubKey);\n-        if (ser_action.ForRead()) {\n-            try {\n-                READWRITE(fInternal);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as external address if we can't read the internal boolean\n-                   (this will be the case for any wallet before the HD chain split version) */\n-                fInternal = false;\n-            }\n-            try {\n-                READWRITE(m_pre_split);\n-            }\n-            catch (std::ios_base::failure&) {\n-                /* flag as postsplit address if we can't read the m_pre_split boolean\n-                   (this will be the case for any wallet that upgrades to HD chain split)*/\n-                m_pre_split = false;\n-            }\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n+\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n+        int nVersion;\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s >> nVersion;\n+        }\n+        s >> nTime >> vchPubKey;\n+        try {\n+            s >> fInternal;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the internal boolean\n+               (this will be the case for any wallet before the HD chain split version) */\n+            fInternal = false;\n         }\n-        else {\n-            READWRITE(fInternal);\n-            READWRITE(m_pre_split);\n+        try {\n+            s >> m_pre_split;\n+        } catch (std::ios_base::failure&) {\n+            /* flag as external address if we can't read the m_pre_split boolean",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429658667",
      "id" : 429658667,
      "in_reply_to_id" : 429632989,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1ODY2Nw==",
      "original_commit_id" : "81caf8a86952c90c0ff73e6442ed6045213a0d9c",
      "original_line" : 141,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : null,
      "pull_request_review_id" : 417377358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-24T17:38:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429658667",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429832792"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429832792"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ef17c03 is this new change from 309a653 intentional (needed for deserializing)?\r\n```diff\r\n-        int nVersion;\r\n+        int nVersion = s.GetVersion();\r\n```",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-25T09:26:27Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n+        int nVersion = s.GetVersion();\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n \n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n         int nVersion = s.GetVersion();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429832792",
      "id" : 429832792,
      "line" : 126,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTgzMjc5Mg==",
      "original_commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "original_line" : 126,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : 20,
      "pull_request_review_id" : 417582557,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-25T09:26:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429832792",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 71f016c6eb42e1ac2 reviewed diff, builds/tests/re-fuzzed.\r\n\r\n<details><summary>changes since 81caf8a: avoiding use before initialization of <code>nVersion</code> in <code>ScriptPubKeyMan::Unserialize()</code> and documentation fixup</summary><p>\r\n\r\n```diff\r\n\r\ndiff --git a/src/wallet/scriptpubkeyman.h b/src/wallet/scriptpubkeyman.h\r\n--- a/src/wallet/scriptpubkeyman.h\r\n+++ b/src/wallet/scriptpubkeyman.h\r\n\r\n@@ -123,7 +123,7 @@ public:\r\n     void Unserialize(Stream& s)\r\n     {\r\n-        int nVersion;\r\n+        int nVersion = s.GetVersion();\r\n         if (!(s.GetType() & SER_GETHASH)) {\r\n             s >> nVersion;\r\n         }\r\n\r\n@@ -138,8 +138,8 @@ public:\r\n         } catch (std::ios_base::failure&) {\r\n-            /* flag as external address if we can't read the m_pre_split boolean\r\n-               (this will be the case for any wallet that upgrades to HD chain split)*/\r\n+            /* flag as postsplit address if we can't read the m_pre_split boolean\r\n+               (this will be the case for any wallet that upgrades to HD chain split) */\r\n             m_pre_split = false;\r\n```\r\n</p></details>\r\n",
      "created_at" : "2020-05-25T10:05:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#issuecomment-633493223",
      "id" : 633493223,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19032",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMzQ5MzIyMw==",
      "updated_at" : "2020-05-25T15:59:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633493223",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429990753"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429990753"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I doubt it's needed, as I don't think this class is ever deserialized with SER_GETHASH. However, if it were ever invoked that way, the old code was UB (nVersion would be used without being initialized).",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-25T15:28:37Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n+        int nVersion = s.GetVersion();\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n \n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n         int nVersion = s.GetVersion();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429990753",
      "id" : 429990753,
      "in_reply_to_id" : 429832792,
      "line" : 126,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk5MDc1Mw==",
      "original_commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "original_line" : 126,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : 20,
      "pull_request_review_id" : 417779072,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-25T15:28:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429990753",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429999558"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429999558"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thank you. Good catch and reminder.",
      "commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-25T15:52:22Z",
      "diff_hunk" : "@@ -110,36 +110,37 @@ class CKeyPool\n     CKeyPool();\n     CKeyPool(const CPubKey& vchPubKeyIn, bool internalIn);\n \n-    ADD_SERIALIZE_METHODS;\n+    template<typename Stream>\n+    void Serialize(Stream& s) const\n+    {\n+        int nVersion = s.GetVersion();\n+        if (!(s.GetType() & SER_GETHASH)) {\n+            s << nVersion;\n+        }\n+        s << nTime << vchPubKey << fInternal << m_pre_split;\n+    }\n \n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n+    template<typename Stream>\n+    void Unserialize(Stream& s)\n+    {\n         int nVersion = s.GetVersion();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#discussion_r429999558",
      "id" : 429999558,
      "in_reply_to_id" : 429832792,
      "line" : 126,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk5OTU1OA==",
      "original_commit_id" : "71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "original_line" : 126,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : 20,
      "pull_request_review_id" : 417789748,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19032",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-25T15:52:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429999558",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 71f016c6eb42e1ac2c905e04ba4d20c2009e533f",
      "created_at" : "2020-05-26T13:44:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#issuecomment-634034066",
      "id" : 634034066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19032",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDAzNDA2Ng==",
      "updated_at" : "2020-05-26T13:44:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634034066",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-ACK 71f016c ð¤´\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nre-ACK 71f016c ð¤´\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUiCcgv9FZxj/YquESruZvS2FcLiLs55nDP0DClnbFBcYts6JsuqkeMwNIiBY1Oa\r\nA8Qx6zv8qN1PdFVXsOhzoA86abTQMGxzJkBHRqC73eDtB9n9DsSZygz+bWP+aLKN\r\ncC7r5YRwdBmnIv/47+rELLK8DD31geVNyISZUvsPk/JfJAwJhf2uSi1MEAI2qjds\r\nFV890WMLshTbj86n2cMCLWlN6LXL9Okkiw4SKs/qo9OzLvCXQwJzycL4grs9lHTj\r\nM3MzZJ6W66jp1BZe9/ob3LeHGwd4qL+5gvaO3FM1y7LoxNCZAnZk7kC83nCv4TOC\r\nMLX2aruo2I1KpumZWoICSkqqp1MXMG6qPnfu7RpntXu/0ky6bB40eyg8q6HaWQPT\r\njIO7F8DkEoow0jC9XNQmG4DJYNq3FhAkDAeKCxnnUsR9zSLEa2HyZ3N/VHp3THsK\r\nhBNzdzfAQ0sAN88Gz1WFL/ky1fy4v2ynBz5hixctLGvvU7EkmYdC4QJnRs6yErvu\r\n1X0GS7hd\r\n=cvua\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `3646ddaf3ced2728b4c9185e8341178d02575e344a8f4292869f74ec2b3f5a97  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e8929401083646ddaf3ced2728b4c9185e8341178d02575e344a8f4292869f74ec2b3f5a97f010eb2327481508399582bee1158ce613a908fff010304ecd932831040e30e161bbe9ca4e2b08f1045ede4b45f0081d08e44f1a61f9790083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff0109a96b026c6ca9549e2f5fbd0a1120e6c08f1208a6c4242a55b1745e37d631d3abb132f603c230deb6685b6438c730fb2db5f4408f1045ede4b44f008a77e3efe71b01a0a0083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff010cd902f6a788a90855094d432fa21ac2308f1045ede4b45f008c085b5714483cb300083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6df010f183ba0eda8942a659532322f4f7cc9408f1045ede4b45f0085acd2e7fcd19ec330083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6d)\r\n\r\n</details>\r\n",
      "created_at" : "2020-06-08T14:29:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19032#issuecomment-640660694",
      "id" : 640660694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19032",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MDY2MDY5NA==",
      "updated_at" : "2020-06-08T14:29:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/640660694",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
