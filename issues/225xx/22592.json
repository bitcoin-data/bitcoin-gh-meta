{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "While running the functional tests under LSAN and 8 parallel jobs, `CDBWrapper` ctor would regularly throw via `HandleError` because of low disk space.  This would make LSAN error because the destructor for `CDBWrapper` was never called and so the `options.block_cache` and some other parameters wouldn't be destructed.\r\n\r\nLSAN output (I deleted the file, but managed to take a picture of it, so log is kind of truncated):\r\n```\r\n==1204791==ERROR:  LeakSanitizer: detected memory leaks\r\n\r\nDirect leak of 3520 byte(s) in 1 object(s) allocated from:\r\n       #0 0x55f632912679 in operator new(unsigned long)\r\n       #1 0x55f6342936d6 in leveldb::NewLRUCache(unsigned long)\r\n       #2 0x55f6335f66f8 in GetOptions(unsigned long)\r\n       #3 0x55f6335f4ec7 in CDBWrapper::CDBWrapper(boost::filesystem::path const&, unsigned long, bool, bool, bool)\r\n       #4 0x55f6332e32cf in std::_MakeUniq<CDBWrapper>::__single_object std::make_unique<CoinsViews ...truncated...\r\n       #5 0x55f6332d2781 in CCoinsViewDB::CCoinsViewDB(boost::filesystem::path, unsigned long, bool, bool)\r\n       #6 0x55f6333ec6e2 in CoinsViews::CoinsViews(std::__cxx11::basic_string<char, std::char_traits<char>, ...truncated...\r\n       #7 0x55f63346a111 in std::_MakeUniq<CoinsViews>::__single_object std::make_unique<CoinsViews, ...truncated...\r\n       #8 0x55f6333ed379 in CChainState::InitCoinsDB(unsigned long, bool, bool, std::__cxx11::basic_string ...truncated...\r\n       #9 0x55f6329699e0 in AppInitMain(NodeContext&, interfaces::BlockAndHeaderTipInfo*)\r\n       #10 0x55f63291868e in AppInit(NodeContext&, int, char**)\r\n       #11 0x55f632915e2f in main\r\n       #12 0x7f86b6f7fb24 in __libc_start_main\r\n```",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22592/comments",
   "created_at" : "2021-07-31T17:44:31Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22592/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/22592",
   "id" : 957290337,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22592/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU5NTcyOTAzMzc=",
   "number" : 22592,
   "performed_via_github_app" : null,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "LeakSanitizer detects memory leak if CDBWrapper ctor fails",
   "updated_at" : "2021-07-31T17:44:31Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22592",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/15145615?v=4",
      "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
      "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
      "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
      "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/Crypt-iQ",
      "id" : 15145615,
      "login" : "Crypt-iQ",
      "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
      "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
      "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
      "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/Crypt-iQ"
   }
}
