[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2021-07-29T14:03:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-889172376",
      "id" : 889172376,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5840_7GY",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-10T19:57:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889172376",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-07-30T01:43:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-889567341",
      "id" : 889567341,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5841Bbht",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-30T01:43:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889567341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8435003?v=4",
         "events_url" : "https://api.github.com/users/tryphe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tryphe/followers",
         "following_url" : "https://api.github.com/users/tryphe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tryphe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tryphe",
         "id" : 8435003,
         "login" : "tryphe",
         "node_id" : "MDQ6VXNlcjg0MzUwMDM=",
         "organizations_url" : "https://api.github.com/users/tryphe/orgs",
         "received_events_url" : "https://api.github.com/users/tryphe/received_events",
         "repos_url" : "https://api.github.com/users/tryphe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tryphe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tryphe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tryphe"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r679691371"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679691371"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What does M1b do? I don't see how it's relevant to the test :thinking: ",
      "commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "created_at" : "2021-07-30T06:52:32Z",
      "diff_hunk" : "@@ -304,6 +305,109 @@ def test_descendant_limits(self):\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n         node.generate(1)\n \n+    def test_descendant_limits_bushy(self):\n+        \"\"\"Create A bushy Package with 24 transaction in mempool and 3 transaction in package\n+                              M1a\n+                             ^  ^\n+                            ^    M2a\n+            M1b            ^       .\n+              ^           ^         .\n+               ^         ^           ^\n+                ^       ^            M23a\n+                 ^     ^\n+                  ^   P1\n+                   ^ ^  ^\n+                    P2   P3\n+\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)\n+        \"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r679691371",
      "id" : 679691371,
      "line" : 325,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTY5MTM3MQ==",
      "original_commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "original_line" : 325,
      "original_position" : 29,
      "original_start_line" : 308,
      "path" : "test/functional/rpc_packages.py",
      "position" : 152,
      "pull_request_review_id" : 718771736,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : 308,
      "start_side" : "RIGHT",
      "updated_at" : "2021-07-30T07:01:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679691371",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r679693319"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679693319"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I wouldn't call this bushy, it's kind of giraffe-shaped?\r\nmaybe `test_descendant_limits_2` or `test_descendant_limits_mempool_dominated`",
      "commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "created_at" : "2021-07-30T06:56:48Z",
      "diff_hunk" : "@@ -304,6 +305,109 @@ def test_descendant_limits(self):\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n         node.generate(1)\n \n+    def test_descendant_limits_bushy(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r679693319",
      "id" : 679693319,
      "line" : 308,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTY5MzMxOQ==",
      "original_commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "original_line" : 308,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "test/functional/rpc_packages.py",
      "position" : 135,
      "pull_request_review_id" : 718771736,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-30T07:01:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679693319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r679917094"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679917094"
         }
      },
      "author_association" : "NONE",
      "body" : "Done",
      "commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "created_at" : "2021-07-30T13:17:00Z",
      "diff_hunk" : "@@ -304,6 +305,109 @@ def test_descendant_limits(self):\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n         node.generate(1)\n \n+    def test_descendant_limits_bushy(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r679917094",
      "id" : 679917094,
      "in_reply_to_id" : 679693319,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTkxNzA5NA==",
      "original_commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "original_line" : 308,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "test/functional/rpc_packages.py",
      "position" : null,
      "pull_request_review_id" : 719066654,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-30T13:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679917094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32807799?v=4",
         "events_url" : "https://api.github.com/users/ritickgoenka/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ritickgoenka/followers",
         "following_url" : "https://api.github.com/users/ritickgoenka/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ritickgoenka/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ritickgoenka",
         "id" : 32807799,
         "login" : "ritickgoenka",
         "node_id" : "MDQ6VXNlcjMyODA3Nzk5",
         "organizations_url" : "https://api.github.com/users/ritickgoenka/orgs",
         "received_events_url" : "https://api.github.com/users/ritickgoenka/received_events",
         "repos_url" : "https://api.github.com/users/ritickgoenka/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ritickgoenka/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ritickgoenka/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ritickgoenka"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r679929485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679929485"
         }
      },
      "author_association" : "NONE",
      "body" : "To test a transaction having a direct connection to mempool doesn't affect it being counted as an indirect descendant of some transaction in the mempool. If this doesn't make much sense I can remove M1b.",
      "commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "created_at" : "2021-07-30T13:34:33Z",
      "diff_hunk" : "@@ -304,6 +305,109 @@ def test_descendant_limits(self):\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n         node.generate(1)\n \n+    def test_descendant_limits_bushy(self):\n+        \"\"\"Create A bushy Package with 24 transaction in mempool and 3 transaction in package\n+                              M1a\n+                             ^  ^\n+                            ^    M2a\n+            M1b            ^       .\n+              ^           ^         .\n+               ^         ^           ^\n+                ^       ^            M23a\n+                 ^     ^\n+                  ^   P1\n+                   ^ ^  ^\n+                    P2   P3\n+\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)\n+        \"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r679929485",
      "id" : 679929485,
      "in_reply_to_id" : 679691371,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTkyOTQ4NQ==",
      "original_commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "original_line" : 325,
      "original_position" : 29,
      "original_start_line" : 308,
      "path" : "test/functional/rpc_packages.py",
      "position" : null,
      "pull_request_review_id" : 719083467,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-07-30T13:34:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679929485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32807799?v=4",
         "events_url" : "https://api.github.com/users/ritickgoenka/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ritickgoenka/followers",
         "following_url" : "https://api.github.com/users/ritickgoenka/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ritickgoenka/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ritickgoenka",
         "id" : 32807799,
         "login" : "ritickgoenka",
         "node_id" : "MDQ6VXNlcjMyODA3Nzk5",
         "organizations_url" : "https://api.github.com/users/ritickgoenka/orgs",
         "received_events_url" : "https://api.github.com/users/ritickgoenka/received_events",
         "repos_url" : "https://api.github.com/users/ritickgoenka/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ritickgoenka/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ritickgoenka/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ritickgoenka"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-08-09T06:06:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-894971893",
      "id" : 894971893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5841WC_1",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-09T06:06:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/894971893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Will review again after rebase - note that the mempool tests have been moved to mempool_package_limits.py",
      "created_at" : "2021-08-09T06:18:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-894976551",
      "id" : 894976551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5841WEIn",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-09T06:19:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/894976551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686825121"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686825121"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I actually think a fee of just `Decimal(\"0.0001\")` would be sufficient here. In fact, I think it'd be best to import `DEFAULT_FEE` from test_framework/wallet.py and use that throughout this test.",
      "commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "created_at" : "2021-08-11T13:21:46Z",
      "diff_hunk" : "@@ -177,6 +178,107 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create A bushy Package with 24 transaction in mempool and 3 transaction in package\n+                              M1a\n+                             ^  ^\n+                            ^    M2a\n+            M1b            ^       .\n+              ^           ^         .\n+               ^         ^           ^\n+                ^       ^            M23a\n+                 ^     ^\n+                  ^   P1\n+                   ^ ^  ^\n+                    P2   P3\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)\n+        \"\"\"\n+\n+        node = self.nodes[0]\n+        package_hex = []\n+        parents_tx = []\n+        values = []\n+        scripts = []\n+        # M1a\n+        first_coin_a = self.coins.pop()\n+        parent_value = (first_coin_a[\"amount\"] - Decimal(\"0.0002\")) / 2 # Deduct reasonable fee and make 2 outputs",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686825121",
      "id" : 686825121,
      "line" : 206,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4NjgyNTEyMQ==",
      "original_commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "original_line" : 206,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 37,
      "pull_request_review_id" : 727476788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-11T13:52:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686825121",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686835358"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686835358"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: this test would be simplified if you made M2a .... M23a be a chain spending vout[0] of M1a. It'd save maybe 5-10 lines.\r\n",
      "commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "created_at" : "2021-08-11T13:33:11Z",
      "diff_hunk" : "@@ -177,6 +178,107 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create A bushy Package with 24 transaction in mempool and 3 transaction in package\n+                              M1a\n+                             ^  ^\n+                            ^    M2a\n+            M1b            ^       .\n+              ^           ^         .\n+               ^         ^           ^\n+                ^       ^            M23a\n+                 ^     ^\n+                  ^   P1\n+                   ^ ^  ^\n+                    P2   P3",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686835358",
      "id" : 686835358,
      "line" : 193,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4NjgzNTM1OA==",
      "original_commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "original_line" : 193,
      "original_position" : 24,
      "original_start_line" : 183,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 24,
      "pull_request_review_id" : 727476788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : 183,
      "start_side" : "RIGHT",
      "updated_at" : "2021-08-11T13:52:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686835358",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686851459"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686851459"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Again, not bushy",
      "commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "created_at" : "2021-08-11T13:50:53Z",
      "diff_hunk" : "@@ -177,6 +178,107 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create A bushy Package with 24 transaction in mempool and 3 transaction in package",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686851459",
      "id" : 686851459,
      "line" : 182,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4Njg1MTQ1OQ==",
      "original_commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "original_line" : 182,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 13,
      "pull_request_review_id" : 727476788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-11T13:52:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686851459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686854062"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686854062"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "^ This description or a short summary of it would be good in place of the \"bushy\" comment",
      "commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "created_at" : "2021-08-11T13:53:36Z",
      "diff_hunk" : "@@ -304,6 +305,109 @@ def test_descendant_limits(self):\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n         node.generate(1)\n \n+    def test_descendant_limits_bushy(self):\n+        \"\"\"Create A bushy Package with 24 transaction in mempool and 3 transaction in package\n+                              M1a\n+                             ^  ^\n+                            ^    M2a\n+            M1b            ^       .\n+              ^           ^         .\n+               ^         ^           ^\n+                ^       ^            M23a\n+                 ^     ^\n+                  ^   P1\n+                   ^ ^  ^\n+                    P2   P3\n+\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)\n+        \"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686854062",
      "id" : 686854062,
      "in_reply_to_id" : 679691371,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4Njg1NDA2Mg==",
      "original_commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "original_line" : 325,
      "original_position" : 29,
      "original_start_line" : 308,
      "path" : "test/functional/rpc_packages.py",
      "position" : null,
      "pull_request_review_id" : 727515348,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-08-11T13:53:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686854062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Another suggestion (probably for a different PR): This doesn't matter _that_ much, but we have quite a few of the same lines repeated in this test. Given how many OP_TRUE spends there are, I think it'd be good to either add a OP_TRUE variation of `make_chain` to wallet.py or, better yet, make all those functions methods of `MiniWallet`.",
      "created_at" : "2021-08-11T13:54:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-896847328",
      "id" : 896847328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5841dM3g",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-11T13:54:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/896847328",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686883715"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686883715"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right now the test doesn't utilize M1b at all - it should test that the package [P1, P2] passes but [P1, P2, P3] fails.",
      "commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "created_at" : "2021-08-11T14:25:08Z",
      "diff_hunk" : "@@ -304,6 +305,109 @@ def test_descendant_limits(self):\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n         node.generate(1)\n \n+    def test_descendant_limits_bushy(self):\n+        \"\"\"Create A bushy Package with 24 transaction in mempool and 3 transaction in package\n+                              M1a\n+                             ^  ^\n+                            ^    M2a\n+            M1b            ^       .\n+              ^           ^         .\n+               ^         ^           ^\n+                ^       ^            M23a\n+                 ^     ^\n+                  ^   P1\n+                   ^ ^  ^\n+                    P2   P3\n+\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)\n+        \"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686883715",
      "id" : 686883715,
      "in_reply_to_id" : 679691371,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4Njg4MzcxNQ==",
      "original_commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "original_line" : 325,
      "original_position" : 29,
      "original_start_line" : 308,
      "path" : "test/functional/rpc_packages.py",
      "position" : null,
      "pull_request_review_id" : 727555894,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-08-11T14:25:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686883715",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686884160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686884160"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This test would fail regardless of whether M1b exists or not (since M1a has 23 descendants in the mempool and 3 descendants in the package). It doesn't seem to me to be testing an edgecase that isn't already covered by the other tests in rpc_packages.py.",
      "commit_id" : "2bc8b5a2c5bd290591e4757e7964a23ed9e79ec9",
      "created_at" : "2021-08-11T14:25:37Z",
      "diff_hunk" : "@@ -304,6 +305,109 @@ def test_descendant_limits(self):\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n         node.generate(1)\n \n+    def test_descendant_limits_bushy(self):\n+        \"\"\"Create A bushy Package with 24 transaction in mempool and 3 transaction in package\n+                              M1a\n+                             ^  ^\n+                            ^    M2a\n+            M1b            ^       .\n+              ^           ^         .\n+               ^         ^           ^\n+                ^       ^            M23a\n+                 ^     ^\n+                  ^   P1\n+                   ^ ^  ^\n+                    P2   P3\n+\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)\n+        \"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r686884160",
      "id" : 686884160,
      "in_reply_to_id" : 679691371,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4Njg4NDE2MA==",
      "original_commit_id" : "c18188e96204f9264e2ed64ab5e53f3abdd137e5",
      "original_line" : 325,
      "original_position" : 29,
      "original_start_line" : 308,
      "path" : "test/functional/rpc_packages.py",
      "position" : null,
      "pull_request_review_id" : 727556492,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-08-11T14:25:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/686884160",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r687545626"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687545626"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Did you consider the suggestion about asserting success for [P1, P3] but failure for [P1, P2, P3] ?",
      "commit_id" : "4fd79792dd547b465dc8f5e9ec37073598db4b8e",
      "created_at" : "2021-08-12T09:28:23Z",
      "diff_hunk" : "@@ -177,6 +179,102 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create a Package with 24 transaction in mempool and 3 transaction in package\n+                      M1a\n+                     ^  ^\n+                   M2a   ^\n+                   .      ^\n+                  .        ^        M1b\n+                 .          ^       ^\n+                M23a         ^     ^\n+                              ^   ^\n+                               ^ ^\n+                               P1\n+                              ^  ^\n+                             P2   P3\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)\n+        \"\"\"\n+\n+        node = self.nodes[0]\n+        package_hex = []\n+        parents_tx = []\n+        values = []\n+        scripts = []\n+        # M1a\n+        first_coin_a = self.coins.pop()\n+        parent_value = (first_coin_a[\"amount\"] - DEFAULT_FEE) / 2 # Deduct reasonable fee and make 2 outputs\n+        inputs = [{\"txid\": first_coin_a[\"txid\"], \"vout\": 0}]\n+        outputs = [{self.address : parent_value}, {ADDRESS_BCRT1_P2WSH_OP_TRUE : parent_value}]\n+        rawtx = node.createrawtransaction(inputs, outputs)\n+\n+        parent_signed = node.signrawtransactionwithkey(hexstring=rawtx, privkeys=self.privkeys)\n+        assert parent_signed[\"complete\"]\n+        parent_tx = tx_from_hex(parent_signed[\"hex\"])\n+        parent_txid = parent_tx.rehash()\n+        node.sendrawtransaction(parent_signed[\"hex\"])\n+\n+        # Chain M2a...M23a\n+        spk = parent_tx.vout[0].scriptPubKey.hex()\n+        value = parent_value\n+        txid = parent_txid\n+        for i in range(22): # M2a... M23a\n+            (tx, txhex, value, spk) = make_chain(node, self.address, self.privkeys, txid, value, 0, spk)\n+            txid = tx.rehash()\n+            node.sendrawtransaction(txhex)\n+\n+        # P1\n+        value_p1 = (parent_value - DEFAULT_FEE) / 2 # Deduct reasonable fee and make 2 outputs\n+        inputs_p1 = [{\"txid\": parent_txid, \"vout\": 1}]\n+        outputs_p1 = [{self.address : value_p1}, {ADDRESS_BCRT1_P2WSH_OP_TRUE : value_p1}]\n+        rawtx_p1 = node.createrawtransaction(inputs_p1, outputs_p1)\n+        tx_child_p1 = tx_from_hex(rawtx_p1)\n+        tx_child_p1.wit.vtxinwit = [CTxInWitness()]\n+        tx_child_p1.wit.vtxinwit[0].scriptWitness.stack = [CScript([OP_TRUE])]\n+        tx_child_p1_hex = tx_child_p1.serialize().hex()\n+        txid_child_p1 = tx_child_p1.rehash()\n+        package_hex.append(tx_child_p1_hex)\n+        parents_tx.append(tx_child_p1)\n+        values.append(value_p1)\n+        scripts.append(tx_child_p1.vout[0].scriptPubKey.hex())\n+\n+        # P3\n+        value_p3 = value_p1 - DEFAULT_FEE\n+        rawtx_p3 = node.createrawtransaction([{\"txid\": txid_child_p1, \"vout\": 1}], {self.address : value_p3})\n+        tx_child_p3 = tx_from_hex(rawtx_p3)\n+        tx_child_p3.wit.vtxinwit = [CTxInWitness()]\n+        tx_child_p3.wit.vtxinwit[0].scriptWitness.stack = [CScript([OP_TRUE])]\n+        tx_child_p3_hex = tx_child_p3.serialize().hex()\n+        package_hex.append(tx_child_p3_hex)\n+\n+        # M1b\n+        first_coin_b = self.coins.pop()\n+        spk = None\n+        txid = first_coin_b[\"txid\"]\n+        value = first_coin_b[\"amount\"]\n+        (tx, txhex, value, spk) = make_chain(node, self.address, self.privkeys, txid, value, 0, spk)\n+        txid = tx.rehash()\n+        node.sendrawtransaction(txhex)\n+        parents_tx.append(tx)\n+        values.append(value)\n+        scripts.append(spk)\n+\n+        # P2\n+        child_hex = create_child_with_parents(node, self.address, self.privkeys, parents_tx, values, scripts)\n+        package_hex.append(child_hex)\n+\n+        assert_equal(24, node.getmempoolinfo()[\"size\"])\n+        assert_equal(3, len(package_hex))\n+        testres = node.testmempoolaccept(rawtxs=package_hex)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r687545626",
      "id" : 687545626,
      "line" : 270,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4NzU0NTYyNg==",
      "original_commit_id" : "4fd79792dd547b465dc8f5e9ec37073598db4b8e",
      "original_line" : 270,
      "original_position" : 108,
      "original_start_line" : null,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 108,
      "pull_request_review_id" : 728380093,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-12T09:29:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687545626",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r687546339"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687546339"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This comment/diagram is now incorrect - M1b is the parent of P2, not P1",
      "commit_id" : "4fd79792dd547b465dc8f5e9ec37073598db4b8e",
      "created_at" : "2021-08-12T09:29:19Z",
      "diff_hunk" : "@@ -177,6 +179,102 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create a Package with 24 transaction in mempool and 3 transaction in package\n+                      M1a\n+                     ^  ^\n+                   M2a   ^\n+                   .      ^\n+                  .        ^        M1b\n+                 .          ^       ^\n+                M23a         ^     ^\n+                              ^   ^\n+                               ^ ^\n+                               P1\n+                              ^  ^\n+                             P2   P3\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r687546339",
      "id" : 687546339,
      "line" : 198,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4NzU0NjMzOQ==",
      "original_commit_id" : "4fd79792dd547b465dc8f5e9ec37073598db4b8e",
      "original_line" : 198,
      "original_position" : 36,
      "original_start_line" : 184,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 36,
      "pull_request_review_id" : 728380093,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : 184,
      "start_side" : "RIGHT",
      "updated_at" : "2021-08-12T09:29:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687546339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r687979237"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687979237"
         }
      },
      "author_association" : "NONE",
      "body" : "I have removed M1b as it was creating more confusion and as jnewbery pointed out the test would still fail regardless of M1b being present there and it was not adding any edgecase that it not already present.",
      "commit_id" : "5a7050c63c1a574abf336a47b18e154554a4020a",
      "created_at" : "2021-08-12T18:17:01Z",
      "diff_hunk" : "@@ -177,6 +179,102 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create a Package with 24 transaction in mempool and 3 transaction in package\n+                      M1a\n+                     ^  ^\n+                   M2a   ^\n+                   .      ^\n+                  .        ^        M1b\n+                 .          ^       ^\n+                M23a         ^     ^\n+                              ^   ^\n+                               ^ ^\n+                               P1\n+                              ^  ^\n+                             P2   P3\n+        P1 has M1a as a mempool ancestor, P2 has only M1b as in-mempool ancestor whereas P3 has\n+        no in-mempool ancestors, but when combined both P2 and P3 have M1a as an ancestor and\n+        M1a exceeds descendant_limits (23 in-mempool descendants + 3 in-package descendants)\n+        \"\"\"\n+\n+        node = self.nodes[0]\n+        package_hex = []\n+        parents_tx = []\n+        values = []\n+        scripts = []\n+        # M1a\n+        first_coin_a = self.coins.pop()\n+        parent_value = (first_coin_a[\"amount\"] - DEFAULT_FEE) / 2 # Deduct reasonable fee and make 2 outputs\n+        inputs = [{\"txid\": first_coin_a[\"txid\"], \"vout\": 0}]\n+        outputs = [{self.address : parent_value}, {ADDRESS_BCRT1_P2WSH_OP_TRUE : parent_value}]\n+        rawtx = node.createrawtransaction(inputs, outputs)\n+\n+        parent_signed = node.signrawtransactionwithkey(hexstring=rawtx, privkeys=self.privkeys)\n+        assert parent_signed[\"complete\"]\n+        parent_tx = tx_from_hex(parent_signed[\"hex\"])\n+        parent_txid = parent_tx.rehash()\n+        node.sendrawtransaction(parent_signed[\"hex\"])\n+\n+        # Chain M2a...M23a\n+        spk = parent_tx.vout[0].scriptPubKey.hex()\n+        value = parent_value\n+        txid = parent_txid\n+        for i in range(22): # M2a... M23a\n+            (tx, txhex, value, spk) = make_chain(node, self.address, self.privkeys, txid, value, 0, spk)\n+            txid = tx.rehash()\n+            node.sendrawtransaction(txhex)\n+\n+        # P1\n+        value_p1 = (parent_value - DEFAULT_FEE) / 2 # Deduct reasonable fee and make 2 outputs\n+        inputs_p1 = [{\"txid\": parent_txid, \"vout\": 1}]\n+        outputs_p1 = [{self.address : value_p1}, {ADDRESS_BCRT1_P2WSH_OP_TRUE : value_p1}]\n+        rawtx_p1 = node.createrawtransaction(inputs_p1, outputs_p1)\n+        tx_child_p1 = tx_from_hex(rawtx_p1)\n+        tx_child_p1.wit.vtxinwit = [CTxInWitness()]\n+        tx_child_p1.wit.vtxinwit[0].scriptWitness.stack = [CScript([OP_TRUE])]\n+        tx_child_p1_hex = tx_child_p1.serialize().hex()\n+        txid_child_p1 = tx_child_p1.rehash()\n+        package_hex.append(tx_child_p1_hex)\n+        parents_tx.append(tx_child_p1)\n+        values.append(value_p1)\n+        scripts.append(tx_child_p1.vout[0].scriptPubKey.hex())\n+\n+        # P3\n+        value_p3 = value_p1 - DEFAULT_FEE\n+        rawtx_p3 = node.createrawtransaction([{\"txid\": txid_child_p1, \"vout\": 1}], {self.address : value_p3})\n+        tx_child_p3 = tx_from_hex(rawtx_p3)\n+        tx_child_p3.wit.vtxinwit = [CTxInWitness()]\n+        tx_child_p3.wit.vtxinwit[0].scriptWitness.stack = [CScript([OP_TRUE])]\n+        tx_child_p3_hex = tx_child_p3.serialize().hex()\n+        package_hex.append(tx_child_p3_hex)\n+\n+        # M1b\n+        first_coin_b = self.coins.pop()\n+        spk = None\n+        txid = first_coin_b[\"txid\"]\n+        value = first_coin_b[\"amount\"]\n+        (tx, txhex, value, spk) = make_chain(node, self.address, self.privkeys, txid, value, 0, spk)\n+        txid = tx.rehash()\n+        node.sendrawtransaction(txhex)\n+        parents_tx.append(tx)\n+        values.append(value)\n+        scripts.append(spk)\n+\n+        # P2\n+        child_hex = create_child_with_parents(node, self.address, self.privkeys, parents_tx, values, scripts)\n+        package_hex.append(child_hex)\n+\n+        assert_equal(24, node.getmempoolinfo()[\"size\"])\n+        assert_equal(3, len(package_hex))\n+        testres = node.testmempoolaccept(rawtxs=package_hex)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r687979237",
      "id" : 687979237,
      "in_reply_to_id" : 687545626,
      "line" : 252,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4Nzk3OTIzNw==",
      "original_commit_id" : "4fd79792dd547b465dc8f5e9ec37073598db4b8e",
      "original_line" : 252,
      "original_position" : 108,
      "original_start_line" : null,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 90,
      "pull_request_review_id" : 728936039,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-12T18:17:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/687979237",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32807799?v=4",
         "events_url" : "https://api.github.com/users/ritickgoenka/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ritickgoenka/followers",
         "following_url" : "https://api.github.com/users/ritickgoenka/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ritickgoenka/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ritickgoenka",
         "id" : 32807799,
         "login" : "ritickgoenka",
         "node_id" : "MDQ6VXNlcjMyODA3Nzk5",
         "organizations_url" : "https://api.github.com/users/ritickgoenka/orgs",
         "received_events_url" : "https://api.github.com/users/ritickgoenka/received_events",
         "repos_url" : "https://api.github.com/users/ritickgoenka/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ritickgoenka/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ritickgoenka/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ritickgoenka"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r689434394"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689434394"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n        (22 in-mempool descendants + 3 in-package descendants, a total of 26 including itself).\r\n```",
      "commit_id" : "5a7050c63c1a574abf336a47b18e154554a4020a",
      "created_at" : "2021-08-16T10:55:12Z",
      "diff_hunk" : "@@ -177,6 +179,84 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create a Package with 23 transaction in mempool and 3 transaction in package\n+                      M1a\n+                     ^  ^\n+                   M2a   ^\n+                   .      ^\n+                  .        ^\n+                 .          ^\n+                M23a         ^\n+                              ^\n+                              P1\n+                             ^  ^\n+                            P2   P3\n+        P1 has M1a as a mempool ancestor, P2 and P3 have no in-mempool ancestors, but when\n+        combined both P2 and P3 have M1a as an ancestor and M1a exceeds descendant_limits\n+        (23 in-mempool descendants + 3 in-package descendants)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r689434394",
      "id" : 689434394,
      "line" : 197,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTQzNDM5NA==",
      "original_commit_id" : "5a7050c63c1a574abf336a47b18e154554a4020a",
      "original_line" : 197,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 35,
      "pull_request_review_id" : 730578286,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-16T10:57:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689434394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "PR description needs to be updated",
      "created_at" : "2021-08-16T12:11:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-899460878",
      "id" : 899460878,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5841nK8O",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-16T12:11:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899460878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I still don't understand what logic this is testing that isn't already covered by the `test_desc_count_limits()` subtest.",
      "created_at" : "2021-08-16T13:33:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-899515089",
      "id" : 899515089,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5841nYLR",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-16T13:33:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899515089",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> I still don't understand what logic this is testing that isn't already covered by the `test_desc_count_limits()` subtest.\r\n\r\nIt is testing if the second generation in Package transactions are considered while checking Descendant count limits. It is analogous to the 'test_anc_count_limits_2()' subtest for Ancestor count limits. ",
      "created_at" : "2021-08-16T17:11:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-899675145",
      "id" : 899675145,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5841n_QJ",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-16T17:11:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899675145",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32807799?v=4",
         "events_url" : "https://api.github.com/users/ritickgoenka/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ritickgoenka/followers",
         "following_url" : "https://api.github.com/users/ritickgoenka/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ritickgoenka/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ritickgoenka",
         "id" : 32807799,
         "login" : "ritickgoenka",
         "node_id" : "MDQ6VXNlcjMyODA3Nzk5",
         "organizations_url" : "https://api.github.com/users/ritickgoenka/orgs",
         "received_events_url" : "https://api.github.com/users/ritickgoenka/received_events",
         "repos_url" : "https://api.github.com/users/ritickgoenka/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ritickgoenka/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ritickgoenka/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ritickgoenka"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@glozow has pointed out that this scenario is for a transaction to fail its descendant limit count due to a combination of mempool descendants, package direct descendants, and package indirect descendants, which seems like a reasonable thing to test.\r\n\r\nI think the transaction P3 is unnecessary, since the package would fail with just P2. It's good for a test to fail at the edge case (i.e. the package would be accepted if you removed just one transaction).\r\n\r\nI'd also recommend you remove the image from the PR description and replace it with an ascii drawing. The PR description is included in the merge commit, so it's best if it's plain text without attachments.",
      "created_at" : "2021-08-17T15:56:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#issuecomment-900420385",
      "id" : 900420385,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22582",
      "node_id" : "IC_kwDOABII5841q1Mh",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-17T15:56:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900420385",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r692345308"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692345308"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[test] checks descendants limtis for second generation Package descendants\" (e0f92f30954438540e6a676af77d17fbb963ca5d)\r\n\r\nMay be paranoid, but could be good to check `assert_equal(len(testres), len(package_hex))`",
      "commit_id" : "2ef27b5b784befb85fd139abf9761c5121bcf08a",
      "created_at" : "2021-08-19T17:33:03Z",
      "diff_hunk" : "@@ -177,6 +179,73 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create a Package with 24 transaction in mempool and 2 transaction in package:\n+                      M1\n+                     ^  ^\n+                   M2    ^\n+                   .      ^\n+                  .        ^\n+                 .          ^\n+                M24          ^\n+                              ^\n+                              P1\n+                              ^\n+                              P2\n+        P1 has M1 as a mempool ancestor, P2 has no in-mempool ancestors, but when\n+        combined P2 has M1 as an ancestor and M1 exceeds descendant_limits(23 in-mempool\n+        descendants + 2 in-package descendants, a total of 26 including itself).\n+        \"\"\"\n+\n+        node = self.nodes[0]\n+        package_hex = []\n+        # M1\n+        first_coin_a = self.coins.pop()\n+        parent_value = (first_coin_a[\"amount\"] - DEFAULT_FEE) / 2 # Deduct reasonable fee and make 2 outputs\n+        inputs = [{\"txid\": first_coin_a[\"txid\"], \"vout\": 0}]\n+        outputs = [{self.address : parent_value}, {ADDRESS_BCRT1_P2WSH_OP_TRUE : parent_value}]\n+        rawtx = node.createrawtransaction(inputs, outputs)\n+\n+        parent_signed = node.signrawtransactionwithkey(hexstring=rawtx, privkeys=self.privkeys)\n+        assert parent_signed[\"complete\"]\n+        parent_tx = tx_from_hex(parent_signed[\"hex\"])\n+        parent_txid = parent_tx.rehash()\n+        node.sendrawtransaction(parent_signed[\"hex\"])\n+\n+        # Chain M2...M24\n+        spk = parent_tx.vout[0].scriptPubKey.hex()\n+        value = parent_value\n+        txid = parent_txid\n+        for i in range(23): # M2...M24\n+            (tx, txhex, value, spk) = make_chain(node, self.address, self.privkeys, txid, value, 0, spk)\n+            txid = tx.rehash()\n+            node.sendrawtransaction(txhex)\n+\n+        # P1\n+        value_p1 = (parent_value - DEFAULT_FEE)\n+        rawtx_p1 = node.createrawtransaction([{\"txid\": parent_txid, \"vout\": 1}], [{self.address : value_p1}])\n+        tx_child_p1 = tx_from_hex(rawtx_p1)\n+        tx_child_p1.wit.vtxinwit = [CTxInWitness()]\n+        tx_child_p1.wit.vtxinwit[0].scriptWitness.stack = [CScript([OP_TRUE])]\n+        tx_child_p1_hex = tx_child_p1.serialize().hex()\n+        txid_child_p1 = tx_child_p1.rehash()\n+        package_hex.append(tx_child_p1_hex)\n+        tx_child_p1_spk = tx_child_p1.vout[0].scriptPubKey.hex()\n+\n+        # P2\n+        (_, tx_child_p2_hex, _, _) = make_chain(node, self.address, self.privkeys, txid_child_p1, value_p1, 0, tx_child_p1_spk)\n+        package_hex.append(tx_child_p2_hex)\n+\n+        assert_equal(24, node.getmempoolinfo()[\"size\"])\n+        assert_equal(2, len(package_hex))\n+        testres = node.testmempoolaccept(rawtxs=package_hex)\n+        for txres in testres:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r692345308",
      "id" : 692345308,
      "line" : 242,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjM0NTMwOA==",
      "original_commit_id" : "2ef27b5b784befb85fd139abf9761c5121bcf08a",
      "original_line" : 242,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 80,
      "pull_request_review_id" : 734284021,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-19T17:36:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692345308",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r705331521"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/705331521"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            tx, txhex, value, spk = make_chain(node, self.address, self.privkeys, txid, value, 0, spk)\r\n```",
      "commit_id" : "fa7db1cbf7e8400b625fccd5757f8e1b200796bd",
      "created_at" : "2021-09-09T13:27:45Z",
      "diff_hunk" : "@@ -177,6 +179,74 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create a Package with 24 transaction in mempool and 2 transaction in package:\n+                      M1\n+                     ^  ^\n+                   M2    ^\n+                   .      ^\n+                  .        ^\n+                 .          ^\n+                M24          ^\n+                              ^\n+                              P1\n+                              ^\n+                              P2\n+        P1 has M1 as a mempool ancestor, P2 has no in-mempool ancestors, but when\n+        combined P2 has M1 as an ancestor and M1 exceeds descendant_limits(23 in-mempool\n+        descendants + 2 in-package descendants, a total of 26 including itself).\n+        \"\"\"\n+\n+        node = self.nodes[0]\n+        package_hex = []\n+        # M1\n+        first_coin_a = self.coins.pop()\n+        parent_value = (first_coin_a[\"amount\"] - DEFAULT_FEE) / 2 # Deduct reasonable fee and make 2 outputs\n+        inputs = [{\"txid\": first_coin_a[\"txid\"], \"vout\": 0}]\n+        outputs = [{self.address : parent_value}, {ADDRESS_BCRT1_P2WSH_OP_TRUE : parent_value}]\n+        rawtx = node.createrawtransaction(inputs, outputs)\n+\n+        parent_signed = node.signrawtransactionwithkey(hexstring=rawtx, privkeys=self.privkeys)\n+        assert parent_signed[\"complete\"]\n+        parent_tx = tx_from_hex(parent_signed[\"hex\"])\n+        parent_txid = parent_tx.rehash()\n+        node.sendrawtransaction(parent_signed[\"hex\"])\n+\n+        # Chain M2...M24\n+        spk = parent_tx.vout[0].scriptPubKey.hex()\n+        value = parent_value\n+        txid = parent_txid\n+        for i in range(23): # M2...M24\n+            (tx, txhex, value, spk) = make_chain(node, self.address, self.privkeys, txid, value, 0, spk)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r705331521",
      "id" : 705331521,
      "line" : 220,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNTMzMTUyMQ==",
      "original_commit_id" : "fa7db1cbf7e8400b625fccd5757f8e1b200796bd",
      "original_line" : 220,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 58,
      "pull_request_review_id" : 750339076,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-09T13:35:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/705331521",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r705337693"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/705337693"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Consider using a linter like [flake8](https://flake8.pycqa.org/en/latest/) or a formatter like [black](https://github.com/psf/black) to catch/fix PEP8 violations:\r\n\r\n```suggestion\r\n        outputs = [{self.address: parent_value}, {ADDRESS_BCRT1_P2WSH_OP_TRUE: parent_value}]\r\n```",
      "commit_id" : "fa7db1cbf7e8400b625fccd5757f8e1b200796bd",
      "created_at" : "2021-09-09T13:34:25Z",
      "diff_hunk" : "@@ -177,6 +179,74 @@ def test_desc_count_limits(self):\n         node.generate(1)\n         assert all([res[\"allowed\"] for res in node.testmempoolaccept(rawtxs=package_hex)])\n \n+    def test_desc_count_limits_2(self):\n+        \"\"\"Create a Package with 24 transaction in mempool and 2 transaction in package:\n+                      M1\n+                     ^  ^\n+                   M2    ^\n+                   .      ^\n+                  .        ^\n+                 .          ^\n+                M24          ^\n+                              ^\n+                              P1\n+                              ^\n+                              P2\n+        P1 has M1 as a mempool ancestor, P2 has no in-mempool ancestors, but when\n+        combined P2 has M1 as an ancestor and M1 exceeds descendant_limits(23 in-mempool\n+        descendants + 2 in-package descendants, a total of 26 including itself).\n+        \"\"\"\n+\n+        node = self.nodes[0]\n+        package_hex = []\n+        # M1\n+        first_coin_a = self.coins.pop()\n+        parent_value = (first_coin_a[\"amount\"] - DEFAULT_FEE) / 2 # Deduct reasonable fee and make 2 outputs\n+        inputs = [{\"txid\": first_coin_a[\"txid\"], \"vout\": 0}]\n+        outputs = [{self.address : parent_value}, {ADDRESS_BCRT1_P2WSH_OP_TRUE : parent_value}]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22582#discussion_r705337693",
      "id" : 705337693,
      "line" : 206,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNTMzNzY5Mw==",
      "original_commit_id" : "fa7db1cbf7e8400b625fccd5757f8e1b200796bd",
      "original_line" : 206,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "test/functional/mempool_package_limits.py",
      "position" : 44,
      "pull_request_review_id" : 750339076,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22582",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-09T13:35:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/705337693",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
