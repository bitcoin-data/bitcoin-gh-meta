[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ping @jnewbery, since https://github.com/bitcoin/bitcoin/pull/21866#issuecomment-858536566 :relaxed: ",
      "created_at" : "2021-07-27T20:02:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-887796309",
      "id" : 887796309,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58406rJV",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-27T20:02:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887796309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Globals must fall!",
      "created_at" : "2021-07-27T21:48:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-887856830",
      "id" : 887856830,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5840656-",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-27T21:48:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887856830",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24232](https://github.com/bitcoin/bitcoin/pull/24232) (assumeutxo: add init and completion logic by jamesob)\n* [#24008](https://github.com/bitcoin/bitcoin/pull/24008) (assumeutxo: net_processing changes by jamesob)\n* [#23443](https://github.com/bitcoin/bitcoin/pull/23443) (p2p: Erlay support signaling by naumenkogs)\n* [#22087](https://github.com/bitcoin/bitcoin/pull/22087) (Validate port-options by amadeuszpawlik)\n* [#20030](https://github.com/bitcoin/bitcoin/pull/20030) (validation: Remove useless call to mempool->clear() by MarcoFalke)\n* [#19888](https://github.com/bitcoin/bitcoin/pull/19888) (rpc, test: Improve getblockstats for unspendables by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-07-28T10:06:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-888183043",
      "id" : 888183043,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58408JkD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888183043/reactions"
      },
      "updated_at" : "2022-04-27T19:09:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888183043",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680503657"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680503657"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hard NACK -- the signatures for the two versions of `DeploymentActiveAfter` (and `..At`) should only differ by whether they accept a `DeploymentPos` or a `BuriedDeployment`, otherwise we're back to having to edit bunches of call sites when burying deployments.\r\n\r\nBUT... I think you can get the result you're trying for by making `DeploymentActiveAfter` (and `..At`) inline member functions of `BlockManager`. Proof of concept at https://github.com/ajtowns/bitcoin/commits/202108-deplotmentstatus-blockmanager\r\n\r\nWould it be feasible to move `BlockManager` to its own module to reduce the amount of stuff validation.cpp does? Giving BlockManager a `CChainParams` member reference and having `CChainState` and `ChainstateManager` reference it via their BlockManager references, and also removing the `Consensus::Params` and `CChainParams` params from bunches of functions (including the `DeploymentActive..` ones) seems like it would be a win.",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T12:23:58Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680503657",
      "id" : 680503657,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUwMzY1Nw==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 719657071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T13:59:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680503657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680508909"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680508909"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note that there shouldn't be any logical need for this to be cleared here -- the cached information doesn't become invalid when we load up different blocks, only if the consensus parameters are changed.",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T13:06:26Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680508909",
      "id" : 680508909,
      "line" : 4111,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUwODkwOQ==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 4109,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 577,
      "pull_request_review_id" : 719657071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T13:58:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680508909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680513805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680513805"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should be `auto& i : warningcache` ??",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T13:44:15Z",
      "diff_hunk" : "@@ -4107,8 +4107,8 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    for (int b = 0; b < VERSIONBITS_NUM_BITS; b++) {\n-        warningcache[b].clear();\n+    for (auto i : warningcache) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680513805",
      "id" : 680513805,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUxMzgwNQ==",
      "original_commit_id" : "6b0a3bc7bd80a8e0dc1f59dbc89bd211ac6a7c1e",
      "original_line" : 4110,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 719657071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T13:58:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680513805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680518852"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680518852"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Wouldn't another class in validation be better suited to host the deployment status? My goal was to move BlockManger to node/storage and have it deal with storage only, not validation. ",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T14:24:19Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680518852",
      "id" : 680518852,
      "in_reply_to_id" : 680503657,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUxODg1Mg==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 719668013,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T14:24:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680518852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680522667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680522667"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke Maybe? I look at deployment status as an expansion of Consensus::Params -- so more as input to validation than a result of it. If we switch to using the coinbase witness nonce for deployment signalling we'd need to change the way we store blocks so that it's easy to access that info without having to load every signalling block from disk, so it's kind-of storage related in that sense?",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-01T14:52:31Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680522667",
      "id" : 680522667,
      "in_reply_to_id" : 680503657,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MDUyMjY2Nw==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 719670647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-01T14:52:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/680522667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r682041105"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/682041105"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> the signatures for the two versions of `DeploymentActiveAfter` (and `..At`) should only differ by whether they accept a `DeploymentPos` or a `BuriedDeployment`, otherwise we're back to having to edit bunches of call sites when burying deployments.\r\n\r\nOh I did not realize that this was the case! Note to self: add a code comment documenting this.\r\n\r\n> BUT... I think you can get the result you're trying for by making `DeploymentActiveAfter` (and `..At`) inline member functions of `BlockManager`. Proof of concept at https://github.com/ajtowns/bitcoin/commits/202108-deplotmentstatus-blockmanager\r\n\r\nThis looks good to me, and it seems like they would eventually end up having to interact with `BlockManager` anyway according to the following?\r\n\r\n> If we switch to using the coinbase witness nonce for deployment signalling we'd need to change the way we store blocks so that it's easy to access that info without having to load every signalling block from disk, so it's kind-of storage related in that sense?\r\n\r\n-----\r\n\r\n> Would it be feasible to move `BlockManager` to its own module to reduce the amount of stuff validation.cpp does? Giving BlockManager a `CChainParams` member reference and having `CChainState` and `ChainstateManager` reference it via their BlockManager references, and also removing the `Consensus::Params` and `CChainParams` params from bunches of functions (including the `DeploymentActive..` ones) seems like it would be a win.\r\n\r\nYes I think as part of some other work I'll have to pull validation apart anyway, I will look into this!",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-03T19:27:49Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r682041105",
      "id" : 682041105,
      "in_reply_to_id" : 680503657,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MjA0MTEwNQ==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 721567946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-03T19:27:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/682041105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r694260466"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/694260466"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"No more heap BlockIndices\" (6a897c0601dff4f116b1ab223595c5c2fac0e7a3)\r\n\r\nComment seems to lack a little context, maybe prefix with \"Because validation code takes pointers to the map's CBlockIndex objects, if we ever switch...\"",
      "commit_id" : "f741623c25455c20bff9eb1ddd10a4ac84dc5655",
      "created_at" : "2021-08-23T19:46:31Z",
      "diff_hunk" : "@@ -107,7 +107,12 @@ enum class SynchronizationState {\n };\n \n extern RecursiveMutex cs_main;\n-typedef std::unordered_map<uint256, CBlockIndex*, BlockHasher> BlockMap;\n+\n+// If we ever switch to another associative container, we need to either use a",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r694260466",
      "id" : 694260466,
      "line" : 111,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NDI2MDQ2Ng==",
      "original_commit_id" : "6a897c0601dff4f116b1ab223595c5c2fac0e7a3",
      "original_line" : 111,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 14,
      "pull_request_review_id" : 736503538,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-23T19:51:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/694260466",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed f741623c25 -> 6e6472e6dc\r\n- Address https://github.com/bitcoin/bitcoin/pull/22564#discussion_r694260466\r\n- Address https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680513805",
      "created_at" : "2021-08-24T17:57:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-904855311",
      "id" : 904855311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58417v8P",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-24T17:57:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/904855311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 6e6472e6dc -> 6bb9ed3f62:\r\n- Rebased on master",
      "created_at" : "2021-08-24T18:45:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-904886902",
      "id" : 904886902,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584173p2",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-24T18:45:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/904886902",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695141648"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695141648"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is this the same case for `warningcache` as well? If so, perhaps we'll just move the clearing logic to `SelectParams` and not move these two structures into `BlockManager`?",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-24T19:29:37Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695141648",
      "id" : 695141648,
      "in_reply_to_id" : 680508909,
      "line" : 4091,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTE0MTY0OA==",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 4091,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 577,
      "pull_request_review_id" : 737608619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-24T19:29:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695141648",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695824018"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695824018"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move pindexBest{Header,Invalid} to BlockManager\" (9fdf6825bc6a3a27b23b7a1015afc33b3a62effd)\r\n\r\nIs there a reason these are moved to BlockManager class instead of ChainstateManager class? I don't see anywhere where the blockmanager class itself is accessing these members, and I don't see any references to this through any blockmanager reference except the ChainStateManager::m_blockman one. These are also set from chain state not block state, so it seems like these are more related to chain state functionality than  in block manager. Maybe ideally it would be a would be a private ChainStateManager member?\r\n\r\nI'm not sure about this and maybe it doesn't matter, but it would be good to at least hint at what the thinking is behind the move destination is in the commit description.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T14:42:37Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695824018",
      "id" : 695824018,
      "line" : 435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTgyNDAxOA==",
      "original_commit_id" : "9fdf6825bc6a3a27b23b7a1015afc33b3a62effd",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 738449978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T15:51:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695824018",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695841110"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695841110"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move setDirty{BlockIndex,FileInfo} to BlockManager\" (feb62ff2a0af6fedfaa3078b1a512416cdf71264)\r\n\r\nShould just delete these old function declarations (now that they are member functions)",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T14:59:53Z",
      "diff_hunk" : "@@ -73,9 +73,9 @@ bool ReadRawBlockFromDisk(std::vector<uint8_t>& block, const FlatFilePos& pos, c\n bool ReadRawBlockFromDisk(std::vector<uint8_t>& block, const CBlockIndex* pindex, const CMessageHeader::MessageStartChars& message_start);\n \n bool UndoReadFromDisk(CBlockUndo& blockundo, const CBlockIndex* pindex);\n-bool WriteUndoDataForBlock(const CBlockUndo& blockundo, BlockValidationState& state, CBlockIndex* pindex, const CChainParams& chainparams);\n+// bool WriteUndoDataForBlock(const CBlockUndo& blockundo, BlockValidationState& state, CBlockIndex* pindex, const CChainParams& chainparams);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695841110",
      "id" : 695841110,
      "line" : 74,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTg0MTExMA==",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 76,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 39,
      "pull_request_review_id" : 738449978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T15:51:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695841110",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695846531"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695846531"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move setDirty{BlockIndex,FileInfo} to BlockManager\" (feb62ff2a0af6fedfaa3078b1a512416cdf71264)\r\n\r\nCan these clears which are moved from `UnloadBlockIndex` to `BlockManager::Unload` be done in a different commit before all the other changes in this commit? It's confusing because `UnloadBlockIndex` isn't even calling `BlockManager::Unload` directly, but indirectly through the `ChainstateManager::Unload` method. Another reason it would be nice to have the change in a standalone commit would be to describe what is motivating the move.\r\n\r\nAdditionally, maybe separately it would be good to flatten the existing call chain here, because it doesn't seem to make much sense outwardly and seems unnecessarily complex. It seems like `ChainstateManager::Unload` is only called one place and could be removed and inlined. Also `CChainState::UnloadBlockIndex` looks like it's only called one place and could be removed and inlined. Another reason it would be great to drop that one is the confusing name clash between the member function and the global function.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T15:05:44Z",
      "diff_hunk" : "@@ -3746,6 +3744,9 @@ void BlockManager::Unload() {\n \n     pindexBestInvalid = nullptr;\n     pindexBestHeader = nullptr;\n+\n+    setDirtyBlockIndex.clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695846531",
      "id" : 695846531,
      "line" : 3744,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTg0NjUzMQ==",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 3748,
      "original_position" : 133,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 508,
      "pull_request_review_id" : 738449978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T15:51:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695846531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695871478"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695871478"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move setDirty{BlockIndex,FileInfo} to BlockManager\" (feb62ff2a0af6fedfaa3078b1a512416cdf71264)\r\n\r\nMoving these variables to BlockManager makes more sense to me than moving pIndexBest variables in the prior commit, but it would helpful to say why this move destination makes sense in the commit description. Maybe \"Move these variables to block manager because they are used to update the block index on disk. In the future it might make sense move more logic responsible for updating and writing the block index to the block manager class and make these variables private instead of public.\"",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T15:32:40Z",
      "diff_hunk" : "@@ -432,6 +432,12 @@ class BlockManager\n     /** Best header we've seen so far (used for getheaders queries' starting points). */\n     CBlockIndex *pindexBestHeader = nullptr;\n \n+    /** Dirty block index entries. */\n+    std::set<CBlockIndex*> setDirtyBlockIndex;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695871478",
      "id" : 695871478,
      "line" : 441,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTg3MTQ3OA==",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 436,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 48,
      "pull_request_review_id" : 738449978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T15:51:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695871478",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695941754"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695941754"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I believe they are accessed by `BlockManager` here: https://github.com/bitcoin/bitcoin/blob/21438d55d553ae5bf3be7c0d4431aaf136db6c6b/src/validation.cpp#L3732-L3737\r\n\r\nAdditionally (and I'd like feedback on if this makes sense), it seems to me that variables whose type involve `CBlockIndex*` should likely live an die with the `BlockManager` since it owns the `BlockMap` entries to which these pointers are pointing.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T16:59:12Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695941754",
      "id" : 695941754,
      "in_reply_to_id" : 695824018,
      "line" : 435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTk0MTc1NA==",
      "original_commit_id" : "9fdf6825bc6a3a27b23b7a1015afc33b3a62effd",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 738604066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T16:59:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695941754",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695978717"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695978717"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> I believe they are accessed by `BlockManager` here:\r\n> \r\n> https://github.com/bitcoin/bitcoin/blob/21438d55d553ae5bf3be7c0d4431aaf136db6c6b/src/validation.cpp#L3732-L3737\r\n> \r\n> Additionally (and I'd like feedback on if this makes sense), it seems to me that variables whose type involve `CBlockIndex*` should likely live an die with the `BlockManager` since it owns the `BlockMap` entries to which these pointers are pointing.\r\n\r\nRegardless of what should happen with these two variables I would definitely push back against this logic. CBlockIndex pointers are used in all kinds of code that has nothing to do with the actual block index, just as convenient and easy way to refer to blocks. If you tried to move all CBlockIndex type variables into BlockManager, you would be moving validation logic and indexing logic (and even wallet logic prior to #10973) into the BlockManager class where it pretty clearly does not belong.\r\n\r\nI think class state should generally be located in the class accessing and updating that state. It doesn't usually make sense for one class to store state on behalf on another class that it never accesses or uses itself. And probably ideally, all of these classes would have private state that would not be directly manipulated by other classes at all.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T17:41:34Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695978717",
      "id" : 695978717,
      "in_reply_to_id" : 695824018,
      "line" : 435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTk3ODcxNw==",
      "original_commit_id" : "9fdf6825bc6a3a27b23b7a1015afc33b3a62effd",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 738655462,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T17:41:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695978717",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695990703"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695990703"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Looking at your link more it does make some sense to me to keep these variables here if they can be derived directly from block index data like that.\r\n\r\nThe boundaries are definitely a little blurry here and in longer run I'd be inclined to want to move this logic out of the Block Manager class so it is just responsible storing the index data and not interpreting it so much. In short run I would add additional `CBlockIndex*&best_header` and `CBlockIndex*&best_invalid_header` output parameters so the LoadBlockIndex can keep the same logic and just return the information.\r\n\r\nBut now that I see what motivated moving these variables here, I don't think it's crazy to keep the variables here either. So you should do what seems best to you, and thanks for clarifying!",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-25T17:58:17Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695990703",
      "id" : 695990703,
      "in_reply_to_id" : 695824018,
      "line" : 435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NTk5MDcwMw==",
      "original_commit_id" : "9fdf6825bc6a3a27b23b7a1015afc33b3a62effd",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 738670688,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T17:58:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/695990703",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r696827015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696827015"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"validation: Add missing cs_LastBlockFile locks in PruneAndFlush() and UnloadBlockIndex(). Add missing locking annotation for nLastBlockFile and fCheckForPruning.\" (ccd6ec5e620dbb3ae251b3511d00aaf3614e97da)\r\n\r\nI think `GUARDED_BY(cs_LastBlockFile)` should be added here to the `vinfoBlockFile` variable as well. The \"last block\" mutex name is confusing, but I believe the naming only ended up that way  because the vinfo variable was added in a later commit ed6d1a2c7be9d046d5e78330d5e163023a6b302a than the last block variables 5382bcf8cd23c36a435c29080770a79b5e28af42. From the code it looks pretty clearly like the mutex is meant to cover all the variables, and it seems to be always locked when accessing them (except during unloading/loading where other locks have been elided as well).",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-26T17:13:50Z",
      "diff_hunk" : "@@ -28,12 +28,12 @@ uint64_t nPruneTarget = 0;\n // TODO make namespace {\n RecursiveMutex cs_LastBlockFile;\n std::vector<CBlockFileInfo> vinfoBlockFile;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r696827015",
      "id" : 696827015,
      "line" : 29,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjgyNzAxNQ==",
      "original_commit_id" : "ccd6ec5e620dbb3ae251b3511d00aaf3614e97da",
      "original_line" : 30,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 10,
      "pull_request_review_id" : 739739848,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-26T17:14:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696827015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697576048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697576048"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"validation: Add missing cs_nBlockSequenceId lock in UnloadBlockIndex(). Add missing locking annotation for nBlockSequenceId.\" (7c3f21a5c16e83ef6baacbcd600d15a470ff1e5b)\r\n\r\nTwo notes for future improvements:\r\n\r\n- Looking at actual `nBlockSequenceId` uses, it is really just used as an atomic, and could be replaced with an atomic and the mutex could be eliminated with no change in behavior.\r\n- nBlockReverseSequenceId below should have GUARDED_BY(cs_main)",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-27T16:35:46Z",
      "diff_hunk" : "@@ -573,7 +573,7 @@ class CChainState\n      */\n     RecursiveMutex cs_nBlockSequenceId;\n     /** Blocks loaded from disk are assigned id 0, so start the counter at 1. */\n-    int32_t nBlockSequenceId = 1;\n+    int32_t nBlockSequenceId GUARDED_BY(cs_nBlockSequenceId) = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697576048",
      "id" : 697576048,
      "line" : 611,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzU3NjA0OA==",
      "original_commit_id" : "7c3f21a5c16e83ef6baacbcd600d15a470ff1e5b",
      "original_line" : 576,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 119,
      "pull_request_review_id" : 740704160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T17:08:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697576048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697585112"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697585112"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move cs_LastBlockFile guarded objects to BlockManager\" (ca77cd53abb455847094cecdc11b217c64166de8)\r\n\r\nShould fully remove this declaration and the one below",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-27T16:50:58Z",
      "diff_hunk" : "@@ -55,11 +55,11 @@ FILE* OpenBlockFile(const FlatFilePos& pos, bool fReadOnly = false);\n /** Translation to a filesystem path */\n fs::path GetBlockPosFilename(const FlatFilePos& pos);\n \n-/** Get block file info entry for one block file */\n-CBlockFileInfo* GetBlockFileInfo(size_t n);\n+// /** Get block file info entry for one block file */\n+// CBlockFileInfo* GetBlockFileInfo(size_t n);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697585112",
      "id" : 697585112,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzU4NTExMg==",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 59,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 25,
      "pull_request_review_id" : 740704160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T17:08:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697585112",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697587487"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697587487"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move cs_LastBlockFile guarded objects to BlockManager\" (ca77cd53abb455847094cecdc11b217c64166de8)\r\n\r\nIt would seem better to keep this comment which is still summarizing behavior of this block of code.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-27T16:55:05Z",
      "diff_hunk" : "@@ -39,11 +38,14 @@ BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n     CChainState& c1 = WITH_LOCK(cs_main, return manager.InitializeChainstate(&mempool));\n     c1.InitCoinsDB(\n         /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n-    WITH_LOCK(::cs_main, c1.InitCoinsCache(1 << 23));\n \n-    // Add a coin to the in-memory cache, upsize once, then downsize.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697587487",
      "id" : 697587487,
      "line" : 44,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzU4NzQ4Nw==",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 44,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/test/validation_chainstate_tests.cpp",
      "position" : 25,
      "pull_request_review_id" : 740704160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T17:08:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697587487",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697594297"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697594297"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move cs_LastBlockFile guarded objects to BlockManager\" (ca77cd53abb455847094cecdc11b217c64166de8)\r\n\r\nI guess this is a preexisting thing better to address in a different PR, but it seems wrong if cs_main is required to get a *pointer* to blockman from the chainman. I didn't look but ideally the blockman pointer would be set once in the chainman constructor and could just be const. Or even if it could not be const for some reason, it could be atomic and not require a validation lock.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-27T17:07:00Z",
      "diff_hunk" : "@@ -84,7 +84,7 @@ BOOST_FIXTURE_TEST_CASE(scan_for_wallet_transactions, TestChain100Setup)\n {\n     // Cap last block file size, and mine new block in a new block file.\n     CBlockIndex* oldTip = m_node.chainman->ActiveChain().Tip();\n-    GetBlockFileInfo(oldTip->GetBlockPos().nFile)->nSize = MAX_BLOCKFILE_SIZE;\n+    (*WITH_LOCK(::cs_main, return &m_node.chainman->m_blockman)).GetBlockFileInfo(oldTip->GetBlockPos().nFile)->nSize = MAX_BLOCKFILE_SIZE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697594297",
      "id" : 697594297,
      "line" : 87,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzU5NDI5Nw==",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 87,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/test/wallet_tests.cpp",
      "position" : 5,
      "pull_request_review_id" : 740704160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T17:08:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697594297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r698659280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/698659280"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Move fHavePruned to BlockManager\" (b40f35d7f0507fcfb71d1c950c5158d6ff5fdb5e)\r\n\r\nThis is another place like https://github.com/bitcoin/bitcoin/pull/22564#discussion_r697594297 where it looks like m_blockman is improperly annotated to require cs_main. In general, if you have a variable\r\n\r\n```c++\r\nT variable GUARDED_BY(mutex);\r\n```\r\n\r\nAnd you are writing `WITH_LOCK(mutex, return &variable);` you're just bypassing the annotation, and either the annotation is wrong and shouldn't be there, or it's right and you're introducing a possible race condition when the variable is accessed through the pointer later without the lock held.\r\n\r\nIt would be nice to drop the `m_blockman` annotation in this PR because it seems overly broad. Or if it's easier a comment could be added just to say why the annotation is bypassed here.",
      "commit_id" : "6bb9ed3f62b99f14730cc469e9fb651d0739448d",
      "created_at" : "2021-08-30T17:08:50Z",
      "diff_hunk" : "@@ -40,7 +40,7 @@ static void BlockToJsonVerbose(benchmark::Bench& bench)\n {\n     TestBlockAndIndex data;\n     bench.run([&] {\n-        auto univalue = blockToJSON(data.block, &data.blockindex, &data.blockindex, /*verbose*/ true);\n+        auto univalue = blockToJSON(WITH_LOCK(::cs_main, return std::ref(data.testing_setup->m_node.chainman->m_blockman)), data.block, &data.blockindex, &data.blockindex, /*verbose*/ true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r698659280",
      "id" : 698659280,
      "line" : 43,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5ODY1OTI4MA==",
      "original_commit_id" : "b40f35d7f0507fcfb71d1c950c5158d6ff5fdb5e",
      "original_line" : 43,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/bench/rpc_blockchain.cpp",
      "position" : 5,
      "pull_request_review_id" : 741875684,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-30T17:08:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/698659280",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708512723"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708512723"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Deleted as of d849178b9c36de80cded34a5305236282d7b24d6",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:07:22Z",
      "diff_hunk" : "@@ -73,9 +73,9 @@ bool ReadRawBlockFromDisk(std::vector<uint8_t>& block, const FlatFilePos& pos, c\n bool ReadRawBlockFromDisk(std::vector<uint8_t>& block, const CBlockIndex* pindex, const CMessageHeader::MessageStartChars& message_start);\n \n bool UndoReadFromDisk(CBlockUndo& blockundo, const CBlockIndex* pindex);\n-bool WriteUndoDataForBlock(const CBlockUndo& blockundo, BlockValidationState& state, CBlockIndex* pindex, const CChainParams& chainparams);\n+// bool WriteUndoDataForBlock(const CBlockUndo& blockundo, BlockValidationState& state, CBlockIndex* pindex, const CChainParams& chainparams);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708512723",
      "id" : 708512723,
      "in_reply_to_id" : 695841110,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qOwvT",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 76,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : null,
      "pull_request_review_id" : 754271400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:07:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708512723",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708513880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708513880"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "First note done in master, second note done by: b903d3b682bc1a779f924fb9da778ec295ab017b",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:09:05Z",
      "diff_hunk" : "@@ -573,7 +573,7 @@ class CChainState\n      */\n     RecursiveMutex cs_nBlockSequenceId;\n     /** Blocks loaded from disk are assigned id 0, so start the counter at 1. */\n-    int32_t nBlockSequenceId = 1;\n+    int32_t nBlockSequenceId GUARDED_BY(cs_nBlockSequenceId) = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708513880",
      "id" : 708513880,
      "in_reply_to_id" : 697576048,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qOxBY",
      "original_commit_id" : "7c3f21a5c16e83ef6baacbcd600d15a470ff1e5b",
      "original_line" : 576,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 754272925,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:09:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708513880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514137"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514137"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed as of d849178b9c36de80cded34a5305236282d7b24d6",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:09:26Z",
      "diff_hunk" : "@@ -55,11 +55,11 @@ FILE* OpenBlockFile(const FlatFilePos& pos, bool fReadOnly = false);\n /** Translation to a filesystem path */\n fs::path GetBlockPosFilename(const FlatFilePos& pos);\n \n-/** Get block file info entry for one block file */\n-CBlockFileInfo* GetBlockFileInfo(size_t n);\n+// /** Get block file info entry for one block file */\n+// CBlockFileInfo* GetBlockFileInfo(size_t n);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514137",
      "id" : 708514137,
      "in_reply_to_id" : 697585112,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qOxFZ",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 59,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : null,
      "pull_request_review_id" : 754273239,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:09:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514206"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514206"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed as of d849178b9c36de80cded34a5305236282d7b24d6",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:09:31Z",
      "diff_hunk" : "@@ -55,11 +55,11 @@ FILE* OpenBlockFile(const FlatFilePos& pos, bool fReadOnly = false);\n /** Translation to a filesystem path */\n fs::path GetBlockPosFilename(const FlatFilePos& pos);\n \n-/** Get block file info entry for one block file */\n-CBlockFileInfo* GetBlockFileInfo(size_t n);\n+// /** Get block file info entry for one block file */\n+// CBlockFileInfo* GetBlockFileInfo(size_t n);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514206",
      "id" : 708514206,
      "in_reply_to_id" : 697585112,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qOxGe",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 59,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : null,
      "pull_request_review_id" : 754273315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:09:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514602"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514602"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed in 8fd345b98f8b8cb81a2c5c9e227405364d7b46a2",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T18:10:02Z",
      "diff_hunk" : "@@ -39,11 +38,14 @@ BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n     CChainState& c1 = WITH_LOCK(cs_main, return manager.InitializeChainstate(&mempool));\n     c1.InitCoinsDB(\n         /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n-    WITH_LOCK(::cs_main, c1.InitCoinsCache(1 << 23));\n \n-    // Add a coin to the in-memory cache, upsize once, then downsize.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708514602",
      "id" : 708514602,
      "in_reply_to_id" : 697587487,
      "line" : 44,
      "node_id" : "PRRC_kwDOABII584qOxMq",
      "original_commit_id" : "ca77cd53abb455847094cecdc11b217c64166de8",
      "original_line" : 44,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/test/validation_chainstate_tests.cpp",
      "position" : 25,
      "pull_request_review_id" : 754273823,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T18:10:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708514602",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708567724"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708567724"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "vinfo guarded in: 952482e8598c9bd38a7a4e382c0c791acda11ff4\r\ncs_LastBlockFile renamed in: 71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T19:27:08Z",
      "diff_hunk" : "@@ -28,12 +28,12 @@ uint64_t nPruneTarget = 0;\n // TODO make namespace {\n RecursiveMutex cs_LastBlockFile;\n std::vector<CBlockFileInfo> vinfoBlockFile;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708567724",
      "id" : 708567724,
      "in_reply_to_id" : 696827015,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584qO-Ks",
      "original_commit_id" : "ccd6ec5e620dbb3ae251b3511d00aaf3614e97da",
      "original_line" : 30,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : null,
      "pull_request_review_id" : 754342417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T19:27:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708567724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708577418"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708577418"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Description added to fa455c0339561ca19a3edd6b249be962ae87194d",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-14T19:41:15Z",
      "diff_hunk" : "@@ -432,6 +432,12 @@ class BlockManager\n     /** Best header we've seen so far (used for getheaders queries' starting points). */\n     CBlockIndex *pindexBestHeader = nullptr;\n \n+    /** Dirty block index entries. */\n+    std::set<CBlockIndex*> setDirtyBlockIndex;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708577418",
      "id" : 708577418,
      "in_reply_to_id" : 695871478,
      "line" : 441,
      "node_id" : "PRRC_kwDOABII584qPAiK",
      "original_commit_id" : "feb62ff2a0af6fedfaa3078b1a512416cdf71264",
      "original_line" : 441,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 48,
      "pull_request_review_id" : 754354350,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-14T19:41:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708577418",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, will review in next few days",
      "created_at" : "2021-09-14T19:50:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-919464754",
      "id" : 919464754,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5842zesy",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-14T19:50:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919464754",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708801191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708801191"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, `warningcache` only relies on the chain history, consensus params, and versionbitscache state. Moving the clearing logic to `SelectParams` would introduce a circular dependency though, I think?",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-15T03:04:45Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708801191",
      "id" : 708801191,
      "in_reply_to_id" : 680508909,
      "line" : 3985,
      "node_id" : "PRRC_kwDOABII584qP3Kn",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 3985,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 589,
      "pull_request_review_id" : 754621227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-15T03:04:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708801191",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708839714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708839714"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> This looks good to me, and it seems like they would eventually end up having to interact with `BlockManager` anyway according to the following?\r\n\r\nWell, using the cb wit nonce for activation signalling might never happen, and even if it does, I think it's a fair way off (since it would need getblocktemplate changes or stratumv2 or similar to make it even possible), so I wouldn't put too much weight on it, but it seems plausible.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-15T05:02:35Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r708839714",
      "id" : 708839714,
      "in_reply_to_id" : 680503657,
      "line" : 20,
      "node_id" : "PRRC_kwDOABII584qQAki",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : 15,
      "pull_request_review_id" : 754664850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-15T05:02:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708839714",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712573048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712573048"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not at all blocking and could be done in a separate commit, but might be nice to add a docstring describing purpose and usage of this member while all this is fresh in your head.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-20T23:06:23Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712573048",
      "id" : 712573048,
      "line" : 435,
      "node_id" : "PRRC_kwDOABII584qeQB4",
      "original_commit_id" : "3ea18162a4d729db720ca14ff8363f539d375ab3",
      "original_line" : 430,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 42,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712573048/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712573048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712598917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712598917"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/22564/commits/fa455c0339561ca19a3edd6b249be962ae87194d\r\n\r\nMight mention these changes somewhere in the commit message; I was surprised to see them here after reading it.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-20T23:59:52Z",
      "diff_hunk" : "@@ -233,7 +227,7 @@ fs::path GetBlockPosFilename(const FlatFilePos& pos)\n     return BlockFileSeq().FileName(pos);\n }\n \n-bool FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigned int nHeight, CChain& active_chain, uint64_t nTime, bool fKnown = false)\n+bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigned int nHeight, CChain& active_chain, uint64_t nTime, bool fKnown = false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712598917",
      "id" : 712598917,
      "line" : 219,
      "node_id" : "PRRC_kwDOABII584qeWWF",
      "original_commit_id" : "fa455c0339561ca19a3edd6b249be962ae87194d",
      "original_line" : 230,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 85,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712598917/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712598917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716945997"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716945997"
         }
      },
      "author_association" : "MEMBER",
      "body" : "17f227f6d44bb417d0c6540e081d4d374bece6a7\r\n\r\nI think this forward declaration is probably outdated and doesn't seem necessary anymore - I was able to compile without it.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-27T18:34:55Z",
      "diff_hunk" : "@@ -51,6 +51,8 @@ struct BIP9Stats {\n     bool possible;\n };\n \n+class VersionBitsCache;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716945997",
      "id" : 716945997,
      "line" : 54,
      "node_id" : "PRRC_kwDOABII584qu7pN",
      "original_commit_id" : "17f227f6d44bb417d0c6540e081d4d374bece6a7",
      "original_line" : 54,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/versionbits.h",
      "position" : 4,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716945997/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716945997",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716987095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716987095"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/22564/commits/b48d7c010f644ed01e310ea4ab590580640a16b7\r\n\r\nTook me awhile to parse this name. I'm not opposed, it's kind of cute, but is it something we've used before? Maybe `newIndex`?",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-27T19:37:28Z",
      "diff_hunk" : "@@ -2800,20 +2800,21 @@ CBlockIndex* BlockManager::AddToBlockIndex(const CBlockHeader& block)\n     uint256 hash = block.GetHash();\n     BlockMap::iterator it = m_block_index.find(hash);\n     if (it != m_block_index.end())\n-        return it->second;\n+        return &it->second;\n \n     // Construct new block index object\n-    CBlockIndex* pindexNew = new CBlockIndex(block);\n+    CBlockIndex neue(block);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716987095",
      "id" : 716987095,
      "line" : 2806,
      "node_id" : "PRRC_kwDOABII584qvFrX",
      "original_commit_id" : "b48d7c010f644ed01e310ea4ab590580640a16b7",
      "original_line" : 2806,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 390,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716987095/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716987095",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716998451"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716998451"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/22564/commits/b48d7c010f644ed01e310ea4ab590580640a16b7\r\n\r\nI'm not so worried about this function in particular since it's really only executed once on startup, but I've got to imagine there may be some performance implications if we're potentially introducing a lot of CBlockIndex value copying (vs. the pointers). \r\n\r\nThis does strike me as a pretty big change, especially for a PR that's nominally about deglobalization. I'm not opposed to including it here, but I just want to make sure that we've thought through all the implications and have made sure that this change is really only as significant as inclusion in a semi-related PR merits.\r\n\r\nDoes anyone have any historical notion of why we didn't have the block index hold values in the first place? For what it's worth, I'm definitely concept ACK on reducing CBlockIndex* usage.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-27T19:54:21Z",
      "diff_hunk" : "@@ -3576,9 +3578,9 @@ bool BlockManager::LoadBlockIndex(\n     // Calculate nChainWork\n     std::vector<std::pair<int, CBlockIndex*> > vSortedByHeight;\n     vSortedByHeight.reserve(m_block_index.size());\n-    for (const std::pair<const uint256, CBlockIndex*>& item : m_block_index)\n+    for (std::pair<const uint256, CBlockIndex>& item : m_block_index)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716998451",
      "id" : 716998451,
      "line" : 3581,
      "node_id" : "PRRC_kwDOABII584qvIcz",
      "original_commit_id" : "b48d7c010f644ed01e310ea4ab590580640a16b7",
      "original_line" : 3581,
      "original_position" : 148,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 506,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716998451/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/716998451",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r717628411"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/717628411"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://github.com/bitcoin/bitcoin/pull/22564/commits/3de7842f50c44e6bed675048737e19a1d8ca5fa4\r\n\r\nThis is most easily reviewed with `--color-move=dimmed_zebra`.\r\n\r\nGiven that init reordering is notoriously tricky, we should probably be sure to test invocation of `bitcoind` with each flag that was moved here.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-09-28T14:19:33Z",
      "diff_hunk" : "@@ -1211,114 +1211,14 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.connman);\n     node.connman = std::make_unique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), *node.addrman, args.GetBoolArg(\"-networkactive\", true));\n \n+    // ********************************************************* Step 7: load block chain",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r717628411",
      "id" : 717628411,
      "line" : 1214,
      "node_id" : "PRRC_kwDOABII584qxiP7",
      "original_commit_id" : "3de7842f50c44e6bed675048737e19a1d8ca5fa4",
      "original_line" : 1214,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 759168474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/717628411/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-28T14:37:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/717628411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "For what it's worth, I benched this and there don't seem to be any significant performance implications to moving block index entries from `CBlockIndex` pointers to values.\r\n\r\n---\r\n\r\n\r\n|          bench name           |                                                                                                     command                                                                                                      |\r\n|-------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\r\n| ibd.local.range.500000.540000 | `bitcoind -dbcache=10000 -debug=coindb -debug=bench -listen=0 -connect=0 -addnode=127.0.0.1:8888 -prune=9999999 -printtoconsole=0 -assumevalid=000000000000000000176c192f42ad13ab159fdb20198b87e7ba3c001e47b876` |\r\n\r\n\r\n\r\n#### #22564 vs. $mergebase (absolute)\r\n|                  bench name                   |  x  |           #22564           |         $mergebase         |\r\n|-----------------------------------------------|----:|----------------------------|----------------------------|\r\n| ibd.local.range.500000.540000.total_secs      |   2 | 3122.0459 (Â± 10.1604)      | 3127.1493 (Â± 4.1510)       |\r\n| ibd.local.range.500000.540000.peak_rss_KiB    |   2 | 6345706.0000 (Â± 3578.0000) | 6356022.0000 (Â± 2906.0000) |\r\n| ibd.local.range.500000.540000.cpu_kernel_secs |   2 | 264.0400 (Â± 0.7700)        | 266.6600 (Â± 1.8000)        |\r\n| ibd.local.range.500000.540000.cpu_user_secs   |   2 | 13185.5400 (Â± 4.5500)      | 13150.5350 (Â± 14.1950)     |\r\n\r\n\r\n#### #22564 vs. $mergebase (relative)\r\n|                  bench name                   |  x  | #22564 | $mergebase |\r\n|-----------------------------------------------|----:|-------:|-----------:|\r\n| ibd.local.range.500000.540000.total_secs      |   2 |   1.00 |      1.002 |\r\n| ibd.local.range.500000.540000.peak_rss_KiB    |   2 |   1.00 |      1.002 |\r\n| ibd.local.range.500000.540000.cpu_kernel_secs |   2 |   1.00 |      1.010 |\r\n| ibd.local.range.500000.540000.cpu_user_secs   |   2 |   1.00 |      1.000 |\r\n",
      "created_at" : "2021-09-29T17:20:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-930377301",
      "id" : 930377301,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5843dG5V",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-29T17:20:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/930377301",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723625367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625367"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> we're potentially introducing a lot of CBlockIndex value copying (vs. the pointers)\r\n\r\nI don't think we're introducing value copying because we're iterating with `std::pair<...>&`, but perhaps there's something I'm missing? When I asked him about it, ryanofsky also pointed out that the const reference was actually more dangerous since it could have created copies through implicit conversion.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-10-06T19:48:15Z",
      "diff_hunk" : "@@ -3576,9 +3578,9 @@ bool BlockManager::LoadBlockIndex(\n     // Calculate nChainWork\n     std::vector<std::pair<int, CBlockIndex*> > vSortedByHeight;\n     vSortedByHeight.reserve(m_block_index.size());\n-    for (const std::pair<const uint256, CBlockIndex*>& item : m_block_index)\n+    for (std::pair<const uint256, CBlockIndex>& item : m_block_index)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723625367",
      "id" : 723625367,
      "in_reply_to_id" : 716998451,
      "line" : 3581,
      "node_id" : "PRRC_kwDOABII584rIaWX",
      "original_commit_id" : "b48d7c010f644ed01e310ea4ab590580640a16b7",
      "original_line" : 3581,
      "original_position" : 148,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 506,
      "pull_request_review_id" : 773159595,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625367/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T19:48:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723625689"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625689"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, I think I'm going to work a bit more on this commit to see if I can make it more easily reviewable.",
      "commit_id" : "71bacd9265f66f4ffc94f551dcdb9fc64e673fb9",
      "created_at" : "2021-10-06T19:48:46Z",
      "diff_hunk" : "@@ -1211,114 +1211,14 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.connman);\n     node.connman = std::make_unique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), *node.addrman, args.GetBoolArg(\"-networkactive\", true));\n \n+    // ********************************************************* Step 7: load block chain",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723625689",
      "id" : 723625689,
      "in_reply_to_id" : 717628411,
      "line" : 1214,
      "node_id" : "PRRC_kwDOABII584rIabZ",
      "original_commit_id" : "3de7842f50c44e6bed675048737e19a1d8ca5fa4",
      "original_line" : 1214,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 773160034,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625689/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T19:48:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723625689",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723787975"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723787975"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good idea, added in e78b6e5105",
      "commit_id" : "5b723331601fa09376a4d4c4452d8455bc174cdb",
      "created_at" : "2021-10-07T01:40:54Z",
      "diff_hunk" : "@@ -430,6 +427,11 @@ class BlockManager\n       */\n     std::set<CBlockIndex*> m_failed_blocks;\n \n+    CBlockIndex* pindexBestInvalid = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723787975",
      "id" : 723787975,
      "in_reply_to_id" : 712573048,
      "line" : 428,
      "node_id" : "PRRC_kwDOABII584rJCDH",
      "original_commit_id" : "3ea18162a4d729db720ca14ff8363f539d375ab3",
      "original_line" : 428,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 43,
      "pull_request_review_id" : 773366135,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723787975/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-07T01:40:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723787975",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788163"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788163"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "True! Fixed in f99156b575!",
      "commit_id" : "5b723331601fa09376a4d4c4452d8455bc174cdb",
      "created_at" : "2021-10-07T01:41:17Z",
      "diff_hunk" : "@@ -233,7 +227,7 @@ fs::path GetBlockPosFilename(const FlatFilePos& pos)\n     return BlockFileSeq().FileName(pos);\n }\n \n-bool FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigned int nHeight, CChain& active_chain, uint64_t nTime, bool fKnown = false)\n+bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigned int nHeight, CChain& active_chain, uint64_t nTime, bool fKnown = false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788163",
      "id" : 723788163,
      "in_reply_to_id" : 712598917,
      "line" : 219,
      "node_id" : "PRRC_kwDOABII584rJCGD",
      "original_commit_id" : "fa455c0339561ca19a3edd6b249be962ae87194d",
      "original_line" : 219,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 85,
      "pull_request_review_id" : 773366539,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788163/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-07T01:41:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788163",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788218"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788218"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done! f5ad3509dc",
      "commit_id" : "5b723331601fa09376a4d4c4452d8455bc174cdb",
      "created_at" : "2021-10-07T01:41:31Z",
      "diff_hunk" : "@@ -51,6 +51,8 @@ struct BIP9Stats {\n     bool possible;\n };\n \n+class VersionBitsCache;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788218",
      "id" : 723788218,
      "in_reply_to_id" : 716945997,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rJCG6",
      "original_commit_id" : "17f227f6d44bb417d0c6540e081d4d374bece6a7",
      "original_line" : 54,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/versionbits.h",
      "position" : null,
      "pull_request_review_id" : 773366616,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788218/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-07T01:41:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788218",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788315"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788315"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hehe that's an artifact from me experimenting. Changed in 5bab523f31!",
      "commit_id" : "5b723331601fa09376a4d4c4452d8455bc174cdb",
      "created_at" : "2021-10-07T01:41:52Z",
      "diff_hunk" : "@@ -2800,20 +2800,21 @@ CBlockIndex* BlockManager::AddToBlockIndex(const CBlockHeader& block)\n     uint256 hash = block.GetHash();\n     BlockMap::iterator it = m_block_index.find(hash);\n     if (it != m_block_index.end())\n-        return it->second;\n+        return &it->second;\n \n     // Construct new block index object\n-    CBlockIndex* pindexNew = new CBlockIndex(block);\n+    CBlockIndex neue(block);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r723788315",
      "id" : 723788315,
      "in_reply_to_id" : 716987095,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rJCIb",
      "original_commit_id" : "b48d7c010f644ed01e310ea4ab590580640a16b7",
      "original_line" : 2806,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 773366740,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788315/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-07T01:41:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723788315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 71bacd9 -> e78b6e5:\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712573048\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r712598917\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716945997\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r716987095\r\n\r\n",
      "created_at" : "2021-10-07T01:52:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-937379956",
      "id" : 937379956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584330h0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937379956/reactions"
      },
      "updated_at" : "2021-10-07T01:52:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937379956",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed e78b6e5 -> 5b72333:\r\n- Rebased over master",
      "created_at" : "2021-10-07T01:59:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-937382271",
      "id" : 937382271,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584331F_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937382271/reactions"
      },
      "updated_at" : "2021-10-07T01:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937382271",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 5b72333 -> 148bf14\r\n- Added `CBlockUndo` forward declaration\r\n- Made intermediate commits comply with lock annotations by adding `GUARDED_BY` annotations to `extern` declarations and fixing up code",
      "created_at" : "2021-10-08T22:16:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-939145083",
      "id" : 939145083,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5843-jd7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939145083/reactions"
      },
      "updated_at" : "2021-10-08T22:16:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939145083",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 148bf148e198027b25894df429dd13b9ca9f60a1 -> 0898078ed59453cc850ebe08010e68e6dea51dbd:\r\n- Only move the `PeerManager` construction in \"init: Reset mempool and chainman via reconstruction\" so that it's more easily reviewable.",
      "created_at" : "2021-10-09T00:39:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-939192113",
      "id" : 939192113,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5843-u8x",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939192113/reactions"
      },
      "updated_at" : "2021-10-09T00:39:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939192113",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-12-13T23:18:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-993000048",
      "id" : 993000048,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5847L_pw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993000048/reactions"
      },
      "updated_at" : "2021-12-13T23:18:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993000048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--13523179cfe9479db18ec6c5d236f789-->There hasn't been much activity lately and the patch still needs rebase. What is the status here?\r\n\r\n* Is it still relevant? â¡ï¸ Please solve the conflicts to make it ready for review and to ensure the CI passes.\r\n* Is it no longer relevant? â¡ï¸ Please close.\r\n* Did the author lose interest or time to work on this? â¡ï¸ Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\r\n",
      "created_at" : "2022-01-03T09:12:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1003956534",
      "id" : 1003956534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58471yk2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003956534/reactions"
      },
      "updated_at" : "2022-01-03T09:12:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003956534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Going to update this soon, @MarcoFalke would it make sense to rebase this on top of your #23974?",
      "created_at" : "2022-01-05T17:06:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1005909065",
      "id" : 1005909065,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58479PRJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005909065/reactions"
      },
      "updated_at" : "2022-01-05T17:06:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005909065",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Oh, apologies I missed that you (partly?) already did #23974 in here. I don't have a preference on how to proceed. Let me know if I should close my pull or something else.",
      "created_at" : "2022-01-05T18:37:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1005980794",
      "id" : 1005980794,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58479gx6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005980794/reactions"
      },
      "updated_at" : "2022-01-05T18:37:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1005980794",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Oh, apologies I missed that you (partly?) already did #23974 in here. I don't have a preference on how to proceed. Let me know if I should close my pull or something else.\r\n\r\nOh, I knew this code looked familiar and couldn't remember where I made these comments before. IMO, #23974 is really easy to understand, and already up to date, and this PR would ultimately be simpler rebased on top of #23974. But I'm not sure if it would significant extra work to do that, so I don't really have an informed opinion about merge order. Will ACK #23974 in any case",
      "created_at" : "2022-01-05T19:14:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1006005733",
      "id" : 1006005733,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII58479m3l",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1006005733/reactions"
      },
      "updated_at" : "2022-01-05T19:14:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1006005733",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "#23974 has been merged.",
      "created_at" : "2022-01-07T03:19:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1007109379",
      "id" : 1007109379,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5848B0UD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1007109379/reactions"
      },
      "updated_at" : "2022-01-07T03:19:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1007109379",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased over #23974, more changes to come.\r\n\r\nWhile rebasing, I noticed a few things:\r\n1. Recent changes has made it such that `CChainState` holds a reference to `ChainstateManager` as `m_chainman`, and that `BlockManager::LoadBlockIndex` takes in a `ChainstateManager` parameter. It seems that there's a lot of reaching up and down the ownership hierarchy, and I'm wondering if I'm missing some underlying logic/structure behind all of this.\r\n2. The recent introduction of the `chainstatemanager_loadblockindex` and its call to `CChainState::UnloadBlockIndex` has made it such that I cannot prune that method. If we examine `CChainState::UnloadBlockIndex` closely, we can also observe that it does not affect the block index at all, but only CChainState's members which relate to the block index. Perhaps something should be done here, but I'm not exactly sure what yet.",
      "created_at" : "2022-01-07T19:59:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1007697503",
      "id" : 1007697503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5848ED5f",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1007697503/reactions"
      },
      "updated_at" : "2022-01-07T19:59:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1007697503",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Recent changes has made it such that CChainState holds a reference to ChainstateManager as m_chainman, and that BlockManager::LoadBlockIndex takes in a ChainstateManager parameter. It seems that there's a lot of reaching up and down the ownership hierarchy, and I'm wondering if I'm missing some underlying logic/structure behind all of this.\r\n\r\nI haven't made the `CChainState::m_chainman`, but I think there is a comment saying that the \"clean\" alternative required more code changes.\r\n\r\nBlockManager::LoadBlockIndex takes in a ChainstateManager parameter to set the \"best invalid\" pointer. An alternative could be to pass in the mutable pointer only. It is also doing a check on chainstates, which I believe can be replaced by passing in a const bool: https://github.com/bitcoin/bitcoin/pull/23174#discussion_r768555186",
      "created_at" : "2022-01-08T08:18:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1007910119",
      "id" : 1007910119,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5848E3zn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1007910119/reactions"
      },
      "updated_at" : "2022-01-08T08:18:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1007910119",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r780645923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/780645923"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit fd2cdbc54efa02f51577c833288961254d5b5053: :eye: ",
      "commit_id" : "44ec73a154efa8605c7ed0a9eed2a3f509ed7bfa",
      "created_at" : "2022-01-08T08:21:42Z",
      "diff_hunk" : "@@ -12,6 +12,7 @@ std::optional<ChainstateLoadingError> LoadChainstate(bool fReset,\n                                                      ChainstateManager& chainman,\n                                                      CTxMemPool* mempool,\n                                                      bool fPruneMode,\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r780645923",
      "id" : 780645923,
      "line" : 15,
      "node_id" : "PRRC_kwDOABII584uh7Yj",
      "original_commit_id" : "fd2cdbc54efa02f51577c833288961254d5b5053",
      "original_line" : 15,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/node/chainstate.cpp",
      "position" : 4,
      "pull_request_review_id" : 847133250,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/780645923/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-08T08:21:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/780645923",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-01-08T10:05:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1007941534",
      "id" : 1007941534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5848E_ee",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1007941534/reactions"
      },
      "updated_at" : "2022-01-08T10:05:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1007941534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r780926902"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/780926902"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Here's a rebase of this that replaces moving g_versionbits with just removing `g_versionbitscache.Clear()` from `UnloadBlockIndex` -- https://github.com/ajtowns/bitcoin/commits/202201-vb-unloadblockindex ... What do you think about doing that instead? I've got some updates for the versionbits code I'd like to PR, and would prefer to minimise conflicts with this one...",
      "commit_id" : "44ec73a154efa8605c7ed0a9eed2a3f509ed7bfa",
      "created_at" : "2022-01-10T07:00:09Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r780926902",
      "id" : 780926902,
      "in_reply_to_id" : 680508909,
      "line" : 3973,
      "node_id" : "PRRC_kwDOABII584ui_-2",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 3973,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 270,
      "pull_request_review_id" : 847425790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/780926902/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-10T07:00:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/780926902",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "nit: s/BlockManager/ChainstateManger/ in the first commit title",
      "created_at" : "2022-01-10T07:28:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1008601831",
      "id" : 1008601831,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5848Hgrn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1008601831/reactions"
      },
      "updated_at" : "2022-01-10T07:28:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1008601831",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "At some point it could also make sense to move functions to BlockManager that don't read any member vars of it, but logically belong to it. For example, CleanupBlockRevFiles...",
      "created_at" : "2022-01-10T09:27:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1008684573",
      "id" : 1008684573,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5848H04d",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1008684573/reactions"
      },
      "updated_at" : "2022-01-10T09:27:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1008684573",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r781492276"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781492276"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If `warningcache` and `g_versionbitscache` are both only dependent on consensus parameters, then perhaps (perhaps not in this PR) we should move them to `ChainstateManager` or `NodeContext`? At the very least we would need to clear them in `~ChainTestingSetup` so that tests with different consensus params won't get confused.",
      "commit_id" : "44ec73a154efa8605c7ed0a9eed2a3f509ed7bfa",
      "created_at" : "2022-01-10T19:36:27Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r781492276",
      "id" : 781492276,
      "in_reply_to_id" : 680508909,
      "line" : 3973,
      "node_id" : "PRRC_kwDOABII584ulKA0",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 3973,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 270,
      "pull_request_review_id" : 848257730,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781492276/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-10T19:36:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781492276",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r781763541"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781763541"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Moving them somewhere rather than having them be globals would be good eventually; I had a look at moving them into `ChainstateManager` but it felt a bit too invasive when what I was hoping to do was avoid/defer introducing conflicts...\r\n\r\nThe patch above clears `g_versionbitscache` in the `BasicTestingSetup` constructor instead (where `SelectParams` is invoked), which I think should be good enough? It's also already cleared explicitly in `versionbits_tests.cpp` which manually changes the consensus params being used.",
      "commit_id" : "44ec73a154efa8605c7ed0a9eed2a3f509ed7bfa",
      "created_at" : "2022-01-11T05:14:53Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r781763541",
      "id" : 781763541,
      "in_reply_to_id" : 680508909,
      "line" : 3973,
      "node_id" : "PRRC_kwDOABII584umMPV",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 3973,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 270,
      "pull_request_review_id" : 848608506,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781763541/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-11T05:14:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781763541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I am more than happy to work on https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1008684573 myself. Just wanted to ping here first to see if you worry about conflicts.\r\n\r\nAlso, I think this pull can be split up. 14 commits is a bit large, especially given that some are \"basically ready\" for months now and others (versionbits) are still up for debate/details.",
      "created_at" : "2022-01-11T10:25:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1009820702",
      "id" : 1009820702,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5848MKQe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1009820702/reactions"
      },
      "updated_at" : "2022-01-11T10:25:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1009820702",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Good idea, I will split it up and PR separately!",
      "created_at" : "2022-01-12T18:31:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1011336155",
      "id" : 1011336155,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII5848R8Pb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1011336155/reactions"
      },
      "updated_at" : "2022-01-12T18:31:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1011336155",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated to be based on #24050\r\n\r\nEdit: Just realized I forgot the re-add my rebase of #15191, will do.",
      "created_at" : "2022-02-23T20:56:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1049209052",
      "id" : 1049209052,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584-iajc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1049209052/reactions"
      },
      "updated_at" : "2022-02-23T21:40:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1049209052",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-03-07T12:40:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1060645969",
      "id" : 1060645969,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584_OCxR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060645969/reactions"
      },
      "updated_at" : "2022-03-07T12:40:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060645969",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 40305c228f1582d31530437f77db22a4c163ff69 -> dc57ee310615d0d63e23e5f391593705141ccc29\r\n- Rebased over master\r\n- Forgot to mention in a previous update: I split up the move-mostly commits and the commits where I move the clearing of variables so that it's easier for reviewers",
      "created_at" : "2022-03-07T14:14:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1060731811",
      "id" : 1060731811,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584_OXuj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060731811/reactions"
      },
      "updated_at" : "2022-03-07T14:14:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060731811",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r820752809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820752809"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is there any reason to move this to blockstorage? It is never used there\r\n\r\nMy suggestion would be to move it to chainman. Also, there could be a follow-up scripted diff to rename the variable after the move to `m_...`.",
      "commit_id" : "dc57ee310615d0d63e23e5f391593705141ccc29",
      "created_at" : "2022-03-07T14:24:30Z",
      "diff_hunk" : "@@ -165,6 +165,9 @@ class BlockManager\n     //! Returns last CBlockIndex* that is a checkpoint\n     const CBlockIndex* GetLastCheckpoint(const CCheckpointData& data) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    /** Best header we've seen so far (used for getheaders queries' starting points). */\n+    CBlockIndex* pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r820752809",
      "id" : 820752809,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII584w67Gp",
      "original_commit_id" : "0e4b6541d2615c35ade80c7221436545141694e4",
      "original_line" : 169,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 5,
      "pull_request_review_id" : 901758338,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820752809/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-07T14:26:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820752809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r820760091"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820760091"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it's used in `BlockManager::AddToBlockIndex` and `BlockManager::LoadBlockIndex`, see previous comment here: https://github.com/bitcoin/bitcoin/pull/22564#discussion_r695990703\r\n\r\nResolve the blurry boundary seems somewhat non-trivial and I don't think would be within the scope of this PR, but we can certainly add a TODO comment so that this doesn't get lost to time? Let me know what you think is best!",
      "commit_id" : "dc57ee310615d0d63e23e5f391593705141ccc29",
      "created_at" : "2022-03-07T14:31:52Z",
      "diff_hunk" : "@@ -165,6 +165,9 @@ class BlockManager\n     //! Returns last CBlockIndex* that is a checkpoint\n     const CBlockIndex* GetLastCheckpoint(const CCheckpointData& data) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    /** Best header we've seen so far (used for getheaders queries' starting points). */\n+    CBlockIndex* pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r820760091",
      "id" : 820760091,
      "in_reply_to_id" : 820752809,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII584w684b",
      "original_commit_id" : "0e4b6541d2615c35ade80c7221436545141694e4",
      "original_line" : 169,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 5,
      "pull_request_review_id" : 901769007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820760091/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-07T14:31:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820760091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r820768687"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820768687"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`LoadBlockIndex` already has a ChainstateManager reference, so this shouldn't cause any issues. See also fab6d6b2d154893ab422dda87f3535d42c3e06f4\r\n\r\nHow hard would it be to do the same for `AddToBlockIndex`?",
      "commit_id" : "dc57ee310615d0d63e23e5f391593705141ccc29",
      "created_at" : "2022-03-07T14:40:32Z",
      "diff_hunk" : "@@ -165,6 +165,9 @@ class BlockManager\n     //! Returns last CBlockIndex* that is a checkpoint\n     const CBlockIndex* GetLastCheckpoint(const CCheckpointData& data) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    /** Best header we've seen so far (used for getheaders queries' starting points). */\n+    CBlockIndex* pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r820768687",
      "id" : 820768687,
      "in_reply_to_id" : 820752809,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII584w6--v",
      "original_commit_id" : "0e4b6541d2615c35ade80c7221436545141694e4",
      "original_line" : 169,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 5,
      "pull_request_review_id" : 901781211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820768687/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-07T14:40:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/820768687",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "```\r\nbitcoin-chainstate.cpp:259:5: error: use of undeclared identifier 'UnloadBlockIndex'\r\n    UnloadBlockIndex(nullptr, chainman);\r\n    ^\r\n1 error generated.",
      "created_at" : "2022-03-07T15:34:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1060818369",
      "id" : 1060818369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584_Os3B",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060818369/reactions"
      },
      "updated_at" : "2022-03-07T15:34:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060818369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r821277140"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/821277140"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm not sure that reaching up to `ChainstateManager` when loading the block index is the best here... Preferably we can split the \"load block index itself\" logic from \"derive Chainstate variables from loaded block index\" logic. Doing so would allow us to keep `pindexBestHeader` in `ChainstateManager` as you suggested (and I think is the right place for it to be in the long run).\r\n\r\nHere's a commit that does this: https://github.com/dongcarl/bitcoin/commit/41b61f245f1f115de4625fda40d8898cb6b2d3ba\r\n\r\nBranch: https://github.com/dongcarl/bitcoin/commits/2022-03-kirby-p2.5\r\n\r\nLmk what you think!",
      "commit_id" : "dc57ee310615d0d63e23e5f391593705141ccc29",
      "created_at" : "2022-03-08T02:49:14Z",
      "diff_hunk" : "@@ -165,6 +165,9 @@ class BlockManager\n     //! Returns last CBlockIndex* that is a checkpoint\n     const CBlockIndex* GetLastCheckpoint(const CCheckpointData& data) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    /** Best header we've seen so far (used for getheaders queries' starting points). */\n+    CBlockIndex* pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r821277140",
      "id" : 821277140,
      "in_reply_to_id" : 820752809,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII584w87HU",
      "original_commit_id" : "0e4b6541d2615c35ade80c7221436545141694e4",
      "original_line" : 169,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 5,
      "pull_request_review_id" : 902486541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/821277140/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-08T02:49:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/821277140",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r821455176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/821455176"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, looks fine long-term. Might want to chat with @jamesob to discuss conflicts.\r\n\r\nI just prefer a (temporary) ChainMan reference to be passed down and have the member in ChainMan, instead of (temporarily) putting it in BlockMan. Though, as both are temporary, either is probably fine.",
      "commit_id" : "dc57ee310615d0d63e23e5f391593705141ccc29",
      "created_at" : "2022-03-08T09:02:26Z",
      "diff_hunk" : "@@ -165,6 +165,9 @@ class BlockManager\n     //! Returns last CBlockIndex* that is a checkpoint\n     const CBlockIndex* GetLastCheckpoint(const CCheckpointData& data) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    /** Best header we've seen so far (used for getheaders queries' starting points). */\n+    CBlockIndex* pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r821455176",
      "id" : 821455176,
      "in_reply_to_id" : 820752809,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII584w9mlI",
      "original_commit_id" : "0e4b6541d2615c35ade80c7221436545141694e4",
      "original_line" : 169,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 5,
      "pull_request_review_id" : 902727291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/821455176/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-08T09:02:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/821455176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r822901256"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822901256"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No trouble doing this move in terms of planned assumeutxo changes, and certainly having it under blockman is better than prior to this changeset.\r\n\r\nI agree some of the \"deep-dot\" accesses are clunky (probably the necessary result of script-diffs) and there are a few instances where `pindexBestHeader` is accessed like `chainstate.chainman.blockman.pindexbestheader` when it could be `chainstate.blockman.pindexbestheader`, again probably just due to scripted-diffs. If we wanted to ease some of the other uses, we could just have a `ChainstateManager::bestIndex` method that returned from its blockmanager.",
      "commit_id" : "dc57ee310615d0d63e23e5f391593705141ccc29",
      "created_at" : "2022-03-09T17:25:01Z",
      "diff_hunk" : "@@ -165,6 +165,9 @@ class BlockManager\n     //! Returns last CBlockIndex* that is a checkpoint\n     const CBlockIndex* GetLastCheckpoint(const CCheckpointData& data) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    /** Best header we've seen so far (used for getheaders queries' starting points). */\n+    CBlockIndex* pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r822901256",
      "id" : 822901256,
      "in_reply_to_id" : 820752809,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII584xDHoI",
      "original_commit_id" : "0e4b6541d2615c35ade80c7221436545141694e4",
      "original_line" : 169,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 5,
      "pull_request_review_id" : 904723754,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822901256/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-09T17:25:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822901256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r822927806"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822927806"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think what we're thinking is doing the changes in https://github.com/dongcarl/bitcoin/commits/2022-03-kirby-p2.5, and then making `pindexBestHeader` a `ChainstateManager` member instead of a `BlockManager` one (this current PR makes it a `BlockManager` member). Lmk if that sounds alright @jamesob ",
      "commit_id" : "dc57ee310615d0d63e23e5f391593705141ccc29",
      "created_at" : "2022-03-09T17:54:37Z",
      "diff_hunk" : "@@ -165,6 +165,9 @@ class BlockManager\n     //! Returns last CBlockIndex* that is a checkpoint\n     const CBlockIndex* GetLastCheckpoint(const CCheckpointData& data) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    /** Best header we've seen so far (used for getheaders queries' starting points). */\n+    CBlockIndex* pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r822927806",
      "id" : 822927806,
      "in_reply_to_id" : 820752809,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII584xDOG-",
      "original_commit_id" : "0e4b6541d2615c35ade80c7221436545141694e4",
      "original_line" : 169,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 5,
      "pull_request_review_id" : 904760878,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822927806/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-09T17:54:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822927806",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r822972240"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822972240"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@dongcarl sounds good to me!",
      "commit_id" : "dc57ee310615d0d63e23e5f391593705141ccc29",
      "created_at" : "2022-03-09T18:46:08Z",
      "diff_hunk" : "@@ -165,6 +165,9 @@ class BlockManager\n     //! Returns last CBlockIndex* that is a checkpoint\n     const CBlockIndex* GetLastCheckpoint(const CCheckpointData& data) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    /** Best header we've seen so far (used for getheaders queries' starting points). */\n+    CBlockIndex* pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r822972240",
      "id" : 822972240,
      "in_reply_to_id" : 820752809,
      "line" : 164,
      "node_id" : "PRRC_kwDOABII584xDY9Q",
      "original_commit_id" : "0e4b6541d2615c35ade80c7221436545141694e4",
      "original_line" : 169,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 5,
      "pull_request_review_id" : 904822471,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822972240/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-09T18:46:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/822972240",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed dc57ee310615d0d63e23e5f391593705141ccc29 -> 0cc5b02bd3b3e9a179b894fad60af639fd370d87\r\n- This PR is now based over #24515\r\n- Moved `pindexBestHeader` to `ChainstateManager` instead\r\n\r\nI gotta say that I'm not entirely happy that having `pindexBestHeader` in `ChainstateManager` means:\r\n- We gotta pass in the `pindexBestHeader` in `BlockManager::AddBlockToIndex` here: https://github.com/bitcoin/bitcoin/pull/22564/commits/4f80756c338970fb7d323459e2a4a40850f77f3e#diff-114c2880ec1ff2c5293ac65ceda0637bf92c05745b74b58410585a549464a33fR49\r\n- We gotta add an additional place where we reach up from `CChainState` to `ChainstateManager` to get the `pindexBestHeader` here: https://github.com/bitcoin/bitcoin/pull/22564/commits/4f80756c338970fb7d323459e2a4a40850f77f3e#diff-97c3a52bc5fad452d82670a7fd291800bae20c7bc35bb82686c2c0a4ea7b5b98R4193\r\n\r\nBut I don't think we can fix this without some clearer definition of what belongs where and some `CChainState` vs `ChainstateManager` disambiguation, so I think we're gucci for now.",
      "created_at" : "2022-03-09T23:25:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1063480773",
      "id" : 1063480773,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584_Y23F",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1063480773/reactions"
      },
      "updated_at" : "2022-03-09T23:27:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1063480773",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> We gotta pass in the pindexBestHeader in BlockManager::AddBlockToIndex here: https://github.com/bitcoin/bitcoin/commit/4f80756c338970fb7d323459e2a4a40850f77f3e#diff-114c2880ec1ff2c5293ac65ceda0637bf92c05745b74b58410585a549464a33fR49\r\n\r\nAn alternative would be to pass in a post-process lambda that is only run when a block was inserted",
      "created_at" : "2022-03-10T10:28:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1063900369",
      "id" : 1063900369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584_adTR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1063900369/reactions"
      },
      "updated_at" : "2022-03-10T10:28:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1063900369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-03-17T07:38:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1070454453",
      "id" : 1070454453,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584_zda1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1070454453/reactions"
      },
      "updated_at" : "2022-03-17T07:38:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1070454453",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829176967"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829176967"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this is dealt with by #24595",
      "commit_id" : "0cc5b02bd3b3e9a179b894fad60af639fd370d87",
      "created_at" : "2022-03-17T14:54:23Z",
      "diff_hunk" : "@@ -10,20 +10,17 @@\n \n #include <limits>\n \n-/** Global cache for versionbits deployment status */\n-extern VersionBitsCache g_versionbitscache;\n-\n /** Determine if a deployment is active for the next block */\n inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::BuriedDeployment dep)\n {\n     assert(Consensus::ValidDeployment(dep));\n     return (pindexPrev == nullptr ? 0 : pindexPrev->nHeight + 1) >= params.DeploymentHeight(dep);\n }\n \n-inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep)\n+inline bool DeploymentActiveAfter(const CBlockIndex* pindexPrev, const Consensus::Params& params, Consensus::DeploymentPos dep, VersionBitsCache& versionbitscache)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829176967",
      "id" : 829176967,
      "in_reply_to_id" : 680503657,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xbDyH",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 20,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/deploymentstatus.h",
      "position" : null,
      "pull_request_review_id" : 913224712,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829176967/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-17T14:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829176967",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 0cc5b02bd3b3e9a179b894fad60af639fd370d87 -> 3227a67e2d987953f71b3a2c9dae508fcc1f1a44\r\n- Rebased after merge of #24515",
      "created_at" : "2022-03-17T22:26:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1071653798",
      "id" : 1071653798,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584_4COm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1071653798/reactions"
      },
      "updated_at" : "2022-03-17T22:26:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1071653798",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829790627"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829790627"
         }
      },
      "author_association" : "MEMBER",
      "body" : "first commit: Looks like this hunk can be moved earlier in a separate commit? Seems mostly unrelated to changing the namespace of `pindexBestHeader`\r\n\r\nThis would also simplify review.",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T08:38:11Z",
      "diff_hunk" : "@@ -4140,6 +4139,8 @@ bool ChainstateManager::LoadBlockIndex()\n             if (pindex->nStatus & BLOCK_FAILED_MASK && (!m_best_invalid || pindex->nChainWork > m_best_invalid->nChainWork)) {\n                 m_best_invalid = pindex;\n             }\n+            if (pindex->IsValid(BLOCK_VALID_TREE) && (pindexBestHeader == nullptr || CBlockIndexWorkComparator()(pindexBestHeader, pindex)))\n+                pindexBestHeader = pindex;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829790627",
      "id" : 829790627,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xdZmj",
      "original_commit_id" : "a9552a094d045e595088d4b6f7cf50d9536bdd7f",
      "original_line" : 4143,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 914072813,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829790627/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T09:24:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829790627",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829812540"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829812540"
         }
      },
      "author_association" : "MEMBER",
      "body" : "first commit: Any reason to violate clang-format on this line? I think the excessive and useless whitespace can be removed while touching this line. In line with `CalculateCurrentUsage` below.\r\n\r\n(feel free to ignore, ofc)",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T09:08:23Z",
      "diff_hunk" : "@@ -1207,7 +1207,7 @@ RPCHelpMan getblockchaininfo()\n     UniValue obj(UniValue::VOBJ);\n     obj.pushKV(\"chain\",                 Params().NetworkIDString());\n     obj.pushKV(\"blocks\",                height);\n-    obj.pushKV(\"headers\",               pindexBestHeader ? pindexBestHeader->nHeight : -1);\n+    obj.pushKV(\"headers\",               chainman.pindexBestHeader ? chainman.pindexBestHeader->nHeight : -1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829812540",
      "id" : 829812540,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xde88",
      "original_commit_id" : "a9552a094d045e595088d4b6f7cf50d9536bdd7f",
      "original_line" : 1210,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 914072813,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829812540/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T09:27:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829812540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829813959"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829813959"
         }
      },
      "author_association" : "MEMBER",
      "body" : "first commit: You are touching all lines where `pindexBestHeader` is used. It seems a scripted-diff can be appended to rename it to `m_best_header` without causing additional merge conflicts.",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T09:10:23Z",
      "diff_hunk" : "@@ -212,9 +212,10 @@ class NodeImpl : public Node\n     bool getHeaderTip(int& height, int64_t& block_time) override\n     {\n         LOCK(::cs_main);\n-        if (::pindexBestHeader) {\n-            height = ::pindexBestHeader->nHeight;\n-            block_time = ::pindexBestHeader->GetBlockTime();\n+        auto best_header = chainman().pindexBestHeader;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829813959",
      "id" : 829813959,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xdfTH",
      "original_commit_id" : "a9552a094d045e595088d4b6f7cf50d9536bdd7f",
      "original_line" : 215,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 914072813,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829813959/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T09:24:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829813959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829820943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829820943"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in b7e44255af0fbd11f33b5425af9fba8809c2e2d9: Any reason to make mempool a reference? This conflicts with #22850.\r\n\r\nIt seems probably best to remove this line and leave the other line untouched. This will reduce the diff here and conflicts/code-churn elsewhere.",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T09:19:24Z",
      "diff_hunk" : "@@ -1403,8 +1392,16 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for chain state database\\n\", cache_sizes.coins_db * (1.0 / 1024 / 1024));\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), nMempoolSizeMax * (1.0 / 1024 / 1024));\n \n+    assert(!node.mempool);\n+    assert(!node.chainman);\n     bool fLoaded = false;\n     while (!fLoaded && !ShutdownRequested()) {\n+        node.mempool = std::make_unique<CTxMemPool>(node.fee_estimator.get(), check_ratio);\n+        CTxMemPool& mempool = *Assert(node.mempool);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829820943",
      "id" : 829820943,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xdhAP",
      "original_commit_id" : "b7e44255af0fbd11f33b5425af9fba8809c2e2d9",
      "original_line" : 1400,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 914072813,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829820943/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T09:24:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829820943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829822724"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829822724"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in fc13e841aa2937dfeb067a36f699c7343947cd6d: According to clang-format missing newline?\r\n\r\n\r\n(feel free to ignore, ofc)",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T09:21:46Z",
      "diff_hunk" : "@@ -5138,3 +5134,15 @@ void ChainstateManager::MaybeRebalanceCaches()\n         }\n     }\n }\n+\n+ChainstateManager::~ChainstateManager() {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r829822724",
      "id" : 829822724,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xdhcE",
      "original_commit_id" : "fc13e841aa2937dfeb067a36f699c7343947cd6d",
      "original_line" : 5138,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 914072813,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829822724/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T09:27:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/829822724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 3227a67e2d987953f71b3a2c9dae508fcc1f1a44 -> ddd6bafc16e75e1fb93fd0177f5c5c7c64579095\r\n- Addressed all review comments",
      "created_at" : "2022-03-18T16:47:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1072595379",
      "id" : 1072595379,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII584_7oGz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1072595379/reactions"
      },
      "updated_at" : "2022-03-18T16:47:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1072595379",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180108"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180108"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done 568181625c52568f0af2a2b3c46d636480fc6a67",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T16:48:19Z",
      "diff_hunk" : "@@ -4140,6 +4139,8 @@ bool ChainstateManager::LoadBlockIndex()\n             if (pindex->nStatus & BLOCK_FAILED_MASK && (!m_best_invalid || pindex->nChainWork > m_best_invalid->nChainWork)) {\n                 m_best_invalid = pindex;\n             }\n+            if (pindex->IsValid(BLOCK_VALID_TREE) && (pindexBestHeader == nullptr || CBlockIndexWorkComparator()(pindexBestHeader, pindex)))\n+                pindexBestHeader = pindex;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180108",
      "id" : 830180108,
      "in_reply_to_id" : 829790627,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xe4sM",
      "original_commit_id" : "a9552a094d045e595088d4b6f7cf50d9536bdd7f",
      "original_line" : 4143,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 914616047,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180108/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T16:48:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180108",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180403"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180403"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done: a4d9c6fd64e1d3222e47b8aae162d472957f2d47, 65ac133803386fb19498d3c0fc5f8b27051665af",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T16:48:40Z",
      "diff_hunk" : "@@ -1207,7 +1207,7 @@ RPCHelpMan getblockchaininfo()\n     UniValue obj(UniValue::VOBJ);\n     obj.pushKV(\"chain\",                 Params().NetworkIDString());\n     obj.pushKV(\"blocks\",                height);\n-    obj.pushKV(\"headers\",               pindexBestHeader ? pindexBestHeader->nHeight : -1);\n+    obj.pushKV(\"headers\",               chainman.pindexBestHeader ? chainman.pindexBestHeader->nHeight : -1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180403",
      "id" : 830180403,
      "in_reply_to_id" : 829812540,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xe4wz",
      "original_commit_id" : "a9552a094d045e595088d4b6f7cf50d9536bdd7f",
      "original_line" : 1210,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 914616459,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180403/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T16:48:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180403",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180629"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180629"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T16:48:55Z",
      "diff_hunk" : "@@ -212,9 +212,10 @@ class NodeImpl : public Node\n     bool getHeaderTip(int& height, int64_t& block_time) override\n     {\n         LOCK(::cs_main);\n-        if (::pindexBestHeader) {\n-            height = ::pindexBestHeader->nHeight;\n-            block_time = ::pindexBestHeader->GetBlockTime();\n+        auto best_header = chainman().pindexBestHeader;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180629",
      "id" : 830180629,
      "in_reply_to_id" : 829813959,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xe40V",
      "original_commit_id" : "a9552a094d045e595088d4b6f7cf50d9536bdd7f",
      "original_line" : 215,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 914616763,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180629/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T16:48:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180629",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180813"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180813"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done 276a07f92925c9be82ecd2fe0504323ded1051a1",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T16:49:05Z",
      "diff_hunk" : "@@ -1403,8 +1392,16 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for chain state database\\n\", cache_sizes.coins_db * (1.0 / 1024 / 1024));\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), nMempoolSizeMax * (1.0 / 1024 / 1024));\n \n+    assert(!node.mempool);\n+    assert(!node.chainman);\n     bool fLoaded = false;\n     while (!fLoaded && !ShutdownRequested()) {\n+        node.mempool = std::make_unique<CTxMemPool>(node.fee_estimator.get(), check_ratio);\n+        CTxMemPool& mempool = *Assert(node.mempool);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180813",
      "id" : 830180813,
      "in_reply_to_id" : 829820943,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xe43N",
      "original_commit_id" : "b7e44255af0fbd11f33b5425af9fba8809c2e2d9",
      "original_line" : 1400,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 914616962,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180813/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T16:49:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180964"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180964"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done 607d73a8a21bb3b3848b45cbb9844d58e9934c42",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-18T16:49:15Z",
      "diff_hunk" : "@@ -5138,3 +5134,15 @@ void ChainstateManager::MaybeRebalanceCaches()\n         }\n     }\n }\n+\n+ChainstateManager::~ChainstateManager() {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r830180964",
      "id" : 830180964,
      "in_reply_to_id" : 829822724,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xe45k",
      "original_commit_id" : "fc13e841aa2937dfeb067a36f699c7343947cd6d",
      "original_line" : 5138,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 914617166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180964/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-18T16:49:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830180964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r837913718"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837913718"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"validation: Load pindexBestHeader in ChainMan\" (568181625c52568f0af2a2b3c46d636480fc6a67)\r\n\r\nNote: Apparently relationship between these methods is that ChainstateManager::LoadBlockIndex() calls BlockManager::LoadBlockIndexDB() which calls BlockManager::LoadBlockIndex(). \r\n\r\nCode is moving from inner to outer function, and there is only one call to each of inner functions, so no behavior is changing.",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-03-29T21:09:59Z",
      "diff_hunk" : "@@ -4140,6 +4140,8 @@ bool ChainstateManager::LoadBlockIndex()\n             if (pindex->nStatus & BLOCK_FAILED_MASK && (!m_best_invalid || pindex->nChainWork > m_best_invalid->nChainWork)) {\n                 m_best_invalid = pindex;\n             }\n+            if (pindex->IsValid(BLOCK_VALID_TREE) && (pindexBestHeader == nullptr || CBlockIndexWorkComparator()(pindexBestHeader, pindex)))\n+                pindexBestHeader = pindex;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r837913718",
      "id" : 837913718,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584x8Yx2",
      "original_commit_id" : "568181625c52568f0af2a2b3c46d636480fc6a67",
      "original_line" : 4144,
      "original_position" : 5,
      "original_start_line" : 4143,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 925242048,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837913718/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-04-05T21:00:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837913718",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r843256452"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843256452"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Clear pindexBestHeader in ChainstateManager::Unload()\" (b0b7d756ba6f943f3292734f4fa35a16b8cbabde)\r\n\r\nNote: This seems safe because because the `pindexBestHeader = nullptr` call is moving from `UnloadBlockIndex` function to the `ChainstateManager::Unload()` method, which is called by `UnloadBlockIndex` and no other callers.",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-04-05T20:58:26Z",
      "diff_hunk" : "@@ -5107,6 +5106,7 @@ void ChainstateManager::Unload()\n \n     m_failed_blocks.clear();\n     m_blockman.Unload();\n+    pindexBestHeader = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r843256452",
      "id" : 843256452,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yQxKE",
      "original_commit_id" : "b0b7d756ba6f943f3292734f4fa35a16b8cbabde",
      "original_line" : 5109,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 12,
      "pull_request_review_id" : 925242048,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843256452/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T21:00:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/843256452",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-04-06T07:50:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1089943006",
      "id" : 1089943006,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585A9zXe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1089943006/reactions"
      },
      "updated_at" : "2022-04-06T07:50:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1089943006",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r844400626"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844400626"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"move-mostly: Make fHavePruned a BlockMan member\" (7123f3d8af4e592212439968f4eaaec912ec8d02)\r\n\r\nPossible bug or unrelated change? Before this locked cs_main while calling UndoReadFromDisk, now it now longer does. It does seems good to not lock cs_main while calling UndoReadFromDisk, but it doesn't really make sense as part of this commit.",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-04-06T20:35:35Z",
      "diff_hunk" : "@@ -180,7 +179,7 @@ UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIn\n         case TxVerbosity::SHOW_DETAILS:\n         case TxVerbosity::SHOW_DETAILS_AND_PREVOUT:\n             CBlockUndo blockUndo;\n-            const bool have_undo{WITH_LOCK(::cs_main, return !IsBlockPruned(blockindex) && UndoReadFromDisk(blockUndo, blockindex))};\n+            const bool have_undo{WITH_LOCK(::cs_main, return !blockman.IsBlockPruned(blockindex)) && UndoReadFromDisk(blockUndo, blockindex)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r844400626",
      "id" : 844400626,
      "line" : 182,
      "node_id" : "PRRC_kwDOABII584yVIfy",
      "original_commit_id" : "7123f3d8af4e592212439968f4eaaec912ec8d02",
      "original_line" : 182,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 22,
      "pull_request_review_id" : 934116139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844400626/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-06T20:43:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844400626",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r844405398"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844405398"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Clear fHavePruned in BlockManager::Unload()\" (18d68910bdd4f18eadbf72fa7ec0c0299def3666)\r\n\r\nNote: `BlockManager::Unload()` is only called by `ChainstateManager::Unload()` and the `BlockManager` destructor. `ChainstateManager::Unload()` is only called by `UnloadBlockIndex`. So there is not really a change moving this line from `UnloadBlockIndex`",
      "commit_id" : "ddd6bafc16e75e1fb93fd0177f5c5c7c64579095",
      "created_at" : "2022-04-06T20:42:10Z",
      "diff_hunk" : "@@ -299,6 +299,8 @@ void BlockManager::Unload()\n     m_last_blockfile = 0;\n     m_dirty_blockindex.clear();\n     m_dirty_fileinfo.clear();\n+\n+    fHavePruned = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r844405398",
      "id" : 844405398,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yVJqW",
      "original_commit_id" : "18d68910bdd4f18eadbf72fa7ec0c0299def3666",
      "original_line" : 303,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 5,
      "pull_request_review_id" : 934116139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844405398/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-06T20:43:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844405398",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed ddd6bafc16e75e1fb93fd0177f5c5c7c64579095 -> 26779f2df1f04e5b5ff8b7edf19cd5f1280074d9\r\n- Rebased over master\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/22564#discussion_r844400626",
      "created_at" : "2022-04-12T00:16:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1095723805",
      "id" : 1095723805,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585BT2sd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095723805/reactions"
      },
      "updated_at" : "2022-04-12T00:16:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095723805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r847836026"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847836026"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah! Yes this was unintentional ð \r\nFixed in 85b8b25239f6a7ce1f6877eec52d786352c90872",
      "commit_id" : "26779f2df1f04e5b5ff8b7edf19cd5f1280074d9",
      "created_at" : "2022-04-12T00:17:46Z",
      "diff_hunk" : "@@ -180,7 +179,7 @@ UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIn\n         case TxVerbosity::SHOW_DETAILS:\n         case TxVerbosity::SHOW_DETAILS_AND_PREVOUT:\n             CBlockUndo blockUndo;\n-            const bool have_undo{WITH_LOCK(::cs_main, return !IsBlockPruned(blockindex) && UndoReadFromDisk(blockUndo, blockindex))};\n+            const bool have_undo{WITH_LOCK(::cs_main, return !blockman.IsBlockPruned(blockindex)) && UndoReadFromDisk(blockUndo, blockindex)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r847836026",
      "id" : 847836026,
      "in_reply_to_id" : 844400626,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yiPN6",
      "original_commit_id" : "7123f3d8af4e592212439968f4eaaec912ec8d02",
      "original_line" : 182,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 938730085,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847836026/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-12T00:17:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/847836026",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ryanofsky I love these reviewer notes! Do you think I should put these notes into the commit messages or leaving it on GitHub is fine?",
      "created_at" : "2022-04-12T00:18:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1095725085",
      "id" : 1095725085,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585BT3Ad",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095725085/reactions"
      },
      "updated_at" : "2022-04-12T00:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095725085",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @ryanofsky I love these reviewer notes! Do you think I should put these notes into the commit messages or leaving it on GitHub is fine?\r\n\r\nI'm just writing these notes as breadcrumbs to remind myself how these commits work in case I look at them again. They would make sense in commit messages, though, so feel free to take anything that seems useful.",
      "created_at" : "2022-04-12T00:33:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1095735492",
      "id" : 1095735492,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585BT5jE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095735492/reactions"
      },
      "updated_at" : "2022-04-12T00:33:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095735492",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 26779f2df1f04e5b5ff8b7edf19cd5f1280074d9 -> c6bce70edfe3857b63414f314394cf7b717ffffe:\r\n- No code changes\r\n- Added helpful reviewer comments by ryanofsky",
      "created_at" : "2022-04-12T18:43:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1097079707",
      "id" : 1097079707,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585BZBub",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1097079707/reactions"
      },
      "updated_at" : "2022-04-12T18:43:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1097079707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r850803312"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850803312"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "#24595 moves `g_versionbitscache` into `ChainstateManager` and builds on this PR, so hopefully resolves this thread",
      "commit_id" : "c6bce70edfe3857b63414f314394cf7b717ffffe",
      "created_at" : "2022-04-14T21:04:24Z",
      "diff_hunk" : "@@ -4106,7 +4107,6 @@ void UnloadBlockIndex(CTxMemPool* mempool, ChainstateManager& chainman)\n     LOCK(cs_main);\n     chainman.Unload();\n     if (mempool) mempool->clear();\n-    g_versionbitscache.Clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r850803312",
      "id" : 850803312,
      "in_reply_to_id" : 680508909,
      "line" : 4127,
      "node_id" : "PRRC_kwDOABII584ytjpw",
      "original_commit_id" : "4d00171fc52d9304084e589cf067ff5ed11754b3",
      "original_line" : 4127,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 117,
      "pull_request_review_id" : 942795812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850803312/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-14T21:04:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850803312",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Have you thought about moving the last commit (scripted-diff) right after the prune commit (4032fc9cf943e512319217d21349f2bb3be55129) and then split that part off from this pull? It may be that the move parts are causing the most conflicts, but they take the least time to review in comparison to the other commits. So maybe a split-off can reduce the rebases needed for the later commits in this pull.",
      "created_at" : "2022-04-15T10:03:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1100011503",
      "id" : 1100011503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585BkNfv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1100011503/reactions"
      },
      "updated_at" : "2022-04-15T10:03:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1100011503",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r851191761"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851191761"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Apart from checking that the moved code is called the same number of times, it is also important to check that nothing executed in between the moved code interacts with the moved code.",
      "commit_id" : "c6bce70edfe3857b63414f314394cf7b717ffffe",
      "created_at" : "2022-04-15T10:05:23Z",
      "diff_hunk" : "@@ -4140,6 +4140,8 @@ bool ChainstateManager::LoadBlockIndex()\n             if (pindex->nStatus & BLOCK_FAILED_MASK && (!m_best_invalid || pindex->nChainWork > m_best_invalid->nChainWork)) {\n                 m_best_invalid = pindex;\n             }\n+            if (pindex->IsValid(BLOCK_VALID_TREE) && (pindexBestHeader == nullptr || CBlockIndexWorkComparator()(pindexBestHeader, pindex)))\n+                pindexBestHeader = pindex;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r851191761",
      "id" : 851191761,
      "in_reply_to_id" : 837913718,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yvCfR",
      "original_commit_id" : "568181625c52568f0af2a2b3c46d636480fc6a67",
      "original_line" : 4144,
      "original_position" : 5,
      "original_start_line" : 4143,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 943315743,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851191761/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-04-15T10:05:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851191761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r851529165"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851529165"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Dropping this looks like it leaves `chainman.m_best_invalid` uninitialized",
      "commit_id" : "c6bce70edfe3857b63414f314394cf7b717ffffe",
      "created_at" : "2022-04-15T21:51:50Z",
      "diff_hunk" : "@@ -28,11 +28,8 @@ std::optional<ChainstateLoadingError> LoadChainstate(bool fReset,\n     };\n \n     LOCK(cs_main);\n-    chainman.InitializeChainstate(mempool);\n-    chainman.m_total_coinstip_cache = nCoinCacheUsage;\n-    chainman.m_total_coinsdb_cache = nCoinDBCache;\n \n-    UnloadBlockIndex(mempool, chainman);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r851529165",
      "id" : 851529165,
      "line" : 35,
      "node_id" : "PRRC_kwDOABII584ywU3N",
      "original_commit_id" : "f8afc08153967c527a7c6b1c67d2e03af0eb060e",
      "original_line" : 35,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/node/chainstate.cpp",
      "position" : 8,
      "pull_request_review_id" : 943759983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851529165/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-15T21:51:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851529165",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed fbc58b4cc5274371ff7f883c71a21febc4cc508a -> 018f97c77f90c950c2e633c9a63be43a71f431db\r\n- Split off #24909 per Marco's suggestion: https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1100011503\r\n- Cherry-picked aj's fix for uninitialized error due to no longer calling `UnloadBlockIndex`: https://github.com/bitcoin/bitcoin/pull/24857#issuecomment-1100432492",
      "created_at" : "2022-04-18T18:53:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1101658304",
      "id" : 1101658304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585BqfjA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1101658304/reactions"
      },
      "updated_at" : "2022-04-18T18:54:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1101658304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-04-20T13:30:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1103935479",
      "id" : 1103935479,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585BzLf3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103935479/reactions"
      },
      "updated_at" : "2022-04-20T13:30:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103935479",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 018f97c77f90c950c2e633c9a63be43a71f431db -> b1ab56316ab8cad391676be2e9ca749215603deb\r\n- Rebased over master after merge of #24909",
      "created_at" : "2022-04-20T15:06:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1104042719",
      "id" : 1104042719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585Bzlrf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1104042719/reactions"
      },
      "updated_at" : "2022-04-20T15:06:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1104042719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857731701"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857731701"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Unrelated.\r\n\r\nSometimes I wonder how safe it is to throw in random places in the consensus code and then continue the program. Too bad there is no asserting `at()`.\r\n\r\n![Screenshot from 2022-04-25 17-03-14](https://user-images.githubusercontent.com/6399679/165116935-32ea6030-0142-4d87-b27f-3348e5c98ace.png)\r\n",
      "commit_id" : "b1ab56316ab8cad391676be2e9ca749215603deb",
      "created_at" : "2022-04-25T15:03:41Z",
      "diff_hunk" : "@@ -2533,7 +2533,7 @@ void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n         const CBlockIndex* pindex = pindexNew;\n         for (int bit = 0; bit < VERSIONBITS_NUM_BITS; bit++) {\n             WarningBitsConditionChecker checker(bit);\n-            ThresholdState state = checker.GetStateFor(pindex, m_params.GetConsensus(), warningcache[bit]);\n+            ThresholdState state = checker.GetStateFor(pindex, m_params.GetConsensus(), warningcache.at(bit));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857731701",
      "id" : 857731701,
      "line" : 2536,
      "node_id" : "PRRC_kwDOABII584zH_J1",
      "original_commit_id" : "4373351ead78ce4330698de9e4a51c2fbbba40a6",
      "original_line" : 2536,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 14,
      "pull_request_review_id" : 952023203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857731701/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-25T15:46:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857731701",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857733783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857733783"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in the second commit:\r\n\r\nclang format:\r\n\r\n```diff\r\ndiff --git a/src/validation.h b/src/validation.h\r\nindex caca7f2531..adefc706fd 100644\r\n--- a/src/validation.h\r\n+++ b/src/validation.h\r\n@@ -831,9 +831,9 @@ private:\r\n \r\n     //! If true, the assumed-valid chainstate has been fully validated\r\n     //! by the background validation chainstate.\r\n-    bool m_snapshot_validated GUARDED_BY(::cs_main) {false};\r\n+    bool m_snapshot_validated GUARDED_BY(::cs_main){false};\r\n \r\n-    CBlockIndex* m_best_invalid GUARDED_BY(::cs_main) {nullptr};\r\n+    CBlockIndex* m_best_invalid GUARDED_BY(::cs_main){nullptr};\r\n     friend bool node::BlockManager::LoadBlockIndex(const Consensus::Params&);\r\n \r\n     //! Internal helper for ActivateSnapshot().\r\n",
      "commit_id" : "b1ab56316ab8cad391676be2e9ca749215603deb",
      "created_at" : "2022-04-25T15:05:43Z",
      "diff_hunk" : "@@ -831,9 +831,9 @@ class ChainstateManager\n \n     //! If true, the assumed-valid chainstate has been fully validated\n     //! by the background validation chainstate.\n-    bool m_snapshot_validated{false};\n+    bool m_snapshot_validated GUARDED_BY(::cs_main) {false};\n \n-    CBlockIndex* m_best_invalid;\n+    CBlockIndex* m_best_invalid GUARDED_BY(::cs_main) {nullptr};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857733783",
      "id" : 857733783,
      "line" : 834,
      "node_id" : "PRRC_kwDOABII584zH_qX",
      "original_commit_id" : "4be05be37aad73adb5211ef039e43089ba373bcf",
      "original_line" : 836,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 8,
      "pull_request_review_id" : 952023203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857733783/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-25T15:46:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857733783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857743735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857743735"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In the third commit:\r\n\r\nI think this should be moved as well, otherwise it is easy to confuse it with some other check_ratio\r\n\r\nEdit: I see it is renamed later, but I still think it could make sense to move as well.",
      "commit_id" : "b1ab56316ab8cad391676be2e9ca749215603deb",
      "created_at" : "2022-04-25T15:15:10Z",
      "diff_hunk" : "@@ -1269,18 +1269,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     // as they would never get updated.\n     if (!ignores_incoming_txs) node.fee_estimator = std::make_unique<CBlockPolicyEstimator>();\n \n-    assert(!node.mempool);\n     int check_ratio = std::min<int>(std::max<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0), 1000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857743735",
      "id" : 857743735,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zICF3",
      "original_commit_id" : "d04d3c4c1f271fd926c15ba979990c02651de9cd",
      "original_line" : 1272,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 5,
      "pull_request_review_id" : 952023203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857743735/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-25T15:46:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857743735",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857759781"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857759781"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also, would it be better to split the peerman move into a separate commit?\r\n\r\nAlso, it would be best to do a rebase first to pull in the intermediate changes to init.cpp?",
      "commit_id" : "b1ab56316ab8cad391676be2e9ca749215603deb",
      "created_at" : "2022-04-25T15:30:36Z",
      "diff_hunk" : "@@ -1269,18 +1269,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     // as they would never get updated.\n     if (!ignores_incoming_txs) node.fee_estimator = std::make_unique<CBlockPolicyEstimator>();\n \n-    assert(!node.mempool);\n     int check_ratio = std::min<int>(std::max<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0), 1000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857759781",
      "id" : 857759781,
      "in_reply_to_id" : 857743735,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zIGAl",
      "original_commit_id" : "d04d3c4c1f271fd926c15ba979990c02651de9cd",
      "original_line" : 1272,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 5,
      "pull_request_review_id" : 952023203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857759781/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-25T15:46:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857759781",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857824438"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857824438"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done in fd6e94252e0860831527293fe9aa743044ca635f",
      "commit_id" : "133d98f446217f0fa37aa5b067fb74d3ac4e3b01",
      "created_at" : "2022-04-25T16:38:18Z",
      "diff_hunk" : "@@ -831,9 +831,9 @@ class ChainstateManager\n \n     //! If true, the assumed-valid chainstate has been fully validated\n     //! by the background validation chainstate.\n-    bool m_snapshot_validated{false};\n+    bool m_snapshot_validated GUARDED_BY(::cs_main) {false};\n \n-    CBlockIndex* m_best_invalid;\n+    CBlockIndex* m_best_invalid GUARDED_BY(::cs_main) {nullptr};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857824438",
      "id" : 857824438,
      "in_reply_to_id" : 857733783,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zIVy2",
      "original_commit_id" : "4be05be37aad73adb5211ef039e43089ba373bcf",
      "original_line" : 836,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 952161345,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857824438/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-25T16:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857824438",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857825532"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857825532"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think this should be moved as well, otherwise it is easy to confuse it with some other check_ratio\r\n\r\nDone in 976679b251e417d3aa7329807f3d934944ab5252\r\n\r\n> Also, would it be better to split the peerman move into a separate commit?\r\n\r\nDon't think so, the diff itself isn't that large, and the peerman move only makes sense in the context of moving the mempool and chainman\r\n\r\n> Also, it would be best to do a rebase first to pull in the intermediate changes to init.cpp?\r\n\r\nDone as of the 133d98f446217f0fa37aa5b067fb74d3ac4e3b01 push",
      "commit_id" : "133d98f446217f0fa37aa5b067fb74d3ac4e3b01",
      "created_at" : "2022-04-25T16:39:40Z",
      "diff_hunk" : "@@ -1269,18 +1269,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     // as they would never get updated.\n     if (!ignores_incoming_txs) node.fee_estimator = std::make_unique<CBlockPolicyEstimator>();\n \n-    assert(!node.mempool);\n     int check_ratio = std::min<int>(std::max<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0), 1000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r857825532",
      "id" : 857825532,
      "in_reply_to_id" : 857743735,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zIWD8",
      "original_commit_id" : "d04d3c4c1f271fd926c15ba979990c02651de9cd",
      "original_line" : 1272,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 952162815,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857825532/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-25T16:39:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857825532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed b1ab56316ab8cad391676be2e9ca749215603deb -> 133d98f446217f0fa37aa5b067fb74d3ac4e3b01\r\n- Rebased over master\r\n- Addressed Marco's review comments (thanks Marco!)",
      "created_at" : "2022-04-25T16:40:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1108800169",
      "id" : 1108800169,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585CFvKp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108800169/reactions"
      },
      "updated_at" : "2022-04-25T16:40:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108800169",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859382018"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859382018"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "There is a compile-time erroring `at()` -- `std::get<N>(my_array)` won't compile if `N` is outside the range. I've got a patchset that switches versionbits to working that way, fwiw; needs a lot of tidying up yet though, and builds on these patches.",
      "commit_id" : "678f5c5a623771f52d5e270cc79c76b87db3e688",
      "created_at" : "2022-04-27T04:59:07Z",
      "diff_hunk" : "@@ -2533,7 +2533,7 @@ void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n         const CBlockIndex* pindex = pindexNew;\n         for (int bit = 0; bit < VERSIONBITS_NUM_BITS; bit++) {\n             WarningBitsConditionChecker checker(bit);\n-            ThresholdState state = checker.GetStateFor(pindex, m_params.GetConsensus(), warningcache[bit]);\n+            ThresholdState state = checker.GetStateFor(pindex, m_params.GetConsensus(), warningcache.at(bit));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859382018",
      "id" : 859382018,
      "in_reply_to_id" : 857731701,
      "line" : 2553,
      "node_id" : "PRRC_kwDOABII584zOSEC",
      "original_commit_id" : "4373351ead78ce4330698de9e4a51c2fbbba40a6",
      "original_line" : 2553,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 14,
      "pull_request_review_id" : 954316458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859382018/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T04:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859382018",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859392826"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859392826"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "super nitty: `make_unique` throws if it can't allocate, so the `Assert` here shouldn't be needed?",
      "commit_id" : "678f5c5a623771f52d5e270cc79c76b87db3e688",
      "created_at" : "2022-04-27T05:15:55Z",
      "diff_hunk" : "@@ -1429,8 +1416,17 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for chain state database\\n\", cache_sizes.coins_db * (1.0 / 1024 / 1024));\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), nMempoolSizeMax * (1.0 / 1024 / 1024));\n \n+    assert(!node.mempool);\n+    assert(!node.chainman);\n+    int check_ratio = std::min<int>(std::max<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0), 1000000);\n+\n     bool fLoaded = false;\n     while (!fLoaded && !ShutdownRequested()) {\n+        node.mempool = std::make_unique<CTxMemPool>(node.fee_estimator.get(), check_ratio);\n+\n+        node.chainman = std::make_unique<ChainstateManager>();\n+        ChainstateManager& chainman = *Assert(node.chainman);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859392826",
      "id" : 859392826,
      "line" : 1428,
      "node_id" : "PRRC_kwDOABII584zOUs6",
      "original_commit_id" : "09574d7ad74fc6e46c5d7311e4662b56f0f9426f",
      "original_line" : 1428,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 33,
      "pull_request_review_id" : 954330970,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859392826/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T05:39:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859392826",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859395674"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859395674"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why are `m_total_coinstip_cache` and `m_total_coinsdb_cache` not initialized anymore? As it stands, bitcoind compiles with both those members marked as `static constexpr` which doesn't seem right...",
      "commit_id" : "678f5c5a623771f52d5e270cc79c76b87db3e688",
      "created_at" : "2022-04-27T05:22:49Z",
      "diff_hunk" : "@@ -28,11 +28,8 @@ std::optional<ChainstateLoadingError> LoadChainstate(bool fReset,\n     };\n \n     LOCK(cs_main);\n-    chainman.InitializeChainstate(mempool);\n-    chainman.m_total_coinstip_cache = nCoinCacheUsage;\n-    chainman.m_total_coinsdb_cache = nCoinDBCache;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859395674",
      "id" : 859395674,
      "line" : 33,
      "node_id" : "PRRC_kwDOABII584zOVZa",
      "original_commit_id" : "09574d7ad74fc6e46c5d7311e4662b56f0f9426f",
      "original_line" : 33,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/node/chainstate.cpp",
      "position" : 6,
      "pull_request_review_id" : 954330970,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859395674/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T05:39:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859395674",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859396462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859396462"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If retouching, maybe add a `const`",
      "commit_id" : "678f5c5a623771f52d5e270cc79c76b87db3e688",
      "created_at" : "2022-04-27T05:24:35Z",
      "diff_hunk" : "@@ -1418,10 +1419,10 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     assert(!node.mempool);\n     assert(!node.chainman);\n-    int check_ratio = std::min<int>(std::max<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0), 1000000);\n+    int mempool_check_ratio = std::clamp<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0, 1000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859396462",
      "id" : 859396462,
      "line" : 1422,
      "node_id" : "PRRC_kwDOABII584zOVlu",
      "original_commit_id" : "66201eab01e169f8ae230570d4296943ff84964c",
      "original_line" : 1422,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 13,
      "pull_request_review_id" : 954330970,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859396462/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T05:39:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859396462",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859399440"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859399440"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The previous commit should have dropped the `nullptr` from this call.",
      "commit_id" : "678f5c5a623771f52d5e270cc79c76b87db3e688",
      "created_at" : "2022-04-27T05:31:15Z",
      "diff_hunk" : "@@ -256,7 +256,5 @@ int main(int argc, char* argv[])\n     }\n     GetMainSignals().UnregisterBackgroundSignalScheduler();\n \n-    WITH_LOCK(::cs_main, UnloadBlockIndex(nullptr, chainman));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859399440",
      "id" : 859399440,
      "line" : 259,
      "node_id" : "PRRC_kwDOABII584zOWUQ",
      "original_commit_id" : "678f5c5a623771f52d5e270cc79c76b87db3e688",
      "original_line" : 259,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/bitcoin-chainstate.cpp",
      "position" : 4,
      "pull_request_review_id" : 954330970,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859399440/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T05:39:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859399440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859908834"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859908834"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: Convert warningcache to std::array\" (98f4bdae81804de17f125bd7c2cd8a48e850a6d2)\r\n\r\nThis commit seems ok but it's not clear why it's good or what the connection is to the PR. Would be good to mention in commit message.",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-27T14:59:06Z",
      "diff_hunk" : "@@ -1921,7 +1921,7 @@ class WarningBitsConditionChecker : public AbstractThresholdConditionChecker\n     }\n };\n \n-static ThresholdConditionCache warningcache[VERSIONBITS_NUM_BITS] GUARDED_BY(cs_main);\n+static std::array<ThresholdConditionCache, VERSIONBITS_NUM_BITS> warningcache GUARDED_BY(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859908834",
      "id" : 859908834,
      "line" : 1924,
      "node_id" : "PRRC_kwDOABII584zQSri",
      "original_commit_id" : "98f4bdae81804de17f125bd7c2cd8a48e850a6d2",
      "original_line" : 1924,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 955059985,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859908834/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T17:17:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859908834",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859927168"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927168"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed as of 7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-27T15:15:21Z",
      "diff_hunk" : "@@ -1429,8 +1416,17 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     LogPrintf(\"* Using %.1f MiB for chain state database\\n\", cache_sizes.coins_db * (1.0 / 1024 / 1024));\n     LogPrintf(\"* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)\\n\", cache_sizes.coins * (1.0 / 1024 / 1024), nMempoolSizeMax * (1.0 / 1024 / 1024));\n \n+    assert(!node.mempool);\n+    assert(!node.chainman);\n+    int check_ratio = std::min<int>(std::max<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0), 1000000);\n+\n     bool fLoaded = false;\n     while (!fLoaded && !ShutdownRequested()) {\n+        node.mempool = std::make_unique<CTxMemPool>(node.fee_estimator.get(), check_ratio);\n+\n+        node.chainman = std::make_unique<ChainstateManager>();\n+        ChainstateManager& chainman = *Assert(node.chainman);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859927168",
      "id" : 859927168,
      "in_reply_to_id" : 859392826,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zQXKA",
      "original_commit_id" : "09574d7ad74fc6e46c5d7311e4662b56f0f9426f",
      "original_line" : 1428,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 955086171,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927168/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T15:15:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927168",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859927248"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927248"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed as of 7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-27T15:15:25Z",
      "diff_hunk" : "@@ -28,11 +28,8 @@ std::optional<ChainstateLoadingError> LoadChainstate(bool fReset,\n     };\n \n     LOCK(cs_main);\n-    chainman.InitializeChainstate(mempool);\n-    chainman.m_total_coinstip_cache = nCoinCacheUsage;\n-    chainman.m_total_coinsdb_cache = nCoinDBCache;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859927248",
      "id" : 859927248,
      "in_reply_to_id" : 859395674,
      "line" : 33,
      "node_id" : "PRRC_kwDOABII584zQXLQ",
      "original_commit_id" : "09574d7ad74fc6e46c5d7311e4662b56f0f9426f",
      "original_line" : 33,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/node/chainstate.cpp",
      "position" : 2,
      "pull_request_review_id" : 955086276,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927248/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T15:15:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927248",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859927352"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927352"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed as of 7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-27T15:15:31Z",
      "diff_hunk" : "@@ -1418,10 +1419,10 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     assert(!node.mempool);\n     assert(!node.chainman);\n-    int check_ratio = std::min<int>(std::max<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0), 1000000);\n+    int mempool_check_ratio = std::clamp<int>(args.GetIntArg(\"-checkmempool\", chainparams.DefaultConsistencyChecks() ? 1 : 0), 0, 1000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859927352",
      "id" : 859927352,
      "in_reply_to_id" : 859396462,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zQXM4",
      "original_commit_id" : "66201eab01e169f8ae230570d4296943ff84964c",
      "original_line" : 1422,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 955086442,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927352/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T15:15:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927352",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859927438"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927438"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed as of 7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-27T15:15:35Z",
      "diff_hunk" : "@@ -256,7 +256,5 @@ int main(int argc, char* argv[])\n     }\n     GetMainSignals().UnregisterBackgroundSignalScheduler();\n \n-    WITH_LOCK(::cs_main, UnloadBlockIndex(nullptr, chainman));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859927438",
      "id" : 859927438,
      "in_reply_to_id" : 859399440,
      "line" : 259,
      "node_id" : "PRRC_kwDOABII584zQXOO",
      "original_commit_id" : "678f5c5a623771f52d5e270cc79c76b87db3e688",
      "original_line" : 259,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/bitcoin-chainstate.cpp",
      "position" : 4,
      "pull_request_review_id" : 955086552,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927438/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T15:15:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859927438",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 678f5c5a623771f52d5e270cc79c76b87db3e688 -> 7ab07e033237d6ea179a6a2c76575ed6bd01a670\r\n- Addressed outstanding reviews (Thanks AJ!)",
      "created_at" : "2022-04-27T15:17:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1111129208",
      "id" : 1111129208,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585COnx4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111129208/reactions"
      },
      "updated_at" : "2022-04-27T15:17:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111129208",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859938286"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859938286"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"init: Reset mempool and chainman via reconstruction\" (976679b251e417d3aa7329807f3d934944ab5252)\r\n\r\nIs it ok for peerman to register for validation notification events later than before? Maybe because none will be sent above, or because peerman doesn't care about ones that would be sent? (would be helpful info for commit message)",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-27T15:25:28Z",
      "diff_hunk" : "@@ -1562,6 +1558,13 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n         return false;\n     }\n \n+    ChainstateManager& chainman = *Assert(node.chainman);\n+\n+    assert(!node.peerman);\n+    node.peerman = PeerManager::make(chainparams, *node.connman, *node.addrman, node.banman.get(),\n+                                     chainman, *node.mempool, ignores_incoming_txs);\n+    RegisterValidationInterface(node.peerman.get());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859938286",
      "id" : 859938286,
      "line" : 1566,
      "node_id" : "PRRC_kwDOABII584zQZ3u",
      "original_commit_id" : "5921b863e39e5c3997895ffee1c87159e37a5d6f",
      "original_line" : 1566,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 47,
      "pull_request_review_id" : 955059985,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859938286/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T17:17:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859938286",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859939213"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859939213"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"init: Reset mempool and chainman via reconstruction\" (5921b863e39e5c3997895ffee1c87159e37a5d6f)\r\n\r\nUnloadBlockIndex is still clearing g_versionbitscache and warningcache at this point. Should this commit come after the later commit \"Clear {versionbits,warning}cache in ~Chainstatemanager\" (572d8319272ae84a81d6bfd53dd9685585697f65) to avoid changing behavior?",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-27T15:26:19Z",
      "diff_hunk" : "@@ -32,8 +32,6 @@ std::optional<ChainstateLoadingError> LoadChainstate(bool fReset,\n     chainman.m_total_coinstip_cache = nCoinCacheUsage;\n     chainman.m_total_coinsdb_cache = nCoinDBCache;\n \n-    UnloadBlockIndex(mempool, chainman);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859939213",
      "id" : 859939213,
      "line" : 35,
      "node_id" : "PRRC_kwDOABII584zQaGN",
      "original_commit_id" : "5921b863e39e5c3997895ffee1c87159e37a5d6f",
      "original_line" : 35,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/node/chainstate.cpp",
      "position" : 4,
      "pull_request_review_id" : 955059985,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859939213/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T17:17:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859939213",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859979063"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859979063"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Clear {versionbits,warning}cache in ~Chainstatemanager\" (572d8319272ae84a81d6bfd53dd9685585697f65)\r\n\r\nIt would seem more appropriate to clear these variables in the constructor not the destructor. Using the constructor to initialize things a class needs is more straightforward than doing things in the destructor to prepare for a future instance being created.",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-27T16:03:46Z",
      "diff_hunk" : "@@ -5231,3 +5227,16 @@ void ChainstateManager::MaybeRebalanceCaches()\n         }\n     }\n }\n+\n+ChainstateManager::~ChainstateManager()\n+{\n+    LOCK(::cs_main);\n+    UnloadBlockIndex(/*mempool=*/nullptr, *this);\n+\n+    // TODO: The version bits cache and warning cache should probably become\n+    // non-globals\n+    g_versionbitscache.Clear();\n+    for (auto& i : warningcache) {\n+        i.clear();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r859979063",
      "id" : 859979063,
      "line" : 5216,
      "node_id" : "PRRC_kwDOABII584zQj03",
      "original_commit_id" : "572d8319272ae84a81d6bfd53dd9685585697f65",
      "original_line" : 5241,
      "original_position" : 26,
      "original_start_line" : 5236,
      "path" : "src/validation.cpp",
      "position" : 26,
      "pull_request_review_id" : 955059985,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859979063/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 5211,
      "start_side" : "RIGHT",
      "updated_at" : "2022-04-27T17:17:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859979063",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860530163"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860530163"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it is just \"updating the code\", since it is already touched for other reasons in this PR",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-28T06:31:25Z",
      "diff_hunk" : "@@ -1921,7 +1921,7 @@ class WarningBitsConditionChecker : public AbstractThresholdConditionChecker\n     }\n };\n \n-static ThresholdConditionCache warningcache[VERSIONBITS_NUM_BITS] GUARDED_BY(cs_main);\n+static std::array<ThresholdConditionCache, VERSIONBITS_NUM_BITS> warningcache GUARDED_BY(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860530163",
      "id" : 860530163,
      "in_reply_to_id" : 859908834,
      "line" : 1924,
      "node_id" : "PRRC_kwDOABII584zSqXz",
      "original_commit_id" : "98f4bdae81804de17f125bd7c2cd8a48e850a6d2",
      "original_line" : 1924,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 955922497,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860530163/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-28T06:31:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860530163",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860531223"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860531223"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nice. TIL https://en.cppreference.com/w/cpp/container/array/get",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-28T06:33:14Z",
      "diff_hunk" : "@@ -2533,7 +2533,7 @@ void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n         const CBlockIndex* pindex = pindexNew;\n         for (int bit = 0; bit < VERSIONBITS_NUM_BITS; bit++) {\n             WarningBitsConditionChecker checker(bit);\n-            ThresholdState state = checker.GetStateFor(pindex, m_params.GetConsensus(), warningcache[bit]);\n+            ThresholdState state = checker.GetStateFor(pindex, m_params.GetConsensus(), warningcache.at(bit));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860531223",
      "id" : 860531223,
      "in_reply_to_id" : 857731701,
      "line" : 2553,
      "node_id" : "PRRC_kwDOABII584zSqoX",
      "original_commit_id" : "4373351ead78ce4330698de9e4a51c2fbbba40a6",
      "original_line" : 2553,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 14,
      "pull_request_review_id" : 955924058,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860531223/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-28T06:33:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860531223",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860540808"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860540808"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My understanding was that no events are sent, since blocks and the mempool are only imported later on",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-28T06:48:19Z",
      "diff_hunk" : "@@ -1562,6 +1558,13 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n         return false;\n     }\n \n+    ChainstateManager& chainman = *Assert(node.chainman);\n+\n+    assert(!node.peerman);\n+    node.peerman = PeerManager::make(chainparams, *node.connman, *node.addrman, node.banman.get(),\n+                                     chainman, *node.mempool, ignores_incoming_txs);\n+    RegisterValidationInterface(node.peerman.get());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860540808",
      "id" : 860540808,
      "in_reply_to_id" : 859938286,
      "line" : 1566,
      "node_id" : "PRRC_kwDOABII584zSs-I",
      "original_commit_id" : "5921b863e39e5c3997895ffee1c87159e37a5d6f",
      "original_line" : 1566,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 47,
      "pull_request_review_id" : 955937359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860540808/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-28T06:48:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860540808",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860559764"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860559764"
         }
      },
      "author_association" : "MEMBER",
      "body" : "And it looks like (from testing) with existing blocks and without import/reindex/empty datadir *no* events are sent at all during startup. I can only see events when the block import thread is running.",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-28T07:15:23Z",
      "diff_hunk" : "@@ -1562,6 +1558,13 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n         return false;\n     }\n \n+    ChainstateManager& chainman = *Assert(node.chainman);\n+\n+    assert(!node.peerman);\n+    node.peerman = PeerManager::make(chainparams, *node.connman, *node.addrman, node.banman.get(),\n+                                     chainman, *node.mempool, ignores_incoming_txs);\n+    RegisterValidationInterface(node.peerman.get());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860559764",
      "id" : 860559764,
      "in_reply_to_id" : 859938286,
      "line" : 1566,
      "node_id" : "PRRC_kwDOABII584zSxmU",
      "original_commit_id" : "5921b863e39e5c3997895ffee1c87159e37a5d6f",
      "original_line" : 1566,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 47,
      "pull_request_review_id" : 955964186,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860559764/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-28T07:15:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860559764",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 7ab07e033237d6ea179a6a2c76575ed6bd01a670 ð\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nACK 7ab07e033237d6ea179a6a2c76575ed6bd01a670 ð\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUhluAwAl/H737rZZOleCgVaxyEu2ymxIHFJINMjj3ivDb0m/PhKo/ebMuzRiHe+\r\n4tLOLlbIAWDh53hh6GBcdJRqKSWPUpED45VaEAF/icNYwUhWaaXavfqfHPwcZ6ud\r\nV436tvffYSKlKoEtMBUupJQ4Ah951vAPwTDFVVr8nNexs5EpmAHei+WdB3hJjht3\r\nUZO2KaLcPrFVfgSJaHEB2Ea2zdpp3NXBAqfLO/QMPaUYcEdUcW4JjVj4uYSaQsv/\r\nwe+/rcmw6f5hGPSvUENkkXa9LaEfGaLrNwp/oB5pa4o+4wIVbI6RQluNtSe1HyJz\r\n1hijjwuV3x/ozky4zB/py1ETlJ1tW4G+UIYFf7b65lV+wymt/Cfx8TM3ijXh47Ha\r\nF5VBksvCvgbmAmLr2Vel7xZHq+jdxbuiU2t+uS2iBY+zNZ+2THEizCEV7hxVOQnB\r\nvAGVKwxMc23sbBUOOnp1jC10xHJer7BbbFdksfrx/f/Evmwa8XKaX5ObpZMx2quu\r\n4u0iV6Pf\r\n=Lld+\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n\r\n</details>\r\n",
      "created_at" : "2022-04-28T07:39:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1111853890",
      "id" : 1111853890,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585CRYtC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111853890/reactions"
      },
      "updated_at" : "2022-04-28T07:39:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111853890",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-28T10:06:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#issuecomment-1112008121",
      "id" : 1112008121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22564",
      "node_id" : "IC_kwDOABII585CR-W5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1112008121/reactions"
      },
      "updated_at" : "2022-04-28T10:06:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1112008121",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860718740"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860718740"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Have you seen https://github.com/bitcoin/bitcoin/pull/22564#discussion_r680508909 ?",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-28T10:12:59Z",
      "diff_hunk" : "@@ -32,8 +32,6 @@ std::optional<ChainstateLoadingError> LoadChainstate(bool fReset,\n     chainman.m_total_coinstip_cache = nCoinCacheUsage;\n     chainman.m_total_coinsdb_cache = nCoinDBCache;\n \n-    UnloadBlockIndex(mempool, chainman);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860718740",
      "id" : 860718740,
      "in_reply_to_id" : 859939213,
      "line" : 35,
      "node_id" : "PRRC_kwDOABII584zTYaU",
      "original_commit_id" : "5921b863e39e5c3997895ffee1c87159e37a5d6f",
      "original_line" : 35,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/node/chainstate.cpp",
      "position" : 4,
      "pull_request_review_id" : 956188693,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860718740/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-28T10:12:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860718740",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860719050"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860719050"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe this can be discussed in the versionbits follow-up?",
      "commit_id" : "7ab07e033237d6ea179a6a2c76575ed6bd01a670",
      "created_at" : "2022-04-28T10:13:22Z",
      "diff_hunk" : "@@ -5231,3 +5227,16 @@ void ChainstateManager::MaybeRebalanceCaches()\n         }\n     }\n }\n+\n+ChainstateManager::~ChainstateManager()\n+{\n+    LOCK(::cs_main);\n+    UnloadBlockIndex(/*mempool=*/nullptr, *this);\n+\n+    // TODO: The version bits cache and warning cache should probably become\n+    // non-globals\n+    g_versionbitscache.Clear();\n+    for (auto& i : warningcache) {\n+        i.clear();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22564#discussion_r860719050",
      "id" : 860719050,
      "in_reply_to_id" : 859979063,
      "line" : 5216,
      "node_id" : "PRRC_kwDOABII584zTYfK",
      "original_commit_id" : "572d8319272ae84a81d6bfd53dd9685585697f65",
      "original_line" : 5241,
      "original_position" : 26,
      "original_start_line" : 5236,
      "path" : "src/validation.cpp",
      "position" : 26,
      "pull_request_review_id" : 956189148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22564",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860719050/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 5211,
      "start_side" : "RIGHT",
      "updated_at" : "2022-04-28T10:13:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860719050",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
