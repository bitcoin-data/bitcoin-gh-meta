[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25005](https://github.com/bitcoin/bitcoin/pull/25005) (wallet: remove extra wtx lookup in 'AvailableCoins' + several code cleanups. by furszy)\n* [#24845](https://github.com/bitcoin/bitcoin/pull/24845) (wallet: createTransaction, return proper error description for  \"too-long-mempool-chain\" + introduce generic Result classes by furszy)\n* [#24699](https://github.com/bitcoin/bitcoin/pull/24699) (wallet: Improve AvailableCoins performance by reducing duplicated operations by achow101)\n* [#23475](https://github.com/bitcoin/bitcoin/pull/23475) (wallet: add config to prioritize a solution that doesn't create change in coin selection by brunoerg)\n* [#20640](https://github.com/bitcoin/bitcoin/pull/20640) (wallet, refactor: return out-params of CreateTransaction() as optional struct by theStack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-04-05T00:56:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#issuecomment-1088165344",
      "id" : 1088165344,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24752",
      "node_id" : "IC_kwDOABII585A3BXg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088165344/reactions"
      },
      "updated_at" : "2022-05-17T05:59:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088165344",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r844973896"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844973896"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    SelectionResult result(selection_target, /*force_no_change=*/true);\r\n```\r\nAnywhere you are adding/touching named args, please use the [style from the developer docs](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#coding-style-c-named-arguments).",
      "commit_id" : "3c106cc578eb2682fb5eab6b03fe3f5e108034b9",
      "created_at" : "2022-04-07T10:26:18Z",
      "diff_hunk" : "@@ -62,9 +62,9 @@ struct {\n \n static const size_t TOTAL_TRIES = 100000;\n \n-std::optional<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change)\n+std::optional<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& upper_bound)\n {\n-    SelectionResult result(selection_target);\n+    SelectionResult result(selection_target, /* force_no_change=*/ true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r844973896",
      "id" : 844973896,
      "line" : 67,
      "node_id" : "PRRC_kwDOABII584yXUdI",
      "original_commit_id" : "3c106cc578eb2682fb5eab6b03fe3f5e108034b9",
      "original_line" : 67,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 8,
      "pull_request_review_id" : 934837861,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844973896/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-07T10:26:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844973896",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r845368222"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/845368222"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Sure, will fix that",
      "commit_id" : "3c106cc578eb2682fb5eab6b03fe3f5e108034b9",
      "created_at" : "2022-04-07T16:51:52Z",
      "diff_hunk" : "@@ -62,9 +62,9 @@ struct {\n \n static const size_t TOTAL_TRIES = 100000;\n \n-std::optional<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change)\n+std::optional<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& upper_bound)\n {\n-    SelectionResult result(selection_target);\n+    SelectionResult result(selection_target, /* force_no_change=*/ true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r845368222",
      "id" : 845368222,
      "in_reply_to_id" : 844973896,
      "line" : 67,
      "node_id" : "PRRC_kwDOABII584yY0ue",
      "original_commit_id" : "3c106cc578eb2682fb5eab6b03fe3f5e108034b9",
      "original_line" : 67,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 8,
      "pull_request_review_id" : 935395728,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/845368222/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-07T16:51:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/845368222",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@achow101 take a look. I reworked my BnB optimization and all the tests pass now. I think the next step would be to do simulations and see how this affects coin selection at large (but locally it fixes some of the edge cases found in #24580)",
      "created_at" : "2022-04-07T16:55:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#issuecomment-1091981193",
      "id" : 1091981193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24752",
      "node_id" : "IC_kwDOABII585BFk-J",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1091981193/reactions"
      },
      "updated_at" : "2022-04-07T16:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1091981193",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-04-26T18:42:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#issuecomment-1110131314",
      "id" : 1110131314,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24752",
      "node_id" : "IC_kwDOABII585CK0Jy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110131314/reactions"
      },
      "updated_at" : "2022-04-26T18:42:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110131314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r860571366"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860571366"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "fixed",
      "commit_id" : "9e9c114e5850f7f7e6baedba96018affbd8050f1",
      "created_at" : "2022-04-28T07:29:41Z",
      "diff_hunk" : "@@ -62,9 +62,9 @@ struct {\n \n static const size_t TOTAL_TRIES = 100000;\n \n-std::optional<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change)\n+std::optional<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& upper_bound)\n {\n-    SelectionResult result(selection_target);\n+    SelectionResult result(selection_target, /* force_no_change=*/ true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r860571366",
      "id" : 860571366,
      "in_reply_to_id" : 844973896,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zS0bm",
      "original_commit_id" : "3c106cc578eb2682fb5eab6b03fe3f5e108034b9",
      "original_line" : 67,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : null,
      "pull_request_review_id" : 955980506,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860571366/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-28T07:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/860571366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868328003"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868328003"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note for reviewers/myself: It should be 10 vB for non-segwit transactions, and 42 WU for segwit transactions (as the witness adds the two fields `marker` and `flag` that don't scale with the count of inputs. So, this is correct for non-segwit transactions, but would be short for a segwit transaction.",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T18:54:41Z",
      "diff_hunk" : "@@ -760,7 +760,8 @@ static bool CreateTransactionInternal(\n \n     // vouts to the payees\n     if (!coin_selection_params.m_subtract_fee_outputs) {\n-        coin_selection_params.tx_noinputs_size = 11; // Static vsize overhead + outputs vsize. 4 nVersion, 4 nLocktime, 1 input count, 1 output count, 1 witness overhead (dummy, flag, stack size)\n+        coin_selection_params.tx_noinputs_size = 10; // Static vsize overhead + outputs vsize. 4 nVersion, 4 nLocktime, 1 input count, 1 witness overhead (dummy, flag, stack size)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868328003",
      "id" : 868328003,
      "line" : 782,
      "node_id" : "PRRC_kwDOABII584zwaJD",
      "original_commit_id" : "27441c7253d0d0a79f95a50efebbd17a4c3553e2",
      "original_line" : 763,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 5,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868328003/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868328003",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868347706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868347706"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note to other reviewers: it wasn't obvious to me at first why this replacement is possible, but I found that `use_max_sig` is directly calculated from `CCoinControl` values. Perhaps this could be mentioned in the commit message.\r\n\r\n> ./src/wallet/wallet.cpp:        const bool use_max_sig = coin_control && (coin_control->fAllowWatchOnly || coin_control->IsExternalSelected(txin.prevout));\r\n",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:14:48Z",
      "diff_hunk" : "@@ -27,25 +27,25 @@ using interfaces::FoundBlock;\n namespace wallet {\n static constexpr size_t OUTPUT_GROUP_MAX_ENTRIES{100};\n \n-int GetTxSpendSize(const CWallet& wallet, const CWalletTx& wtx, unsigned int out, bool use_max_sig)\n+int GetTxSpendSize(const CWallet& wallet, const CWalletTx& wtx, unsigned int out, const CCoinControl* coin_control)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868347706",
      "id" : 868347706,
      "line" : 30,
      "node_id" : "PRRC_kwDOABII584zwe86",
      "original_commit_id" : "e4cfbe5e7b8b91c5f089e169539dc3723f9a2897",
      "original_line" : 30,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 5,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868347706/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868347706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868361193"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868361193"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see how this is just a refactor, and doesn't change the result, but it's not clear to me why it's being done. Could you add a sentence of motivation to the commit message?",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:26:53Z",
      "diff_hunk" : "@@ -398,11 +398,8 @@ std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAm\n         results.push_back(*knapsack_result);\n     }\n \n-    // Include change for SRD as we want to avoid making really small change if the selection just\n-    // barely meets the target. Just use the lower bound change target instead of the randomly\n-    // generated one, since SRD will result in a random change amount anyway; avoid making the\n-    // target needlessly large.\n-    const CAmount srd_target = nTargetValue + coin_selection_params.m_change_fee + CHANGE_LOWER;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868361193",
      "id" : 868361193,
      "line" : 405,
      "node_id" : "PRRC_kwDOABII584zwiPp",
      "original_commit_id" : "9be243779eb02fd36e1c9a4ae6fa8b54b1ea50b1",
      "original_line" : 405,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 8,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868361193/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868361193",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868369284"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868369284"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nice catch!",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:34:45Z",
      "diff_hunk" : "@@ -390,17 +390,18 @@ std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAm\n \n     // The knapsack solver has some legacy behavior where it will spend dust outputs. We retain this behavior, so don't filter for positive only here.\n     std::vector<OutputGroup> all_groups = GroupOutputs(wallet, coins, coin_selection_params, eligibility_filter, false /* positive_only */);\n+    CAmount target_with_change = nTargetValue;\n     // While nTargetValue includes the transaction fees for non-input things, it does not include the fee for creating a change output.\n-    // So we need to include that for KnapsackSolver as well, as we are expecting to create a change output.\n-    if (auto knapsack_result{KnapsackSolver(all_groups, nTargetValue + coin_selection_params.m_change_fee,\n-                                            coin_selection_params.m_min_change_target, coin_selection_params.rng_fast)}) {\n+    // So we need to include that for KnapsackSolver and SRD as well, as we are expecting to create a change output.\n+    if (!coin_selection_params.m_subtract_fee_outputs) {\n+        target_with_change += coin_selection_params.m_change_fee;\n+    }\n+    if (auto knapsack_result{KnapsackSolver(all_groups, target_with_change, coin_selection_params.m_min_change_target, coin_selection_params.rng_fast)}) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868369284",
      "id" : 868369284,
      "line" : 400,
      "node_id" : "PRRC_kwDOABII584zwkOE",
      "original_commit_id" : "dcb9a0e53ae5b8b60f90e0669771a483933c8603",
      "original_line" : 399,
      "original_position" : 13,
      "original_start_line" : 396,
      "path" : "src/wallet/spend.cpp",
      "position" : 13,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868369284/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 397,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868369284",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868374271"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868374271"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`force_no_change = false` feels like a potential braintwister a brain twister. Perhaps it would be better to call this `allow_change` and invert the boolean values.\r\n\r\n```suggestion\r\n    /** Do not allow change even if more than enough inputs are selected */\r\n    bool m_allow_change{true};\r\n```",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:39:55Z",
      "diff_hunk" : "@@ -258,15 +258,17 @@ struct SelectionResult\n     bool m_use_effective{false};\n     /** The computed waste */\n     std::optional<CAmount> m_waste;\n+    /** Force no change even if more than enough inputs are selected */\n+    bool m_force_no_change{false};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868374271",
      "id" : 868374271,
      "line" : 266,
      "node_id" : "PRRC_kwDOABII584zwlb_",
      "original_commit_id" : "e4c0838479205632f5b8f793feb30b368ade3845",
      "original_line" : 262,
      "original_position" : 5,
      "original_start_line" : 261,
      "path" : "src/wallet/coinselection.h",
      "position" : 5,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868374271/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 265,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868374271",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868376362"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868376362"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "See below\r\n```suggestion\r\n    SelectionResult result(selection_target, SelectionAlgorithm::BNB, /*allow_change=*/false);\r\n```",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:41:56Z",
      "diff_hunk" : "@@ -64,7 +64,7 @@ static const size_t TOTAL_TRIES = 100000;\n \n std::optional<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n+    SelectionResult result(selection_target, SelectionAlgorithm::BNB, /*force_no_change=*/true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868376362",
      "id" : 868376362,
      "line" : 67,
      "node_id" : "PRRC_kwDOABII584zwl8q",
      "original_commit_id" : "e4c0838479205632f5b8f793feb30b368ade3845",
      "original_line" : 67,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 5,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868376362/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868376362",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868377710"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868377710"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "see above\r\n```suggestion\r\n    explicit SelectionResult(const CAmount target, SelectionAlgorithm algo, const bool allow_change = true)\r\n        : m_target(target), m_algo(algo), m_allow_change(allow_change) {}\r\n```",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:43:19Z",
      "diff_hunk" : "@@ -258,15 +258,17 @@ struct SelectionResult\n     bool m_use_effective{false};\n     /** The computed waste */\n     std::optional<CAmount> m_waste;\n+    /** Force no change even if more than enough inputs are selected */\n+    bool m_force_no_change{false};\n \n public:\n     /** The target the algorithm selected for. Note that this may not be equal to the recipient amount as it can include non-input fees */\n     const CAmount m_target;\n     /** The algorithm used to produce this result */\n     const SelectionAlgorithm m_algo;\n \n-    explicit SelectionResult(const CAmount target, SelectionAlgorithm algo)\n-        : m_target(target), m_algo(algo) {}\n+    explicit SelectionResult(const CAmount target, SelectionAlgorithm algo, const bool force_no_change = false)\n+        : m_target(target), m_algo(algo), m_force_no_change(force_no_change) {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868377710",
      "id" : 868377710,
      "line" : 270,
      "node_id" : "PRRC_kwDOABII584zwmRu",
      "original_commit_id" : "e4c0838479205632f5b8f793feb30b368ade3845",
      "original_line" : 271,
      "original_position" : 16,
      "original_start_line" : 270,
      "path" : "src/wallet/coinselection.h",
      "position" : 16,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868377710/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 269,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868377710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868383563"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868383563"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't understand what's going on here. I'm actually now wondering why we need `m_use_effective` in the first place if it's just the negation of `m_subtract_fee_outputs` on the group.",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:49:08Z",
      "diff_hunk" : "@@ -439,7 +450,18 @@ void SelectionResult::Clear()\n void SelectionResult::AddInput(const OutputGroup& group)\n {\n     util::insert(m_selected_inputs, group.m_outputs);\n-    m_use_effective = !group.m_subtract_fee_outputs;\n+    m_use_effective = m_use_effective || !group.m_subtract_fee_outputs;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868383563",
      "id" : 868383563,
      "line" : 453,
      "node_id" : "PRRC_kwDOABII584zwntL",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 453,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 35,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868383563/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868383563",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868388727"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868388727"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This feels like it should be mentioned in the commit message and should perhaps be a separate commit than \"Return change from SelectionResult\". I see that this might be useful to construct input sets with a specific UTXO included, but I have a hard time following how it fits into the bigger picture.",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:54:01Z",
      "diff_hunk" : "@@ -439,7 +450,18 @@ void SelectionResult::Clear()\n void SelectionResult::AddInput(const OutputGroup& group)\n {\n     util::insert(m_selected_inputs, group.m_outputs);\n-    m_use_effective = !group.m_subtract_fee_outputs;\n+    m_use_effective = m_use_effective || !group.m_subtract_fee_outputs;\n+}\n+\n+void SelectionResult::Merge(const SelectionResult& other)\n+{\n+    m_target += other.m_target;\n+    m_use_effective |= other.m_use_effective;\n+    m_force_no_change |= other.m_force_no_change;\n+    if (m_algo == SelectionAlgorithm::MANUAL) {\n+        m_algo = other.m_algo;\n+    }\n+    util::insert(m_selected_inputs, other.m_selected_inputs);\n }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868388727",
      "id" : 868388727,
      "line" : 465,
      "node_id" : "PRRC_kwDOABII584zwo93",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 465,
      "original_position" : 47,
      "original_start_line" : 456,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 47,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868388727/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 456,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868388727",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868394832"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868394832"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nice! :heart:\r\nI was also thinking about us returning the change value in the `SelectionResult` in the context of automatic CPFP for unconfirmed inputs when the parent transaction has a lower feerate and we need to add fees for that. This is great!",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T19:59:20Z",
      "diff_hunk" : "@@ -479,4 +502,21 @@ std::string GetAlgorithmName(const SelectionAlgorithm algo)\n     }\n     assert(false);\n }\n+\n+CAmount SelectionResult::GetChange(const CAmount min_change) const\n+{\n+    if (m_force_no_change) return 0;\n+\n+    CAmount change = m_use_effective\n+                     ? GetSelectedEffectiveValue() - m_target\n+                     : GetSelectedValue() - m_target;\n+    assert(change >= 0);\n+\n+    if (change <= min_change) { // TODO: less or less_or_equal\n+        change = 0;\n+    }\n+\n+    return change;\n+}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868394832",
      "id" : 868394832,
      "line" : 520,
      "node_id" : "PRRC_kwDOABII584zwqdQ",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 520,
      "original_position" : 77,
      "original_start_line" : 506,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 77,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868394832/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 506,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868394832",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868400777"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868400777"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I wish we had canonical terms to consistently disambiguate the selection target and the recipient output total, especially because it additionally sometimes includes cost of change and a minimum change.\r\n\r\nWhat do you all think about something along the lines of:\r\n- `recipients_total`: sum of recipient output values (excluding change)\r\n- `selection_target`: the value the coin selection needs to raise to pay for the payload including change for algorithms that allow change\r\n\r\nDo we need another term for `selection_target` without change?",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T20:05:32Z",
      "diff_hunk" : "@@ -254,6 +254,10 @@ struct SelectionResult\n private:\n     /** Set of inputs selected by the algorithm to use in the transaction */\n     std::set<COutput> m_selected_inputs;\n+    /** The target the algorithm selected for. Note that this may not be equal to the recipient amount as it can include non-input fees */\n+    CAmount m_target;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868400777",
      "id" : 868400777,
      "line" : 258,
      "node_id" : "PRRC_kwDOABII584zwr6J",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 258,
      "original_position" : 5,
      "original_start_line" : 257,
      "path" : "src/wallet/coinselection.h",
      "position" : 5,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868400777/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 257,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868400777",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868403748"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868403748"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think we got something like this via #24644 now.",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T20:08:28Z",
      "diff_hunk" : "@@ -254,6 +254,10 @@ struct SelectionResult\n private:\n     /** Set of inputs selected by the algorithm to use in the transaction */\n     std::set<COutput> m_selected_inputs;\n+    /** The target the algorithm selected for. Note that this may not be equal to the recipient amount as it can include non-input fees */\n+    CAmount m_target;\n+    /** The algorithm used to produce this result */\n+    SelectionAlgorithm m_algo;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868403748",
      "id" : 868403748,
      "line" : 260,
      "node_id" : "PRRC_kwDOABII584zwsok",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 260,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 7,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868403748/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868403748",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868406613"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868406613"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Wasn't this what we introduced `SelectionResult.Merge(â¦)` above for?",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T20:11:31Z",
      "diff_hunk" : "@@ -434,9 +434,17 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n              */\n             preset_inputs.Insert(out, /*ancestors=*/ 0, /*descendants=*/ 0, /*positive_only=*/ false);\n         }\n+        if (preset_inputs.GetSelectionAmount() < nTargetValue) return std::nullopt;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868406613",
      "id" : 868406613,
      "line" : 438,
      "node_id" : "PRRC_kwDOABII584zwtVV",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 437,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 4,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868406613/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868406613",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868408331"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868408331"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Would this perhaps still need to check whether the remainder is greater than the dust threshold?",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T20:13:22Z",
      "diff_hunk" : "@@ -434,9 +434,17 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n              */\n             preset_inputs.Insert(out, /*ancestors=*/ 0, /*descendants=*/ 0, /*positive_only=*/ false);\n         }\n+        if (preset_inputs.GetSelectionAmount() < nTargetValue) return std::nullopt;\n+\n+        if (preset_inputs.GetSelectionAmount() > nTargetValue + coin_selection_params.m_cost_of_change) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868408331",
      "id" : 868408331,
      "line" : 440,
      "node_id" : "PRRC_kwDOABII584zwtwL",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 439,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 6,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868408331/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868408331",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868413078"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868413078"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I have the impression that this commit makes changes to how coin selection works with preselected inputs and in addition introduces that SelectionResult returns change. While both changes look worthwhile to me, it would be easier to follow if they were separate commits if not separate PRs. Am I missing some special reason why doing all of this at once is advantageous?",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T20:18:11Z",
      "diff_hunk" : "@@ -572,8 +585,8 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n     if (!res) return std::nullopt;\n \n     // Add preset inputs to result\n-    res->AddInput(preset_inputs);\n-    if (res->m_algo == SelectionAlgorithm::MANUAL) {\n+    res->Merge(preselected);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868413078",
      "id" : 868413078,
      "line" : 589,
      "node_id" : "PRRC_kwDOABII584zwu6W",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 588,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 51,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868413078/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868413078",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868417805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868417805"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "That's an interesting upper bound. Much better than just completely unbounded, but definitely gives some room for bigger `excess` amounts than before. Is this still a WIP-value to give you more wiggle room or is this what you finally identified as the appropriate upper bound? Curious about your thought process here.",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-09T20:23:01Z",
      "diff_hunk" : "@@ -382,9 +382,10 @@ std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAm\n     // Vector of results. We will choose the best one based on waste.\n     std::vector<SelectionResult> results;\n \n+    const auto cost_of_extra_input = coin_selection_params.m_effective_feerate.GetFee(DUMMY_NESTED_P2WPKH_INPUT_SIZE);\n     // Note that unlike KnapsackSolver, we do not include the fee for creating a change output as BnB will not create a change output.\n     std::vector<OutputGroup> positive_groups = GroupOutputs(wallet, coins, coin_selection_params, eligibility_filter, true /* positive_only */);\n-    if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change)}) {\n+    if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change + cost_of_extra_input)}) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868417805",
      "id" : 868417805,
      "line" : 388,
      "node_id" : "PRRC_kwDOABII584zwwEN",
      "original_commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "original_line" : 388,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 8,
      "pull_request_review_id" : 966693630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868417805/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-09T20:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868417805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868858918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868858918"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "For clarity. The size required to store output counter added below. So in case of <253 outputs `tx_noinputs_size` will be 11vB for both segwit and non-segwit txs. This overshoots the target a bit for non-segwit, but this is much better than selecting not enough coins.",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T06:25:52Z",
      "diff_hunk" : "@@ -760,7 +760,8 @@ static bool CreateTransactionInternal(\n \n     // vouts to the payees\n     if (!coin_selection_params.m_subtract_fee_outputs) {\n-        coin_selection_params.tx_noinputs_size = 11; // Static vsize overhead + outputs vsize. 4 nVersion, 4 nLocktime, 1 input count, 1 output count, 1 witness overhead (dummy, flag, stack size)\n+        coin_selection_params.tx_noinputs_size = 10; // Static vsize overhead + outputs vsize. 4 nVersion, 4 nLocktime, 1 input count, 1 witness overhead (dummy, flag, stack size)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868858918",
      "id" : 868858918,
      "in_reply_to_id" : 868328003,
      "line" : 782,
      "node_id" : "PRRC_kwDOABII584zybwm",
      "original_commit_id" : "27441c7253d0d0a79f95a50efebbd17a4c3553e2",
      "original_line" : 763,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 5,
      "pull_request_review_id" : 967231776,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868858918/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T06:25:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868858918",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868861407"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868861407"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, I just made it non const to allow merging two `SelectionResult`s",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T06:29:49Z",
      "diff_hunk" : "@@ -254,6 +254,10 @@ struct SelectionResult\n private:\n     /** Set of inputs selected by the algorithm to use in the transaction */\n     std::set<COutput> m_selected_inputs;\n+    /** The target the algorithm selected for. Note that this may not be equal to the recipient amount as it can include non-input fees */\n+    CAmount m_target;\n+    /** The algorithm used to produce this result */\n+    SelectionAlgorithm m_algo;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868861407",
      "id" : 868861407,
      "in_reply_to_id" : 868403748,
      "line" : 260,
      "node_id" : "PRRC_kwDOABII584zycXf",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 260,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 7,
      "pull_request_review_id" : 967235259,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868861407/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T06:29:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868861407",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868880476"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868880476"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "To fix inefficiencies identified #24580 we need to increase upper limit by the opportunity cost of spending one extra input. We don't know what type that one extra input would be.\r\n\r\nThe range of possible values is from the cost of p2tr (57.5vb) to the cost of p2pkh (148vb). The chosen value is in the middle of that range. \r\n\r\n- If you have only p2pkh inputs in your wallet: the new upper bound is lower than optimal, but still better than current bound as it extends the set of possible BnB solutions.\r\n- If you have only p2tr inputs: the new bound is higher than optimal, but also better than current bound. Same reasoning applies here as for the BnB without upper limit. We produce more BnB solutions and later choose what solution is economically more efficient. But unlike BnB without upper limit we don't risk dropping ridiculous amounts to fees.\r\n\r\nAn alternative way to pick the value would be to examine available UTXOs and take an average input size or something like this. This is more complicated and I'm not sure if it makes a meaningful difference. ",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T06:56:29Z",
      "diff_hunk" : "@@ -382,9 +382,10 @@ std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAm\n     // Vector of results. We will choose the best one based on waste.\n     std::vector<SelectionResult> results;\n \n+    const auto cost_of_extra_input = coin_selection_params.m_effective_feerate.GetFee(DUMMY_NESTED_P2WPKH_INPUT_SIZE);\n     // Note that unlike KnapsackSolver, we do not include the fee for creating a change output as BnB will not create a change output.\n     std::vector<OutputGroup> positive_groups = GroupOutputs(wallet, coins, coin_selection_params, eligibility_filter, true /* positive_only */);\n-    if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change)}) {\n+    if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change + cost_of_extra_input)}) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868880476",
      "id" : 868880476,
      "in_reply_to_id" : 868417805,
      "line" : 388,
      "node_id" : "PRRC_kwDOABII584zyhBc",
      "original_commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "original_line" : 388,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 8,
      "pull_request_review_id" : 967262403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868880476/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T06:56:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868880476",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868884647"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868884647"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't think so, because `m_cost_of_change` is higher than dust",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:01:52Z",
      "diff_hunk" : "@@ -434,9 +434,17 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n              */\n             preset_inputs.Insert(out, /*ancestors=*/ 0, /*descendants=*/ 0, /*positive_only=*/ false);\n         }\n+        if (preset_inputs.GetSelectionAmount() < nTargetValue) return std::nullopt;\n+\n+        if (preset_inputs.GetSelectionAmount() > nTargetValue + coin_selection_params.m_cost_of_change) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868884647",
      "id" : 868884647,
      "in_reply_to_id" : 868408331,
      "line" : 440,
      "node_id" : "PRRC_kwDOABII584zyiCn",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 439,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 6,
      "pull_request_review_id" : 967268077,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868884647/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T07:01:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868884647",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868885595"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868885595"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Will do. The reason is to have the correct value (without CHANGE_LOWER) for `SelectionResult.m_target`",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:03:12Z",
      "diff_hunk" : "@@ -398,11 +398,8 @@ std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAm\n         results.push_back(*knapsack_result);\n     }\n \n-    // Include change for SRD as we want to avoid making really small change if the selection just\n-    // barely meets the target. Just use the lower bound change target instead of the randomly\n-    // generated one, since SRD will result in a random change amount anyway; avoid making the\n-    // target needlessly large.\n-    const CAmount srd_target = nTargetValue + coin_selection_params.m_change_fee + CHANGE_LOWER;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868885595",
      "id" : 868885595,
      "in_reply_to_id" : 868361193,
      "line" : 405,
      "node_id" : "PRRC_kwDOABII584zyiRb",
      "original_commit_id" : "9be243779eb02fd36e1c9a4ae6fa8b54b1ea50b1",
      "original_line" : 405,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 8,
      "pull_request_review_id" : 967269434,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868885595/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T07:03:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868885595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868885737"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868885737"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Will do",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:03:25Z",
      "diff_hunk" : "@@ -27,25 +27,25 @@ using interfaces::FoundBlock;\n namespace wallet {\n static constexpr size_t OUTPUT_GROUP_MAX_ENTRIES{100};\n \n-int GetTxSpendSize(const CWallet& wallet, const CWalletTx& wtx, unsigned int out, bool use_max_sig)\n+int GetTxSpendSize(const CWallet& wallet, const CWalletTx& wtx, unsigned int out, const CCoinControl* coin_control)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868885737",
      "id" : 868885737,
      "in_reply_to_id" : 868347706,
      "line" : 30,
      "node_id" : "PRRC_kwDOABII584zyiTp",
      "original_commit_id" : "e4cfbe5e7b8b91c5f089e169539dc3723f9a2897",
      "original_line" : 30,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 5,
      "pull_request_review_id" : 967269652,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868885737/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T07:03:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868885737",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868887333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868887333"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "meh.. I'm ambivalent about this. What do others think?",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:05:27Z",
      "diff_hunk" : "@@ -258,15 +258,17 @@ struct SelectionResult\n     bool m_use_effective{false};\n     /** The computed waste */\n     std::optional<CAmount> m_waste;\n+    /** Force no change even if more than enough inputs are selected */\n+    bool m_force_no_change{false};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868887333",
      "id" : 868887333,
      "in_reply_to_id" : 868374271,
      "line" : 266,
      "node_id" : "PRRC_kwDOABII584zyisl",
      "original_commit_id" : "e4c0838479205632f5b8f793feb30b368ade3845",
      "original_line" : 262,
      "original_position" : 5,
      "original_start_line" : 261,
      "path" : "src/wallet/coinselection.h",
      "position" : 5,
      "pull_request_review_id" : 967271858,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868887333/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 265,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-10T07:05:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868887333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868888591"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868888591"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'll work on splitting this into a separate commit",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:07:05Z",
      "diff_hunk" : "@@ -439,7 +450,18 @@ void SelectionResult::Clear()\n void SelectionResult::AddInput(const OutputGroup& group)\n {\n     util::insert(m_selected_inputs, group.m_outputs);\n-    m_use_effective = !group.m_subtract_fee_outputs;\n+    m_use_effective = m_use_effective || !group.m_subtract_fee_outputs;\n+}\n+\n+void SelectionResult::Merge(const SelectionResult& other)\n+{\n+    m_target += other.m_target;\n+    m_use_effective |= other.m_use_effective;\n+    m_force_no_change |= other.m_force_no_change;\n+    if (m_algo == SelectionAlgorithm::MANUAL) {\n+        m_algo = other.m_algo;\n+    }\n+    util::insert(m_selected_inputs, other.m_selected_inputs);\n }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868888591",
      "id" : 868888591,
      "in_reply_to_id" : 868388727,
      "line" : 465,
      "node_id" : "PRRC_kwDOABII584zyjAP",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 465,
      "original_position" : 47,
      "original_start_line" : 456,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 47,
      "pull_request_review_id" : 967273572,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868888591/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 456,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-10T07:07:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868888591",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868890021"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868890021"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "+1 to the terms. I don't think we need another one for `selection_target` without change. Currently we know in most cases whether we need change or not. BnB - always no change, Knapsack and SRD always change, unless sffo.",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:08:51Z",
      "diff_hunk" : "@@ -254,6 +254,10 @@ struct SelectionResult\n private:\n     /** Set of inputs selected by the algorithm to use in the transaction */\n     std::set<COutput> m_selected_inputs;\n+    /** The target the algorithm selected for. Note that this may not be equal to the recipient amount as it can include non-input fees */\n+    CAmount m_target;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868890021",
      "id" : 868890021,
      "in_reply_to_id" : 868400777,
      "line" : 258,
      "node_id" : "PRRC_kwDOABII584zyjWl",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 258,
      "original_position" : 5,
      "original_start_line" : 257,
      "path" : "src/wallet/coinselection.h",
      "position" : 5,
      "pull_request_review_id" : 967275526,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868890021/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 257,
      "start_side" : "RIGHT",
      "updated_at" : "2022-05-10T07:08:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868890021",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868891698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868891698"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not sure what did you mean by this. This is the case when the selected inputs are not enough and we just return null value. There's no merging going on.",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:10:50Z",
      "diff_hunk" : "@@ -434,9 +434,17 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n              */\n             preset_inputs.Insert(out, /*ancestors=*/ 0, /*descendants=*/ 0, /*positive_only=*/ false);\n         }\n+        if (preset_inputs.GetSelectionAmount() < nTargetValue) return std::nullopt;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868891698",
      "id" : 868891698,
      "in_reply_to_id" : 868406613,
      "line" : 438,
      "node_id" : "PRRC_kwDOABII584zyjwy",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 437,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 4,
      "pull_request_review_id" : 967277725,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868891698/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T07:10:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868891698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868893882"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868893882"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I intended this to not change the behavior. The reason why we need `Merge` is to correctly track `SelectionResult::m_target`. Right now in case with preselected inputs `m_target` will be reduced by the amount of preselected inputs and this leads to incorrect result in `SelectionResult::GetChange`\r\n\r\nI'll split the commits and try to explain better why this is needed",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:13:36Z",
      "diff_hunk" : "@@ -572,8 +585,8 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n     if (!res) return std::nullopt;\n \n     // Add preset inputs to result\n-    res->AddInput(preset_inputs);\n-    if (res->m_algo == SelectionAlgorithm::MANUAL) {\n+    res->Merge(preselected);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868893882",
      "id" : 868893882,
      "in_reply_to_id" : 868413078,
      "line" : 589,
      "node_id" : "PRRC_kwDOABII584zykS6",
      "original_commit_id" : "5ee8f6c23e8485869604d33a03a8b352a0fc43ba",
      "original_line" : 588,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 51,
      "pull_request_review_id" : 967281011,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868893882/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T07:13:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868893882",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868896848"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868896848"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I should probably add a comment to the code once we agree on the value",
      "commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "created_at" : "2022-05-10T07:17:15Z",
      "diff_hunk" : "@@ -382,9 +382,10 @@ std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAm\n     // Vector of results. We will choose the best one based on waste.\n     std::vector<SelectionResult> results;\n \n+    const auto cost_of_extra_input = coin_selection_params.m_effective_feerate.GetFee(DUMMY_NESTED_P2WPKH_INPUT_SIZE);\n     // Note that unlike KnapsackSolver, we do not include the fee for creating a change output as BnB will not create a change output.\n     std::vector<OutputGroup> positive_groups = GroupOutputs(wallet, coins, coin_selection_params, eligibility_filter, true /* positive_only */);\n-    if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change)}) {\n+    if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change + cost_of_extra_input)}) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#discussion_r868896848",
      "id" : 868896848,
      "in_reply_to_id" : 868417805,
      "line" : 388,
      "node_id" : "PRRC_kwDOABII584zylBQ",
      "original_commit_id" : "b009a99839dd062709e0c0be1972ef62cd96b1c2",
      "original_line" : 388,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 8,
      "pull_request_review_id" : 967284951,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24752",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868896848/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-10T07:17:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/868896848",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-05-17T12:06:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#issuecomment-1128786137",
      "id" : 1128786137,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24752",
      "node_id" : "IC_kwDOABII585DR-jZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1128786137/reactions"
      },
      "updated_at" : "2022-05-17T12:06:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1128786137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Update:\r\n[I did some simulations](https://github.com/achow101/coin-selection-simulation/pull/10/commits/cbe0346dcbe70dfa862da3abb13875e7ae3b1c0a) for this branch.\r\nThe results were that\r\n \r\n -  the cost increased when the BnB window was relaxed\r\n - the number of changeless solutions was reduced\r\n \r\n FWIU, @S3RK had a similar result with his simulations so far. There was a bug discovered in how the waste is calculated for Knapsack in some instances, but I don't expect this bug to impact the overall trend.\r\n \r\nMore experiments to follow, and it may be interesting to explore the opposite, i.e. see  whether reducing the window size in which BnB produces solutions improves results instead.",
      "created_at" : "2022-05-27T20:53:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#issuecomment-1140029982",
      "id" : 1140029982,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24752",
      "node_id" : "IC_kwDOABII585D83oe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1140029982/reactions"
      },
      "updated_at" : "2022-05-27T20:53:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1140029982",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The results were that\r\n> \r\n> * the cost increased when the BnB window was relaxed\r\n> * the number of changeless solutions was reduced\r\n\r\nI don't think this is the correct interpretation of the data. e.g. for `bustabit-tiny-hot-wallet_2019-2020-per-day`\r\n* total cost remained the same.\r\n   * average balance: baseline - 14.6401 vs branch - 14.6396\r\n   * average total fees: baseline - 0.4950 vs branch - 0.4954\r\n   * average total cost: baseline - 0.4958 vs branch - 0.4963\r\n* the number of changeless solutions very slightly increased (~ +3% but we see more knapsack solutions and it's not clear if the difference is significant or due to randomness)\r\n   * average for baseline - 1668.2 vs branch - 1721.6\r\n\r\nI see similar picture for `bustabit-tiny-hot-wallet_peak-and-tail` and for my own simulations.\r\n\r\nOverall it's not clear whether increasing the upper limit is beneficial. I'm closing this now and will send refactoring PRs separately.",
      "created_at" : "2022-06-22T06:50:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24752#issuecomment-1162715336",
      "id" : 1162715336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24752",
      "node_id" : "IC_kwDOABII585FTaDI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1162715336/reactions"
      },
      "updated_at" : "2022-06-22T06:50:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1162715336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   }
]
