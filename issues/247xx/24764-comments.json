[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24742](https://github.com/bitcoin/bitcoin/pull/24742) ([POC] build: prune Boost headers in depends by fanquake)\n* [#24185](https://github.com/bitcoin/bitcoin/pull/24185) (refactor: only use explicit reinterpret/const casts, not implicit by PastaPastaPasta)\n* [#24058](https://github.com/bitcoin/bitcoin/pull/24058) (BIP-322 basic support by kallewoof)\n* [#23595](https://github.com/bitcoin/bitcoin/pull/23595) (util: Add ParseHex<std::byte>() helper by MarcoFalke)\n* [#22953](https://github.com/bitcoin/bitcoin/pull/22953) (refactor: introduce single-separator split helper (boost::split replacement) by theStack)\n* [#22087](https://github.com/bitcoin/bitcoin/pull/22087) (Validate port-options by amadeuszpawlik)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-04-04T23:40:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1088125027",
      "id" : 1088125027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585A23hj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088125027/reactions"
      },
      "updated_at" : "2022-04-25T04:56:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088125027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842477988"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842477988"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in the first commit:\r\n\r\nIs there any reason for the cast? My understanding is that compilers will treat this as `int` either way. So I think this can be clearer written as `c1==-1||c2==-1`. Alternatively, `c1<0||c2<0`, similar to the other places where `HexDigit` is used.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T07:52:01Z",
      "diff_hunk" : "@@ -81,32 +81,24 @@ bool IsHexNumber(const std::string& str)\n     return (str.size() > starting_location);\n }\n \n-std::vector<unsigned char> ParseHex(const char* psz)\n+std::vector<unsigned char> ParseHex(std::string_view str)\n {\n     // convert hex dump to vector\n     std::vector<unsigned char> vch;\n-    while (true)\n-    {\n-        while (IsSpace(*psz))\n-            psz++;\n-        signed char c = HexDigit(*psz++);\n-        if (c == (signed char)-1)\n-            break;\n-        auto n{uint8_t(c << 4)};\n-        c = HexDigit(*psz++);\n-        if (c == (signed char)-1)\n-            break;\n-        n |= c;\n-        vch.push_back(n);\n+    auto it = str.begin();\n+    while (it != str.end() && it + 1 != str.end()) {\n+        if (IsSpace(*it)) {\n+            ++it;\n+            continue;\n+        }\n+        auto c1 = HexDigit(*(it++));\n+        auto c2 = HexDigit(*(it++));\n+        if (c1 == (signed char)-1 || c2 == (signed char)-1) break;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842477988",
      "id" : 842477988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yNzGk",
      "original_commit_id" : "d59c1f99bdbff737ba366e183a5482130be143e8",
      "original_line" : 96,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842477988/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842477988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\n> Add RemovePrefixView and TrimStringView which also return std::string_view objects (the corresponding RemovePrefix and TrimString keep returning an std::string, as that's needed in many call sites still).\r\n\r\nReturning a string_view can be somewhat dangerous (in combination with auto? also when the original string goes out of scope, especially if it's a temporary), so giving these functions new names is a good idea.",
      "created_at" : "2022-04-05T08:03:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1088393028",
      "id" : 1088393028,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585A349E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088393028/reactions"
      },
      "updated_at" : "2022-04-05T08:12:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088393028",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842495509"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842495509"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ParseHex itself could use error feedback using an `optional` at some point too. But this will need revisiting all call sites, too much for this PR.",
      "commit_id" : "6e1f14780452d956503f1dbc3c91b17b44287f77",
      "created_at" : "2022-04-05T08:09:53Z",
      "diff_hunk" : "@@ -58,56 +58,43 @@ signed char HexDigit(char c)\n     return p_util_hexdigit[(unsigned char)c];\n }\n \n-bool IsHex(const std::string& str)\n+bool IsHex(std::string_view str)\n {\n-    for(std::string::const_iterator it(str.begin()); it != str.end(); ++it)\n-    {\n-        if (HexDigit(*it) < 0)\n-            return false;\n+    for (char c : str) {\n+        if (HexDigit(c) < 0) return false;\n     }\n     return (str.size() > 0) && (str.size()%2 == 0);\n }\n \n-bool IsHexNumber(const std::string& str)\n+bool IsHexNumber(std::string_view str)\n {\n-    size_t starting_location = 0;\n-    if (str.size() > 2 && *str.begin() == '0' && *(str.begin()+1) == 'x') {\n-        starting_location = 2;\n-    }\n-    for (const char c : str.substr(starting_location)) {\n+    if (str.size() > 2 && str[0] == '0' && str[1] == 'x') str.remove_prefix(2);\n+    for (char c : str) {\n         if (HexDigit(c) < 0) return false;\n     }\n     // Return false for empty string or \"0x\".\n-    return (str.size() > starting_location);\n+    return str.size() > 0;\n }\n \n-std::vector<unsigned char> ParseHex(const char* psz)\n+std::vector<unsigned char> ParseHex(std::string_view str)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842495509",
      "id" : 842495509,
      "line" : 79,
      "node_id" : "PRRC_kwDOABII584yN3YV",
      "original_commit_id" : "6e1f14780452d956503f1dbc3c91b17b44287f77",
      "original_line" : 79,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 58,
      "pull_request_review_id" : 931446483,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842495509/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T08:09:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842495509",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842504157"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842504157"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in e2fcab145708e43daed290e1b951ff5e43d8890b:\r\n\r\nI prefer `{}` over `()`. (feel free to ignore) ",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T08:19:15Z",
      "diff_hunk" : "@@ -132,7 +132,8 @@ static bool RPCAuthorized(const std::string& strAuth, std::string& strAuthUserna\n     if (strAuth.substr(0, 6) != \"Basic \")\n         return false;\n     std::string strUserPass64 = TrimString(strAuth.substr(6));\n-    std::string strUserPass = DecodeBase64(strUserPass64);\n+    std::vector<unsigned char> userpass_data = DecodeBase64(strUserPass64);\n+    std::string strUserPass(userpass_data.begin(), userpass_data.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842504157",
      "id" : 842504157,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yN5fd",
      "original_commit_id" : "e2fcab145708e43daed290e1b951ff5e43d8890b",
      "original_line" : 136,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842504157/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842504157",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842521157"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842521157"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in https://github.com/bitcoin/bitcoin/commit/e2fcab145708e43daed290e1b951ff5e43d8890b:\r\n\r\nIsn't it problematic to print binary data as is to the terminal? `vstrIn[i]` (the error message) is binary data?\r\n\r\nWouldn't it be better to call `BOOST_CHECK_EQUAL(std::string{dec.begin(), dec.end()}, vstrIn[i]);`, if it compiles?",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T08:37:01Z",
      "diff_hunk" : "@@ -22,8 +22,8 @@ BOOST_AUTO_TEST_CASE(base32_testvectors)\n         BOOST_CHECK_EQUAL(strEnc, vstrOut[i]);\n         strEnc = EncodeBase32(vstrIn[i], false);\n         BOOST_CHECK_EQUAL(strEnc, vstrOutNoPadding[i]);\n-        std::string strDec = DecodeBase32(vstrOut[i]);\n-        BOOST_CHECK_EQUAL(strDec, vstrIn[i]);\n+        auto dec = DecodeBase32(vstrOut[i]);\n+        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842521157",
      "id" : 842521157,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yN9pF",
      "original_commit_id" : "e2fcab145708e43daed290e1b951ff5e43d8890b",
      "original_line" : 26,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/test/base32_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842521157/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842521157",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842521307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842521307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T08:37:10Z",
      "diff_hunk" : "@@ -19,8 +19,8 @@ BOOST_AUTO_TEST_CASE(base64_testvectors)\n     {\n         std::string strEnc = EncodeBase64(vstrIn[i]);\n         BOOST_CHECK_EQUAL(strEnc, vstrOut[i]);\n-        std::string strDec = DecodeBase64(strEnc);\n-        BOOST_CHECK_EQUAL(strDec, vstrIn[i]);\n+        auto dec = DecodeBase64(strEnc);\n+        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842521307",
      "id" : 842521307,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yN9rb",
      "original_commit_id" : "e2fcab145708e43daed290e1b951ff5e43d8890b",
      "original_line" : 23,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/test/base64_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842521307/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842521307",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842529175"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842529175"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Edit: Removed in a later commit, pls ignore.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T08:44:55Z",
      "diff_hunk" : "@@ -132,7 +132,8 @@ static bool RPCAuthorized(const std::string& strAuth, std::string& strAuthUserna\n     if (strAuth.substr(0, 6) != \"Basic \")\n         return false;\n     std::string strUserPass64 = TrimString(strAuth.substr(6));\n-    std::string strUserPass = DecodeBase64(strUserPass64);\n+    std::vector<unsigned char> userpass_data = DecodeBase64(strUserPass64);\n+    std::string strUserPass(userpass_data.begin(), userpass_data.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842529175",
      "id" : 842529175,
      "in_reply_to_id" : 842504157,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yN_mX",
      "original_commit_id" : "e2fcab145708e43daed290e1b951ff5e43d8890b",
      "original_line" : 136,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/httprpc.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842529175/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842529175",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842533846"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842533846"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in 576799874b7e4d026ab888dc2bef84a5c02adfa1:\r\n\r\nI think it is fine if you prefer single-line if over multi-line ones for your own code. Though, I don't think we should convert unrelated lines to that style. This makes the diff larger than needed and I think single-line ifs shouldn't be used for anything non-trivial (`continue;`, `break;`, `return;`). For anything larger they promote large lines and make it hard to see coverage information as well as attaching a debugger to the right statements. Also they increase the diffs for future patches that need to add lines to the if-body.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T08:49:49Z",
      "diff_hunk" : "@@ -69,12 +69,9 @@ static std::string SwapBase64(const std::string& from)\n static Binary DecodeI2PBase64(const std::string& i2p_b64)\n {\n     const std::string& std_b64 = SwapBase64(i2p_b64);\n-    bool invalid;\n-    Binary decoded = DecodeBase64(std_b64, &invalid);\n-    if (invalid) {\n-        throw std::runtime_error(strprintf(\"Cannot decode Base64: \\\"%s\\\"\", i2p_b64));\n-    }\n-    return decoded;\n+    auto decoded = DecodeBase64(std_b64);\n+    if (!decoded) throw std::runtime_error(strprintf(\"Cannot decode Base64: \\\"%s\\\"\", i2p_b64));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842533846",
      "id" : 842533846,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yOAvW",
      "original_commit_id" : "576799874b7e4d026ab888dc2bef84a5c02adfa1",
      "original_line" : 73,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842533846/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842533846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842544635"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842544635"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in https://github.com/bitcoin/bitcoin/commit/576799874b7e4d026ab888dc2bef84a5c02adfa1:\r\n\r\nAn alternative would be to use `dec.value()`, which gives a better indication of where the error happened.\r\n\r\nEdit: Or maybe even a `BOOST_REQUIRE(dec);` in a separate line?",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T09:00:40Z",
      "diff_hunk" : "@@ -23,19 +23,14 @@ BOOST_AUTO_TEST_CASE(base32_testvectors)\n         strEnc = EncodeBase32(vstrIn[i], false);\n         BOOST_CHECK_EQUAL(strEnc, vstrOutNoPadding[i]);\n         auto dec = DecodeBase32(vstrOut[i]);\n-        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);\n+        BOOST_CHECK_MESSAGE(dec && MakeByteSpan(*dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842544635",
      "id" : 842544635,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yODX7",
      "original_commit_id" : "576799874b7e4d026ab888dc2bef84a5c02adfa1",
      "original_line" : 26,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/base32_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842544635/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:14:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842544635",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842544752"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842544752"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T09:00:47Z",
      "diff_hunk" : "@@ -20,7 +20,7 @@ BOOST_AUTO_TEST_CASE(base64_testvectors)\n         std::string strEnc = EncodeBase64(vstrIn[i]);\n         BOOST_CHECK_EQUAL(strEnc, vstrOut[i]);\n         auto dec = DecodeBase64(strEnc);\n-        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);\n+        BOOST_CHECK_MESSAGE(dec && MakeByteSpan(*dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842544752",
      "id" : 842544752,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yODZw",
      "original_commit_id" : "576799874b7e4d026ab888dc2bef84a5c02adfa1",
      "original_line" : 23,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/base64_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842544752/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842544752",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842549888"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842549888"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in https://github.com/bitcoin/bitcoin/commit/576799874b7e4d026ab888dc2bef84a5c02adfa1:\r\n\r\nDiff could be smaller if the multi-line if is kept.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T09:06:19Z",
      "diff_hunk" : "@@ -244,20 +239,15 @@ std::vector<unsigned char> DecodeBase32(const char* p, bool* pf_invalid)\n         ++p;\n     }\n     valid = valid && (p - e) % 8 == 0 && p - q < 8;\n-    if (pf_invalid) *pf_invalid = !valid;\n+    if (!valid) return {};\n \n     return ret;\n }\n \n-std::vector<unsigned char> DecodeBase32(const std::string& str, bool* pf_invalid)\n+std::optional<std::vector<unsigned char>> DecodeBase32(const std::string& str)\n {\n-    if (!ValidAsCString(str)) {\n-        if (pf_invalid) {\n-            *pf_invalid = true;\n-        }\n-        return {};\n-    }\n-    return DecodeBase32(str.c_str(), pf_invalid);\n+    if (!ValidAsCString(str)) return {};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842549888",
      "id" : 842549888,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yOEqA",
      "original_commit_id" : "576799874b7e4d026ab888dc2bef84a5c02adfa1",
      "original_line" : 249,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842549888/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842549888",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842588339"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842588339"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in 2e2645a9b169824f064f1d69eb80d1a1945c68fb: I tagged this pull with \"refactoring\", but I think the validation is now minimally stricter?\r\n\r\n* `DecodeBase64` fails if the size isn't `%4`. Previously it may have succeed. For example if a trailing padding char was removed.\r\n\r\nIt may be possible to check this with the following test on current master:\r\n\r\n```diff\r\ndiff --git a/src/test/base64_tests.cpp b/src/test/base64_tests.cpp\r\nindex 6ee1b83691..e06bd3a542 100644\r\n--- a/src/test/base64_tests.cpp\r\n+++ b/src/test/base64_tests.cpp\r\n@@ -14,12 +14,11 @@ BOOST_AUTO_TEST_SUITE(base64_tests)\r\n BOOST_AUTO_TEST_CASE(base64_testvectors)\r\n {\r\n     static const std::string vstrIn[]  = {\"\",\"f\",\"fo\",\"foo\",\"foob\",\"fooba\",\"foobar\"};\r\n-    static const std::string vstrOut[] = {\"\",\"Zg==\",\"Zm8=\",\"Zm9v\",\"Zm9vYg==\",\"Zm9vYmE=\",\"Zm9vYmFy\"};\r\n+    static const std::string vstrOut[] = {\"\",\"Zg=\",\"Zm8\",\"Zm9v\",\"Zm9vYg\",\"Zm9vYmE=\",\"Zm9vYmFy\"};\r\n     for (unsigned int i=0; i<std::size(vstrIn); i++)\r\n     {\r\n         std::string strEnc = EncodeBase64(vstrIn[i]);\r\n-        BOOST_CHECK_EQUAL(strEnc, vstrOut[i]);\r\n-        std::string strDec = DecodeBase64(strEnc);\r\n+        std::string strDec = DecodeBase64(vstrOut[i]);\r\n         BOOST_CHECK_EQUAL(strDec, vstrIn[i]);\r\n     }\r\n \r\n```\r\n\r\n\r\n",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T09:47:38Z",
      "diff_hunk" : "@@ -144,40 +144,23 @@ std::optional<std::vector<unsigned char>> DecodeBase64(const char* p)\n         -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n     };\n \n-    const char* e = p;\n-    std::vector<uint8_t> val;\n-    val.reserve(strlen(p));\n-    while (*p != 0) {\n-        int x = decode64_table[(unsigned char)*p];\n-        if (x == -1) break;\n-        val.push_back(uint8_t(x));\n-        ++p;\n-    }\n+    if (str.size() % 4 != 0) return {};\n+    /* One or two = characters at the end are permitted. */\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842588339",
      "id" : 842588339,
      "line" : 150,
      "node_id" : "PRRC_kwDOABII584yOOCz",
      "original_commit_id" : "2e2645a9b169824f064f1d69eb80d1a1945c68fb",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 124,
      "pull_request_review_id" : 931423974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842588339/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:04:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842588339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842610410"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842610410"
         }
      },
      "author_association" : "MEMBER",
      "body" : "edit: Looks like the binary data in this test are printable-ascii-only strings, so feel free to ignore. Also it looks like boost doesn't attempt to sanitize the binary data anyway.\r\n\r\nThough, I still slightly prefer to print both the decoded string and the input string on failure, as opposed to just the input string.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T10:11:54Z",
      "diff_hunk" : "@@ -22,8 +22,8 @@ BOOST_AUTO_TEST_CASE(base32_testvectors)\n         BOOST_CHECK_EQUAL(strEnc, vstrOut[i]);\n         strEnc = EncodeBase32(vstrIn[i], false);\n         BOOST_CHECK_EQUAL(strEnc, vstrOutNoPadding[i]);\n-        std::string strDec = DecodeBase32(vstrOut[i]);\n-        BOOST_CHECK_EQUAL(strDec, vstrIn[i]);\n+        auto dec = DecodeBase32(vstrOut[i]);\n+        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842610410",
      "id" : 842610410,
      "in_reply_to_id" : 842521157,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yOTbq",
      "original_commit_id" : "e2fcab145708e43daed290e1b951ff5e43d8890b",
      "original_line" : 26,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/test/base32_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931606498,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842610410/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:11:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842610410",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842615979"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842615979"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If true, it could make sense to mention this behaviour change in the commit description (or pull request description).",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T10:18:35Z",
      "diff_hunk" : "@@ -144,40 +144,23 @@ std::optional<std::vector<unsigned char>> DecodeBase64(const char* p)\n         -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n     };\n \n-    const char* e = p;\n-    std::vector<uint8_t> val;\n-    val.reserve(strlen(p));\n-    while (*p != 0) {\n-        int x = decode64_table[(unsigned char)*p];\n-        if (x == -1) break;\n-        val.push_back(uint8_t(x));\n-        ++p;\n-    }\n+    if (str.size() % 4 != 0) return {};\n+    /* One or two = characters at the end are permitted. */\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842615979",
      "id" : 842615979,
      "in_reply_to_id" : 842588339,
      "line" : 150,
      "node_id" : "PRRC_kwDOABII584yOUyr",
      "original_commit_id" : "2e2645a9b169824f064f1d69eb80d1a1945c68fb",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 124,
      "pull_request_review_id" : 931615605,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842615979/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T10:18:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842615979",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> A new name is good, but doesn't solve the problem. I think this can be fixed with an attribute: https://github.com/bitcoin/bitcoin/issues/20493\r\n\r\nAgree, I just meant that putting a string_view-returning function as a drop-in replacement would have been a very bad idea, a new function with a new name means that people using it can reason about the risks anew. Sure, if an attribute can help avoid such problems more widely that's of course even better.",
      "created_at" : "2022-04-05T11:04:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1088568594",
      "id" : 1088568594,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585A4j0S",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088568594/reactions"
      },
      "updated_at" : "2022-04-05T11:04:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088568594",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842708636"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842708636"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I left the casts there because the original calls had them too. I believe they are indeed redundant here, I'll remove them.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T12:09:09Z",
      "diff_hunk" : "@@ -81,32 +81,24 @@ bool IsHexNumber(const std::string& str)\n     return (str.size() > starting_location);\n }\n \n-std::vector<unsigned char> ParseHex(const char* psz)\n+std::vector<unsigned char> ParseHex(std::string_view str)\n {\n     // convert hex dump to vector\n     std::vector<unsigned char> vch;\n-    while (true)\n-    {\n-        while (IsSpace(*psz))\n-            psz++;\n-        signed char c = HexDigit(*psz++);\n-        if (c == (signed char)-1)\n-            break;\n-        auto n{uint8_t(c << 4)};\n-        c = HexDigit(*psz++);\n-        if (c == (signed char)-1)\n-            break;\n-        n |= c;\n-        vch.push_back(n);\n+    auto it = str.begin();\n+    while (it != str.end() && it + 1 != str.end()) {\n+        if (IsSpace(*it)) {\n+            ++it;\n+            continue;\n+        }\n+        auto c1 = HexDigit(*(it++));\n+        auto c2 = HexDigit(*(it++));\n+        if (c1 == (signed char)-1 || c2 == (signed char)-1) break;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842708636",
      "id" : 842708636,
      "in_reply_to_id" : 842477988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yOrac",
      "original_commit_id" : "d59c1f99bdbff737ba366e183a5482130be143e8",
      "original_line" : 96,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 931749951,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842708636/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T12:09:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842708636",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842804709"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842804709"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Right, good for a follow-up.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:45:36Z",
      "diff_hunk" : "@@ -58,56 +58,43 @@ signed char HexDigit(char c)\n     return p_util_hexdigit[(unsigned char)c];\n }\n \n-bool IsHex(const std::string& str)\n+bool IsHex(std::string_view str)\n {\n-    for(std::string::const_iterator it(str.begin()); it != str.end(); ++it)\n-    {\n-        if (HexDigit(*it) < 0)\n-            return false;\n+    for (char c : str) {\n+        if (HexDigit(c) < 0) return false;\n     }\n     return (str.size() > 0) && (str.size()%2 == 0);\n }\n \n-bool IsHexNumber(const std::string& str)\n+bool IsHexNumber(std::string_view str)\n {\n-    size_t starting_location = 0;\n-    if (str.size() > 2 && *str.begin() == '0' && *(str.begin()+1) == 'x') {\n-        starting_location = 2;\n-    }\n-    for (const char c : str.substr(starting_location)) {\n+    if (str.size() > 2 && str[0] == '0' && str[1] == 'x') str.remove_prefix(2);\n+    for (char c : str) {\n         if (HexDigit(c) < 0) return false;\n     }\n     // Return false for empty string or \"0x\".\n-    return (str.size() > starting_location);\n+    return str.size() > 0;\n }\n \n-std::vector<unsigned char> ParseHex(const char* psz)\n+std::vector<unsigned char> ParseHex(std::string_view str)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842804709",
      "id" : 842804709,
      "in_reply_to_id" : 842495509,
      "line" : 79,
      "node_id" : "PRRC_kwDOABII584yPC3l",
      "original_commit_id" : "6e1f14780452d956503f1dbc3c91b17b44287f77",
      "original_line" : 79,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 58,
      "pull_request_review_id" : 931887799,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842804709/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:45:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842804709",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842805058"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842805058"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Replaced it with `< 0` checks.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:45:54Z",
      "diff_hunk" : "@@ -81,32 +81,24 @@ bool IsHexNumber(const std::string& str)\n     return (str.size() > starting_location);\n }\n \n-std::vector<unsigned char> ParseHex(const char* psz)\n+std::vector<unsigned char> ParseHex(std::string_view str)\n {\n     // convert hex dump to vector\n     std::vector<unsigned char> vch;\n-    while (true)\n-    {\n-        while (IsSpace(*psz))\n-            psz++;\n-        signed char c = HexDigit(*psz++);\n-        if (c == (signed char)-1)\n-            break;\n-        auto n{uint8_t(c << 4)};\n-        c = HexDigit(*psz++);\n-        if (c == (signed char)-1)\n-            break;\n-        n |= c;\n-        vch.push_back(n);\n+    auto it = str.begin();\n+    while (it != str.end() && it + 1 != str.end()) {\n+        if (IsSpace(*it)) {\n+            ++it;\n+            continue;\n+        }\n+        auto c1 = HexDigit(*(it++));\n+        auto c2 = HexDigit(*(it++));\n+        if (c1 == (signed char)-1 || c2 == (signed char)-1) break;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842805058",
      "id" : 842805058,
      "in_reply_to_id" : 842477988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yPC9C",
      "original_commit_id" : "d59c1f99bdbff737ba366e183a5482130be143e8",
      "original_line" : 96,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 931888315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842805058/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:45:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842805058",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842806254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842806254"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've changed them to just reporting the encoded string in case of failure; that should still be sufficient to notice the offending test case, and keeps working if we'd add cases that have non-printable input. Ok?",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:46:54Z",
      "diff_hunk" : "@@ -22,8 +22,8 @@ BOOST_AUTO_TEST_CASE(base32_testvectors)\n         BOOST_CHECK_EQUAL(strEnc, vstrOut[i]);\n         strEnc = EncodeBase32(vstrIn[i], false);\n         BOOST_CHECK_EQUAL(strEnc, vstrOutNoPadding[i]);\n-        std::string strDec = DecodeBase32(vstrOut[i]);\n-        BOOST_CHECK_EQUAL(strDec, vstrIn[i]);\n+        auto dec = DecodeBase32(vstrOut[i]);\n+        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842806254",
      "id" : 842806254,
      "in_reply_to_id" : 842521157,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yPDPu",
      "original_commit_id" : "e2fcab145708e43daed290e1b951ff5e43d8890b",
      "original_line" : 26,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/test/base32_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931889939,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842806254/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:46:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842806254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842806572"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842806572"
         }
      },
      "author_association" : "MEMBER",
      "body" : "See https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842806254",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:47:09Z",
      "diff_hunk" : "@@ -19,8 +19,8 @@ BOOST_AUTO_TEST_CASE(base64_testvectors)\n     {\n         std::string strEnc = EncodeBase64(vstrIn[i]);\n         BOOST_CHECK_EQUAL(strEnc, vstrOut[i]);\n-        std::string strDec = DecodeBase64(strEnc);\n-        BOOST_CHECK_EQUAL(strDec, vstrIn[i]);\n+        auto dec = DecodeBase64(strEnc);\n+        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842806572",
      "id" : 842806572,
      "in_reply_to_id" : 842521307,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yPDUs",
      "original_commit_id" : "e2fcab145708e43daed290e1b951ff5e43d8890b",
      "original_line" : 23,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/test/base64_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931890358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842806572/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:47:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842806572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842808666"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842808666"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I prefer code with less clutter lines in general, but you make a good point. Reverted.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:48:59Z",
      "diff_hunk" : "@@ -69,12 +69,9 @@ static std::string SwapBase64(const std::string& from)\n static Binary DecodeI2PBase64(const std::string& i2p_b64)\n {\n     const std::string& std_b64 = SwapBase64(i2p_b64);\n-    bool invalid;\n-    Binary decoded = DecodeBase64(std_b64, &invalid);\n-    if (invalid) {\n-        throw std::runtime_error(strprintf(\"Cannot decode Base64: \\\"%s\\\"\", i2p_b64));\n-    }\n-    return decoded;\n+    auto decoded = DecodeBase64(std_b64);\n+    if (!decoded) throw std::runtime_error(strprintf(\"Cannot decode Base64: \\\"%s\\\"\", i2p_b64));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842808666",
      "id" : 842808666,
      "in_reply_to_id" : 842533846,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yPD1a",
      "original_commit_id" : "576799874b7e4d026ab888dc2bef84a5c02adfa1",
      "original_line" : 73,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/i2p.cpp",
      "position" : null,
      "pull_request_review_id" : 931893350,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842808666/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:48:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842808666",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842808889"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842808889"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Used `BOOST_REQUIRE(dec);`.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:49:11Z",
      "diff_hunk" : "@@ -23,19 +23,14 @@ BOOST_AUTO_TEST_CASE(base32_testvectors)\n         strEnc = EncodeBase32(vstrIn[i], false);\n         BOOST_CHECK_EQUAL(strEnc, vstrOutNoPadding[i]);\n         auto dec = DecodeBase32(vstrOut[i]);\n-        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);\n+        BOOST_CHECK_MESSAGE(dec && MakeByteSpan(*dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842808889",
      "id" : 842808889,
      "in_reply_to_id" : 842544635,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yPD45",
      "original_commit_id" : "576799874b7e4d026ab888dc2bef84a5c02adfa1",
      "original_line" : 26,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/base32_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931893680,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842808889/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:49:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842808889",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842809261"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842809261"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Used `BOOST_REQUIRE(dec);`.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:49:30Z",
      "diff_hunk" : "@@ -20,7 +20,7 @@ BOOST_AUTO_TEST_CASE(base64_testvectors)\n         std::string strEnc = EncodeBase64(vstrIn[i]);\n         BOOST_CHECK_EQUAL(strEnc, vstrOut[i]);\n         auto dec = DecodeBase64(strEnc);\n-        BOOST_CHECK_MESSAGE(MakeByteSpan(dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);\n+        BOOST_CHECK_MESSAGE(dec && MakeByteSpan(*dec) == MakeByteSpan(vstrIn[i]), vstrIn[i]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842809261",
      "id" : 842809261,
      "in_reply_to_id" : 842544752,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yPD-t",
      "original_commit_id" : "576799874b7e4d026ab888dc2bef84a5c02adfa1",
      "original_line" : 23,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/base64_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 931894218,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842809261/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:49:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842809261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842809415"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842809415"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:49:36Z",
      "diff_hunk" : "@@ -244,20 +239,15 @@ std::vector<unsigned char> DecodeBase32(const char* p, bool* pf_invalid)\n         ++p;\n     }\n     valid = valid && (p - e) % 8 == 0 && p - q < 8;\n-    if (pf_invalid) *pf_invalid = !valid;\n+    if (!valid) return {};\n \n     return ret;\n }\n \n-std::vector<unsigned char> DecodeBase32(const std::string& str, bool* pf_invalid)\n+std::optional<std::vector<unsigned char>> DecodeBase32(const std::string& str)\n {\n-    if (!ValidAsCString(str)) {\n-        if (pf_invalid) {\n-            *pf_invalid = true;\n-        }\n-        return {};\n-    }\n-    return DecodeBase32(str.c_str(), pf_invalid);\n+    if (!ValidAsCString(str)) return {};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842809415",
      "id" : 842809415,
      "in_reply_to_id" : 842549888,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yPEBH",
      "original_commit_id" : "576799874b7e4d026ab888dc2bef84a5c02adfa1",
      "original_line" : 249,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 931894422,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842809415/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:49:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842809415",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "review ACK e4092c5230bdd1f6439c70fa22b68381e5cc6899 ð¤\r\n\r\nOnly changes:\r\n* Remove confusing (signed char) cast\r\n* Use shorter str.substr(0, 2) == \"0x\" over manual matching/implementation\r\n* A minor change in a unit test\r\n* Whitespace changes\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nreview ACK e4092c5230bdd1f6439c70fa22b68381e5cc6899 ð¤\r\n\r\nOnly changes:\r\n* Remove confusing (signed char) cast\r\n* Use shorter str.substr(0, 2) == \"0x\" over manual matching/implementation\r\n* A minor change in a unit test\r\n* Whitespace changes\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUjhQQwAsEPZBkw/LyKgYc/xITU1DL5Oausc0jYNBH7WrBEh055OyfUZ5NgxM87K\r\nbcJTNQMCmLVfWnOcg0FUELaXCGbqua8qPgiKwQT5nxlHN0DXpakSSWrkGh2HKIGe\r\nzwPKwNrMEH7TrCs3Tkn3ZTkiHI3gl+AFTL5zdw1b/sMwPapeZLDqoAQZXTqj+LRB\r\n0d44jHX6oO5faHRI6p+fErVtg40Q+3s49CkYXbTl/u1HEWaKcWBxk0wZ9JHUUWuY\r\nZ2K1OWDWH/KuR/gYlUUuVfJk5jgG6NqNgzErLUjCtYjQ6LGpI90e7ud/ahv2Xndb\r\nvRzi/r/XAQrzlYLKM4ZuoeiTTSKxLJHD6353KVgPVKETioM6o1eyn3qWpg5JwnT4\r\nVglcsozZzoVbSdghoQ397NhFjI+Lfs+d60EcUB8lzPgzP00gAo2smlXXM0QMBRV/\r\nXOweIVcmYulLYK0LnBXbQy4GSqyE06JsIKpugwFJEcKb7mkdJSdJ8Xg4xxwwYyjR\r\nCdV7knXn\r\n=yyjx\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n\r\n</details>\r\n",
      "created_at" : "2022-04-05T13:57:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1088737708",
      "id" : 1088737708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585A5NGs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088737708/reactions"
      },
      "updated_at" : "2022-04-05T13:57:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1088737708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842818981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842818981"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Interesting! The answer is that it's complicated.\r\n\r\nSo, the test code you suggest here actually passes, but only because it isn't checking the invalid output flag. Current master, I believe, decodes input which isn't a multiple of 4 characters correctly (as if it had padding) but does set the `*pf_invalid` flag.\r\n\r\nSo this is indeed a behavior change, but only for call sites which don't check the invalid flag. I think there is only one such site: `RPCAuthorized()` in httprpc.cpp, and I think that's a bug (the HTTP spec RFC 7617 for Basic authentication specifies the use of padded Base64 on very casual reading).\r\n\r\nIf so, the commit that switches to `std::optional`-wrapped results actually fixes this.\r\n\r\nThoughts?",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T13:57:42Z",
      "diff_hunk" : "@@ -144,40 +144,23 @@ std::optional<std::vector<unsigned char>> DecodeBase64(const char* p)\n         -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n     };\n \n-    const char* e = p;\n-    std::vector<uint8_t> val;\n-    val.reserve(strlen(p));\n-    while (*p != 0) {\n-        int x = decode64_table[(unsigned char)*p];\n-        if (x == -1) break;\n-        val.push_back(uint8_t(x));\n-        ++p;\n-    }\n+    if (str.size() % 4 != 0) return {};\n+    /* One or two = characters at the end are permitted. */\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842818981",
      "id" : 842818981,
      "in_reply_to_id" : 842588339,
      "line" : 150,
      "node_id" : "PRRC_kwDOABII584yPGWl",
      "original_commit_id" : "2e2645a9b169824f064f1d69eb80d1a1945c68fb",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 124,
      "pull_request_review_id" : 931908091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842818981/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T13:57:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842818981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842913941"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842913941"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh right. The commit that changes behaviour is likely the std::optional one (889a5f107c5187c9232f340adfaedfe1b90361d5), not the string_view one I mentioned earlier.\r\n\r\nI guess there is nothing needed to be done here. I just wanted to mention the behaviour change here, so that we aren't surprised when someone creates a bug report \"My broken javascript rpc library doesn't work\".",
      "commit_id" : "e4092c5230bdd1f6439c70fa22b68381e5cc6899",
      "created_at" : "2022-04-05T15:19:02Z",
      "diff_hunk" : "@@ -144,40 +144,23 @@ std::optional<std::vector<unsigned char>> DecodeBase64(const char* p)\n         -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n     };\n \n-    const char* e = p;\n-    std::vector<uint8_t> val;\n-    val.reserve(strlen(p));\n-    while (*p != 0) {\n-        int x = decode64_table[(unsigned char)*p];\n-        if (x == -1) break;\n-        val.push_back(uint8_t(x));\n-        ++p;\n-    }\n+    if (str.size() % 4 != 0) return {};\n+    /* One or two = characters at the end are permitted. */\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r842913941",
      "id" : 842913941,
      "in_reply_to_id" : 842588339,
      "line" : 150,
      "node_id" : "PRRC_kwDOABII584yPdiV",
      "original_commit_id" : "2e2645a9b169824f064f1d69eb80d1a1945c68fb",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 124,
      "pull_request_review_id" : 932047826,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842913941/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-05T15:19:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/842913941",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK - ~~the `ConvertBits` functionality is unused in this PR - maybe it could be saved for a time when it is needed?~~ (misread)\r\n\r\nnits:\r\n* Mild preference for more strict separation between refactoring and behavior modification - would make this easier to ACK, at least in part\r\n* There is a check in `IsHex` (`% 2 == 0`) that could be applied to `IsHexNumber`\r\n* Could inline or return early in some cases where you're converting to return `optional` (previous implementation was constrained by the need to set the val) 889a5f107c5187c9232f340adfaedfe1b90361d5\r\n",
      "created_at" : "2022-04-06T18:17:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1090584825",
      "id" : 1090584825,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585BAQD5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1090584825/reactions"
      },
      "updated_at" : "2022-04-06T18:18:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1090584825",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Mild preference for more strict separation between refactoring and behavior modification - would make this easier to ACK, at least in part\r\n\r\nYeah, I'll separate them (now that we figured out the issue with ignoring the pfInvalid flag in the http auth logic).\r\n\r\n> There is a check in IsHex (% 2 == 0) that could be applied to IsHexNumber\r\n\r\nThat would be incorrect. Hex numbers don't need to be a multiple of 2 characters (0xF is a valid hex number, e.g.).",
      "created_at" : "2022-04-06T18:21:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1090588097",
      "id" : 1090588097,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585BAQ3B",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1090588097/reactions"
      },
      "updated_at" : "2022-04-06T18:21:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1090588097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r846568827"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/846568827"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Moved the behavior-changing aspect to a separate commit.",
      "commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "created_at" : "2022-04-09T03:35:29Z",
      "diff_hunk" : "@@ -144,40 +144,23 @@ std::optional<std::vector<unsigned char>> DecodeBase64(const char* p)\n         -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1\n     };\n \n-    const char* e = p;\n-    std::vector<uint8_t> val;\n-    val.reserve(strlen(p));\n-    while (*p != 0) {\n-        int x = decode64_table[(unsigned char)*p];\n-        if (x == -1) break;\n-        val.push_back(uint8_t(x));\n-        ++p;\n-    }\n+    if (str.size() % 4 != 0) return {};\n+    /* One or two = characters at the end are permitted. */\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);\n+    if (str.size() >= 1 && str.back() == '=') str.remove_suffix(1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r846568827",
      "id" : 846568827,
      "in_reply_to_id" : 842588339,
      "line" : 150,
      "node_id" : "PRRC_kwDOABII584ydZ17",
      "original_commit_id" : "2e2645a9b169824f064f1d69eb80d1a1945c68fb",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 124,
      "pull_request_review_id" : 937070968,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/846568827/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-09T03:35:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/846568827",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r852634603"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/852634603"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think the name `ValidAsCString` is now a bit dangerous. I'd assume that it returns `true` when the argument is 0 terminated at the end (which was the case for the `const std::string& str` argument), but with a `std::string_view` argument this might not be the case.\r\n\r\nSo now even when `ValidAsCString(str)` returns `true`, it is not allowed to use e.g. `strlen(str.data())`.\r\n\r\nI would rename the method to something like `ContainsNoNUL` to make it more clear what's checked, or keep the `const std::string&` argument for now",
      "commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "created_at" : "2022-04-19T06:22:05Z",
      "diff_hunk" : "@@ -75,9 +85,12 @@ inline std::string MakeUnorderedList(const std::vector<std::string>& items)\n /**\n  * Check if a string does not contain any embedded NUL (\\0) characters\n  */\n-[[nodiscard]] inline bool ValidAsCString(const std::string& str) noexcept\n+[[nodiscard]] inline bool ValidAsCString(std::string_view str) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r852634603",
      "id" : 852634603,
      "line" : 88,
      "node_id" : "PRRC_kwDOABII584y0ivr",
      "original_commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "original_line" : 88,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/util/string.h",
      "position" : 61,
      "pull_request_review_id" : 945073583,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/852634603/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-19T06:34:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/852634603",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r855420883"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855420883"
         }
      },
      "author_association" : "MEMBER",
      "body" : "According to the documentation, it only checks if a string has embedded `\\0` characters. That std::string is zero-terminated internally is an implementation detail, the caller is still responsible for passing `c_str()` (and never `.data()`) when passing it to a function that takes a C string.\r\n\r\n> it is not allowed to use e.g. strlen(str.data()). \r\n\r\nI'd really frown on code like that in any case.\r\n\r\nEdit: The only time it'd be remotely acceptable to pass `.data()` as a C string would be *if* there is an embedded \\0 in the array, which is exactly what this function avoids :smile: ",
      "commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "created_at" : "2022-04-21T17:24:44Z",
      "diff_hunk" : "@@ -75,9 +85,12 @@ inline std::string MakeUnorderedList(const std::vector<std::string>& items)\n /**\n  * Check if a string does not contain any embedded NUL (\\0) characters\n  */\n-[[nodiscard]] inline bool ValidAsCString(const std::string& str) noexcept\n+[[nodiscard]] inline bool ValidAsCString(std::string_view str) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r855420883",
      "id" : 855420883,
      "in_reply_to_id" : 852634603,
      "line" : 88,
      "node_id" : "PRRC_kwDOABII584y_K_T",
      "original_commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "original_line" : 88,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/util/string.h",
      "position" : 61,
      "pull_request_review_id" : 948968325,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855420883/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-21T19:46:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855420883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r855972679"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855972679"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "well, maybe it's just me, but from the interface `ValidAsCString(std::string_view str)` I'd guess that it returns `true` when it actually finds a `\\0` somewhere, but it's exactly the opposite :slightly_smiling_face: ",
      "commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "created_at" : "2022-04-22T09:26:40Z",
      "diff_hunk" : "@@ -75,9 +85,12 @@ inline std::string MakeUnorderedList(const std::vector<std::string>& items)\n /**\n  * Check if a string does not contain any embedded NUL (\\0) characters\n  */\n-[[nodiscard]] inline bool ValidAsCString(const std::string& str) noexcept\n+[[nodiscard]] inline bool ValidAsCString(std::string_view str) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r855972679",
      "id" : 855972679,
      "in_reply_to_id" : 852634603,
      "line" : 88,
      "node_id" : "PRRC_kwDOABII584zBRtH",
      "original_commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "original_line" : 88,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/util/string.h",
      "position" : 61,
      "pull_request_review_id" : 949726066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855972679/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-22T09:26:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/855972679",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r856159518"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856159518"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I have no objection to adding a scripted-diff to rename `ValidAsCString` to `ContainsNoNUL`. Either in this pull or as a follow-up.",
      "commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "created_at" : "2022-04-22T11:58:06Z",
      "diff_hunk" : "@@ -75,9 +85,12 @@ inline std::string MakeUnorderedList(const std::vector<std::string>& items)\n /**\n  * Check if a string does not contain any embedded NUL (\\0) characters\n  */\n-[[nodiscard]] inline bool ValidAsCString(const std::string& str) noexcept\n+[[nodiscard]] inline bool ValidAsCString(std::string_view str) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r856159518",
      "id" : 856159518,
      "in_reply_to_id" : 852634603,
      "line" : 88,
      "node_id" : "PRRC_kwDOABII584zB_Ue",
      "original_commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "original_line" : 88,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/util/string.h",
      "position" : 61,
      "pull_request_review_id" : 949984357,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856159518/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-22T11:58:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856159518",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r857396148"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857396148"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@sipa ",
      "commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "created_at" : "2022-04-25T08:47:55Z",
      "diff_hunk" : "@@ -75,9 +85,12 @@ inline std::string MakeUnorderedList(const std::vector<std::string>& items)\n /**\n  * Check if a string does not contain any embedded NUL (\\0) characters\n  */\n-[[nodiscard]] inline bool ValidAsCString(const std::string& str) noexcept\n+[[nodiscard]] inline bool ValidAsCString(std::string_view str) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r857396148",
      "id" : 857396148,
      "in_reply_to_id" : 852634603,
      "line" : 88,
      "node_id" : "PRRC_kwDOABII584zGtO0",
      "original_commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "original_line" : 88,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/util/string.h",
      "position" : 61,
      "pull_request_review_id" : 951537811,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857396148/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-25T08:47:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857396148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-04-26T10:06:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1109606105",
      "id" : 1109606105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585CIz7Z",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 1,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1109606105/reactions"
      },
      "updated_at" : "2022-04-26T10:06:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1109606105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I am happy to pick this up if you are no longer working on it",
      "created_at" : "2022-04-27T12:07:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1110921072",
      "id" : 1110921072,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585CN09w",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110921072/reactions"
      },
      "updated_at" : "2022-04-27T12:07:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110921072",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke Go for it.",
      "created_at" : "2022-04-27T12:08:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#issuecomment-1110922692",
      "id" : 1110922692,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24764",
      "node_id" : "IC_kwDOABII585CN1XE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110922692/reactions"
      },
      "updated_at" : "2022-04-27T12:08:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110922692",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r859730085"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859730085"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@martinus See https://github.com/bitcoin/bitcoin/pull/25001",
      "commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "created_at" : "2022-04-27T12:20:25Z",
      "diff_hunk" : "@@ -75,9 +85,12 @@ inline std::string MakeUnorderedList(const std::vector<std::string>& items)\n /**\n  * Check if a string does not contain any embedded NUL (\\0) characters\n  */\n-[[nodiscard]] inline bool ValidAsCString(const std::string& str) noexcept\n+[[nodiscard]] inline bool ValidAsCString(std::string_view str) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24764#discussion_r859730085",
      "id" : 859730085,
      "in_reply_to_id" : 852634603,
      "line" : 88,
      "node_id" : "PRRC_kwDOABII584zPnCl",
      "original_commit_id" : "5ea072ed08b43cdfdf8554597dcf8c1a51ef4dae",
      "original_line" : 88,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/util/string.h",
      "position" : 61,
      "pull_request_review_id" : 954800298,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24764",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859730085/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-27T12:20:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/859730085",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
