[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#20277](https://github.com/bitcoin/bitcoin/pull/20277) (test: Extend p2p_ibd_tx_relay.py to verify no-transaction are requested during IBD by ariard)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-03-01T22:24:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-788345340",
      "id" : 788345340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODM0NTM0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-17T13:02:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788345340",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585433607"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585433607"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to add a silent merge conflict with dongcarl's work? Could simply use `m_chainman.ActiveChainstate().IsInitialBlockDownload()`",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T10:11:35Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585433607",
      "id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTQzMzYwNw==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 601646704,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585433607",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585435567"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585435567"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Using the member also mirrors the check used in `NetMsgType::INV` processing.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T10:14:33Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585435567",
      "id" : 585435567,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTQzNTU2Nw==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 601646704,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585435567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585436728"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585436728"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could log the rejection to the debug NET category?",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T10:16:04Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585436728",
      "id" : 585436728,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTQzNjcyOA==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 601646704,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585436728",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585781532"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585781532"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps remove \"Also\". Comments have a habit of migrating around and not getting updated, so the \"also\" that this is referring to may no longer make sense in future.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T17:51:20Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585781532",
      "id" : 585781532,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTc4MTUzMg==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3209,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602101317,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585781532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585781699"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585781699"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe update this, since the test is now testing more.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T17:51:38Z",
      "diff_hunk" : "@@ -5,9 +5,23 @@\n \"\"\"Test fee filters during and after IBD.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585781699",
      "id" : 585781699,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTc4MTY5OQ==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 5,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 602101317,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585781699",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585782939"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585782939"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think this is testing anything. If a node receives an INV for a transaction from an inbound connection, it won't request it for at least two seconds (see `AddTxAnnouncement()`), so this assert would pass even if the node wasn't in IBD.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T17:53:18Z",
      "diff_hunk" : "@@ -28,6 +42,30 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # assert peer_inver doesn't receive a getdata for the txid\n+        with p2p_lock:\n+            assert txid not in peer_inver.getdata_requests",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585782939",
      "id" : 585782939,
      "line" : 59,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTc4MjkzOQ==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 59,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : 47,
      "pull_request_review_id" : 602101317,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585782939",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585791701"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585791701"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Could log the rejection to the debug NET category?\r\n\r\nwe considered adding logging, but it seemed like it could be annoying if you're connected to a client who keeps sending TXs? seems like if you get 1 you might get many?",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T18:05:40Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585791701",
      "id" : 585791701,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTc5MTcwMQ==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602114174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585791701",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585835092"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585835092"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you will already log that a message of type `tx` has been received, so adding another line wouldn't make things worse than they are now?\r\n\r\nMy thinking is that this code path should rarely be hit, because outbound connections generally don't announce txs via raw `tx` messages and inbound connections would only connect to you once your address is well propagated on the network, in which case you'll have left IBD.\r\n\r\nIf a peer wants to annoy you, they can already send a message that will log at least one line in the NET debug category (before and after this pull).",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T19:10:08Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585835092",
      "id" : 585835092,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTgzNTA5Mg==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602170347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585835092",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585839634"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585839634"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I also thought we'd go by this [comment](https://github.com/bitcoin/bitcoin/blob/master/src/logging.h#L164-L166) that says not to log too much unnecessarily? My goal here is to do as little as possible when there's peers sending us unsolicited transactions we have no use for (which apparently does happen - there's a bit of discussion [here](https://bitcoincore.reviews/21224#l-173)).",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T19:17:39Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585839634",
      "id" : 585839634,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTgzOTYzNA==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602176276,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585839634",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585840437"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585840437"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done!",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T19:18:46Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585840437",
      "id" : 585840437,
      "in_reply_to_id" : 585781532,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTg0MDQzNw==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3209,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602177198,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585840437",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585840544"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585840544"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done!",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T19:18:54Z",
      "diff_hunk" : "@@ -5,9 +5,23 @@\n \"\"\"Test fee filters during and after IBD.\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585840544",
      "id" : 585840544,
      "in_reply_to_id" : 585781699,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTg0MDU0NA==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 5,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 602177324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585840544",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585841061"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585841061"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oopsie! Added a sleep + sync with ping",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T19:19:43Z",
      "diff_hunk" : "@@ -28,6 +42,30 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # assert peer_inver doesn't receive a getdata for the txid\n+        with p2p_lock:\n+            assert txid not in peer_inver.getdata_requests",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585841061",
      "id" : 585841061,
      "in_reply_to_id" : 585782939,
      "line" : 59,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTg0MTA2MQ==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 59,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : 47,
      "pull_request_review_id" : 602178005,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585841061",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585851015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585851015"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah, that comment is about the unconditional log, which probably shouldn't be used in net at all. The conditional NET log doesn't have that concern. (If it did, we already have a massive problem, because on a medium activity node the NET log category eats up about 1TB of disk every 6 months)",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T19:35:11Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585851015",
      "id" : 585851015,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTg1MTAxNQ==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602190967,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585851015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585862863"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585862863"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke seems like you think this information useful to surface to the user, can you share why? what could a node operator do with this information? ",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T19:51:25Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585862863",
      "id" : 585862863,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTg2Mjg2Mw==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602205220,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585862863",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585918460"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585918460"
         }
      },
      "author_association" : "MEMBER",
      "body" : "As a transaction received during IBD is necessary unsolicited, you might want to `setban` the faultive peer because that's a hint of a peer non-compliant with the inv-getdata sequence ?",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T21:21:27Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585918460",
      "id" : 585918460,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTkxODQ2MA==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602283471,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585918460",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585929777"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585929777"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Note this is also used in p2p_tx_download.py, can you move this in p2p.py ? If we update the production `NONPREF_PEER_TX_DELAY`, it's easier to have corresponding test constants in one place.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T21:40:38Z",
      "diff_hunk" : "@@ -2,15 +2,35 @@\n # Copyright (c) 2020 The Bitcoin Core developers\n # Distributed under the MIT software license, see the accompanying\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n-\"\"\"Test fee filters during and after IBD.\"\"\"\n+\"\"\"Test transaction relay behavior during IBD:\n+- Set fee filters to MAX_MONEY\n+- Don't request transactions\n+- Ignore all transaction messages\n+\"\"\"\n \n from decimal import Decimal\n+from io import BytesIO\n+import time\n \n-from test_framework.messages import COIN\n+from test_framework.messages import (\n+        CInv,\n+        COIN,\n+        CTransaction,\n+        msg_inv,\n+        msg_tx,\n+        MSG_WTX,\n+)\n+from test_framework.p2p import (\n+        P2PDataStore,\n+        P2PInterface,\n+        p2p_lock\n+)\n from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import hex_str_to_bytes\n \n MAX_FEE_FILTER = Decimal(9170997) / COIN\n NORMAL_FEE_FILTER = Decimal(100) / COIN\n+NONPREF_PEER_TX_DELAY = 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585929777",
      "id" : 585929777,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTkyOTc3Nw==",
      "original_commit_id" : "d6314481efa4ff054dc036e980b4923ee5d1d736",
      "original_line" : 33,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 602297876,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585929777",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585952117"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585952117"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You could use the \"received: tx (x bytes) peer=x\" [log](https://github.com/bitcoin/bitcoin/blob/b9f41df1ead4b6a83a51fc41966b111c8459c313/src/net_processing.cpp#L2527) if you wanted to look for tx messages in IBD",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-02T22:20:38Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r585952117",
      "id" : 585952117,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTk1MjExNw==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602326048,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585952117",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r586227564"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/586227564"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fair enough. The existing debug log statements are sufficient to determine whether this code path was hit. Though, for an easy `grep` I'd still prefer a specific log statement, but I guess I can add this myself.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-03T08:53:44Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Also stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.\n+        if (::ChainstateActive().IsInitialBlockDownload()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r586227564",
      "id" : 586227564,
      "in_reply_to_id" : 585433607,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NjIyNzU2NA==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 3211,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 602650674,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/586227564",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK d6314481efa4ff054dc036e980b4923ee5d1d736",
      "created_at" : "2021-03-03T09:14:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-789562105",
      "id" : 789562105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4OTU2MjEwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-03T09:14:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789562105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r586256865"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/586256865"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks. Looks good.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-03T09:33:08Z",
      "diff_hunk" : "@@ -28,6 +42,30 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # assert peer_inver doesn't receive a getdata for the txid\n+        with p2p_lock:\n+            assert txid not in peer_inver.getdata_requests",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r586256865",
      "id" : 586256865,
      "in_reply_to_id" : 585782939,
      "line" : 59,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NjI1Njg2NQ==",
      "original_commit_id" : "5b9036ef70e4a774e5392525a5ed099d02ebfb1f",
      "original_line" : 59,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : 47,
      "pull_request_review_id" : 602688174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/586256865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r587618759"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587618759"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This comment is confusing to me -- have we decided whether it's protocol-violating to not process unrequested transactions?  That was exactly what I proposed we do elsewhere, in general, but there was debate over whether such a change would be breaking or whether it was useful.\r\n\r\nIf it's not useful for our software to do this in general, I don't know why it's useful to do in this smaller specific case?  And on the flip side, if it's not a protocol violation here, why exactly would it be a protocol violation to do this in general?\r\n\r\nNote also that being in IBD happens not just when we're syncing the whole blockchain, but whenever a node is started up again after being off for a few days.  So I believe that if there are any software projects that send unrequested transactions at all, this would be a potentially observable change for them -- as far as I can tell, even while in IBD we can at least sometimes validate and relay a transaction just fine, if a transaction were only spending utxos that are already confirmed...  (Unless I'm missing some other interaction that would prevent that from working?)\r\n\r\nNot to say that this change can't be made, I'm just looking for reasoning and a comment that explains our actual thinking, because so far I think the reasoning has been contradictory.  If it's not a protocol violation to ignore unrequested transactions, I don't see the harm in us always doing it and avoiding gating yet another behavior on whether we are in IBD (which has always been a source of headaches when developers try to understand why something isn't working as expected).  If it is a protocol violation or potentially breaking, we should note that here and have a better justification for doing it than has been provided so far (particularly if a transaction were coming from a PF_RELAY or PF_FORCERELAY peer, where you might expect us to try harder to pass the transaction on).",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-04T16:27:25Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r587618759",
      "id" : 587618759,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzYxODc1OQ==",
      "original_commit_id" : "9687b98b21bfaed81b6d87c8548c6d542fde9209",
      "original_line" : 3210,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 604297061,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587618759",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r587639359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587639359"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "For some context, the comment is meant to convey that sending us unsolicited transactions is not a protocol violation, and I wanted to distinguish from the case above in which we disconnect the peer in addition to ignoring the transaction for violating no-tx-relay. Something like \"since the peer has not violated protocol, don't punish\" is what I meant. The comment could definitely be clearer.\r\n\r\nMy goal is just to fail early when we don't expect to be able to validate a transaction. It's definitely a good point that we could be perfectly able to validate despite being in IBD. I wonder if we could improve the condition with a better heuristic than \"if in IBD?\"",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-04T16:51:02Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r587639359",
      "id" : 587639359,
      "in_reply_to_id" : 587618759,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzYzOTM1OQ==",
      "original_commit_id" : "9687b98b21bfaed81b6d87c8548c6d542fde9209",
      "original_line" : 3210,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 604323005,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587639359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r587646500"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587646500"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah, yes I completely misparsed that protocol violation comment, thanks for explaining that.\r\n\r\nI'm still looking to understand why this change is beneficial, but a broader change that includes IBD as a subset and also allows for PF_RELAY peers to bypass it, would not be.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-04T16:59:08Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r587646500",
      "id" : 587646500,
      "in_reply_to_id" : 587618759,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzY0NjUwMA==",
      "original_commit_id" : "9687b98b21bfaed81b6d87c8548c6d542fde9209",
      "original_line" : 3210,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 604332059,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587646500",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r587808317"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587808317"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we can consider this change as beneficial as it's a small resources saving during IBD, a period during which our resources should be allocated on a more prioritized task. W.r.t to a broader change adopting this behavior beyond IBD (e.g #21224) we have an explicit concern about silently harming other bitcoin softwares deployed on the tx-relay network. As it's a reasonable assumption to expect only a minority fraction of nodes doing IBD at anytime, this change might be considered as a far lesser disruption.\r\n\r\nThough, we could also say that disruption would be limited for a broader change as we expect deployment cycles to be gradual.\r\n\r\n> I wonder if we could improve the condition with a better heuristic than \"if in IBD?\"\r\n\r\nYou can definitely validate while in IBD. But \"already confirmed utxos\" at your-IBD-tip doesn't mean those have not been spent at network tip. If your last synced block is 100,  your valid transaction might already have been double-spent at block 200, so validation cost would have been lost. IMO, utxo set view should be assumed to fluctuate quickly during IBD. \r\n\r\nAlso, you won't request transactions so your mempool is likely to be empty and you won't be able to accurately weight transaction feerate. Relying on those _heuristics_, better to save on resources until your node is more able to assert with certainty if the transaction is a good candidate for propagation and block inclusion.\r\n",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-04T20:37:48Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r587808317",
      "id" : 587808317,
      "in_reply_to_id" : 587618759,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzgwODMxNw==",
      "original_commit_id" : "9687b98b21bfaed81b6d87c8548c6d542fde9209",
      "original_line" : 3210,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 604537417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587808317",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r589233570"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589233570"
         }
      },
      "author_association" : "MEMBER",
      "body" : ">Ah, yes I completely misparsed that protocol violation comment, thanks for explaining that.\r\n\r\nI just had the same confusion.",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-08T08:07:26Z",
      "diff_hunk" : "@@ -3206,6 +3206,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n \n+        // Stop processing the transaction early if we are still in IBD since we don't\n+        // have enough information to validate it yet. Not a protocol violation.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r589233570",
      "id" : 589233570,
      "in_reply_to_id" : 587618759,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTIzMzU3MA==",
      "original_commit_id" : "9687b98b21bfaed81b6d87c8548c6d542fde9209",
      "original_line" : 3210,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 606041959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T21:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589233570",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Issues like those being explored in #21106 â where IBD may kick in at unintuitive times, complicating our understanding of the network due to special-case interactions throughout our codebase â are why I think we should hesitate before adding more checks gated on IBD and ensure we have a good reason for doing so.\r\n\r\nIn this case, I think our code is simpler to understand if we either always or never processed unrequested transactions (and the benefit to skipping this while in IBD seems small in comparison).",
      "created_at" : "2021-03-09T23:49:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-794620032",
      "id" : 794620032,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NDYyMDAzMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T23:49:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/794620032",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\nðµï¸ @sipa has been requested to review this pull request as specified in the REVIEWERS file.",
      "created_at" : "2021-03-15T16:49:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-799574190",
      "id" : 799574190,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5OTU3NDE5MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-15T16:49:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799574190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just pushed some changes addressing @ariardâs review comment and clarifying the comment about ânot a protocol violation.â\r\n\r\nOn why add a gate for unsolicited transactions in IBD but not the general case:\r\n\r\nThere can perhaps be an observable difference if we stop processing unsolicited transactions in the general case - someone mentioned in #21224 that there are clients that wouldnât be able to broadcast their transactions because they donât follow the inv/getdata dialogue. I'm not sure what the status is on that discussion so I won't speak to it too much.\r\n\r\nOn the other hand, I donât think thereâs any downside to ignoring unsolicited transactions in IBD. We just have less wasted effort: Right now, if we canât validate the transaction yet, we waste time putting it into orphan pool. If it conflicts with a block tx we see later on, we need to go through removing it from our mempool. If itâs valid and we can validate it, doing so while in IBD doesnât benefit us - even if we come out of IBD really quickly (e.g. on a restart), we can download it again in a rebroadcast (or, later on, a reconciliation with Erlay). My personal opinion is that getting to exit early is worth the complexity of an extra `IsIBD` check, even if we later change it to ignore all unsolicited transactions.",
      "created_at" : "2021-03-24T22:05:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-806215485",
      "id" : 806215485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNjIxNTQ4NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-24T22:09:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/806215485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r600905035"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600905035"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done!",
      "commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "created_at" : "2021-03-24T22:05:18Z",
      "diff_hunk" : "@@ -2,15 +2,35 @@\n # Copyright (c) 2020 The Bitcoin Core developers\n # Distributed under the MIT software license, see the accompanying\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n-\"\"\"Test fee filters during and after IBD.\"\"\"\n+\"\"\"Test transaction relay behavior during IBD:\n+- Set fee filters to MAX_MONEY\n+- Don't request transactions\n+- Ignore all transaction messages\n+\"\"\"\n \n from decimal import Decimal\n+from io import BytesIO\n+import time\n \n-from test_framework.messages import COIN\n+from test_framework.messages import (\n+        CInv,\n+        COIN,\n+        CTransaction,\n+        msg_inv,\n+        msg_tx,\n+        MSG_WTX,\n+)\n+from test_framework.p2p import (\n+        P2PDataStore,\n+        P2PInterface,\n+        p2p_lock\n+)\n from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import hex_str_to_bytes\n \n MAX_FEE_FILTER = Decimal(9170997) / COIN\n NORMAL_FEE_FILTER = Decimal(100) / COIN\n+NONPREF_PEER_TX_DELAY = 2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r600905035",
      "id" : 600905035,
      "in_reply_to_id" : 585929777,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDkwNTAzNQ==",
      "original_commit_id" : "d6314481efa4ff054dc036e980b4923ee5d1d736",
      "original_line" : 33,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 620269790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T22:05:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600905035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 89ebd01de2",
      "created_at" : "2021-06-09T12:32:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-857654498",
      "id" : 857654498,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1NzY1NDQ5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-09T12:32:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/857654498",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r648528881"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/648528881"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can mocktime be used here?",
      "commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "created_at" : "2021-06-09T17:37:39Z",
      "diff_hunk" : "@@ -28,6 +48,32 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        time.sleep(NONPREF_PEER_TX_DELAY)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r648528881",
      "id" : 648528881,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0ODUyODg4MQ==",
      "original_commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "original_line" : 56,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 679953934,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-11T09:11:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/648528881",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649820311"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649820311"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        tx = FromHex(CTransaction(), rawhex)\r\n```",
      "commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "created_at" : "2021-06-11T09:10:07Z",
      "diff_hunk" : "@@ -28,6 +48,32 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        time.sleep(NONPREF_PEER_TX_DELAY)\n+        peer_inver.sync_with_ping()\n+        with p2p_lock:\n+            assert txid not in peer_inver.getdata_requests\n+        self.nodes[0].disconnect_p2ps()\n+\n+        self.log.info(\"Check that nodes don't process unsolicited transactions while still in IBD\")\n+        # A transaction hex pulled from tx_valid.json. There are no valid transactions since no UTXOs\n+        # exist yet, but it should be a well-formed transaction.\n+        rawhex = \"0100000001b14bdcbc3e01bdaad36cc08e81e69c82e1060bc14e518db2b49aa43ad90ba260000000004a01ff473\" + \\\n+            \"04402203f16c6f40162ab686621ef3000b04e75418a0c0cb2d8aebeac894ae360ac1e780220ddc15ecdfc3507ac48e168\" + \\\n+            \"1a33eb60996631bf6bf5bc0a0682c4db743ce7ca2b01ffffffff0140420f00000000001976a914660d4ef3a743e3e696a\" + \\\n+            \"d990364e555c271ad504b88ac00000000\"\n+        assert self.nodes[1].decoderawtransaction(rawhex) # returns a dict, should not throw\n+        tx = CTransaction()\n+        tx.deserialize(BytesIO(hex_str_to_bytes(rawhex)))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649820311",
      "id" : 649820311,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTgyMDMxMQ==",
      "original_commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "original_line" : 71,
      "original_position" : 59,
      "original_start_line" : 70,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 679953934,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-06-11T09:11:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649820311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649845401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649845401"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, fixed",
      "commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "created_at" : "2021-06-11T09:47:41Z",
      "diff_hunk" : "@@ -28,6 +48,32 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        time.sleep(NONPREF_PEER_TX_DELAY)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649845401",
      "id" : 649845401,
      "in_reply_to_id" : 648528881,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTg0NTQwMQ==",
      "original_commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "original_line" : 56,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 681652060,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-11T09:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649845401",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649845490"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649845490"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "created_at" : "2021-06-11T09:47:51Z",
      "diff_hunk" : "@@ -28,6 +48,32 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        time.sleep(NONPREF_PEER_TX_DELAY)\n+        peer_inver.sync_with_ping()\n+        with p2p_lock:\n+            assert txid not in peer_inver.getdata_requests\n+        self.nodes[0].disconnect_p2ps()\n+\n+        self.log.info(\"Check that nodes don't process unsolicited transactions while still in IBD\")\n+        # A transaction hex pulled from tx_valid.json. There are no valid transactions since no UTXOs\n+        # exist yet, but it should be a well-formed transaction.\n+        rawhex = \"0100000001b14bdcbc3e01bdaad36cc08e81e69c82e1060bc14e518db2b49aa43ad90ba260000000004a01ff473\" + \\\n+            \"04402203f16c6f40162ab686621ef3000b04e75418a0c0cb2d8aebeac894ae360ac1e780220ddc15ecdfc3507ac48e168\" + \\\n+            \"1a33eb60996631bf6bf5bc0a0682c4db743ce7ca2b01ffffffff0140420f00000000001976a914660d4ef3a743e3e696a\" + \\\n+            \"d990364e555c271ad504b88ac00000000\"\n+        assert self.nodes[1].decoderawtransaction(rawhex) # returns a dict, should not throw\n+        tx = CTransaction()\n+        tx.deserialize(BytesIO(hex_str_to_bytes(rawhex)))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649845490",
      "id" : 649845490,
      "in_reply_to_id" : 649820311,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTg0NTQ5MA==",
      "original_commit_id" : "89ebd01de2c75eb05e88376fc90030fcfbdeb352",
      "original_line" : 71,
      "original_position" : 59,
      "original_start_line" : 70,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 681652192,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-06-11T09:47:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649845490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649850761"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649850761"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        peer_inver.sync_send_with_ping()\r\n```\r\n\r\nTo account for the possibility that pongs are sent before getdata?",
      "commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "created_at" : "2021-06-11T09:56:04Z",
      "diff_hunk" : "@@ -28,6 +47,31 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        self.nodes[0].setmocktime(int(time.time() + NONPREF_PEER_TX_DELAY))\n+        peer_inver.sync_with_ping()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649850761",
      "id" : 649850761,
      "line" : 56,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTg1MDc2MQ==",
      "original_commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "original_line" : 56,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : 43,
      "pull_request_review_id" : 681659092,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-11T09:57:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649850761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649855931"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649855931"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes :brain:",
      "commit_id" : "648c5c73aef8785e49b7f23622f9d6e87b72f013",
      "created_at" : "2021-06-11T10:04:22Z",
      "diff_hunk" : "@@ -28,6 +47,31 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        self.nodes[0].setmocktime(int(time.time() + NONPREF_PEER_TX_DELAY))\n+        peer_inver.sync_with_ping()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649855931",
      "id" : 649855931,
      "in_reply_to_id" : 649850761,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTg1NTkzMQ==",
      "original_commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "original_line" : 56,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 681666189,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-11T10:04:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649855931",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649856390"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649856390"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Wait, isn't there a ping after the inv? since we're calling `send_and_ping()`?",
      "commit_id" : "648c5c73aef8785e49b7f23622f9d6e87b72f013",
      "created_at" : "2021-06-11T10:05:11Z",
      "diff_hunk" : "@@ -28,6 +47,31 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        self.nodes[0].setmocktime(int(time.time() + NONPREF_PEER_TX_DELAY))\n+        peer_inver.sync_with_ping()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649856390",
      "id" : 649856390,
      "in_reply_to_id" : 649850761,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTg1NjM5MA==",
      "original_commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "original_line" : 56,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 681666798,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-11T10:05:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649856390",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649862838"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649862838"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There is, but it doesn't matter. The pong in this line (after mocktime) will be sent out here:\r\n\r\n```\r\n            // Receive messages\r\n            bool fMoreNodeWork = m_msgproc->ProcessMessages(pnode, flagInterruptMsgProc);\r\n```\r\n\r\nAt this point no messages have been sent out (no getdata etc). Sending will happen right after, but may take a long time if the thread is put aside or the buffer is full.",
      "commit_id" : "648c5c73aef8785e49b7f23622f9d6e87b72f013",
      "created_at" : "2021-06-11T10:16:12Z",
      "diff_hunk" : "@@ -28,6 +47,31 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        self.nodes[0].setmocktime(int(time.time() + NONPREF_PEER_TX_DELAY))\n+        peer_inver.sync_with_ping()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649862838",
      "id" : 649862838,
      "in_reply_to_id" : 649850761,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTg2MjgzOA==",
      "original_commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "original_line" : 56,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 681675256,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-11T10:16:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649862838",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649867691"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649867691"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased for #21785 and added this",
      "commit_id" : "648c5c73aef8785e49b7f23622f9d6e87b72f013",
      "created_at" : "2021-06-11T10:24:29Z",
      "diff_hunk" : "@@ -28,6 +47,31 @@ def run_test(self):\n             assert node.getblockchaininfo()['initialblockdownload']\n             self.wait_until(lambda: all(peer['minfeefilter'] == MAX_FEE_FILTER for peer in node.getpeerinfo()))\n \n+        self.log.info(\"Check that nodes don't send getdatas for transactions while still in IBD\")\n+        peer_inver = self.nodes[0].add_p2p_connection(P2PDataStore())\n+        txid = 0xdeadbeef\n+        peer_inver.send_and_ping(msg_inv([CInv(t=MSG_WTX, h=txid)]))\n+        # The node should not send a getdata, but if it did, it would first delay 2 seconds\n+        self.nodes[0].setmocktime(int(time.time() + NONPREF_PEER_TX_DELAY))\n+        peer_inver.sync_with_ping()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r649867691",
      "id" : 649867691,
      "in_reply_to_id" : 649850761,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0OTg2NzY5MQ==",
      "original_commit_id" : "1665bbdb28a84ecd228ec9685d8069d84d1849e8",
      "original_line" : 56,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 681681530,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-11T10:24:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/649867691",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 648c5c73aef8785e49b7f23622f9d6e87b72f013",
      "created_at" : "2021-06-11T12:31:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-859548111",
      "id" : 859548111,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1OTU0ODExMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-11T12:31:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/859548111",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The code 648c5c73aef8785e49b7f23622f9d6e87b72f013 looks correct, but I share the hesitation suhas [expressed above](https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-794620032).",
      "created_at" : "2021-09-29T10:28:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-930050728",
      "id" : 930050728,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "IC_kwDOABII5843b3Ko",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-29T10:28:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/930050728",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r725701309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725701309"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Silent conflict. This needs to get renamed to `from_hex`",
      "commit_id" : "648c5c73aef8785e49b7f23622f9d6e87b72f013",
      "created_at" : "2021-10-10T21:31:21Z",
      "diff_hunk" : "@@ -2,11 +2,30 @@\n # Copyright (c) 2020 The Bitcoin Core developers\n # Distributed under the MIT software license, see the accompanying\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n-\"\"\"Test fee filters during and after IBD.\"\"\"\n+\"\"\"Test transaction relay behavior during IBD:\n+- Set fee filters to MAX_MONEY\n+- Don't request transactions\n+- Ignore all transaction messages\n+\"\"\"\n \n from decimal import Decimal\n+import time\n \n-from test_framework.messages import COIN\n+from test_framework.messages import (\n+        CInv,\n+        COIN,\n+        CTransaction,\n+        FromHex,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r725701309",
      "id" : 725701309,
      "line" : 18,
      "node_id" : "PRRC_kwDOABII584rQVK9",
      "original_commit_id" : "648c5c73aef8785e49b7f23622f9d6e87b72f013",
      "original_line" : 18,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : 19,
      "pull_request_review_id" : 775712901,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725701309/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-10T21:31:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725701309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r738518717"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738518717"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "thanks, rebased",
      "commit_id" : "6aed8b7e9b206e728367fee9edfeb85b536bba69",
      "created_at" : "2021-10-28T15:37:50Z",
      "diff_hunk" : "@@ -2,11 +2,30 @@\n # Copyright (c) 2020 The Bitcoin Core developers\n # Distributed under the MIT software license, see the accompanying\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n-\"\"\"Test fee filters during and after IBD.\"\"\"\n+\"\"\"Test transaction relay behavior during IBD:\n+- Set fee filters to MAX_MONEY\n+- Don't request transactions\n+- Ignore all transaction messages\n+\"\"\"\n \n from decimal import Decimal\n+import time\n \n-from test_framework.messages import COIN\n+from test_framework.messages import (\n+        CInv,\n+        COIN,\n+        CTransaction,\n+        FromHex,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#discussion_r738518717",
      "id" : 738518717,
      "in_reply_to_id" : 725701309,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sBOa9",
      "original_commit_id" : "648c5c73aef8785e49b7f23622f9d6e87b72f013",
      "original_line" : 18,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "test/functional/p2p_ibd_txrelay.py",
      "position" : null,
      "pull_request_review_id" : 792048766,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21327",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738518717/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-28T15:37:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/738518717",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "reACK 6aed8b7e9b",
      "created_at" : "2021-11-02T13:05:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-957527251",
      "id" : 957527251,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "IC_kwDOABII5845ErTT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957527251/reactions"
      },
      "updated_at" : "2021-11-02T13:05:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957527251",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 6aed8b7e9b206e728367fee9edfeb85b536bba69\r\nI've always shared Suhas' hesitation with regard to gating things on some (pretty arbitrary) \"initial block download\" criterion. But in this specific case, without an up-to-date view of blocks it's not that useful to process transactions, so I think it makes sense.",
      "created_at" : "2021-11-30T18:05:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21327#issuecomment-982886722",
      "id" : 982886722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21327",
      "node_id" : "IC_kwDOABII5846lalC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/982886722/reactions"
      },
      "updated_at" : "2021-11-30T18:05:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/982886722",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
