[
   {
      "author_association" : "MEMBER",
      "body" : "(edited title)",
      "created_at" : "2021-03-02T09:43:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21331#issuecomment-788772660",
      "id" : 788772660,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21331",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODc3MjY2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T09:43:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788772660",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21366 (refactor: replace util::Ref with std::any (C++17) by theStack)\n* #21359 (rpc: include_unsafe option for fundrawtransaction by t-bast)\n* #21329 (descriptor wallet: Cache last hardened xpub and use in normalized descriptors by achow101)\n* #21206 (refactor: Make CWalletTx sync state type-safe by ryanofsky)\n* #20640 (wallet, refactor: return out-params of CreateTransaction() as optional struct by theStack)\n* #20583 (rpc: Add missing BlockUntilSyncedToCurrentChain to wallet RPCs by MarcoFalke)\n* #14707 ([RPC] Include coinbase transactions in receivedby RPCs by andrewtoth)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-03-02T10:07:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21331#issuecomment-788788721",
      "id" : 788788721,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21331",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODc4ODcyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T17:04:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788788721",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21331#discussion_r585439441"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21331"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585439441"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Our style is no longer to use `pthing` as the name for pointer variables, but I guess you did this to be consistent with the other functions in this file.",
      "commit_id" : "7c90c67b7e6f598f9ffdc136ded2b533b78ed044",
      "created_at" : "2021-03-02T10:19:52Z",
      "diff_hunk" : "@@ -1768,20 +1758,20 @@ RPCHelpMan listdescriptors()\n         },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n-    if (!wallet) return NullUniValue;\n+    std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21331#discussion_r585439441",
      "id" : 585439441,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTQzOTQ0MQ==",
      "original_commit_id" : "199c81f5fb54fa9d944968bf35c505e3941ddf67",
      "original_line" : 1761,
      "original_position" : 357,
      "original_start_line" : null,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : null,
      "pull_request_review_id" : 601654261,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21331",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-05T01:28:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585439441",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Super Strong Concept ACK for safety reasons: pre-conditions should be stated explicitly and be enforced at compile-time where possible.\r\n\r\nThanks for tackling these!\r\n\r\nI stumbled upon a similar case in the networking code the other day. More generally it seems like there are a few functions in our case base where we take `T*` instead of `T&` in places where we don't safely handle the `nullptr` case. That's quite confusing and potentially dangerous. I think it makes sense to convert these from `T*` to `T&` gradually over time. This PR is a good start :)\r\n\r\n---\r\n\r\nMore specifically â¦\r\n\r\n```c++\r\nvoid f_1(T& t) { t.foo(); }\r\n```\r\n\r\nâ¦ is preferable over â¦\r\n\r\n```c++\r\nvoid f_2(T* t) { t->foo(); }\r\n```\r\n\r\nLive demo:\r\n\r\n```c++\r\n$ cat nullptr-deref.cpp\r\n#include <iostream>\r\n\r\nstruct T {\r\n    void foo() { std::cout << this << \"->foo()\\n\"; }\r\n};\r\n\r\nvoid f_1(T& t) { t.foo(); }\r\n\r\nvoid f_2(T* t) { t->foo(); }\r\n\r\nint main(void)\r\n{\r\n    T t;\r\n    f_1(t);\r\n    f_2(&t);\r\n\r\n    // f_1(nullptr); // compile time error: no known conversion from nullptr_t to T&\r\n    f_2(nullptr);\r\n}\r\n$ clang++ -o nullptr-deref nullptr-deref.cpp && ./nullptr-deref\r\n0x7fff9e191234->foo()\r\n0x7fff9e191234->foo()\r\n0->foo()\r\n$ g++ -o nullptr-deref nullptr-deref.cpp && ./nullptr-deref\r\n0x7fff9e191234->foo()\r\n0x7fff9e191234->foo()\r\n0->foo()\r\n$ clang++ -fsanitize=undefined -o nullptr-deref nullptr-deref.cpp && ./nullptr-deref\r\n0x7fff9e191234->foo()\r\n0x7fff9e191234->foo()\r\nnullptr-deref.cpp:9:21: runtime error: member call on null pointer of type 'T'\r\nSUMMARY: UndefinedBehaviorSanitizer: undefined-behavior nullptr-deref.cpp:9:21 in\r\nnullptr-deref.cpp:4:10: runtime error: member call on null pointer of type 'T *'\r\nSUMMARY: UndefinedBehaviorSanitizer: undefined-behavior nullptr-deref.cpp:4:10 in\r\n0->foo()\r\n```\r\n\r\nNote how `f_1(nullptr)` gives a nice compile-time error whereas `f_2(nullptr)` gives a run-time WTF (at best) :)",
      "created_at" : "2021-03-02T11:58:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21331#issuecomment-788857034",
      "id" : 788857034,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21331",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODg1NzAzNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T12:16:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788857034",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21331#discussion_r587957744"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21331"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587957744"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yea it's done to keep the diff to a minimum, otherwise we'd also have to rename all the pwallet usage in each function.",
      "commit_id" : "7c90c67b7e6f598f9ffdc136ded2b533b78ed044",
      "created_at" : "2021-03-05T01:27:29Z",
      "diff_hunk" : "@@ -1768,20 +1758,20 @@ RPCHelpMan listdescriptors()\n         },\n         [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n {\n-    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n-    if (!wallet) return NullUniValue;\n+    std::shared_ptr<CWallet> const pwallet = GetWalletForJSONRPCRequest(request);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21331#discussion_r587957744",
      "id" : 587957744,
      "in_reply_to_id" : 585439441,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4Nzk1Nzc0NA==",
      "original_commit_id" : "199c81f5fb54fa9d944968bf35c505e3941ddf67",
      "original_line" : 1761,
      "original_position" : 357,
      "original_start_line" : null,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : null,
      "pull_request_review_id" : 604720993,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21331",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-05T01:28:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587957744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think this would be much easier to review if it was split into two commits:\r\n\r\nThis is now split into two commits.",
      "created_at" : "2021-03-05T01:28:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21331#issuecomment-791075536",
      "id" : 791075536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21331",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MTA3NTUzNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-05T01:28:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/791075536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 7c90c67b7e6f598f9ffdc136ded2b533b78ed044 ð§\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nACK 7c90c67b7e6f598f9ffdc136ded2b533b78ed044 ð§\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUhiuAwApvxFWa2GM0vLZKgdZ8tCocQ52qIb/VphCjBZlzqC9iDCdexw+68eQAgN\r\n0Q/EbzNXvZURPeOBOdoxH8tR25R83uvyLaCz/LAtDV65Md6a2aKdfohI5VmFUbbi\r\niOloTCEMLJL9GShzZwV8jf6ggcp/I8VDcCx6bwchJNf1q07V+ykiBnxeYFQlPM2Y\r\nfcDOc2G7jbhLuSH/TBI9tdoEzzYG6tqbOuaTJ/gwzz7W0MlN2OuqfWtdkLvq4HXG\r\nAOu4e2pBzL9QkUbi/rDkRRQCRIfZOM5g7ggWY7gSiRXv9QWFYhNqGYkqCGWkZRMH\r\nuZnk0yRLKXOEyfGBZlAScugPzTtLaI9Yf4cCbFigZE4xl7gyKRHgdNzx/Uldzh4F\r\nTjAJOwZBrLQepDyg0EqIAazdo7ELrdq/yXFirhimLZpnJxLwz8RNrxlFY3D0MFOF\r\nYHOR8rkn5eLI3Z79YFxxSq92S5utVpjhga7/C1e9wkVuiPzw4mfS5pUnzukRSY1j\r\nhla9xmWx\r\n=grAy\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `a4b1e57819992cf30341a0c036b138d89f4d20fc296eae408b441244f39f67f2  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e892940108a4b1e57819992cf30341a0c036b138d89f4d20fc296eae408b441244f39f67f2f0109438f8b56fa6c578bce6cdb915c20b2508fff0100060e1e9a44afb6ccb29081d7785fe2008f1046048663ff008363844fb9db1c2940083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6dfff010263bbf03c4e77cd50e6935cf7276c73408f10460487414f00850dde4e9fe64da430083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff01039c69d7c8360b1ff1eab1a2c45a184c308f10460487414f0081d1f9a9cae0a0bbd0083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267f01097fdc03529c0a77821980eb62b62bd7e08f10460487414f008c6a3ae7dbae021530083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6d)\r\n\r\n</details>\r\n",
      "created_at" : "2021-03-10T07:24:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21331#issuecomment-795014139",
      "id" : 795014139,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21331",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NTAxNDEzOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-10T07:24:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/795014139",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
