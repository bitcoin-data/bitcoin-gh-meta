[
   {
      "author_association" : "MEMBER",
      "body" : "I can reproduce this all the way back to commit fab7d954b261d74b369fe2a3c1785540c4f056b4 (at which point a BDB valgrind error takes over which I'll need to silence).",
      "created_at" : "2021-03-05T03:03:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/21367#issuecomment-791116184",
      "id" : 791116184,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21367",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MTExNjE4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-05T03:03:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/791116184",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Might not be relevant here but sometimes valgrind \"Conditional jump or move depends on uninitialised value(s)\" errors are spurious. This was the case previously in #18785.",
      "created_at" : "2021-03-05T03:18:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/21367#issuecomment-791121559",
      "id" : 791121559,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21367",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MTEyMTU1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-05T03:18:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/791121559",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I would not be surprised if this was spurious (the fact that it goes away when trying to add logging to inspect is a sign, but not a guarantee - if it's the result of miscompilation, it may actually be invalid machine code, and also actually go away with changed C++ code).",
      "created_at" : "2021-03-05T03:24:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/21367#issuecomment-791123359",
      "id" : 791123359,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21367",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MTEyMzM1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-05T03:24:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/791123359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I can't reproduce with the valgrind ci config",
      "created_at" : "2021-03-05T07:03:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/21367#issuecomment-791204438",
      "id" : 791204438,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21367",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MTIwNDQzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-05T07:03:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/791204438",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I couldn't reproduce this either, but I'm using an older version of gcc.\r\n\r\nIt should be pretty straightforward to look at the assembly code at the address printed by valgrind (`0x5873EB` in the example above) and see what uninitialized value it's referring to, and whether it's a really a bug for the value to be uninitialized. Like if the line number mentioned in IRC is referring to:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/ed25cb58f605ba583c735f330482df0bf9348f3a/src/wallet/wallet.cpp#L1822-L1824\r\n\r\nIt would be perfectly fine for optimized `&&` code to not short circuit and for the `block_height >= *max_height` comparison to execute with some garbage uninitialized `*max_height` value when the other branch of the `&&` expression is false anyway.\r\n\r\nGetting GDB to run with functional tests is a minor PITA. I use little wrapper scripts that fork off gdb in screen processes like:\r\n\r\n```sh\r\n#!/bin/bash\r\nexec screen -S \"bitcoind_${PPID}_$$\" -D -m gdb -ex run --args /path/to/src/bitcoind \"$@\"\r\n```\r\n\r\nRun the test with:\r\n\r\n```sh\r\nBITCOIND=/path/to/little_script test/functional/wallet_hd.py --descriptors --valgrind\r\n```\r\n\r\nConnect to GDB with:\r\n\r\n```sh\r\nscreen -r\r\n```\r\n\r\nWhere you can type in GDB commands like::\r\n\r\n```\r\ndisassemble 0x5873EB\r\n```\r\n\r\n",
      "created_at" : "2021-03-05T14:38:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/21367#issuecomment-791459146",
      "id" : 791459146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21367",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MTQ1OTE0Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-05T14:38:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/791459146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is this still an issue with a recent version of Bitcoin Core? If yes, what are the steps to reproduce?",
      "created_at" : "2022-08-15T11:35:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/21367#issuecomment-1214913907",
      "id" : 1214913907,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21367",
      "node_id" : "IC_kwDOABII585Iah1z",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1214913907/reactions"
      },
      "updated_at" : "2022-08-15T11:35:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1214913907",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
