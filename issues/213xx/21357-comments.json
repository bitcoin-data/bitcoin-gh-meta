[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r587300384"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587300384"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think better would be to just catch `struct.error`:\r\n\r\n```suggestion\r\n        except struct.error:\r\n            self.relay = 0\r\n```\r\n\r\nand allow all other exceptions to raise.",
      "commit_id" : "39a9ec579f023ab262a1abd1f0c869be5b1f3f4d",
      "created_at" : "2021-03-04T09:27:05Z",
      "diff_hunk" : "@@ -1045,13 +1045,13 @@ def deserialize(self, f):\n \n         self.nStartingHeight = struct.unpack(\"<i\", f.read(4))[0]\n \n-        if self.nVersion >= 70001:\n-            # Relay field is optional for version 70001 onwards\n-            try:\n-                self.relay = struct.unpack(\"<b\", f.read(1))[0]\n-            except:\n-                self.relay = 0\n-        else:\n+        # Relay field is optional for version 70001 onwards\n+        # But, unconditionally check it to match behaviour in bitcoind\n+        try:\n+            self.relay = struct.unpack(\"<b\", f.read(1))[0]\n+        except KeyboardInterrupt:\n+            raise KeyboardInterrupt\n+        except:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r587300384",
      "id" : 587300384,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzMwMDM4NA==",
      "original_commit_id" : "bfc4333a502ba85d4e63ce82259657484cc994dc",
      "original_line" : 1054,
      "original_position" : 17,
      "original_start_line" : 1052,
      "path" : "test/functional/test_framework/messages.py",
      "position" : null,
      "pull_request_review_id" : 603881240,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-24T00:00:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587300384",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r588530282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588530282"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "addressed in 5c46992",
      "commit_id" : "39a9ec579f023ab262a1abd1f0c869be5b1f3f4d",
      "created_at" : "2021-03-05T17:57:22Z",
      "diff_hunk" : "@@ -1045,13 +1045,13 @@ def deserialize(self, f):\n \n         self.nStartingHeight = struct.unpack(\"<i\", f.read(4))[0]\n \n-        if self.nVersion >= 70001:\n-            # Relay field is optional for version 70001 onwards\n-            try:\n-                self.relay = struct.unpack(\"<b\", f.read(1))[0]\n-            except:\n-                self.relay = 0\n-        else:\n+        # Relay field is optional for version 70001 onwards\n+        # But, unconditionally check it to match behaviour in bitcoind\n+        try:\n+            self.relay = struct.unpack(\"<b\", f.read(1))[0]\n+        except KeyboardInterrupt:\n+            raise KeyboardInterrupt\n+        except:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r588530282",
      "id" : 588530282,
      "in_reply_to_id" : 587300384,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODUzMDI4Mg==",
      "original_commit_id" : "bfc4333a502ba85d4e63ce82259657484cc994dc",
      "original_line" : 1054,
      "original_position" : 17,
      "original_start_line" : 1052,
      "path" : "test/functional/test_framework/messages.py",
      "position" : null,
      "pull_request_review_id" : 605468964,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-24T00:00:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588530282",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23396902?v=4",
         "events_url" : "https://api.github.com/users/jarolrod/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jarolrod/followers",
         "following_url" : "https://api.github.com/users/jarolrod/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jarolrod/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jarolrod",
         "id" : 23396902,
         "login" : "jarolrod",
         "node_id" : "MDQ6VXNlcjIzMzk2OTAy",
         "organizations_url" : "https://api.github.com/users/jarolrod/orgs",
         "received_events_url" : "https://api.github.com/users/jarolrod/received_events",
         "repos_url" : "https://api.github.com/users/jarolrod/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jarolrod/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jarolrod/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jarolrod"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated from  bfc4333 -> 5c46992, addressed @jnewbery suggestions\r\n\r\nChanges:\r\n- catch specific `struct.error` instead of blanket except",
      "created_at" : "2021-03-05T17:57:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21357#issuecomment-791584194",
      "id" : 791584194,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21357",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MTU4NDE5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-05T17:57:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/791584194",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23396902?v=4",
         "events_url" : "https://api.github.com/users/jarolrod/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jarolrod/followers",
         "following_url" : "https://api.github.com/users/jarolrod/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jarolrod/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jarolrod",
         "id" : 23396902,
         "login" : "jarolrod",
         "node_id" : "MDQ6VXNlcjIzMzk2OTAy",
         "organizations_url" : "https://api.github.com/users/jarolrod/orgs",
         "received_events_url" : "https://api.github.com/users/jarolrod/received_events",
         "repos_url" : "https://api.github.com/users/jarolrod/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jarolrod/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jarolrod/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jarolrod"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r591467529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591467529"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You can remove:\r\n\r\n```\r\n        except KeyboardInterrupt:\r\n            raise KeyboardInterrupt\r\n```\r\n\r\nsince there's no blanket `except` catching, this is doing nothing (`KeyboardInterrupt` exceptions would be raised anyway)",
      "commit_id" : "39a9ec579f023ab262a1abd1f0c869be5b1f3f4d",
      "created_at" : "2021-03-10T12:51:36Z",
      "diff_hunk" : "@@ -1045,13 +1045,13 @@ def deserialize(self, f):\n \n         self.nStartingHeight = struct.unpack(\"<i\", f.read(4))[0]\n \n-        if self.nVersion >= 70001:\n-            # Relay field is optional for version 70001 onwards\n-            try:\n-                self.relay = struct.unpack(\"<b\", f.read(1))[0]\n-            except:\n-                self.relay = 0\n-        else:\n+        # Relay field is optional for version 70001 onwards\n+        # But, unconditionally check it to match behaviour in bitcoind\n+        try:\n+            self.relay = struct.unpack(\"<b\", f.read(1))[0]\n+        except KeyboardInterrupt:\n+            raise KeyboardInterrupt\n+        except:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r591467529",
      "id" : 591467529,
      "in_reply_to_id" : 587300384,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTQ2NzUyOQ==",
      "original_commit_id" : "bfc4333a502ba85d4e63ce82259657484cc994dc",
      "original_line" : 1054,
      "original_position" : 17,
      "original_start_line" : 1052,
      "path" : "test/functional/test_framework/messages.py",
      "position" : null,
      "pull_request_review_id" : 608675655,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-24T00:00:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591467529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated from 5c46992 -> 39a9ec5, addressed @jnewbery [comment](https://github.com/bitcoin/bitcoin/pull/21357#discussion_r591467529)\r\n\r\n**Changes**: I misunderstood the initial suggestion. This removes the unnecessary handling of `KeyboardInterrupt`",
      "created_at" : "2021-03-24T00:05:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21357#issuecomment-805362329",
      "id" : 805362329,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21357",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNTM2MjMyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-24T00:05:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/805362329",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23396902?v=4",
         "events_url" : "https://api.github.com/users/jarolrod/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jarolrod/followers",
         "following_url" : "https://api.github.com/users/jarolrod/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jarolrod/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jarolrod",
         "id" : 23396902,
         "login" : "jarolrod",
         "node_id" : "MDQ6VXNlcjIzMzk2OTAy",
         "organizations_url" : "https://api.github.com/users/jarolrod/orgs",
         "received_events_url" : "https://api.github.com/users/jarolrod/received_events",
         "repos_url" : "https://api.github.com/users/jarolrod/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jarolrod/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jarolrod/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jarolrod"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 39a9ec579f023ab262a1abd1f0c869be5b1f3f4d",
      "created_at" : "2021-03-24T13:00:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21357#issuecomment-805799828",
      "id" : 805799828,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21357",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwNTc5OTgyOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-24T13:00:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/805799828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r600727982"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600727982"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The goal of the test framework is not to match behavior in bitcoind (we don't want to re-implement bitcoind in python), but to properly deserialize messages that have been serialized by bitcoind.\r\n\r\nThus, the try-catch can be removed completely.",
      "commit_id" : "39a9ec579f023ab262a1abd1f0c869be5b1f3f4d",
      "created_at" : "2021-03-24T17:56:48Z",
      "diff_hunk" : "@@ -1045,13 +1045,11 @@ def deserialize(self, f):\n \n         self.nStartingHeight = struct.unpack(\"<i\", f.read(4))[0]\n \n-        if self.nVersion >= 70001:\n-            # Relay field is optional for version 70001 onwards\n-            try:\n-                self.relay = struct.unpack(\"<b\", f.read(1))[0]\n-            except:\n-                self.relay = 0\n-        else:\n+        # Relay field is optional for version 70001 onwards\n+        # But, unconditionally check it to match behaviour in bitcoind\n+        try:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r600727982",
      "id" : 600727982,
      "line" : 1050,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDcyNzk4Mg==",
      "original_commit_id" : "39a9ec579f023ab262a1abd1f0c869be5b1f3f4d",
      "original_line" : 1050,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/messages.py",
      "position" : 13,
      "pull_request_review_id" : 620050232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T17:57:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600727982",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r600737160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600737160"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The deserialization code can be useful in other contexts, eg https://github.com/bitcoin/bitcoin/blob/f67b5dca576669bfed0cf4af9f2cc6273010a0d7/contrib/message-capture/message-capture-parser.py. Besides, there's no disadvantage to making this more robust.",
      "commit_id" : "39a9ec579f023ab262a1abd1f0c869be5b1f3f4d",
      "created_at" : "2021-03-24T18:09:20Z",
      "diff_hunk" : "@@ -1045,13 +1045,11 @@ def deserialize(self, f):\n \n         self.nStartingHeight = struct.unpack(\"<i\", f.read(4))[0]\n \n-        if self.nVersion >= 70001:\n-            # Relay field is optional for version 70001 onwards\n-            try:\n-                self.relay = struct.unpack(\"<b\", f.read(1))[0]\n-            except:\n-                self.relay = 0\n-        else:\n+        # Relay field is optional for version 70001 onwards\n+        # But, unconditionally check it to match behaviour in bitcoind\n+        try:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21357#discussion_r600737160",
      "id" : 600737160,
      "in_reply_to_id" : 600727982,
      "line" : 1050,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDczNzE2MA==",
      "original_commit_id" : "39a9ec579f023ab262a1abd1f0c869be5b1f3f4d",
      "original_line" : 1050,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/messages.py",
      "position" : 13,
      "pull_request_review_id" : 620077184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21357",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-24T18:09:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600737160",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
