[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #14111 (index: Create IndexRunner class for activing indexes. by jimpo)\n* #14053 (Add address-based index (attempt 4?) by marcinja)\n* #14035 (Utxoscriptindex by mgrychow)\n* #14032 (Add p2p layer encryption with ECDH/ChaCha20Poly1305 by jonasschnelli)\n* #13949 (Introduce MempoolObserver interface to break \"policy/fees -> txmempool -> policy/fees\" circular dependency by Empact)\n* #13937 (Track best-possible-headers (TheBlueMatt) by Sjors)\n* #13864 (validation: Document where we are intentionally ignoring bool return values from validation related functions by practicalswift)\n* #13815 (util: Add [[nodiscard]] to all {Decode,Parse}[...](...) functions returning bool by practicalswift)\n* #13686 (ZMQ: Small cleanups in the ZMQ code by domob1812)\n* #13258 (uint256: Remove unnecessary crypto/common.h dependency by kallewoof)\n* #11652 (Add missing locks: validation.cpp + related by practicalswift)\n* #11599 (scripted-diff: Small locking rename by ryanofsky)\n* #10823 (Allow all mempool txs to be replaced after a configurable timeout (default 6h) by greenaddress)\n* #10443 (Add fee_est tool for debugging fee estimation code by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-08-11T05:53:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-412253644",
      "id" : 412253644,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMjI1MzY0NA==",
      "updated_at" : "2018-08-31T14:01:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/412253644",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "How about splitting the content further to fit more functional areas? E.g. there's a pretty clear division between disk-oriented functions and block-index-oriented functions, seems they are independent of the other globals.",
      "created_at" : "2018-08-11T06:52:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-412256053",
      "id" : 412256053,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMjI1NjA1Mw==",
      "updated_at" : "2018-08-11T06:52:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/412256053",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "You'll want to squash 86e36e0",
      "created_at" : "2018-08-11T17:05:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-412288479",
      "id" : 412288479,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMjI4ODQ3OQ==",
      "updated_at" : "2018-08-11T17:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/412288479",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In each file, you'll want to be sure each of the definitions used are included in the file directly or in the .h for that file if used there, or forward-declared. E.g. `#include <uint256.h>` in `validation_block_utils.h`\r\n> Every .cpp and .h file should #include every header file it directly uses classes, functions or other definitions from, even if those headers are already included indirectly through other headers.`\r\nhttps://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md\r\n\r\nI'm concerned about the fact that the globals are still set in `validation.cpp`. Seems moving those to `validation_globals.cpp` would be more consistent with that file's purpose of containing and presenting the globals. One idea is to rename `validation_block_utils.h` to `chainstate.h` and move `g_chainstate`, `mapBlockIndex` and `chainActive` out to it.",
      "created_at" : "2018-08-12T19:12:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-412365076",
      "id" : 412365076,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMjM2NTA3Ng==",
      "updated_at" : "2018-08-12T19:12:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/412365076",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Rebased, conflict solved, 86e36e064b18067f8c09f0a4f4bee55c76cbacf0 squashed.\r\n\r\n@Empact : Globals from `validation_globals.h` set in `validation` were moved to `validation_globals.cpp` where possible, but please note that there are still `txmempool->validation->txmempool` and `policy/fees->policy/policy->validation->policy/fees` circular dependencies that prevent moving `mapBlockIndex`, `feeEstimator` and `mempool` as it would create another CD. Similarly, `g_chainstate` cannot yet be moved to file included by `validation`, because `CChainState` uses `ConnectTrace` that uses `MemPoolRemovalReason` from `txmempool`, which includes `validation` (circular dep again). As fixing those other CDs is beyond this pull request scope, I suggest to do it in another PR after those other lint issues are fixed.\r\n\r\nDirect includes were added for both symbols used in `validation_...` files and symbols that are defined in `validation_...`. Where it was possible redundant includes for `validation` were removed, leading to removal of another circular dep: `checkpoints->validation->checkpoints` (!)",
      "created_at" : "2018-08-20T13:59:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-414325846",
      "id" : 414325846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNDMyNTg0Ng==",
      "updated_at" : "2018-08-24T15:47:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/414325846",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/42271287?v=4",
         "events_url" : "https://api.github.com/users/mgrychow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mgrychow/followers",
         "following_url" : "https://api.github.com/users/mgrychow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mgrychow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mgrychow",
         "id" : 42271287,
         "login" : "mgrychow",
         "node_id" : "MDQ6VXNlcjQyMjcxMjg3",
         "organizations_url" : "https://api.github.com/users/mgrychow/orgs",
         "received_events_url" : "https://api.github.com/users/mgrychow/received_events",
         "repos_url" : "https://api.github.com/users/mgrychow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mgrychow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mgrychow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mgrychow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The refactor in #13144 also breaks the cyclic dependency cited as the motivation for this PR.\r\n\r\nThat said, I still like the idea of breaking validation into multiple files. Though I prefer grouping them in a `src/validation/` directory rather than just by the `validation_` file prefix.",
      "created_at" : "2018-08-30T18:25:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-417420371",
      "id" : 417420371,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNzQyMDM3MQ==",
      "updated_at" : "2018-08-30T18:27:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/417420371",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "node_id" : "MDQ6VXNlcjg4MTI1Mw==",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2018-08-31T15:56:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-417709038",
      "id" : 417709038,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNzcwOTAzOA==",
      "updated_at" : "2018-08-31T15:56:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/417709038",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@jimpo Thanks for pointing it out. I'll close it after #13144 being merged and continue to work on splitting `validation` in next PR. Still, there is a circular dependency in #14035 but I guess it may be solved within scope of that PR (interface between index and validation or something, but after #13144 merge). No rebase for now unless explicitly requested.\r\n\r\nedit: Please note that also `checkpoints -> validation -> checkpoints` dependency was removed here due to `validation` split",
      "created_at" : "2018-09-03T18:25:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-418173532",
      "id" : 418173532,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxODE3MzUzMg==",
      "updated_at" : "2018-09-04T10:29:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/418173532",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/42271287?v=4",
         "events_url" : "https://api.github.com/users/mgrychow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mgrychow/followers",
         "following_url" : "https://api.github.com/users/mgrychow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mgrychow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mgrychow",
         "id" : 42271287,
         "login" : "mgrychow",
         "node_id" : "MDQ6VXNlcjQyMjcxMjg3",
         "organizations_url" : "https://api.github.com/users/mgrychow/orgs",
         "received_events_url" : "https://api.github.com/users/mgrychow/received_events",
         "repos_url" : "https://api.github.com/users/mgrychow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mgrychow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mgrychow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mgrychow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Still needs rebase, so closing for now. Let me know when you want to work on this again, so I can reopen.",
      "created_at" : "2018-09-20T20:15:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13942#issuecomment-423318058",
      "id" : 423318058,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13942",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyMzMxODA1OA==",
      "updated_at" : "2018-09-20T20:15:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423318058",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
