[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r510322471"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510322471"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This action is performed in `SetFeeEstimateMode()` and calling it in bumpfee beforehand causes an error when explicit feerates are used (issue #20219).",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-22T17:06:14Z",
      "diff_hunk" : "@@ -3461,7 +3461,6 @@ static RPCHelpMan bumpfee_helper(std::string method_name)\n             if (options.exists(\"fee_rate\")) {\n                 throw JSONRPCError(RPC_INVALID_PARAMETER, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\");\n             }\n-            coin_control.m_confirm_target = ParseConfirmTarget(conf_target, pwallet->chain().estimateMaxBlocks());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r510322471",
      "id" : 510322471,
      "line" : 3464,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMyMjQ3MQ==",
      "original_commit_id" : "59222c6e22349b26baebd707a7174848130c653f",
      "original_line" : 3464,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 79,
      "pull_request_review_id" : 514943224,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510322471",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r510364623"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510364623"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixup requested in https://github.com/bitcoin/bitcoin/pull/19200#discussion_r438781980.",
      "commit_id" : "b04e7bb270db73c8398067a1fc64bf667560b67e",
      "created_at" : "2020-10-22T18:16:32Z",
      "diff_hunk" : "@@ -3785,8 +3788,9 @@ RPCHelpMan getaddressinfo()\n                         {RPCResult::Type::STR_HEX, \"pubkey\", /* optional */ true, \"The hex value of the raw public key for single-key addresses (possibly embedded in P2SH or P2WSH).\"},\n                         {RPCResult::Type::OBJ, \"embedded\", /* optional */ true, \"Information about the address embedded in P2SH or P2WSH, if relevant and known.\",\n                         {\n-                            {RPCResult::Type::ELISION, \"\", \"Includes all getaddressinfo output fields for the embedded address, excluding metadata (timestamp, hdkeypath, hdseedid)\\n\"\n-                            \"and relation to the wallet (ismine, iswatchonly).\"},\n+                            {RPCResult::Type::ELISION, \"\",\n+                                    \"Includes all getaddressinfo output fields for the embedded address, excluding metadata (timestamp,\\n\"\n+                                    \"hdkeypath, hdseedid) and relation to the wallet (ismine, iswatchonly).\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r510364623",
      "id" : 510364623,
      "line" : 3793,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM2NDYyMw==",
      "original_commit_id" : "b04e7bb270db73c8398067a1fc64bf667560b67e",
      "original_line" : 3793,
      "original_position" : 79,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 79,
      "pull_request_review_id" : 514998455,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-22T18:16:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510364623",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Pushed a few improvements. Should be ready for review.",
      "created_at" : "2020-10-23T10:57:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-715268966",
      "id" : 715268966,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNTI2ODk2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-23T10:57:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/715268966",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511134364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511134364"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Isn't the `BTC_MODE then essentially a duplicate of the `{\"fee_rate\": â¦}` option?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:13:59Z",
      "diff_hunk" : "@@ -132,6 +134,13 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n     if mode == \"fee_rate\":\n         bumped_psbt = rbf_node.psbtbumpfee(rbfid, {\"fee_rate\": NORMAL})\n         bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": NORMAL})\n+    elif mode == BTC_MODE:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511134364",
      "id" : 511134364,
      "line" : 164,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTEzNDM2NA==",
      "original_commit_id" : "995dd4a6e7c21665472e71d7aac0251f379e3420",
      "original_line" : 164,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 115,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511134364",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511135422"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511135422"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't understand this change. Is this not referring to the \"fee_rate\" argument below?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:16:29Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511135422",
      "id" : 511135422,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTEzNTQyMg==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 171,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511135422",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511136927"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511136927"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "So much clearer! :+1: ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:20:13Z",
      "diff_hunk" : "@@ -3459,7 +3459,7 @@ static RPCHelpMan bumpfee_helper(std::string method_name)\n \n         if (!conf_target.isNull()) {\n             if (options.exists(\"fee_rate\")) {\n-                throw JSONRPCError(RPC_INVALID_PARAMETER, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\");\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511136927",
      "id" : 511136927,
      "line" : 3466,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTEzNjkyNw==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 3466,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 77,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511136927",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511139081"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511139081"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Style nit: line 183 uses \"feerate\", 184 uses \"fee rate\". I'd prefer \"feerate\" per Optech style guide, but if the error message currently is \"fee rate\", it might be nicer to keep it homogeneous.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:25:22Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511139081",
      "id" : 511139081,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTEzOTA4MQ==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 184,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511139081",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511142032"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511142032"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "That's an odd name clash, that the error complains about the missing \"fee rate\", but it's actually `conf_target` that's missing. I assume that was part of the items that #19543 was meant to address?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:32:37Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511142032",
      "id" : 511142032,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE0MjAzMg==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 185,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511142032",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511143512"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511143512"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay, I guess this is a prime example of what is meant to get addressed in #19543. `conf_target` actually being a feerate is fairly icky.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:36:15Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})\n+\n+    self.log.info(\"Test explicit feerate raises RPC error if both fee_rate and conf_target are passed\")\n+    msg = \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation \" \\\n+          \"target in blocks for automatic fee estimation, or an explicit fee rate.\"\n+    assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {\"conf_target\": NORMAL, \"fee_rate\": NORMAL})",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511143512",
      "id" : 511143512,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE0MzUxMg==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 190,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511143512",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511145359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511145359"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: `msg` is a bit unspecific. Could be for example `msg_both` or `error_both`",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:40:58Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})\n+\n+    self.log.info(\"Test explicit feerate raises RPC error if both fee_rate and conf_target are passed\")\n+    msg = \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation \" \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511145359",
      "id" : 511145359,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE0NTM1OQ==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 188,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511145359",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511146854"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511146854"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Potential missing test case: what would happen if we specified something lower than `minRelayTxFeerate` here?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:44:29Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})\n+\n+    self.log.info(\"Test explicit feerate raises RPC error if both fee_rate and conf_target are passed\")\n+    msg = \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation \" \\\n+          \"target in blocks for automatic fee estimation, or an explicit fee rate.\"\n+    assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {\"conf_target\": NORMAL, \"fee_rate\": NORMAL})\n+\n+    self.log.info(\"Test invalid conf_target settings\")\n+    for field in [\"confTarget\", \"conf_target\"]:\n+        assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {field: 1, \"fee_rate\": NORMAL})\n+    too_high = \"is too high (cannot be higher than -maxtxfee\"\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": BTC_MODE, \"conf_target\": 2009}))\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": SAT_MODE, \"conf_target\": 2009 * 10000}))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511146854",
      "id" : 511146854,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE0Njg1NA==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 197,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511146854",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511148504"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511148504"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "TIL how to iterate through a dictionary in python. :)",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T20:48:31Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})\n+\n+    self.log.info(\"Test explicit feerate raises RPC error if both fee_rate and conf_target are passed\")\n+    msg = \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation \" \\\n+          \"target in blocks for automatic fee estimation, or an explicit fee rate.\"\n+    assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {\"conf_target\": NORMAL, \"fee_rate\": NORMAL})\n+\n+    self.log.info(\"Test invalid conf_target settings\")\n+    for field in [\"confTarget\", \"conf_target\"]:\n+        assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {field: 1, \"fee_rate\": NORMAL})\n+    too_high = \"is too high (cannot be higher than -maxtxfee\"\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": BTC_MODE, \"conf_target\": 2009}))\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": SAT_MODE, \"conf_target\": 2009 * 10000}))\n+\n+    self.log.info(\"Test invalid estimate_mode settings\")\n+    for k, v in {\"number\": 42, \"object\": {\"foo\": \"bar\"}}.items():",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511148504",
      "id" : 511148504,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE0ODUwNA==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 200,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511148504",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511153062"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511153062"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is a bit hard to review. My approach would currently be to check line by line whether all test cases are accounted for but that would probably be easier if the reordering of code and the refactoring to traverse the test cases had been separated into two commits. What would a reviewer usually be expected to do here?\r\n\r\nAlternatively, I suspect that there might be better diff tools that can follow a change like this. :thinking: ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:00:05Z",
      "diff_hunk" : "@@ -100,28 +99,55 @@ def run_test(self):\n         test_small_output_with_feerate_succeeds(self, rbf_node, dest_address)\n         test_no_more_inputs_fails(self, rbf_node, dest_address)\n \n-    def test_invalid_parameters(self, node, dest_address):\n-        txid = spend_one_input(node, dest_address)\n-        # invalid estimate mode\n-        assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", node.bumpfee, txid, {\n-            \"estimate_mode\": \"moo\",\n-        })\n-        assert_raises_rpc_error(-3, \"Expected type string\", node.bumpfee, txid, {\n-            \"estimate_mode\": 38,\n-        })\n-        assert_raises_rpc_error(-3, \"Expected type string\", node.bumpfee, txid, {\n-            \"estimate_mode\": {\n-                \"foo\": \"bar\",\n-            },\n-        })\n-        assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", node.bumpfee, txid, {\n-            \"estimate_mode\": Decimal(\"3.141592\"),\n-        })\n-        # confTarget and conf_target\n-        assert_raises_rpc_error(-8, \"confTarget and conf_target options should not both be set\", node.bumpfee, txid, {\n-            \"confTarget\": 123,\n-            \"conf_target\": 456,\n-        })\n+    def test_invalid_parameters(self, rbf_node, peer_node, dest_address):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511153062",
      "id" : 511153062,
      "line" : 102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MzA2Mg==",
      "original_commit_id" : "9ea6d390c26975c98a9cf28cf816bcbded9aa3d1",
      "original_line" : 102,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 58,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511153062",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511153839"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511153839"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What is the advantage of this construction over the previous line?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:02:04Z",
      "diff_hunk" : "@@ -272,11 +272,12 @@ UniValue DescribeAddress(const CTxDestination& dest)\n \n unsigned int ParseConfirmTarget(const UniValue& value, unsigned int max_target)\n {\n-    int target = value.get_int();\n-    if (target < 1 || (unsigned int)target > max_target) {\n-        throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Invalid conf_target, must be between %u - %u\", 1, max_target));\n+    const int target{value.get_int()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511153839",
      "id" : 511153839,
      "line" : 275,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MzgzOQ==",
      "original_commit_id" : "84fc42f32c8f649918e3db55d1dcc62d9f402224",
      "original_line" : 275,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/util.cpp",
      "position" : 7,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511153839",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511156476"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511156476"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Would this not fail if the value of the input was between `MAX_INT` if `max_target` were between `MAX_INT` and `MAX_UNSIGNED_INT`?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:09:21Z",
      "diff_hunk" : "@@ -272,11 +272,12 @@ UniValue DescribeAddress(const CTxDestination& dest)\n \n unsigned int ParseConfirmTarget(const UniValue& value, unsigned int max_target)\n {\n-    int target = value.get_int();\n-    if (target < 1 || (unsigned int)target > max_target) {\n-        throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Invalid conf_target, must be between %u - %u\", 1, max_target));\n+    const int target{value.get_int()};\n+    const unsigned int unsigned_target{static_cast<unsigned int>(target)};\n+    if (target < 1 || unsigned_target > max_target) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511156476",
      "id" : 511156476,
      "line" : 277,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1NjQ3Ng==",
      "original_commit_id" : "84fc42f32c8f649918e3db55d1dcc62d9f402224",
      "original_line" : 277,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/rpc/util.cpp",
      "position" : 9,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511156476",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511157014"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511157014"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I assume this is safe, because `max_target` is 1000 blocks, but I did spend a few minutes staring at this.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:10:47Z",
      "diff_hunk" : "@@ -272,11 +272,12 @@ UniValue DescribeAddress(const CTxDestination& dest)\n \n unsigned int ParseConfirmTarget(const UniValue& value, unsigned int max_target)\n {\n-    int target = value.get_int();\n-    if (target < 1 || (unsigned int)target > max_target) {\n-        throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Invalid conf_target, must be between %u - %u\", 1, max_target));\n+    const int target{value.get_int()};\n+    const unsigned int unsigned_target{static_cast<unsigned int>(target)};\n+    if (target < 1 || unsigned_target > max_target) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511157014",
      "id" : 511157014,
      "in_reply_to_id" : 511156476,
      "line" : 277,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1NzAxNA==",
      "original_commit_id" : "84fc42f32c8f649918e3db55d1dcc62d9f402224",
      "original_line" : 277,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/rpc/util.cpp",
      "position" : 9,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511157014",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511158281"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511158281"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "So now we have `fee rate`, `feeRate` and `fee_rate` in one PR. The horrors. :sweat_smile: ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:14:19Z",
      "diff_hunk" : "@@ -672,6 +674,53 @@ def test_option_feerate(self):\n         assert_fee_amount(result2['fee'], count_bytes(result2['hex']), 2 * result_fee_rate)\n         assert_fee_amount(result3['fee'], count_bytes(result3['hex']), 10 * result_fee_rate)\n \n+    def test_feerate_with_conf_target_and_estimate_mode(self):\n+        self.log.info(\"Test fundrawtxn passing an explicit feerate using conf_target and estimate_mode\")\n+        node = self.nodes[3]\n+        # Make sure there is exactly one input so coin selection can't skew the result.\n+        assert_equal(len(node.listunspent(1)), 1)\n+        inputs = []\n+        outputs = {node.getnewaddress() : 1}\n+        rawtx = node.createrawtransaction(inputs, outputs)\n+\n+        for unit, feerate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():\n+            self.log.info(\"Test fundrawtxn with conf_target {} estimate_mode {} produces expected fee\".format(feerate, unit))\n+            # With no arguments passed, expect fee of 141 sats/b.\n+            assert_approx(node.fundrawtransaction(rawtx)[\"fee\"], vexp=0.00000141, vspan=0.00000001)\n+            # Expect fee to be 10,000x higher when explicit fee 10,000x greater is specified.\n+            result = node.fundrawtransaction(rawtx, {\"conf_target\": feerate, \"estimate_mode\": unit})\n+            assert_approx(result[\"fee\"], vexp=0.0141, vspan=0.0001)\n+\n+        for field, feerate in {\"conf_target\": 0.1, \"estimate_mode\": \"sat/b\"}.items():\n+            self.log.info(\"Test fundrawtxn raises RPC error if both feeRate and {} are passed\".format(field))\n+            assert_raises_rpc_error(\n+                -8, \"Cannot specify both {} and feeRate\".format(field),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511158281",
      "id" : 511158281,
      "line" : 697,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1ODI4MQ==",
      "original_commit_id" : "84fc42f32c8f649918e3db55d1dcc62d9f402224",
      "original_line" : 697,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 40,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511158281",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511159365"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511159365"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: since this is an address and amount, how about \"receiver_output\"?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:17:12Z",
      "diff_hunk" : "@@ -174,8 +174,11 @@ def run_test(self):\n             elif out['scriptPubKey']['addresses'][0] == p2pkh:\n                 p2pkh_pos = out['n']\n \n+        inputs = [{\"txid\": txid, \"vout\": p2wpkh_pos}, {\"txid\": txid, \"vout\": p2sh_p2wpkh_pos}, {\"txid\": txid, \"vout\": p2pkh_pos}]\n+        addr = {self.nodes[1].getnewaddress(): 29.99}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511159365",
      "id" : 511159365,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1OTM2NQ==",
      "original_commit_id" : "1b498b9b6aa4d2d7c1d316f9ab4bc4c96728cd6a",
      "original_line" : 178,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511159365",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511160072"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511160072"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: \"K\" is the symbol for Kelvin, it's \"kB\", also remove spacing like below for consistency. :nerd_face: ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:19:17Z",
      "diff_hunk" : "@@ -186,14 +189,15 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        # feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000):\n-        res = self.nodes[1].walletcreatefundedpsbt([{\"txid\":txid,\"vout\":p2wpkh_pos},{\"txid\":txid,\"vout\":p2sh_p2wpkh_pos},{\"txid\":txid,\"vout\":p2pkh_pos}], {self.nodes[1].getnewaddress():29.99}, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n+        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000)\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511160072",
      "id" : 511160072,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE2MDA3Mg==",
      "original_commit_id" : "1b498b9b6aa4d2d7c1d316f9ab4bc4c96728cd6a",
      "original_line" : 192,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511160072",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511161360"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511161360"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Still getting used to this, but totally see what you're doing now. :)",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:22:52Z",
      "diff_hunk" : "@@ -186,14 +189,15 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        # feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000):\n-        res = self.nodes[1].walletcreatefundedpsbt([{\"txid\":txid,\"vout\":p2wpkh_pos},{\"txid\":txid,\"vout\":p2sh_p2wpkh_pos},{\"txid\":txid,\"vout\":p2pkh_pos}], {self.nodes[1].getnewaddress():29.99}, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n+        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000)\")\n+        res = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n         assert_approx(res[\"fee\"], 0.055, 0.005)\n \n-        # feeRate of 10 BTC / KB produces a total fee well above -maxtxfee\n+        self.log.info(\"Test feeRate of 10 BTC/KB produces total fee well above -maxtxfee and raises RPC error\")\n         # previously this was silently capped at -maxtxfee\n-        assert_raises_rpc_error(-4, \"Fee exceeds maximum configured by user (e.g. -maxtxfee, maxfeerate)\", self.nodes[1].walletcreatefundedpsbt, [{\"txid\":txid,\"vout\":p2wpkh_pos},{\"txid\":txid,\"vout\":p2sh_p2wpkh_pos},{\"txid\":txid,\"vout\":p2pkh_pos}], {self.nodes[1].getnewaddress():29.99}, 0, {\"feeRate\": 10, \"add_inputs\": True})\n-        assert_raises_rpc_error(-4, \"Fee exceeds maximum configured by user (e.g. -maxtxfee, maxfeerate)\", self.nodes[1].walletcreatefundedpsbt, [{\"txid\":txid,\"vout\":p2wpkh_pos},{\"txid\":txid,\"vout\":p2sh_p2wpkh_pos},{\"txid\":txid,\"vout\":p2pkh_pos}], {self.nodes[1].getnewaddress():1}, 0, {\"feeRate\": 10, \"add_inputs\": False})\n+        for bool_add, addr in {True: addr, False: {self.nodes[1].getnewaddress(): 1}}.items():",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511161360",
      "id" : 511161360,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE2MTM2MA==",
      "original_commit_id" : "1b498b9b6aa4d2d7c1d316f9ab4bc4c96728cd6a",
      "original_line" : 198,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511161360",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511163315"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511163315"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Probably not the right place to bring this up, but the explicit specifying of the unit does seem really error prone as mentioned in the comments of #19543 before. ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:28:43Z",
      "diff_hunk" : "@@ -189,10 +189,46 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000)\")\n+        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee at or slightly below -maxtxfee (~0.05290000)\")\n         res = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n         assert_approx(res[\"fee\"], 0.055, 0.005)\n \n+        self.log.info(\"Test passing walletcreatefundedpsbt explicit feerate with conf_target and estimate_mode\")\n+        for unit, feerate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511163315",
      "id" : 511163315,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE2MzMxNQ==",
      "original_commit_id" : "6ad143c294858af93d22012c2d52997b05db0028",
      "original_line" : 197,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511163315",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511165359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511165359"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Zero often being some sort of special case, what happens with values between 0 and 0.00001000? Maybe we should also test `0.00000999`.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:34:44Z",
      "diff_hunk" : "@@ -189,10 +189,46 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000)\")\n+        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee at or slightly below -maxtxfee (~0.05290000)\")\n         res = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n         assert_approx(res[\"fee\"], 0.055, 0.005)\n \n+        self.log.info(\"Test passing walletcreatefundedpsbt explicit feerate with conf_target and estimate_mode\")\n+        for unit, feerate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():\n+            fee = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"conf_target\": feerate, \"estimate_mode\": unit, \"add_inputs\": True})[\"fee\"]\n+            self.log.info(\"- conf_target {}, estimate_mode {} produces fee {} at or slightly below -maxtxfee (~0.05290000)\".format(feerate, unit, fee))\n+            assert_approx(fee, vexp=0.055, vspan=0.005)\n+\n+        for field, feerate in {\"conf_target\": 0.1, \"estimate_mode\": \"sat/b\"}.items():\n+            self.log.info(\"Test walletcreatefundedpsbt raises RPC error if both feeRate and {} are passed\".format(field))\n+            assert_raises_rpc_error(\n+                -8, \"Cannot specify both {} and feeRate\".format(field),\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, field: feerate, \"add_inputs\": True}))\n+\n+        self.log.info(\"Test walletcreatefundedpsbt with invalid estimate_mode settings\")\n+        for k, v in {\"number\": 42, \"object\": {\"foo\": \"bar\"}}.items():\n+            assert_raises_rpc_error(-3, \"Expected type string for estimate_mode, got {}\".format(k),\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": v, \"conf_target\": 0.1, \"add_inputs\": True}))\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\",\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": 0.1, \"add_inputs\": True}))\n+\n+        self.log.info(\"Test walletcreatefundedpsbt with invalid conf_target settings\")\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.log.debug(\"{}\".format(mode))\n+            for k, v in {\"string\": \"\", \"object\": {\"foo\": \"bar\"}}.items():\n+                assert_raises_rpc_error(-3, \"Expected type number for conf_target, got {}\".format(k),\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": v, \"add_inputs\": True}))\n+            if mode in [\"btc/kb\", \"sat/b\"]:\n+                assert_raises_rpc_error(-3, \"Amount out of range\",\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": -1, \"add_inputs\": True}))\n+                assert_raises_rpc_error(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": 0, \"add_inputs\": True}))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511165359",
      "id" : 511165359,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE2NTM1OQ==",
      "original_commit_id" : "6ad143c294858af93d22012c2d52997b05db0028",
      "original_line" : 226,
      "original_position" : 39,
      "original_start_line" : 222,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511165359",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511165699"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511165699"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh my, great improvement!",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:35:37Z",
      "diff_hunk" : "@@ -4034,7 +4034,7 @@ static RPCHelpMan send()\n                     {\"locktime\", RPCArg::Type::NUM, /* default */ \"0\", \"Raw locktime. Non-0 value also locktime-activates inputs\"},\n                     {\"lock_unspents\", RPCArg::Type::BOOL, /* default */ \"false\", \"Lock selected unspent outputs\"},\n                     {\"psbt\", RPCArg::Type::BOOL,  /* default */ \"automatic\", \"Always return a PSBT, implies add_to_wallet=false.\"},\n-                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"A JSON array of integers.\\n\"\n+                    {\"subtract_fee_from_outputs\", RPCArg::Type::ARR, /* default */ \"empty array\", \"Outputs to subtract the fee from, specified as integer indices.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511165699",
      "id" : 511165699,
      "line" : 4043,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE2NTY5OQ==",
      "original_commit_id" : "77a4f98897ab4430311cff3f2226f274fad20d6a",
      "original_line" : 4043,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 108,
      "pull_request_review_id" : 515982840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511165699",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511170366"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511170366"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Little: constness, and while changing the line, updated the style. It's not essential, to be sure. Initially, the function was touched to fix the error message. Then, I saw the function has two C-style type conversions and replaced them with one preferred static cast (per https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#es49-if-you-must-use-a-cast-use-a-named-cast). Then, made the non-mutated variables const.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:49:02Z",
      "diff_hunk" : "@@ -272,11 +272,12 @@ UniValue DescribeAddress(const CTxDestination& dest)\n \n unsigned int ParseConfirmTarget(const UniValue& value, unsigned int max_target)\n {\n-    int target = value.get_int();\n-    if (target < 1 || (unsigned int)target > max_target) {\n-        throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Invalid conf_target, must be between %u - %u\", 1, max_target));\n+    const int target{value.get_int()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511170366",
      "id" : 511170366,
      "in_reply_to_id" : 511153839,
      "line" : 275,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE3MDM2Ng==",
      "original_commit_id" : "84fc42f32c8f649918e3db55d1dcc62d9f402224",
      "original_line" : 275,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/util.cpp",
      "position" : 7,
      "pull_request_review_id" : 516029047,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511170366",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511172152"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511172152"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes. It would be good to replace this with the fixed-unit `feerate_sat_vb` argument before the 0.21 branch-off. Edit: I have a changeset for that but I guess it's too late though.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:54:29Z",
      "diff_hunk" : "@@ -189,10 +189,46 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000)\")\n+        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee at or slightly below -maxtxfee (~0.05290000)\")\n         res = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n         assert_approx(res[\"fee\"], 0.055, 0.005)\n \n+        self.log.info(\"Test passing walletcreatefundedpsbt explicit feerate with conf_target and estimate_mode\")\n+        for unit, feerate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511172152",
      "id" : 511172152,
      "in_reply_to_id" : 511163315,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE3MjE1Mg==",
      "original_commit_id" : "6ad143c294858af93d22012c2d52997b05db0028",
      "original_line" : 197,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 516031240,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-01T22:53:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511172152",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511172884"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511172884"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agreed--started doing just that today for the new arg in [`0f2eb16` (#20231)](https://github.com/bitcoin/bitcoin/pull/20231/commits/0f2eb167ddfa7d2612708d09e05189f969699121#diff-047f185450ff2093df390b522db9b6aa1c87353abf7e7a99c00390db8c707f6eR375), will update here.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-23T21:56:39Z",
      "diff_hunk" : "@@ -189,10 +189,46 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000)\")\n+        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee at or slightly below -maxtxfee (~0.05290000)\")\n         res = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n         assert_approx(res[\"fee\"], 0.055, 0.005)\n \n+        self.log.info(\"Test passing walletcreatefundedpsbt explicit feerate with conf_target and estimate_mode\")\n+        for unit, feerate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():\n+            fee = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"conf_target\": feerate, \"estimate_mode\": unit, \"add_inputs\": True})[\"fee\"]\n+            self.log.info(\"- conf_target {}, estimate_mode {} produces fee {} at or slightly below -maxtxfee (~0.05290000)\".format(feerate, unit, fee))\n+            assert_approx(fee, vexp=0.055, vspan=0.005)\n+\n+        for field, feerate in {\"conf_target\": 0.1, \"estimate_mode\": \"sat/b\"}.items():\n+            self.log.info(\"Test walletcreatefundedpsbt raises RPC error if both feeRate and {} are passed\".format(field))\n+            assert_raises_rpc_error(\n+                -8, \"Cannot specify both {} and feeRate\".format(field),\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, field: feerate, \"add_inputs\": True}))\n+\n+        self.log.info(\"Test walletcreatefundedpsbt with invalid estimate_mode settings\")\n+        for k, v in {\"number\": 42, \"object\": {\"foo\": \"bar\"}}.items():\n+            assert_raises_rpc_error(-3, \"Expected type string for estimate_mode, got {}\".format(k),\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": v, \"conf_target\": 0.1, \"add_inputs\": True}))\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\",\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": 0.1, \"add_inputs\": True}))\n+\n+        self.log.info(\"Test walletcreatefundedpsbt with invalid conf_target settings\")\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.log.debug(\"{}\".format(mode))\n+            for k, v in {\"string\": \"\", \"object\": {\"foo\": \"bar\"}}.items():\n+                assert_raises_rpc_error(-3, \"Expected type number for conf_target, got {}\".format(k),\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": v, \"add_inputs\": True}))\n+            if mode in [\"btc/kb\", \"sat/b\"]:\n+                assert_raises_rpc_error(-3, \"Amount out of range\",\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": -1, \"add_inputs\": True}))\n+                assert_raises_rpc_error(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": 0, \"add_inputs\": True}))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511172884",
      "id" : 511172884,
      "in_reply_to_id" : 511165359,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE3Mjg4NA==",
      "original_commit_id" : "6ad143c294858af93d22012c2d52997b05db0028",
      "original_line" : 226,
      "original_position" : 39,
      "original_start_line" : 222,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 516032102,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511172884",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511469087"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511469087"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I agree, it's a redundant feature here that adds to the confusion...and it also uses a different code path so the test is needed. ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T14:20:03Z",
      "diff_hunk" : "@@ -132,6 +134,13 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n     if mode == \"fee_rate\":\n         bumped_psbt = rbf_node.psbtbumpfee(rbfid, {\"fee_rate\": NORMAL})\n         bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": NORMAL})\n+    elif mode == BTC_MODE:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511469087",
      "id" : 511469087,
      "in_reply_to_id" : 511134364,
      "line" : 164,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ2OTA4Nw==",
      "original_commit_id" : "995dd4a6e7c21665472e71d7aac0251f379e3420",
      "original_line" : 164,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 115,
      "pull_request_review_id" : 516281174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511469087",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511474549"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511474549"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sorry about that. Yes, there are a few options. In this case, a helpful one might be\r\n\r\n`git show 6fa5686 -w --color-moved=dimmed-zebra`\r\n\r\nFor other cases, maybe git show or git diff with `--word-diff`.\r\n\r\nOr to ignore all added lines having a matching identical removed line (empty result proves move-only):\r\n\r\n`git diff 6fa5686f~1..6fa5686f | grep -E '^[+-][^+-]' | cut -b2- | sort | uniq -c | grep -v '^ *2'`\r\n\r\nPeople like practicalswift, promag, MarcoFalke, jnewbery, and harding likely know some more good ones.\r\n",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T14:41:40Z",
      "diff_hunk" : "@@ -100,28 +99,55 @@ def run_test(self):\n         test_small_output_with_feerate_succeeds(self, rbf_node, dest_address)\n         test_no_more_inputs_fails(self, rbf_node, dest_address)\n \n-    def test_invalid_parameters(self, node, dest_address):\n-        txid = spend_one_input(node, dest_address)\n-        # invalid estimate mode\n-        assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", node.bumpfee, txid, {\n-            \"estimate_mode\": \"moo\",\n-        })\n-        assert_raises_rpc_error(-3, \"Expected type string\", node.bumpfee, txid, {\n-            \"estimate_mode\": 38,\n-        })\n-        assert_raises_rpc_error(-3, \"Expected type string\", node.bumpfee, txid, {\n-            \"estimate_mode\": {\n-                \"foo\": \"bar\",\n-            },\n-        })\n-        assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", node.bumpfee, txid, {\n-            \"estimate_mode\": Decimal(\"3.141592\"),\n-        })\n-        # confTarget and conf_target\n-        assert_raises_rpc_error(-8, \"confTarget and conf_target options should not both be set\", node.bumpfee, txid, {\n-            \"confTarget\": 123,\n-            \"conf_target\": 456,\n-        })\n+    def test_invalid_parameters(self, rbf_node, peer_node, dest_address):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511474549",
      "id" : 511474549,
      "in_reply_to_id" : 511153062,
      "line" : 102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ3NDU0OQ==",
      "original_commit_id" : "9ea6d390c26975c98a9cf28cf816bcbded9aa3d1",
      "original_line" : 102,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 58,
      "pull_request_review_id" : 516282625,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511474549",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511476668"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511476668"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good idea. Changed it to an `outputs` array like in the help:\r\n```diff\r\n         inputs = [{\"txid\": txid, \"vout\": p2wpkh_pos}, {\"txid\": txid, \"vout\": p2sh_p2wpkh_pos}, {\"txid\": txid, \"vout\": p2pkh_pos}]\r\n-        addr = {self.nodes[1].getnewaddress(): 29.99}\r\n+        outputs = [{self.nodes[1].getnewaddress(): 29.99}]\r\n```\r\n",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T14:50:29Z",
      "diff_hunk" : "@@ -174,8 +174,11 @@ def run_test(self):\n             elif out['scriptPubKey']['addresses'][0] == p2pkh:\n                 p2pkh_pos = out['n']\n \n+        inputs = [{\"txid\": txid, \"vout\": p2wpkh_pos}, {\"txid\": txid, \"vout\": p2sh_p2wpkh_pos}, {\"txid\": txid, \"vout\": p2pkh_pos}]\n+        addr = {self.nodes[1].getnewaddress(): 29.99}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511476668",
      "id" : 511476668,
      "in_reply_to_id" : 511159365,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ3NjY2OA==",
      "original_commit_id" : "1b498b9b6aa4d2d7c1d316f9ab4bc4c96728cd6a",
      "original_line" : 178,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 516283205,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511476668",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511477245"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511477245"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T14:52:45Z",
      "diff_hunk" : "@@ -186,14 +189,15 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        # feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000):\n-        res = self.nodes[1].walletcreatefundedpsbt([{\"txid\":txid,\"vout\":p2wpkh_pos},{\"txid\":txid,\"vout\":p2sh_p2wpkh_pos},{\"txid\":txid,\"vout\":p2pkh_pos}], {self.nodes[1].getnewaddress():29.99}, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n+        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000)\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511477245",
      "id" : 511477245,
      "in_reply_to_id" : 511160072,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ3NzI0NQ==",
      "original_commit_id" : "1b498b9b6aa4d2d7c1d316f9ab4bc4c96728cd6a",
      "original_line" : 192,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 516283363,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511477245",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511477688"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511477688"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Reverted. This line goes away in the following commit.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T14:54:24Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511477688",
      "id" : 511477688,
      "in_reply_to_id" : 511135422,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ3NzY4OA==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 171,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 516283470,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511477688",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511478300"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511478300"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done, changed to `error_both`.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T14:58:34Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})\n+\n+    self.log.info(\"Test explicit feerate raises RPC error if both fee_rate and conf_target are passed\")\n+    msg = \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation \" \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511478300",
      "id" : 511478300,
      "in_reply_to_id" : 511145359,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ3ODMwMA==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 188,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 516283716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511478300",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511479304"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511479304"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added\r\n```python\r\nfor unit, feerate in {\"SAT/B\": 0.99999999, \"BTC/KB\": 0.00000999}.items():\r\n    self.log.info(\"- raises RPC error 'fee rate too low' if conf_target {} and estimate_mode {} are passed\".format(feerate, unit))\r\n    assert_raises_rpc_error(-4, \"Fee rate (0.00000999 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\r\n        lambda: self.nodes[1].walletcreatefundedpsbt(inputs, outputs, 0, {\"estimate_mode\": unit, \"conf_target\": feerate, \"add_inputs\": True}))\r\n```\r\n",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T15:01:55Z",
      "diff_hunk" : "@@ -189,10 +189,46 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000)\")\n+        self.log.info(\"Test feeRate of 0.1 BTC / KB produces a total fee at or slightly below -maxtxfee (~0.05290000)\")\n         res = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n         assert_approx(res[\"fee\"], 0.055, 0.005)\n \n+        self.log.info(\"Test passing walletcreatefundedpsbt explicit feerate with conf_target and estimate_mode\")\n+        for unit, feerate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():\n+            fee = self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"conf_target\": feerate, \"estimate_mode\": unit, \"add_inputs\": True})[\"fee\"]\n+            self.log.info(\"- conf_target {}, estimate_mode {} produces fee {} at or slightly below -maxtxfee (~0.05290000)\".format(feerate, unit, fee))\n+            assert_approx(fee, vexp=0.055, vspan=0.005)\n+\n+        for field, feerate in {\"conf_target\": 0.1, \"estimate_mode\": \"sat/b\"}.items():\n+            self.log.info(\"Test walletcreatefundedpsbt raises RPC error if both feeRate and {} are passed\".format(field))\n+            assert_raises_rpc_error(\n+                -8, \"Cannot specify both {} and feeRate\".format(field),\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"feeRate\": 0.1, field: feerate, \"add_inputs\": True}))\n+\n+        self.log.info(\"Test walletcreatefundedpsbt with invalid estimate_mode settings\")\n+        for k, v in {\"number\": 42, \"object\": {\"foo\": \"bar\"}}.items():\n+            assert_raises_rpc_error(-3, \"Expected type string for estimate_mode, got {}\".format(k),\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": v, \"conf_target\": 0.1, \"add_inputs\": True}))\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\",\n+                lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": 0.1, \"add_inputs\": True}))\n+\n+        self.log.info(\"Test walletcreatefundedpsbt with invalid conf_target settings\")\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.log.debug(\"{}\".format(mode))\n+            for k, v in {\"string\": \"\", \"object\": {\"foo\": \"bar\"}}.items():\n+                assert_raises_rpc_error(-3, \"Expected type number for conf_target, got {}\".format(k),\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": v, \"add_inputs\": True}))\n+            if mode in [\"btc/kb\", \"sat/b\"]:\n+                assert_raises_rpc_error(-3, \"Amount out of range\",\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": -1, \"add_inputs\": True}))\n+                assert_raises_rpc_error(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\n+                    lambda: self.nodes[1].walletcreatefundedpsbt(inputs, addr, 0, {\"estimate_mode\": mode, \"conf_target\": 0, \"add_inputs\": True}))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511479304",
      "id" : 511479304,
      "in_reply_to_id" : 511165359,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ3OTMwNA==",
      "original_commit_id" : "6ad143c294858af93d22012c2d52997b05db0028",
      "original_line" : 226,
      "original_position" : 39,
      "original_start_line" : 222,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 516283957,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511479304",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511482368"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511482368"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nice find! added:\r\n```diff\r\n-        assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\r\n+        for options in [{\"fee_rate\": INSUFFICIENT}, {\"conf_target\": INSUFFICIENT, \"estimate_mode\": BTC_MODE}, {\"conf_target\": 1, \"estimate_mode\": SAT_MODE}]:\r\n+            assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, options)\r\n```",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T15:14:46Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})\n+\n+    self.log.info(\"Test explicit feerate raises RPC error if both fee_rate and conf_target are passed\")\n+    msg = \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation \" \\\n+          \"target in blocks for automatic fee estimation, or an explicit fee rate.\"\n+    assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {\"conf_target\": NORMAL, \"fee_rate\": NORMAL})\n+\n+    self.log.info(\"Test invalid conf_target settings\")\n+    for field in [\"confTarget\", \"conf_target\"]:\n+        assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {field: 1, \"fee_rate\": NORMAL})\n+    too_high = \"is too high (cannot be higher than -maxtxfee\"\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": BTC_MODE, \"conf_target\": 2009}))\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": SAT_MODE, \"conf_target\": 2009 * 10000}))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511482368",
      "id" : 511482368,
      "in_reply_to_id" : 511146854,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ4MjM2OA==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 197,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 516284821,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511482368",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511486145"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511486145"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good find. Fixed the error message to now print `Selected estimate_mode <MODE> requires a fee rate to be specified in conf_target` and updated the tests.\r\n```diff\r\n+++ b/src/wallet/rpcwallet.cpp\r\n@@ -214,7 +214,7 @@ static void SetFeeEstimateMode(const CWallet* pwallet, CCoinControl& cc, const U\r\n \r\n     if (cc.m_fee_mode == FeeEstimateMode::BTC_KB || cc.m_fee_mode == FeeEstimateMode::SAT_B) {\r\n         if (estimate_param.isNull()) {\r\n-            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Selected estimate_mode requires a fee rate\");\r\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Selected estimate_mode %s requires a fee rate to be specified in conf_target\", estimate_mode.get_str()));\r\n         }\r\n```\r\n```diff\r\n+++ b/test/functional/wallet_bumpfee.py\r\n-        assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": HIGH, \"estimate_mode\": BTC_MODE})\r\n-        assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 1000, \"estimate_mode\": SAT_MODE})\r\n+        for unit, fee_rate in {\"SAT/B\": 100, \"BTC/KB\": NORMAL}.items():\r\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode {} requires a fee rate to be specified in conf_target\".format(unit),\r\n+                                    rbf_node.bumpfee, rbfid, {\"fee_rate\": fee_rate, \"estimate_mode\": unit})\r\n```",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T15:52:46Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511486145",
      "id" : 511486145,
      "in_reply_to_id" : 511142032,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ4NjE0NQ==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 185,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 516287338,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511486145",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511493888"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511493888"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Updated the log message to \"fee rate\".",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-24T17:16:50Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r511493888",
      "id" : 511493888,
      "in_reply_to_id" : 511139081,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTQ5Mzg4OA==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 184,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 516292935,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511493888",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Xekyo thanks for the excellent feedback--I have been building on it, writing more tests, finding a few more things, will push an update tomorrow.",
      "created_at" : "2020-10-26T20:47:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-716813756",
      "id" : 716813756,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNjgxMzc1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-26T20:47:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/716813756",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20250 (Bugfix: RPC/Wallet: Make BTC/kB and sat/B fee modes work sanely by luke-jr)\n* #17211 (Allow fundrawtransaction and walletcreatefundedpsbt to take external inputs by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-10-27T05:48:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-717000109",
      "id" : 717000109,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNzAwMDEwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-31T16:35:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/717000109",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513038521"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513038521"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done in fc572172",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-27T21:18:15Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513038521",
      "id" : 513038521,
      "in_reply_to_id" : 511142032,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzAzODUyMQ==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 185,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 518158729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513038521",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513039023"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513039023"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done in 1697a40",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-27T21:19:18Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})\n+\n+    self.log.info(\"Test explicit feerate raises RPC error if both fee_rate and conf_target are passed\")\n+    msg = \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation \" \\\n+          \"target in blocks for automatic fee estimation, or an explicit fee rate.\"\n+    assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {\"conf_target\": NORMAL, \"fee_rate\": NORMAL})\n+\n+    self.log.info(\"Test invalid conf_target settings\")\n+    for field in [\"confTarget\", \"conf_target\"]:\n+        assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {field: 1, \"fee_rate\": NORMAL})\n+    too_high = \"is too high (cannot be higher than -maxtxfee\"\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": BTC_MODE, \"conf_target\": 2009}))\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": SAT_MODE, \"conf_target\": 2009 * 10000}))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513039023",
      "id" : 513039023,
      "in_reply_to_id" : 511146854,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzAzOTAyMw==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 197,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 518159395,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513039023",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hopefully addressed the (excellent) review feedback and also added missing explicit fee rate coverage in `wallet_basic.py` for RPCs sendtoaddress and sendmany and in `wallet_send.py` for RPC send. Found some bugs and inconsistent behavior in RPC send, some of which I notated with `TODO` comments in the tests, but left the fixes for follow-ups as I've spent a ton of time here already going through all these RPCs and the release branch-off isn't far away.",
      "created_at" : "2020-10-27T21:25:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-717549366",
      "id" : 717549366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNzU0OTM2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-27T21:25:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/717549366",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just seeing this now. Aiming to take a look tomorrow.",
      "created_at" : "2020-10-28T03:38:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-717675094",
      "id" : 717675094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNzY3NTA5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-28T03:38:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/717675094",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513700393"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513700393"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: `bTc`?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:17:48Z",
      "diff_hunk" : "@@ -226,9 +228,9 @@ def run_test(self):\n         assert_equal(self.nodes[2].getbalance(), node_2_bal)\n         node_0_bal = self.check_fee_amount(self.nodes[0].getbalance(), node_0_bal + Decimal('10'), fee_per_byte, self.get_vsize(self.nodes[2].gettransaction(txid)['hex']))\n \n-        # Sendmany with explicit fee (BTC/kB)\n+        self.log.info(\"Test explicit fee (sendmany as BTC/kB)\")\n         # Throw if no conf_target provided\n-        assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+        assert_raises_rpc_error(-8, \"Selected estimate_mode bTc/kB requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513700393",
      "id" : 513700393,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwMDM5Mw==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 233,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 17,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513700393",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513701195"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513701195"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: I think that's a fee rate, not an absolute fee.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:19:17Z",
      "diff_hunk" : "@@ -226,9 +228,9 @@ def run_test(self):\n         assert_equal(self.nodes[2].getbalance(), node_2_bal)\n         node_0_bal = self.check_fee_amount(self.nodes[0].getbalance(), node_0_bal + Decimal('10'), fee_per_byte, self.get_vsize(self.nodes[2].gettransaction(txid)['hex']))\n \n-        # Sendmany with explicit fee (BTC/kB)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513701195",
      "id" : 513701195,
      "line" : 229,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwMTE5NQ==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 229,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 13,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513701195",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513701478"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513701478"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This should say \"fee rate\" rather than \"fee\".",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:19:48Z",
      "diff_hunk" : "@@ -252,9 +254,9 @@ def run_test(self):\n         node_0_bal += Decimal('10')\n         assert_equal(self.nodes[0].getbalance(), node_0_bal)\n \n-        # Sendmany with explicit fee (SAT/B)\n+        self.log.info(\"Test explicit fee (sendmany as sat/B)\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513701478",
      "id" : 513701478,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwMTQ3OA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 257,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : null,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513701478",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513701599"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513701599"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This should say \"fee rate\" rather than \"fee\".",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:20:00Z",
      "diff_hunk" : "@@ -413,15 +421,14 @@ def run_test(self):\n             self.nodes[0].generate(1)\n             self.sync_all(self.nodes[0:3])\n \n-            # send with explicit btc/kb fee\n-            self.log.info(\"test explicit fee (sendtoaddress as btc/kb)\")\n+            self.log.info(\"Test explicit fee (sendtoaddress as BTC/kB)\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513701599",
      "id" : 513701599,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwMTU5OQ==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 424,
      "original_position" : 52,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : null,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513701599",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513702864"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513702864"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: Inconsistency between 257 and 259, once it's `sat/B` once `sat/b`. \r\n\r\nThere seem to be a lot of case variations in the following code on the `sat/b` and `BTc/Kb`. I'm not sure whether that is on purpose to test the case insensitivity. I'll err on pointing them out when I notice. Feel free to ignore if that's on purpose and I'm just not grokking the reason.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:22:20Z",
      "diff_hunk" : "@@ -252,9 +254,9 @@ def run_test(self):\n         node_0_bal += Decimal('10')\n         assert_equal(self.nodes[0].getbalance(), node_0_bal)\n \n-        # Sendmany with explicit fee (SAT/B)\n+        self.log.info(\"Test explicit fee (sendmany as sat/B)\")\n         # Throw if no conf_target provided\n-        assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+        assert_raises_rpc_error(-8, \"Selected estimate_mode sat/b requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513702864",
      "id" : 513702864,
      "line" : 259,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwMjg2NA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 259,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 29,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513702864",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513703330"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513703330"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This should say \"fee rate\" rather than \"fee\".\r\n\r\nThe phrase \"explicit fee\" would imply to me that an absolute amount of satoshis is used rather than a fee rate. That's why I'm pointing it out.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:23:15Z",
      "diff_hunk" : "@@ -447,15 +454,15 @@ def run_test(self):\n             fee = prebalance - postbalance - Decimal('1')\n             assert_fee_amount(fee, tx_size, Decimal('0.00002500'))\n \n-            # send with explicit sat/b fee\n             self.sync_all(self.nodes[0:3])\n-            self.log.info(\"test explicit fee (sendtoaddress as sat/b)\")\n+\n+            self.log.info(\"Test explicit fee (sendtoaddress as sat/B)\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513703330",
      "id" : 513703330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwMzMzMA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 459,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : null,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513703330",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513703918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513703918"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: `SAT/b`",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:24:15Z",
      "diff_hunk" : "@@ -447,15 +454,15 @@ def run_test(self):\n             fee = prebalance - postbalance - Decimal('1')\n             assert_fee_amount(fee, tx_size, Decimal('0.00002500'))\n \n-            # send with explicit sat/b fee\n             self.sync_all(self.nodes[0:3])\n-            self.log.info(\"test explicit fee (sendtoaddress as sat/b)\")\n+\n+            self.log.info(\"Test explicit fee (sendtoaddress as sat/B)\")\n             self.nodes[0].generate(1)\n             prebalance = self.nodes[2].getbalance()\n             assert prebalance > 2\n             address = self.nodes[1].getnewaddress()\n             # Throw if no conf_target provided\n-            assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode SAT/b requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513703918",
      "id" : 513703918,
      "line" : 465,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwMzkxOA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 465,
      "original_position" : 79,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 79,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513703918",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513705249"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513705249"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay, lemme check this out locally and run this incantation on it. :)",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:26:29Z",
      "diff_hunk" : "@@ -100,28 +99,55 @@ def run_test(self):\n         test_small_output_with_feerate_succeeds(self, rbf_node, dest_address)\n         test_no_more_inputs_fails(self, rbf_node, dest_address)\n \n-    def test_invalid_parameters(self, node, dest_address):\n-        txid = spend_one_input(node, dest_address)\n-        # invalid estimate mode\n-        assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", node.bumpfee, txid, {\n-            \"estimate_mode\": \"moo\",\n-        })\n-        assert_raises_rpc_error(-3, \"Expected type string\", node.bumpfee, txid, {\n-            \"estimate_mode\": 38,\n-        })\n-        assert_raises_rpc_error(-3, \"Expected type string\", node.bumpfee, txid, {\n-            \"estimate_mode\": {\n-                \"foo\": \"bar\",\n-            },\n-        })\n-        assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", node.bumpfee, txid, {\n-            \"estimate_mode\": Decimal(\"3.141592\"),\n-        })\n-        # confTarget and conf_target\n-        assert_raises_rpc_error(-8, \"confTarget and conf_target options should not both be set\", node.bumpfee, txid, {\n-            \"confTarget\": 123,\n-            \"conf_target\": 456,\n-        })\n+    def test_invalid_parameters(self, rbf_node, peer_node, dest_address):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513705249",
      "id" : 513705249,
      "in_reply_to_id" : 511153062,
      "line" : 102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcwNTI0OQ==",
      "original_commit_id" : "9ea6d390c26975c98a9cf28cf816bcbded9aa3d1",
      "original_line" : 102,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 58,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513705249",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513717032"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513717032"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`git diff 2d8eba8~1..2d8eba8 | grep -E '^[+-][^+-]' | cut -b2- | sort | uniq -c | grep -v '^ *2'` led to weird output for me. It appears to break the new diff viewer I'm currently trying. I also hope I didn't accidentally summon an imp. :sweat_smile: \r\n\r\nAlright, the `git show 2d8eba8 -w --color-moved=dimmed_zebra` did the trick for me. Thanks for teaching me!\r\n",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:48:08Z",
      "diff_hunk" : "@@ -100,28 +99,55 @@ def run_test(self):\n         test_small_output_with_feerate_succeeds(self, rbf_node, dest_address)\n         test_no_more_inputs_fails(self, rbf_node, dest_address)\n \n-    def test_invalid_parameters(self, node, dest_address):\n-        txid = spend_one_input(node, dest_address)\n-        # invalid estimate mode\n-        assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", node.bumpfee, txid, {\n-            \"estimate_mode\": \"moo\",\n-        })\n-        assert_raises_rpc_error(-3, \"Expected type string\", node.bumpfee, txid, {\n-            \"estimate_mode\": 38,\n-        })\n-        assert_raises_rpc_error(-3, \"Expected type string\", node.bumpfee, txid, {\n-            \"estimate_mode\": {\n-                \"foo\": \"bar\",\n-            },\n-        })\n-        assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", node.bumpfee, txid, {\n-            \"estimate_mode\": Decimal(\"3.141592\"),\n-        })\n-        # confTarget and conf_target\n-        assert_raises_rpc_error(-8, \"confTarget and conf_target options should not both be set\", node.bumpfee, txid, {\n-            \"confTarget\": 123,\n-            \"conf_target\": 456,\n-        })\n+    def test_invalid_parameters(self, rbf_node, peer_node, dest_address):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513717032",
      "id" : 513717032,
      "in_reply_to_id" : 511153062,
      "line" : 102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcxNzAzMg==",
      "original_commit_id" : "9ea6d390c26975c98a9cf28cf816bcbded9aa3d1",
      "original_line" : 102,
      "original_position" : 38,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 58,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513717032",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513721009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513721009"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: `BTc/Kb`?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T19:55:01Z",
      "diff_hunk" : "@@ -421,7 +421,7 @@ def run_test(self):\n             assert prebalance > 2\n             address = self.nodes[1].getnewaddress()\n             # Throw if no conf_target provided\n-            assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode BTc/Kb requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513721009",
      "id" : 513721009,
      "line" : 431,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyMTAwOQ==",
      "original_commit_id" : "fc5721723d34f76f9e1ffd2e31f274ea6b22f894",
      "original_line" : 424,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 60,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513721009",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513724524"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513724524"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I just saw the value below in the `estimate_mode` the input in 260 is matching. I conclude that the string is case-insensitive, and the purpose was to test the insensitivity. I'd prefer an approach where a single style was used across all tests, and then one test checked the case insensitivity of the estimate_mode explicitly, but I don't think it's pertinent to make the actual change in this PR.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:01:01Z",
      "diff_hunk" : "@@ -252,9 +254,9 @@ def run_test(self):\n         node_0_bal += Decimal('10')\n         assert_equal(self.nodes[0].getbalance(), node_0_bal)\n \n-        # Sendmany with explicit fee (SAT/B)\n+        self.log.info(\"Test explicit fee (sendmany as sat/B)\")\n         # Throw if no conf_target provided\n-        assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+        assert_raises_rpc_error(-8, \"Selected estimate_mode sat/b requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513724524",
      "id" : 513724524,
      "in_reply_to_id" : 513702864,
      "line" : 259,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyNDUyNA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 259,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 29,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513724524",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513725954"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513725954"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Wonderful, thanks!",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:03:36Z",
      "diff_hunk" : "@@ -168,24 +168,54 @@ def test_simple_bumpfee_succeeds(self, mode, rbf_node, peer_node, dest_address):\n \n \n def test_feerate_args(self, rbf_node, peer_node, dest_address):\n-    self.log.info('Test fee_rate args')\n+    self.log.info('Test feerate args')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n \n     # Bumping to just above minrelay should fail to increase total fee enough, at least\n     assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n-\n     assert_raises_rpc_error(-3, \"Amount out of range\", rbf_node.bumpfee, rbfid, {\"fee_rate\": -1})\n-\n     assert_raises_rpc_error(-4, \"is too high (cannot be higher than\", rbf_node.bumpfee, rbfid, {\"fee_rate\": TOO_HIGH})\n-    self.clear_mempool()\n \n+    self.log.info(\"Test explicit feerate raises RPC error if estimate_mode is passed without a conf_target\")\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"estimate_mode\": BTC_MODE})\n+    assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\", rbf_node.bumpfee, rbfid, {\"fee_rate\": 10, \"estimate_mode\": SAT_MODE})\n+\n+    self.log.info(\"Test explicit feerate raises RPC error if both fee_rate and conf_target are passed\")\n+    msg = \"Cannot specify both conf_target and fee_rate. Please provide either a confirmation \" \\\n+          \"target in blocks for automatic fee estimation, or an explicit fee rate.\"\n+    assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {\"conf_target\": NORMAL, \"fee_rate\": NORMAL})\n+\n+    self.log.info(\"Test invalid conf_target settings\")\n+    for field in [\"confTarget\", \"conf_target\"]:\n+        assert_raises_rpc_error(-8, msg, rbf_node.bumpfee, rbfid, {field: 1, \"fee_rate\": NORMAL})\n+    too_high = \"is too high (cannot be higher than -maxtxfee\"\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": BTC_MODE, \"conf_target\": 2009}))\n+    assert_raises_rpc_error(-4, too_high, lambda: rbf_node.bumpfee(rbfid, {\"estimate_mode\": SAT_MODE, \"conf_target\": 2009 * 10000}))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513725954",
      "id" : 513725954,
      "in_reply_to_id" : 511146854,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyNTk1NA==",
      "original_commit_id" : "70b793c2b3b91b012316292cd87a093871dd714a",
      "original_line" : 197,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513725954",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513730504"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513730504"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I was originally thinking here:\r\n\r\n> I'm confused by the ` {\"conf_target\": 1, \"estimate_mode\": SAT_MODE}`. Fitting the theme, I would expect the `conf_target` to be below `minRelayTxFeeRate`. But IIUC, 1 sat/B would be exactly the `minRelayTxFeeRate`. Is it possible that this should be â¦ oh. â¦ `INSUFFICIENT` also appears to be exactly the `minRelayTxFeeRate`. â¦ Oh, this is for bumping. Duh.\r\n\r\nNevermind, carry on! :ok_hand: Thanks for adding this.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:12:02Z",
      "diff_hunk" : "@@ -173,19 +173,50 @@ def test_feerate_args(self, rbf_node, peer_node, dest_address):\n     self.sync_mempools((rbf_node, peer_node))\n     assert rbfid in rbf_node.getrawmempool() and rbfid in peer_node.getrawmempool()\n \n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\": NORMAL, \"confTarget\": 1})\n-\n     assert_raises_rpc_error(-3, \"Unexpected key totalFee\", rbf_node.bumpfee, rbfid, {\"totalFee\": NORMAL})\n-    assert_raises_rpc_error(-8, \"conf_target can't be set with fee_rate. Please provide either a confirmation target in blocks for automatic fee estimation, or an explicit fee rate.\", rbf_node.bumpfee, rbfid, {\"fee_rate\":0.00001, \"confTarget\": 1})\n-\n-    # Bumping to just above minrelay should fail to increase total fee enough, at least\n-    assert_raises_rpc_error(-8, \"Insufficient total fee\", rbf_node.bumpfee, rbfid, {\"fee_rate\": INSUFFICIENT})\n \n+    # For each fee mode, bumping to just above minrelay should fail to increase the total fee enough.\n+    for options in [{\"fee_rate\": INSUFFICIENT}, {\"conf_target\": INSUFFICIENT, \"estimate_mode\": BTC_MODE}, {\"conf_target\": 1, \"estimate_mode\": SAT_MODE}]:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513730504",
      "id" : 513730504,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzczMDUwNA==",
      "original_commit_id" : "1697a40b6f841a54ee0d9744ed7fd09034b0ddad",
      "original_line" : 179,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513730504",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513737635"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513737635"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: Since this is new code, I'm surprised by the variations in the estimate_mode case, but not feeling strongly about it.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:25:13Z",
      "diff_hunk" : "@@ -672,6 +674,59 @@ def test_option_feerate(self):\n         assert_fee_amount(result2['fee'], count_bytes(result2['hex']), 2 * result_fee_rate)\n         assert_fee_amount(result3['fee'], count_bytes(result3['hex']), 10 * result_fee_rate)\n \n+    def test_feerate_with_conf_target_and_estimate_mode(self):\n+        self.log.info(\"Test fundrawtxn passing an explicit fee rate using conf_target and estimate_mode\")\n+        node = self.nodes[3]\n+        # Make sure there is exactly one input so coin selection can't skew the result.\n+        assert_equal(len(node.listunspent(1)), 1)\n+        inputs = []\n+        outputs = {node.getnewaddress() : 1}\n+        rawtx = node.createrawtransaction(inputs, outputs)\n+\n+        for unit, fee_rate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():\n+            self.log.info(\"Test fundrawtxn with conf_target {} estimate_mode {} produces expected fee\".format(fee_rate, unit))\n+            # With no arguments passed, expect fee of 141 sats/b.\n+            assert_approx(node.fundrawtransaction(rawtx)[\"fee\"], vexp=0.00000141, vspan=0.00000001)\n+            # Expect fee to be 10,000x higher when explicit fee 10,000x greater is specified.\n+            result = node.fundrawtransaction(rawtx, {\"conf_target\": fee_rate, \"estimate_mode\": unit})\n+            assert_approx(result[\"fee\"], vexp=0.0141, vspan=0.0001)\n+\n+        for field, fee_rate in {\"conf_target\": 0.1, \"estimate_mode\": \"sat/b\"}.items():\n+            self.log.info(\"Test fundrawtxn raises RPC error if both feeRate and {} are passed\".format(field))\n+            assert_raises_rpc_error(\n+                -8, \"Cannot specify both {} and feeRate\".format(field),\n+                lambda: node.fundrawtransaction(rawtx, {\"feeRate\": 0.1, field: fee_rate}))\n+\n+        self.log.info(\"Test fundrawtxn with invalid estimate_mode settings\")\n+        for k, v in {\"number\": 42, \"object\": {\"foo\": \"bar\"}}.items():\n+            assert_raises_rpc_error(-3, \"Expected type string for estimate_mode, got {}\".format(k),\n+                lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": v, \"conf_target\": 0.1}))\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\",\n+                lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": 0.1}))\n+\n+        self.log.info(\"Test fundrawtxn with invalid conf_target settings\")\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.log.debug(\"{}\".format(mode))\n+            for k, v in {\"string\": \"\", \"object\": {\"foo\": \"bar\"}}.items():\n+                assert_raises_rpc_error(-3, \"Expected type number for conf_target, got {}\".format(k),\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": v}))\n+            if mode in [\"btc/kb\", \"sat/b\"]:\n+                assert_raises_rpc_error(-3, \"Amount out of range\",\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": -1}))\n+                assert_raises_rpc_error(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": 0}))\n+            else:\n+                for n in [-1, 0, 1009]:\n+                    assert_raises_rpc_error(-8, \"Invalid conf_target, must be between 1 and 1008\",\n+                        lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": n}))\n+\n+        for unit, fee_rate in {\"SAT/B\": 0.99999999, \"BTC/KB\": 0.00000999}.items():",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513737635",
      "id" : 513737635,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzczNzYzNQ==",
      "original_commit_id" : "3f52eafa405c5e05b2b2fadcbccc84c815951974",
      "original_line" : 724,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513737635",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513738107"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513738107"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : ":+1: ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:26:07Z",
      "diff_hunk" : "@@ -672,6 +674,59 @@ def test_option_feerate(self):\n         assert_fee_amount(result2['fee'], count_bytes(result2['hex']), 2 * result_fee_rate)\n         assert_fee_amount(result3['fee'], count_bytes(result3['hex']), 10 * result_fee_rate)\n \n+    def test_feerate_with_conf_target_and_estimate_mode(self):\n+        self.log.info(\"Test fundrawtxn passing an explicit fee rate using conf_target and estimate_mode\")\n+        node = self.nodes[3]\n+        # Make sure there is exactly one input so coin selection can't skew the result.\n+        assert_equal(len(node.listunspent(1)), 1)\n+        inputs = []\n+        outputs = {node.getnewaddress() : 1}\n+        rawtx = node.createrawtransaction(inputs, outputs)\n+\n+        for unit, fee_rate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():\n+            self.log.info(\"Test fundrawtxn with conf_target {} estimate_mode {} produces expected fee\".format(fee_rate, unit))\n+            # With no arguments passed, expect fee of 141 sats/b.\n+            assert_approx(node.fundrawtransaction(rawtx)[\"fee\"], vexp=0.00000141, vspan=0.00000001)\n+            # Expect fee to be 10,000x higher when explicit fee 10,000x greater is specified.\n+            result = node.fundrawtransaction(rawtx, {\"conf_target\": fee_rate, \"estimate_mode\": unit})\n+            assert_approx(result[\"fee\"], vexp=0.0141, vspan=0.0001)\n+\n+        for field, fee_rate in {\"conf_target\": 0.1, \"estimate_mode\": \"sat/b\"}.items():\n+            self.log.info(\"Test fundrawtxn raises RPC error if both feeRate and {} are passed\".format(field))\n+            assert_raises_rpc_error(\n+                -8, \"Cannot specify both {} and feeRate\".format(field),\n+                lambda: node.fundrawtransaction(rawtx, {\"feeRate\": 0.1, field: fee_rate}))\n+\n+        self.log.info(\"Test fundrawtxn with invalid estimate_mode settings\")\n+        for k, v in {\"number\": 42, \"object\": {\"foo\": \"bar\"}}.items():\n+            assert_raises_rpc_error(-3, \"Expected type string for estimate_mode, got {}\".format(k),\n+                lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": v, \"conf_target\": 0.1}))\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\",\n+                lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": 0.1}))\n+\n+        self.log.info(\"Test fundrawtxn with invalid conf_target settings\")\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.log.debug(\"{}\".format(mode))\n+            for k, v in {\"string\": \"\", \"object\": {\"foo\": \"bar\"}}.items():\n+                assert_raises_rpc_error(-3, \"Expected type number for conf_target, got {}\".format(k),\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": v}))\n+            if mode in [\"btc/kb\", \"sat/b\"]:\n+                assert_raises_rpc_error(-3, \"Amount out of range\",\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": -1}))\n+                assert_raises_rpc_error(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": 0}))\n+            else:\n+                for n in [-1, 0, 1009]:\n+                    assert_raises_rpc_error(-8, \"Invalid conf_target, must be between 1 and 1008\",\n+                        lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": n}))\n+\n+        for unit, fee_rate in {\"SAT/B\": 0.99999999, \"BTC/KB\": 0.00000999}.items():\n+            self.log.info(\"- raises RPC error 'fee rate too low' if conf_target {} and estimate_mode {} are passed\".format(fee_rate, unit))\n+            assert_raises_rpc_error(-4, \"Fee rate (0.00000999 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513738107",
      "id" : 513738107,
      "line" : 726,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzczODEwNw==",
      "original_commit_id" : "3f52eafa405c5e05b2b2fadcbccc84c815951974",
      "original_line" : 726,
      "original_position" : 69,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 69,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513738107",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513739278"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513739278"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: kelvinbytes\r\n\r\nI know, I know, \"kilo\" is the odd one out because generally the prefixes for multiples are capitalized. Just being a bit of a unit nerd here.\r\n\r\n(To be clear, when I mark a comment with \"Nit:\" I consider it optional for the author to address it.)",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:27:54Z",
      "diff_hunk" : "@@ -186,15 +189,17 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        # feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000):\n-        res = self.nodes[1].walletcreatefundedpsbt([{\"txid\":txid,\"vout\":p2wpkh_pos},{\"txid\":txid,\"vout\":p2sh_p2wpkh_pos},{\"txid\":txid,\"vout\":p2pkh_pos}], {self.nodes[1].getnewaddress():29.99}, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n+        self.log.info(\"Test walletcreatefundedpsbt feeRate of 0.1 BTC/kB produces a total fee at or slightly below -maxtxfee (~0.05290000)\")\n+        res = self.nodes[1].walletcreatefundedpsbt(inputs, outputs, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n         assert_approx(res[\"fee\"], 0.055, 0.005)\n \n-        # feeRate of 10 BTC / KB produces a total fee well above -maxtxfee\n+        self.log.info(\"Test walletcreatefundedpsbt feeRate of 10 BTC/KB produces total fee well above -maxtxfee and raises RPC error\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513739278",
      "id" : 513739278,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzczOTI3OA==",
      "original_commit_id" : "36b6ab749457fb43727bc180588978a4d946b856",
      "original_line" : 196,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513739278",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513741651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513741651"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Love how much more readable the tests below become. Good improvement.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:32:04Z",
      "diff_hunk" : "@@ -174,8 +174,11 @@ def run_test(self):\n             elif out['scriptPubKey']['addresses'][0] == p2pkh:\n                 p2pkh_pos = out['n']\n \n+        inputs = [{\"txid\": txid, \"vout\": p2wpkh_pos}, {\"txid\": txid, \"vout\": p2sh_p2wpkh_pos}, {\"txid\": txid, \"vout\": p2pkh_pos}]\n+        outputs = [{self.nodes[1].getnewaddress(): 29.99}]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513741651",
      "id" : 513741651,
      "line" : 178,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc0MTY1MQ==",
      "original_commit_id" : "36b6ab749457fb43727bc180588978a4d946b856",
      "original_line" : 178,
      "original_position" : 5,
      "original_start_line" : 177,
      "path" : "test/functional/rpc_psbt.py",
      "position" : 5,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : 177,
      "start_side" : "RIGHT",
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513741651",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513745170"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513745170"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I noticed that both `arg_estimate_mode` and `estimate_mode` appear in these test parameters. That seems odd. I wonder whether both pertain to the same value. If one of them would supersede the other, and that happened to be `arg_estimate_mode`, we would actually only be testing for `economical` here. If they actually do refer both to the same value, they should probably both be set to `=mode`.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:38:56Z",
      "diff_hunk" : "@@ -224,8 +226,10 @@ def run_test(self):\n         assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"],\n                      self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n         # but not at the same time\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",\n-                       conf_target=1, estimate_mode=\"economical\", add_to_wallet=False, expect_error=(-8,\"Use either conf_target and estimate_mode or the options dictionary to control fee rate\"))\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513745170",
      "id" : 513745170,
      "line" : 230,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc0NTE3MA==",
      "original_commit_id" : "328ac2b0a32d2fa3696778681e71813a4deda663",
      "original_line" : 230,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 16,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513745170",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513747612"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513747612"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The only difference I see in this line is that it now uses `arg_conf_target` where `conf_target` was used in 284 and `arg_estimate_mode` where `estimate_mode` was used. Potentially, the sanitation for those parameters are different?",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:43:32Z",
      "diff_hunk" : "@@ -246,19 +250,61 @@ def run_test(self):\n         res = w2.walletprocesspsbt(res[\"psbt\"])\n         assert res[\"complete\"]\n \n-        self.log.info(\"Set fee rate...\")\n+        self.log.info(\"Test setting explicit fee rate\")\n+        res1 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\", add_to_wallet=False)\n+        res2 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=1, estimate_mode=\"economical\", add_to_wallet=False)\n+        assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"], self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n+\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.00007, estimate_mode=\"btc/kb\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00007\"))\n+\n         res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=2, estimate_mode=\"sat/b\", add_to_wallet=False)\n         fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n         assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00002\"))\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=\"sat/b\",\n-                       expect_error=(-3, \"Amount out of range\"))\n-        # Fee rate of 0.1 satoshi per byte should throw an error\n-        # TODO: error should use sat/b\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\",\n-                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n \n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.000001, estimate_mode=\"BTC/KB\",\n-                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=0.00004531, arg_estimate_mode=\"btc/kb\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00004531\"))\n+\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=3, arg_estimate_mode=\"sat/b\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00003\"))\n+\n+        # TODO: This test should pass with all modes, e.g. with the next line uncommented.\n+        # for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+        for mode in [\"btc/kb\", \"sat/b\"]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=mode,\n+                expect_error=(-3, \"Amount out of range\"))\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0, estimate_mode=mode,\n+                expect_error=(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=mode,\n+                expect_error=(-8, \"Invalid estimate_mode parameter\"))\n+            # TODO: these 2 equivalent sends with an invalid estimate_mode arg should both fail, but they do not...why?\n+            # self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=0.1, arg_estimate_mode=mode,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513747612",
      "id" : 513747612,
      "line" : 286,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc0NzYxMg==",
      "original_commit_id" : "328ac2b0a32d2fa3696778681e71813a4deda663",
      "original_line" : 286,
      "original_position" : 68,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 69,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513747612",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513749048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513749048"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see that the third argument here has changed from `\"wallet default\"` to `\"wallet -txconfirmtarget\"`, but it's not clear to me what the effect of that would be.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T20:46:14Z",
      "diff_hunk" : "@@ -440,7 +440,8 @@ static RPCHelpMan sendtoaddress()\n                     {\"subtractfeefromamount\", RPCArg::Type::BOOL, /* default */ \"false\", \"The fee will be deducted from the amount being sent.\\n\"\n                                          \"The recipient will receive less bitcoins than you enter in the amount field.\"},\n                     {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Allow this transaction to be replaced by a transaction with higher fees via BIP 125\"},\n-                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet -txconfirmtarget\", \"Confirmation target (in blocks)\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513749048",
      "id" : 513749048,
      "line" : 443,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc0OTA0OA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 443,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 14,
      "pull_request_review_id" : 519005534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513749048",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513788941"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513788941"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point. In the `send` RPC, `conf_target` and `estimate_mode` can be both args (`arg_estimate_mode` in this test file) and options (`estimate_mode` in this test file).\r\n\r\nThere seem to be some oddities or bugs in the `send` RPC related to this, as described in https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513789526. The send RPC is marked as experimental, but these should be fixed or made consistent with the other RPCs after this is merged. I started to look into it but didn't find a fix quickly, and the PR is already quite large and the deadline for 0.21 branch-off this weekend is looming.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:03:00Z",
      "diff_hunk" : "@@ -224,8 +226,10 @@ def run_test(self):\n         assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"],\n                      self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n         # but not at the same time\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",\n-                       conf_target=1, estimate_mode=\"economical\", add_to_wallet=False, expect_error=(-8,\"Use either conf_target and estimate_mode or the options dictionary to control fee rate\"))\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513788941",
      "id" : 513788941,
      "in_reply_to_id" : 513745170,
      "line" : 230,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc4ODk0MQ==",
      "original_commit_id" : "328ac2b0a32d2fa3696778681e71813a4deda663",
      "original_line" : 230,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 16,
      "pull_request_review_id" : 519118726,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-29T08:27:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513788941",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513789526"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513789526"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, there seems to be a bug in the `send` RPC: per the code in `wallet/rpcwallet.cpp`, these should behave the same whether passed as an arg or an option, but they do not.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:04:27Z",
      "diff_hunk" : "@@ -246,19 +250,61 @@ def run_test(self):\n         res = w2.walletprocesspsbt(res[\"psbt\"])\n         assert res[\"complete\"]\n \n-        self.log.info(\"Set fee rate...\")\n+        self.log.info(\"Test setting explicit fee rate\")\n+        res1 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\", add_to_wallet=False)\n+        res2 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=1, estimate_mode=\"economical\", add_to_wallet=False)\n+        assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"], self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n+\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.00007, estimate_mode=\"btc/kb\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00007\"))\n+\n         res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=2, estimate_mode=\"sat/b\", add_to_wallet=False)\n         fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n         assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00002\"))\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=\"sat/b\",\n-                       expect_error=(-3, \"Amount out of range\"))\n-        # Fee rate of 0.1 satoshi per byte should throw an error\n-        # TODO: error should use sat/b\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\",\n-                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n \n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.000001, estimate_mode=\"BTC/KB\",\n-                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=0.00004531, arg_estimate_mode=\"btc/kb\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00004531\"))\n+\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=3, arg_estimate_mode=\"sat/b\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00003\"))\n+\n+        # TODO: This test should pass with all modes, e.g. with the next line uncommented.\n+        # for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+        for mode in [\"btc/kb\", \"sat/b\"]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=mode,\n+                expect_error=(-3, \"Amount out of range\"))\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0, estimate_mode=mode,\n+                expect_error=(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=mode,\n+                expect_error=(-8, \"Invalid estimate_mode parameter\"))\n+            # TODO: these 2 equivalent sends with an invalid estimate_mode arg should both fail, but they do not...why?\n+            # self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=0.1, arg_estimate_mode=mode,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513789526",
      "id" : 513789526,
      "in_reply_to_id" : 513747612,
      "line" : 286,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc4OTUyNg==",
      "original_commit_id" : "328ac2b0a32d2fa3696778681e71813a4deda663",
      "original_line" : 286,
      "original_position" : 68,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 69,
      "pull_request_review_id" : 519119478,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:29:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513789526",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513791924"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513791924"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is the RPC help output the user sees. The idea was to make the `conf_target` help correct (some were missing the sat/B mention), consistent and helpful across the 6 RPCs. The txconfirmtarget mention in some of the `conf_target` helps seems more useful info than just \"wallet default\", so I made them all the same/consistent. Open to disagreement about that :) ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:09:52Z",
      "diff_hunk" : "@@ -440,7 +440,8 @@ static RPCHelpMan sendtoaddress()\n                     {\"subtractfeefromamount\", RPCArg::Type::BOOL, /* default */ \"false\", \"The fee will be deducted from the amount being sent.\\n\"\n                                          \"The recipient will receive less bitcoins than you enter in the amount field.\"},\n                     {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Allow this transaction to be replaced by a transaction with higher fees via BIP 125\"},\n-                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet -txconfirmtarget\", \"Confirmation target (in blocks)\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513791924",
      "id" : 513791924,
      "in_reply_to_id" : 513749048,
      "line" : 443,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MTkyNA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 443,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 14,
      "pull_request_review_id" : 519122471,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513791924",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513792048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513792048"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:10:07Z",
      "diff_hunk" : "@@ -186,15 +189,17 @@ def run_test(self):\n         assert_equal(walletprocesspsbt_out['complete'], True)\n         self.nodes[1].sendrawtransaction(self.nodes[1].finalizepsbt(walletprocesspsbt_out['psbt'])['hex'])\n \n-        # feeRate of 0.1 BTC / KB produces a total fee slightly below -maxtxfee (~0.05280000):\n-        res = self.nodes[1].walletcreatefundedpsbt([{\"txid\":txid,\"vout\":p2wpkh_pos},{\"txid\":txid,\"vout\":p2sh_p2wpkh_pos},{\"txid\":txid,\"vout\":p2pkh_pos}], {self.nodes[1].getnewaddress():29.99}, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n+        self.log.info(\"Test walletcreatefundedpsbt feeRate of 0.1 BTC/kB produces a total fee at or slightly below -maxtxfee (~0.05290000)\")\n+        res = self.nodes[1].walletcreatefundedpsbt(inputs, outputs, 0, {\"feeRate\": 0.1, \"add_inputs\": True})\n         assert_approx(res[\"fee\"], 0.055, 0.005)\n \n-        # feeRate of 10 BTC / KB produces a total fee well above -maxtxfee\n+        self.log.info(\"Test walletcreatefundedpsbt feeRate of 10 BTC/KB produces total fee well above -maxtxfee and raises RPC error\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513792048",
      "id" : 513792048,
      "in_reply_to_id" : 513739278,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MjA0OA==",
      "original_commit_id" : "36b6ab749457fb43727bc180588978a4d946b856",
      "original_line" : 196,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : null,
      "pull_request_review_id" : 519122599,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513792048",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513792227"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513792227"
         }
      },
      "author_association" : "MEMBER",
      "body" : "made them all the same",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:10:30Z",
      "diff_hunk" : "@@ -672,6 +674,59 @@ def test_option_feerate(self):\n         assert_fee_amount(result2['fee'], count_bytes(result2['hex']), 2 * result_fee_rate)\n         assert_fee_amount(result3['fee'], count_bytes(result3['hex']), 10 * result_fee_rate)\n \n+    def test_feerate_with_conf_target_and_estimate_mode(self):\n+        self.log.info(\"Test fundrawtxn passing an explicit fee rate using conf_target and estimate_mode\")\n+        node = self.nodes[3]\n+        # Make sure there is exactly one input so coin selection can't skew the result.\n+        assert_equal(len(node.listunspent(1)), 1)\n+        inputs = []\n+        outputs = {node.getnewaddress() : 1}\n+        rawtx = node.createrawtransaction(inputs, outputs)\n+\n+        for unit, fee_rate in {\"btc/kb\": 0.1, \"sat/b\": 10000}.items():\n+            self.log.info(\"Test fundrawtxn with conf_target {} estimate_mode {} produces expected fee\".format(fee_rate, unit))\n+            # With no arguments passed, expect fee of 141 sats/b.\n+            assert_approx(node.fundrawtransaction(rawtx)[\"fee\"], vexp=0.00000141, vspan=0.00000001)\n+            # Expect fee to be 10,000x higher when explicit fee 10,000x greater is specified.\n+            result = node.fundrawtransaction(rawtx, {\"conf_target\": fee_rate, \"estimate_mode\": unit})\n+            assert_approx(result[\"fee\"], vexp=0.0141, vspan=0.0001)\n+\n+        for field, fee_rate in {\"conf_target\": 0.1, \"estimate_mode\": \"sat/b\"}.items():\n+            self.log.info(\"Test fundrawtxn raises RPC error if both feeRate and {} are passed\".format(field))\n+            assert_raises_rpc_error(\n+                -8, \"Cannot specify both {} and feeRate\".format(field),\n+                lambda: node.fundrawtransaction(rawtx, {\"feeRate\": 0.1, field: fee_rate}))\n+\n+        self.log.info(\"Test fundrawtxn with invalid estimate_mode settings\")\n+        for k, v in {\"number\": 42, \"object\": {\"foo\": \"bar\"}}.items():\n+            assert_raises_rpc_error(-3, \"Expected type string for estimate_mode, got {}\".format(k),\n+                lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": v, \"conf_target\": 0.1}))\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\",\n+                lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": 0.1}))\n+\n+        self.log.info(\"Test fundrawtxn with invalid conf_target settings\")\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.log.debug(\"{}\".format(mode))\n+            for k, v in {\"string\": \"\", \"object\": {\"foo\": \"bar\"}}.items():\n+                assert_raises_rpc_error(-3, \"Expected type number for conf_target, got {}\".format(k),\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": v}))\n+            if mode in [\"btc/kb\", \"sat/b\"]:\n+                assert_raises_rpc_error(-3, \"Amount out of range\",\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": -1}))\n+                assert_raises_rpc_error(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\n+                    lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": 0}))\n+            else:\n+                for n in [-1, 0, 1009]:\n+                    assert_raises_rpc_error(-8, \"Invalid conf_target, must be between 1 and 1008\",\n+                        lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": n}))\n+\n+        for unit, fee_rate in {\"SAT/B\": 0.99999999, \"BTC/KB\": 0.00000999}.items():",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513792227",
      "id" : 513792227,
      "in_reply_to_id" : 513737635,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MjIyNw==",
      "original_commit_id" : "3f52eafa405c5e05b2b2fadcbccc84c815951974",
      "original_line" : 724,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 519122797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513792227",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793167"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I suppose I'll make them all proper-cased in wallet_basic, and lowercased in fundrawtransaction, so they are less jarring while still testing the case insensitivity.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:12:53Z",
      "diff_hunk" : "@@ -421,7 +421,7 @@ def run_test(self):\n             assert prebalance > 2\n             address = self.nodes[1].getnewaddress()\n             # Throw if no conf_target provided\n-            assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode BTc/Kb requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793167",
      "id" : 513793167,
      "in_reply_to_id" : 513721009,
      "line" : 431,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MzE2Nw==",
      "original_commit_id" : "fc5721723d34f76f9e1ffd2e31f274ea6b22f894",
      "original_line" : 424,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 60,
      "pull_request_review_id" : 519124046,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793167",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793272"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793272"
         }
      },
      "author_association" : "MEMBER",
      "body" : "made sat/B",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:13:12Z",
      "diff_hunk" : "@@ -447,15 +454,15 @@ def run_test(self):\n             fee = prebalance - postbalance - Decimal('1')\n             assert_fee_amount(fee, tx_size, Decimal('0.00002500'))\n \n-            # send with explicit sat/b fee\n             self.sync_all(self.nodes[0:3])\n-            self.log.info(\"test explicit fee (sendtoaddress as sat/b)\")\n+\n+            self.log.info(\"Test explicit fee (sendtoaddress as sat/B)\")\n             self.nodes[0].generate(1)\n             prebalance = self.nodes[2].getbalance()\n             assert prebalance > 2\n             address = self.nodes[1].getnewaddress()\n             # Throw if no conf_target provided\n-            assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode SAT/b requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793272",
      "id" : 513793272,
      "in_reply_to_id" : 513703918,
      "line" : 465,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MzI3Mg==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 465,
      "original_position" : 79,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 79,
      "pull_request_review_id" : 519124216,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793272",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793418"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793418"
         }
      },
      "author_association" : "MEMBER",
      "body" : "agree, done",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:13:31Z",
      "diff_hunk" : "@@ -447,15 +454,15 @@ def run_test(self):\n             fee = prebalance - postbalance - Decimal('1')\n             assert_fee_amount(fee, tx_size, Decimal('0.00002500'))\n \n-            # send with explicit sat/b fee\n             self.sync_all(self.nodes[0:3])\n-            self.log.info(\"test explicit fee (sendtoaddress as sat/b)\")\n+\n+            self.log.info(\"Test explicit fee (sendtoaddress as sat/B)\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793418",
      "id" : 513793418,
      "in_reply_to_id" : 513703330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MzQxOA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 459,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : null,
      "pull_request_review_id" : 519124382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793418",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793536"
         }
      },
      "author_association" : "MEMBER",
      "body" : "good eye, done",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:13:50Z",
      "diff_hunk" : "@@ -252,9 +254,9 @@ def run_test(self):\n         node_0_bal += Decimal('10')\n         assert_equal(self.nodes[0].getbalance(), node_0_bal)\n \n-        # Sendmany with explicit fee (SAT/B)\n+        self.log.info(\"Test explicit fee (sendmany as sat/B)\")\n         # Throw if no conf_target provided\n-        assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+        assert_raises_rpc_error(-8, \"Selected estimate_mode sat/b requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793536",
      "id" : 513793536,
      "in_reply_to_id" : 513702864,
      "line" : 259,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MzUzNg==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 259,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 29,
      "pull_request_review_id" : 519124543,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793536",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793606"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793606"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:14:05Z",
      "diff_hunk" : "@@ -413,15 +421,14 @@ def run_test(self):\n             self.nodes[0].generate(1)\n             self.sync_all(self.nodes[0:3])\n \n-            # send with explicit btc/kb fee\n-            self.log.info(\"test explicit fee (sendtoaddress as btc/kb)\")\n+            self.log.info(\"Test explicit fee (sendtoaddress as BTC/kB)\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793606",
      "id" : 513793606,
      "in_reply_to_id" : 513701599,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MzYwNg==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 424,
      "original_position" : 52,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : null,
      "pull_request_review_id" : 519124655,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793606",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793675"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793675"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:14:13Z",
      "diff_hunk" : "@@ -252,9 +254,9 @@ def run_test(self):\n         node_0_bal += Decimal('10')\n         assert_equal(self.nodes[0].getbalance(), node_0_bal)\n \n-        # Sendmany with explicit fee (SAT/B)\n+        self.log.info(\"Test explicit fee (sendmany as sat/B)\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793675",
      "id" : 513793675,
      "in_reply_to_id" : 513701478,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MzY3NQ==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 257,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : null,
      "pull_request_review_id" : 519124723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793675",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793717"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793717"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good eye! Done",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:14:19Z",
      "diff_hunk" : "@@ -226,9 +228,9 @@ def run_test(self):\n         assert_equal(self.nodes[2].getbalance(), node_2_bal)\n         node_0_bal = self.check_fee_amount(self.nodes[0].getbalance(), node_0_bal + Decimal('10'), fee_per_byte, self.get_vsize(self.nodes[2].gettransaction(txid)['hex']))\n \n-        # Sendmany with explicit fee (BTC/kB)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513793717",
      "id" : 513793717,
      "in_reply_to_id" : 513701195,
      "line" : 229,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MzcxNw==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 229,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 13,
      "pull_request_review_id" : 519124773,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513793717",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513800841"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513800841"
         }
      },
      "author_association" : "MEMBER",
      "body" : "e.g. before\r\n```\r\n7. conf_target      (numeric, optional, default=wallet default) Confirmation target (in blocks), or fee rate (for BTC/kB or sat/B estimate modes)\r\n```\r\nafter\r\n```\r\n7. conf_target      (numeric, optional, default=wallet -txconfirmtarget) Confirmation target (in blocks)\r\n                    or fee rate (for BTC/kB and sat/B estimate modes)\r\n```",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:31:44Z",
      "diff_hunk" : "@@ -440,7 +440,8 @@ static RPCHelpMan sendtoaddress()\n                     {\"subtractfeefromamount\", RPCArg::Type::BOOL, /* default */ \"false\", \"The fee will be deducted from the amount being sent.\\n\"\n                                          \"The recipient will receive less bitcoins than you enter in the amount field.\"},\n                     {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Allow this transaction to be replaced by a transaction with higher fees via BIP 125\"},\n-                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet -txconfirmtarget\", \"Confirmation target (in blocks)\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513800841",
      "id" : 513800841,
      "in_reply_to_id" : 513749048,
      "line" : 443,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwMDg0MQ==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 443,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 14,
      "pull_request_review_id" : 519133341,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513800841",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513808799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513808799"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh wait, in wallet_basic.py I'd rather not touch the units in the original tests by @kallewoof. They were set this way on purpose. See closed PR #20041 that wanted to change them.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:53:00Z",
      "diff_hunk" : "@@ -421,7 +421,7 @@ def run_test(self):\n             assert prebalance > 2\n             address = self.nodes[1].getnewaddress()\n             # Throw if no conf_target provided\n-            assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode BTc/Kb requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513808799",
      "id" : 513808799,
      "in_reply_to_id" : 513721009,
      "line" : 431,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwODc5OQ==",
      "original_commit_id" : "fc5721723d34f76f9e1ffd2e31f274ea6b22f894",
      "original_line" : 424,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 60,
      "pull_request_review_id" : 519142723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513808799",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513809879"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513809879"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'll add \"case insensitive\" to the logging so it's clear to future readers of the test code.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-28T22:55:55Z",
      "diff_hunk" : "@@ -421,7 +421,7 @@ def run_test(self):\n             assert prebalance > 2\n             address = self.nodes[1].getnewaddress()\n             # Throw if no conf_target provided\n-            assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode BTc/Kb requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513809879",
      "id" : 513809879,
      "in_reply_to_id" : 513721009,
      "line" : 431,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwOTg3OQ==",
      "original_commit_id" : "fc5721723d34f76f9e1ffd2e31f274ea6b22f894",
      "original_line" : 424,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 60,
      "pull_request_review_id" : 519144005,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-28T23:24:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513809879",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks @Xekyo, updated units and comments per `git diff c80e227 0be2900`.\r\n\r\n<details><summary><code>git diff c80e227 0be2900</code></summary><p>\r\n\r\n```diff\r\ndiff --git a/test/functional/rpc_fundrawtransaction.py b/test/functional/rpc_fundrawtransaction.py\r\nindex a0e1d1b8a3..85ecb40354 100755\r\n--- a/test/functional/rpc_fundrawtransaction.py\r\n+++ b/test/functional/rpc_fundrawtransaction.py\r\n@@ -721,7 +721,7 @@ class RawTransactionsTest(BitcoinTestFramework):\r\n                     assert_raises_rpc_error(-8, \"Invalid conf_target, must be between 1 and 1008\",\r\n                         lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": mode, \"conf_target\": n}))\r\n \r\n-        for unit, fee_rate in {\"SAT/B\": 0.99999999, \"BTC/KB\": 0.00000999}.items():\r\n+        for unit, fee_rate in {\"sat/B\": 0.99999999, \"BTC/kB\": 0.00000999}.items():\r\n             self.log.info(\"- raises RPC error 'fee rate too low' if conf_target {} and estimate_mode {} are passed\".format(fee_rate, unit))\r\n             assert_raises_rpc_error(-4, \"Fee rate (0.00000999 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\r\n                 lambda: self.nodes[1].fundrawtransaction(rawtx, {\"estimate_mode\": unit, \"conf_target\": fee_rate, \"add_inputs\": True}))\r\ndiff --git a/test/functional/rpc_psbt.py b/test/functional/rpc_psbt.py\r\nindex 31a28d6ae7..28bcc516c6 100755\r\n--- a/test/functional/rpc_psbt.py\r\n+++ b/test/functional/rpc_psbt.py\r\n@@ -238,7 +238,7 @@ class PSBTTest(BitcoinTestFramework):\r\n             assert_raises_rpc_error(-4, \"Fee rate (0.00000999 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\r\n                 lambda: self.nodes[1].walletcreatefundedpsbt(inputs, outputs, 0, {\"estimate_mode\": unit, \"conf_target\": fee_rate, \"add_inputs\": True}))\r\n \r\n-        self.log.info(\"Test walletcreatefundedpsbt feeRate of 10 BTC/KB produces total fee well above -maxtxfee and raises RPC error\")\r\n+        self.log.info(\"Test walletcreatefundedpsbt feeRate of 10 BTC/kB produces total fee well above -maxtxfee and raises RPC error\")\r\n         # previously this was silently capped at -maxtxfee\r\n         for bool_add, outputs_array in {True: outputs, False: [{self.nodes[1].getnewaddress(): 1}]}.items():\r\n             assert_raises_rpc_error(-4, \"Fee exceeds maximum configured by user (e.g. -maxtxfee, maxfeerate)\",\r\ndiff --git a/test/functional/wallet_basic.py b/test/functional/wallet_basic.py\r\nindex 584be1da94..411ae3db29 100755\r\n--- a/test/functional/wallet_basic.py\r\n+++ b/test/functional/wallet_basic.py\r\n@@ -228,7 +228,7 @@ class WalletTest(BitcoinTestFramework):\r\n         assert_equal(self.nodes[2].getbalance(), node_2_bal)\r\n         node_0_bal = self.check_fee_amount(self.nodes[0].getbalance(), node_0_bal + Decimal('10'), fee_per_byte, self.get_vsize(self.nodes[2].gettransaction(txid)['hex']))\r\n \r\n-        self.log.info(\"Test explicit fee (sendmany as BTC/kB)\")\r\n+        self.log.info(\"Test case-insensitive explicit fee rate (sendmany as BTC/kB)\")\r\n         # Throw if no conf_target provided\r\n         assert_raises_rpc_error(-8, \"Selected estimate_mode bTc/kB requires a fee rate to be specified in conf_target\",\r\n             self.nodes[2].sendmany,\r\n@@ -254,7 +254,7 @@ class WalletTest(BitcoinTestFramework):\r\n         node_0_bal += Decimal('10')\r\n         assert_equal(self.nodes[0].getbalance(), node_0_bal)\r\n \r\n-        self.log.info(\"Test explicit fee (sendmany as sat/B)\")\r\n+        self.log.info(\"Test case-insensitive explicit fee rate (sendmany as sat/B)\")\r\n         # Throw if no conf_target provided\r\n         assert_raises_rpc_error(-8, \"Selected estimate_mode sat/b requires a fee rate to be specified in conf_target\",\r\n             self.nodes[2].sendmany,\r\n@@ -283,7 +283,7 @@ class WalletTest(BitcoinTestFramework):\r\n         assert_equal(self.nodes[0].getbalance(), node_0_bal)\r\n \r\n         # Test setting explicit fee rate just below the minimum.\r\n-        for unit, fee_rate in {\"BTC/KB\": 0.00000999, \"SAT/B\": 0.99999999}.items():\r\n+        for unit, fee_rate in {\"BTC/kB\": 0.00000999, \"sat/B\": 0.99999999}.items():\r\n             self.log.info(\"Test sendmany raises 'fee rate too low' if conf_target {} and estimate_mode {} are passed\".format(fee_rate, unit))\r\n             assert_raises_rpc_error(-6, \"Fee rate (0.00000999 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\r\n                 self.nodes[2].sendmany, amounts={address: 10}, estimate_mode=unit, conf_target=fee_rate)\r\n@@ -421,7 +421,7 @@ class WalletTest(BitcoinTestFramework):\r\n             self.nodes[0].generate(1)\r\n             self.sync_all(self.nodes[0:3])\r\n \r\n-            self.log.info(\"Test explicit fee (sendtoaddress as BTC/kB)\")\r\n+            self.log.info(\"Test case-insensitive explicit fee rate (sendtoaddress as BTC/kB)\")\r\n             self.nodes[0].generate(1)\r\n             self.sync_all(self.nodes[0:3])\r\n             prebalance = self.nodes[2].getbalance()\r\n@@ -456,7 +456,7 @@ class WalletTest(BitcoinTestFramework):\r\n \r\n             self.sync_all(self.nodes[0:3])\r\n \r\n-            self.log.info(\"Test explicit fee (sendtoaddress as sat/B)\")\r\n+            self.log.info(\"Test case-insensitive explicit fee rate (sendtoaddress as sat/B)\")\r\n             self.nodes[0].generate(1)\r\n             prebalance = self.nodes[2].getbalance()\r\n             assert prebalance > 2\r\n@@ -489,7 +489,7 @@ class WalletTest(BitcoinTestFramework):\r\n             assert_fee_amount(fee, tx_size, Decimal('0.00002000'))\r\n \r\n             # Test setting explicit fee rate just below the minimum.\r\n-            for unit, fee_rate in {\"BTC/KB\": 0.00000999, \"SAT/B\": 0.99999999}.items():\r\n+            for unit, fee_rate in {\"BTC/kB\": 0.00000999, \"sat/B\": 0.99999999}.items():\r\n                 self.log.info(\"Test sendtoaddress raises 'fee rate too low' if conf_target {} and estimate_mode {} are passed\".format(fee_rate, unit))\r\n                 assert_raises_rpc_error(-6, \"Fee rate (0.00000999 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\",\r\n                     self.nodes[2].sendtoaddress, address=address, amount=1, estimate_mode=unit, conf_target=fee_rate)\r\ndiff --git a/test/functional/wallet_send.py b/test/functional/wallet_send.py\r\nindex a6002b67f0..5840a24404 100755\r\n--- a/test/functional/wallet_send.py\r\n+++ b/test/functional/wallet_send.py\r\n@@ -271,7 +271,7 @@ class WalletSendTest(BitcoinTestFramework):\r\n         fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\r\n         assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00003\"))\r\n \r\n-        # TODO: This test should pass with all modes, e.g. with the next line uncommented.\r\n+        # TODO: This test should pass with all modes, e.g. with the next line uncommented, for consistency with the other explicit feerate RPCs.\r\n         # for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\r\n         for mode in [\"btc/kb\", \"sat/b\"]:\r\n             self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=mode,\r\n@@ -285,24 +285,24 @@ class WalletSendTest(BitcoinTestFramework):\r\n             # TODO: these 2 equivalent sends with an invalid estimate_mode arg should both fail, but they do not...why?\r\n             # self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=0.1, arg_estimate_mode=mode,\r\n             #     expect_error=(-8, \"Invalid estimate_mode parameter\"))\r\n-            # assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", lambda: w0.send({w0.getnewaddress(): 1}, 0.1, mode))\r\n+            # assert_raises_rpc_error(-8, \"Invalid estimate_mode parameter\", lambda: w0.send({w1.getnewaddress(): 1}, 0.1, mode))\r\n \r\n-        # TODO: These tests should pass but they do not.\r\n+        # TODO: These tests should pass for consistency with the other explicit feerate RPCs, but they do not.\r\n         # for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\r\n         #     self.log.debug(\"{}\".format(mode))\r\n         #     for k, v in {\"string\": \"\", \"object\": {\"foo\": \"bar\"}}.items():\r\n         #         self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=v, estimate_mode=mode,\r\n         #             expect_error=(-3, \"Expected type number for conf_target, got {}\".format(k)))\r\n \r\n-        # TODO: error should use sat/b\r\n+        # TODO: error should use sat/B instead of BTC/kB if sat/B is selected.\r\n         # Test setting explicit fee rate just below the minimum.\r\n-        for unit, fee_rate in {\"SAT/B\": 0.99999999, \"BTC/KB\": 0.00000999}.items():\r\n+        for unit, fee_rate in {\"sat/B\": 0.99999999, \"BTC/kB\": 0.00000999}.items():\r\n             self.log.info(\"Explicit fee rate raises RPC error 'fee rate too low' if conf_target {} and estimate_mode {} are passed\".format(fee_rate, unit))\r\n             self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=fee_rate, estimate_mode=unit,\r\n                 expect_error=(-4, \"Fee rate (0.00000999 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\r\n \r\n         self.log.info(\"Explicit fee rate raises RPC error if estimate_mode is passed without a conf_target\")\r\n-        for unit, fee_rate in {\"SAT/B\": 100, \"BTC/KB\": 0.001}.items():\r\n+        for unit, fee_rate in {\"sat/B\": 100, \"BTC/kB\": 0.001}.items():\r\n             self.test_send(from_wallet=w0, to_wallet=w1, amount=1, estimate_mode=unit,\r\n                 expect_error=(-8, \"Selected estimate_mode {} requires a fee rate to be specified in conf_target\".format(unit)))\r\n\r\n```\r\n</p></details>\r\n",
      "created_at" : "2020-10-28T23:27:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-718265863",
      "id" : 718265863,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxODI2NTg2Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-28T23:27:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/718265863",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513832017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513832017"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay, since this is only in a test, it may be fine to keep track of it, but not get too hung up on fixing every little bit before the merge.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-29T00:01:52Z",
      "diff_hunk" : "@@ -224,8 +226,10 @@ def run_test(self):\n         assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"],\n                      self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n         # but not at the same time\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",\n-                       conf_target=1, estimate_mode=\"economical\", add_to_wallet=False, expect_error=(-8,\"Use either conf_target and estimate_mode or the options dictionary to control fee rate\"))\n+        for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513832017",
      "id" : 513832017,
      "in_reply_to_id" : 513745170,
      "line" : 230,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgzMjAxNw==",
      "original_commit_id" : "328ac2b0a32d2fa3696778681e71813a4deda663",
      "original_line" : 230,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 16,
      "pull_request_review_id" : 519179640,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-29T00:01:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513832017",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513832348"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513832348"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see. That looks like a good change to me.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-29T00:03:15Z",
      "diff_hunk" : "@@ -440,7 +440,8 @@ static RPCHelpMan sendtoaddress()\n                     {\"subtractfeefromamount\", RPCArg::Type::BOOL, /* default */ \"false\", \"The fee will be deducted from the amount being sent.\\n\"\n                                          \"The recipient will receive less bitcoins than you enter in the amount field.\"},\n                     {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"wallet default\", \"Allow this transaction to be replaced by a transaction with higher fees via BIP 125\"},\n-                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks), or fee rate (for \" + CURRENCY_UNIT + \"/kB or \" + CURRENCY_ATOM + \"/B estimate modes)\"},\n+                    {\"conf_target\", RPCArg::Type::NUM, /* default */ \"wallet -txconfirmtarget\", \"Confirmation target (in blocks)\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513832348",
      "id" : 513832348,
      "in_reply_to_id" : 513749048,
      "line" : 443,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgzMjM0OA==",
      "original_commit_id" : "c80e2276fbf39667b59bbb801864c0dd1398d69b",
      "original_line" : 443,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 14,
      "pull_request_review_id" : 519181074,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-29T00:03:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513832348",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just ran the functional tests (for the previous commit I reviewed), which takes a surprisingly long time. Luckily, the first hit on an internet search for how to run the functional tests was this guide by some Jon Atack, made it really easy to get set up. :laughing: ",
      "created_at" : "2020-10-29T00:09:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-718278451",
      "id" : 718278451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxODI3ODQ1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-29T00:09:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/718278451",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Changes look great to me. \r\nutack `0be2900` \r\ncurrently running functional tests.",
      "created_at" : "2020-10-29T00:17:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-718280719",
      "id" : 718280719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxODI4MDcxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-29T00:17:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/718280719",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513836967"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513836967"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Cool, thanks for digging up the context. I still think it would be better to test case insensitivity of an argument in one dedicated test and then make all the other tests use the canonical writing, but it's definitely out of scope here.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-29T00:19:12Z",
      "diff_hunk" : "@@ -421,7 +421,7 @@ def run_test(self):\n             assert prebalance > 2\n             address = self.nodes[1].getnewaddress()\n             # Throw if no conf_target provided\n-            assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode BTc/Kb requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513836967",
      "id" : 513836967,
      "in_reply_to_id" : 513721009,
      "line" : 431,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgzNjk2Nw==",
      "original_commit_id" : "fc5721723d34f76f9e1ffd2e31f274ea6b22f894",
      "original_line" : 424,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 60,
      "pull_request_review_id" : 519200915,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-29T00:19:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513836967",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Xekyo You can run them in parallel; if you have sufficient RAM pretty extremely even. `test_runner.py -j60` works fine on my 4-core 32 GiB RAM system, taking 3m46s. A lot of the time consists of processes waiting for each other, so it's not actually CPU bound.",
      "created_at" : "2020-10-29T00:25:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-718283509",
      "id" : 718283509,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxODI4MzUwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-29T00:35:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/718283509",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513840343"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513840343"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree, and in a way that's what we've done: The added tests use canonical units and the original tests in wallet_basic.py do case insensitive testing of the units and are now described as such.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-29T00:31:06Z",
      "diff_hunk" : "@@ -421,7 +421,7 @@ def run_test(self):\n             assert prebalance > 2\n             address = self.nodes[1].getnewaddress()\n             # Throw if no conf_target provided\n-            assert_raises_rpc_error(-8, \"Selected estimate_mode requires a fee rate\",\n+            assert_raises_rpc_error(-8, \"Selected estimate_mode BTc/Kb requires a fee rate to be specified in conf_target\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r513840343",
      "id" : 513840343,
      "in_reply_to_id" : 513721009,
      "line" : 431,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MDM0Mw==",
      "original_commit_id" : "fc5721723d34f76f9e1ffd2e31f274ea6b22f894",
      "original_line" : 424,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "test/functional/wallet_basic.py",
      "position" : 60,
      "pull_request_review_id" : 519215365,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-29T08:28:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/513840343",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> You can run them in parallel; if you have sufficient RAM pretty extremely even. `test_runner.py -j60` works fine on my 4-core 32 GIB RAM system\n\nGood point; I'll mention that in the guide.",
      "created_at" : "2020-10-29T00:34:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-718286085",
      "id" : 718286085,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxODI4NjA4NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-29T00:34:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/718286085",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "tack (functional tests only) 0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-10-29T00:37:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-718287029",
      "id" : 718287029,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxODI4NzAyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-29T00:37:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/718287029",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r515729855"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/515729855"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I like the original better on this one, but I'm fine with the change.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-11-02T04:01:04Z",
      "diff_hunk" : "@@ -3373,7 +3376,7 @@ static RPCHelpMan bumpfee_helper(std::string method_name)\n         \"The command will pay the additional fee by reducing change outputs or adding inputs when necessary. It may add a new change output if one does not already exist.\\n\"\n         \"All inputs in the original transaction will be included in the replacement transaction.\\n\"\n         \"The command will fail if the wallet or mempool contains a transaction that spends one of T's outputs.\\n\"\n-        \"By default, the new fee will be calculated automatically using estimatesmartfee.\\n\"\n+        \"By default, the new fee will be calculated automatically using the estimatesmartfee RPC.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r515729855",
      "id" : 515729855,
      "line" : 3379,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTcyOTg1NQ==",
      "original_commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "original_line" : 3379,
      "original_position" : 53,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 53,
      "pull_request_review_id" : 521319710,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-02T11:55:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/515729855",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r515946353"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/515946353"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks @kallewoof--the idea was to help users know what estimatesmartfee is and where to look for more info without grepping the codebase, even though it's less exact than writing, say, \"using CBlockPolicyEstimator::estimateSmartFee in src/fees.cpp\". I don't feel strongly about it though. ",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-11-02T12:45:26Z",
      "diff_hunk" : "@@ -3373,7 +3376,7 @@ static RPCHelpMan bumpfee_helper(std::string method_name)\n         \"The command will pay the additional fee by reducing change outputs or adding inputs when necessary. It may add a new change output if one does not already exist.\\n\"\n         \"All inputs in the original transaction will be included in the replacement transaction.\\n\"\n         \"The command will fail if the wallet or mempool contains a transaction that spends one of T's outputs.\\n\"\n-        \"By default, the new fee will be calculated automatically using estimatesmartfee.\\n\"\n+        \"By default, the new fee will be calculated automatically using the estimatesmartfee RPC.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r515946353",
      "id" : 515946353,
      "in_reply_to_id" : 515729855,
      "line" : 3379,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk0NjM1Mw==",
      "original_commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "original_line" : 3379,
      "original_position" : 53,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 53,
      "pull_request_review_id" : 521594655,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-02T12:45:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/515946353",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> @Xekyo You can run them in parallel; if you have sufficient RAM pretty extremely even. `test_runner.py -j60` works fine on my 4-core 32 GiB RAM system, taking 3m46s. A lot of the time consists of processes waiting for each other, so it's not actually CPU bound.\r\n\r\nI have a sloow 4-core 32GB RAM laptop and `test/functional/test_runner.py -j60` does run much faster--good tip.",
      "created_at" : "2020-11-02T12:50:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-720452130",
      "id" : 720452130,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMDQ1MjEzMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-02T12:50:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/720452130",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thank you @Xekyo, @kallewoof and @meshcollider!",
      "created_at" : "2020-11-04T08:42:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#issuecomment-721593631",
      "id" : 721593631,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20220",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMTU5MzYzMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-04T08:42:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/721593631",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r517817389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/517817389"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Yes, there seems to be a bug in the `send` RPC: per the code in `wallet/rpcwallet.cpp`, these should behave the same whether passed as an arg or an option, but they do not.\r\n\r\nFixed in #20305.",
      "commit_id" : "0be29000c011dec0722481dbebb159873da6fa54",
      "created_at" : "2020-11-05T06:26:53Z",
      "diff_hunk" : "@@ -246,19 +250,61 @@ def run_test(self):\n         res = w2.walletprocesspsbt(res[\"psbt\"])\n         assert res[\"complete\"]\n \n-        self.log.info(\"Set fee rate...\")\n+        self.log.info(\"Test setting explicit fee rate\")\n+        res1 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=1, arg_estimate_mode=\"economical\", add_to_wallet=False)\n+        res2 = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=1, estimate_mode=\"economical\", add_to_wallet=False)\n+        assert_equal(self.nodes[1].decodepsbt(res1[\"psbt\"])[\"fee\"], self.nodes[1].decodepsbt(res2[\"psbt\"])[\"fee\"])\n+\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.00007, estimate_mode=\"btc/kb\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00007\"))\n+\n         res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=2, estimate_mode=\"sat/b\", add_to_wallet=False)\n         fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n         assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00002\"))\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=\"sat/b\",\n-                       expect_error=(-3, \"Amount out of range\"))\n-        # Fee rate of 0.1 satoshi per byte should throw an error\n-        # TODO: error should use sat/b\n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=\"sat/b\",\n-                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n \n-        self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.000001, estimate_mode=\"BTC/KB\",\n-                       expect_error=(-4, \"Fee rate (0.00000100 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=0.00004531, arg_estimate_mode=\"btc/kb\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00004531\"))\n+\n+        res = self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=3, arg_estimate_mode=\"sat/b\", add_to_wallet=False)\n+        fee = self.nodes[1].decodepsbt(res[\"psbt\"])[\"fee\"]\n+        assert_fee_amount(fee, Decimal(len(res[\"hex\"]) / 2), Decimal(\"0.00003\"))\n+\n+        # TODO: This test should pass with all modes, e.g. with the next line uncommented.\n+        # for mode in [\"unset\", \"economical\", \"conservative\", \"btc/kb\", \"sat/b\"]:\n+        for mode in [\"btc/kb\", \"sat/b\"]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=-1, estimate_mode=mode,\n+                expect_error=(-3, \"Amount out of range\"))\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0, estimate_mode=mode,\n+                expect_error=(-4, \"Fee rate (0.00000000 BTC/kB) is lower than the minimum fee rate setting (0.00001000 BTC/kB)\"))\n+\n+        for mode in [\"foo\", Decimal(\"3.141592\")]:\n+            self.test_send(from_wallet=w0, to_wallet=w1, amount=1, conf_target=0.1, estimate_mode=mode,\n+                expect_error=(-8, \"Invalid estimate_mode parameter\"))\n+            # TODO: these 2 equivalent sends with an invalid estimate_mode arg should both fail, but they do not...why?\n+            # self.test_send(from_wallet=w0, to_wallet=w1, amount=1, arg_conf_target=0.1, arg_estimate_mode=mode,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20220#discussion_r517817389",
      "id" : 517817389,
      "in_reply_to_id" : 513747612,
      "line" : 286,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzgxNzM4OQ==",
      "original_commit_id" : "328ac2b0a32d2fa3696778681e71813a4deda663",
      "original_line" : 286,
      "original_position" : 68,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : 69,
      "pull_request_review_id" : 523955849,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20220",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-05T06:26:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/517817389",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
