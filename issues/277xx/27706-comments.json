[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "cc: @Davidson-Souza",
      "created_at" : "2023-05-20T11:38:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555893035",
      "id" : 1555893035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27706",
      "node_id" : "IC_kwDOABII585cvQsr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555893035/reactions"
      },
      "updated_at" : "2023-05-20T11:38:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555893035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Short IDs, as they are specified in BIP 152, cannot be computed in advance because their formula includes a block header (and a random nonce) in addition to a transaction content.",
      "created_at" : "2023-05-20T12:45:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555904229",
      "id" : 1555904229,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27706",
      "node_id" : "IC_kwDOABII585cvTbl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555904229/reactions"
      },
      "updated_at" : "2023-05-20T12:45:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555904229",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73423761?v=4",
         "events_url" : "https://api.github.com/users/pavel-vasin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pavel-vasin/followers",
         "following_url" : "https://api.github.com/users/pavel-vasin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pavel-vasin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pavel-vasin",
         "id" : 73423761,
         "login" : "pavel-vasin",
         "node_id" : "MDQ6VXNlcjczNDIzNzYx",
         "organizations_url" : "https://api.github.com/users/pavel-vasin/orgs",
         "received_events_url" : "https://api.github.com/users/pavel-vasin/received_events",
         "repos_url" : "https://api.github.com/users/pavel-vasin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pavel-vasin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pavel-vasin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pavel-vasin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yeah, what @pavel-vasin says.\n\nSalting the hash computation using the block header is needed to prevent intentional collisions, and is the price for using short ids.",
      "created_at" : "2023-05-20T12:57:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555906319",
      "id" : 1555906319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27706",
      "node_id" : "IC_kwDOABII585cvT8P",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555906319/reactions"
      },
      "updated_at" : "2023-05-20T12:57:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555906319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Makes sense, thanks for the clarification!",
      "created_at" : "2023-05-20T13:56:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555917084",
      "id" : 1555917084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27706",
      "node_id" : "IC_kwDOABII585cvWkc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555917084/reactions"
      },
      "updated_at" : "2023-05-20T13:56:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555917084",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@pavel-vasin Yes, you're right. The compact block relay design, as it currently exists, does not permit pre computations.\r\n\r\n> Salting the hash computation using the block header is needed to prevent intentional collisions, and is the price for using short ids.\r\n\r\nDoes it really need to be the block header? If we kept a random, per connection byte-array used for salting, how could an attacker cause intentional collisions?\r\n\r\n(Thinking outside BIP152 context) If we hold a per connection salt, and a rolling hash map for mempool transactions, we could avoid the mempool iteration entirely. Since we only keep a few high-bandwidth connections, and hash sets are very small, it's not really a memory usage penalty, IMO. If our peer misbehave, we can detect it, once they would create an uncommon number of collisions.\r\n\r\nI guess a first good step would be benchmarking this code path, and see how it impacts the whole block compact propagation logic.",
      "created_at" : "2023-05-20T15:01:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1555930857",
      "id" : 1555930857,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27706",
      "node_id" : "IC_kwDOABII585cvZ7p",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555930857/reactions"
      },
      "updated_at" : "2023-05-20T22:58:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1555930857",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/40968167?v=4",
         "events_url" : "https://api.github.com/users/Davidson-Souza/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Davidson-Souza/followers",
         "following_url" : "https://api.github.com/users/Davidson-Souza/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Davidson-Souza/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Davidson-Souza",
         "id" : 40968167,
         "login" : "Davidson-Souza",
         "node_id" : "MDQ6VXNlcjQwOTY4MTY3",
         "organizations_url" : "https://api.github.com/users/Davidson-Souza/orgs",
         "received_events_url" : "https://api.github.com/users/Davidson-Souza/received_events",
         "repos_url" : "https://api.github.com/users/Davidson-Souza/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Davidson-Souza/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Davidson-Souza/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Davidson-Souza"
      }
   },
   {
      "author_association" : "NONE",
      "body" : ">Does it really need to be the block header? If we kept a random, per connection byte-array used for salting, how could an attacker cause intentional collisions?\r\n\r\nIf PoW or something similarly strong is not involved then the attacker can create collisions for a chosen set of nonces. An algorithm of the attack is straightforward:\r\n1. Connect to a next victim\r\n2. Negotiate a nonce\r\n3. Bruteforce transactions that collide under the nonce\r\n4. Go to step 1",
      "created_at" : "2023-05-21T09:11:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1556126859",
      "id" : 1556126859,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27706",
      "node_id" : "IC_kwDOABII585cwJyL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1556126859/reactions"
      },
      "updated_at" : "2023-05-21T09:11:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1556126859",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73423761?v=4",
         "events_url" : "https://api.github.com/users/pavel-vasin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pavel-vasin/followers",
         "following_url" : "https://api.github.com/users/pavel-vasin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pavel-vasin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pavel-vasin",
         "id" : 73423761,
         "login" : "pavel-vasin",
         "node_id" : "MDQ6VXNlcjczNDIzNzYx",
         "organizations_url" : "https://api.github.com/users/pavel-vasin/orgs",
         "received_events_url" : "https://api.github.com/users/pavel-vasin/received_events",
         "repos_url" : "https://api.github.com/users/pavel-vasin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pavel-vasin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pavel-vasin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pavel-vasin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok. Closing for now. Discussion can continue, but it's not clear why this is an issue. General questions /discussion can also be asked/happen in IRC etc.",
      "created_at" : "2023-05-22T08:56:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27706#issuecomment-1556818802",
      "id" : 1556818802,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27706",
      "node_id" : "IC_kwDOABII585cyyty",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1556818802/reactions"
      },
      "updated_at" : "2023-05-22T08:56:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1556818802",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
