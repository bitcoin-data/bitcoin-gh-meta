[
   {
      "body" : "Have you measured that this improves your propagation time more than just\nconnecting to a few fast peers? By the time you have sent out your block to\n100 well-connected peers, the last ones to get it likely could have already\ngotten it from eachother faster than from you, as more fast peers means you\nsuddenly need to do a lot more work to keep up with the sudden burst of\nnetwork packets to broadcast the block.\n\nIn any case, I do not think this serves the best interests of users of the\nsoftware. We have had several cases of people thinking that more\nconnections means faster confirmations of their transactions, or \"better\nvalidated\" blocks.\n\nIn the past we have also seen problems with the network running out of\nconnectable slots, so we have actively avoided options for people to\noverwelm the network with connections. I'm very aware an attacker could do\nthis anyhow, but this is more about preventing people from hurting the\nnetwork while incorrectly believing it benefits them (for non-miners, a\nsingle connection to a non-compromised is as good as any higher number).\n\nI believe this equally would not actually benefit you.\n",
      "created_at" : "2015-04-15T04:40:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93185470",
      "id" : 93185470,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T04:40:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93185470",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Pool servers typically are run from datacenter grade gigabit connections or better so I don't think bandwidth is that big of an issue most of the time. My pool server with nearly 6000 active miner connections is normally running at under 5% CPU usage total for all applications at nearly any time, this includes bitcoind, stratum server, database, web front end and relay node. I don't really see what type of resource bottleneck I would be running into.\r\n\r\nUnless a pool server is expected to run with 8 or less connections total I think that increasing the max outbound to match the max connections would help ensure that the pool is only connecting to well connected nodes rather than nodes behind NAT that would propagate slower(more hops required). The other issue is that even when allowing inbound connections it is difficult to reach the the default max of 125. I haven't been able to test this myself but I don't see why this change wouldn't help. When starting up a pool server it takes a long time to start getting more connections than the initial 8.\r\n\r\nI agree this option could cause problems if too many people enabled it, but I think we need a better solution than just hard coding the outbound connection count to be 8(I think hard-coding arbitrary variables is a bad idea). Do you have any ideas on how one might go about making this option hard for people not running pools to enable? I don't want to maintain a fork of bitcoin just because someone decided to hard code one variable. Maybe force the user to add \"-isweariamactuallyrunningaminingpool\" to their config in order to enable this option.",
      "created_at" : "2015-04-15T05:13:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93191485",
      "id" : 93191485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T05:13:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93191485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "Making it easily possible to increase the default outgoing connections above 8 would put undue load on the network. See the discussion in #4687 as well as many previous discussions.\r\n\r\nIf you want lots of connections, raise the maximum number of incoming connections instead. I have no trouble on my longer running nodes to get lots of incoming connections. \"NAT restricted\" doesn't change much, I'd hope that the larger pool servers won't be running on someone's home network (but even on my home network the router's port forwarding doesn't seem to impose a low connection limit).",
      "created_at" : "2015-04-15T08:08:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93253349",
      "id" : 93253349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T08:14:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93253349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Would it really cause an issue if it was only pool servers that were increasing this limit? It seems this option can be beneficial to pool operators but its not being considered because nobody trusts the users. I'm not a fan of crippling software because someone *might* abuse a feature. The comment in that discussion is only talking about regular users and regular nodes and doesn't seem apply to this use case. \r\n\r\nFrom what I've been reading its been historically common for pool operators to override this option in order to improve connectivity. I'm also wondering who came up with 8 as the default for outbound connections and 125 as the default max connection limit? 8 and 125 are pretty specific numbers and it would be good to know how people came up with them. \r\n\r\nOne other thing I'm wondering is why bitcoind can't just establish thousands of connections like other p2p protocols can? Is the core networking code just in really bad shape or is it something else?",
      "created_at" : "2015-04-15T08:35:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93261239",
      "id" : 93261239,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T08:35:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93261239",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "bitcoind's network code can deal with around 1000 connections, due to the file descriptor limits of select().\r\n",
      "created_at" : "2015-04-15T10:14:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93303190",
      "id" : 93303190,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T10:14:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93303190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "The reason for the default restriction of 125 is to \r\n- cope with shitty routers that crash with lots of connections\r\n- bound the memory usage; every active connection will have send/receive buffers and some other associated data\r\n\r\nIf these are not concerns for you, you can increase the number of incoming connections up to the select limit (as @sipa mentions).",
      "created_at" : "2015-04-15T11:43:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93344202",
      "id" : 93344202,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T11:43:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93344202",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Anyhow, if you trust yourself enough to not abuse this feature you can remove the cap in your local builds. This is open source and there's nothing 'we' can do to prevent you from that (although there are some ideas with regard to banning mass connectors*) . But this can not be merged unless you cap the maximum to 8.\r\n\r\n*: not because of you, but the other, malicious use case for mass connecting are 'listening nodes' that try to subvert privacy by correlation of transaction origins (see #3828)\r\n",
      "created_at" : "2015-04-15T11:46:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93346755",
      "id" : 93346755,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T11:53:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93346755",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@sipa it is common for pool servers and other servers with lots of connections to override the OS file descriptor limitation, maybe moving to something libevent based for networking would help scalability.\r\n\r\n@laanwj so that more or less explains why 125 is set as the default for inbound but I have yet to hear where the number 8 comes from and why it is hard coded.\r\n\r\nOne other use case may be for pools that are NAT restricted for reasons outside of their control such as being on farm sites where only wireless internet is available in countries with unreliable backbones. If a pool gets NAT restricted then it gets stuck at the 8 outbound connection limitation which seems far less than ideal. In addition during start-up incoming connections can take a very long time to get anywhere close to 125 even on pools without NAT restrictions.",
      "created_at" : "2015-04-15T22:35:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93588268",
      "id" : 93588268,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T22:35:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93588268",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "There was a long discussion on IRC yesterday about why its probably bad even for a pool server to increase the limit significantly. I'm assuming that was you? If not, you should go read it. http://bitcoinstats.com/irc/bitcoin-dev/logs/2015/04/14#l1429040973",
      "created_at" : "2015-04-15T23:10:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93593735",
      "id" : 93593735,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T23:10:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93593735",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt Yes that was me, how would you go about calculating the ideal number of connections a pool server should make in cases where manually establishing connections to trusted nodes is not possible?",
      "created_at" : "2015-04-15T23:14:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93594599",
      "id" : 93594599,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T23:14:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93594599",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "A pool server should run its mining bitcoind behind a firewall with only connections to other bitcoinds, which are making 8 outgoing connections and accepting other connections, as well as a connection to the relay network (and maybe other similar networks...if someone set them up). But, really, this is not the place to discuss pool architecture.",
      "created_at" : "2015-04-15T23:19:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93595340",
      "id" : 93595340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-15T23:19:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93595340",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt In areas with poor internet connectivity such as China where mining sites and operators aren't able to reliably set up their own offsite nodes I think a better solution such as this is often needed. The outbound connection limit of 8 just seems very arbitrary. Your suggestion of running multiple nodes seems to itself be a workaround to getting more than 8 outbound connections to the bitcoin network since its basically running more nodes as a way to increase bitcoind's arbitrary connection limitation. \r\n\r\nFor example I don't see how running 5 nodes with the default limitations of 8 outbound connections each and 125 inbound connections each for a total of 40 outbound and 625 inbound connections would be all that different from just running a single node with 40 outbound and 625 inbound connections allowed. The current bitcoind design encourages people to run a whole lot of small nodes on low resource systems instead of using larger more powerful systems that could perform much better by providing a high performance backbone for the bitcoin network.",
      "created_at" : "2015-04-16T00:12:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93603754",
      "id" : 93603754,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-16T00:12:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93603754",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "NAK.\r\n\r\nIncreasing the connection count in abusive to the network, it consumes third party resources and without actual reason.  Measurements I performed with p2pool users about a year an a half ago or so showed that cranking the outbound count also _increased_ the propagation time.  (But even if it did decrease it, it wouldn't hold a candle to the improvement from simply better relay systems such as the block relay network)\r\n\r\nExposing a pool server's bitcoin node directly to the outside world is a known-bad-practice which will pretty reliably result in DOS attacks. Continuing to ignore professional advice based on years of experience is at your own peril.\r\n\r\nExisting users are already actively banning single nodes that are mass connecting to users and I expect this practice to become more common in the future (especially once I publish the private set intersection tools that enable people to safely perform such blocking at scale and without centralization). \r\n\r\nMatt's suggestion about multiple nodes is very much not a suggestion about the connection limits, its a suggestion about establishing a trusted topology that gives you a reliably exponentially growing cone of propagation as far as possible and minimizing risks from stalled connections blocking the pipeline.  ",
      "created_at" : "2015-04-16T23:38:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93862664",
      "id" : 93862664,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-16T23:39:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93862664",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell I don't really see why increasing outbound connections would increase propagation time unless some sort of resource was being constrained such as CPU RAM, disk IO or network capacity, unless their was some sort of flaw or scalability limitation in the networking code.\r\n\r\nThis would seem to only be an issue if there were flaws in bitcoind's networking code more than anything, if someone is able to block data transfers by say keeping connections open that should be fixed in bitcoind possibly by redesigning the networking to function asynchronously. Allowing more outbound connections would actually make fire-walling easier as you wouldn't have to have an open port on a pool server in order to have over 8 connections(I still have yet to hear how the number 8 was calculated). In any case bitcoind can usually be run off of an alternate IP address even if its on the same server.\r\n\r\nI really don't see this accomplishing much for a number of reason, for one thing ipv6 will make it more difficult to target ban IP's and its also not that hard to get a lot of IPv4 addresses either on a datacenter connection for cheap. Right now there doesn't seem to be any way to properly make use of high throughput or high resource servers.\r\n\r\nThis sounds to be more of a design flaw in bitcoind's networking code, you shouldn't be able to stall connections like that in a properly designed web application server. It would be really bad for a pool server if a stalled stratum connection blocked all the others, but pool software is designed not to let that happen. Its the same way with modern web servers like nginx.",
      "created_at" : "2015-04-17T00:43:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93869372",
      "id" : 93869372,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T00:43:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93869372",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "Even with a 10 Gbit/s connection, when serving 100 connections, at least\none of them will only receive a 1 Mbyte block after 100ms (because it takes\nthat long to pump 100*1 Mbyte through your line). In 100 milliseconds, the\nfirst of your peers could already have relayed it to a dozen peers.\n\nThat's under perfect conditions, where there is no software and operating\nsystem overhead from the sudden load of packets.\n",
      "created_at" : "2015-04-17T08:54:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93946854",
      "id" : 93946854,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T08:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93946854",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa In your calculation you are ignoring a lot of real world factors. First of which is that receiving 1 Mbyte of data over 100ms requires a connection with a minimum of about 80 megabits a seconds of bandwidth which the vast majority of connected peers will not have. In addition most of those peers will probably be on residential grade connections where their upload speed is generally significantly slower than their download so their relay speeds will be far slower than that of a pool server. Those peers will also have a validation step themselves which will add delay. Most of those peer will also only have 8 connections themselves so there will be more intermediary validation and relay steps needed. \r\n\r\nIn any case this could all be optimized around by having bitcoind not upload to more peers than there is bandwidth for at any one time in order to sure it gets out to as many peers as quickly as possible before sending to the next set of connections it has. I don't see link saturation being much of a bottleneck on datacenter grade connections unless there is an issue unless there are issues with bitcoind's networking code.\r\n\r\nThe problem right now is that after a pool server sends out blocks to its very small list of directly connected peers all of its connections go idle and any excess bandwidth gets wasted. Keeping the connections near max throughput is a good thing since blocks can propagate to a lot of nodes far faster than just uploading to a few and then not doing anything after. Even a 100 megabit symmetric datacenter connection will probably have 20 times the upload capacity of a typical residential cable connection. Using your example and assuming an average upload speed of 8 megabits a second per connected peer with 8 connections to the pool server it would take each peer 8 seconds to propagate a 1Mbyte block to 8 of their own connected peers for about 64 peers total after 8 seconds and this would still be far less than a single server connected to 100 peers on a high bandwidth line could do, 100ms to 100 peers in your example on a 10Gbit/s line vs 64 peers in 8 seconds if you only send to 8 peers. It's this initial propagation step that seems to be the bottleneck for block propagation.\r\n\r\nIf the propagation speeds can't be optimized then it encourages pools to mine less transactions into their blocks to reduce the size and speed propagation. This is something that has been done before.",
      "created_at" : "2015-04-17T09:45:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93954142",
      "id" : 93954142,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T09:45:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93954142",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "I understand your reasoning, and I agree that in theory, the network topology could be improved by having nodes with better connectivity connect to more nodes (which they already do) and peer preferentially with eachother (which you also already can do, with -addnode). With my numbers I tried to show that there are cases where you're better off relaying to fewer peers; I agree they're overly simplistic though.\r\n\r\nI however, don't think it will matter in practice. You're already using a system which relays far faster than the P2P protocol because it was specifically optimized for it (the block relay network), through which you'll likely reach a significant portion of miners faster anyway. And more work is being done to research faster relay protocols with lower bandwidth usage (look up @gavinandresen's IBLT based relay, or @gmaxwell's block network coding), which perhaps may end up being part of the P2P protocol.\r\n\r\nI'm personally interested in seeing what propagation speeds and/or orphan rate changes you'd see from connecting out to more nodes, and you're free to run a private patch for it. I don't think we want it in Bitcoin Core, though, sorry.",
      "created_at" : "2015-04-17T10:01:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93956897",
      "id" : 93956897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T10:01:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93956897",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa One major issue with the block relay network right now I think is China and their unreliable network topography where you sometimes have to rely exclusively on bitcoind's ability to establish connections automatically. While efforts like IBLT and other similar optimizations may help I think they are just delaying a lot of needed improvements in bitcoind's core p2p networking code. \r\n\r\nThe C10k has been solved in plenty of server applications before and I think that fixing it in bitcoind should be a priority. If high end servers can support thousands of connections I don't think we then have any need to enforce connection caps and banning nodes that make too many connections. Solving network connection scalability to me sounds like an easy first step since there are already well known examples of how it can be done.\r\n\r\nUnfortunately the pools I run(non-public private pools) don't find enough blocks for me to do any meaningful statistical analysis on orphan rates, is there currently any way to measure propagation speeds reliably on the bitcoin network? I'm also really weary of maintaining my own fork of bitcoind just so that an arbitrary static variable can be overwritten mainly since my application programming skills are very limited which is why I would like some way to flag the outbound connection limit without having to recompile bitcoind.\r\n\r\nI don't think this is much of an issue for western based pools that use the block relay network but I'm far more worried about China where these types of things don't always get set up or work properly due to their network issues.",
      "created_at" : "2015-04-17T10:33:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93961370",
      "id" : 93961370,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T10:33:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93961370",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : ">  I think they are just delaying\r\n\r\nWhat is the basis of this belief?\r\n\r\n> I'm also really weary of maintaining my own fork of bitcoind\r\n\r\nYou should be-- your patch is incomplete.\r\n\r\n> One major issue with the block relay network right now I think is China \r\n\r\nWhat is the basis of this belief?\r\n\r\n> have to rely exclusively on bitcoind's ability to establish connections\r\n\r\nNo, they're not limited to bitcoind's connectivity; e.g. block relay network, manual topology configuration.\r\n\r\n> Unfortunately the pools I run\r\n\r\nIf you're concerned about the orphan rates, you should be running the relay network client.\r\n\r\n>  can support thousands of connections\r\n\r\nIt's not a question of supporting thousands of connections. Parallelism reduces the goodput of the network due to redundant transmissions as bitcoin is a flooding network.  \r\n\r\nAs was explained on IRC, adjusting the first nodes connection count is at best optimizing the linear part of an exponential. It has diminishing returns; and in reality both due to attack exposure and because blocks take time to transmit and don't move further (and are not preferred) until they are complete running high connection counts on nodes has been observed in practice to increase orphan rates (as would also be expected from the theory).\r\n",
      "created_at" : "2015-04-17T11:06:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93965836",
      "id" : 93965836,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:11:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93965836",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "> I think they are just delaying\r\n\r\nSee #5307, #5971, #5941, #5976, #5875, #5989, #5820, #5662, #4468 for P2P improvements in the past few months.\r\n",
      "created_at" : "2015-04-17T11:29:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93968850",
      "id" : 93968850,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:29:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93968850",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "> What is the basis of this belief?\r\n\r\nThe outbound connection limit hasn't been change from 8 for years and there doesn't seem to have much progress towards enabling nodes to support very large amounts of connections, I think this would be a better area to focus effort rather than just trying to block nodes that establish many connections.\r\n\r\n> You should be-- your patch is incomplete.\r\n\r\nThis is exactly the reason I want this to be merged in properly.\r\n\r\n> What is the basis of this belief?\r\n\r\nFirewall delays in addition to contact with pool operators there, it would be interesting to do some statistical analysis on orphan rates by region by analyzing which regions are involved in the race and which region ultimately finds the block that ends the race.\r\n\r\n> No, they're not limited to bitcoind's connectivity; e.g. block relay network, manual topology configuration.\r\n\r\nThe firewall can be unpredictable which is why in certain cases manual configuration is and relay network is not always possible.\r\n\r\n> If you're concerned about the orphan rates, you should be running the relay network client.\r\n\r\nI do run it myself but I think this would improve connectivity in China for pools which would require them to have this option.\r\n\r\n> It's not a question of supporting thousands of connections. Parallelism reduces the goodput of the network due to redundant transmissions; bitcoin is a flooding network.\r\n\r\nThis option is most important for the initial generated block propagation, but I think there are still a lot of things that can be done to improve connectivity overall. Methods to reduce redundant transmissions may be needed but I don't think that's anything all that revolutionary as its something other p2p networks employ.",
      "created_at" : "2015-04-17T11:29:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93968860",
      "id" : 93968860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:29:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93968860",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "> See #5307, #5971, #5941, #5976, #5875, #5989, #5820, #5662, #4468 for P2P improvements in the past few months.\r\n\r\nI meant more along the lines of connection count scalability rather than the protocol scalability improvements.",
      "created_at" : "2015-04-17T11:35:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93969491",
      "id" : 93969491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:35:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93969491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "You keep arguing that the way to optimize propagation is by having more connections. No, we are not working on increasing that, or being able to increase that, because we don't believe it matters in practice - or may matters worse (increase misunderstanding, risk people believing they help while hurting, increase wasted bandwidth and connections).\r\n\r\nThere is a lot of work being done to optimize propagation, which does not rely on blowing up resource usage (I consider available network connections as a resource).\r\n",
      "created_at" : "2015-04-17T11:37:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93969731",
      "id" : 93969731,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:40:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93969731",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "> The outbound connection limit hasn't been change from 8 for years\r\n\r\nIncreasing it is undesirable. Doing so would harm throughput, capacity, and cost of the network without any corresponding improvement. The connection count is necessary to reduce the probability of partitioning; which is exponentially related to the count.\r\n\r\n> The firewall can be unpredictable \r\n\r\nSo you have no basis for your beliefs-- they're just conjecture?\r\n\r\n> which would require them to have this option\r\n\r\nThis would harm their propagation.\r\n\r\n> but I think there are still a lot of things that can be done to improve connectivity overall\r\n\r\nSure. But this is the wrong direction.\r\n\r\n> as its something other p2p networks employ\r\n\r\nI'm not aware of any comparable with similar requirements or mechanisms. \r\n\r\nYou appear to just be interested in arguing, but you are doing so from a position of ignorance.  All this is accomplishing is irritating the folks who've spent a fair amount of time trying to assist and educate you. ",
      "created_at" : "2015-04-17T11:41:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93970259",
      "id" : 93970259,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:41:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93970259",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "> You keep arguing that the way to optimize propagation is by having more connections. No, we are not working on increasing that, or being able to increase that, because we don't believe it matters in practice at this point.\r\n> \r\n> There is a lot of work being done to optimize propagation, which does not rely on blowing up resource usage (I consider available network connections as a resource).\r\n\r\nImproving propagation via other means is good thing but overall but I don't think its a good idea to completely ignore connection count scalability. Each can benefit the other.",
      "created_at" : "2015-04-17T11:41:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93970297",
      "id" : 93970297,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:41:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93970297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "> I don't think its a good idea to completely ignore connection count scalability. Each can benefit the other.\r\n\r\nLet me try repeating this with different but technically accurate language.\r\n\r\n\"I think its a good idea for every link in the network to repeat the same network, so that each peer ends up with as many redundantly transmitted copies as they have connections, and have every peer maintain a TCP connection to every other, so the whole network has N^2 traffic; and I expect the increase of traffic from nearly linear in node count to quadratic to somehow improve propagation\".\r\n",
      "created_at" : "2015-04-17T11:44:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93970577",
      "id" : 93970577,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:44:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93970577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "> Let me try repeating this with different but technically accurate language.\r\n> \r\n> \"I think its a good idea for every link in the network to repeat the same network, so that each peer ends up with as many redundantly transmitted copies as they have connections, and have every peer maintain a TCP connection to every other, so the whole network has N^2 traffic; and I expect the increase of traffic from nearly linear in node count to quadratic to somehow improve propagation\".\r\n\r\nNo properly designed p2p system should be transmitting redundant data merely having lots of established connections in and of itself shouldn't create any significant traffic.\r\n\r\n\r\n\r\n> So you have no basis for your beliefs-- they're just conjecture?\r\n\r\nThey change it all the time and do packet manipulation as well....this isn't exactly new.\r\n\r\n\r\n\r\n> I'm not aware of any comparable with similar requirements or mechanisms.\r\n\r\nSystems like bittorrent and other file transfer protocols generally don't duplicate data transmissions. \r\n\r\n\r\n> You appear to just be interested in arguing, but you are doing so from a position of ignorance. All this is accomplishing is irritating the folks who've spent a fair amount of time trying to assist and educate you.\r\n\r\nI'm not as familiar with bitcoind's networking design as some but I'm trying to get as clear a picture as possible why certain design decisions were made and what improvements can be made.\r\n\r\n\r\n\r\n> Increasing it is undesirable. Doing so would harm throughput, capacity, and cost of the network without any corresponding improvement. The connection count is necessary to reduce the probability of partitioning; which is exponentially related to the count.\r\n\r\nI suspect there may be already some of this going on in China, not fully separated but a situation where Chinese pools have a higher chance of confirming blocks that originate in China with the same thing happening for pools outside of China. It would be interesting to do a statistical analysis on this by comparing outcomes of block races.",
      "created_at" : "2015-04-17T11:57:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93972369",
      "id" : 93972369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T11:57:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93972369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "> > I'm not aware of any comparable with similar requirements or mechanisms.\r\n> Systems like bittorrent and other file transfer protocols generally don't duplicate data transmissions. \r\n\r\nBittorrent is not a flood network, and does not have latency reduction as a goal.\r\n\r\nBlock propagation in Bitcoin must reach every node, and must minimize the time to reach a majority. That means that there is a fundamental compromise to be made between latency and bandwidth. You can do more negotiation about who is going to send what to whom (at the cost of more roundtrips), or you can choose to just send things, and have the receiver drop redundant data.\r\n\r\nBitcoin's P2P network today advertises new blocks by their hash in an inv message, and has the peer query the data if they need it. This means that over every link, 1 or 2 invs for every block will be sent (2 if they cross each other). Invs are cheap, but just blowing up the number of links will inevitably lead to a proportional number of packets being sent (and processed) over the network for every block.\r\n\r\nThe relay network does not have this extra advertisement step, and thus avoids an extra round trip + processing step, at the cost of potential duplicate block transmission (which is lower, due to it not sending blocks in full), and requiring central control (a hub) to make it efficient.",
      "created_at" : "2015-04-17T12:22:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-93975453",
      "id" : 93975453,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T12:23:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93975453",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa I'm guessing Invs can be considered negligible resource wise since they are just message advertizements, at least in the case of a block announcement where all of them should be roughly uniform. From working with stratum servers it seems there are very little system or network resources needed to transmit small messages if they are all coming from the same in memory data source as it has been shown that stratum can easily scale to over 10k connections.\r\n\r\nSo it sounds like invs are being used already as a de-duplication method so I'm not entirely sure what the issue there is.\r\n\r\nFrom the looks of it IBLT and block network encoding would make nodes themselves function in a manner similar to the relay network, am I understanding that correctly?\r\n\r\nI still see the option to increase outbound connections as useful since propagation is exponential and getting the initial block to as many peers as possible as fast as possible can lower overall propagation times even with other improvements such as IBLT or block network encoding.",
      "created_at" : "2015-04-17T16:58:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-94027096",
      "id" : 94027096,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-17T16:58:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/94027096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3298484?v=3",
         "events_url" : "https://api.github.com/users/jameshilliard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jameshilliard/followers",
         "following_url" : "https://api.github.com/users/jameshilliard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jameshilliard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jameshilliard",
         "id" : 3298484,
         "login" : "jameshilliard",
         "organizations_url" : "https://api.github.com/users/jameshilliard/orgs",
         "received_events_url" : "https://api.github.com/users/jameshilliard/received_events",
         "repos_url" : "https://api.github.com/users/jameshilliard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jameshilliard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jameshilliard"
      }
   },
   {
      "body" : "Closing this; there is clear consensus that increasing the number of outgoing connections beyond 8 is not a good idea and should not be supported without patching the code.",
      "created_at" : "2015-04-24T14:39:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6014#issuecomment-95951059",
      "id" : 95951059,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6014",
      "updated_at" : "2015-04-24T14:39:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/95951059",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
