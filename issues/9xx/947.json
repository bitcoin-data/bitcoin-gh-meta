{
   "active_lock_reason" : "resolved",
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "Currently, if a node is banned for misbehaviour the receive buffer, vRecv, is not cleared\nand ProcessMessages continues to process any further messages already received from the node.\n\nThus, if a node spams hundreds of messages and does not wait for a response, all the messages\nget processed, even if the node is banned after just a couple.\n\nThis patch clears the receive buffer when the socket is closed. Perhaps it should be done in Misbehaving() instead? But it seems logical that we never want to process messages from a disconnected node since we can't reply to them anyway.\n\nEDIT: Two things I forgot to mention:\n\nFirstly, I found this problem in litecoin, which is being actively attacked by spammers. I don't know for sure if bitcoin has this problem.\n\nSecondly, this won't do much alone, because there is very little code to actually ban bad nodes. I am experimenting with detecting bad behaviour - ie adding banning code, and that's how I noticed this.\n",
   "closed_at" : "2012-03-21T19:24:57Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=4",
      "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
      "followers_url" : "https://api.github.com/users/gavinandresen/followers",
      "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/gavinandresen",
      "id" : 331997,
      "login" : "gavinandresen",
      "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
      "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
      "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
      "repos_url" : "https://api.github.com/users/gavinandresen/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/gavinandresen"
   },
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/947/comments",
   "created_at" : "2012-03-18T03:09:01Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/947/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/947",
   "id" : 3697999,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/947/labels{/name}",
   "locked" : true,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MTAwMjQ1Ng==",
   "number" : 947,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/947.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/947",
      "merged_at" : "2012-03-21T19:24:57Z",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/947.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/947"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/947/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/947/timeline",
   "title" : "When disconnecting a node, the receive buffer should be cleared",
   "updated_at" : "2021-09-08T10:08:05Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/947",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/651970?v=4",
      "events_url" : "https://api.github.com/users/ali1234/events{/privacy}",
      "followers_url" : "https://api.github.com/users/ali1234/followers",
      "following_url" : "https://api.github.com/users/ali1234/following{/other_user}",
      "gists_url" : "https://api.github.com/users/ali1234/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/ali1234",
      "id" : 651970,
      "login" : "ali1234",
      "node_id" : "MDQ6VXNlcjY1MTk3MA==",
      "organizations_url" : "https://api.github.com/users/ali1234/orgs",
      "received_events_url" : "https://api.github.com/users/ali1234/received_events",
      "repos_url" : "https://api.github.com/users/ali1234/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/ali1234/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/ali1234/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/ali1234"
   }
}
