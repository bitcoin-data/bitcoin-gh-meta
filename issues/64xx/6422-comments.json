[
   {
      "body" : "As I've explained on IRC yesterday, offline builds *are* possible without manual patching.\r\n\r\n- Download the dependency sources manually or use `make download` (as mentioned)\r\n- Make sure that the git repositories with bitcoin (`https://github.com/bitcoin/bitcoin.git`) as well as the signatures (`https://github.com/bitcoin/bitcoin-detached-sigs.git`, only necessary for *signer.yml) are available locally, then to `gbuild` pass `--url bitcoin=${P1} --url signature=${P2}`. `P1` and `P2` must be set to the local paths of said repositories.\r\n\r\nAnything missing?\r\n",
      "created_at" : "2015-07-11T17:06:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#issuecomment-120645728",
      "id" : 120645728,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6422",
      "updated_at" : "2015-07-11T17:06:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/120645728",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Correcting the pullreq: I think it's valuable to provide at least some direction on doing an offline build. I suppose in the end there should also be either an offline apt-cacher-ng or one that's been torified but..",
      "created_at" : "2015-07-13T03:24:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#issuecomment-120796519",
      "id" : 120796519,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6422",
      "updated_at" : "2015-07-13T03:24:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/120796519",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/607777?v=3",
         "events_url" : "https://api.github.com/users/midnightmagic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/midnightmagic/followers",
         "following_url" : "https://api.github.com/users/midnightmagic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/midnightmagic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/midnightmagic",
         "id" : 607777,
         "login" : "midnightmagic",
         "organizations_url" : "https://api.github.com/users/midnightmagic/orgs",
         "received_events_url" : "https://api.github.com/users/midnightmagic/received_events",
         "repos_url" : "https://api.github.com/users/midnightmagic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/midnightmagic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/midnightmagic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/midnightmagic"
      }
   },
   {
      "body" : "I'd suppose when you provide apt-cacher-ng with all packages, it doesn't need to access any from the internet anymore. But I haven't checked.\r\n\r\nI suppose it would be possible to add socks support to apt-cacher-ng but torifying is most throughly and safely done by routing all of a user's network traffic through Tor using iptables.\r\n",
      "created_at" : "2015-07-14T10:51:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#issuecomment-121199031",
      "id" : 121199031,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6422",
      "updated_at" : "2015-07-14T10:51:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/121199031",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "After apt-cacher-ng is populated you must set it to be offline in its config file. Unfortunately it looks like the plain archive.ubuntu.com chokes up apt-cacher-ng as per:\r\n\r\nhttps://bugs.launchpad.net/ubuntu/+source/apt-cacher/+bug/1358883\r\n\r\nÃ¢ÂÂof all the weird things, but switching it to us.archive.ubuntu.com corrects this.\r\n\r\nOther than that, the --url bitcoin={},signature={} works well.",
      "created_at" : "2015-07-15T09:07:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#issuecomment-121538151",
      "id" : 121538151,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6422",
      "updated_at" : "2015-07-15T09:08:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/121538151",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/607777?v=3",
         "events_url" : "https://api.github.com/users/midnightmagic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/midnightmagic/followers",
         "following_url" : "https://api.github.com/users/midnightmagic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/midnightmagic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/midnightmagic",
         "id" : 607777,
         "login" : "midnightmagic",
         "organizations_url" : "https://api.github.com/users/midnightmagic/orgs",
         "received_events_url" : "https://api.github.com/users/midnightmagic/received_events",
         "repos_url" : "https://api.github.com/users/midnightmagic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/midnightmagic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/midnightmagic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/midnightmagic"
      }
   },
   {
      "body" : "ACK\r\n",
      "created_at" : "2015-07-23T19:07:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#issuecomment-124213779",
      "id" : 124213779,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6422",
      "updated_at" : "2015-07-23T19:07:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/124213779",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6422#discussion_r37847010"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6422"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/37847010"
         }
      },
      "body" : "path? `/v/soft/btc/bitcoin/contrib/gitian-descriptors/gitian-osx.yml`",
      "commit_id" : "c73a8ea2718b597dfbb8948deb8d14a0d74c4d8f",
      "created_at" : "2015-08-25T09:15:14Z",
      "diff_hunk" : "@@ -52,28 +67,44 @@ Release Process\n  \n \ttar -C /Volumes/Xcode/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/ -czf MacOSX10.9.sdk.tar.gz MacOSX10.9.sdk\n \n-###Optional: Seed the Gitian sources cache\n+###Optional: Seed the Gitian sources cache and offline git repositories\n \n-  By default, gitian will fetch source files as needed. For offline builds, they can be fetched ahead of time:\n+By default, gitian will fetch source files as needed. To cache them ahead of time:\n \n \tmake -C ../bitcoin/depends download SOURCES_PATH=`pwd`/cache/common\n \n-  Only missing files will be fetched, so this is safe to re-run for each build.\n+Only missing files will be fetched, so this is safe to re-run for each build.\n+\n+Clone the detached-sigs repository:\n+\n+\tpopd\n+\tgit clone https://github.com/bitcoin/bitcoin-detached-sigs.git\n+\tpushd ./bitcoin-builder\n+\n+NOTE: Offline builds must use the --url flag to ensure gitian fetches only from local URLs.\n+For example: ./bin/bguild --url bitcoin=/path/to/bitcoin,signature=/path/to/sigs {rest of arguments}\n+The following gbuild invocations DO NOT DO THIS by default.\n \n-###Build Bitcoin Core for Linux, Windows, and OS X:\n+###Build (and optionally verify) Bitcoin Core for Linux, Windows, and OS X:\n   \n \t./bin/gbuild --commit bitcoin=v${VERSION} ../bitcoin/contrib/gitian-descriptors/gitian-linux.yml\n \t./bin/gsign --signer $SIGNER --release ${VERSION}-linux --destination ../gitian.sigs/ ../bitcoin/contrib/gitian-descriptors/gitian-linux.yml\n+\t./bin/gverify -v -d ../gitian.sigs/ -r ${VERSION}-linux ../bitcoin/contrib/gitian-descriptors/gitian-linux.yml\n \tmv build/out/bitcoin-*.tar.gz build/out/src/bitcoin-*.tar.gz ../\n+\n \t./bin/gbuild --commit bitcoin=v${VERSION} ../bitcoin/contrib/gitian-descriptors/gitian-win.yml\n \t./bin/gsign --signer $SIGNER --release ${VERSION}-win-unsigned --destination ../gitian.sigs/ ../bitcoin/contrib/gitian-descriptors/gitian-win.yml\n+\t./bin/gverify -v -d ../gitian.sigs/ -r ${VERSION}-win-unsigned ../bitcoin/contrib/gitian-descriptors/gitian-win.yml\n \tmv build/out/bitcoin-*-win-unsigned.tar.gz inputs/bitcoin-win-unsigned.tar.gz\n \tmv build/out/bitcoin-*.zip build/out/bitcoin-*.exe ../\n+\n \t./bin/gbuild --commit bitcoin=v${VERSION} ../bitcoin/contrib/gitian-descriptors/gitian-osx.yml\n \t./bin/gsign --signer $SIGNER --release ${VERSION}-osx-unsigned --destination ../gitian.sigs/ ../bitcoin/contrib/gitian-descriptors/gitian-osx.yml\n+\t./bin/gverify -v -d ../gitian.sigs/ -r ${VERSION}-osx-unsigned /v/soft/btc/bitcoin/contrib/gitian-descriptors/gitian-osx.yml",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#discussion_r37847010",
      "id" : 37847010,
      "original_commit_id" : "6563da18ad9f37fc34094eca1347286e67ecd394",
      "original_position" : 107,
      "path" : "doc/release-process.md",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6422",
      "updated_at" : "2015-09-17T21:27:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/37847010",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Corrected path.",
      "created_at" : "2015-08-27T03:35:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#issuecomment-135279791",
      "id" : 135279791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6422",
      "updated_at" : "2015-08-27T03:35:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135279791",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/607777?v=3",
         "events_url" : "https://api.github.com/users/midnightmagic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/midnightmagic/followers",
         "following_url" : "https://api.github.com/users/midnightmagic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/midnightmagic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/midnightmagic",
         "id" : 607777,
         "login" : "midnightmagic",
         "organizations_url" : "https://api.github.com/users/midnightmagic/orgs",
         "received_events_url" : "https://api.github.com/users/midnightmagic/received_events",
         "repos_url" : "https://api.github.com/users/midnightmagic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/midnightmagic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/midnightmagic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/midnightmagic"
      }
   },
   {
      "body" : "needs rebase to fix conflicts; looks ready to merge.",
      "created_at" : "2015-09-16T13:16:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#issuecomment-140739323",
      "id" : 140739323,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6422",
      "updated_at" : "2015-09-16T13:16:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/140739323",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Fixed a couple more spelling errors, re-read it. Should be okay as long as nothing big has changed in the build. At the very least, it has some more detail to help new users to get into gitian building, which is good I think.",
      "created_at" : "2015-09-17T21:28:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6422#issuecomment-141232964",
      "id" : 141232964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6422",
      "updated_at" : "2015-09-17T21:28:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/141232964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/607777?v=3",
         "events_url" : "https://api.github.com/users/midnightmagic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/midnightmagic/followers",
         "following_url" : "https://api.github.com/users/midnightmagic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/midnightmagic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/midnightmagic",
         "id" : 607777,
         "login" : "midnightmagic",
         "organizations_url" : "https://api.github.com/users/midnightmagic/orgs",
         "received_events_url" : "https://api.github.com/users/midnightmagic/received_events",
         "repos_url" : "https://api.github.com/users/midnightmagic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/midnightmagic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/midnightmagic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/midnightmagic"
      }
   }
]
