{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "When using a python bitcoin RPC client, I sometimes encounter errors like:\n\n```\n>>> proxy._call(\"getblock\", \"45b0efe24da4ed0f984a8808e04b584a78cedaa8b49ac9097f724d368d0871df\")\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/local/lib/python3.4/dist-packages/bitcoin/rpc.py\", line 142, in _call\n    'Content-type': 'application/json'})\n  File \"/usr/lib/python3.4/http/client.py\", line 1065, in request\n    self._send_request(method, url, body, headers)\n  File \"/usr/lib/python3.4/http/client.py\", line 1093, in _send_request\n    self.putrequest(method, url, **skips)\n  File \"/usr/lib/python3.4/http/client.py\", line 948, in putrequest\n    raise CannotSendRequest(self.__state)\nhttp.client.CannotSendRequest: Request-sent\n```\n\nWhen this error is received, I find that:\n- `bitcoin-cli` and other RPC clients cannot get bitcoind to respond, they hang\n- only way to kill bitcoind is to SIGKILL it?\n- RPC threads seem locked, syscalls were all waits or recvs\n- on testnet in this state, bitcoind continues normal p2p gossip\n\nReplication steps:\nhttps://gist.github.com/kanzure/57f1b50cf7fb82cc5c1a\n\nReplication steps summary:\n- `setgenerate true 1000`\n- when `setgenerate` is running, send another RPC request\n- kill the client that sent the other RPC request\n- when `setgenerate` is done, RPC will be unavailable\n- use `rpcthreads=1` to help see this behavor\n\nExpected behavior is that the RPC thread should eventually be available again.\n\nRelevant commits:\nhttps://github.com/bitcoin/bitcoin/commit/16a5c18cea7330bd68dc9d2f768eb518af88795b\nhttps://github.com/bitcoin/bitcoin/commit/7d2cb485116636595250fce4ea4eab16a877479b\n\nRelevant issues:\nhttps://github.com/bitcoin/bitcoin/pull/5655#issuecomment-70162936\n\nUsing `rpckeepalive=0` solves this problem, although the above commit messages make it sound like this is only a temporary fix. So hopefully others can replicate this problem now with the steps given above. Alternatively, #5677 should fix this too.\n\nFWIW, I was completely unable to determine that this was a keep-alive problem when I was receiving error messages. Only once I started reading commit history on the rpcserver file did I find that rpckeepalive was meant to help with this issue. So maybe this is a docs issue.....\n",
   "closed_at" : "2015-09-04T15:26:07Z",
   "closed_by" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/101238?v=4",
      "events_url" : "https://api.github.com/users/kanzure/events{/privacy}",
      "followers_url" : "https://api.github.com/users/kanzure/followers",
      "following_url" : "https://api.github.com/users/kanzure/following{/other_user}",
      "gists_url" : "https://api.github.com/users/kanzure/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/kanzure",
      "id" : 101238,
      "login" : "kanzure",
      "node_id" : "MDQ6VXNlcjEwMTIzOA==",
      "organizations_url" : "https://api.github.com/users/kanzure/orgs",
      "received_events_url" : "https://api.github.com/users/kanzure/received_events",
      "repos_url" : "https://api.github.com/users/kanzure/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/kanzure/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/kanzure/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/kanzure"
   },
   "comments" : 10,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6454/comments",
   "created_at" : "2015-07-17T19:38:25Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6454/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/6454",
   "id" : 95729047,
   "labels" : [
      {
         "color" : "0052cc",
         "default" : false,
         "id" : 98279177,
         "name" : "RPC/REST/ZMQ",
         "node_id" : "MDU6TGFiZWw5ODI3OTE3Nw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6454/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU5NTcyOTA0Nw==",
   "number" : 6454,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Unresponsive RPC server and RPC threads hanging",
   "updated_at" : "2015-09-04T15:26:07Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6454",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/101238?v=4",
      "events_url" : "https://api.github.com/users/kanzure/events{/privacy}",
      "followers_url" : "https://api.github.com/users/kanzure/followers",
      "following_url" : "https://api.github.com/users/kanzure/following{/other_user}",
      "gists_url" : "https://api.github.com/users/kanzure/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/kanzure",
      "id" : 101238,
      "login" : "kanzure",
      "node_id" : "MDQ6VXNlcjEwMTIzOA==",
      "organizations_url" : "https://api.github.com/users/kanzure/orgs",
      "received_events_url" : "https://api.github.com/users/kanzure/received_events",
      "repos_url" : "https://api.github.com/users/kanzure/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/kanzure/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/kanzure/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/kanzure"
   }
}
