[
   {
      "body" : "Can you try replacing in UniValue::write\r\n```\r\n    case VREAL:\r\n        {\r\n            std::stringstream ss;\r\n            ss << std::showpoint << std::fixed << std::setprecision(8) << get_real();\r\n            s += ss.str();\r\n        }\r\n        break;\r\n    case VNUM:\r\n        s += val;\r\n        break;\r\n```\r\nwith\r\n```\r\n    case VREAL:\r\n    case VNUM:\r\n        s += val;\r\n        break;\r\n```\r\nThere is no need to parse and re-format the value via a double when outputting...\r\n\r\n`get_real` is only used in one place apart from that, prioritisetransaction, so if this is a problem with ParseDouble this should avoid your issue.",
      "created_at" : "2015-07-17T19:37:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6443#issuecomment-122388926",
      "id" : 122388926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6443",
      "updated_at" : "2015-07-17T19:37:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/122388926",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "> Can you try replacing in UniValue::write ...\r\n\r\nIt looks like the numbers are parsed and re-formatted to normalize the values to `%d.%8d`:\r\n```java\r\n{\r\n  \"version\": 119900,\r\n  \"protocolversion\": 70002,\r\n  \"walletversion\": 60000,\r\n  \"balance\": 11.56061, // <-- would be 11.56061000\r\n  \"blocks\": 1046,\r\n  \"timeoffset\": 0,\r\n  \"connections\": 0,\r\n  \"proxy\": \"\",\r\n  \"difficulty\": 4.656542373906925e-10, // <-- would be 0.00000000\r\n  \"testnet\": false,\r\n  \"keypoololdest\": 1436225389,\r\n  \"keypoolsize\": 101,\r\n  \"paytxfee\": 0.0001, // <-- would be 0.00010000\r\n  \"relayfee\": 0.00001, // <-- would be 0.00001000\r\n  \"errors\": \"This is a pre-release test build - use at your own risk - do not use for mining or merchant applications\"\r\n}\r\n```\r\n\r\n> get_real is only used in one place apart from that, prioritisetransaction, so if this is a problem with ParseDouble this should avoid your issue.\r\n\r\nJust to quickly clarify with an example: I didn't mess with my locale settings, but I live in Europe, and as per system default, `,` is used as decimal point:\r\n```c++\r\ndouble n;\r\nbool success = ParseDouble(\"1.2345\", &n);\r\n\r\n// => n == 1.0\r\n// => success == false\r\n```\r\nThe unit tests pass, because it seems that only the QT client is affected. The [QT documenation](http://doc.qt.io/qt-5/qcoreapplication.html#locale-settings) actually addresses this pitfall and suggests to reset `LC_NUMERIC`, once the application is initialized. This works, though I think it would probably best to avoid the use of locale-dependent functions altogether, or reset the numeric locale directly in `ParseDouble()`, if `strtod` should be kept.",
      "created_at" : "2015-07-18T00:25:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6443#issuecomment-122460176",
      "id" : 122460176,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6443",
      "updated_at" : "2015-07-18T00:25:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/122460176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5836089?v=3",
         "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dexX7/followers",
         "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dexX7",
         "id" : 5836089,
         "login" : "dexX7",
         "organizations_url" : "https://api.github.com/users/dexX7/orgs",
         "received_events_url" : "https://api.github.com/users/dexX7/received_events",
         "repos_url" : "https://api.github.com/users/dexX7/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dexX7"
      }
   },
   {
      "body" : "> It looks like the numbers are parsed and re-formatted to normalize the values to %d.%8d:\r\n\r\nIf that kind of formatting is desired for non-monetary values, this can also be done in `setFloat` directly (avoiding a round-trip with potential loss of precision). My point was not that the above is a good fix, but it works around the issue to isolate the problem.\r\nDoes it stop the issue from happening in qt if you do that?\r\n\r\nAgree that a locale-independent alternative to `strtod` should be used in `ParseDouble`, but as said, this was not meant as a proper fix. My surprise was just that a problem in `ParseDouble` escalates to almost all JSON generated.",
      "created_at" : "2015-07-18T04:55:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6443#issuecomment-122483744",
      "id" : 122483744,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6443",
      "updated_at" : "2015-07-18T05:11:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/122483744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Working on a fix...",
      "created_at" : "2015-07-18T06:30:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6443#issuecomment-122496718",
      "id" : 122496718,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6443",
      "updated_at" : "2015-07-18T06:30:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/122496718",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "See #6456",
      "created_at" : "2015-07-18T07:26:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6443#issuecomment-122508409",
      "id" : 122508409,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6443",
      "updated_at" : "2015-07-18T07:26:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/122508409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
