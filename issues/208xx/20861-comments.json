[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21279 (scripted-diff: Regenerate key_io data deterministically by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-01-05T22:05:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-754930797",
      "id" : 754930797,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDkzMDc5Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-17T15:23:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754930797",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r552296627"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552296627"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why forbid Bech32m for v0? Seems like it might be nice to (very slowly) migrate to Bech32m exclusively, and drop Bech32 someday?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-01-06T00:52:33Z",
      "diff_hunk" : "@@ -90,14 +90,21 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n             return ScriptHash(hash);\n         }\n     }\n+    bech32::Encoding encoding;\n+    std::string hrp;\n+    std::vector<unsigned char> encdata;\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0 && bech.first == params.Bech32HRP()) {\n+    std::tie(encoding, hrp, encdata) = bech32::Decode(str);\n+    if ((encoding == bech32::Encoding::BECH32 || encoding == bech32::Encoding::BECH32M) &&\n+        encdata.size() > 0 && hrp == params.Bech32HRP()) {\n         // Bech32 decoding\n-        int version = bech.second[0]; // The first 5 bit symbol is the witness version (0-16)\n+        int version = encdata[0]; // The first 5 bit symbol is the witness version (0-16)\n+        if ((version == 0 && encoding != bech32::Encoding::BECH32) || (version != 0 && encoding != bech32::Encoding::BECH32M)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r552296627",
      "id" : 552296627,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjI5NjYyNw==",
      "original_commit_id" : "863a5c2eba77ca571813b33b9fa6237a9f3efbd7",
      "original_line" : 102,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : null,
      "pull_request_review_id" : 562255415,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552296627",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r552298542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552298542"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it's a bad idea to have multiple addresses valid for the same scriptPubKey. It only results in confusion when decoding/recoding doesn't roundtrip. v0 outputs use bech32, and I don't think this should ever change, for better or for worse.\r\n\r\nIt also worsens error detection to 29 bits (as every v0 output now has two valid checksums).",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-01-06T00:55:03Z",
      "diff_hunk" : "@@ -90,14 +90,21 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n             return ScriptHash(hash);\n         }\n     }\n+    bech32::Encoding encoding;\n+    std::string hrp;\n+    std::vector<unsigned char> encdata;\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0 && bech.first == params.Bech32HRP()) {\n+    std::tie(encoding, hrp, encdata) = bech32::Decode(str);\n+    if ((encoding == bech32::Encoding::BECH32 || encoding == bech32::Encoding::BECH32M) &&\n+        encdata.size() > 0 && hrp == params.Bech32HRP()) {\n         // Bech32 decoding\n-        int version = bech.second[0]; // The first 5 bit symbol is the witness version (0-16)\n+        int version = encdata[0]; // The first 5 bit symbol is the witness version (0-16)\n+        if ((version == 0 && encoding != bech32::Encoding::BECH32) || (version != 0 && encoding != bech32::Encoding::BECH32M)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r552298542",
      "id" : 552298542,
      "in_reply_to_id" : 552296627,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjI5ODU0Mg==",
      "original_commit_id" : "863a5c2eba77ca571813b33b9fa6237a9f3efbd7",
      "original_line" : 102,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : null,
      "pull_request_review_id" : 562256132,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552298542",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r552315960"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552315960"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Roundtrips (by uninvolved third parties) seem like strictly a bad thing IMO, but loss of error detection precision is a good reason. :/",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-01-06T01:40:14Z",
      "diff_hunk" : "@@ -90,14 +90,21 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n             return ScriptHash(hash);\n         }\n     }\n+    bech32::Encoding encoding;\n+    std::string hrp;\n+    std::vector<unsigned char> encdata;\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0 && bech.first == params.Bech32HRP()) {\n+    std::tie(encoding, hrp, encdata) = bech32::Decode(str);\n+    if ((encoding == bech32::Encoding::BECH32 || encoding == bech32::Encoding::BECH32M) &&\n+        encdata.size() > 0 && hrp == params.Bech32HRP()) {\n         // Bech32 decoding\n-        int version = bech.second[0]; // The first 5 bit symbol is the witness version (0-16)\n+        int version = encdata[0]; // The first 5 bit symbol is the witness version (0-16)\n+        if ((version == 0 && encoding != bech32::Encoding::BECH32) || (version != 0 && encoding != bech32::Encoding::BECH32M)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r552315960",
      "id" : 552315960,
      "in_reply_to_id" : 552296627,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjMxNTk2MA==",
      "original_commit_id" : "863a5c2eba77ca571813b33b9fa6237a9f3efbd7",
      "original_line" : 102,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : null,
      "pull_request_review_id" : 562269930,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552315960",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "By implementing Bech32m, I found out that it is not obvious how to locate errors, because the `residue` was polymod^1, but now is either `polimod^1` or `polimod^0x2bc830a3`... I am tempted to try both and take the residue with the least errors. I think this should be specified in the bip.\r\nThat said by doing this, the `error patterns with failure probability` in the bip are probably different. As I think you assume in your table that the decoder knows it is decoding bech32m. Unsure if this is really changing things by a lot.\r\n\r\nThis is not the right place to comment for it, but did not found elsewhere.",
      "created_at" : "2021-01-06T12:40:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-755277023",
      "id" : 755277023,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTI3NzAyMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T12:42:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755277023",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/3020646?v=4",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "node_id" : "MDQ6VXNlcjMwMjA2NDY=",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@NicolasDorier That isn't solved by sipa only allowing one polimod based on the witness version?",
      "created_at" : "2021-01-06T17:16:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-755437272",
      "id" : 755437272,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTQzNzI3Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T17:16:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755437272",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@luke-jr It's not, because the error may be one that affects the witness version symbol.\r\n\r\n@NicolasDorier Good point, I will elaborate on that.",
      "created_at" : "2021-01-06T17:29:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-755444262",
      "id" : 755444262,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTQ0NDI2Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T17:29:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755444262",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, Approach ACK. Skimmed code but will hopefully go through more thoroughly at a later date.\r\n\r\nhttps://bitcoin.stackexchange.com/questions/101117/what-problems-identified-with-bech32-addresses-have-been-resolved-with-the-updat",
      "created_at" : "2021-01-09T20:35:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-757363546",
      "id" : 757363546,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NzM2MzU0Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-09T20:35:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757363546",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r559473212"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559473212"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 6b28812881375311891e80c1d4e9df6aaa0b85d5\r\n\r\nPerhaps too unorthodox, but it would theoretically be possible to do\r\n```C++\r\n   BECH32 = 1, //...\r\n   BECH32M = 0x2bc830a3, // ...\r\n```\r\nand get rid of `EncodingConstant`. (But the amount of casting required is probably not worth it.)",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-01-18T10:44:38Z",
      "diff_hunk" : "@@ -14,16 +14,25 @@\n \n #include <stdint.h>\n #include <string>\n+#include <tuple>\n #include <vector>\n \n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID,\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //! Bech32 encoding as defined in BIP173\n+    BECH32M, //! Bech32m encoding as defined in bip-bech32m",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r559473212",
      "id" : 559473212,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTQ3MzIxMg==",
      "original_commit_id" : "6b28812881375311891e80c1d4e9df6aaa0b85d5",
      "original_line" : 27,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : null,
      "pull_request_review_id" : 570369959,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559473212",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r559812907"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559812907"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I prefer not to do that just for encapsulation reason. Nothing outside of bech32.cpp should care or see the constants.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-01-18T22:05:33Z",
      "diff_hunk" : "@@ -14,16 +14,25 @@\n \n #include <stdint.h>\n #include <string>\n+#include <tuple>\n #include <vector>\n \n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID,\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //! Bech32 encoding as defined in BIP173\n+    BECH32M, //! Bech32m encoding as defined in bip-bech32m",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r559812907",
      "id" : 559812907,
      "in_reply_to_id" : 559473212,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTgxMjkwNw==",
      "original_commit_id" : "6b28812881375311891e80c1d4e9df6aaa0b85d5",
      "original_line" : 27,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : null,
      "pull_request_review_id" : 570798121,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559812907",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@kallewoof Agree, a `struct` is definitely warranted here. Updated.",
      "created_at" : "2021-01-18T22:05:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-762490169",
      "id" : 762490169,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2MjQ5MDE2OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-18T22:05:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/762490169",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r559853231"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559853231"
         }
      },
      "author_association" : "NONE",
      "body" : "Don't think this is needed anymore.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-01-19T00:56:48Z",
      "diff_hunk" : "@@ -14,16 +14,35 @@\n \n #include <stdint.h>\n #include <string>\n+#include <tuple>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r559853231",
      "id" : 559853231,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTg1MzIzMQ==",
      "original_commit_id" : "936322d351ad8ad2b0497bdb0651d5d969944f9f",
      "original_line" : 17,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : null,
      "pull_request_review_id" : 570840478,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559853231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/77431338?v=4",
         "events_url" : "https://api.github.com/users/btcslade/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcslade/followers",
         "following_url" : "https://api.github.com/users/btcslade/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcslade/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcslade",
         "id" : 77431338,
         "login" : "btcslade",
         "node_id" : "MDQ6VXNlcjc3NDMxMzM4",
         "organizations_url" : "https://api.github.com/users/btcslade/orgs",
         "received_events_url" : "https://api.github.com/users/btcslade/received_events",
         "repos_url" : "https://api.github.com/users/btcslade/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcslade/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcslade/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcslade"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r559901375"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559901375"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-01-19T04:06:50Z",
      "diff_hunk" : "@@ -14,16 +14,35 @@\n \n #include <stdint.h>\n #include <string>\n+#include <tuple>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r559901375",
      "id" : 559901375,
      "in_reply_to_id" : 559853231,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTkwMTM3NQ==",
      "original_commit_id" : "936322d351ad8ad2b0497bdb0651d5d969944f9f",
      "original_line" : 17,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : null,
      "pull_request_review_id" : 570892259,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559901375",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/20861/commits/2827cf86559a9310ca3fb8b19e03422586a21a2b",
      "created_at" : "2021-01-21T11:41:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-764586255",
      "id" : 764586255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NDU4NjI1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-21T11:41:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/764586255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/11212268?v=4",
         "events_url" : "https://api.github.com/users/gruve-p/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gruve-p/followers",
         "following_url" : "https://api.github.com/users/gruve-p/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gruve-p/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gruve-p",
         "id" : 11212268,
         "login" : "gruve-p",
         "node_id" : "MDQ6VXNlcjExMjEyMjY4",
         "organizations_url" : "https://api.github.com/users/gruve-p/orgs",
         "received_events_url" : "https://api.github.com/users/gruve-p/received_events",
         "repos_url" : "https://api.github.com/users/gruve-p/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gruve-p/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gruve-p/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gruve-p"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-01-26T00:45:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-767205964",
      "id" : 767205964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NzIwNTk2NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-26T00:45:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/767205964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased now #20832 is merged.\r\n\r\nI've also addressed some comments on the BIP draft itself, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-January/018362.html.",
      "created_at" : "2021-01-27T00:23:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-767918296",
      "id" : 767918296,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NzkxODI5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-27T00:23:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/767918296",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re-ACK 3fee858",
      "created_at" : "2021-01-27T07:42:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-768099947",
      "id" : 768099947,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2ODA5OTk0Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-27T07:42:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/768099947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "BIP draft is now published as [BIP 350](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki).",
      "created_at" : "2021-02-03T23:22:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-772895907",
      "id" : 772895907,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc3Mjg5NTkwNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-03T23:22:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/772895907",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571153401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571153401"
         }
      },
      "author_association" : "NONE",
      "body" : "Shouldn't `0x2bc830a3` be made a global constant value?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-05T18:05:42Z",
      "diff_hunk" : "@@ -27,6 +30,12 @@ const int8_t CHARSET_REV[128] = {\n      1,  0,  3, 16, 11, 28, 12, 14,  6,  4,  2, -1, -1, -1, -1, -1\n };\n \n+/* Determine the final constant to use for the specified encoding. */\n+uint32_t EncodingConstant(Encoding encoding) {\n+    assert(encoding == Encoding::BECH32 || encoding == Encoding::BECH32M);\n+    return encoding == Encoding::BECH32 ? 1 : 0x2bc830a3;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571153401",
      "id" : 571153401,
      "line" : 36,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTE1MzQwMQ==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 36,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : 34,
      "pull_request_review_id" : 584581812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571153401",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/372034?v=4",
         "events_url" : "https://api.github.com/users/dr-orlovsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dr-orlovsky/followers",
         "following_url" : "https://api.github.com/users/dr-orlovsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dr-orlovsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dr-orlovsky",
         "id" : 372034,
         "login" : "dr-orlovsky",
         "node_id" : "MDQ6VXNlcjM3MjAzNA==",
         "organizations_url" : "https://api.github.com/users/dr-orlovsky/orgs",
         "received_events_url" : "https://api.github.com/users/dr-orlovsky/received_events",
         "repos_url" : "https://api.github.com/users/dr-orlovsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dr-orlovsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dr-orlovsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dr-orlovsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571154527"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571154527"
         }
      },
      "author_association" : "NONE",
      "body" : "Why here `Encoding` is added as the last parameter why in https://github.com/bitcoin/bitcoin/pull/20861/files#diff-f146300624c06d2e08aadf500952294148a1785edd6ff2e8b50f13b2c08255edR152 it became first? Is there any reason behind API inconsistency?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-05T18:07:44Z",
      "diff_hunk" : "@@ -111,21 +120,24 @@ data ExpandHRP(const std::string& hrp)\n }\n \n /** Verify a checksum. */\n-bool VerifyChecksum(const std::string& hrp, const data& values)\n+Encoding VerifyChecksum(const std::string& hrp, const data& values)\n {\n     // PolyMod computes what value to xor into the final values to make the checksum 0. However,\n     // if we required that the checksum was 0, it would be the case that appending a 0 to a valid\n     // list of values would result in a new valid list. For that reason, Bech32 requires the\n-    // resulting checksum to be 1 instead.\n-    return PolyMod(Cat(ExpandHRP(hrp), values)) == 1;\n+    // resulting checksum to be 1 instead. In Bech32m, this constant was amended.\n+    uint32_t check = PolyMod(Cat(ExpandHRP(hrp), values));\n+    if (check == EncodingConstant(Encoding::BECH32)) return Encoding::BECH32;\n+    if (check == EncodingConstant(Encoding::BECH32M)) return Encoding::BECH32M;\n+    return Encoding::INVALID;\n }\n \n /** Create a checksum. */\n-data CreateChecksum(const std::string& hrp, const data& values)\n+data CreateChecksum(const std::string& hrp, const data& values, Encoding encoding)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571154527",
      "id" : 571154527,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTE1NDUyNw==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 136,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : null,
      "pull_request_review_id" : 584581812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571154527",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/372034?v=4",
         "events_url" : "https://api.github.com/users/dr-orlovsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dr-orlovsky/followers",
         "following_url" : "https://api.github.com/users/dr-orlovsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dr-orlovsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dr-orlovsky",
         "id" : 372034,
         "login" : "dr-orlovsky",
         "node_id" : "MDQ6VXNlcjM3MjAzNA==",
         "organizations_url" : "https://api.github.com/users/dr-orlovsky/orgs",
         "received_events_url" : "https://api.github.com/users/dr-orlovsky/received_events",
         "repos_url" : "https://api.github.com/users/dr-orlovsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dr-orlovsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dr-orlovsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dr-orlovsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571431168"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571431168"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Won't this need to be backported to 0.21.1 with taproot activation?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-06T12:43:36Z",
      "diff_hunk" : "@@ -46,3 +46,4 @@ BIPs that are implemented by Bitcoin Core (up-to-date up to **v0.21.0**):\n * [`BIP 325`](https://github.com/bitcoin/bips/blob/master/bip-0325.mediawiki): Signet test network is supported as of **v0.21.0** ([PR 18267](https://github.com/bitcoin/bitcoin/pull/18267)).\n * [`BIP 339`](https://github.com/bitcoin/bips/blob/master/bip-0339.mediawiki): Relay of transactions by wtxid is supported as of **v0.21.0** ([PR 18044](https://github.com/bitcoin/bitcoin/pull/18044)).\n * [`BIP 340`](https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki) [`341`](https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki) [`342`](https://github.com/bitcoin/bips/blob/master/bip-0342.mediawiki): Validation rules for Taproot (including Schnorr signatures and Tapscript leaves) are implemented as of **v0.21.0** ([PR 19953](https://github.com/bitcoin/bitcoin/pull/19953)), without mainnet activation.\n+* [`BIP 350`](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki): Addresses for native v1+ segregated Witness outputs use Bech32m instead of Bech32 as of **v22.0** ([PR 20861](https://github.com/bitcoin/bitcoin/pull/20861)).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571431168",
      "id" : 571431168,
      "line" : 53,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTQzMTE2OA==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 53,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/bips.md",
      "position" : 10,
      "pull_request_review_id" : 584881347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571431168",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571431311"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571431311"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Couldn't this be signet as well?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-06T12:45:30Z",
      "diff_hunk" : "@@ -486,7 +486,25 @@\n         }\n     ],\n     [\n-        \"bc1pw508d6qejxtdg4y5r3zarvary0c5xw7kw508d6qejxtdg4y5r3zarvary0c5xw7k7grplx\",\n+        \"tb1qqqqqp399et2xygdj5xreqhjjvcmzhxw4aywxecjdzew6hylgvsesrxh6hy\",\n+        \"0020000000c4a5cad46221b2a187905e5266362b99d5e91c6ce24d165dab93e86433\",\n+        {\n+            \"isPrivkey\": false,\n+            \"chain\": \"test\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571431311",
      "id" : 571431311,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTQzMTMxMQ==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 493,
      "original_position" : 9,
      "original_start_line" : 489,
      "path" : "src/test/data/key_io_valid.json",
      "position" : null,
      "pull_request_review_id" : 584881347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571431311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571431407"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571431407"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ditto signet comment",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-06T12:46:07Z",
      "diff_hunk" : "@@ -513,20 +531,20 @@\n         }\n     ],\n     [\n-        \"tb1qqqqqp399et2xygdj5xreqhjjvcmzhxw4aywxecjdzew6hylgvsesrxh6hy\",\n-        \"0020000000c4a5cad46221b2a187905e5266362b99d5e91c6ce24d165dab93e86433\",\n+        \"tb1pqqqqp399et2xygdj5xreqhjjvcmzhxw4aywxecjdzew6hylgvsesf3hn0c\",\n+        \"5120000000c4a5cad46221b2a187905e5266362b99d5e91c6ce24d165dab93e86433\",\n         {\n             \"isPrivkey\": false,\n             \"chain\": \"test\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r571431407",
      "id" : 571431407,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTQzMTQwNw==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 590,
      "original_position" : 55,
      "original_start_line" : 534,
      "path" : "src/test/data/key_io_valid.json",
      "position" : null,
      "pull_request_review_id" : 584881347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/571431407",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r574754752"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574754752"
         }
      },
      "author_association" : "MEMBER",
      "body" : "IMO, no. There is no reason why it should be exported from this module.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-11T19:05:02Z",
      "diff_hunk" : "@@ -27,6 +30,12 @@ const int8_t CHARSET_REV[128] = {\n      1,  0,  3, 16, 11, 28, 12, 14,  6,  4,  2, -1, -1, -1, -1, -1\n };\n \n+/* Determine the final constant to use for the specified encoding. */\n+uint32_t EncodingConstant(Encoding encoding) {\n+    assert(encoding == Encoding::BECH32 || encoding == Encoding::BECH32M);\n+    return encoding == Encoding::BECH32 ? 1 : 0x2bc830a3;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r574754752",
      "id" : 574754752,
      "in_reply_to_id" : 571153401,
      "line" : 36,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDc1NDc1Mg==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 36,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : 34,
      "pull_request_review_id" : 588892359,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574754752",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r574755263"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574755263"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I have no opinion on that, but even if we do that, that's not part of this PR.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-11T19:05:50Z",
      "diff_hunk" : "@@ -46,3 +46,4 @@ BIPs that are implemented by Bitcoin Core (up-to-date up to **v0.21.0**):\n * [`BIP 325`](https://github.com/bitcoin/bips/blob/master/bip-0325.mediawiki): Signet test network is supported as of **v0.21.0** ([PR 18267](https://github.com/bitcoin/bitcoin/pull/18267)).\n * [`BIP 339`](https://github.com/bitcoin/bips/blob/master/bip-0339.mediawiki): Relay of transactions by wtxid is supported as of **v0.21.0** ([PR 18044](https://github.com/bitcoin/bitcoin/pull/18044)).\n * [`BIP 340`](https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki) [`341`](https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki) [`342`](https://github.com/bitcoin/bips/blob/master/bip-0342.mediawiki): Validation rules for Taproot (including Schnorr signatures and Tapscript leaves) are implemented as of **v0.21.0** ([PR 19953](https://github.com/bitcoin/bitcoin/pull/19953)), without mainnet activation.\n+* [`BIP 350`](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki): Addresses for native v1+ segregated Witness outputs use Bech32m instead of Bech32 as of **v22.0** ([PR 20861](https://github.com/bitcoin/bitcoin/pull/20861)).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r574755263",
      "id" : 574755263,
      "in_reply_to_id" : 571431168,
      "line" : 53,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDc1NTI2Mw==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 53,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/bips.md",
      "position" : 10,
      "pull_request_review_id" : 588892970,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574755263",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r577715636"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/577715636"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also note that if 0.21.1 contains Taproot activation logic, it won't contain any wallet support. Being able to send _to_ a Taproot address is probably worth back-porting, but that could also wait for 0.21.2.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-17T15:39:18Z",
      "diff_hunk" : "@@ -46,3 +46,4 @@ BIPs that are implemented by Bitcoin Core (up-to-date up to **v0.21.0**):\n * [`BIP 325`](https://github.com/bitcoin/bips/blob/master/bip-0325.mediawiki): Signet test network is supported as of **v0.21.0** ([PR 18267](https://github.com/bitcoin/bitcoin/pull/18267)).\n * [`BIP 339`](https://github.com/bitcoin/bips/blob/master/bip-0339.mediawiki): Relay of transactions by wtxid is supported as of **v0.21.0** ([PR 18044](https://github.com/bitcoin/bitcoin/pull/18044)).\n * [`BIP 340`](https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki) [`341`](https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki) [`342`](https://github.com/bitcoin/bips/blob/master/bip-0342.mediawiki): Validation rules for Taproot (including Schnorr signatures and Tapscript leaves) are implemented as of **v0.21.0** ([PR 19953](https://github.com/bitcoin/bitcoin/pull/19953)), without mainnet activation.\n+* [`BIP 350`](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki): Addresses for native v1+ segregated Witness outputs use Bech32m instead of Bech32 as of **v22.0** ([PR 20861](https://github.com/bitcoin/bitcoin/pull/20861)).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r577715636",
      "id" : 577715636,
      "in_reply_to_id" : 571431168,
      "line" : 53,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NzcxNTYzNg==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 53,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/bips.md",
      "position" : 10,
      "pull_request_review_id" : 592330806,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/577715636",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r578000069"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/578000069"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added a signet copy of this.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-17T22:49:21Z",
      "diff_hunk" : "@@ -486,7 +486,25 @@\n         }\n     ],\n     [\n-        \"bc1pw508d6qejxtdg4y5r3zarvary0c5xw7kw508d6qejxtdg4y5r3zarvary0c5xw7k7grplx\",\n+        \"tb1qqqqqp399et2xygdj5xreqhjjvcmzhxw4aywxecjdzew6hylgvsesrxh6hy\",\n+        \"0020000000c4a5cad46221b2a187905e5266362b99d5e91c6ce24d165dab93e86433\",\n+        {\n+            \"isPrivkey\": false,\n+            \"chain\": \"test\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r578000069",
      "id" : 578000069,
      "in_reply_to_id" : 571431311,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3ODAwMDA2OQ==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 493,
      "original_position" : 9,
      "original_start_line" : 489,
      "path" : "src/test/data/key_io_valid.json",
      "position" : null,
      "pull_request_review_id" : 592696501,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/578000069",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r578000126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/578000126"
         }
      },
      "author_association" : "MEMBER",
      "body" : "And this.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-17T22:49:29Z",
      "diff_hunk" : "@@ -513,20 +531,20 @@\n         }\n     ],\n     [\n-        \"tb1qqqqqp399et2xygdj5xreqhjjvcmzhxw4aywxecjdzew6hylgvsesrxh6hy\",\n-        \"0020000000c4a5cad46221b2a187905e5266362b99d5e91c6ce24d165dab93e86433\",\n+        \"tb1pqqqqp399et2xygdj5xreqhjjvcmzhxw4aywxecjdzew6hylgvsesf3hn0c\",\n+        \"5120000000c4a5cad46221b2a187905e5266362b99d5e91c6ce24d165dab93e86433\",\n         {\n             \"isPrivkey\": false,\n             \"chain\": \"test\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r578000126",
      "id" : 578000126,
      "in_reply_to_id" : 571431407,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3ODAwMDEyNg==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 590,
      "original_position" : 55,
      "original_start_line" : 534,
      "path" : "src/test/data/key_io_valid.json",
      "position" : null,
      "pull_request_review_id" : 592696571,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/578000126",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r578000224"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/578000224"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-17T22:49:42Z",
      "diff_hunk" : "@@ -111,21 +120,24 @@ data ExpandHRP(const std::string& hrp)\n }\n \n /** Verify a checksum. */\n-bool VerifyChecksum(const std::string& hrp, const data& values)\n+Encoding VerifyChecksum(const std::string& hrp, const data& values)\n {\n     // PolyMod computes what value to xor into the final values to make the checksum 0. However,\n     // if we required that the checksum was 0, it would be the case that appending a 0 to a valid\n     // list of values would result in a new valid list. For that reason, Bech32 requires the\n-    // resulting checksum to be 1 instead.\n-    return PolyMod(Cat(ExpandHRP(hrp), values)) == 1;\n+    // resulting checksum to be 1 instead. In Bech32m, this constant was amended.\n+    uint32_t check = PolyMod(Cat(ExpandHRP(hrp), values));\n+    if (check == EncodingConstant(Encoding::BECH32)) return Encoding::BECH32;\n+    if (check == EncodingConstant(Encoding::BECH32M)) return Encoding::BECH32M;\n+    return Encoding::INVALID;\n }\n \n /** Create a checksum. */\n-data CreateChecksum(const std::string& hrp, const data& values)\n+data CreateChecksum(const std::string& hrp, const data& values, Encoding encoding)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r578000224",
      "id" : 578000224,
      "in_reply_to_id" : 571154527,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3ODAwMDIyNA==",
      "original_commit_id" : "50769c8085110bd013d469840c2b04e069ab2fa5",
      "original_line" : 136,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : null,
      "pull_request_review_id" : 592696700,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/578000224",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and addressed review comments.",
      "created_at" : "2021-02-17T22:49:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-780906248",
      "id" : 780906248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MDkwNjI0OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-17T22:49:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/780906248",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK f15513d4184e637eda76eb23e0d6d47d7fb25075",
      "created_at" : "2021-02-18T01:31:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-780972516",
      "id" : 780972516,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MDk3MjUxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-18T01:31:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/780972516",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK f15513d4184e637eda76eb23e0d6d47d7fb25075\r\n\r\nI'm confused how `key_io_valid.json` and `key_io_invalid.json` are used. It doesn't seem to be referenced in any of the (functional) tests or CI scripts. If I use the suggested incantation in `gen_key_io_test_vectors.py` it fails at line 131 with `bech32_encode() missing 1 required positional argument: 'spec'`.\r\n\r\n",
      "created_at" : "2021-02-18T14:55:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-781399950",
      "id" : 781399950,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MTM5OTk1MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-18T14:55:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/781399950",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors The key_io_{in,}valid.json tests are executed in src/test/key_io_tests.cpp. I had no idea there was a script to automatically generate them, though. I've updated that now too and regenerated them using it.\r\n",
      "created_at" : "2021-02-19T22:39:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-782423094",
      "id" : 782423094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MjQyMzA5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-19T22:39:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/782423094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r579569442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/579569442"
         }
      },
      "author_association" : "NONE",
      "body" : "There might be a Base58 string which is a valid Bech32m with future Witness version, and since Base58 is the first decoder, a future valid Bech32m address may be incorrectly parsed as Base58. So I propose to change their order.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-20T01:44:51Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r579569442",
      "id" : 579569442,
      "line" : 99,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3OTU2OTQ0Mg==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 99,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 34,
      "pull_request_review_id" : 594686877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/579569442",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/372034?v=4",
         "events_url" : "https://api.github.com/users/dr-orlovsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dr-orlovsky/followers",
         "following_url" : "https://api.github.com/users/dr-orlovsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dr-orlovsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dr-orlovsky",
         "id" : 372034,
         "login" : "dr-orlovsky",
         "node_id" : "MDQ6VXNlcjM3MjAzNA==",
         "organizations_url" : "https://api.github.com/users/dr-orlovsky/orgs",
         "received_events_url" : "https://api.github.com/users/dr-orlovsky/received_events",
         "repos_url" : "https://api.github.com/users/dr-orlovsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dr-orlovsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dr-orlovsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dr-orlovsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r579570368"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/579570368"
         }
      },
      "author_association" : "NONE",
      "body" : "in case of Bech32 address `error_str` will still be set to `\"Invalid prefix for Base58-encoded address\"` because it is not cleaned when we return https://github.com/bitcoin/bitcoin/pull/20861/files#diff-a83ac7cb4a9d60b647db6378ccfad815005724e594bf53f49745b0f40701292fR152\r\n\r\nSo I propose\r\n```suggestion\r\n        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, dec.data.begin() + 1, dec.data.end())) {\r\n            error_str = \"\";\r\n```",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-20T01:50:28Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {\n+        // Bech32 decoding\n         error_str = \"\";\n-\n-        if (bech.first != params.Bech32HRP()) {\n+        if (dec.hrp != params.Bech32HRP()) {\n             error_str = \"Invalid prefix for Bech32 address\";\n             return CNoDestination();\n         }\n-\n-        // Bech32 decoding\n-        int version = bech.second[0]; // The first 5 bit symbol is the witness version (0-16)\n+        int version = dec.data[0]; // The first 5 bit symbol is the witness version (0-16)\n+        if (version == 0 && dec.encoding != bech32::Encoding::BECH32) {\n+            error_str = \"Version 0 witness address must use Bech32 checksum\";\n+            return CNoDestination();\n+        }\n+        if (version != 0 && dec.encoding != bech32::Encoding::BECH32M) {\n+            error_str = \"Version 1+ witness address must use Bech32m checksum\";\n+            return CNoDestination();\n+        }\n         // The rest of the symbols are converted witness program bytes.\n-        data.reserve(((bech.second.size() - 1) * 5) / 8);\n-        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, bech.second.begin() + 1, bech.second.end())) {\n+        data.reserve(((dec.data.size() - 1) * 5) / 8);\n+        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, dec.data.begin() + 1, dec.data.end())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r579570368",
      "id" : 579570368,
      "line" : 117,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3OTU3MDM2OA==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 117,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 59,
      "pull_request_review_id" : 594686877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/579570368",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/372034?v=4",
         "events_url" : "https://api.github.com/users/dr-orlovsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dr-orlovsky/followers",
         "following_url" : "https://api.github.com/users/dr-orlovsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dr-orlovsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dr-orlovsky",
         "id" : 372034,
         "login" : "dr-orlovsky",
         "node_id" : "MDQ6VXNlcjM3MjAzNA==",
         "organizations_url" : "https://api.github.com/users/dr-orlovsky/orgs",
         "received_events_url" : "https://api.github.com/users/dr-orlovsky/received_events",
         "repos_url" : "https://api.github.com/users/dr-orlovsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dr-orlovsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dr-orlovsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dr-orlovsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r579589300"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/579589300"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's already wiped in line 102, I think?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-20T03:51:38Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {\n+        // Bech32 decoding\n         error_str = \"\";\n-\n-        if (bech.first != params.Bech32HRP()) {\n+        if (dec.hrp != params.Bech32HRP()) {\n             error_str = \"Invalid prefix for Bech32 address\";\n             return CNoDestination();\n         }\n-\n-        // Bech32 decoding\n-        int version = bech.second[0]; // The first 5 bit symbol is the witness version (0-16)\n+        int version = dec.data[0]; // The first 5 bit symbol is the witness version (0-16)\n+        if (version == 0 && dec.encoding != bech32::Encoding::BECH32) {\n+            error_str = \"Version 0 witness address must use Bech32 checksum\";\n+            return CNoDestination();\n+        }\n+        if (version != 0 && dec.encoding != bech32::Encoding::BECH32M) {\n+            error_str = \"Version 1+ witness address must use Bech32m checksum\";\n+            return CNoDestination();\n+        }\n         // The rest of the symbols are converted witness program bytes.\n-        data.reserve(((bech.second.size() - 1) * 5) / 8);\n-        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, bech.second.begin() + 1, bech.second.end())) {\n+        data.reserve(((dec.data.size() - 1) * 5) / 8);\n+        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, dec.data.begin() + 1, dec.data.end())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r579589300",
      "id" : 579589300,
      "in_reply_to_id" : 579570368,
      "line" : 117,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3OTU4OTMwMA==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 117,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 59,
      "pull_request_review_id" : 594707276,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/579589300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r579631322"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/579631322"
         }
      },
      "author_association" : "NONE",
      "body" : "True, don't know how I missed that",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-20T09:38:47Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {\n+        // Bech32 decoding\n         error_str = \"\";\n-\n-        if (bech.first != params.Bech32HRP()) {\n+        if (dec.hrp != params.Bech32HRP()) {\n             error_str = \"Invalid prefix for Bech32 address\";\n             return CNoDestination();\n         }\n-\n-        // Bech32 decoding\n-        int version = bech.second[0]; // The first 5 bit symbol is the witness version (0-16)\n+        int version = dec.data[0]; // The first 5 bit symbol is the witness version (0-16)\n+        if (version == 0 && dec.encoding != bech32::Encoding::BECH32) {\n+            error_str = \"Version 0 witness address must use Bech32 checksum\";\n+            return CNoDestination();\n+        }\n+        if (version != 0 && dec.encoding != bech32::Encoding::BECH32M) {\n+            error_str = \"Version 1+ witness address must use Bech32m checksum\";\n+            return CNoDestination();\n+        }\n         // The rest of the symbols are converted witness program bytes.\n-        data.reserve(((bech.second.size() - 1) * 5) / 8);\n-        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, bech.second.begin() + 1, bech.second.end())) {\n+        data.reserve(((dec.data.size() - 1) * 5) / 8);\n+        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, dec.data.begin() + 1, dec.data.end())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r579631322",
      "id" : 579631322,
      "in_reply_to_id" : 579570368,
      "line" : 117,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3OTYzMTMyMg==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 117,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 59,
      "pull_request_review_id" : 594734840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/579631322",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/372034?v=4",
         "events_url" : "https://api.github.com/users/dr-orlovsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dr-orlovsky/followers",
         "following_url" : "https://api.github.com/users/dr-orlovsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dr-orlovsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dr-orlovsky",
         "id" : 372034,
         "login" : "dr-orlovsky",
         "node_id" : "MDQ6VXNlcjM3MjAzNA==",
         "organizations_url" : "https://api.github.com/users/dr-orlovsky/orgs",
         "received_events_url" : "https://api.github.com/users/dr-orlovsky/received_events",
         "repos_url" : "https://api.github.com/users/dr-orlovsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dr-orlovsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dr-orlovsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dr-orlovsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r581045010"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581045010"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That seems like something for a separate PR.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-02-23T13:44:25Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r581045010",
      "id" : 581045010,
      "in_reply_to_id" : 579569442,
      "line" : 99,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MTA0NTAxMA==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 99,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 34,
      "pull_request_review_id" : 596345213,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581045010",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r587903081"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587903081"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think there is any concern about that.\r\n\r\nThe decoder only accepts Base58Check inputs that encode 20 data bytes, which means addresses of at most 35 characters (ceil(log(256)/log(58)*20) == 20). A Bech32(m) segwit address of 35 characters (assuming 2+-character HRP) would encode at most (35-6(checksum)-1(separator)-2(hrp)-1(version byte))*5 = 125 bits, rounded down to a byte, 120 bits. I don't think anyone is planning on proposing 120-bit addresses for Bitcoin any time soon.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-04T23:19:38Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r587903081",
      "id" : 587903081,
      "in_reply_to_id" : 579569442,
      "line" : 99,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzkwMzA4MQ==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 99,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 34,
      "pull_request_review_id" : 604656373,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587903081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591699783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591699783"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Makes no difference to the compiled code, but the convention is to give the declaration's parameters names (which match the parameter names in the function definition).\r\n\r\n```suggestion\r\nstd::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);\r\n```",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-10T16:58:14Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding, const std::string& hrp, const std::vector<uint8_t>& values);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591699783",
      "id" : 591699783,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTY5OTc4Mw==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 31,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : null,
      "pull_request_review_id" : 608947633,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591699783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591700730"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591700730"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps update line 10:\r\n\r\n```diff\r\n-// For more information, see BIP 173.\r\n+// For more information, see BIPs 173 and 350.\r\n```",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-10T16:59:15Z",
      "diff_hunk" : "@@ -1,4 +1,4 @@\n-// Copyright (c) 2017 Pieter Wuille\n+// Copyright (c) 2017, 2021 Pieter Wuille",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591700730",
      "id" : 591700730,
      "line" : 1,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTcwMDczMA==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 1,
      "original_position" : 2,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 2,
      "pull_request_review_id" : 608947633,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591700730",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591802440"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591802440"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should a round trip encode/decode always result in the same hrp (\"bc\") here? Am I missing some way that this could legitimately fail?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-10T19:19:32Z",
      "diff_hunk" : "@@ -16,28 +16,27 @@\n FUZZ_TARGET(bech32)\n {\n     const std::string random_string(buffer.begin(), buffer.end());\n-    const std::pair<std::string, std::vector<uint8_t>> r1 = bech32::Decode(random_string);\n-    if (r1.first.empty()) {\n-        assert(r1.second.empty());\n+    const auto r1 = bech32::Decode(random_string);\n+    if (r1.hrp.empty()) {\n+        assert(r1.data.empty());\n     } else {\n-        const std::string& hrp = r1.first;\n-        const std::vector<uint8_t>& data = r1.second;\n-        const std::string reencoded = bech32::Encode(hrp, data);\n+        const std::string reencoded = bech32::Encode(r1.encoding, r1.hrp, r1.data);\n         assert(CaseInsensitiveEqual(random_string, reencoded));\n     }\n \n     std::vector<unsigned char> input;\n     ConvertBits<8, 5, true>([&](unsigned char c) { input.push_back(c); }, buffer.begin(), buffer.end());\n-    const std::string encoded = bech32::Encode(\"bc\", input);\n-    assert(!encoded.empty());\n \n-    const std::pair<std::string, std::vector<uint8_t>> r2 = bech32::Decode(encoded);\n-    if (r2.first.empty()) {\n-        assert(r2.second.empty());\n-    } else {\n-        const std::string& hrp = r2.first;\n-        const std::vector<uint8_t>& data = r2.second;\n-        assert(hrp == \"bc\");\n-        assert(data == input);\n+    for (auto encoding : {bech32::Encoding::BECH32, bech32::Encoding::BECH32M}) {\n+        const std::string encoded = bech32::Encode(encoding, \"bc\", input);\n+        assert(!encoded.empty());\n+        const auto r2 = bech32::Decode(encoded);\n+        if (r2.hrp.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591802440",
      "id" : 591802440,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTgwMjQ0MA==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 34,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/test/fuzz/bech32.cpp",
      "position" : null,
      "pull_request_review_id" : 608947633,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591802440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591818909"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591818909"
         }
      },
      "author_association" : "MEMBER",
      "body" : ">> I honestly don't really like the std::tuple stuff. It's pretty ugly and a simple struct containing the 3 elements passed as a copy by reference (edit: I meant like the tuples are passed now) in the same way would be more straightforward. (@kallewoof)\r\n\r\n> @kallewoof Agree, a struct is definitely warranted here. Updated. (@sipa)\r\n\r\nNo need to change this again, but in future you may find that structured bindings (since c++17) offer a clean and readable way to avoid the boilerplate of declaring a `struct` return. Combining with an if init statement:\r\n\r\n```suggestion\r\n    if (const auto [encoding, hrp, data] = bech32::Decode(str);\r\n        (encoding == bech32::Encoding::BECH32 || encoding == bech32::Encoding::BECH32M) && data.size() > 0) {\r\n        // [... do stuff ]\r\n    } // encoding, hrp and data fall out of scope at end of if block\r\n```",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-10T19:41:21Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591818909",
      "id" : 591818909,
      "line" : 99,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTgxODkwOQ==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 99,
      "original_position" : 34,
      "original_start_line" : 98,
      "path" : "src/key_io.cpp",
      "position" : 34,
      "pull_request_review_id" : 608947633,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : 98,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591818909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591827324"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591827324"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree, though another reason why we may not want to do this: we'll want this PR backported as far as possible.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-10T19:54:26Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591827324",
      "id" : 591827324,
      "in_reply_to_id" : 591818909,
      "line" : 99,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTgyNzMyNA==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 99,
      "original_position" : 34,
      "original_start_line" : 98,
      "path" : "src/key_io.cpp",
      "position" : 34,
      "pull_request_review_id" : 609109975,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : 98,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591827324",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591831450"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591831450"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Makes sense. I'll mark this as resolved.\r\n\r\nAlso, TIL: you can use structured bindings to unpack a `struct`, so this works even when the return value is a `DecodeResult`: `const auto [encoding, hrp, d] = bech32::Decode(str);`\r\n",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-10T20:00:35Z",
      "diff_hunk" : "@@ -95,20 +95,26 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\n         error_str = \"Invalid prefix for Base58-encoded address\";\n     }\n     data.clear();\n-    auto bech = bech32::Decode(str);\n-    if (bech.second.size() > 0) {\n+    const auto dec = bech32::Decode(str);\n+    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r591831450",
      "id" : 591831450,
      "in_reply_to_id" : 591818909,
      "line" : 99,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTgzMTQ1MA==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 99,
      "original_position" : 34,
      "original_start_line" : 98,
      "path" : "src/key_io.cpp",
      "position" : 34,
      "pull_request_review_id" : 609115104,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : 98,
      "start_side" : "RIGHT",
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591831450",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592047803"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592047803"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Add Bech32m test vectors\" (f0e15955421870c297d4ddb523431dae711e27d3)\r\n\r\nI think this means to check != BECH32M, instead of != BECH32. Alternately could check == INVALID, if it is not a problem to be more strict.\r\n",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T03:50:07Z",
      "diff_hunk" : "@@ -54,4 +74,28 @@ BOOST_AUTO_TEST_CASE(bip173_testvectors_invalid)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bech32m_testvectors_invalid)\n+{\n+    static const std::string CASES[] = {\n+        \" 1xj0phk\",\n+        \"\\x7f\"\"1g6xzxy\",\n+        \"\\x80\"\"1vctc34\",\n+        \"an84characterslonghumanreadablepartthatcontainsthetheexcludedcharactersbioandnumber11d6pts4\",\n+        \"qyrz8wqd2c9m\",\n+        \"1qyrz8wqd2c9m\",\n+        \"y1b0jsk6g\",\n+        \"lt1igcx5c0\",\n+        \"in1muywd\",\n+        \"mm1crxm3i\",\n+        \"au1s5cgom\",\n+        \"M1VUXWEZ\",\n+        \"16plkw9\",\n+        \"1p2gdwpf\"\n+    };\n+    for (const std::string& str : CASES) {\n+        const auto dec = bech32::Decode(str);\n+        BOOST_CHECK(dec.encoding != bech32::Encoding::BECH32);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592047803",
      "id" : 592047803,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA0NzgwMw==",
      "original_commit_id" : "f0e15955421870c297d4ddb523431dae711e27d3",
      "original_line" : 97,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "src/test/bech32_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 609373502,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592047803",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592054623"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592054623"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Use Bech32m encoding for v1+ segwit addresses\" (ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5)\r\n\r\nShould AddressDescriptor::GetOutputType should now return BECH32M instead of BECH32 for WitnessUnknown addresses to be consistent with this change?\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5/src/script/descriptor.cpp#L656\r\n\r\nAlso, this change seems like the first change that affects user-visible behavior, so it would be great if it added release notes or at least mentioned what the effects are in the commit message. I think the only thing current software can do with V1 addresses is validate them and do watchonly scans for them. So this only affects validate and import RPCs?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T04:14:28Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592054623",
      "id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA1NDYyMw==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 609373502,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592054623",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592056814"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592056814"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Use Bech32m encoding for v1+ segwit addresses\" (ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5)\r\n\r\nI probably just need to stare at this more, but maybe you could summarize the changes here. Like where did the 1,2 and 2,16 cases go?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T04:22:10Z",
      "diff_hunk" : "@@ -65,29 +67,39 @@\n ]\n # templates for valid bech32 sequences\n bech32_templates = [\n-  # hrp, version, witprog_size, metadata, output_prefix\n-  ('bc',    0, 20, (False, 'main',    None, True), p2wpkh_prefix),\n-  ('bc',    0, 32, (False, 'main',    None, True), p2wsh_prefix),\n-  ('bc',    1,  2, (False, 'main',    None, True), (OP_1, 2)),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592056814",
      "id" : 592056814,
      "line" : 71,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA1NjgxNA==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 71,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "contrib/testgen/gen_key_io_test_vectors.py",
      "position" : 62,
      "pull_request_review_id" : 609373502,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592056814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592086654"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592086654"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T06:00:26Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding, const std::string& hrp, const std::vector<uint8_t>& values);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592086654",
      "id" : 592086654,
      "in_reply_to_id" : 591699783,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA4NjY1NA==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 31,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : null,
      "pull_request_review_id" : 609416912,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592086654",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592086689"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592086689"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T06:00:33Z",
      "diff_hunk" : "@@ -1,4 +1,4 @@\n-// Copyright (c) 2017 Pieter Wuille\n+// Copyright (c) 2017, 2021 Pieter Wuille",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592086689",
      "id" : 592086689,
      "in_reply_to_id" : 591700730,
      "line" : 1,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA4NjY4OQ==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 1,
      "original_position" : 2,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 2,
      "pull_request_review_id" : 609416957,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592086689",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592086993"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592086993"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This already existed in the code before this PR, but it's a good point. The only failure case is when the data is too big to fit in a valid Bech32(m) encoding (max 90 characters).\r\n\r\nI've added a check for that, and then dropped the `if (r2.hrp.empty()) {` branch.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T06:01:36Z",
      "diff_hunk" : "@@ -16,28 +16,27 @@\n FUZZ_TARGET(bech32)\n {\n     const std::string random_string(buffer.begin(), buffer.end());\n-    const std::pair<std::string, std::vector<uint8_t>> r1 = bech32::Decode(random_string);\n-    if (r1.first.empty()) {\n-        assert(r1.second.empty());\n+    const auto r1 = bech32::Decode(random_string);\n+    if (r1.hrp.empty()) {\n+        assert(r1.data.empty());\n     } else {\n-        const std::string& hrp = r1.first;\n-        const std::vector<uint8_t>& data = r1.second;\n-        const std::string reencoded = bech32::Encode(hrp, data);\n+        const std::string reencoded = bech32::Encode(r1.encoding, r1.hrp, r1.data);\n         assert(CaseInsensitiveEqual(random_string, reencoded));\n     }\n \n     std::vector<unsigned char> input;\n     ConvertBits<8, 5, true>([&](unsigned char c) { input.push_back(c); }, buffer.begin(), buffer.end());\n-    const std::string encoded = bech32::Encode(\"bc\", input);\n-    assert(!encoded.empty());\n \n-    const std::pair<std::string, std::vector<uint8_t>> r2 = bech32::Decode(encoded);\n-    if (r2.first.empty()) {\n-        assert(r2.second.empty());\n-    } else {\n-        const std::string& hrp = r2.first;\n-        const std::vector<uint8_t>& data = r2.second;\n-        assert(hrp == \"bc\");\n-        assert(data == input);\n+    for (auto encoding : {bech32::Encoding::BECH32, bech32::Encoding::BECH32M}) {\n+        const std::string encoded = bech32::Encode(encoding, \"bc\", input);\n+        assert(!encoded.empty());\n+        const auto r2 = bech32::Decode(encoded);\n+        if (r2.hrp.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592086993",
      "id" : 592086993,
      "in_reply_to_id" : 591802440,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA4Njk5Mw==",
      "original_commit_id" : "835ff6b8568291870652ca0d33d934039e7b84a8",
      "original_line" : 34,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/test/fuzz/bech32.cpp",
      "position" : null,
      "pull_request_review_id" : 609417344,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592086993",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592087079"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592087079"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Indeed. Replaced with `== INVALID`.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T06:01:54Z",
      "diff_hunk" : "@@ -54,4 +74,28 @@ BOOST_AUTO_TEST_CASE(bip173_testvectors_invalid)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(bech32m_testvectors_invalid)\n+{\n+    static const std::string CASES[] = {\n+        \" 1xj0phk\",\n+        \"\\x7f\"\"1g6xzxy\",\n+        \"\\x80\"\"1vctc34\",\n+        \"an84characterslonghumanreadablepartthatcontainsthetheexcludedcharactersbioandnumber11d6pts4\",\n+        \"qyrz8wqd2c9m\",\n+        \"1qyrz8wqd2c9m\",\n+        \"y1b0jsk6g\",\n+        \"lt1igcx5c0\",\n+        \"in1muywd\",\n+        \"mm1crxm3i\",\n+        \"au1s5cgom\",\n+        \"M1VUXWEZ\",\n+        \"16plkw9\",\n+        \"1p2gdwpf\"\n+    };\n+    for (const std::string& str : CASES) {\n+        const auto dec = bech32::Decode(str);\n+        BOOST_CHECK(dec.encoding != bech32::Encoding::BECH32);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592087079",
      "id" : 592087079,
      "in_reply_to_id" : 592047803,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA4NzA3OQ==",
      "original_commit_id" : "f0e15955421870c297d4ddb523431dae711e27d3",
      "original_line" : 97,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "src/test/bech32_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 609417437,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592087079",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592088741"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592088741"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Very good point.\r\n\r\nWe can't return `GetOutputType::BECH32M` because no such constant exists. It could be added, but I'd rather not do that in this PR, because I don't think it actually matters at this stage. The purpose of output types is so the user can select what kind of address to request from a wallet. You're right that technically a `addr(...)` descriptor could be imported (but I think that in most cases a ranged descriptor is required, so `addr(...)` won't even work), and it might matter to classify that as bech32m - but this seems like a very unrealistic edge case.\r\n\r\nHowever, I think this will matter once we want to add actual taproot support to the wallet (#21365, and follow-ups that at one point might want to construct such wallet descriptors by default). I suspect we may want an OutputType::BECH32M then, and permit wallets to have separate -addresstype=bech32 and -addresstype=bech32m active descriptors, as one may know that the sender they want to receive from supports bech32 but not bech32m yet.\r\n\r\nI've also added release notes.\r\n\r\nping @achow101: thoughts on OutputType::BECH32M?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T06:07:07Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592088741",
      "id" : 592088741,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA4ODc0MQ==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 609419480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592088741",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592090257"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592090257"
         }
      },
      "author_association" : "MEMBER",
      "body" : "They're just gone and replaced by better cases. I got rid of (1,2) as (1,32) is a more relevant case (that's taproot) and added (2,2) too. To test a bit larger variety, some other (2, _) were replaced with (3, _) as well.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T06:11:13Z",
      "diff_hunk" : "@@ -65,29 +67,39 @@\n ]\n # templates for valid bech32 sequences\n bech32_templates = [\n-  # hrp, version, witprog_size, metadata, output_prefix\n-  ('bc',    0, 20, (False, 'main',    None, True), p2wpkh_prefix),\n-  ('bc',    0, 32, (False, 'main',    None, True), p2wsh_prefix),\n-  ('bc',    1,  2, (False, 'main',    None, True), (OP_1, 2)),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592090257",
      "id" : 592090257,
      "in_reply_to_id" : 592056814,
      "line" : 71,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjA5MDI1Nw==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 71,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "contrib/testgen/gen_key_io_test_vectors.py",
      "position" : 62,
      "pull_request_review_id" : 609421172,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592090257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592250917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592250917"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think `-addresstype=bech32m` makes sense, e.g. `getnewaddress bech32m` as a way to request a taproot p2pk address. However it might be more future proof to use `-addresstype=tap` and  `getnewaddress tap`.\r\n\r\nLonger term I suspect it might be better to give wallet descriptors a name and then call `getnewaddress NAME`.\r\n\r\nSee also #15590 for some earlier discussions around this issue.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T10:41:24Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592250917",
      "id" : 592250917,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjI1MDkxNw==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 609619746,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592250917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-utACK 92ec3fcdd2f79949839ce269403396362bea9d54",
      "created_at" : "2021-03-11T10:44:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-796644013",
      "id" : 796644013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NjY0NDAxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-11T10:44:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/796644013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592311215"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592311215"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "s/350/341/\r\n\r\nd1054b98e5ec04cd3cdb487eaaf561926ef6c82d",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T12:15:04Z",
      "diff_hunk" : "@@ -0,0 +1,13 @@\n+Updated RPCs\n+------------\n+\n+- Due to [BIP 350](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)\n+  being implemented, behavior for all RPCs that accept addresses is changed when\n+  a native witness version 1 (or higher) is passed. These now require a Bech32m\n+  encoding instead of a Bech32 one, and Bech32m encoding will be used for such\n+  addresses in RPC output as well. No version 1 addresses should be created\n+  for mainnet until consensus rules are adopted that give them meaning\n+  (e.g. through [BIP 341](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592311215",
      "id" : 592311215,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjMxMTIxNQ==",
      "original_commit_id" : "d1054b98e5ec04cd3cdb487eaaf561926ef6c82d",
      "original_line" : 10,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/release-notes-20861.md",
      "position" : null,
      "pull_request_review_id" : 609695853,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592311215",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592671016"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592671016"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> However it might be more future proof to use `-addresstype=tap` and `getnewaddress tap`.\r\n\r\nI'm not sure. If Bech32m gets adopted as I hope it does, we won't need a new address type for post-taproot things anymore.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T19:43:30Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592671016",
      "id" : 592671016,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjY3MTAxNg==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 610159448,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592671016",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592693878"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592693878"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Since bech32m is (and bech32 was) intended to be used for different segwit versions, I think that we should actually move away from having bech32 or bech32m as the address type as with future segwit versions, it becomes ambiguous as to what type of address you want.\r\n\r\nFor example, suppose we introduce a segwit v2 that, like segwit v1, will encode a pubkey in the address. Now the wallet would have a descriptor for segwit v1, and another for segwit v2. If I wanted a segwit v1 address, what do I provide as the address type? If I provide `bech32m`, that's ambiguous because both segwit v1 and segwit v2 use `bech32m` addresses. We would have to come up with another name for segwit v2 addresses, and even then, it is still confusing because technically both are bech32m addresses.\r\n\r\nWith that in mind, I think we need to use a different and more unique naming scheme. Luckily this is pretty easy because segwit has version numbers, and proposals all have unique names. So for segwit v1 addresses, we could call the address type `tap` and just not expose bech32m in it.\r\n\r\nI have done a similar thing in HWI where segwit v0 is `wit` rather than `bech32`, and segwit v1 will be `tap`.\r\n\r\nLooking at it now, I do also think that having `bech32` as the address type for segwit v0 was not the right thing to do. It really should have just be `wit` or something like that that makes it unique to just segwit v0. Since bech32 is now segwit v0 only, it's fine, but in the future, we should not do the same thing.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T20:20:06Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592693878",
      "id" : 592693878,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjY5Mzg3OA==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 610188702,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592693878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592697525"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592697525"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How come this scenario is no longer relevant?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T20:26:16Z",
      "diff_hunk" : "@@ -16,28 +16,26 @@\n FUZZ_TARGET(bech32)\n {\n     const std::string random_string(buffer.begin(), buffer.end());\n-    const std::pair<std::string, std::vector<uint8_t>> r1 = bech32::Decode(random_string);\n-    if (r1.first.empty()) {\n-        assert(r1.second.empty());\n+    const auto r1 = bech32::Decode(random_string);\n+    if (r1.hrp.empty()) {\n+        assert(r1.data.empty());\n     } else {\n-        const std::string& hrp = r1.first;\n-        const std::vector<uint8_t>& data = r1.second;\n-        const std::string reencoded = bech32::Encode(hrp, data);\n+        const std::string reencoded = bech32::Encode(r1.encoding, r1.hrp, r1.data);\n         assert(CaseInsensitiveEqual(random_string, reencoded));\n     }\n \n     std::vector<unsigned char> input;\n     ConvertBits<8, 5, true>([&](unsigned char c) { input.push_back(c); }, buffer.begin(), buffer.end());\n-    const std::string encoded = bech32::Encode(\"bc\", input);\n-    assert(!encoded.empty());\n \n-    const std::pair<std::string, std::vector<uint8_t>> r2 = bech32::Decode(encoded);\n-    if (r2.first.empty()) {\n-        assert(r2.second.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592697525",
      "id" : 592697525,
      "line" : 36,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjY5NzUyNQ==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 36,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/test/fuzz/bech32.cpp",
      "position" : 27,
      "pull_request_review_id" : 610188702,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592697525",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592701017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592701017"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Now the wallet would have a descriptor for segwit v1, and another for segwit v2. If I wanted a segwit v1 address, what do I provide as the address type?\r\n\r\nI think that's the crucial point: why would you want that? If every sender supports both equally, you'd always produce whatever you have a descriptor for that is compatible with that.\r\n\r\nIf there is a reason for being more flexible, no objection to just using names or something. But then also, would you support having multiple distinct active descriptors that produce the same address type within the same wallet? I think that's the same problem.\r\n\r\nIf anything, I think we should have done things in the other direction; OutputTypes should have been LEGACY, BIP16, BECH32 or so (and BIP16 should have been both usable for multisig and segwit v0). Because those are the classes senders care about.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T20:31:41Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592701017",
      "id" : 592701017,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjcwMTAxNw==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 610197923,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592701017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592717345"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592717345"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The added `if` condition around it (which checks that the input is within acceptable range).",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T20:58:44Z",
      "diff_hunk" : "@@ -16,28 +16,26 @@\n FUZZ_TARGET(bech32)\n {\n     const std::string random_string(buffer.begin(), buffer.end());\n-    const std::pair<std::string, std::vector<uint8_t>> r1 = bech32::Decode(random_string);\n-    if (r1.first.empty()) {\n-        assert(r1.second.empty());\n+    const auto r1 = bech32::Decode(random_string);\n+    if (r1.hrp.empty()) {\n+        assert(r1.data.empty());\n     } else {\n-        const std::string& hrp = r1.first;\n-        const std::vector<uint8_t>& data = r1.second;\n-        const std::string reencoded = bech32::Encode(hrp, data);\n+        const std::string reencoded = bech32::Encode(r1.encoding, r1.hrp, r1.data);\n         assert(CaseInsensitiveEqual(random_string, reencoded));\n     }\n \n     std::vector<unsigned char> input;\n     ConvertBits<8, 5, true>([&](unsigned char c) { input.push_back(c); }, buffer.begin(), buffer.end());\n-    const std::string encoded = bech32::Encode(\"bc\", input);\n-    assert(!encoded.empty());\n \n-    const std::pair<std::string, std::vector<uint8_t>> r2 = bech32::Decode(encoded);\n-    if (r2.first.empty()) {\n-        assert(r2.second.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592717345",
      "id" : 592717345,
      "in_reply_to_id" : 592697525,
      "line" : 36,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjcxNzM0NQ==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 36,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/test/fuzz/bech32.cpp",
      "position" : 27,
      "pull_request_review_id" : 610218656,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592717345",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592731006"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592731006"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> I think that's the crucial point: why would you want that? If every sender supports both equally, you'd always produce whatever you have a descriptor for that is compatible with that.\r\n\r\nIn the ideal world, sure. But as we have seen with segwit, that's not guaranteed. Even though senders were supposed to allow any segwit version with bech32, they didn't. I'm not sure that everyone will understand to do that with bech32m.\r\n\r\nThe address type option is not just for senders. It's also for receivers and what they are comfortable with receiving. I could conceive of a situation where someone sets up a new wallet but wants to use v1 instead of v2 because, e.g., v2 introduces some new signature algo that has assumptions they aren't comfortable with using. What would they have to do to use v1?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T21:22:04Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592731006",
      "id" : 592731006,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjczMTAwNg==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 610235921,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592731006",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592735937"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592735937"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> In the ideal world, sure. But as we have seen with segwit, that's not guaranteed. Even though senders were supposed to allow any segwit version with bech32, they didn't. I'm not sure that everyone will understand to do that with bech32m.\r\n\r\nSure, that's why I suggest we may want to add an OutputType::BECH32M - precisely because Bech32 and Bech32m may differ for senders. But p2sh vs. p2sh-p2wpk shouldn't be distinguished, for example.\r\n\r\n> I could conceive of a situation where someone sets up a new wallet but wants to use v1 instead of v2 because, e.g., v2 introduces some new signature algo that has assumptions they aren't comfortable with using. What would they have to do to use v1?\r\n\r\nThat's fair, and was a good argument for segwit vs non-segwit in pre-descriptor wallets. But in descriptor wallets if you don't want witness v9 addresses because you're not comfortable with them, simply don't import/create such a descriptor.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T21:30:41Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592735937",
      "id" : 592735937,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjczNTkzNw==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 610242395,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592735937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592768459"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592768459"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Sure, that's why I suggest we may want to add an OutputType::BECH32M - precisely because Bech32 and Bech32m may differ for senders.\r\n\r\nYes, I agree with doing that.\r\n\r\n> But in descriptor wallets if you don't want witness v9 addresses because you're not comfortable with them, simply don't import/create such a descriptor.\r\n\r\nThat's reasonable, but I think it's too onerous on users to have to figure out which and how to create the descriptor that they want. I think it's reasonable that user would know about different address types and, at a high level, the consequences of using each type, but also not know (or be afraid of) the descriptor syntax, which derivation paths to use, safely handling xprvs for import, etc. I suppose we could add more options to the wallet creation stuff, but that still means the user has to deal with descriptors directly once they feel comfortable enough to upgrade, or they have to make a wholly new wallet.\r\n\r\nIf instead the wallet generated v1 and v2 descriptors, then the user could switch to the new address type by choosing the option and it's very simple and easy to do so.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-11T22:30:25Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r592768459",
      "id" : 592768459,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Mjc2ODQ1OQ==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 610283191,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592768459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Approach ACK, reviewing.",
      "created_at" : "2021-03-12T20:30:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-797737912",
      "id" : 797737912,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NzczNzkxMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-12T20:30:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797737912",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593464165"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593464165"
         }
      },
      "author_association" : "MEMBER",
      "body" : "402cbb2 Perhaps move the `data` type alias to the header file to use it uniformly in `bech32.{h, cpp}`\r\n\r\n<details><summary>example code diff</summary><p>\r\n\r\n```diff\r\ndiff --git a/src/bech32.cpp b/src/bech32.cpp\r\nindex 80794ec4f1..60d4d72ca5 100644\r\n--- a/src/bech32.cpp\r\n+++ b/src/bech32.cpp\r\n@@ -13,8 +13,6 @@ namespace bech32\r\n\r\n-typedef std::vector<uint8_t> data;\r\n-\r\n /** The Bech32 character set for encoding. */\r\n const char* CHARSET = \"qpzry9x8gf2tvdw0s3jn54khce6mua7l\";\r\n \r\ndiff --git a/src/bech32.h b/src/bech32.h\r\nindex 3679ea8ccb..7a601a7b97 100644\r\n--- a/src/bech32.h\r\n+++ b/src/bech32.h\r\n@@ -16,6 +16,8 @@\r\n #include <string>\r\n #include <vector>\r\n \r\n+typedef std::vector<uint8_t> data;\r\n+\r\n namespace bech32\r\n {\r\n \r\n@@ -28,16 +30,16 @@ enum class Encoding {\r\n \r\n /** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\r\n  *  assertion error. Encoding must be one of BECH32 or BECH32M. */\r\n-std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);\r\n+std::string Encode(Encoding encoding, const std::string& hrp, const data& values);\r\n \r\n struct DecodeResult\r\n {\r\n-    Encoding encoding;         //!< What encoding was detected in the result; Encoding::INVALID if failed.\r\n-    std::string hrp;           //!< The human readable part\r\n-    std::vector<uint8_t> data; //!< The payload (excluding checksum)\r\n+    Encoding encoding; //!< What encoding was detected in the result; Encoding::INVALID if failed.\r\n+    std::string hrp;   //!< The human readable part\r\n+    data data;         //!< The payload (excluding checksum)\r\n \r\n     DecodeResult() : encoding(Encoding::INVALID) {}\r\n-    DecodeResult(Encoding enc, std::string&& h, std::vector<uint8_t>&& d) : encoding(enc), hrp(std::move(h)), data(std::move(d)) {}\r\n+    DecodeResult(Encoding enc, std::string&& h, ::data&& d) : encoding(enc), hrp(std::move(h)), data(std::move(d)) {}\r\n };\r\n ```\r\n</p></details>\r\n\r\n ",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-12T21:36:12Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593464165",
      "id" : 593464165,
      "line" : 32,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzQ2NDE2NQ==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 31,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 38,
      "pull_request_review_id" : 611169358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593464165",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593465566"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593465566"
         }
      },
      "author_association" : "MEMBER",
      "body" : "402cbb29516d5bf03a18822af9f1b4b574f319ac pico-nits, `check` can be `const` (and braced initialization for type safety)\r\n```suggestion\r\n    const uint32_t check{PolyMod(Cat(ExpandHRP(hrp), values))};\r\n```\r\n\r\nIdem for `mod` on line 140, `result` on line 195, and `version` in `key_io.cpp::L106`",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-12T21:39:14Z",
      "diff_hunk" : "@@ -111,21 +120,24 @@ data ExpandHRP(const std::string& hrp)\n }\n \n /** Verify a checksum. */\n-bool VerifyChecksum(const std::string& hrp, const data& values)\n+Encoding VerifyChecksum(const std::string& hrp, const data& values)\n {\n     // PolyMod computes what value to xor into the final values to make the checksum 0. However,\n     // if we required that the checksum was 0, it would be the case that appending a 0 to a valid\n     // list of values would result in a new valid list. For that reason, Bech32 requires the\n-    // resulting checksum to be 1 instead.\n-    return PolyMod(Cat(ExpandHRP(hrp), values)) == 1;\n+    // resulting checksum to be 1 instead. In Bech32m, this constant was amended.\n+    uint32_t check = PolyMod(Cat(ExpandHRP(hrp), values));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593465566",
      "id" : 593465566,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzQ2NTU2Ng==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 129,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : null,
      "pull_request_review_id" : 611169358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593465566",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593470134"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593470134"
         }
      },
      "author_association" : "MEMBER",
      "body" : "d1054b98e nit, s/system/systems/ and omit comma\r\n```suggestion\r\n  affect any production systems but may be observed on other networks where such\r\n```",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-12T21:49:17Z",
      "diff_hunk" : "@@ -0,0 +1,13 @@\n+Updated RPCs\n+------------\n+\n+- Due to [BIP 350](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)\n+  being implemented, behavior for all RPCs that accept addresses is changed when\n+  a native witness version 1 (or higher) is passed. These now require a Bech32m\n+  encoding instead of a Bech32 one, and Bech32m encoding will be used for such\n+  addresses in RPC output as well. No version 1 addresses should be created\n+  for mainnet until consensus rules are adopted that give them meaning\n+  (e.g. through [BIP 341](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)).\n+  Once that happens, Bech32m is expected to be used for them, so this shouldn't\n+  affect any production system, but may be observed on other networks where such",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593470134",
      "id" : 593470134,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzQ3MDEzNA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 12,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "doc/release-notes-20861.md",
      "position" : null,
      "pull_request_review_id" : 611169358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593470134",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593471343"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593471343"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Checking for encoding type may be done frequently enough to consider adding helper functions (not necessarily in this PR). ",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-12T21:52:01Z",
      "diff_hunk" : "@@ -27,6 +30,12 @@ const int8_t CHARSET_REV[128] = {\n      1,  0,  3, 16, 11, 28, 12, 14,  6,  4,  2, -1, -1, -1, -1, -1\n };\n \n+/* Determine the final constant to use for the specified encoding. */\n+uint32_t EncodingConstant(Encoding encoding) {\n+    assert(encoding == Encoding::BECH32 || encoding == Encoding::BECH32M);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593471343",
      "id" : 593471343,
      "line" : 35,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzQ3MTM0Mw==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 35,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : 33,
      "pull_request_review_id" : 611169358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593471343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593510753"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593510753"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm going to mark this as resolved; we've discussed this in today's wallet meeting. It's not exactly clear how to proceed, but in any case, I don't think this is something for this PR. Please respond if you don't agree.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-12T23:47:23Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593510753",
      "id" : 593510753,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzUxMDc1Mw==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 611224200,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593510753",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593512866"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593512866"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Discussion: http://www.erisian.com.au/bitcoin-core-dev/log-2021-03-12.html#l-286",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-12T23:55:30Z",
      "diff_hunk" : "@@ -62,7 +62,7 @@ class DestinationEncoder\n         std::vector<unsigned char> data = {(unsigned char)id.version};\n         data.reserve(1 + (id.length * 8 + 4) / 5);\n         ConvertBits<8, 5, true>([&](unsigned char c) { data.push_back(c); }, id.program, id.program + id.length);\n-        return bech32::Encode(bech32::Encoding::BECH32, m_params.Bech32HRP(), data);\n+        return bech32::Encode(bech32::Encoding::BECH32M, m_params.Bech32HRP(), data);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593512866",
      "id" : 593512866,
      "in_reply_to_id" : 592054623,
      "line" : 65,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzUxMjg2Ng==",
      "original_commit_id" : "ea3995aa3cd8f04d7328c95a43c79a5b20fa18a5",
      "original_line" : 65,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/key_io.cpp",
      "position" : 23,
      "pull_request_review_id" : 611233309,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593512866",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593938931"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593938931"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not necessarily for this PR but we may want to think about renaming this to `BECH32Legacy` or `BECH32v0` or so. In the code right now sometimes \"bech32\" refers to BIP173 specifically and sometimes to both BIP173 and BIP350. In this line it's the former case, in the namespace it's the latter case. I can see people getting confused by that in the future.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-14T18:07:25Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r593938931",
      "id" : 593938931,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MzkzODkzMQ==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 25,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 32,
      "pull_request_review_id" : 611722636,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/593938931",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594153824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594153824"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think we want to pollute the global namespace with a type called `data`.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T09:00:11Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594153824",
      "id" : 594153824,
      "in_reply_to_id" : 593464165,
      "line" : 32,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDE1MzgyNA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 31,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 38,
      "pull_request_review_id" : 611955130,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594153824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594166019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594166019"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The caller can't do anything with a `DecodeResult` where encoding is `Encoding::INVALID`, so changing this return type to `std::optional<DecodeResult>` and removing the `Encoding::INVALID` enum type feels more natural to me.\r\n\r\n<details>\r\n<summary>Diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/bech32.cpp b/src/bech32.cpp\r\nindex 80794ec4f1..2fd84b395b 100644\r\n--- a/src/bech32.cpp\r\n+++ b/src/bech32.cpp\r\n@@ -6,6 +6,7 @@\r\n #include <util/vector.h>\r\n \r\n #include <assert.h>\r\n+#include <optional>\r\n \r\n namespace bech32\r\n {\r\n@@ -120,7 +121,7 @@ data ExpandHRP(const std::string& hrp)\r\n }\r\n \r\n /** Verify a checksum. */\r\n-Encoding VerifyChecksum(const std::string& hrp, const data& values)\r\n+std::optional<Encoding> VerifyChecksum(const std::string& hrp, const data& values)\r\n {\r\n     // PolyMod computes what value to xor into the final values to make the checksum 0. However,\r\n     // if we required that the checksum was 0, it would be the case that appending a 0 to a valid\r\n@@ -129,7 +130,7 @@ Encoding VerifyChecksum(const std::string& hrp, const data& values)\r\n     uint32_t check = PolyMod(Cat(ExpandHRP(hrp), values));\r\n     if (check == EncodingConstant(Encoding::BECH32)) return Encoding::BECH32;\r\n     if (check == EncodingConstant(Encoding::BECH32M)) return Encoding::BECH32M;\r\n-    return Encoding::INVALID;\r\n+    return {};\r\n }\r\n \r\n /** Create a checksum. */\r\n@@ -165,7 +166,7 @@ std::string Encode(Encoding encoding, const std::string& hrp, const data& values\r\n }\r\n \r\n /** Decode a Bech32 or Bech32m string. */\r\n-DecodeResult Decode(const std::string& str) {\r\n+std::optional<DecodeResult> Decode(const std::string& str) {\r\n     bool lower = false, upper = false;\r\n     for (size_t i = 0; i < str.size(); ++i) {\r\n         unsigned char c = str[i];\r\n@@ -192,9 +193,9 @@ DecodeResult Decode(const std::string& str) {\r\n     for (size_t i = 0; i < pos; ++i) {\r\n         hrp += LowerCase(str[i]);\r\n     }\r\n-    Encoding result = VerifyChecksum(hrp, values);\r\n-    if (result == Encoding::INVALID) return {};\r\n-    return {result, std::move(hrp), data(values.begin(), values.end() - 6)};\r\n+    auto result = VerifyChecksum(hrp, values);\r\n+    if (!result) return {};\r\n+    return {{*result, std::move(hrp), data(values.begin(), values.end() - 6)}};\r\n }\r\n \r\n } // namespace bech32\r\ndiff --git a/src/bech32.h b/src/bech32.h\r\nindex 3679ea8ccb..f2f294bc3f 100644\r\n--- a/src/bech32.h\r\n+++ b/src/bech32.h\r\n@@ -12,6 +12,7 @@\r\n #ifndef BITCOIN_BECH32_H\r\n #define BITCOIN_BECH32_H\r\n \r\n+#include <optional>\r\n #include <stdint.h>\r\n #include <string>\r\n #include <vector>\r\n@@ -20,8 +21,6 @@ namespace bech32\r\n {\r\n \r\n enum class Encoding {\r\n-    INVALID, //!< Failed decoding\r\n-\r\n     BECH32,  //!< Bech32 encoding as defined in BIP173\r\n     BECH32M, //!< Bech32m encoding as defined in BIP350\r\n };\r\n@@ -32,16 +31,15 @@ std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<\r\n \r\n struct DecodeResult\r\n {\r\n-    Encoding encoding;         //!< What encoding was detected in the result; Encoding::INVALID if failed.\r\n+    Encoding encoding;         //!< What encoding was detected in the result\r\n     std::string hrp;           //!< The human readable part\r\n     std::vector<uint8_t> data; //!< The payload (excluding checksum)\r\n \r\n-    DecodeResult() : encoding(Encoding::INVALID) {}\r\n     DecodeResult(Encoding enc, std::string&& h, std::vector<uint8_t>&& d) : encoding(enc), hrp(std::move(h)), data(std::move(d)) {}\r\n };\r\n \r\n /** Decode a Bech32 string. */\r\n-DecodeResult Decode(const std::string& str);\r\n+std::optional<DecodeResult> Decode(const std::string& str);\r\n \r\n } // namespace bech32\r\n \r\ndiff --git a/src/key_io.cpp b/src/key_io.cpp\r\nindex dbcbfa1f29..dbb4711d42 100644\r\n--- a/src/key_io.cpp\r\n+++ b/src/key_io.cpp\r\n@@ -96,25 +96,25 @@ CTxDestination DecodeDestination(const std::string& str, const CChainParams& par\r\n     }\r\n     data.clear();\r\n     const auto dec = bech32::Decode(str);\r\n-    if ((dec.encoding == bech32::Encoding::BECH32 || dec.encoding == bech32::Encoding::BECH32M) && dec.data.size() > 0) {\r\n+    if (dec && dec->data.size() > 0) {\r\n         // Bech32 decoding\r\n         error_str = \"\";\r\n-        if (dec.hrp != params.Bech32HRP()) {\r\n+        if (dec->hrp != params.Bech32HRP()) {\r\n             error_str = \"Invalid prefix for Bech32 address\";\r\n             return CNoDestination();\r\n         }\r\n-        int version = dec.data[0]; // The first 5 bit symbol is the witness version (0-16)\r\n-        if (version == 0 && dec.encoding != bech32::Encoding::BECH32) {\r\n+        int version = dec->data[0]; // The first 5 bit symbol is the witness version (0-16)\r\n+        if (version == 0 && dec->encoding != bech32::Encoding::BECH32) {\r\n             error_str = \"Version 0 witness address must use Bech32 checksum\";\r\n             return CNoDestination();\r\n         }\r\n-        if (version != 0 && dec.encoding != bech32::Encoding::BECH32M) {\r\n+        if (version != 0 && dec->encoding != bech32::Encoding::BECH32M) {\r\n             error_str = \"Version 1+ witness address must use Bech32m checksum\";\r\n             return CNoDestination();\r\n         }\r\n         // The rest of the symbols are converted witness program bytes.\r\n-        data.reserve(((dec.data.size() - 1) * 5) / 8);\r\n-        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, dec.data.begin() + 1, dec.data.end())) {\r\n+        data.reserve(((dec->data.size() - 1) * 5) / 8);\r\n+        if (ConvertBits<5, 8, false>([&](unsigned char c) { data.push_back(c); }, dec->data.begin() + 1, dec->data.end())) {\r\n             if (version == 0) {\r\n                 {\r\n                     WitnessV0KeyHash keyid;\r\ndiff --git a/src/test/bech32_tests.cpp b/src/test/bech32_tests.cpp\r\nindex 2651e46430..835d3a1c79 100644\r\n--- a/src/test/bech32_tests.cpp\r\n+++ b/src/test/bech32_tests.cpp\r\n@@ -23,8 +23,9 @@ BOOST_AUTO_TEST_CASE(bech32_testvectors_valid)\r\n     };\r\n     for (const std::string& str : CASES) {\r\n         const auto dec = bech32::Decode(str);\r\n-        BOOST_CHECK(dec.encoding == bech32::Encoding::BECH32);\r\n-        std::string recode = bech32::Encode(bech32::Encoding::BECH32, dec.hrp, dec.data);\r\n+        BOOST_CHECK(dec);\r\n+        BOOST_CHECK(dec->encoding == bech32::Encoding::BECH32);\r\n+        std::string recode = bech32::Encode(bech32::Encoding::BECH32, dec->hrp, dec->data);\r\n         BOOST_CHECK(!recode.empty());\r\n         BOOST_CHECK(CaseInsensitiveEqual(str, recode));\r\n     }\r\n@@ -43,8 +44,9 @@ BOOST_AUTO_TEST_CASE(bech32m_testvectors_valid)\r\n     };\r\n     for (const std::string& str : CASES) {\r\n         const auto dec = bech32::Decode(str);\r\n-        BOOST_CHECK(dec.encoding == bech32::Encoding::BECH32M);\r\n-        std::string recode = bech32::Encode(bech32::Encoding::BECH32M, dec.hrp, dec.data);\r\n+        BOOST_CHECK(dec);\r\n+        BOOST_CHECK(dec->encoding == bech32::Encoding::BECH32M);\r\n+        std::string recode = bech32::Encode(bech32::Encoding::BECH32M, dec->hrp, dec->data);\r\n         BOOST_CHECK(!recode.empty());\r\n         BOOST_CHECK(CaseInsensitiveEqual(str, recode));\r\n     }\r\n@@ -70,7 +72,7 @@ BOOST_AUTO_TEST_CASE(bech32_testvectors_invalid)\r\n     };\r\n     for (const std::string& str : CASES) {\r\n         const auto dec = bech32::Decode(str);\r\n-        BOOST_CHECK(dec.encoding == bech32::Encoding::INVALID);\r\n+        BOOST_CHECK(!dec);\r\n     }\r\n }\r\n \r\n@@ -94,7 +96,7 @@ BOOST_AUTO_TEST_CASE(bech32m_testvectors_invalid)\r\n     };\r\n     for (const std::string& str : CASES) {\r\n         const auto dec = bech32::Decode(str);\r\n-        BOOST_CHECK(dec.encoding == bech32::Encoding::INVALID);\r\n+        BOOST_CHECK(!dec);\r\n     }\r\n }\r\n \r\ndiff --git a/src/test/fuzz/bech32.cpp b/src/test/fuzz/bech32.cpp\r\nindex 15a3875828..c794fdafc3 100644\r\n--- a/src/test/fuzz/bech32.cpp\r\n+++ b/src/test/fuzz/bech32.cpp\r\n@@ -17,10 +17,8 @@ FUZZ_TARGET(bech32)\r\n {\r\n     const std::string random_string(buffer.begin(), buffer.end());\r\n     const auto r1 = bech32::Decode(random_string);\r\n-    if (r1.hrp.empty()) {\r\n-        assert(r1.data.empty());\r\n-    } else {\r\n-        const std::string reencoded = bech32::Encode(r1.encoding, r1.hrp, r1.data);\r\n+    if (r1) {\r\n+        const std::string reencoded = bech32::Encode(r1->encoding, r1->hrp, r1->data);\r\n         assert(CaseInsensitiveEqual(random_string, reencoded));\r\n     }\r\n \r\n@@ -33,9 +31,10 @@ FUZZ_TARGET(bech32)\r\n             const std::string encoded = bech32::Encode(encoding, \"bc\", input);\r\n             assert(!encoded.empty());\r\n             const auto r2 = bech32::Decode(encoded);\r\n-            assert(r2.encoding == encoding);\r\n-            assert(r2.hrp == \"bc\");\r\n-            assert(r2.data == input);\r\n+            assert(r2);\r\n+            assert(r2->encoding == encoding);\r\n+            assert(r2->hrp == \"bc\");\r\n+            assert(r2->data == input);\r\n         }\r\n     }\r\n }\r\n```\r\n\r\n</details>\r\n\r\nNote that we've removed the following check from the fuzz tester:\r\n\r\n```diff\r\n-    if (r1.hrp.empty()) {\r\n-        assert(r1.data.empty());\r\n```\r\n\r\nThat inconsistent state can't exist where `DecodeResult` only contains a successfully decoded bech32{m} string.\r\n\r\nEDIT: I guess you're not using std::optional so it's easier to backport to versions that don't require c++17?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T09:18:09Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);\n+\n+struct DecodeResult\n+{\n+    Encoding encoding;         //!< What encoding was detected in the result; Encoding::INVALID if failed.\n+    std::string hrp;           //!< The human readable part\n+    std::vector<uint8_t> data; //!< The payload (excluding checksum)\n+\n+    DecodeResult() : encoding(Encoding::INVALID) {}\n+    DecodeResult(Encoding enc, std::string&& h, std::vector<uint8_t>&& d) : encoding(enc), hrp(std::move(h)), data(std::move(d)) {}\n+};\n+\n+/** Decode a Bech32 string. */\n+DecodeResult Decode(const std::string& str);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594166019",
      "id" : 594166019,
      "line" : 45,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDE2NjAxOQ==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 44,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 51,
      "pull_request_review_id" : 611955130,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594166019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594172283"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594172283"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is there a reason that this isn't simply a `std::map<Encoding, uint32_t>`?\r\n\r\nThis can be `constexpr`ed to evaluate this in compile time for the `VerifyChecksum()` case:\r\n\r\n```suggestion\r\nconstexpr uint32_t EncodingConstant(Encoding encoding) {\r\n```",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T09:27:01Z",
      "diff_hunk" : "@@ -27,6 +30,12 @@ const int8_t CHARSET_REV[128] = {\n      1,  0,  3, 16, 11, 28, 12, 14,  6,  4,  2, -1, -1, -1, -1, -1\n };\n \n+/* Determine the final constant to use for the specified encoding. */\n+uint32_t EncodingConstant(Encoding encoding) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594172283",
      "id" : 594172283,
      "line" : 34,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDE3MjI4Mw==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 34,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : 32,
      "pull_request_review_id" : 611955130,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594172283",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594177361"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594177361"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's slightly inconsistent that in the c++ code, this is called `encoding` and is the first argument, and here it's `spec` and the last argument.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T09:34:08Z",
      "diff_hunk" : "@@ -27,38 +34,45 @@ def bech32_hrp_expand(hrp):\n \n def bech32_verify_checksum(hrp, data):\n     \"\"\"Verify a checksum given HRP and converted data characters.\"\"\"\n-    return bech32_polymod(bech32_hrp_expand(hrp) + data) == 1\n-\n+    check = bech32_polymod(bech32_hrp_expand(hrp) + data)\n+    if check == 1:\n+        return Encoding.BECH32\n+    elif check == BECH32M_CONST:\n+        return Encoding.BECH32M\n+    else:\n+        return None\n \n-def bech32_create_checksum(hrp, data):\n+def bech32_create_checksum(hrp, data, spec):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594177361",
      "id" : 594177361,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDE3NzM2MQ==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 45,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/segwit_addr.py",
      "position" : null,
      "pull_request_review_id" : 611955130,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594177361",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594177702"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594177702"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps add constant `BECH32_CONST = 1`",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T09:34:39Z",
      "diff_hunk" : "@@ -27,38 +34,45 @@ def bech32_hrp_expand(hrp):\n \n def bech32_verify_checksum(hrp, data):\n     \"\"\"Verify a checksum given HRP and converted data characters.\"\"\"\n-    return bech32_polymod(bech32_hrp_expand(hrp) + data) == 1\n-\n+    check = bech32_polymod(bech32_hrp_expand(hrp) + data)\n+    if check == 1:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594177702",
      "id" : 594177702,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDE3NzcwMg==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 38,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/segwit_addr.py",
      "position" : null,
      "pull_request_review_id" : 611955130,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594177702",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594579018"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594579018"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point indeed: https://google.github.io/styleguide/cppguide.html#Aliases. \"However, local convenience aliases are fine in function definitions, private sections of classes, explicitly marked internal namespaces, and in .cc (.cpp) files.\"",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T18:19:46Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594579018",
      "id" : 594579018,
      "in_reply_to_id" : 593464165,
      "line" : 32,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDU3OTAxOA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 31,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 38,
      "pull_request_review_id" : 612511827,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594579018",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594593139"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594593139"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 402cbb29516d5bf03a18822af9f1b4b574f319ac \"Implement Bech32m encoding/decoding\"\r\n\r\nIt would be nice to also check that the encoding is `Encoding::INVALID`",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T18:39:30Z",
      "diff_hunk" : "@@ -16,28 +16,26 @@\n FUZZ_TARGET(bech32)\n {\n     const std::string random_string(buffer.begin(), buffer.end());\n-    const std::pair<std::string, std::vector<uint8_t>> r1 = bech32::Decode(random_string);\n-    if (r1.first.empty()) {\n-        assert(r1.second.empty());\n+    const auto r1 = bech32::Decode(random_string);\n+    if (r1.hrp.empty()) {\n+        assert(r1.data.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594593139",
      "id" : 594593139,
      "line" : 22,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDU5MzEzOQ==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 22,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/test/fuzz/bech32.cpp",
      "position" : 10,
      "pull_request_review_id" : 612529475,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594593139",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594593511"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594593511"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In d1054b98e5ec04cd3cdb487eaaf561926ef6c82d \"Use Bech32m encoding for v1+ segwit addresses\"\r\n\r\nI think you meant https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki (341, not 350)",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T18:40:06Z",
      "diff_hunk" : "@@ -0,0 +1,13 @@\n+Updated RPCs\n+------------\n+\n+- Due to [BIP 350](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)\n+  being implemented, behavior for all RPCs that accept addresses is changed when\n+  a native witness version 1 (or higher) is passed. These now require a Bech32m\n+  encoding instead of a Bech32 one, and Bech32m encoding will be used for such\n+  addresses in RPC output as well. No version 1 addresses should be created\n+  for mainnet until consensus rules are adopted that give them meaning\n+  (e.g. through [BIP 341](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594593511",
      "id" : 594593511,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDU5MzUxMQ==",
      "original_commit_id" : "d1054b98e5ec04cd3cdb487eaaf561926ef6c82d",
      "original_line" : 10,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/release-notes-20861.md",
      "position" : null,
      "pull_request_review_id" : 612529475,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594593511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594610201"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594610201"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 92ec3fcdd2f79949839ce269403396362bea9d54 \"Add signet support to gen_key_io_test_vectors.py\"\r\n\r\nThere is a similar comment at the top of `contrib/testgen/gen_key_io_test_vectors.py` which should either be updated or removed. Also that comment says the file is for Base58 addresses when clearly both Base58 and Bech32 things are generated in it.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T19:06:05Z",
      "diff_hunk" : "@@ -4,5 +4,5 @@ Utilities to generate test vectors for the data-driven Bitcoin tests.\n \n Usage:\n \n-    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py valid 50 > ../../src/test/data/key_io_valid.json\n-    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py invalid 50 > ../../src/test/data/key_io_invalid.json\n+    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py valid 70 > ../../src/test/data/key_io_valid.json\n+    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py invalid 70 > ../../src/test/data/key_io_invalid.json",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594610201",
      "id" : 594610201,
      "line" : 8,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDYxMDIwMQ==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 8,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "contrib/testgen/README.md",
      "position" : 7,
      "pull_request_review_id" : 612529475,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594610201",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594750050"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594750050"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps this is more personal style. I don't think this is an improvement.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T23:08:27Z",
      "diff_hunk" : "@@ -111,21 +120,24 @@ data ExpandHRP(const std::string& hrp)\n }\n \n /** Verify a checksum. */\n-bool VerifyChecksum(const std::string& hrp, const data& values)\n+Encoding VerifyChecksum(const std::string& hrp, const data& values)\n {\n     // PolyMod computes what value to xor into the final values to make the checksum 0. However,\n     // if we required that the checksum was 0, it would be the case that appending a 0 to a valid\n     // list of values would result in a new valid list. For that reason, Bech32 requires the\n-    // resulting checksum to be 1 instead.\n-    return PolyMod(Cat(ExpandHRP(hrp), values)) == 1;\n+    // resulting checksum to be 1 instead. In Bech32m, this constant was amended.\n+    uint32_t check = PolyMod(Cat(ExpandHRP(hrp), values));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594750050",
      "id" : 594750050,
      "in_reply_to_id" : 593465566,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc1MDA1MA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 129,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : null,
      "pull_request_review_id" : 612727328,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594750050",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594751091"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594751091"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps it's worth having a global typedef for this (maybe with a more descriptive name than `data`), but if so, I think it's something for a different PR.\r\n\r\nClosing this.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T23:09:25Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594751091",
      "id" : 594751091,
      "in_reply_to_id" : 593464165,
      "line" : 32,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc1MTA5MQ==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 31,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 38,
      "pull_request_review_id" : 612727734,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594751091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594752331"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594752331"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think that's the right solution. The bech32 module is independent of the concept of segwit or bitcoin or addresses or witness versions. If there are other places where the name bech32 is used in a confusing way to include bech32m, feel free to point them out so they can be fixed (in this PR or elsewhere).",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T23:11:33Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594752331",
      "id" : 594752331,
      "in_reply_to_id" : 593938931,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc1MjMzMQ==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 25,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 32,
      "pull_request_review_id" : 612728715,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594752331",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594752698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594752698"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@jnewbery Yes, exactly. I considered that, but decided against it, as I prefer to have something maximally backportable.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T23:12:31Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);\n+\n+struct DecodeResult\n+{\n+    Encoding encoding;         //!< What encoding was detected in the result; Encoding::INVALID if failed.\n+    std::string hrp;           //!< The human readable part\n+    std::vector<uint8_t> data; //!< The payload (excluding checksum)\n+\n+    DecodeResult() : encoding(Encoding::INVALID) {}\n+    DecodeResult(Encoding enc, std::string&& h, std::vector<uint8_t>&& d) : encoding(enc), hrp(std::move(h)), data(std::move(d)) {}\n+};\n+\n+/** Decode a Bech32 string. */\n+DecodeResult Decode(const std::string& str);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594752698",
      "id" : 594752698,
      "in_reply_to_id" : 594166019,
      "line" : 45,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc1MjY5OA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 44,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 51,
      "pull_request_review_id" : 612729152,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594752698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594753385"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594753385"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hmm, a map feels like a lot more heavyweight/overkill to me.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T23:14:15Z",
      "diff_hunk" : "@@ -27,6 +30,12 @@ const int8_t CHARSET_REV[128] = {\n      1,  0,  3, 16, 11, 28, 12, 14,  6,  4,  2, -1, -1, -1, -1, -1\n };\n \n+/* Determine the final constant to use for the specified encoding. */\n+uint32_t EncodingConstant(Encoding encoding) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594753385",
      "id" : 594753385,
      "in_reply_to_id" : 594172283,
      "line" : 34,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc1MzM4NQ==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 34,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : 32,
      "pull_request_review_id" : 612730017,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594753385",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594755534"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594755534"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Making it `constexpr` will prevent backporting to pre-C++17 code. It's also unnecessary (constexpr doesn't control whether the compiler can evaluate at compile time as an optimization, only whether you can use it in compile-time expressions).",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T23:20:00Z",
      "diff_hunk" : "@@ -27,6 +30,12 @@ const int8_t CHARSET_REV[128] = {\n      1,  0,  3, 16, 11, 28, 12, 14,  6,  4,  2, -1, -1, -1, -1, -1\n };\n \n+/* Determine the final constant to use for the specified encoding. */\n+uint32_t EncodingConstant(Encoding encoding) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594755534",
      "id" : 594755534,
      "in_reply_to_id" : 594172283,
      "line" : 34,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc1NTUzNA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 34,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : 32,
      "pull_request_review_id" : 612732540,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594755534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594756287"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594756287"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure what you're suggesting concretely here.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-15T23:22:11Z",
      "diff_hunk" : "@@ -27,6 +30,12 @@ const int8_t CHARSET_REV[128] = {\n      1,  0,  3, 16, 11, 28, 12, 14,  6,  4,  2, -1, -1, -1, -1, -1\n };\n \n+/* Determine the final constant to use for the specified encoding. */\n+uint32_t EncodingConstant(Encoding encoding) {\n+    assert(encoding == Encoding::BECH32 || encoding == Encoding::BECH32M);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594756287",
      "id" : 594756287,
      "in_reply_to_id" : 593471343,
      "line" : 35,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc1NjI4Nw==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 35,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : 33,
      "pull_request_review_id" : 612733416,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594756287",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594771528"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594771528"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think explicitly asserting is purposefully done to give a sort of code-visual cue on where updates are required, after adding additional encodings in the future, so I don't think helper functions would be appropriate here.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T00:04:43Z",
      "diff_hunk" : "@@ -27,6 +30,12 @@ const int8_t CHARSET_REV[128] = {\n      1,  0,  3, 16, 11, 28, 12, 14,  6,  4,  2, -1, -1, -1, -1, -1\n };\n \n+/* Determine the final constant to use for the specified encoding. */\n+uint32_t EncodingConstant(Encoding encoding) {\n+    assert(encoding == Encoding::BECH32 || encoding == Encoding::BECH32M);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594771528",
      "id" : 594771528,
      "in_reply_to_id" : 593471343,
      "line" : 35,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc3MTUyOA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 35,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : 33,
      "pull_request_review_id" : 612750477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594771528",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Addressed comments. Rebased + made the following changes:\r\n\r\n```patch\r\ndiff --git a/contrib/testgen/gen_key_io_test_vectors.py b/contrib/testgen/gen_key_io_test_vectors.py\r\nindex 6b985b8ec2..2f3189eca9 100755\r\n--- a/contrib/testgen/gen_key_io_test_vectors.py\r\n+++ b/contrib/testgen/gen_key_io_test_vectors.py\r\n@@ -3,11 +3,11 @@\r\n # Distributed under the MIT software license, see the accompanying\r\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n '''\r\n-Generate valid and invalid base58 address and private key test vectors.\r\n+Generate valid and invalid base58/bech32(m) address and private key test vectors.\r\n \r\n Usage:\r\n-    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py valid 50 > ../../src/test/data/key_io_valid.json\r\n-    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py invalid 50 > ../../src/test/data/key_io_invalid.json\r\n+    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py valid 70 > ../../src/test/data/key_io_valid.json\r\n+    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py invalid 70 > ../../src/test/data/key_io_invalid.json\r\n '''\r\n # 2012 Wladimir J. van der Laan\r\n # Released under MIT License\r\ndiff --git a/doc/release-notes-20861.md b/doc/release-notes-20861.md\r\nindex 2c270f0df5..5c68e4ab0c 100644\r\n--- a/doc/release-notes-20861.md\r\n+++ b/doc/release-notes-20861.md\r\n@@ -7,7 +7,7 @@ Updated RPCs\r\n   encoding instead of a Bech32 one, and Bech32m encoding will be used for such\r\n   addresses in RPC output as well. No version 1 addresses should be created\r\n   for mainnet until consensus rules are adopted that give them meaning\r\n-  (e.g. through [BIP 341](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)).\r\n+  (e.g. through [BIP 341](https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki)).\r\n   Once that happens, Bech32m is expected to be used for them, so this shouldn't\r\n-  affect any production system, but may be observed on other networks where such\r\n+  affect any production systems, but may be observed on other networks where such\r\n   addresses already have meaning (like signet).\r\ndiff --git a/src/bech32.cpp b/src/bech32.cpp\r\nindex 80794ec4f1..289e0213e8 100644\r\n--- a/src/bech32.cpp\r\n+++ b/src/bech32.cpp\r\n@@ -126,7 +126,7 @@ Encoding VerifyChecksum(const std::string& hrp, const data& values)\r\n     // if we required that the checksum was 0, it would be the case that appending a 0 to a valid\r\n     // list of values would result in a new valid list. For that reason, Bech32 requires the\r\n     // resulting checksum to be 1 instead. In Bech32m, this constant was amended.\r\n-    uint32_t check = PolyMod(Cat(ExpandHRP(hrp), values));\r\n+    const uint32_t check = PolyMod(Cat(ExpandHRP(hrp), values));\r\n     if (check == EncodingConstant(Encoding::BECH32)) return Encoding::BECH32;\r\n     if (check == EncodingConstant(Encoding::BECH32M)) return Encoding::BECH32M;\r\n     return Encoding::INVALID;\r\ndiff --git a/src/test/fuzz/bech32.cpp b/src/test/fuzz/bech32.cpp\r\nindex 15a3875828..63f05c4474 100644\r\n--- a/src/test/fuzz/bech32.cpp\r\n+++ b/src/test/fuzz/bech32.cpp\r\n@@ -19,9 +19,11 @@ FUZZ_TARGET(bech32)\r\n     const auto r1 = bech32::Decode(random_string);\r\n     if (r1.hrp.empty()) {\r\n         assert(r1.data.empty());\r\n+        assert(r1.encoding == Encoding::INVALID);\r\n     } else {\r\n         const std::string reencoded = bech32::Encode(r1.encoding, r1.hrp, r1.data);\r\n         assert(CaseInsensitiveEqual(random_string, reencoded));\r\n+        assert(r1.encoding != Encoding::INVALID);\r\n     }\r\n \r\n     std::vector<unsigned char> input;\r\ndiff --git a/test/functional/test_framework/segwit_addr.py b/test/functional/test_framework/segwit_addr.py\r\nindex 78b175a69e..3c3d242ad2 100644\r\n--- a/test/functional/test_framework/segwit_addr.py\r\n+++ b/test/functional/test_framework/segwit_addr.py\r\n@@ -7,6 +7,7 @@ import unittest\r\n from enum import Enum\r\n \r\n CHARSET = \"qpzry9x8gf2tvdw0s3jn54khce6mua7l\"\r\n+BECH32_CONST = 1\r\n BECH32M_CONST = 0x2bc830a3\r\n \r\n class Encoding(Enum):\r\n@@ -35,24 +36,24 @@ def bech32_hrp_expand(hrp):\r\n def bech32_verify_checksum(hrp, data):\r\n     \"\"\"Verify a checksum given HRP and converted data characters.\"\"\"\r\n     check = bech32_polymod(bech32_hrp_expand(hrp) + data)\r\n-    if check == 1:\r\n+    if check == BECH32_CONST:\r\n         return Encoding.BECH32\r\n     elif check == BECH32M_CONST:\r\n         return Encoding.BECH32M\r\n     else:\r\n         return None\r\n \r\n-def bech32_create_checksum(hrp, data, spec):\r\n+def bech32_create_checksum(encoding, hrp, data):\r\n     \"\"\"Compute the checksum values given HRP and data.\"\"\"\r\n     values = bech32_hrp_expand(hrp) + data\r\n-    const = BECH32M_CONST if spec == Encoding.BECH32M else 1\r\n+    const = BECH32M_CONST if encoding == Encoding.BECH32M else 1\r\n     polymod = bech32_polymod(values + [0, 0, 0, 0, 0, 0]) ^ const\r\n     return [(polymod >> 5 * (5 - i)) & 31 for i in range(6)]\r\n \r\n \r\n-def bech32_encode(hrp, data, spec):\r\n+def bech32_encode(encoding, hrp, data):\r\n     \"\"\"Compute a Bech32 or Bech32m string given HRP and data values.\"\"\"\r\n-    combined = data + bech32_create_checksum(hrp, data, spec)\r\n+    combined = data + bech32_create_checksum(encoding, hrp, data)\r\n     return hrp + '1' + ''.join([CHARSET[d] for d in combined])\r\n \r\n \r\n@@ -69,10 +70,10 @@ def bech32_decode(bech):\r\n         return (None, None, None)\r\n     hrp = bech[:pos]\r\n     data = [CHARSET.find(x) for x in bech[pos+1:]]\r\n-    spec = bech32_verify_checksum(hrp, data)\r\n-    if spec is None:\r\n+    encoding = bech32_verify_checksum(hrp, data)\r\n+    if encoding is None:\r\n         return (None, None, None)\r\n-    return (hrp, data[:-6], spec)\r\n+    return (encoding, hrp, data[:-6])\r\n \r\n \r\n def convertbits(data, frombits, tobits, pad=True):\r\n@@ -100,7 +101,7 @@ def convertbits(data, frombits, tobits, pad=True):\r\n \r\n def decode_segwit_address(hrp, addr):\r\n     \"\"\"Decode a segwit address.\"\"\"\r\n-    hrpgot, data, spec = bech32_decode(addr)\r\n+    encoding, hrpgot, data = bech32_decode(addr)\r\n     if hrpgot != hrp:\r\n         return (None, None)\r\n     decoded = convertbits(data[1:], 5, 8, False)\r\n@@ -110,15 +111,15 @@ def decode_segwit_address(hrp, addr):\r\n         return (None, None)\r\n     if data[0] == 0 and len(decoded) != 20 and len(decoded) != 32:\r\n         return (None, None)\r\n-    if (data[0] == 0 and spec != Encoding.BECH32) or (data[0] != 0 and spec != Encoding.BECH32M):\r\n+    if (data[0] == 0 and encoding != Encoding.BECH32) or (data[0] != 0 and encoding != Encoding.BECH32M):\r\n         return (None, None)\r\n     return (data[0], decoded)\r\n \r\n \r\n def encode_segwit_address(hrp, witver, witprog):\r\n     \"\"\"Encode a segwit address.\"\"\"\r\n-    spec = Encoding.BECH32 if witver == 0 else Encoding.BECH32M\r\n-    ret = bech32_encode(hrp, [witver] + convertbits(witprog, 8, 5), spec)\r\n+    encoding = Encoding.BECH32 if witver == 0 else Encoding.BECH32M\r\n+    ret = bech32_encode(encoding, hrp, [witver] + convertbits(witprog, 8, 5))\r\n     if decode_segwit_address(hrp, ret) == (None, None):\r\n         return None\r\n     return ret\r\n```",
      "created_at" : "2021-03-16T00:17:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-799847447",
      "id" : 799847447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5OTg0NzQ0Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T00:17:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799847447",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776227"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776227"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added `const`.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T00:18:20Z",
      "diff_hunk" : "@@ -111,21 +120,24 @@ data ExpandHRP(const std::string& hrp)\n }\n \n /** Verify a checksum. */\n-bool VerifyChecksum(const std::string& hrp, const data& values)\n+Encoding VerifyChecksum(const std::string& hrp, const data& values)\n {\n     // PolyMod computes what value to xor into the final values to make the checksum 0. However,\n     // if we required that the checksum was 0, it would be the case that appending a 0 to a valid\n     // list of values would result in a new valid list. For that reason, Bech32 requires the\n-    // resulting checksum to be 1 instead.\n-    return PolyMod(Cat(ExpandHRP(hrp), values)) == 1;\n+    // resulting checksum to be 1 instead. In Bech32m, this constant was amended.\n+    uint32_t check = PolyMod(Cat(ExpandHRP(hrp), values));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776227",
      "id" : 594776227,
      "in_reply_to_id" : 593465566,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc3NjIyNw==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 129,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "src/bech32.cpp",
      "position" : null,
      "pull_request_review_id" : 612755817,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776338"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776338"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T00:18:38Z",
      "diff_hunk" : "@@ -0,0 +1,13 @@\n+Updated RPCs\n+------------\n+\n+- Due to [BIP 350](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)\n+  being implemented, behavior for all RPCs that accept addresses is changed when\n+  a native witness version 1 (or higher) is passed. These now require a Bech32m\n+  encoding instead of a Bech32 one, and Bech32m encoding will be used for such\n+  addresses in RPC output as well. No version 1 addresses should be created\n+  for mainnet until consensus rules are adopted that give them meaning\n+  (e.g. through [BIP 341](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)).\n+  Once that happens, Bech32m is expected to be used for them, so this shouldn't\n+  affect any production system, but may be observed on other networks where such",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776338",
      "id" : 594776338,
      "in_reply_to_id" : 593470134,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc3NjMzOA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 12,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "doc/release-notes-20861.md",
      "position" : null,
      "pull_request_review_id" : 612755926,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776338",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776566"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776566"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Changed the test_framework code to also use (encoding,hrp,data) everywhere.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T00:19:20Z",
      "diff_hunk" : "@@ -27,38 +34,45 @@ def bech32_hrp_expand(hrp):\n \n def bech32_verify_checksum(hrp, data):\n     \"\"\"Verify a checksum given HRP and converted data characters.\"\"\"\n-    return bech32_polymod(bech32_hrp_expand(hrp) + data) == 1\n-\n+    check = bech32_polymod(bech32_hrp_expand(hrp) + data)\n+    if check == 1:\n+        return Encoding.BECH32\n+    elif check == BECH32M_CONST:\n+        return Encoding.BECH32M\n+    else:\n+        return None\n \n-def bech32_create_checksum(hrp, data):\n+def bech32_create_checksum(hrp, data, spec):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776566",
      "id" : 594776566,
      "in_reply_to_id" : 594177361,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc3NjU2Ng==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 45,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/segwit_addr.py",
      "position" : null,
      "pull_request_review_id" : 612756198,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776566",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776639"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776639"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T00:19:31Z",
      "diff_hunk" : "@@ -27,38 +34,45 @@ def bech32_hrp_expand(hrp):\n \n def bech32_verify_checksum(hrp, data):\n     \"\"\"Verify a checksum given HRP and converted data characters.\"\"\"\n-    return bech32_polymod(bech32_hrp_expand(hrp) + data) == 1\n-\n+    check = bech32_polymod(bech32_hrp_expand(hrp) + data)\n+    if check == 1:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776639",
      "id" : 594776639,
      "in_reply_to_id" : 594177702,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc3NjYzOQ==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 38,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/segwit_addr.py",
      "position" : null,
      "pull_request_review_id" : 612756279,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776639",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776687"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776687"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T00:19:42Z",
      "diff_hunk" : "@@ -16,28 +16,26 @@\n FUZZ_TARGET(bech32)\n {\n     const std::string random_string(buffer.begin(), buffer.end());\n-    const std::pair<std::string, std::vector<uint8_t>> r1 = bech32::Decode(random_string);\n-    if (r1.first.empty()) {\n-        assert(r1.second.empty());\n+    const auto r1 = bech32::Decode(random_string);\n+    if (r1.hrp.empty()) {\n+        assert(r1.data.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776687",
      "id" : 594776687,
      "in_reply_to_id" : 594593139,
      "line" : 22,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc3NjY4Nw==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 22,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/test/fuzz/bech32.cpp",
      "position" : 10,
      "pull_request_review_id" : 612756338,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776687",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776738"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776738"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T00:19:49Z",
      "diff_hunk" : "@@ -0,0 +1,13 @@\n+Updated RPCs\n+------------\n+\n+- Due to [BIP 350](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)\n+  being implemented, behavior for all RPCs that accept addresses is changed when\n+  a native witness version 1 (or higher) is passed. These now require a Bech32m\n+  encoding instead of a Bech32 one, and Bech32m encoding will be used for such\n+  addresses in RPC output as well. No version 1 addresses should be created\n+  for mainnet until consensus rules are adopted that give them meaning\n+  (e.g. through [BIP 341](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776738",
      "id" : 594776738,
      "in_reply_to_id" : 594593511,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc3NjczOA==",
      "original_commit_id" : "d1054b98e5ec04cd3cdb487eaaf561926ef6c82d",
      "original_line" : 10,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/release-notes-20861.md",
      "position" : null,
      "pull_request_review_id" : 612756391,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776738",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776825"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776825"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T00:19:58Z",
      "diff_hunk" : "@@ -4,5 +4,5 @@ Utilities to generate test vectors for the data-driven Bitcoin tests.\n \n Usage:\n \n-    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py valid 50 > ../../src/test/data/key_io_valid.json\n-    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py invalid 50 > ../../src/test/data/key_io_invalid.json\n+    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py valid 70 > ../../src/test/data/key_io_valid.json\n+    PYTHONPATH=../../test/functional/test_framework ./gen_key_io_test_vectors.py invalid 70 > ../../src/test/data/key_io_invalid.json",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r594776825",
      "id" : 594776825,
      "in_reply_to_id" : 594610201,
      "line" : 8,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NDc3NjgyNQ==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 8,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "contrib/testgen/README.md",
      "position" : 7,
      "pull_request_review_id" : 612756448,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/594776825",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-utACK c85b2fce57a49133ec652a3ec95d67511cde311c",
      "created_at" : "2021-03-16T10:15:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-800130789",
      "id" : 800130789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMDEzMDc4OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T10:15:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800130789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r595087630"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/595087630"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks. Marking resolved.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T11:37:29Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173\n+    BECH32M, //!< Bech32m encoding as defined in BIP350\n+};\n+\n+/** Encode a Bech32 or Bech32m string. If hrp contains uppercase characters, this will cause an\n+ *  assertion error. Encoding must be one of BECH32 or BECH32M. */\n+std::string Encode(Encoding encoding, const std::string& hrp, const std::vector<uint8_t>& values);\n+\n+struct DecodeResult\n+{\n+    Encoding encoding;         //!< What encoding was detected in the result; Encoding::INVALID if failed.\n+    std::string hrp;           //!< The human readable part\n+    std::vector<uint8_t> data; //!< The payload (excluding checksum)\n+\n+    DecodeResult() : encoding(Encoding::INVALID) {}\n+    DecodeResult(Encoding enc, std::string&& h, std::vector<uint8_t>&& d) : encoding(enc), hrp(std::move(h)), data(std::move(d)) {}\n+};\n+\n+/** Decode a Bech32 string. */\n+DecodeResult Decode(const std::string& str);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r595087630",
      "id" : 595087630,
      "in_reply_to_id" : 594166019,
      "line" : 45,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NTA4NzYzMA==",
      "original_commit_id" : "92ec3fcdd2f79949839ce269403396362bea9d54",
      "original_line" : 44,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 51,
      "pull_request_review_id" : 613137714,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/595087630",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r595095660"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/595095660"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    const = BECH32M_CONST if encoding == Encoding.BECH32M else BECH32_CONST\r\n```",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T11:50:25Z",
      "diff_hunk" : "@@ -27,38 +35,45 @@ def bech32_hrp_expand(hrp):\n \n def bech32_verify_checksum(hrp, data):\n     \"\"\"Verify a checksum given HRP and converted data characters.\"\"\"\n-    return bech32_polymod(bech32_hrp_expand(hrp) + data) == 1\n-\n+    check = bech32_polymod(bech32_hrp_expand(hrp) + data)\n+    if check == BECH32_CONST:\n+        return Encoding.BECH32\n+    elif check == BECH32M_CONST:\n+        return Encoding.BECH32M\n+    else:\n+        return None\n \n-def bech32_create_checksum(hrp, data):\n+def bech32_create_checksum(encoding, hrp, data):\n     \"\"\"Compute the checksum values given HRP and data.\"\"\"\n     values = bech32_hrp_expand(hrp) + data\n-    polymod = bech32_polymod(values + [0, 0, 0, 0, 0, 0]) ^ 1\n+    const = BECH32M_CONST if encoding == Encoding.BECH32M else 1",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r595095660",
      "id" : 595095660,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NTA5NTY2MA==",
      "original_commit_id" : "c85b2fce57a49133ec652a3ec95d67511cde311c",
      "original_line" : 49,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/segwit_addr.py",
      "position" : null,
      "pull_request_review_id" : 613148224,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/595095660",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re-utACK https://github.com/bitcoin/bitcoin/pull/20861/commits/c85b2fce57a49133ec652a3ec95d67511cde311c",
      "created_at" : "2021-03-16T12:07:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-800205212",
      "id" : 800205212,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMDIwNTIxMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T12:07:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800205212",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/11212268?v=4",
         "events_url" : "https://api.github.com/users/gruve-p/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gruve-p/followers",
         "following_url" : "https://api.github.com/users/gruve-p/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gruve-p/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gruve-p",
         "id" : 11212268,
         "login" : "gruve-p",
         "node_id" : "MDQ6VXNlcjExMjEyMjY4",
         "organizations_url" : "https://api.github.com/users/gruve-p/orgs",
         "received_events_url" : "https://api.github.com/users/gruve-p/received_events",
         "repos_url" : "https://api.github.com/users/gruve-p/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gruve-p/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gruve-p/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gruve-p"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r595408094"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/595408094"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-16T17:49:52Z",
      "diff_hunk" : "@@ -27,38 +35,45 @@ def bech32_hrp_expand(hrp):\n \n def bech32_verify_checksum(hrp, data):\n     \"\"\"Verify a checksum given HRP and converted data characters.\"\"\"\n-    return bech32_polymod(bech32_hrp_expand(hrp) + data) == 1\n-\n+    check = bech32_polymod(bech32_hrp_expand(hrp) + data)\n+    if check == BECH32_CONST:\n+        return Encoding.BECH32\n+    elif check == BECH32M_CONST:\n+        return Encoding.BECH32M\n+    else:\n+        return None\n \n-def bech32_create_checksum(hrp, data):\n+def bech32_create_checksum(encoding, hrp, data):\n     \"\"\"Compute the checksum values given HRP and data.\"\"\"\n     values = bech32_hrp_expand(hrp) + data\n-    polymod = bech32_polymod(values + [0, 0, 0, 0, 0, 0]) ^ 1\n+    const = BECH32M_CONST if encoding == Encoding.BECH32M else 1",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r595408094",
      "id" : 595408094,
      "in_reply_to_id" : 595095660,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NTQwODA5NA==",
      "original_commit_id" : "c85b2fce57a49133ec652a3ec95d67511cde311c",
      "original_line" : 49,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/segwit_addr.py",
      "position" : null,
      "pull_request_review_id" : 613555392,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/595408094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 2e7c80fb5be82ad4a3f737cab65b31f70a772a23",
      "created_at" : "2021-03-16T18:26:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-800503168",
      "id" : 800503168,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMDUwMzE2OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T18:26:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800503168",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-utACK 2e7c80fb5be82ad4a3f737cab65b31f70a772a23",
      "created_at" : "2021-03-16T18:59:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-800525384",
      "id" : 800525384,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMDUyNTM4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T18:59:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800525384",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 2e7c80fb5be82ad4a3f737cab65b31f70a772a23",
      "created_at" : "2021-03-16T20:05:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-800566012",
      "id" : 800566012,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMDU2NjAxMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T20:05:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800566012",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re-ACK 2e7c80fb5be82ad4a3f737cab65b31f70a772a23\r\n\r\nCheck range-diff since last review.",
      "created_at" : "2021-03-16T21:51:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-800636341",
      "id" : 800636341,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMDYzNjM0MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-16T21:52:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/800636341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596341682"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596341682"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, my naming suggestions were just what came to my head at that moment, I did not want to intentionally peg the encoding name to one of its use cases. I just think it's unfortunate that everything including the BIP173 encoding was called \"Bech32\" and now there is a new encoding called \"Bech32m\" that is also a Bech32 string. I think it might be helpful to have a naming distinction between Bech32 in general and the BIP173 encoding. But I also hope this code doesn't have to change much in the future and if no one else shares that view, I am happy to have it ignored :)",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-17T20:01:50Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596341682",
      "id" : 596341682,
      "in_reply_to_id" : 593938931,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM0MTY4Mg==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 25,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 32,
      "pull_request_review_id" : 614733836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596341682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596346647"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596346647"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> there is a new encoding called \"Bech32m\" that is also a Bech32 string.\n\nThat's wrong. We should fix places in the code where Bech32m is referred to as Bech32. I know of one, addresstype/OutputType::BECH32, which I'm intentionally ignoring in this to minimize code changes (see earlier discussion), but should be fixed still.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-17T20:10:00Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596346647",
      "id" : 596346647,
      "in_reply_to_id" : 593938931,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM0NjY0Nw==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 25,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 32,
      "pull_request_review_id" : 614740102,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596346647",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596369573"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596369573"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596346647\r\n\r\nThe name \"bech32m\" does maybe seem unfortunate. It might have been nice to chose a completely different name (\"fatfinger32, now catching more stupid typos!\") since from a user perspective you can't use a bech32 address when you need a bech32m address, or vice versa. It's just behind the scenes that they share an extremely similar implementation, and the \"human readable\" parts can be interpreted the same way.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-17T20:45:45Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596369573",
      "id" : 596369573,
      "in_reply_to_id" : 593938931,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM2OTU3Mw==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 25,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 32,
      "pull_request_review_id" : 609695853,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596369573",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596388812"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596388812"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Already fixed.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-17T21:17:03Z",
      "diff_hunk" : "@@ -0,0 +1,13 @@\n+Updated RPCs\n+------------\n+\n+- Due to [BIP 350](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)\n+  being implemented, behavior for all RPCs that accept addresses is changed when\n+  a native witness version 1 (or higher) is passed. These now require a Bech32m\n+  encoding instead of a Bech32 one, and Bech32m encoding will be used for such\n+  addresses in RPC output as well. No version 1 addresses should be created\n+  for mainnet until consensus rules are adopted that give them meaning\n+  (e.g. through [BIP 341](https://github.com/bitcoin/bips/blob/master/bip-0350.mediawiki)).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596388812",
      "id" : 596388812,
      "in_reply_to_id" : 592311215,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM4ODgxMg==",
      "original_commit_id" : "d1054b98e5ec04cd3cdb487eaaf561926ef6c82d",
      "original_line" : 10,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/release-notes-20861.md",
      "position" : null,
      "pull_request_review_id" : 614792797,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596388812",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596389178"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596389178"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You are hereby promoted to Official Namer Of Stuff.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-17T21:17:36Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596389178",
      "id" : 596389178,
      "in_reply_to_id" : 593938931,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM4OTE3OA==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 25,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 32,
      "pull_request_review_id" : 614793219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596389178",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596433779"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596433779"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nice, so much easier than my other jobs!",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-17T22:46:43Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596433779",
      "id" : 596433779,
      "in_reply_to_id" : 593938931,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjQzMzc3OQ==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 25,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 32,
      "pull_request_review_id" : 614847108,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596433779",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596460892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596460892"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> That's wrong. We should fix places in the code where Bech32m is referred to as Bech32.\r\n\r\nOk, re-reading the module now I think this is mostly clear and I was probably bringing in my own preconceived ideas or looking at older code like the comment 2 lines above that was actually removed. I nit-picked through the module and here a few suggestions where this could be clarified further: https://github.com/fjahr/bitcoin/commit/2156afd69e6e5bd587a9d734b21c3e068a037156 but obviously feel free to ignore or keep for a follow-up together with the OutputType maybe.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-17T23:57:18Z",
      "diff_hunk" : "@@ -19,11 +19,29 @@\n namespace bech32\n {\n \n-/** Encode a Bech32 string. If hrp contains uppercase characters, this will cause an assertion error. */\n-std::string Encode(const std::string& hrp, const std::vector<uint8_t>& values);\n+enum class Encoding {\n+    INVALID, //!< Failed decoding\n \n-/** Decode a Bech32 string. Returns (hrp, data). Empty hrp means failure. */\n-std::pair<std::string, std::vector<uint8_t>> Decode(const std::string& str);\n+    BECH32,  //!< Bech32 encoding as defined in BIP173",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596460892",
      "id" : 596460892,
      "in_reply_to_id" : 593938931,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjQ2MDg5Mg==",
      "original_commit_id" : "402cbb29516d5bf03a18822af9f1b4b574f319ac",
      "original_line" : 25,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/bech32.h",
      "position" : 32,
      "pull_request_review_id" : 614878171,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-18T00:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596460892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@fjahr Included your naming nits commit.",
      "created_at" : "2021-03-18T01:00:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-801538560",
      "id" : 801538560,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMTUzODU2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-18T01:00:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801538560",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 0334602\r\n\r\nApologies for the meta naming nit, but let's call that commit `bech32m: naming nits`? :-)",
      "created_at" : "2021-03-18T08:05:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-801717877",
      "id" : 801717877,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMTcxNzg3Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-18T13:24:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801717877",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 03346022d6\r\n\r\nThis seems ready for merge (and had 4 ACKs prior to the last push). Can we settle on this and resolve any additional style comments in follow-up PRs?",
      "created_at" : "2021-03-18T11:11:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-801834795",
      "id" : 801834795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMTgzNDc5NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-18T11:11:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801834795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 0334602",
      "created_at" : "2021-03-18T19:05:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-802212960",
      "id" : 802212960,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMjIxMjk2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-18T19:05:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/802212960",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re-ACK 0334602",
      "created_at" : "2021-03-18T19:05:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#issuecomment-802213275",
      "id" : 802213275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20861",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMjIxMzI3NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-18T19:05:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/802213275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597918726"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597918726"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Any reason to remove the branch that checks bech32 for larger input sizes? I know this isn't relevant for bitcoin addresses, but there are other applications that use bech32 for encoding and checking it here doesn't cost us anything, no?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-19T19:13:39Z",
      "diff_hunk" : "@@ -16,28 +16,28 @@\n FUZZ_TARGET(bech32)\n {\n     const std::string random_string(buffer.begin(), buffer.end());\n-    const std::pair<std::string, std::vector<uint8_t>> r1 = bech32::Decode(random_string);\n-    if (r1.first.empty()) {\n-        assert(r1.second.empty());\n+    const auto r1 = bech32::Decode(random_string);\n+    if (r1.hrp.empty()) {\n+        assert(r1.encoding == bech32::Encoding::INVALID);\n+        assert(r1.data.empty());\n     } else {\n-        const std::string& hrp = r1.first;\n-        const std::vector<uint8_t>& data = r1.second;\n-        const std::string reencoded = bech32::Encode(hrp, data);\n+        assert(r1.encoding != bech32::Encoding::INVALID);\n+        const std::string reencoded = bech32::Encode(r1.encoding, r1.hrp, r1.data);\n         assert(CaseInsensitiveEqual(random_string, reencoded));\n     }\n \n     std::vector<unsigned char> input;\n     ConvertBits<8, 5, true>([&](unsigned char c) { input.push_back(c); }, buffer.begin(), buffer.end());\n-    const std::string encoded = bech32::Encode(\"bc\", input);\n-    assert(!encoded.empty());\n \n-    const std::pair<std::string, std::vector<uint8_t>> r2 = bech32::Decode(encoded);\n-    if (r2.first.empty()) {\n-        assert(r2.second.empty());\n-    } else {\n-        const std::string& hrp = r2.first;\n-        const std::vector<uint8_t>& data = r2.second;\n-        assert(hrp == \"bc\");\n-        assert(data == input);\n+    if (input.size() + 3 + 6 <= 90) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597918726",
      "id" : 597918726,
      "line" : 32,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzkxODcyNg==",
      "original_commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "original_line" : 32,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/test/fuzz/bech32.cpp",
      "position" : 33,
      "pull_request_review_id" : 616721379,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-19T19:15:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597918726",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597919281"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597919281"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: obviously unrelated to your changes, but the `B` should be a `G`. (blame me)",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-19T19:14:47Z",
      "diff_hunk" : "@@ -138,13 +138,13 @@ def run_test(self):\n         node.createwallet(wallet_name='watch_only', disable_private_keys=True)\n         wallet_watch_only = node.get_wallet_rpc('watch_only')\n         BECH32_VALID = {\n-            'âï¸_VER15_PROG40': 'bcrt10qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqn2cjv3',\n-            'âï¸_VER16_PROG03': 'bcrt1sqqqqqjq8pdp',\n-            'âï¸_VER16_PROB02': 'bcrt1sqqqqqjq8pv',\n+            'âï¸_VER15_PROG40': 'bcrt10qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqxkg7fn',\n+            'âï¸_VER16_PROG03': 'bcrt1sqqqqq8uhdgr',\n+            'âï¸_VER16_PROB02': 'bcrt1sqqqq4wstyw',\n         }\n         BECH32_INVALID = {\n-            'â_VER15_PROG41': 'bcrt10qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqzc7xyq',\n-            'â_VER16_PROB01': 'bcrt1sqqpl9r5c',\n+            'â_VER15_PROG41': 'bcrt1sqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqajlxj8',\n+            'â_VER16_PROB01': 'bcrt1sqq5r4036',",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597919281",
      "id" : 597919281,
      "line" : 147,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzkxOTI4MQ==",
      "original_commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "original_line" : 147,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "test/functional/wallet_labels.py",
      "position" : 15,
      "pull_request_review_id" : 616721379,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-19T19:15:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597919281",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597919847"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597919847"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Could add a benchmark for bech32m?",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-19T19:15:46Z",
      "diff_hunk" : "@@ -19,7 +19,7 @@ static void Bech32Encode(benchmark::Bench& bench)\n     tmp.reserve(1 + 32 * 8 / 5);\n     ConvertBits<8, 5, true>([&](unsigned char c) { tmp.push_back(c); }, v.begin(), v.end());\n     bench.batch(v.size()).unit(\"byte\").run([&] {\n-        bech32::Encode(\"bc\", tmp);\n+        bech32::Encode(bech32::Encoding::BECH32, \"bc\", tmp);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597919847",
      "id" : 597919847,
      "line" : 22,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzkxOTg0Nw==",
      "original_commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "original_line" : 22,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/bench/bech32.cpp",
      "position" : 5,
      "pull_request_review_id" : 616721379,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-19T19:15:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597919847",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597922938"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597922938"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Bech32 and Bech32m do not permit encoded strings over 90 characters (the checksum properties break down past that point). BOLT11 uses a relaxed version of the spec that drops this requirement.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-19T19:21:22Z",
      "diff_hunk" : "@@ -16,28 +16,28 @@\n FUZZ_TARGET(bech32)\n {\n     const std::string random_string(buffer.begin(), buffer.end());\n-    const std::pair<std::string, std::vector<uint8_t>> r1 = bech32::Decode(random_string);\n-    if (r1.first.empty()) {\n-        assert(r1.second.empty());\n+    const auto r1 = bech32::Decode(random_string);\n+    if (r1.hrp.empty()) {\n+        assert(r1.encoding == bech32::Encoding::INVALID);\n+        assert(r1.data.empty());\n     } else {\n-        const std::string& hrp = r1.first;\n-        const std::vector<uint8_t>& data = r1.second;\n-        const std::string reencoded = bech32::Encode(hrp, data);\n+        assert(r1.encoding != bech32::Encoding::INVALID);\n+        const std::string reencoded = bech32::Encode(r1.encoding, r1.hrp, r1.data);\n         assert(CaseInsensitiveEqual(random_string, reencoded));\n     }\n \n     std::vector<unsigned char> input;\n     ConvertBits<8, 5, true>([&](unsigned char c) { input.push_back(c); }, buffer.begin(), buffer.end());\n-    const std::string encoded = bech32::Encode(\"bc\", input);\n-    assert(!encoded.empty());\n \n-    const std::pair<std::string, std::vector<uint8_t>> r2 = bech32::Decode(encoded);\n-    if (r2.first.empty()) {\n-        assert(r2.second.empty());\n-    } else {\n-        const std::string& hrp = r2.first;\n-        const std::vector<uint8_t>& data = r2.second;\n-        assert(hrp == \"bc\");\n-        assert(data == input);\n+    if (input.size() + 3 + 6 <= 90) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597922938",
      "id" : 597922938,
      "in_reply_to_id" : 597918726,
      "line" : 32,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzkyMjkzOA==",
      "original_commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "original_line" : 32,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/test/fuzz/bech32.cpp",
      "position" : 33,
      "pull_request_review_id" : 616726563,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-19T19:21:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597922938",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597923117"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597923117"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, could do. The performance should be exactly identical to Bech32 though.",
      "commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "created_at" : "2021-03-19T19:21:42Z",
      "diff_hunk" : "@@ -19,7 +19,7 @@ static void Bech32Encode(benchmark::Bench& bench)\n     tmp.reserve(1 + 32 * 8 / 5);\n     ConvertBits<8, 5, true>([&](unsigned char c) { tmp.push_back(c); }, v.begin(), v.end());\n     bench.batch(v.size()).unit(\"byte\").run([&] {\n-        bech32::Encode(\"bc\", tmp);\n+        bech32::Encode(bech32::Encoding::BECH32, \"bc\", tmp);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20861#discussion_r597923117",
      "id" : 597923117,
      "in_reply_to_id" : 597919847,
      "line" : 22,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzkyMzExNw==",
      "original_commit_id" : "03346022d611871f2cc185440b19d928b9264d9d",
      "original_line" : 22,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/bench/bech32.cpp",
      "position" : 5,
      "pull_request_review_id" : 616726812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20861",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-19T19:21:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597923117",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
