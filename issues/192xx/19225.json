{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "Our implementation of ChaCha20 is based on [RFC 7539](https://tools.ietf.org/html/rfc7539) which has been declared obsolete by  [RFC 8439](https://tools.ietf.org/html/rfc8439).\r\n\r\nFor example the nonce changed from 64-bit to 96-bit:\r\n> Note also that the original ChaCha had a 64-bit nonce and 64-bit block count. We have modified this here to be more consistent with recommendations in Section 3.2 of [RFC5116]. This limits the use of a single (key,nonce) combination to 2^32 blocks, or 256 GB, but that is enough for most uses. In cases where a single key is used by multiple senders, it is important to make sure that they donât use the same nonces. This can be assured by partitioning the nonce space so that the first 32 bits are unique per sender, while the other 64 bits come from a counter.\r\n\r\nI have no idea if any of the changes are really material.\r\n\r\nGiven that we plan to use ChaCha20 in MuHash3072 (#19055), if we ever want to write an RFC for that, we should probably use the new version of ChaCha20.\r\n\r\nThis is also relevant for the [BIP-151 followup](https://gist.github.com/jonasschnelli/c530ea8421b8d0e80c51486325587c52), which appears also to based on RFC 7539. Since the original BIP151 is withdrawn and its replacement hasn't been proposed, it's not too late to change that. RFC 8439 also defines ChaCha20-Poly1305, at minimum the test vectors seem different.\r\n\r\nRFC 8439 has some [errata](https://www.rfc-editor.org/errata/rfc8439):\r\n* bug in Poly1305 pseudo code (2.5.1)\r\n* bug in ChaCha20 pseudo code (2.4.1)\r\n* remarks about constant-timeness for Poly1305",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19225/comments",
   "created_at" : "2020-06-09T14:39:25Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19225/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/19225",
   "id" : 635488618,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19225/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU2MzU0ODg2MTg=",
   "number" : 19225,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Update ChaCha20 to RFC 8439?",
   "updated_at" : "2020-06-09T20:00:51Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19225",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
      "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
      "followers_url" : "https://api.github.com/users/Sjors/followers",
      "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/Sjors",
      "id" : 10217,
      "login" : "Sjors",
      "node_id" : "MDQ6VXNlcjEwMjE3",
      "organizations_url" : "https://api.github.com/users/Sjors/orgs",
      "received_events_url" : "https://api.github.com/users/Sjors/received_events",
      "repos_url" : "https://api.github.com/users/Sjors/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/Sjors"
   }
}
