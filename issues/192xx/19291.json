{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "<!-- This issue tracker is only for technical issues related to Bitcoin Core.\r\n\r\nGeneral bitcoin questions and/or support requests are best directed to the Bitcoin StackExchange at https://bitcoin.stackexchange.com.\r\n\r\nFor reporting security issues, please read instructions at https://bitcoincore.org/en/contact/.\r\n\r\nIf the node is \"stuck\" during sync or giving \"block checksum mismatch\" errors, please ensure your hardware is stable by running memtest and observe CPU temperature with a load-test tool such as linpack before creating an issue! -->\r\n\r\n<!-- Describe the issue -->\r\n\r\n**Expected behavior**\r\n\r\nI want my Bitcoin Core node to *never* prune the blockchain. \r\n\r\n<!--- What behavior did you expect? -->\r\n\r\n**Actual behavior**\r\n\r\nOccasionally, Bitcoin Core will enable the pruning option. This causes it to prune the blockchain, and forces me to resync when I disable it.  I started seeing this in 0.19 and it still persists in 0.20. It may also be related to my moving to a new computer which upgraded me to Catalina. I'm not really sure.\r\n  \r\n<!--- What was the actual behavior (provide screenshots if the issue is GUI-related)? -->\r\n\r\n**To reproduce**\r\n\r\nI think it might be related to the fact that my data directory is on an external hard drive. If I start Bitcoin Core before mounting in the drive, it will popup the dialog as if it is my first time starting Bitcoin Core, asking me where to store the block chain. In the dialog, the datadir location is defaulted to put it in the location where my external hard drive mount would be, like `/Volumes/Drive/Bitcoin`. If I then mount the drive and choose next in the dialog, the sync works, but pruning is enabled and it immediately prunes the blockchain. I can go into the settings at this point and uncheck pruning, but at that point, it requires a full resync. And it ends up being enabled again the next time I start Bitcoin Core. Needless to say, this is extremely annoying and makes Bitcoin Core almost unusable for me.\r\n\r\nI even tried setting `prune=0` in my bitcoin.conf file, which is on the external drive, but it has no effect. \r\n\r\nI suspect what is happening is that pruning is enabled by default, and since it can't find my datadir when it launches, Bitcoin Core thinks that it is doing a fresh sync and sets it to true. This setting is then not updated, even from the bitcoin.conf (which itself lives on the external drive) once that datadir is loaded. The fact that it remembers where the datadir is implies that some settings are stored locally, though I can't really tell where. Is it possible for me to store my no-prune setting locally as well? \r\n\r\nNote that I used to do this exact workflow of opening Bitcoin Core before mounting my drive all the time in previous node versions and macOS versions, and it never enabled pruning on me. \r\n\r\n(as an aside, I feel like Bitcoin Core should be smart enough to recognize that a datadir in `/Volumes` on macOS is an external drive, even when it doesn't currently exist). \r\n\r\n<!--- How reliably can you reproduce the issue, what are the steps to do so? -->\r\n\r\n**System information**\r\n\r\n<!-- What version of Bitcoin Core are you using, where did you get it (website, self-compiled, etc)? -->\r\n\r\nBitcoin Core 0.20.0 macOS GUI version. Downloaded from https://bitcoincore.org/. \r\n\r\n<!-- What type of machine are you observing the error on (OS/CPU and disk type)? -->\r\n\r\nmacOS Catalina 10.15.5.\r\n\r\n<!-- GUI-related issue? What is your operating system and its version? If Linux, what is your desktop environment and graphical shell? -->\r\n\r\n<!-- Any extra information that might be useful in the debugging process. -->\r\n<!--- This is normally the contents of a `debug.log` or `config.log` file. Raw text or a link to a pastebin type site are preferred. -->\r\n\r\nContents of `/Volume/Drive/Bitcoin/bitcoin.conf`:\r\n\r\n```\r\nserver=1\r\ndbcache=4096\r\nrpcport=8332\r\nprune=0\r\n```",
   "closed_at" : "2023-02-07T13:30:44Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
      "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
      "followers_url" : "https://api.github.com/users/hebasto/followers",
      "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/hebasto",
      "id" : 32963518,
      "login" : "hebasto",
      "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
      "organizations_url" : "https://api.github.com/users/hebasto/orgs",
      "received_events_url" : "https://api.github.com/users/hebasto/received_events",
      "repos_url" : "https://api.github.com/users/hebasto/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/hebasto"
   },
   "comments" : 9,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19291/comments",
   "created_at" : "2020-06-16T00:54:38Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19291/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/19291",
   "id" : 639290532,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "description" : null,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      },
      {
         "color" : "02d7e1",
         "default" : false,
         "description" : null,
         "id" : 135946,
         "name" : "GUI",
         "node_id" : "MDU6TGFiZWwxMzU5NDY=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/GUI"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19291/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU2MzkyOTA1MzI=",
   "number" : 19291,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19291/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "state_reason" : "completed",
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19291/timeline",
   "title" : "gui: Pruning keeps getting reenabled",
   "updated_at" : "2023-02-07T13:30:44Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19291",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/66979985?v=4",
      "events_url" : "https://api.github.com/users/dummy65839/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dummy65839/followers",
      "following_url" : "https://api.github.com/users/dummy65839/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dummy65839/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dummy65839",
      "id" : 66979985,
      "login" : "dummy65839",
      "node_id" : "MDQ6VXNlcjY2OTc5OTg1",
      "organizations_url" : "https://api.github.com/users/dummy65839/orgs",
      "received_events_url" : "https://api.github.com/users/dummy65839/received_events",
      "repos_url" : "https://api.github.com/users/dummy65839/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dummy65839/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dummy65839/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dummy65839"
   }
}
