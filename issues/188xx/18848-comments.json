[
   {
      "author_association" : "MEMBER",
      "body" : "Why is `ThreadRename` being called so many times? Does it make sense? :)",
      "created_at" : "2020-05-02T08:32:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622872215",
      "id" : 622872215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjg3MjIxNQ==",
      "updated_at" : "2020-05-02T08:32:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622872215",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> ... ThreadRename is called many many times...\r\n\r\nIt seems like a more serious bug than memory over-allocation.\r\n\r\n",
      "created_at" : "2020-05-02T08:40:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622882866",
      "id" : 622882866,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjg4Mjg2Ng==",
      "updated_at" : "2020-05-02T08:40:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622882866",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "hmmm I went into this from a top-down approach. I'm not familiar with the internals of core, but it's possible the tool I'm using (heaptrack) might have false positives or be flat out wrong. all I know is that doing this PR made the ThreadRename heaptrack logs go away.\r\n\r\nThere are a bunch of callsites but none of them look too suspicious...",
      "created_at" : "2020-05-02T08:50:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622895724",
      "id" : 622895724,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjg5NTcyNA==",
      "updated_at" : "2020-05-02T08:50:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622895724",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Uhm, if this is that case, the underlying issue must be addressed, not the symptom. It's supposed to only be called at initial thread creation and bitcoin core's threads are more or less static.\r\n(e.g. the HTTP worker threads are only supposed to be created once, at startup, not all the time? wtf is happening lately)\r\n\r\nCould this also explain why `thread_local` adds unexpected amount of overhead? (see #18678)\r\n",
      "created_at" : "2020-05-02T08:51:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622897432",
      "id" : 622897432,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjg5NzQzMg==",
      "updated_at" : "2020-05-02T08:56:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622897432",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "is there some mechanism where thread jobs would allocate and destroy thread_local heap storage every time or something? I'm not that familiar with thread_local...",
      "created_at" : "2020-05-02T08:58:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622906791",
      "id" : 622906791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkwNjc5MQ==",
      "updated_at" : "2020-05-02T08:58:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622906791",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It's somewhat of a mystery. It's up to the compiler - OS - libc - architecture combination how `thread_local` is implemented.\r\n\r\nCould you try `--disable-threadlocal` to see if it makes this problem go away?\r\n",
      "created_at" : "2020-05-02T09:07:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622917303",
      "id" : 622917303,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkxNzMwMw==",
      "updated_at" : "2020-05-02T09:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622917303",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "amazingly, the allocs went away with `--disable-threadlocal`\r\n\r\n![May02-021545](https://user-images.githubusercontent.com/45598/80860180-eeb37c80-8c1a-11ea-9e1a-5f0ce2fefc35.png)\r\n",
      "created_at" : "2020-05-02T09:16:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622924220",
      "id" : 622924220,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNDIyMA==",
      "updated_at" : "2020-05-02T09:16:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622924220",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "going to `make clean` just incase to confirm",
      "created_at" : "2020-05-02T09:20:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622924684",
      "id" : 622924684,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNDY4NA==",
      "updated_at" : "2020-05-02T09:20:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622924684",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ouch. Looks like you're on to something.\r\n\r\nWhich platform are you checking on? On x86_64, Ubuntu 20.04, with gcc `9.3.0-10ubuntu2`, it looks like ThreadRename is only called once per thread as expected, even with active RPC use (edit: oh and once at shutdown with `shutoff`). Checked by breakpointing it in gdb.",
      "created_at" : "2020-05-02T09:20:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622924722",
      "id" : 622924722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNDcyMg==",
      "updated_at" : "2020-05-02T09:26:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622924722",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "yup no more `ThreadRename` allocs on master with `--disable-threadlocal` after a `make clean`\r\n\r\n`gcc (GCC) 9.3.0`\r\n\r\n![May02-022408](https://user-images.githubusercontent.com/45598/80860400-46061c80-8c1c-11ea-95e9-0710fc96908a.png)\r\n\r\ngoing to try with clang",
      "created_at" : "2020-05-02T09:25:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622925288",
      "id" : 622925288,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNTI4OA==",
      "updated_at" : "2020-05-02T09:26:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622925288",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I have the same. Why can't I reproduce this. This is fucking madness.\r\n\r\nEdit: can you please trap the function in `gdb` and look what the backtrace is, where it keeps being called from for the same threads?",
      "created_at" : "2020-05-02T09:28:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622925624",
      "id" : 622925624,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNTYyNA==",
      "updated_at" : "2020-05-02T09:30:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622925624",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested IBD on x86_64, Linux Mint 19.3 with the patched `util::ThreadRename()` to print a message. The only output is:\r\n```\r\n$ ./src/qt/bitcoin-qt -testnet -server\r\nThreadRename: name=qt-init\r\nThreadRename: name=scriptch.1\r\nThreadRename: name=scriptch.0\r\nThreadRename: name=scriptch.2\r\nThreadRename: name=scheduler\r\nThreadRename: name=httpworker.0\r\nThreadRename: name=http\r\nThreadRename: name=httpworker.3\r\nThreadRename: name=httpworker.1\r\nThreadRename: name=httpworker.2\r\nThreadRename: name=loadblk\r\nThreadRename: name=net\r\nThreadRename: name=addcon\r\nThreadRename: name=msghand\r\nThreadRename: name=opencon\r\nThreadRename: name=dnsseed\r\nThreadRename: name=shutoff\r\n```",
      "created_at" : "2020-05-02T09:30:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622925860",
      "id" : 622925860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNTg2MA==",
      "updated_at" : "2020-05-02T09:30:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622925860",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "heaptrack tracks allocations, I have no idea how heaptrack attributes mallocs to ThreadRename, but it must be something thread_local related...\r\n\r\nhere's with clang with thread_local enabled:\r\n\r\n![May02-023523](https://user-images.githubusercontent.com/45598/80860611-b19cb980-8c1d-11ea-9677-208f905218d0.png)\r\n\r\nlet me try to log the get internal name call",
      "created_at" : "2020-05-02T09:36:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622926470",
      "id" : 622926470,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNjQ3MA==",
      "updated_at" : "2020-05-02T09:36:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622926470",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I have the feeling it's more subtle.\r\nMind that without `thread_local` enabled, the `SetInternalName` function called from `ThreadRename` is stubbed out\r\n```\r\nstatic void SetInternalName(std::string name) { }\r\n```\r\nIt might still be that it is called many times, it just doesn't show up in this profile.\r\n(but it means that `::prctl` for ex. will still be called a lot)\r\n",
      "created_at" : "2020-05-02T09:40:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622926853",
      "id" : 622926853,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNjg1Mw==",
      "updated_at" : "2020-05-02T09:41:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622926853",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ok I'm dumb, I think I was reading this pane wrong. It's showing the top-down allocations. so that means it allocated that many times UP to the point it allocated once in ThreadRename.\r\n\r\nso perhaps the thread_local performance thing is just because LogPrintF has to allocate a bit more to display thread info? Seems like 6 minutes is lot though just for a print line...",
      "created_at" : "2020-05-02T09:46:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622927534",
      "id" : 622927534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNzUzNA==",
      "updated_at" : "2020-05-02T09:48:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622927534",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "this might still be useful for the case where we're logging thread names... but it's pretty minor compared to other huge sources of allocations. going to close this for now.",
      "created_at" : "2020-05-02T10:19:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18848#issuecomment-622931041",
      "id" : 622931041,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18848",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkzMTA0MQ==",
      "updated_at" : "2020-05-02T10:19:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622931041",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   }
]
