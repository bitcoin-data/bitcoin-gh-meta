[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19503 (Add parameter feature to serialization and use it for CAddress by sipa)\n* #19498 (Tidy up ProcessOrphanTx by jnewbery)\n* #19306 (refactor: Replace RecursiveMutex with Mutex in CTxMemPool by hebasto)\n* #19184 (Overhaul transaction request logic by sipa)\n* #19107 (p2p: Move all header verification into the network layer, extend logging by troygiorshev)\n* #18991 (Cache responses to GETADDR to prevent topology leaks by naumenkogs)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-07-17T11:27:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19542#issuecomment-660054955",
      "id" : 660054955,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19542",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDA1NDk1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-17T18:16:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660054955",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can we wait for a comment from @theuni before merging this? I think that we all agree that #19174 was merged too quickly, but it caused a bunch of PRs to have to be rebased and reverting it would mean rebasing everything yet again.",
      "created_at" : "2020-07-17T12:23:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19542#issuecomment-660077893",
      "id" : 660077893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19542",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDA3Nzg5Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-17T12:23:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660077893",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "We must also hold up those other PRs as long as this should maybe be reverted. Right now this is still a clean `git revert`",
      "created_at" : "2020-07-17T12:44:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19542#issuecomment-660086644",
      "id" : 660086644,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19542",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDA4NjY0NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-17T12:44:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660086644",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Not sure if there is a deterministic way to find all such PRs, but at least https://github.com/bitcoin/bitcoin/pull/19031 and https://github.com/bitcoin/bitcoin/pull/19503 are among them.",
      "created_at" : "2020-07-17T13:16:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19542#issuecomment-660101427",
      "id" : 660101427,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19542",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDEwMTQyNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-17T13:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660101427",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  reverting it would mean rebasing everything yet again\r\n\r\nThey could also be reset to the previous version, as this was the only conflict. (Assuming no other changes to the pulls in question happened in the meantime).\r\n\r\nAs to the conceptual discussion, I think everyone agrees with @theuni that connman should be treated as an optional pointer. In current master, connman is a pointer (and it is not trivially possible to make it a non-pointer). https://github.com/bitcoin/bitcoin/blob/c04485850e72e773280e0cc8d88e73ec791bef73/src/node/context.h#L36\r\nAlso, places where connman could be nullptr properly check for that. https://github.com/bitcoin/bitcoin/blob/c04485850e72e773280e0cc8d88e73ec791bef73/src/rpc/mining.cpp#L640-L642\r\n\r\nHowever, the lines changed by the patch are called only where connman is already confirmed to be not null. If we go ahead to merge this, it would be good to document in the code or somewhere else why those cases should be treated as pointers and, at the same time, why nullptr checks are not needed for them. \r\n\r\nACK 1aff21b36450644390d6361d496811dda5a6ae31 for now. I only checked that it cleanly reverts, but ideally we'd have clear documentation on how to pass connman around and why. Sorry for causing this disagreement in the first place. I wish the time spent on this was used on user-facing changes, but properly documenting this will hopefully avoid misunderstandings in the future.",
      "created_at" : "2020-07-17T14:29:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19542#issuecomment-660138396",
      "id" : 660138396,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19542",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDEzODM5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-17T14:29:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660138396",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "FWIW I did review the original #19174 and it does appear safe/not a bug, so happy to re-ACK it if @theuni weighs in affirmatively.\r\n\r\n+1 Marco you can just revert the rebases, no need to write new code. But may as well wait till we get word from Cory on if there's a reason not to take the patch.",
      "created_at" : "2020-07-17T16:00:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19542#issuecomment-660188897",
      "id" : 660188897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19542",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDE4ODg5Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-17T16:00:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660188897",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Related discussion on IRC for reference:\r\n\r\n```\r\n[14:24] <jnewbery> wumpus: can you wait for cfields to review before merging 19542 please?\r\n[14:26] <cfields> I was just commenting there... will review in detail today. I suspect I was wrong with the concept nack anyway...\r\n[14:26] <cfields> it's not a big deal, though.\r\n[14:28] <jnewbery> cfields: thanks!\r\n[14:30] <cfields> np, these things happen :)\r\n[14:33] <wumpus> yes, though, \"this causes a few PRs to need to be rebased\" was another reason to be cautious about merging it in the first place\r\n[14:34] <wumpus> I think we should avoid doing these kind of mass data type changes unless there is a really good rationale and people agree about doing it\r\n[14:34] <wumpus> \"increases code quality\" is kind of subjective\r\n[14:38] <wumpus> if it's uncontroversial and doesn't impact other people's work, okay, but not sure about this\r\n[14:48] <jnewbery> wumpus: yes, agree. When I wrote my ACK I originally had a comment about not merging immediately because of conflicts, but I deleted that because I didn't want to tell the maintainers how to do their job\r\n[16:46] <MarcoFalke> when merging I do check all conflicts for reviews, and in this case, all of the conflicts had either, no review, didn't compile, or didn't pass the test suite. So in all cases a rebase or force push wouldn't have been harmful or was needed anyway.\r\n",
      "created_at" : "2020-07-17T16:06:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19542#issuecomment-660192167",
      "id" : 660192167,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19542",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDE5MjE2Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-17T16:06:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660192167",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept NACK :p\r\n\r\nLooking in more detail now, it's clear that I jumped to an incorrect conclusion in #19174. My apologies to @theStack for a review so shallow it proved harmful. I'll make sure that future NACKs come with a more thorough review.\r\n\r\nI agree with @jnewbery's assessment here: https://github.com/bitcoin/bitcoin/pull/19174#issuecomment-658627037.\r\n\r\nAs a note on process, I rather appreciate the way this worked out. Bad reviews should be called out as such (as @MarcoFalke and @jnewbery did), and worrisome merges should be pointed out for discussion (as @JeremyRubin did), even if ultimately no further action is taken. Though one might argue that I was so off-base on my argument that @MarcoFalke was right not to sit around and wait for me to figure it out :)\r\n\r\nThanks to everyone for being reasonable. Sorry for the noise!",
      "created_at" : "2020-07-17T19:41:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19542#issuecomment-660303800",
      "id" : 660303800,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19542",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDMwMzgwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-17T20:39:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660303800",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   }
]
