{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "Submitting this in the hopes somebody might pick it up and run with it (see the TODO list at end):\n\nInstead of dropping double-spent transactions, relay them to peers. Why? To make it easier for merchants to quickly detect attempted fraud for low-value, in-person purchases.\n\nA bloom filter is used so that only the first double-spend is relayed, to prevent an attacker from mounting a network denial-of-service attack by flooding it with double-spends of a transaction output they control.\n\nPeter Todd pointed out a possible try-to-DoS-network-bandwidth attack that this enables that works like this:\n\n1) Attacker starts with an unspent transaction input.\n2) Attacker sends a small-in-size first spend with a small fee.\n3) Attacker double-spends the transaction input with a very large (e.g. 100K) transaction with a large fee.\n\nSince miners will mine the first, small transaction (it might even pay a higher fee-per-kilobyte, but pay lower overall fee), an attacker can waste network bandwidth for a low cost.  Whether or not attackers will actually do this isn't clear, they don't directly gain anything by wasting network bandwidth.\n\nThe right solution to that possible DoS attack is for nodes to have a bandwidth budget for 'tx' messages, and start dropping messages (perhaps starting with the largest double-spends) if that budget is exceeded.\n\nOther things on the TODO:\n\n1) Bitcoin-Qt should warn the user if a zero-confirmation transaction is double-spent, and should have a notion of \"dead\" transactions (another spend made it into a block). NOTE: I found it is easy to create double spends running three local nodes in -regtest mode, and the raw transactions API (create/sign a pair of double-spending transactions, then sendrawtransaction them from two nodes at the same time).\n\n2) The RPC calls that give transaction information should report (somehow) double-spend attempts and \"dead\" transactions.\n\n3) Write up a test plan for all of the above.\n",
   "closed_at" : "2014-07-04T19:04:53Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/331997?v=4",
      "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
      "followers_url" : "https://api.github.com/users/gavinandresen/followers",
      "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/gavinandresen",
      "id" : 331997,
      "login" : "gavinandresen",
      "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
      "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
      "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
      "repos_url" : "https://api.github.com/users/gavinandresen/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/gavinandresen"
   },
   "comments" : 34,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3354/comments",
   "created_at" : "2013-12-04T05:17:05Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3354/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/3354",
   "id" : 23695355,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3354/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MTA1MDE1NjE=",
   "number" : 3354,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/3354.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3354",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/3354.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3354"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Relay first-double-spend transactions",
   "updated_at" : "2014-07-04T19:04:53Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3354",
   "user" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/331997?v=4",
      "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
      "followers_url" : "https://api.github.com/users/gavinandresen/followers",
      "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/gavinandresen",
      "id" : 331997,
      "login" : "gavinandresen",
      "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
      "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
      "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
      "repos_url" : "https://api.github.com/users/gavinandresen/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/gavinandresen"
   }
}
