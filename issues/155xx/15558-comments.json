[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2019-03-07T23:51:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-470748173",
      "id" : 470748173,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MDc0ODE3Mw==",
      "updated_at" : "2019-06-05T11:31:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/470748173",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Wouldn't this mean if one DNS seed is compromised, it could potentially feed sybil addresses to nodes and its victims wouldn't have any honest nodes (eg, from other DNS seeds)?\r\n\r\nDoes the issue it intends to address actually exist? I would think DNS queries would get cached and proxied by ISP DNS servers sufficiently to deny any information to the real DNS servers, no?",
      "created_at" : "2019-03-08T02:57:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-470786101",
      "id" : 470786101,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MDc4NjEwMQ==",
      "updated_at" : "2019-03-08T02:57:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/470786101",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "3 seems like an OK number to query for at once, but a reasonable thing to bikeshed a bit.\r\n\r\nCode looks good to me.",
      "created_at" : "2019-03-08T06:05:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-470816781",
      "id" : 470816781,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MDgxNjc4MQ==",
      "updated_at" : "2019-03-08T06:05:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/470816781",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "node_id" : "MDQ6VXNlcjg4MTI1Mw==",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yeah, my comment in IRC was that one creates an immediate eclipse vulnerability.  Three sounds reasonable.\r\n\r\nWe also really should look at why this is triggered as much as it is, locally I see it run on every restart these days.",
      "created_at" : "2019-03-08T10:09:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-470875656",
      "id" : 470875656,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MDg3NTY1Ng==",
      "updated_at" : "2019-03-08T10:09:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/470875656",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\n> Yeah, my comment in IRC was that one creates an immediate eclipse vulnerability. Three sounds reasonable.\r\n\r\nBut only for new nodes, I suppose? If it already has gossiped peers before, then 'query one DNS seed' seems more reasonable. But okay, 3 is a safer option in any case.\r\n\r\n> We also really should look at why this is triggered as much as it is, locally I see it run on every restart these days.\r\n\r\nMy guess would be that the peers it tries initially to connect to might not be selected for connectability. Maybe 11 seconds is also too little. I think it would be fine to increase this to say, 30 or even 60 seconds.",
      "created_at" : "2019-03-09T05:19:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-471147040",
      "id" : 471147040,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MTE0NzA0MA==",
      "updated_at" : "2019-03-09T05:19:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/471147040",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It may just be that we need to try connections faster initially. ... I dunno I really have the impression that it was frequently not using dns seeds in the past but is now, but I don't have hard data to support that. In theory feelers should mean that our tried table is better than ever before, but it might just be that there has been a lot of node churn lately.",
      "created_at" : "2019-03-09T06:20:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-471150395",
      "id" : 471150395,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MTE1MDM5NQ==",
      "updated_at" : "2019-03-09T06:21:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/471150395",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "When the code was added circa 2014 in 2e7009d67b862cf822a1c70e181de6af659a3096, 11 seconds was completely arbitrary.   It was always the intent to adjust that number based on field experience.  It sounds like it needs to increase.\r\n\r\nThe driving theory is to make DNS seeds a fallback and \"give it a good try\" to avoid querying DNS seeds at all.\r\n\r\nThe code already skips the delay for an empty AddrMan -- ie. fresh bitcoind install -- thus narrowing the user impact of a longer delay to existing nodes that presumably have addrman data to sort through.\r\n\r\nIt boils down to a question of how much dependence should a node have on DNS seeds, in general?   *300 seconds* is a reasonable answer for the new delay, if we want to give AddrMan time to \"warm up\" and preserve privacy a bit more. ",
      "created_at" : "2019-03-09T18:25:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-471208937",
      "id" : 471208937,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MTIwODkzNw==",
      "updated_at" : "2019-03-09T18:25:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/471208937",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/494411?v=4",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "node_id" : "MDQ6VXNlcjQ5NDQxMQ==",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It boils down to a question of how much dependence should a node have on DNS seeds, in general? \r\n\r\nIMO nodes should only consult DNS seeds at first run, and then never again.",
      "created_at" : "2019-03-10T02:03:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-471239506",
      "id" : 471239506,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MTIzOTUwNg==",
      "updated_at" : "2019-03-10T02:03:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/471239506",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-03-15T06:16:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-473171758",
      "id" : 473171758,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MzE3MTc1OA==",
      "updated_at" : "2019-03-15T06:16:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/473171758",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK with > 1 seed per round.\r\n\r\nutACK 9f36b04fa039d4ddbd9a4b559a62a5d6e1a873e5 (3 seeds)\r\n\r\nThe frequent DNS queries recently have hopefully been addressed with #15486. \r\n\r\n> IMO nodes should only consult DNS seeds at first run, and then never again.\r\n\r\nI like that idea as well, but for another PR, as it requires much more thought than this change.\r\n\r\n> 11 seconds was completely arbitrary. It was always the intent to adjust that number based on field experience. It sounds like it needs to increase\r\n\r\nAs a GUI use I'd get antsy if \"nothing happens\" for 15+ seconds, but as long as there's some indicator that we're trying various new peers that should be fine. In that case we can wait much longer before trying the DNS again. ",
      "created_at" : "2019-03-15T16:57:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-473364080",
      "id" : 473364080,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3MzM2NDA4MA==",
      "updated_at" : "2019-03-15T17:02:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/473364080",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r276410000"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276410000"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If the user specifies `-forcednsseed`, they might want/expect all of them to be queried?",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-04-17T20:00:20Z",
      "diff_hunk" : "@@ -1521,35 +1524,40 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        seeds_right_now += DNSSEEDS_TO_QUERY_AT_ONCE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r276410000",
      "id" : 276410000,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NjQxMDAwMA==",
      "original_commit_id" : "9f36b04fa039d4ddbd9a4b559a62a5d6e1a873e5",
      "original_position" : 38,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 227967877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-08-07T00:25:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276410000",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r276411035"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276411035"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this might be more readable if the std::string type remained explicit here (since we LogPrintf it below).",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-04-17T20:03:26Z",
      "diff_hunk" : "@@ -1521,35 +1524,40 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        seeds_right_now += DNSSEEDS_TO_QUERY_AT_ONCE;\n     }\n \n-    const std::vector<std::string> &vSeeds = Params().DNSSeeds();\n-    int found = 0;\n+    for (const auto& seed : seeds) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r276411035",
      "id" : 276411035,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NjQxMTAzNQ==",
      "original_commit_id" : "9f36b04fa039d4ddbd9a4b559a62a5d6e1a873e5",
      "original_position" : 43,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 227967877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-08-07T00:25:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/276411035",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@naumenkogs Did you want to take a look here? \r\n\r\nThis has a number of Concept ACKs, have tagged with `0.19.0`.",
      "created_at" : "2019-08-04T06:16:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-517977282",
      "id" : 517977282,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNzk3NzI4Mg==",
      "updated_at" : "2019-08-04T06:16:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/517977282",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-08-04T14:32:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-518008426",
      "id" : 518008426,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxODAwODQyNg==",
      "updated_at" : "2019-08-04T14:32:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/518008426",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "First of all, could we update the initial message of the PR so that it's clear that it suggests connecting to 3 (*not one*) without reading full discussion? Maybe strike-through would work.\r\n\r\nThe choice of 3 seeds and the general idea seems reasonable to me.\r\nutACK\r\n\r\n\r\n",
      "created_at" : "2019-08-05T15:11:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-518275038",
      "id" : 518275038,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxODI3NTAzOA==",
      "updated_at" : "2019-08-05T15:14:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/518275038",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r311326690"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/311326690"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-08-07T00:25:27Z",
      "diff_hunk" : "@@ -1521,35 +1524,40 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        seeds_right_now += DNSSEEDS_TO_QUERY_AT_ONCE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r311326690",
      "id" : 311326690,
      "in_reply_to_id" : 276410000,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxMTMyNjY5MA==",
      "original_commit_id" : "9f36b04fa039d4ddbd9a4b559a62a5d6e1a873e5",
      "original_position" : 38,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 271678241,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-08-07T00:25:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/311326690",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r311326750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/311326750"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fine.",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-08-07T00:25:44Z",
      "diff_hunk" : "@@ -1521,35 +1524,40 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        seeds_right_now += DNSSEEDS_TO_QUERY_AT_ONCE;\n     }\n \n-    const std::vector<std::string> &vSeeds = Params().DNSSeeds();\n-    int found = 0;\n+    for (const auto& seed : seeds) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r311326750",
      "id" : 311326750,
      "in_reply_to_id" : 276411035,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxMTMyNjc1MA==",
      "original_commit_id" : "9f36b04fa039d4ddbd9a4b559a62a5d6e1a873e5",
      "original_position" : 43,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 271678307,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-08-07T00:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/311326750",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Addressed the comments above.",
      "created_at" : "2019-08-07T00:26:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-518891719",
      "id" : 518891719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxODg5MTcxOQ==",
      "updated_at" : "2019-08-07T00:26:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/518891719",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 6170ec5d3\r\n\r\nWith `-forcednsseed=1` it now fetches all (testnet) seeds.\r\n\r\nWhen I restart it sometimes fetches (3) seeds, about 10 seconds after `dnsseed thread start`. Other times it finds several outbound nodes and the DNS seed exited. \r\n\r\nWhen I delete `peers.dat` it uses all DNS seeds.",
      "created_at" : "2019-08-07T14:23:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-519119962",
      "id" : 519119962,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxOTExOTk2Mg==",
      "updated_at" : "2019-08-07T14:23:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/519119962",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "One high-level concern with this is the monoculture of DNS seed software we have, if you select three at random you're almost certain to get three seeds serving from sipa's seeder implementation, whereas we should really be trying to diversify a little bit (not to mention get things like dnssec going, which I dont believe sipa's seeder support). Otherwise, Concept ACK.",
      "created_at" : "2019-09-07T17:38:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-529128985",
      "id" : 529128985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyOTEyODk4NQ==",
      "updated_at" : "2019-09-07T17:39:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/529128985",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "node_id" : "MDQ6VXNlcjY0OTI0Ng==",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@naumenkogs @luke-jr Did you want to re-review here?\r\n\r\n@sdaftuar This might also interest you?",
      "created_at" : "2019-09-13T02:06:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-531071650",
      "id" : 531071650,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMTA3MTY1MA==",
      "updated_at" : "2019-09-13T02:06:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/531071650",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-09-18T12:33:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-532663432",
      "id" : 532663432,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMjY2MzQzMg==",
      "updated_at" : "2019-09-18T12:33:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/532663432",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 6170ec5d3ac2bc206068b270e5722a7ecd3a8f26 - I think the risk of a single seeder codebase is orthogonal to this PR. Such risks could also be interpreted differently (diversity could also increase the risk based on the threat model).",
      "created_at" : "2019-09-18T12:51:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-532669748",
      "id" : 532669748,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMjY2OTc0OA==",
      "updated_at" : "2019-09-18T12:51:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/532669748",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r326947136"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/326947136"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> goal: only query DNS seed if address need is acute\r\n\r\nFrom my understanding, \"acute\" here is essentially on first run, or if you've got a `peers.dat` with low quality/unlikely to connect quickly peers?",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-09-23T04:38:16Z",
      "diff_hunk" : "@@ -1508,35 +1511,41 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        // When -forcednsseed is provided, query all.\n+        seeds_right_now = seeds.size();\n     }\n \n-    const std::vector<std::string> &vSeeds = Params().DNSSeeds();\n-    int found = 0;\n+    for (const std::string& seed : seeds) {\n+        // goal: only query DNS seed if address need is acute",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r326947136",
      "id" : 326947136,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNjk0NzEzNg==",
      "original_commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "original_position" : 45,
      "path" : "src/net.cpp",
      "position" : 45,
      "pull_request_review_id" : 291561357,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-09-23T04:41:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/326947136",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> One high-level concern with this is the monoculture of DNS seed software we have, if you select three at random you're almost certain to get three seeds serving from sipa's seeder implementation, whereas we should really be trying to diversify a little bit (not to mention get things like dnssec going, which I dont believe sipa's seeder support). \r\n\r\nOpened #16938 if anyone wants to brainstorm / discuss DNS seeder software diversity. \r\nThis PR is also related to #15434.",
      "created_at" : "2019-09-23T04:46:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-533958576",
      "id" : 533958576,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMzk1ODU3Ng==",
      "updated_at" : "2019-09-23T04:46:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533958576",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Change this to to only query three randomly-selected DNS seed. If 11 seconds later we still don't have enough connections, try again with another one, and so on\r\n\r\nI guess this should say \"try again with another *three*\"\r\n\r\n```\r\n\r\n2019-09-23T14:06:29Z Loading addresses from DNS seed seed.bitcoin.sipa.be\r\n2019-09-23T14:06:29Z Loading addresses from DNS seed seed.bitcoin.sprovoost.nl\r\n2019-09-23T14:06:29Z Loading addresses from DNS seed dnsseed.bluematt.me\r\n\r\n\r\n\r\n2019-09-23T14:06:40Z Loading addresses from DNS seed seed.bitcoinstats.com\r\n2019-09-23T14:06:40Z Loading addresses from DNS seed seed.bitcoin.jonasschnelli.ch\r\n2019-09-23T14:06:40Z Loading addresses from DNS seed seed.btc.petertodd.org\r\n\r\n\r\n\r\n2019-09-23T14:06:51Z Loading addresses from DNS seed dnsseed.bitcoin.dashjr.org\r\n2019-09-23T14:06:51Z Loading addresses from DNS seed dnsseed.emzy.de\r\n2019-09-23T14:06:51Z 0 addresses found from DNS seeds\r\n2019-09-23T14:06:51Z dnsseed thread exit\r\n\r\n",
      "created_at" : "2019-09-23T14:08:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-534115760",
      "id" : 534115760,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15558",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDExNTc2MA==",
      "updated_at" : "2019-09-23T14:08:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534115760",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r327421987"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/327421987"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Post-merge review: I think there's a bug here: if this loop is hit with `addrman.size()==0` and `seeds_right_now==0` it will then query the first seed, and set `seeds_right_now==-1`, at which point this condition will keep failing on future loops, preventing a delay between batches of 3 seeds, and preventing early exit. I think this means that new nodes with no peers.dat will still always immediately query all dns seeds. In #16939 I've made the logic `if (addrman==0 && seeds_right_now==0) { current code } else if (seeds_right_now == 0) { seeds_right_now += 3; }` which should give more sensible behaviour.",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-09-24T04:23:54Z",
      "diff_hunk" : "@@ -1508,35 +1511,41 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        // When -forcednsseed is provided, query all.\n+        seeds_right_now = seeds.size();\n     }\n \n-    const std::vector<std::string> &vSeeds = Params().DNSSeeds();\n-    int found = 0;\n+    for (const std::string& seed : seeds) {\n+        // goal: only query DNS seed if address need is acute\n+        // Avoiding DNS seeds when we don't need them improves user privacy by\n+        // creating fewer identifying DNS requests, reduces trust by giving seeds\n+        // less influence on the network topology, and reduces traffic to the seeds.\n+        if (addrman.size() > 0 && seeds_right_now == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r327421987",
      "id" : 327421987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNzQyMTk4Nw==",
      "original_commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "original_position" : 49,
      "path" : "src/net.cpp",
      "position" : 49,
      "pull_request_review_id" : 292169223,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-09-24T04:23:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/327421987",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r327643907"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/327643907"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My understanding was that this was intentional behavior (eg @Sjors  points this out in https://github.com/bitcoin/bitcoin/pull/15558#issuecomment-519119962), but perhaps this should be better commented.\r\n\r\nIt made sense to me that we would query all dns seeds when starting up for the first time, which is consistent with prior behavior, and that the purpose of this PR was to limit dns seed usage only in the case of nodes that have been online before.",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-09-24T14:21:28Z",
      "diff_hunk" : "@@ -1508,35 +1511,41 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        // When -forcednsseed is provided, query all.\n+        seeds_right_now = seeds.size();\n     }\n \n-    const std::vector<std::string> &vSeeds = Params().DNSSeeds();\n-    int found = 0;\n+    for (const std::string& seed : seeds) {\n+        // goal: only query DNS seed if address need is acute\n+        // Avoiding DNS seeds when we don't need them improves user privacy by\n+        // creating fewer identifying DNS requests, reduces trust by giving seeds\n+        // less influence on the network topology, and reduces traffic to the seeds.\n+        if (addrman.size() > 0 && seeds_right_now == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r327643907",
      "id" : 327643907,
      "in_reply_to_id" : 327421987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNzY0MzkwNw==",
      "original_commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "original_position" : 49,
      "path" : "src/net.cpp",
      "position" : 49,
      "pull_request_review_id" : 292459377,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-09-24T14:21:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/327643907",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r327663011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/327663011"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Seems surprising to me. If it's intentional, could simplify the logic a bit, and make it:\r\n\r\n```\r\nif (forcednsseed || addrman.size() == 0) seeds_right_now = seeds.size();\r\nfor (seed : seeds) {\r\n    if (seeds_right_now == 0) { sleep(); check(); seeds_right_now += 3; }\r\n    lookup();\r\n    --seeds_right_now;\r\n}\r\n```",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-09-24T14:53:29Z",
      "diff_hunk" : "@@ -1508,35 +1511,41 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        // When -forcednsseed is provided, query all.\n+        seeds_right_now = seeds.size();\n     }\n \n-    const std::vector<std::string> &vSeeds = Params().DNSSeeds();\n-    int found = 0;\n+    for (const std::string& seed : seeds) {\n+        // goal: only query DNS seed if address need is acute\n+        // Avoiding DNS seeds when we don't need them improves user privacy by\n+        // creating fewer identifying DNS requests, reduces trust by giving seeds\n+        // less influence on the network topology, and reduces traffic to the seeds.\n+        if (addrman.size() > 0 && seeds_right_now == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r327663011",
      "id" : 327663011,
      "in_reply_to_id" : 327421987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNzY2MzAxMQ==",
      "original_commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "original_position" : 49,
      "path" : "src/net.cpp",
      "position" : 49,
      "pull_request_review_id" : 292484573,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-09-24T14:53:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/327663011",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r327672786"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/327672786"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Aligning with the code comments that are quoted above + @luke-jr 's comments in related PR, this seems like an adequate summary?\r\n* Newly initialized nodes with no addrman data should query seeds immediately\r\n* Nodes with healthy addrman should not query seeds at all\r\n\r\nThe latter point seems to maximally align with the code comment & user privacy",
      "commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "created_at" : "2019-09-24T15:10:11Z",
      "diff_hunk" : "@@ -1508,35 +1511,41 @@ void StopMapPort()\n \n void CConnman::ThreadDNSAddressSeed()\n {\n-    // goal: only query DNS seeds if address need is acute\n-    // Avoiding DNS seeds when we don't need them improves user privacy by\n-    //  creating fewer identifying DNS requests, reduces trust by giving seeds\n-    //  less influence on the network topology, and reduces traffic to the seeds.\n-    if ((addrman.size() > 0) &&\n-        (!gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED))) {\n-        if (!interruptNet.sleep_for(std::chrono::seconds(11)))\n-            return;\n+    FastRandomContext rng;\n+    std::vector<std::string> seeds = Params().DNSSeeds();\n+    Shuffle(seeds.begin(), seeds.end(), rng);\n+    int seeds_right_now = 0; // Number of seeds left before testing if we have enough connections\n+    int found = 0;\n \n-        LOCK(cs_vNodes);\n-        int nRelevant = 0;\n-        for (const CNode* pnode : vNodes) {\n-            nRelevant += pnode->fSuccessfullyConnected && !pnode->fFeeler && !pnode->fOneShot && !pnode->m_manual_connection && !pnode->fInbound;\n-        }\n-        if (nRelevant >= 2) {\n-            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n-            return;\n-        }\n+    if (gArgs.GetBoolArg(\"-forcednsseed\", DEFAULT_FORCEDNSSEED)) {\n+        // When -forcednsseed is provided, query all.\n+        seeds_right_now = seeds.size();\n     }\n \n-    const std::vector<std::string> &vSeeds = Params().DNSSeeds();\n-    int found = 0;\n+    for (const std::string& seed : seeds) {\n+        // goal: only query DNS seed if address need is acute\n+        // Avoiding DNS seeds when we don't need them improves user privacy by\n+        // creating fewer identifying DNS requests, reduces trust by giving seeds\n+        // less influence on the network topology, and reduces traffic to the seeds.\n+        if (addrman.size() > 0 && seeds_right_now == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15558#discussion_r327672786",
      "id" : 327672786,
      "in_reply_to_id" : 327421987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNzY3Mjc4Ng==",
      "original_commit_id" : "6170ec5d3ac2bc206068b270e5722a7ecd3a8f26",
      "original_position" : 49,
      "path" : "src/net.cpp",
      "position" : 49,
      "pull_request_review_id" : 292497619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15558",
      "updated_at" : "2019-09-24T15:10:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/327672786",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/494411?v=4",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "node_id" : "MDQ6VXNlcjQ5NDQxMQ==",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   }
]
