{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "(WIP because if we're not careful this could result in a lot of false +ves. Should be tested on different platforms to verify portability).\r\n\r\n#12362 was only observed when running the functional tests locally because:\r\n- by defatul libc logs to `/dev/tty` instead of stderr\r\n- the functional tests only check for substring inclusion in stderr when we're expecting bitcoind to fail.\r\n\r\nThis PR tightens our checking of stderr and will cause tests to fail if there is any unexpected message in stderr:\r\n\r\n- commit _rename TestNode to TestP2PConn in tests_ is not necessary in this PR, but it removes a name conflict in the functional tests (which makes it difficult to see all the places that `TestNode` is being called)\r\n- commit _Move assert_start_raises_init_error method to TestNode_ moves a method from test_framework to test_node (in general, methods which only affect a single node should be methods in `TestNode`).\r\n- commit _Write stdout/stderr to datadir instead of temp file_ writes stderr to a file in the datadir instead of a temporary file. This helps with debugging in the case of failure.\r\n- commit _Use LIBC_FATAL_STDERR_=1 in tests_ ensures that libc failures are logged to stderr instead of the terminal.\r\n- commit _Update assert_start_raises_init_eror() to test for an exact mâ¦_ changes `assert_start_raises_init_eror()` to match on an exact regex instead of a substring (with due [apologies](https://github.com/bitcoin/bitcoin/pull/12302#issuecomment-361691241) to @laanwj for #12302).\r\n- commit _Assert that bitcoind stdout is empty on shutdown_ asserts that stderr is empty on bitcoind shutdown.",
   "closed_at" : "2018-03-22T13:53:50Z",
   "closed_by" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
      "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jnewbery/followers",
      "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jnewbery",
      "id" : 1063656,
      "login" : "jnewbery",
      "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
      "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
      "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
      "repos_url" : "https://api.github.com/users/jnewbery/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jnewbery"
   },
   "comments" : 6,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12379/comments",
   "created_at" : "2018-02-07T16:03:25Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12379/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/12379",
   "id" : 295193702,
   "labels" : [
      {
         "color" : "d4c5f9",
         "default" : false,
         "id" : 62963516,
         "name" : "Tests",
         "node_id" : "MDU6TGFiZWw2Mjk2MzUxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12379/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MTY3NzM0NTg5",
   "number" : 12379,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/12379.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12379",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/12379.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12379"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "[WIP] Better stderr testing in functional tests",
   "updated_at" : "2018-03-22T13:53:50Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12379",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
      "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jnewbery/followers",
      "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jnewbery",
      "id" : 1063656,
      "login" : "jnewbery",
      "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
      "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
      "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
      "repos_url" : "https://api.github.com/users/jnewbery/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jnewbery"
   }
}
