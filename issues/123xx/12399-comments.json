[
   {
      "author_association" : "MEMBER",
      "body" : "I don't see how this causes coin loss. The keys are imported to the wallet and their transactions are still scanned for regardless of whether they were in the keypool or not. So what if they are not returned to the user? Transactions to those keys are still scanned for; the backups are not invalidated as the keys are all there.",
      "created_at" : "2018-02-09T16:15:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-364479716",
      "id" : 364479716,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "updated_at" : "2018-02-09T16:15:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/364479716",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@achow101 \r\n> I don't see how this causes coin loss. The keys are imported to the wallet and their transactions are still scanned for regardless of whether they were in the keypool or not. So what if they are not returned to the user? Transactions to those keys are still scanned for; the backups are not invalidated as the keys are all there.\r\n\r\nI was *not* referring to preexisting stored coins on the imported keys or coins incoming to the imported keys. You lose coins if:\r\n- you request a new address in the UI.\r\n- you have someone send coins to that address.\r\n- afterwards your disk dies and you try to restore from a backup of your wallet dump. The requested address won't be included in it as it was from the keypool of the wallet you imported to, **not** from the keypool of the imported wallet of which your dump was from.",
      "created_at" : "2018-02-09T16:17:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-364480178",
      "id" : 364480178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "updated_at" : "2018-02-09T16:25:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/364480178",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/78502?v=4",
         "events_url" : "https://api.github.com/users/xor-freenet/events{/privacy}",
         "followers_url" : "https://api.github.com/users/xor-freenet/followers",
         "following_url" : "https://api.github.com/users/xor-freenet/following{/other_user}",
         "gists_url" : "https://api.github.com/users/xor-freenet/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/xor-freenet",
         "id" : 78502,
         "login" : "xor-freenet",
         "organizations_url" : "https://api.github.com/users/xor-freenet/orgs",
         "received_events_url" : "https://api.github.com/users/xor-freenet/received_events",
         "repos_url" : "https://api.github.com/users/xor-freenet/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/xor-freenet/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/xor-freenet/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/xor-freenet"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "(Of course the user should assume that if there are 2 keypools involved then both can be used, so also the one of the newer wallet which imported the older one - but the ```dumpwallet``` output also contains the birth date of all keys, and the keypool normally should be used in order of key age. So if the imported dump is much older than the importing wallet then I would assume the keypool of the imported dump is used up first, but it is not used at all.)",
      "created_at" : "2018-02-09T16:35:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-364485847",
      "id" : 364485847,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "updated_at" : "2018-02-09T16:36:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/364485847",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/78502?v=4",
         "events_url" : "https://api.github.com/users/xor-freenet/events{/privacy}",
         "followers_url" : "https://api.github.com/users/xor-freenet/followers",
         "following_url" : "https://api.github.com/users/xor-freenet/following{/other_user}",
         "gists_url" : "https://api.github.com/users/xor-freenet/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/xor-freenet",
         "id" : 78502,
         "login" : "xor-freenet",
         "organizations_url" : "https://api.github.com/users/xor-freenet/orgs",
         "received_events_url" : "https://api.github.com/users/xor-freenet/received_events",
         "repos_url" : "https://api.github.com/users/xor-freenet/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/xor-freenet/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/xor-freenet/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/xor-freenet"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Please recover our losses",
      "created_at" : "2018-02-12T22:17:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-365081920",
      "id" : 365081920,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "updated_at" : "2018-02-12T22:17:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/365081920",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/36367168?v=4",
         "events_url" : "https://api.github.com/users/ushan007/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ushan007/followers",
         "following_url" : "https://api.github.com/users/ushan007/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ushan007/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ushan007",
         "id" : 36367168,
         "login" : "ushan007",
         "organizations_url" : "https://api.github.com/users/ushan007/orgs",
         "received_events_url" : "https://api.github.com/users/ushan007/received_events",
         "repos_url" : "https://api.github.com/users/ushan007/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ushan007/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ushan007/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ushan007"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The feature request didn't seem to attract much attention in the past. Also, the issue seems not important enough right now to keep it sitting around idle in the list of open issues.\r\n\r\nClosing due to lack of interest. Pull requests with improvements are always welcome.",
      "created_at" : "2020-05-08T22:32:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-626048460",
      "id" : 626048460,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNjA0ODQ2MA==",
      "updated_at" : "2020-05-08T22:32:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626048460",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@MarcoFalke \r\n> The feature request didn't seem to attract much attention in the past. Also, the issue seems not important enough right now to keep it sitting around idle in the list of open issues.\r\n> \r\n> Closing due to lack of interest. Pull requests with improvements are always welcome.\r\n\r\nUh, sorry but this is **not** a feature request, it is a bug report, and it can cause users to lose money!  \r\n\r\nThus requesting more people to be interested in this seems inappropriate because someone being \"interested\" is equal to them having lost money due to the bug, and you wouldn't want people to lose money I suppose :)\r\n\r\nI cannot offer a PR because I'm not qualified to write C++ code, sorry.",
      "created_at" : "2020-05-11T21:14:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-626968271",
      "id" : 626968271,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNjk2ODI3MQ==",
      "updated_at" : "2020-05-11T21:14:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626968271",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/78502?v=4",
         "events_url" : "https://api.github.com/users/xor-freenet/events{/privacy}",
         "followers_url" : "https://api.github.com/users/xor-freenet/followers",
         "following_url" : "https://api.github.com/users/xor-freenet/following{/other_user}",
         "gists_url" : "https://api.github.com/users/xor-freenet/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/xor-freenet",
         "id" : 78502,
         "login" : "xor-freenet",
         "node_id" : "MDQ6VXNlcjc4NTAy",
         "organizations_url" : "https://api.github.com/users/xor-freenet/orgs",
         "received_events_url" : "https://api.github.com/users/xor-freenet/received_events",
         "repos_url" : "https://api.github.com/users/xor-freenet/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/xor-freenet/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/xor-freenet/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/xor-freenet"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Sorry, I just couldn't follow how this leads to loss of fund, so I interpreted the issue as a wish-list item where you want imported keypool keys be queued up in the keypool again. I don't think anyone is ever going to work on that idea.\r\n\r\nHowever, if you think this leads to loss of coins, then please include exact steps to reproduce and I am happy to take another look.",
      "created_at" : "2020-05-11T21:32:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-626976926",
      "id" : 626976926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNjk3NjkyNg==",
      "updated_at" : "2020-05-11T21:32:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626976926",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I haven't tested, but I think @xor-freenet is imagining this sequence of steps, which I have also worried about:\r\n\r\n1. Import backed up wallet to a new computer; call the computer C.\r\n2. With C, perform a transaction.\r\n3. C's hard disk crashes.\r\n\r\nIf importing a wallet also imported the keypool, you'd be okay: your original wallet backup (the one you used in step 1) would work.\r\n\r\nBut if not, I assume that means you've lost your outputs from 2.\r\n\r\nThis could be mitigated by making a new backup each time you import a wallet, but some users may reasonably assume there's no point in backing up a wallet when you've just restored from a backup.\r\n\r\nThis comment is based on assumptions and no actual tests; sorry if I'm mistaken about all this.",
      "created_at" : "2021-01-10T06:06:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-757423565",
      "id" : 757423565,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NzQyMzU2NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-10T06:06:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757423565",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/225893?v=4",
         "events_url" : "https://api.github.com/users/falsifian/events{/privacy}",
         "followers_url" : "https://api.github.com/users/falsifian/followers",
         "following_url" : "https://api.github.com/users/falsifian/following{/other_user}",
         "gists_url" : "https://api.github.com/users/falsifian/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/falsifian",
         "id" : 225893,
         "login" : "falsifian",
         "node_id" : "MDQ6VXNlcjIyNTg5Mw==",
         "organizations_url" : "https://api.github.com/users/falsifian/orgs",
         "received_events_url" : "https://api.github.com/users/falsifian/received_events",
         "repos_url" : "https://api.github.com/users/falsifian/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/falsifian/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/falsifian/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/falsifian"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@MarcoFalke :\r\n@falsifian has correctly described the exact steps you requested which lead to loss of funds.  \r\nSorry for forgetting to reply with them myself, and thanks to falsifian for doing so.\r\n\r\nfalsifian also brought up a very good additional point:\r\n> but some users may reasonably assume there's no point in backing up a wallet when you've just restored from a backup\r\n\r\nThis is amplified by the fact that professional users might even before they send **any** funds to a wallet dump it first, import the dump to a fresh wallet, and then work off the imported dump.\r\nThat's because only working upon a working-copy which is the result of a restored backup ensures that both:\r\n- you are forced to test your restoring mechanism so you know it works.\r\n- and it also prevents you from ever forgetting to backup anything because your working copy is **based** upon a backup.\r\n\r\nWith the current state of Bitcoin Core's `importwallet` however, it means they lose their money even though they intended to do a professional failsafe procedure!\r\n\r\nFurther, notice that it is not unlikely for people to prefer `dumpwallet` + `importwallet` over just backing up the `wallet.dat`:  \r\n- `dumpwallet` produces a human readable file which can thus be much more easily validated to be non-corrupted than a binary blob such as `wallet.dat`.  \r\n- Also if someone wants to conduct cold storage they might prefer `dumpwallet` because you can just print the output on a sheet of paper (albeit that is not encrypted with a password, please be careful!).\r\n\r\nThus please re-open this ticket, it is not a feature request, it is a bug :(",
      "created_at" : "2021-01-10T22:32:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-757555666",
      "id" : 757555666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NzU1NTY2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-10T22:33:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757555666",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/78502?v=4",
         "events_url" : "https://api.github.com/users/xor-freenet/events{/privacy}",
         "followers_url" : "https://api.github.com/users/xor-freenet/followers",
         "following_url" : "https://api.github.com/users/xor-freenet/following{/other_user}",
         "gists_url" : "https://api.github.com/users/xor-freenet/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/xor-freenet",
         "id" : 78502,
         "login" : "xor-freenet",
         "node_id" : "MDQ6VXNlcjc4NTAy",
         "organizations_url" : "https://api.github.com/users/xor-freenet/orgs",
         "received_events_url" : "https://api.github.com/users/xor-freenet/received_events",
         "repos_url" : "https://api.github.com/users/xor-freenet/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/xor-freenet/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/xor-freenet/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/xor-freenet"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@MarcoFalke @falsifian \r\nIn case you had read my reply off an email notification please notice that I had to edit a word in the \"This is amplified by...\" sentence to make it more easy to understand, and GitHub won't notice you by email about that, so here it is:\r\n\"This is amplified by the fact that professional users might even before they send (<- edited, was 'import') any funds to a wallet dump it first, import the dump to a fresh wallet, and then work off the imported dump.\"",
      "created_at" : "2021-01-10T22:40:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12399#issuecomment-757556575",
      "id" : 757556575,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12399",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NzU1NjU3NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-10T22:40:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757556575",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/78502?v=4",
         "events_url" : "https://api.github.com/users/xor-freenet/events{/privacy}",
         "followers_url" : "https://api.github.com/users/xor-freenet/followers",
         "following_url" : "https://api.github.com/users/xor-freenet/following{/other_user}",
         "gists_url" : "https://api.github.com/users/xor-freenet/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/xor-freenet",
         "id" : 78502,
         "login" : "xor-freenet",
         "node_id" : "MDQ6VXNlcjc4NTAy",
         "organizations_url" : "https://api.github.com/users/xor-freenet/orgs",
         "received_events_url" : "https://api.github.com/users/xor-freenet/received_events",
         "repos_url" : "https://api.github.com/users/xor-freenet/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/xor-freenet/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/xor-freenet/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/xor-freenet"
      }
   }
]
