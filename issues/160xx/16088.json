{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "<!-- This issue tracker is only for technical issues related to Bitcoin Core.\r\n\r\nGeneral bitcoin questions and/or support requests are best directed to the Bitcoin StackExchange at https://bitcoin.stackexchange.com.\r\n\r\nFor reporting security issues, please read instructions at https://bitcoincore.org/en/contact/.\r\n\r\nIf the node is \"stuck\" during sync or giving \"block checksum mismatch\" errors, please ensure your hardware is stable by running memtest and observe CPU temperature with a load-test tool such as linpack before creating an issue! -->\r\n\r\n<!-- Describe the issue -->\r\nï¬Level 5 vulnerabilitiesï¼only 1ï¼\r\n(1)bitcoin-master/src/qt/guiutil.cpp:662: [5] (race) readlink:\r\nThis accepts filename arguments; if an attacker can move those files or change the link content, a race condition result. Also, it does not terminate with ASCII NUL. (CWE-362, CWE-20). Reconsider approach.\r\n(2) bitcoin-master/src/leveldb/util/env_posix.cc:411: [4] (race) access: (from level 4)\r\nThis usually indicates a security flaw. If an attacker can change anything along the path between the call to access () and the file's actual use (e.g., by moving files), the attacker can exploit the race condition (CWE-362/CWE-367). Set up the correct permissions (e.g., using setuid ()) and try to open the file directly.\r\n\r\nCWE-362: Indicates that the program contains a sequence of code that can be run concurrently with other code, and that requires temporary, mutually exclusive access to Shared resources. However, there is a time window in which another sequence of code can modify a Shared resource concurrently. If the expected synchronization activity is in security-critical code, there may be security implications. Security-critical codes include recording whether the user is authenticated, modifying important status information. Competitive conditions occur in concurrent environments, where a sequence of code can take the form of a function call, a small number of instructions, a series of program calls, and more, depending on the context.\r\nScope of impact: confidentiality, integrity, and availability.\r\n\r\nCWE-20: The product does not validate or incorrectly validate inputs that can affect the program's control flow or data flow. Given enough information, such vulnerabilities can be further classified into lower-level types. When software does not correctly validate input, an attacker can forge input that is not expected by the application. This will cause the system to receive some abnormal input, and an attacker may use this vulnerability to modify the control flow, control arbitrary resources and execute arbitrary code.\r\nï¬Level 4 vulnerabilities\r\n(1)Bitcoin-master/src/dbwrapper.cpp:45: [4] (format) vsnprintf:\r\nIf format strings can be influenced by an attacker, they can be exploited, and note that sprintf variations do not always \\0-terminate (CWE-134). Use a constant for the format specification.\r\n(2) bitcoin-master/src/leveldb/util/env_win.cc:582: [4] (format) vsnprintf:\r\nIf format strings can be influenced by an attacker, they can be exploited, and note that sprintf variations do not always \\0-terminate (CWE-134). Use a constant for the format specification.\r\n(3) bitcoin-master/src/leveldb/util/posix_logger.h:67: [4] (format) vsnprintf:\r\nIf format strings can be influenced by an attacker, they can be exploited, and note that sprintf variations do not always \\0-terminate (CWE-134). Use a constant for the format specification.\r\n(4) bitcoin-master/src/tinyformat.h:984: [4] (format) printf:\r\nIf format strings can be influenced by an attacker, they can be exploited (CWE-134). Use a constant for the format specification. \r\n(5) bitcoin-master/src/tinyformat.h:1010: [4] (format) printf:\r\nIf format strings can be influenced by an attacker, they can be exploited (CWE-134). Use a constant for the format specification. \r\n(6) bitcoin-master/src/tinyformat.h:1038: [4] (format) printf:\r\nIf format strings can be influenced by an attacker, they can be exploited (CWE-134). Use a constant for the format specification.\r\n\r\nCWE-134 The functions used by the software receive a formatted string from the external source code as a parameter to the function. This can lead to buffer overflows, denial of service attacks, or data representation problems when an attacker can modify the externally controlled formatting string. The existence of this vulnerability may affect memory reading while the program is running.\r\n\r\n(7) bitcoin-master/src/qt/bitcoin.cpp:78: [4] (shell) system:\r\nThis causes a new program to execute and is difficult to use safely (CWE-78). try using a library call that implements the same functionality if available.\r\n\r\n(8) bitcoin-master/src/util/system.cpp:1129: [4] (shell) system:\r\nThis causes a new program to execute and is difficult to use safely (CWE-78). try using a library call that implements the same functionality if available.\r\nCWE-78: The software constructs all or part of the operating system commands using externally affected input from upstream components but does not filter or properly filter out elements that can modify the expected operating system commands sent to downstream components. Such vulnerabilities allow an attacker to execute unexpected and dangerous commands directly on the operating system. This vulnerability, on the part of the project, can cause system errors by executing some unauthorized code.\r\n\r\n<!--- What behavior did you expect? -->\r\nrecover this \r\n\r\n<!--- What was the actual behavior (provide screenshots if the issue is GUI-related)? -->\r\n\r\n<!--- How reliably can you reproduce the issue, what are the steps to do so? -->\r\n\r\n<!-- What version of Bitcoin Core are you using, where did you get it (website, self-compiled, etc)? -->\r\n\r\n<!-- What type of machine are you observing the error on (OS/CPU and disk type)? -->\r\n\r\n<!-- For the GUI-related issue on Linux provide names and versions of a distro, a desktop environment and a graphical shell (if relevant). -->\r\n\r\n<!-- Any extra information that might be useful in the debugging process. -->\r\n<!--- This is normally the contents of a `debug.log` or `config.log` file. Raw text or a link to a pastebin type site are preferred. -->\r\n",
   "closed_at" : "2019-05-25T15:10:27Z",
   "closed_by" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
      "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
      "followers_url" : "https://api.github.com/users/fanquake/followers",
      "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/fanquake",
      "id" : 863730,
      "login" : "fanquake",
      "node_id" : "MDQ6VXNlcjg2MzczMA==",
      "organizations_url" : "https://api.github.com/users/fanquake/orgs",
      "received_events_url" : "https://api.github.com/users/fanquake/received_events",
      "repos_url" : "https://api.github.com/users/fanquake/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/fanquake"
   },
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16088/comments",
   "created_at" : "2019-05-25T15:06:51Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16088/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/16088",
   "id" : 448472875,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16088/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU0NDg0NzI4NzU=",
   "number" : 16088,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "flawfinder",
   "updated_at" : "2019-05-25T15:10:27Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16088",
   "user" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/49299079?v=4",
      "events_url" : "https://api.github.com/users/monashpaul/events{/privacy}",
      "followers_url" : "https://api.github.com/users/monashpaul/followers",
      "following_url" : "https://api.github.com/users/monashpaul/following{/other_user}",
      "gists_url" : "https://api.github.com/users/monashpaul/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/monashpaul",
      "id" : 49299079,
      "login" : "monashpaul",
      "node_id" : "MDQ6VXNlcjQ5Mjk5MDc5",
      "organizations_url" : "https://api.github.com/users/monashpaul/orgs",
      "received_events_url" : "https://api.github.com/users/monashpaul/received_events",
      "repos_url" : "https://api.github.com/users/monashpaul/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/monashpaul/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/monashpaul/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/monashpaul"
   }
}
