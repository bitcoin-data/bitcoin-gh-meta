{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "The timeout interval for the send and recv buffers was changed from 90\r\nminutes to 20 minutes in commit f1920e86 in 2013, except for peers that\r\ndid not support the pong message (where the recv buffer timeout remained\r\nat 90 minutes). A few observations:\r\n\r\n- for peers that support BIP 31 (pong messages), this recv buffer\r\n  timeout is almost redundant with the ping timeout. We send a ping\r\n  message every two minutes, and set a timeout of twenty minutes to\r\n  receive the pong response. If the recv buffer was really timing out,\r\n  then the pong response would also time out.\r\n- BIP 31 is supported by all nodes of p2p version 60000 and higher, and\r\n  has been in widespread use since 2013. I'd be very surprised if there\r\n  are many nodes on the network that don't support pong messages.\r\n- The recv buffer timeout is not specified in any p2p BIP. We're free to\r\n  set it at any value we want.\r\n- A peer that doesn't support BIP 31 and hasn't sent any message to us\r\n  at all in 90 minutes is unlikely to be useful for us, and is more likely\r\n  to be evicted AttemptToEvictConnection() since it'll have the worst\r\n  possible ping time and isn't providing blocks/transactions.\r\n\r\nTherefore, we remove this check, and set the recv buffer timeout to 20\r\nminutes for all peers. This removes the final p2p version dependent\r\nlogic from the net layer, so all p2p version data can move into the\r\nnet_processing layer.\r\n\r\nAlternative approaches:\r\n\r\n- Set the recv buffer timeout to 90 minutes for all peers. This almost\r\n  wouldn't be a behaviour change at all (pre-BIP 31 peers would still\r\n  have the same recv buffer timeout, and we can't ever reach a recv buffer\r\n  timeout higher than 21 minutes for post-BIP31 peers, because the pong\r\n  timeout would be hit first).\r\n- Stop supporting peers that don't support BIP 31. BIP 31 has been in\r\n  use since 2012, and implementing it is trivial.",
   "closed_at" : "2020-12-16T19:30:25Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
      "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
      "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/MarcoFalke",
      "id" : 6399679,
      "login" : "MarcoFalke",
      "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
      "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
      "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
      "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/MarcoFalke"
   },
   "comments" : 9,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20651/comments",
   "created_at" : "2020-12-14T13:25:01Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20651/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/20651",
   "id" : 766432979,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "description" : null,
         "id" : 98298007,
         "name" : "P2P",
         "node_id" : "MDU6TGFiZWw5ODI5ODAwNw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20651/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0NTM5NDQ5Nzc5",
   "number" : 20651,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/20651.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20651",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/20651.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20651"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "net: Make p2p recv buffer timeout 20 minutes for all peers",
   "updated_at" : "2020-12-16T20:02:11Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20651",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
      "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jnewbery/followers",
      "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jnewbery",
      "id" : 1063656,
      "login" : "jnewbery",
      "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
      "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
      "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
      "repos_url" : "https://api.github.com/users/jnewbery/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jnewbery"
   }
}
