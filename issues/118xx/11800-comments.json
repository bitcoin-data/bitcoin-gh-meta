[
   {
      "author_association" : "OWNER",
      "body" : "> Of course testnet is always \"weird\", but 36 block estimate being higher than 2 block estimate doesn't make sense, even on testnet.\r\n\r\nYes, that seems wrong.",
      "created_at" : "2017-11-30T18:38:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11800#issuecomment-348280430",
      "id" : 348280430,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11800",
      "updated_at" : "2017-11-30T18:38:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/348280430",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Question about the fee_estimates file you attached.  Did you quit bitcoind before grabbing it, or is that the file that was in place while it was running?",
      "created_at" : "2017-12-05T15:42:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11800#issuecomment-349343598",
      "id" : 349343598,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11800",
      "updated_at" : "2017-12-05T15:42:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349343598",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh. I don't remember at this point, but I probably forgot that it's written\nonly on turn-off and I copied from a live node, so it's useless. Sorry\n\nOn Dec 5, 2017 4:43 PM, \"Alex Morcos\" <notifications@github.com> wrote:\n\n> Question about the fee_estimates file you attached. Did you quit bitcoind\n> before grabbing it, or is that the file that was in place while it was\n> running?\n>\n> Ã¢ÂÂ\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/issues/11800#issuecomment-349343598>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AAGZ8WloqN4hL17wYMpG400k6jN49bx_ks5s9WSggaJpZM4Qwztn>\n> .\n>\n",
      "created_at" : "2017-12-05T16:35:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11800#issuecomment-349361281",
      "id" : 349361281,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11800",
      "updated_at" : "2017-12-05T16:35:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349361281",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/104945?v=4",
         "events_url" : "https://api.github.com/users/runn1ng/events{/privacy}",
         "followers_url" : "https://api.github.com/users/runn1ng/followers",
         "following_url" : "https://api.github.com/users/runn1ng/following{/other_user}",
         "gists_url" : "https://api.github.com/users/runn1ng/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/runn1ng",
         "id" : 104945,
         "login" : "runn1ng",
         "organizations_url" : "https://api.github.com/users/runn1ng/orgs",
         "received_events_url" : "https://api.github.com/users/runn1ng/received_events",
         "repos_url" : "https://api.github.com/users/runn1ng/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/runn1ng/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/runn1ng/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/runn1ng"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "That's ok, I think I have an idea for what the issue is, and perhaps a way to fix it.",
      "created_at" : "2017-12-05T18:29:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11800#issuecomment-349396568",
      "id" : 349396568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11800",
      "updated_at" : "2017-12-05T18:29:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349396568",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "OK, so I believe I understand the bug.\r\nestimatesmartfee takes the max of three different sub-estimates:\r\n- 60% threshold at half the target\r\n- 85% threshold at the target\r\n- 95% threshold at double the target\r\n\r\nAn estimate for a higher target should be monotonically decreasing in each of those 3 sub-estimates.  So therefore the final estimates should also be monotonically decreasing.\r\n\r\nHowever, there is the possibility that one of the sub-estimates is unable to return an estimate because there is no fee rate that is high enough to meet the threshold.  The algorithm was designed to just return the max of the other sub-estimates in this case with the reasoning being that it is better to give some estimate rather than give up and revert to the fallback fee or have a potentially computationally expensive search for the lowest target which is able to return all sub-estimates.   The downside of this is that if a higher target can return that sub-estimate, it might actually be higher than either of the other sub-estimates at the lower target and cause a final estimate which is actually greater for the higher target.\r\n\r\nAlthough it's not ideal, I think this falls in the category of \"won't fix\".  What is really happening in this edge case is that the estimate for the lower target is perhaps not as high as it should be.  But in analyzing a proper fix, I think that time would be better spent either doing a wholesale improvement to fee estimation, or working on better RBF or CPFP tools.\r\n\r\nI believe that given current fee markets this should be very unlikely on mainnet, and that if conditions were to arise that made this more likely, we probably need a better fee estimation algorithm anyway.  Also the raw data is accessible through estimaterawfee which could allow anyone to make their own more complicated combination of sub-estimates if they really care.\r\n\r\n",
      "created_at" : "2017-12-06T16:38:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11800#issuecomment-349697807",
      "id" : 349697807,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11800",
      "updated_at" : "2017-12-06T16:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349697807",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It might be good to update the existing code comment to mention the edge case, since it's easy to read it and think that monoticity will always be preserved:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/497d0e014cc79d46531d570e74e4aeae72db602d/src/policy/fees.cpp#L860-L868",
      "created_at" : "2017-12-06T17:07:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11800#issuecomment-349707510",
      "id" : 349707510,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11800",
      "updated_at" : "2017-12-06T17:07:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349707510",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
