[
   {
      "author_association" : "MEMBER",
      "body" : "I've seen this multiple times\r\n\r\ncc @instagibbs ",
      "created_at" : "2020-12-01T08:13:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-736301192",
      "id" : 736301192,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20538",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNjMwMTE5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-01T08:13:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/736301192",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Which notifications are you listening to?\n\nOn Tue, Dec 1, 2020, 4:14 PM MarcoFalke <notifications@github.com> wrote:\n\n> I've seen this multiple times\n>\n> cc @instagibbs <https://github.com/instagibbs>\n>\n> â\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-736301192>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ABMAFU7NPJSKW5Z2IL7646DSSSQUZANCNFSM4UIVKXXA>\n> .\n>\n",
      "created_at" : "2020-12-01T10:06:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-736372514",
      "id" : 736372514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20538",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNjM3MjUxNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-01T10:06:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/736372514",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ah sorry, email notification confusion.\r\n\r\nI'll take a look and see if I can reason about it.",
      "created_at" : "2020-12-01T12:46:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-736529810",
      "id" : 736529810,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20538",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNjUyOTgxMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-01T12:46:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/736529810",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nothing fishy in the logs.\r\n\r\nIt's possible that this chunk of code isn't lenient enough under certain conditions, causing the first message to get lost:\r\n```\r\n        # Relax so that the subscriber is ready before publishing zmq messages\r\n        sleep(0.2)\r\n```",
      "created_at" : "2020-12-02T12:32:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-737201554",
      "id" : 737201554,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20538",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNzIwMTU1NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-02T12:32:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/737201554",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Removing the sleep gives `zmq.error.Again: Resource temporarily unavailable`, which I've also seen in some test failures. Generally, a hardcoded sleep is a recipe for intermittent failures.\r\n\r\nIs it not possible for zmq to fully boot up (like the rpc interface) when the server is starting?\r\n\r\nHow is this dealt with in production?",
      "created_at" : "2020-12-04T13:42:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-738790061",
      "id" : 738790061,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20538",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczODc5MDA2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-04T13:42:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/738790061",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In prod you don't \"expect\" any specific message so you start with whichever\none you get.\n\nI think for tests we could just have a block making and zmq consumption\nloop that \"syncs up\" the expected message then continues onto the rest of\nthe test?\n\nOn Fri, Dec 4, 2020, 9:42 PM MarcoFalke <notifications@github.com> wrote:\n\n> Removing the sleep gives zmq.error.Again: Resource temporarily unavailable,\n> which I've also seen in some test failures. Generally, a hardcoded sleep is\n> a recipe for intermittent failures.\n>\n> Is it not possible for zmq to fully boot up (like the rpc interface) when\n> the server is starting?\n>\n> How is this dealt with in production?\n>\n> â\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-738790061>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ABMAFU6TPANPRGZ55ANO5RDSTDRMDANCNFSM4UIVKXXA>\n> .\n>\n",
      "created_at" : "2020-12-04T13:44:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-738791198",
      "id" : 738791198,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20538",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczODc5MTE5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-04T13:44:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/738791198",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "E.g., make a block, try to read off zmq messages until you get it(with\ntimeout), if that fails with timeout do it again. Rinse repeat until you\nget the message.\n\nOn Fri, Dec 4, 2020, 9:44 PM Greg Sanders <gsanders87@gmail.com> wrote:\n\n> In prod you don't \"expect\" any specific message so you start with\n> whichever one you get.\n>\n> I think for tests we could just have a block making and zmq consumption\n> loop that \"syncs up\" the expected message then continues onto the rest of\n> the test?\n>\n> On Fri, Dec 4, 2020, 9:42 PM MarcoFalke <notifications@github.com> wrote:\n>\n>> Removing the sleep gives zmq.error.Again: Resource temporarily\n>> unavailable, which I've also seen in some test failures. Generally, a\n>> hardcoded sleep is a recipe for intermittent failures.\n>>\n>> Is it not possible for zmq to fully boot up (like the rpc interface) when\n>> the server is starting?\n>>\n>> How is this dealt with in production?\n>>\n>> â\n>> You are receiving this because you were mentioned.\n>> Reply to this email directly, view it on GitHub\n>> <https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-738790061>,\n>> or unsubscribe\n>> <https://github.com/notifications/unsubscribe-auth/ABMAFU6TPANPRGZ55ANO5RDSTDRMDANCNFSM4UIVKXXA>\n>> .\n>>\n>\n",
      "created_at" : "2020-12-04T13:45:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20538#issuecomment-738791868",
      "id" : 738791868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20538",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczODc5MTg2OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-04T13:45:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/738791868",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
