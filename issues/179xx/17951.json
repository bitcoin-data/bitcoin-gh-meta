{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "In order to determine whether to download or process a relayed transaction, we first try to check whether we already have the transaction -- either in the mempool, in our filter of recently rejected transactions, in our orphan pool, or already confirmed in a block.\r\n\r\nPrior to this commit, the heuristic for checking whether a transaction was confirmed in a block is based on whether there's a coin cache entry corresponding to the 0- or 1-index vout of the tx. While that is a quick check, it is very imprecise (eg if those outputs were already spent in another block, we wouldn't detect that the transaction has already been confirmed) -- we can do better by just keeping a rolling bloom filter of the transactions in recent blocks, which will better capture the case of a transaction which has been confirmed and then fully spent. \r\n\r\nThis should reduce the bandwidth that we waste by requesting transactions which will not be accepted to the mempool.\r\n\r\nTo avoid relay problems for transactions which have been included in a recent block but then reorged out of the chain, we clear the bloom filter whenever a block is disconnected.",
   "closed_at" : "2020-01-31T13:43:42Z",
   "closed_by" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
      "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
      "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jonasschnelli",
      "id" : 178464,
      "login" : "jonasschnelli",
      "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
      "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
      "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
      "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jonasschnelli"
   },
   "comments" : 17,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17951/comments",
   "created_at" : "2020-01-17T17:22:23Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17951/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/17951",
   "id" : 551538503,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "description" : null,
         "id" : 98298007,
         "name" : "P2P",
         "node_id" : "MDU6TGFiZWw5ODI5ODAwNw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17951/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MzY0MjQyNjI0",
   "number" : 17951,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/17951.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17951",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/17951.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17951"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Use rolling bloom filter of recent block txs for AlreadyHave() check",
   "updated_at" : "2020-01-31T13:43:42Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17951",
   "user" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
      "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
      "followers_url" : "https://api.github.com/users/sdaftuar/followers",
      "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/sdaftuar",
      "id" : 7463573,
      "login" : "sdaftuar",
      "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
      "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
      "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
      "repos_url" : "https://api.github.com/users/sdaftuar/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/sdaftuar"
   }
}
