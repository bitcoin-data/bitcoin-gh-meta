[
   {
      "author_association" : "MEMBER",
      "body" : "Haven't tested yet, but screenshots look good.\n",
      "created_at" : "2013-10-24T18:04:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27015421",
      "id" : 27015421,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MDE1NDIx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27015421/reactions"
      },
      "updated_at" : "2013-10-24T18:04:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27015421",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "You might want to write \"verified\" vs \"unverified\", it's a bit closer to the truth.\n",
      "created_at" : "2013-10-24T19:02:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27020463",
      "id" : 27020463,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MDIwNDYz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27020463/reactions"
      },
      "updated_at" : "2013-10-24T19:02:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27020463",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/971089?v=4",
         "events_url" : "https://api.github.com/users/mikehearn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mikehearn/followers",
         "following_url" : "https://api.github.com/users/mikehearn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mikehearn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mikehearn",
         "id" : 971089,
         "login" : "mikehearn",
         "node_id" : "MDQ6VXNlcjk3MTA4OQ==",
         "organizations_url" : "https://api.github.com/users/mikehearn/orgs",
         "received_events_url" : "https://api.github.com/users/mikehearn/received_events",
         "repos_url" : "https://api.github.com/users/mikehearn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mikehearn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mikehearn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mikehearn"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Yay!  Thanks for tackling this!\n",
      "created_at" : "2013-10-24T21:15:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27031245",
      "id" : 27031245,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MDMxMjQ1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27031245/reactions"
      },
      "updated_at" : "2013-10-24T21:15:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27031245",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=4",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@mikehearn Agreed, thanks.\n",
      "created_at" : "2013-10-25T12:05:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27084963",
      "id" : 27084963,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MDg0OTYz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27084963/reactions"
      },
      "updated_at" : "2013-10-25T12:05:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27084963",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=4",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "node_id" : "MDQ6VXNlcjE0MTk2NDk=",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Updated:\n- re-worked some UI tooltips to better understand (secure -> verified and insecure -> unverified)\n- changed code to use SendCoinsRecipient.message for storing the memo\n",
      "created_at" : "2013-10-27T20:58:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27179058",
      "id" : 27179058,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MTc5MDU4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27179058/reactions"
      },
      "updated_at" : "2013-10-27T20:58:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27179058",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=4",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "node_id" : "MDQ6VXNlcjE0MTk2NDk=",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3145#discussion_r7245794"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3145"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7245794"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you be sure that the new SendCoinsRecipient is always the first one? (index 0)\nNit: It may be better to first build a SendCoinsRecipient and append it to recipients at the end of the function. This also avoids a lot of repeated `recipients[0]`.\n",
      "commit_id" : "395d0d5af017bbf6d432471075608efaf4104a03",
      "created_at" : "2013-10-28T12:14:41Z",
      "diff_hunk" : "@@ -454,9 +451,36 @@ bool PaymentServer::processPaymentRequest(PaymentRequestPlus& request, QList<Sen\n     if (!optionsModel)\n         return false;\n \n-    QList<std::pair<CScript,qint64> > sendingTos = request.getPayTo();\n-    qint64 totalAmount = 0;\n+    recipients.append(SendCoinsRecipient());\n+\n+    recipients[0].paymentRequest = request;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#discussion_r7245794",
      "id" : 7245794,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcyNDU3OTQ=",
      "original_commit_id" : "fe168997ba3daf036ecea83b8000c0f9e6ef1165",
      "original_line" : null,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/qt/paymentserver.cpp",
      "position" : null,
      "pull_request_review_id" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3145",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7245794/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2013-10-31T16:52:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7245794",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3145#discussion_r7245969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3145"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7245969"
         }
      },
      "author_association" : "NONE",
      "body" : "I locally changed all QList<SendCoinsEntry> usages with processPaymentRequest() to a single SendCoinsEntry, as we don't have multiple SendCoinsEntries with payment requests (as that is one of the things which this pull is changing), so yes I can be sure (as long as there are no subtle bugs left then).\n\nYour nit should be fixed by the next push to this branch :).\n",
      "commit_id" : "395d0d5af017bbf6d432471075608efaf4104a03",
      "created_at" : "2013-10-28T12:24:09Z",
      "diff_hunk" : "@@ -454,9 +451,36 @@ bool PaymentServer::processPaymentRequest(PaymentRequestPlus& request, QList<Sen\n     if (!optionsModel)\n         return false;\n \n-    QList<std::pair<CScript,qint64> > sendingTos = request.getPayTo();\n-    qint64 totalAmount = 0;\n+    recipients.append(SendCoinsRecipient());\n+\n+    recipients[0].paymentRequest = request;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#discussion_r7245969",
      "id" : 7245969,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcyNDU5Njk=",
      "original_commit_id" : "fe168997ba3daf036ecea83b8000c0f9e6ef1165",
      "original_line" : null,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/qt/paymentserver.cpp",
      "position" : null,
      "pull_request_review_id" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3145",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7245969/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2013-10-31T16:52:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7245969",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=4",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "node_id" : "MDQ6VXNlcjE0MTk2NDk=",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3145#discussion_r7246631"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3145"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7246631"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If not generating a new-line for the last entry is the goal, comparing to sendingTos.size() - 1 is not enough, as the next entry may not generate a line of text at all even if it exists (but has a non-address target). \nI'd do this differently: Build a QStringList, then at the end concatenate them using join(\"&lt;br />\"). This also means that the counter `i` can go.\n",
      "commit_id" : "395d0d5af017bbf6d432471075608efaf4104a03",
      "created_at" : "2013-10-28T12:59:18Z",
      "diff_hunk" : "@@ -449,14 +446,39 @@ bool PaymentServer::readPaymentRequest(const QString& filename, PaymentRequestPl\n     return request.parse(data);\n }\n \n-bool PaymentServer::processPaymentRequest(PaymentRequestPlus& request, QList<SendCoinsRecipient>& recipients)\n+bool PaymentServer::processPaymentRequest(PaymentRequestPlus& request, SendCoinsRecipient& recipient)\n {\n     if (!optionsModel)\n         return false;\n \n-    QList<std::pair<CScript,qint64> > sendingTos = request.getPayTo();\n-    qint64 totalAmount = 0;\n+    recipient.paymentRequest = request;\n+    recipient.message = GUIUtil::HtmlEscape(request.getDetails().memo());\n+\n+    request.getMerchant(PaymentServer::certStore, recipient.authenticatedMerchant);\n+\n+    QList<std::pair<CScript, qint64> > sendingTos = request.getPayTo();\n+\n+    int i = 0;\n     foreach(const PAIRTYPE(CScript, qint64)& sendingTo, sendingTos) {\n+        // Extract and check destination addresses\n+        CTxDestination dest;\n+        if (ExtractDestination(sendingTo.first, dest)) {\n+            // Append destination address (for payment requests .address is used ONLY for GUI display)\n+            recipient.address.append(QString::fromStdString(CBitcoinAddress(dest).ToString()));\n+            if (i < sendingTos.size() - 1) // prevent new-line for last entry\n+                recipient.address.append(\"<br />\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#discussion_r7246631",
      "id" : 7246631,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcyNDY2MzE=",
      "original_commit_id" : "fef0b715eef1c7dc122792f0b17ce7d7e941d7ad",
      "original_line" : null,
      "original_position" : 69,
      "original_start_line" : null,
      "path" : "src/qt/paymentserver.cpp",
      "position" : null,
      "pull_request_review_id" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3145",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7246631/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2013-10-31T16:52:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7246631",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3145#discussion_r7247912"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3145"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7247912"
         }
      },
      "author_association" : "NONE",
      "body" : "I thought about changing `address` to a QStringList in general, but this would require an extensive rework, as SendCoinsRecipient is used quite often and makes only sense for payment requests anyway. This here is only used for displaying the addresses in the GUI anyway, no wallet code or such will ever touch this for payment requests currently.\n\nThe counter `i` is really just a quick and ugly hack ^^. And I'm going to change this to a QStringList, which is a much cleaner approach :).\n",
      "commit_id" : "395d0d5af017bbf6d432471075608efaf4104a03",
      "created_at" : "2013-10-28T13:47:43Z",
      "diff_hunk" : "@@ -449,14 +446,39 @@ bool PaymentServer::readPaymentRequest(const QString& filename, PaymentRequestPl\n     return request.parse(data);\n }\n \n-bool PaymentServer::processPaymentRequest(PaymentRequestPlus& request, QList<SendCoinsRecipient>& recipients)\n+bool PaymentServer::processPaymentRequest(PaymentRequestPlus& request, SendCoinsRecipient& recipient)\n {\n     if (!optionsModel)\n         return false;\n \n-    QList<std::pair<CScript,qint64> > sendingTos = request.getPayTo();\n-    qint64 totalAmount = 0;\n+    recipient.paymentRequest = request;\n+    recipient.message = GUIUtil::HtmlEscape(request.getDetails().memo());\n+\n+    request.getMerchant(PaymentServer::certStore, recipient.authenticatedMerchant);\n+\n+    QList<std::pair<CScript, qint64> > sendingTos = request.getPayTo();\n+\n+    int i = 0;\n     foreach(const PAIRTYPE(CScript, qint64)& sendingTo, sendingTos) {\n+        // Extract and check destination addresses\n+        CTxDestination dest;\n+        if (ExtractDestination(sendingTo.first, dest)) {\n+            // Append destination address (for payment requests .address is used ONLY for GUI display)\n+            recipient.address.append(QString::fromStdString(CBitcoinAddress(dest).ToString()));\n+            if (i < sendingTos.size() - 1) // prevent new-line for last entry\n+                recipient.address.append(\"<br />\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#discussion_r7247912",
      "id" : 7247912,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcyNDc5MTI=",
      "original_commit_id" : "fef0b715eef1c7dc122792f0b17ce7d7e941d7ad",
      "original_line" : null,
      "original_position" : 69,
      "original_start_line" : null,
      "path" : "src/qt/paymentserver.cpp",
      "position" : null,
      "pull_request_review_id" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3145",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7247912/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2013-10-31T16:52:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7247912",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=4",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "node_id" : "MDQ6VXNlcjE0MTk2NDk=",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've tested a bit, works great.\n\nNext thing we need to deal with is how payment request-generated transactions are shown in the transactions list. We ought to show the name of the merchant and the memo instead of bare addresses/labels.\n",
      "created_at" : "2013-10-28T15:08:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27219591",
      "id" : 27219591,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MjE5NTkx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27219591/reactions"
      },
      "updated_at" : "2013-10-28T15:08:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27219591",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Thanks for testing, I'm with you, we should rework how pr are shown in the tx list. But that should be part of another pull request then.\n\nMy roadmap with this is to re-add the delete button for pr's and then re-check the issue for what is left to be done here, before this needs testing by some other devs.\n",
      "created_at" : "2013-10-28T16:38:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27228874",
      "id" : 27228874,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MjI4ODc0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27228874/reactions"
      },
      "updated_at" : "2013-10-28T16:38:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27228874",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=4",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "node_id" : "MDQ6VXNlcjE0MTk2NDk=",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Eh yes, I certainly am not proposing that you add that to this pull req, it was just a general remark :)\n(BTW as unverified payments requests don't really have a recipient name/label, just the memo, this makes it challenging to show them in the transaction list in the same way as other transactions)\n\nAnd indeed a delete button would be useful, currently the only way to get rid of payment requests in the send list is the Clear button.\n",
      "created_at" : "2013-10-28T16:43:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27229432",
      "id" : 27229432,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MjI5NDMy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27229432/reactions"
      },
      "updated_at" : "2013-10-28T16:46:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27229432",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@laanwj A further thing to consider is our baloon pop-up when a transaction is detected. I mainly use 3 addresses I sent coins to when testing a payment request. This is really ugly with the pop-up, as we only show 1 a time, but the 3 are practically created right in a row... any idea here?\n",
      "created_at" : "2013-10-28T16:51:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27230304",
      "id" : 27230304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MjMwMzA0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27230304/reactions"
      },
      "updated_at" : "2013-10-28T16:51:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27230304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=4",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "node_id" : "MDQ6VXNlcjE0MTk2NDk=",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It should really show only one popup per transaction, not per output.\n\nFor the transaction list some kind of grouping makes sense too. Right now we always generate one record per output. Grouping on transaction level would be too coarse, but it should ideally show paid payment requests (which can involve multiple consecutive outputs) as one row and not multiple.\n",
      "created_at" : "2013-10-28T16:56:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27230970",
      "id" : 27230970,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3MjMwOTcw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27230970/reactions"
      },
      "updated_at" : "2013-10-28T16:56:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27230970",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/395d0d5af017bbf6d432471075608efaf4104a03 for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.\n",
      "created_at" : "2013-10-31T17:19:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27506353",
      "id" : 27506353,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3NTA2MzUz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27506353/reactions"
      },
      "updated_at" : "2013-10-31T17:19:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27506353",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=4",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "node_id" : "MDQ6VXNlcjIxMTA5MDc=",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@diapolo do you intend to make further changes here or is this ready for merging?\n",
      "created_at" : "2013-11-04T13:46:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27685433",
      "id" : 27685433,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3Njg1NDMz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27685433/reactions"
      },
      "updated_at" : "2013-11-04T13:46:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27685433",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@laanwj I currently have no working local build environment (tried to upgrade to a newer MinGW version, which caused troubles ^^). I intended to add back the delete button for payment requests, but this can be done in another pull. If there are no show-stoppers or bugs in here this can be merged.\n\n@gavinandresen Can you perhaps check this out and give an ACK?\n",
      "created_at" : "2013-11-04T14:10:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3145#issuecomment-27687040",
      "id" : 27687040,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3145",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3Njg3MDQw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27687040/reactions"
      },
      "updated_at" : "2013-11-04T14:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27687040",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=4",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "node_id" : "MDQ6VXNlcjE0MTk2NDk=",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   }
]
