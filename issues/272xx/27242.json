{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "### Current behaviour\r\n\r\nBuilding with the `--with-experimental-kernel-lib` configuration option currently leads to linker failures on OpenBSD 7.2. The following compiler/linker/build-tool versions are used:\r\n- clang 13.0.0\r\n- lld 13.0.0\r\n- ccache 4.6.3\r\n- GNU make 4.3\r\n- autoconf 2.71\r\n- automake 1.16.5\r\n\r\n### Expected behaviour\r\n\r\n- Building should succeed\r\n\r\n### Steps to reproduce\r\n\r\n```\r\n$ ./configure --enable-suppress-external-warnings --with-experimental-kernel-lib MAKE=gmake\r\n[ ... ]\r\n$ gmake clean\r\n$ gmake -j8\r\n[ ... ]\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for leveldb_comparator_t; recompile with -fPIC                  \r\n>>> defined in leveldb/.libs/libleveldb.a(libleveldb_la-c.o)\r\n>>> referenced by c.cc:87 (leveldb/db/c.cc:87)                                                                                           \r\n>>>               libleveldb_la-c.o:(leveldb_comparator_create) in archive leveldb/.libs/libleveldb.a                                    \r\n                                                                                                                                         \r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for leveldb_filterpolicy_t; recompile with -fPIC                \r\n>>> defined in leveldb/.libs/libleveldb.a(libleveldb_la-c.o)        \r\n>>> referenced by c.cc:107 (leveldb/db/c.cc:107) \r\n>>>               libleveldb_la-c.o:(leveldb_filterpolicy_create) in archive leveldb/.libs/libleveldb.a                                  \r\n                                                                    \r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for leveldb_filterpolicy_t; recompile with -fPIC                \r\n>>> defined in leveldb/.libs/libleveldb.a(libleveldb_la-c.o)                                                                             \r\n>>> referenced by c.cc:108 (leveldb/db/c.cc:108)                                                                                         \r\n>>>               libleveldb_la-c.o:(leveldb_filterpolicy_create_bloom::Wrapper::~Wrapper()) in archive leveldb/.libs/libleveldb.a       \r\n                                                                                                                                         \r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for leveldb_filterpolicy_t; recompile with -fPIC                \r\n>>> defined in leveldb/.libs/libleveldb.a(libleveldb_la-c.o)                                                                             \r\n>>> referenced by c.cc:108 (leveldb/db/c.cc:108)                                                                                         \r\n>>>               libleveldb_la-c.o:(leveldb_filterpolicy_create_bloom::Wrapper::~Wrapper()) in archive leveldb/.libs/libleveldb.a\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for leveldb_comparator_t; recompile with -fPIC\r\n>>> defined in leveldb/.libs/libleveldb.a(libleveldb_la-c.o)\r\n>>> referenced by c.cc:88 (leveldb/db/c.cc:88)\r\n>>>               libleveldb_la-c.o:(leveldb_comparator_t::~leveldb_comparator_t()) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for leveldb_comparator_t; recompile with -fPIC\r\n>>> defined in leveldb/.libs/libleveldb.a(libleveldb_la-c.o)\r\n>>> referenced by c.cc:88 (leveldb/db/c.cc:88)\r\n>>>               libleveldb_la-c.o:(leveldb_comparator_t::~leveldb_comparator_t()) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for leveldb_filterpolicy_t; recompile with -fPIC\r\n>>> defined in leveldb/.libs/libleveldb.a(libleveldb_la-c.o)\r\n>>> referenced by c.cc:108 (leveldb/db/c.cc:108)\r\n>>>               libleveldb_la-c.o:(leveldb_filterpolicy_t::~leveldb_filterpolicy_t()) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for leveldb_filterpolicy_t; recompile with -fPIC\r\n>>> defined in leveldb/.libs/libleveldb.a(libleveldb_la-c.o)\r\n>>> referenced by c.cc:108 (leveldb/db/c.cc:108)\r\n>>>               libleveldb_la-c.o:(leveldb_filterpolicy_t::~leveldb_filterpolicy_t()) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol construction vtable for std::__1::basic_ostream<char, std::__1::char_traits<char> >-in-std::__1::basic_ostringstream<char, std::__1::char_traits<char>, std::__1::allocator<char> >; recompile with -fPIC\r\n>>> defined in .libs/libbitcoinkernel_la-chain.o\r\n>>> referenced by ostream:165 (/usr/include/c++/v1/ostream:165)\r\n>>>               libleveldb_la-dbformat.o:(leveldb::ParsedInternalKey::DebugString() const) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol construction vtable for std::__1::basic_ostream<char, std::__1::char_traits<char> >-in-std::__1::basic_ostringstream<char, std::__1::char_traits<char>, std::__1::allocator<char> >; recompile with -fPIC\r\n>>> defined in .libs/libbitcoinkernel_la-chain.o\r\n>>> referenced by ostream:165 (/usr/include/c++/v1/ostream:165)\r\n>>>               libleveldb_la-dbformat.o:(leveldb::ParsedInternalKey::DebugString() const) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for std::__1::basic_ostringstream<char, std::__1::char_traits<char>, std::__1::allocator<char> >; recompile with -fPIC\r\nar>, std::__1::allocator<char> >; recompile with -fPIC\r\n>>> defined in .libs/libbitcoinkernel_la-chain.o\r\n>>> referenced by iosfwd:139 (/usr/include/c++/v1/iosfwd:139)\r\n>>>               libleveldb_la-dbformat.o:(leveldb::ParsedInternalKey::DebugString() const) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for std::__1::basic_stringbuf<char, std::__1::char_traits<char>,\r\n std::__1::allocator<char> >; recompile with -fPIC\r\n>>> defined in .libs/libbitcoinkernel_la-chain.o\r\n>>> referenced by iosfwd:133 (/usr/include/c++/v1/iosfwd:133)\r\n>>>               libleveldb_la-dbformat.o:(leveldb::ParsedInternalKey::DebugString() const) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol VTT for std::__1::basic_ostringstream<char, std::__1::char_traits<char>\r\n, std::__1::allocator<char> >; recompile with -fPIC\r\n>>> defined in .libs/libbitcoinkernel_la-chain.o\r\n>>> referenced by iosfwd:139 (/usr/include/c++/v1/iosfwd:139)\r\n>>>               libleveldb_la-dbformat.o:(leveldb::ParsedInternalKey::DebugString() const) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for std::__1::basic_ostringstream<char, std::__1::char_traits<ch\r\nar>, std::__1::allocator<char> >; recompile with -fPIC\r\n>>> defined in .libs/libbitcoinkernel_la-chain.o\r\n>>> referenced by iosfwd:139 (/usr/include/c++/v1/iosfwd:139)\r\n>>>               libleveldb_la-dbformat.o:(leveldb::ParsedInternalKey::DebugString() const) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for std::__1::basic_ostringstream<char, std::__1::char_traits<ch\r\nar>, std::__1::allocator<char> >; recompile with -fPIC\r\n>>> defined in .libs/libbitcoinkernel_la-chain.o\r\n>>> referenced by iosfwd:139 (/usr/include/c++/v1/iosfwd:139)\r\n>>>               libleveldb_la-dbformat.o:(leveldb::ParsedInternalKey::DebugString() const) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: relocation R_X86_64_PC32 cannot be used against symbol vtable for std::__1::basic_stringbuf<char, std::__1::char_traits<char>, std::__1::allocator<char> >; recompile with -fPIC\r\n>>> defined in .libs/libbitcoinkernel_la-chain.o\r\n>>> referenced by iosfwd:133 (/usr/include/c++/v1/iosfwd:133)\r\n>>>               libleveldb_la-dbformat.o:(leveldb::ParsedInternalKey::DebugString() const) in archive leveldb/.libs/libleveldb.a\r\n\r\nld: error: too many errors emitted, stopping now (use -error-limit=0 to see all errors)\r\nc++: error: linker command failed with exit code 1 (use -v to see invocation)\r\ngmake[2]: *** [Makefile:7030: libbitcoinkernel.la] Error 1\r\ngmake[1]: *** [Makefile:19397: all-recursive] Error 1\r\ngmake: *** [Makefile:814: all-recursive] Error 1\r\n```\r\n\r\n### Relevant log output\r\n\r\nThe ./configure output can be found here: https://pastebin.com/XzrZKe7D\r\n\r\n### How did you obtain Bitcoin Core\r\n\r\nCompiled from source\r\n\r\n### What version of Bitcoin Core are you using?\r\n\r\nmaster branch (commit 40d0b0a524dfe8cc70cc116a6c76a3f834824fe5)\r\n\r\n### Operating system and version\r\n\r\nOpenBSD 7.2 (amd64)\r\n\r\n### Machine specifications\r\n\r\n_No response_",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27242/comments",
   "created_at" : "2023-03-11T12:17:31Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27242/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/27242",
   "id" : 1619986699,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27242/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII585gjwkL",
   "number" : 27242,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27242/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27242/timeline",
   "title" : "Building `--with-experimental-kernel-lib` fails on OpenBSD 7.2",
   "updated_at" : "2023-03-11T12:23:51Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27242",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
      "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
      "followers_url" : "https://api.github.com/users/theStack/followers",
      "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
      "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/theStack",
      "id" : 91535,
      "login" : "theStack",
      "node_id" : "MDQ6VXNlcjkxNTM1",
      "organizations_url" : "https://api.github.com/users/theStack/orgs",
      "received_events_url" : "https://api.github.com/users/theStack/received_events",
      "repos_url" : "https://api.github.com/users/theStack/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/theStack"
   }
}
