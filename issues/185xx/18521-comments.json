[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18470 (net: Make stale tip check time type-safe, extend test by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-04-04T06:46:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#issuecomment-608984856",
      "id" : 608984856,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18521",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwODk4NDg1Ng==",
      "updated_at" : "2020-04-04T06:46:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/608984856",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\nVery nice fuzzing harness! Keep them coming! :)",
      "created_at" : "2020-04-04T17:27:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#issuecomment-609062123",
      "id" : 609062123,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18521",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwOTA2MjEyMw==",
      "updated_at" : "2020-04-04T17:27:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/609062123",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested ACK fa6a00843447d53a5708ea3a629b9150cfe58be2\r\n\r\nThanks for adding a very nice harness!",
      "created_at" : "2020-04-06T20:25:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#issuecomment-610018121",
      "id" : 610018121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18521",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxMDAxODEyMQ==",
      "updated_at" : "2020-04-06T20:25:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/610018121",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for testing. Did you find the CVE after re-introducing it?",
      "created_at" : "2020-04-06T20:26:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#issuecomment-610018603",
      "id" : 610018603,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18521",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxMDAxODYwMw==",
      "updated_at" : "2020-04-06T20:26:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/610018603",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke \r\n\r\nYes :)\r\n\r\nLive demo:\r\n\r\n```\r\n$ mkdir -p process_messages/\r\n$ src/test/fuzz/process_messages process_messages/\r\nâ¦\r\nbloom.cpp:45:69: runtime error: division by zero\r\nSUMMARY: UndefinedBehaviorSanitizer: undefined-behavior bloom.cpp:45:69 in\r\nAddressSanitizer:DEADLYSIGNAL\r\n=================================================================\r\n==17357==ERROR: AddressSanitizer: FPE on unknown address 0x55b551298dca (pc 0x55b551298dca bp 0x7ffd02f6f890 sp 0x7ffd02f6f860 T0)\r\n    #0 0x55b551298dca in CBloomFilter::Hash(unsigned int, std::vector<unsigned char, std::allocator<unsigned char> > const&) const src/bloom.cpp:45:69\r\n    #1 0x55b551298b69 in CBloomFilter::insert(std::vector<unsigned char, std::allocator<unsigned char> > const&) src/bloom.cpp:54:31\r\n    #2 0x55b550a820c6 in ProcessMessage(CNode*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, CDataStream&, long, CChainParams const&, CTxMemPool&, CConnman*, BanMan*, std::atomic<bool> const&) src/net_processing.cpp:3183:45\r\n    #3 0x55b550abd122 in PeerLogicValidation::ProcessMessages(CNode*, std::atomic<bool>&) src/net_processing.cpp:3359:16\r\n    #4 0x55b550ac0f25 in non-virtual thunk to PeerLogicValidation::ProcessMessages(CNode*, std::atomic<bool>&) src/net_processing.cpp\r\n    #5 0x55b550907f01 in ConnmanTestMsg::ProcessMessagesOnce(CNode&) src/./test/util/net.h:26:56\r\n    #6 0x55b550904ecf in test_one_input(std::vector<unsigned char, std::allocator<unsigned char> > const&) src/test/fuzz/process_messages.cpp:69:21\r\nâ¦\r\n$ xxd -p < ./crash-55a890a083dbb4291c5dbc367a58651d02854d86\r\n697665726163ffff006e5757a860a80d5d5c6966696c7465726164640061\r\nfc010000000064645757575757a8a8b661a85ca866696c7465726c6f6164\r\n00bb000500000000d08cff00000000613000ad000000005c6966696c7465\r\n72616464031561b800fc40636d7063ffffffffffffff325c6966696c7465\r\n726164640061fc00a8e0a87800000000000000ffff4100ff67cb59570d41\r\n4141fffedf4141415ca8a5a85a006ea5a8a865a867e5cb79570d5c57572f\r\na8a5ffff00ff020d5ca8a8a8a8a8696e76a8a86464\r\n$ strings ./crash-55a890a083dbb4291c5dbc367a58651d02854d86\r\niverac\r\n]\\ifilteradd\r\nddWWWWW\r\nfilterload\r\n\\ifilteradd\r\n@cmpc\r\n2\\ifilteradd\r\nAAA\\\r\n\\WW/\r\n```",
      "created_at" : "2020-04-08T08:31:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#issuecomment-610826738",
      "id" : 610826738,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18521",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxMDgyNjczOA==",
      "updated_at" : "2020-04-08T08:31:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/610826738",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Going to go ahead and merge this. If someone has feedback or questions, you are welcome to leave them here.",
      "created_at" : "2020-04-08T16:15:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#issuecomment-611051980",
      "id" : 611051980,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18521",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxMTA1MTk4MA==",
      "updated_at" : "2020-04-08T16:15:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/611051980",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r407148167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/407148167"
         }
      },
      "author_association" : "NONE",
      "body" : "Could the fuzzer check \"interesting\" cases more quickly by choosing a random but valid command, instead of generating a random string of length `COMMAND_SIZE`?",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-12T05:22:33Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r407148167",
      "id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE0ODE2Nw==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 391822769,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-12T05:36:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/407148167",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/63171930?v=4",
         "events_url" : "https://api.github.com/users/robot-visions/events{/privacy}",
         "followers_url" : "https://api.github.com/users/robot-visions/followers",
         "following_url" : "https://api.github.com/users/robot-visions/following{/other_user}",
         "gists_url" : "https://api.github.com/users/robot-visions/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/robot-visions",
         "id" : 63171930,
         "login" : "robot-visions",
         "node_id" : "MDQ6VXNlcjYzMTcxOTMw",
         "organizations_url" : "https://api.github.com/users/robot-visions/orgs",
         "received_events_url" : "https://api.github.com/users/robot-visions/received_events",
         "repos_url" : "https://api.github.com/users/robot-visions/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/robot-visions/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/robot-visions/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/robot-visions"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r407190532"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/407190532"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good question. I think there is a trade-off here between giving the fuzz engine as much freedom to explore as possible at a potentially slight cost of performance (citation needed, giving more freedom could also increase efficiency).\r\n\r\nYour suggestion would involve enumerating all netmessage types in an array and then having the fuzz engine pick one from it. This is possible, but as soon as you add a new message type, the developed seeds (inputs) render invalid and need to be adjusted. Readjusting the seeds should not be an issue for the fuzz engine, but it has to be done.\r\n\r\nApart from the above slight inconvenience of having to readjust the seeds on every added (or removed) message type, there is also an issue that the enumeration could accidentally miss one message type. On top, Bitcoin Core ignores unknown message types, and I'd say we want to test this code path as well. (Have at least one unknown message type generated by the fuzzer). This can also be fixed by adding an unknown message type to the fixed array the fuzz engine can pick from. E.g. \"foobarfoo\".\r\n\r\nMoreover, we might also want to test for slight modifications of the same message type and see if they affect behavior in any way. For example b\"filteradd\\x01add\" vs b\"filteradd\\x02\". Those two should never be treated as a valid command and obviously shouldn't crash Bitcoin Core. There should be unit and maybe other fuzz tests in place to check this, but I think allowing the fuzz engine in this test more freedom can't hurt.\r\n\r\nFinally, while I don't know the internals of fuzz engines, I believe they are really smart and quick about figuring out \"interesting\" strings that appear in the source code. If I had to guess what the performance penalty was of allowing any message type as opposed to limiting it to a fixed set of types, I'd presume it is an unnoticeable difference, maybe slight slow down or possibly a slight speed up even. A benchmark might help here.\r\n\r\nI tried a few other presumed performance improvements while writing the test and surprisingly I found that writing the least code, simplest code, while allowing the fuzz engine the most freedom was also the fastest way to find the CVE.",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-12T12:21:25Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r407190532",
      "id" : 407190532,
      "in_reply_to_id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE5MDUzMg==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 391851642,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-12T12:21:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/407190532",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r407246671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/407246671"
         }
      },
      "author_association" : "NONE",
      "body" : "Thanks for the really thorough explanation!  That tradeoff / your decision makes sense to me, especially since I didn't know that fuzz engines might do better than \"just generate random strings\".",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-12T20:12:05Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r407246671",
      "id" : 407246671,
      "in_reply_to_id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzI0NjY3MQ==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 391891351,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-12T20:17:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/407246671",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/63171930?v=4",
         "events_url" : "https://api.github.com/users/robot-visions/events{/privacy}",
         "followers_url" : "https://api.github.com/users/robot-visions/followers",
         "following_url" : "https://api.github.com/users/robot-visions/following{/other_user}",
         "gists_url" : "https://api.github.com/users/robot-visions/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/robot-visions",
         "id" : 63171930,
         "login" : "robot-visions",
         "node_id" : "MDQ6VXNlcjYzMTcxOTMw",
         "organizations_url" : "https://api.github.com/users/robot-visions/orgs",
         "received_events_url" : "https://api.github.com/users/robot-visions/received_events",
         "repos_url" : "https://api.github.com/users/robot-visions/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/robot-visions/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/robot-visions/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/robot-visions"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408509515"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408509515"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I agree as well that the merged version makes sense, but just out of interest I ran both versions (PR and a version which samples an array with all `NetMsgType`s currently defined in protocol.cpp ) in parallel with libfuzzer and it was the altered version which found the reintroduced CVE first after 2.3M iterations / 2 hours, while the PR version hadn't found it after 10M tries. \r\nI found it interesting that while the `cov` metric was similar between the runs, the `ft` metric of the fuzzer was consistently higher for the array version throughout the run.\r\n\r\nAlthough this was just sample size 1, so finding the CVE might have just been a lucky mutation in the fuzzer algorithm...",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-15T00:19:18Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408509515",
      "id" : 408509515,
      "in_reply_to_id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUwOTUxNQ==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 393379075,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-15T00:20:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408509515",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408518950"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408518950"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How many workers did you run in parallel?",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-15T00:53:18Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408518950",
      "id" : 408518950,
      "in_reply_to_id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUxODk1MA==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 393389349,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-15T00:53:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408518950",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408525052"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408525052"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just 1 for each version.",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-15T01:16:37Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408525052",
      "id" : 408525052,
      "in_reply_to_id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUyNTA1Mg==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 393396150,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-15T01:16:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408525052",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408526863"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408526863"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This sounds like a promising speed-up. I wouldn't object either having this one replaced or a new fuzz target with the array version.",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-15T01:23:37Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408526863",
      "id" : 408526863,
      "in_reply_to_id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUyNjg2Mw==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 393398182,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-15T01:23:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408526863",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408529541"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408529541"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'll do some more runs tomorrow, maybe I was just lucky. I don't have a good feeling for the variance of runtimes yet.",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-15T01:33:40Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408529541",
      "id" : 408529541,
      "in_reply_to_id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUyOTU0MQ==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 393401058,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408529541/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-15T01:33:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408529541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408532343"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408532343"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I saw it vary by a factor or 5 or 10 in my tests last week, so it could very well be just noise",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2020-04-15T01:44:12Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n+    std::vector<CNode*> peers;\n+\n+    const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n+    for (int i = 0; i < num_peers_to_add; ++i) {\n+        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        const bool inbound{fuzzed_data_provider.ConsumeBool()};\n+        const bool block_relay_only{fuzzed_data_provider.ConsumeBool()};\n+        peers.push_back(MakeUnique<CNode>(i, service_flags, 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, inbound, block_relay_only).release());\n+        CNode& p2p_node = *peers.back();\n+\n+        p2p_node.fSuccessfullyConnected = true;\n+        p2p_node.fPauseSend = false;\n+        p2p_node.nVersion = PROTOCOL_VERSION;\n+        p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+        g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n+\n+        connman.AddTestNode(p2p_node);\n+    }\n+\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r408532343",
      "id" : 408532343,
      "in_reply_to_id" : 407148167,
      "line" : 57,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODUzMjM0Mw==",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 57,
      "pull_request_review_id" : 393404038,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408532343/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-15T01:44:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408532343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "As a data point, I was able to reproduce the CVE. It took about ~5-6 hours running 16 jobs.\r\n\r\n```\r\nbloom.cpp:45:69: runtime error: division by zero\r\nSUMMARY: UndefinedBehaviorSanitizer: undefined-behavior bloom.cpp:45:69 in \r\nAddressSanitizer:DEADLYSIGNAL\r\n=================================================================\r\n==40871==ERROR: AddressSanitizer: FPE on unknown address 0x55931bfc0b75 (pc 0x55931bfc0b75 bp 0x7ffc03d58840 sp 0x7ffc03d58810 T0)\r\n    #0 0x55931bfc0b74  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x2526b74)\r\n    #1 0x55931bfbb90b  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x252190b)\r\n    #2 0x55931b823465  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1d89465)\r\n    #3 0x55931b8528f1  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1db88f1)\r\n    #4 0x55931b855d15  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1dbbd15)\r\n    #5 0x55931b687ea4  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1bedea4)\r\n    #6 0x55931b684453  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1bea453)\r\n    #7 0x55931c85a94f  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x2dc094f)\r\n    #8 0x55931b562ce7  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1ac8ce7)\r\n    #9 0x55931b56d554  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1ad3554)\r\n    #10 0x55931b56ebbf  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1ad4bbf)\r\n    #11 0x55931b55df7c  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1ac3f7c)\r\n    #12 0x55931b5427d2  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1aa87d2)\r\n    #13 0x7f81d6280b96  (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)\r\n    #14 0x55931b550e99  (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x1ab6e99)\r\n\r\nAddressSanitizer can not provide additional info.\r\nSUMMARY: AddressSanitizer: FPE (/home/neha/src/bitcoin/src/test/fuzz/process_messages+0x2526b74) \r\n==40871==ABORTING\r\nMS: 2 ChangeByte-CrossOver-; base unit: 369297d2ec45713fa6113836603e63a500a2403c\r\nartifact_prefix='./'; Test unit written to ./crash-b8f6aae14715726dbd88ef4a5b383e1b50c0fa46\r\n```\r\n\r\n",
      "created_at" : "2020-04-22T16:18:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#issuecomment-617880540",
      "id" : 617880540,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18521",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNzg4MDU0MA==",
      "updated_at" : "2020-04-22T16:18:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617880540",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/177646?v=4",
         "events_url" : "https://api.github.com/users/narula/events{/privacy}",
         "followers_url" : "https://api.github.com/users/narula/followers",
         "following_url" : "https://api.github.com/users/narula/following{/other_user}",
         "gists_url" : "https://api.github.com/users/narula/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/narula",
         "id" : 177646,
         "login" : "narula",
         "node_id" : "MDQ6VXNlcjE3NzY0Ng==",
         "organizations_url" : "https://api.github.com/users/narula/orgs",
         "received_events_url" : "https://api.github.com/users/narula/received_events",
         "repos_url" : "https://api.github.com/users/narula/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/narula/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/narula/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/narula"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r809441108"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/809441108"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm pretty sure this is UB. You can't cast to a subclass of the actually created object, even if it adds no fields or member functions.",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2022-02-17T20:27:21Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r809441108",
      "id" : 809441108,
      "line" : 36,
      "node_id" : "PRRC_kwDOABII584wPxdU",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 36,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 36,
      "pull_request_review_id" : 886514324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/809441108/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-17T20:27:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/809441108",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r809724450"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/809724450"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good find, further discussion in https://github.com/bitcoin/bitcoin/issues/24373\r\n\r\n(Obviously I was testing the review process to see how long it would take to find out)",
      "commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "created_at" : "2022-02-18T07:06:00Z",
      "diff_hunk" : "@@ -0,0 +1,75 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <consensus/consensus.h>\n+#include <net.h>\n+#include <net_processing.h>\n+#include <protocol.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/mining.h>\n+#include <test/util/net.h>\n+#include <test/util/setup_common.h>\n+#include <util/memory.h>\n+#include <validation.h>\n+#include <validationinterface.h>\n+\n+const RegTestingSetup* g_setup;\n+\n+void initialize()\n+{\n+    static RegTestingSetup setup{};\n+    g_setup = &setup;\n+\n+    for (int i = 0; i < 2 * COINBASE_MATURITY; i++) {\n+        MineBlock(g_setup->m_node, CScript() << OP_TRUE);\n+    }\n+    SyncWithValidationInterfaceQueue();\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18521#discussion_r809724450",
      "id" : 809724450,
      "in_reply_to_id" : 809441108,
      "line" : 36,
      "node_id" : "PRRC_kwDOABII584wQ2oi",
      "original_commit_id" : "fa6a00843447d53a5708ea3a629b9150cfe58be2",
      "original_line" : 36,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/test/fuzz/process_messages.cpp",
      "position" : 36,
      "pull_request_review_id" : 886895273,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18521",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/809724450/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-18T07:06:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/809724450",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
