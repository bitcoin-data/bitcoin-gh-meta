[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r403131807"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/403131807"
         }
      },
      "author_association" : "MEMBER",
      "body" : "please explain why the slack(is it the DER encoded sig length difference in witness?)",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-03T16:34:01Z",
      "diff_hunk" : "@@ -253,12 +253,13 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n+    # expected size of transaction (p2wpkh, 1 input, 2 outputs): 140-141 vbytes",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r403131807",
      "id" : 403131807,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzEzMTgwNw==",
      "original_commit_id" : "e7a1154d7c42eddc954f1a2ec28ae1e2f78aadb3",
      "original_line" : 256,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 387410355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:08:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/403131807",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r403132052"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/403132052"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`assert 140 <= fulltx[\"vsize\"] <= 141` I think is the style used",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-03T16:34:24Z",
      "diff_hunk" : "@@ -253,12 +253,13 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n+    # expected size of transaction (p2wpkh, 1 input, 2 outputs): 140-141 vbytes\n+    assert(140 <= fulltx[\"vsize\"] <= 141)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r403132052",
      "id" : 403132052,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzEzMjA1Mg==",
      "original_commit_id" : "e7a1154d7c42eddc954f1a2ec28ae1e2f78aadb3",
      "original_line" : 257,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 387410632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:08:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/403132052",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404003232"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404003232"
         }
      },
      "author_association" : "MEMBER",
      "body" : "good idea -- done",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T10:57:57Z",
      "diff_hunk" : "@@ -253,12 +253,13 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n+    # expected size of transaction (p2wpkh, 1 input, 2 outputs): 140-141 vbytes",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404003232",
      "id" : 404003232,
      "in_reply_to_id" : 403131807,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDAwMzIzMg==",
      "original_commit_id" : "e7a1154d7c42eddc954f1a2ec28ae1e2f78aadb3",
      "original_line" : 256,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 388140318,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:08:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404003232",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404003360"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404003360"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T10:58:10Z",
      "diff_hunk" : "@@ -253,12 +253,13 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n+    # expected size of transaction (p2wpkh, 1 input, 2 outputs): 140-141 vbytes\n+    assert(140 <= fulltx[\"vsize\"] <= 141)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404003360",
      "id" : 404003360,
      "in_reply_to_id" : 403132052,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDAwMzM2MA==",
      "original_commit_id" : "e7a1154d7c42eddc954f1a2ec28ae1e2f78aadb3",
      "original_line" : 257,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 388140454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:08:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404003360",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for reviewing, @instagibbs. Updated with your feedback.",
      "created_at" : "2020-04-06T11:04:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#issuecomment-609726954",
      "id" : 609726954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18516",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwOTcyNjk1NA==",
      "updated_at" : "2020-04-06T11:04:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/609726954",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404113173"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404113173"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Pedantically, the signature size can be smaller than 70 bytes, but with very small probability :)",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T13:59:49Z",
      "diff_hunk" : "@@ -253,12 +253,16 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means signatures can have\n+    # a variable size of 70-72 bytes, with most being 71 or 72 bytes. The signature in the witness",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404113173",
      "id" : 404113173,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDExMzE3Mw==",
      "original_commit_id" : "b631556d654c53281098aa62b2318181b0f592be",
      "original_line" : 257,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 388277535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:08:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404113173",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404132633"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404132633"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: this variance can take ~it~ _the weight_ across a 4-byte boundary.\r\n\r\nThe witness discount is applied to all bytes that don't appear in the non-segwit serialization:\r\n\r\n- 1 byte (marker 0x00)\r\n- 1 byte (flag 0x01)\r\n- 1 byte (number of stack items 0x02)\r\n- 71/72 bytes (sig length + signature 0x46..../0x47....)\r\n- 34 bytes (pubkey length _ pubkey 0x21....)\r\n\r\nTOTAL: 108/109 bytes weight => 27/28 vbytes vsize\r\n\r\nref: https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki#transaction-id",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T14:24:47Z",
      "diff_hunk" : "@@ -253,12 +253,16 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means signatures can have\n+    # a variable size of 70-72 bytes, with most being 71 or 72 bytes. The signature in the witness\n+    # is divided by 4 for the vsize, so this variance can take it across a vbyte boundary. Thus",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404132633",
      "id" : 404132633,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDEzMjYzMw==",
      "original_commit_id" : "b631556d654c53281098aa62b2318181b0f592be",
      "original_line" : 258,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 388277535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:08:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404132633",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404133323"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404133323"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If this fails, we don't get any useful output (the assert return value is False). If you wanted to be really verbose, you could do something like:\r\n\r\n```\r\nif fulltx['vsize'] not in [140, 141]:\r\n    print(\"Invalid tx size: {}, full tx: {}\".format(fulltx['vsize'], fulltx))\r\n    raise AssertionError\r\n```\r\n\r\nThat's perhaps overkill, but more verbose logging makes debugging intermittent failures much easier.",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T14:25:35Z",
      "diff_hunk" : "@@ -253,12 +253,16 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means signatures can have\n+    # a variable size of 70-72 bytes, with most being 71 or 72 bytes. The signature in the witness\n+    # is divided by 4 for the vsize, so this variance can take it across a vbyte boundary. Thus\n+    # the expected transaction size (p2wpkh, 1 input, 2 outputs) is 140-141 vbytes -- usually 141.\n+    assert 140 <= fulltx[\"vsize\"] <= 141",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404133323",
      "id" : 404133323,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDEzMzMyMw==",
      "original_commit_id" : "b631556d654c53281098aa62b2318181b0f592be",
      "original_line" : 260,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 388277535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:08:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404133323",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404167627"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404167627"
         }
      },
      "author_association" : "MEMBER",
      "body" : "changed to \"70-72 bytes (or possibly even less),\"",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T15:09:24Z",
      "diff_hunk" : "@@ -253,12 +253,16 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means signatures can have\n+    # a variable size of 70-72 bytes, with most being 71 or 72 bytes. The signature in the witness",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404167627",
      "id" : 404167627,
      "in_reply_to_id" : 404113173,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE2NzYyNw==",
      "original_commit_id" : "b631556d654c53281098aa62b2318181b0f592be",
      "original_line" : 257,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 388346419,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:09:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404167627",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404167987"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404167987"
         }
      },
      "author_association" : "MEMBER",
      "body" : "good point, updated!",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T15:09:54Z",
      "diff_hunk" : "@@ -253,12 +253,16 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means signatures can have\n+    # a variable size of 70-72 bytes, with most being 71 or 72 bytes. The signature in the witness\n+    # is divided by 4 for the vsize, so this variance can take it across a vbyte boundary. Thus",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404167987",
      "id" : 404167987,
      "in_reply_to_id" : 404132633,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE2Nzk4Nw==",
      "original_commit_id" : "b631556d654c53281098aa62b2318181b0f592be",
      "original_line" : 258,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 388346911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:09:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404167987",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404169872"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404169872"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point; thanks for the suggestion. Updated (with the x <= y <= z operator as it apparently runs faster?)",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T15:12:32Z",
      "diff_hunk" : "@@ -253,12 +253,16 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means signatures can have\n+    # a variable size of 70-72 bytes, with most being 71 or 72 bytes. The signature in the witness\n+    # is divided by 4 for the vsize, so this variance can take it across a vbyte boundary. Thus\n+    # the expected transaction size (p2wpkh, 1 input, 2 outputs) is 140-141 vbytes -- usually 141.\n+    assert 140 <= fulltx[\"vsize\"] <= 141",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404169872",
      "id" : 404169872,
      "in_reply_to_id" : 404133323,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE2OTg3Mg==",
      "original_commit_id" : "b631556d654c53281098aa62b2318181b0f592be",
      "original_line" : 260,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : null,
      "pull_request_review_id" : 388349420,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:12:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404169872",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for reviewing, @jnewbery! Great points; updated.",
      "created_at" : "2020-04-06T15:13:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#issuecomment-609855981",
      "id" : 609855981,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18516",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwOTg1NTk4MQ==",
      "updated_at" : "2020-04-06T15:13:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/609855981",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T15:33:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#issuecomment-609867503",
      "id" : 609867503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18516",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwOTg2NzUwMw==",
      "updated_at" : "2020-04-06T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/609867503",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404191587"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404191587"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        raise AssertionError(\"Error: Invalid tx vsize of {} (140-141 expected), full tx: {}\".format(fulltx[\"vsize\"], fulltx))\r\n```\r\n\r\nGenerally we put the fail reason in the assertion instead of printing it to stdout, but I'll got ahead and merge this now, to get some more green in the ci.",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T15:40:50Z",
      "diff_hunk" : "@@ -253,12 +253,18 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means that signatures can have a\n+    # variable size of 70-72 bytes (or possibly even less), with most being 71 or 72 bytes. The signature\n+    # in the witness is divided by 4 for the vsize, so this variance can take the weight across a 4-byte\n+    # boundary. Thus expected transaction size (p2wpkh, 1 input, 2 outputs) is 140-141 vbytes, usually 141.\n+    if not 140 <= fulltx[\"vsize\"] <= 141:\n+        print(\"Error: Invalid tx vsize of {} (140-141 expected), full tx: {}\".format(fulltx[\"vsize\"], fulltx))\n+        raise AssertionError",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404191587",
      "id" : 404191587,
      "line" : 262,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE5MTU4Nw==",
      "original_commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "original_line" : 262,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 16,
      "pull_request_review_id" : 388376348,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:40:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404191587",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404203219"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404203219"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Generally we put the fail reason in the assertion instead of printing it to stdout, but I'll got ahead and merge this now, to get some more green in the ci.\r\n\r\nThanks -- noting that for the future.",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T15:56:32Z",
      "diff_hunk" : "@@ -253,12 +253,18 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means that signatures can have a\n+    # variable size of 70-72 bytes (or possibly even less), with most being 71 or 72 bytes. The signature\n+    # in the witness is divided by 4 for the vsize, so this variance can take the weight across a 4-byte\n+    # boundary. Thus expected transaction size (p2wpkh, 1 input, 2 outputs) is 140-141 vbytes, usually 141.\n+    if not 140 <= fulltx[\"vsize\"] <= 141:\n+        print(\"Error: Invalid tx vsize of {} (140-141 expected), full tx: {}\".format(fulltx[\"vsize\"], fulltx))\n+        raise AssertionError",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404203219",
      "id" : 404203219,
      "in_reply_to_id" : 404191587,
      "line" : 262,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIwMzIxOQ==",
      "original_commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "original_line" : 262,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 16,
      "pull_request_review_id" : 388390848,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T15:56:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404203219",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404206161"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404206161"
         }
      },
      "author_association" : "MEMBER",
      "body" : "oops, sorry - yes this should have been a log (or as Marco says, in the assertion)",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T16:00:18Z",
      "diff_hunk" : "@@ -253,12 +253,18 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means that signatures can have a\n+    # variable size of 70-72 bytes (or possibly even less), with most being 71 or 72 bytes. The signature\n+    # in the witness is divided by 4 for the vsize, so this variance can take the weight across a 4-byte\n+    # boundary. Thus expected transaction size (p2wpkh, 1 input, 2 outputs) is 140-141 vbytes, usually 141.\n+    if not 140 <= fulltx[\"vsize\"] <= 141:\n+        print(\"Error: Invalid tx vsize of {} (140-141 expected), full tx: {}\".format(fulltx[\"vsize\"], fulltx))\n+        raise AssertionError",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404206161",
      "id" : 404206161,
      "in_reply_to_id" : 404191587,
      "line" : 262,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIwNjE2MQ==",
      "original_commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "original_line" : 262,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 16,
      "pull_request_review_id" : 388394476,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T16:00:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404206161",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404219731"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404219731"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe a small fixup pr would be appropriate?",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T16:19:32Z",
      "diff_hunk" : "@@ -253,12 +253,18 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means that signatures can have a\n+    # variable size of 70-72 bytes (or possibly even less), with most being 71 or 72 bytes. The signature\n+    # in the witness is divided by 4 for the vsize, so this variance can take the weight across a 4-byte\n+    # boundary. Thus expected transaction size (p2wpkh, 1 input, 2 outputs) is 140-141 vbytes, usually 141.\n+    if not 140 <= fulltx[\"vsize\"] <= 141:\n+        print(\"Error: Invalid tx vsize of {} (140-141 expected), full tx: {}\".format(fulltx[\"vsize\"], fulltx))\n+        raise AssertionError",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404219731",
      "id" : 404219731,
      "in_reply_to_id" : 404191587,
      "line" : 262,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIxOTczMQ==",
      "original_commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "original_line" : 262,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 16,
      "pull_request_review_id" : 388410970,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T16:19:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404219731",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404234385"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404234385"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok -- done in #18540",
      "commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "created_at" : "2020-04-06T16:41:16Z",
      "diff_hunk" : "@@ -253,12 +253,18 @@ def test_dust_to_fee(self, rbf_node, dest_address):\n     self.log.info('Test that bumped output that is dust is dropped to fee')\n     rbfid = spend_one_input(rbf_node, dest_address)\n     fulltx = rbf_node.getrawtransaction(rbfid, 1)\n-    # size of transaction (p2wpkh, 1 input, 2 outputs): 141 vbytes\n-    assert_equal(fulltx[\"vsize\"], 141)\n-    # bump with fee_rate of 0.00350000 BTC per 1000 vbytes\n-    # expected bump fee of 141 vbytes * fee_rate 0.00350000 BTC / 1000 vbytes = 0.00049350 BTC\n-    # but dust is dropped, so actual bump fee is 0.00050000\n-    bumped_tx = rbf_node.bumpfee(rbfid, {\"fee_rate\": 0.0035})\n+    # The DER formatting used by Bitcoin to serialize ECDSA signatures means that signatures can have a\n+    # variable size of 70-72 bytes (or possibly even less), with most being 71 or 72 bytes. The signature\n+    # in the witness is divided by 4 for the vsize, so this variance can take the weight across a 4-byte\n+    # boundary. Thus expected transaction size (p2wpkh, 1 input, 2 outputs) is 140-141 vbytes, usually 141.\n+    if not 140 <= fulltx[\"vsize\"] <= 141:\n+        print(\"Error: Invalid tx vsize of {} (140-141 expected), full tx: {}\".format(fulltx[\"vsize\"], fulltx))\n+        raise AssertionError",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18516#discussion_r404234385",
      "id" : 404234385,
      "in_reply_to_id" : 404191587,
      "line" : 262,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNDM4NQ==",
      "original_commit_id" : "25e03ba1ff18ca06954786e512000648941b4dfb",
      "original_line" : 262,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "test/functional/wallet_bumpfee.py",
      "position" : 16,
      "pull_request_review_id" : 388428961,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18516",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T16:41:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404234385",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
