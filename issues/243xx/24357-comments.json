[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24185](https://github.com/bitcoin/bitcoin/pull/24185) (refactor: only use explicit reinterpret/const casts, not implicit by PastaPastaPasta)\n* [#22052](https://github.com/bitcoin/bitcoin/pull/22052) (net: remove non-blocking bool from interface by Bushstar)\n* [#21878](https://github.com/bitcoin/bitcoin/pull/21878) (Make all networking code mockable by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-02-17T08:10:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#issuecomment-1042676966",
      "id" : 1042676966,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24357",
      "node_id" : "IC_kwDOABII584-Jfzm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1042676966/reactions"
      },
      "updated_at" : "2022-04-08T17:25:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1042676966",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2022-03-09T16:56:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#issuecomment-1063144289",
      "id" : 1063144289,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24357",
      "node_id" : "IC_kwDOABII584_Xkth",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1063144289/reactions"
      },
      "updated_at" : "2022-03-09T16:56:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1063144289",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827476824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827476824"
         }
      },
      "author_association" : "MEMBER",
      "body" : "03c630e\r\n```suggestion\r\n     * `setsockopt(/*sockfd=*/this->Get(), level, opt_name, opt_val, opt_len)`. Code that uses this\r\n```\r\n(same for `getsockopt` just above)",
      "commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "created_at" : "2022-03-15T22:47:51Z",
      "diff_hunk" : "@@ -115,6 +115,22 @@ class Sock\n                                          void* opt_val,\n                                          socklen_t* opt_len) const;\n \n+    /**\n+     * setsockopt(2) wrapper. Equivalent to\n+     * `setsockopt(this->Get(), level, opt_name, opt_val, opt_len)`. Code that uses this",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827476824",
      "id" : 827476824,
      "line" : 120,
      "node_id" : "PRRC_kwDOABII584xUktY",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 120,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/util/sock.h",
      "position" : 6,
      "pull_request_review_id" : 910912260,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827476824/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-15T23:27:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827476824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827477981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827477981"
         }
      },
      "author_association" : "MEMBER",
      "body" : "03c630e Placing all the `SetSockOpt()` declaration parameters on the same line, like in the definition, would be more consistent and easier to compare with the definition. ",
      "commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "created_at" : "2022-03-15T22:50:13Z",
      "diff_hunk" : "@@ -115,6 +115,22 @@ class Sock\n                                          void* opt_val,\n                                          socklen_t* opt_len) const;\n \n+    /**\n+     * setsockopt(2) wrapper. Equivalent to\n+     * `setsockopt(this->Get(), level, opt_name, opt_val, opt_len)`. Code that uses this\n+     * wrapper can be unit tested if this method is overridden by a mock Sock implementation.\n+     */\n+    [[nodiscard]] virtual int SetSockOpt(int level,\n+                                         int opt_name,\n+                                         const void* opt_val,\n+                                         socklen_t opt_len) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827477981",
      "id" : 827477981,
      "line" : 126,
      "node_id" : "PRRC_kwDOABII584xUk_d",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 126,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/util/sock.h",
      "position" : 12,
      "pull_request_review_id" : 910912260,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827477981/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-15T23:27:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827477981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827489776"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827489776"
         }
      },
      "author_association" : "MEMBER",
      "body" : "7c914fe2 These 3 error messages would be easier to read and review if they were on one line like the two pre-existing ones in the same `BindListenPort()` function. Also, the first added one is formatted differently from the next two added ones in this commit. Each being on one line would be simpler to write and to read.",
      "commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "created_at" : "2022-03-15T23:13:20Z",
      "diff_hunk" : "@@ -2382,17 +2385,32 @@ bool CConnman::BindListenPort(const CService& addrBind, bilingual_str& strError,\n \n     // Allow binding if the port is still in TIME_WAIT state after\n     // the program was closed and restarted.\n-    setsockopt(sock->Get(), SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int));\n+    if (sock->SetSockOpt(SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+        strError =\n+            strprintf(Untranslated(\"Error setting SO_REUSEADDR on socket: %s, continuing anyway\"),\n+                      NetworkErrorString(WSAGetLastError()));\n+        LogPrintf(\"%s\\n\", strError.original);\n+    }\n \n     // some systems don't have IPV6_V6ONLY but are always v6only; others do have the option\n     // and enable it by default or not. Try to enable it, if possible.\n     if (addrBind.IsIPv6()) {\n #ifdef IPV6_V6ONLY\n-        setsockopt(sock->Get(), IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int));\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(\n+                Untranslated(\"Error setting IPV6_V6ONLY on socket: %s, continuing anyway\"),\n+                NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n #endif\n #ifdef WIN32\n         int nProtLevel = PROTECTION_LEVEL_UNRESTRICTED;\n-        setsockopt(sock->Get(), IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int));\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(\n+                Untranslated(\"Error setting IPV6_PROTECTION_LEVEL on socket: %s, continuing anyway\"),\n+                NetworkErrorString(WSAGetLastError()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827489776",
      "id" : 827489776,
      "line" : 2411,
      "node_id" : "PRRC_kwDOABII584xUn3w",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 2411,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 42,
      "pull_request_review_id" : 910912260,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827489776/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-15T23:27:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827489776",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`aaf8d7ed1f...3ee641f452`: style changes\r\n\r\nInvalidates ACK from @jonatack \r\n",
      "created_at" : "2022-03-16T11:40:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#issuecomment-1069034180",
      "id" : 1069034180,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24357",
      "node_id" : "IC_kwDOABII584_uCrE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069034180/reactions"
      },
      "updated_at" : "2022-03-16T11:40:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069034180",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827914151"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827914151"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ignoring, on my system the parameter is named `s`: `int setsockopt(int s, ...`",
      "commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "created_at" : "2022-03-16T11:41:44Z",
      "diff_hunk" : "@@ -115,6 +115,22 @@ class Sock\n                                          void* opt_val,\n                                          socklen_t* opt_len) const;\n \n+    /**\n+     * setsockopt(2) wrapper. Equivalent to\n+     * `setsockopt(this->Get(), level, opt_name, opt_val, opt_len)`. Code that uses this",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827914151",
      "id" : 827914151,
      "in_reply_to_id" : 827476824,
      "line" : 120,
      "node_id" : "PRRC_kwDOABII584xWPen",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 120,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/util/sock.h",
      "position" : 6,
      "pull_request_review_id" : 911493546,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827914151/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T11:41:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827914151",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827915765"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827915765"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ignoring, the line would then become too long, and `GetSockOpt()` is already like that, so leaving it for consistency with surrounding code. Actually clang-format formats it like this, given a line length limit:\r\n\r\n```cpp\r\n    [[nodiscard]] virtual int            \r\n    SetSockOpt(int level, int opt_name, const void* opt_val, socklen_t opt_len) const;\r\n```",
      "commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "created_at" : "2022-03-16T11:43:52Z",
      "diff_hunk" : "@@ -115,6 +115,22 @@ class Sock\n                                          void* opt_val,\n                                          socklen_t* opt_len) const;\n \n+    /**\n+     * setsockopt(2) wrapper. Equivalent to\n+     * `setsockopt(this->Get(), level, opt_name, opt_val, opt_len)`. Code that uses this\n+     * wrapper can be unit tested if this method is overridden by a mock Sock implementation.\n+     */\n+    [[nodiscard]] virtual int SetSockOpt(int level,\n+                                         int opt_name,\n+                                         const void* opt_val,\n+                                         socklen_t opt_len) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827915765",
      "id" : 827915765,
      "in_reply_to_id" : 827477981,
      "line" : 126,
      "node_id" : "PRRC_kwDOABII584xWP31",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 126,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/util/sock.h",
      "position" : 12,
      "pull_request_review_id" : 911495859,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827915765/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T11:43:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827915765",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827916916"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827916916"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Changed to be all in one line, for consistency with the pre-existent ones (even though I do not like too long lines).",
      "commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "created_at" : "2022-03-16T11:45:20Z",
      "diff_hunk" : "@@ -2382,17 +2385,32 @@ bool CConnman::BindListenPort(const CService& addrBind, bilingual_str& strError,\n \n     // Allow binding if the port is still in TIME_WAIT state after\n     // the program was closed and restarted.\n-    setsockopt(sock->Get(), SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int));\n+    if (sock->SetSockOpt(SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+        strError =\n+            strprintf(Untranslated(\"Error setting SO_REUSEADDR on socket: %s, continuing anyway\"),\n+                      NetworkErrorString(WSAGetLastError()));\n+        LogPrintf(\"%s\\n\", strError.original);\n+    }\n \n     // some systems don't have IPV6_V6ONLY but are always v6only; others do have the option\n     // and enable it by default or not. Try to enable it, if possible.\n     if (addrBind.IsIPv6()) {\n #ifdef IPV6_V6ONLY\n-        setsockopt(sock->Get(), IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int));\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(\n+                Untranslated(\"Error setting IPV6_V6ONLY on socket: %s, continuing anyway\"),\n+                NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n #endif\n #ifdef WIN32\n         int nProtLevel = PROTECTION_LEVEL_UNRESTRICTED;\n-        setsockopt(sock->Get(), IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int));\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(\n+                Untranslated(\"Error setting IPV6_PROTECTION_LEVEL on socket: %s, continuing anyway\"),\n+                NetworkErrorString(WSAGetLastError()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r827916916",
      "id" : 827916916,
      "in_reply_to_id" : 827489776,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xWQJ0",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 2411,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 911497577,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827916916/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T11:46:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/827916916",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r828548876"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828548876"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, makes sense",
      "commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "created_at" : "2022-03-17T00:08:18Z",
      "diff_hunk" : "@@ -115,6 +115,22 @@ class Sock\n                                          void* opt_val,\n                                          socklen_t* opt_len) const;\n \n+    /**\n+     * setsockopt(2) wrapper. Equivalent to\n+     * `setsockopt(this->Get(), level, opt_name, opt_val, opt_len)`. Code that uses this",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r828548876",
      "id" : 828548876,
      "in_reply_to_id" : 827476824,
      "line" : 120,
      "node_id" : "PRRC_kwDOABII584xYqcM",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 120,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/util/sock.h",
      "position" : 6,
      "pull_request_review_id" : 912408825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828548876/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-17T00:08:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828548876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r828550928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828550928"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> given a line length limit:\r\n\r\nThere isn't a limit, for this project the line isn't particularly long, and it would be annoying for all the functions with several params to be formatted this way. That said, thanks for responding.",
      "commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "created_at" : "2022-03-17T00:14:02Z",
      "diff_hunk" : "@@ -115,6 +115,22 @@ class Sock\n                                          void* opt_val,\n                                          socklen_t* opt_len) const;\n \n+    /**\n+     * setsockopt(2) wrapper. Equivalent to\n+     * `setsockopt(this->Get(), level, opt_name, opt_val, opt_len)`. Code that uses this\n+     * wrapper can be unit tested if this method is overridden by a mock Sock implementation.\n+     */\n+    [[nodiscard]] virtual int SetSockOpt(int level,\n+                                         int opt_name,\n+                                         const void* opt_val,\n+                                         socklen_t opt_len) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r828550928",
      "id" : 828550928,
      "in_reply_to_id" : 827477981,
      "line" : 126,
      "node_id" : "PRRC_kwDOABII584xYq8Q",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 126,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/util/sock.h",
      "position" : 12,
      "pull_request_review_id" : 912416000,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828550928/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-17T00:14:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828550928",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r828550973"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828550973"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks.",
      "commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "created_at" : "2022-03-17T00:14:09Z",
      "diff_hunk" : "@@ -2382,17 +2385,32 @@ bool CConnman::BindListenPort(const CService& addrBind, bilingual_str& strError,\n \n     // Allow binding if the port is still in TIME_WAIT state after\n     // the program was closed and restarted.\n-    setsockopt(sock->Get(), SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int));\n+    if (sock->SetSockOpt(SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+        strError =\n+            strprintf(Untranslated(\"Error setting SO_REUSEADDR on socket: %s, continuing anyway\"),\n+                      NetworkErrorString(WSAGetLastError()));\n+        LogPrintf(\"%s\\n\", strError.original);\n+    }\n \n     // some systems don't have IPV6_V6ONLY but are always v6only; others do have the option\n     // and enable it by default or not. Try to enable it, if possible.\n     if (addrBind.IsIPv6()) {\n #ifdef IPV6_V6ONLY\n-        setsockopt(sock->Get(), IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int));\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(\n+                Untranslated(\"Error setting IPV6_V6ONLY on socket: %s, continuing anyway\"),\n+                NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n #endif\n #ifdef WIN32\n         int nProtLevel = PROTECTION_LEVEL_UNRESTRICTED;\n-        setsockopt(sock->Get(), IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int));\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(\n+                Untranslated(\"Error setting IPV6_PROTECTION_LEVEL on socket: %s, continuing anyway\"),\n+                NetworkErrorString(WSAGetLastError()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r828550973",
      "id" : 828550973,
      "in_reply_to_id" : 827489776,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xYq89",
      "original_commit_id" : "aaf8d7ed1fbcd2f1a90e4f02d50ca7d2864587d0",
      "original_line" : 2411,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 912416213,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828550973/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-17T00:14:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828550973",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 3ee641f452dc98644246252613e7590ca5ad88f",
      "created_at" : "2022-03-17T00:16:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#issuecomment-1069767356",
      "id" : 1069767356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24357",
      "node_id" : "IC_kwDOABII584_w1q8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069767356/reactions"
      },
      "updated_at" : "2022-03-17T00:16:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069767356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r850135707"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850135707"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's a little bit ugly imo to have both a general `SetSockOpt` and a specific `SetNoDelay` on the same interface. I think we should decide either way:\r\n- Add a general `SetSockOpt` . Move the `SetSockOpt(IPPROTO_TCP, TCP_NODELAY, &on, sizeof(on))` into the caller, or,\r\n- Add specific calls for SetNoDelay, ReuseAddr, V6only, etc etc.",
      "commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "created_at" : "2022-04-14T06:52:01Z",
      "diff_hunk" : "@@ -105,6 +105,17 @@ int Sock::GetSockOpt(int level, int opt_name, void* opt_val, socklen_t* opt_len)\n     return getsockopt(m_socket, level, opt_name, static_cast<char*>(opt_val), opt_len);\n }\n \n+int Sock::SetSockOpt(int level, int opt_name, const void* opt_val, socklen_t opt_len) const\n+{\n+    return setsockopt(m_socket, level, opt_name, static_cast<const char*>(opt_val), opt_len);\n+}\n+\n+bool Sock::SetNoDelay() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r850135707",
      "id" : 850135707,
      "line" : 113,
      "node_id" : "PRRC_kwDOABII584yrAqb",
      "original_commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "original_line" : 113,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/util/sock.cpp",
      "position" : 9,
      "pull_request_review_id" : 941856575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850135707/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-14T06:52:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850135707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-04-14T08:40:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#issuecomment-1098860579",
      "id" : 1098860579,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24357",
      "node_id" : "IC_kwDOABII585Bf0gj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098860579/reactions"
      },
      "updated_at" : "2022-04-14T08:40:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098860579",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r851123709"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851123709"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good point! There is already a general `SetSockOpt()`, so I used it and ditched the `SetNoDelay()` method.",
      "commit_id" : "a2c4a7acd1dfb2fb7e3c9dac6b3d8c9354b2e0a6",
      "created_at" : "2022-04-15T07:47:22Z",
      "diff_hunk" : "@@ -105,6 +105,17 @@ int Sock::GetSockOpt(int level, int opt_name, void* opt_val, socklen_t* opt_len)\n     return getsockopt(m_socket, level, opt_name, static_cast<char*>(opt_val), opt_len);\n }\n \n+int Sock::SetSockOpt(int level, int opt_name, const void* opt_val, socklen_t opt_len) const\n+{\n+    return setsockopt(m_socket, level, opt_name, static_cast<const char*>(opt_val), opt_len);\n+}\n+\n+bool Sock::SetNoDelay() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#discussion_r851123709",
      "id" : 851123709,
      "in_reply_to_id" : 850135707,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584yux39",
      "original_commit_id" : "3ee641f452dc98644246252613e7590ca5ad88f4",
      "original_line" : 113,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/util/sock.cpp",
      "position" : null,
      "pull_request_review_id" : 943229293,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24357",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851123709/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-15T07:47:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851123709",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`3ee641f452...a2c4a7acd1`: rebase due to conflicts and address [suggestion](https://github.com/bitcoin/bitcoin/pull/24357#discussion_r850135707).\r\n\r\nInvalidates ACK from @jonatack",
      "created_at" : "2022-04-15T07:49:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#issuecomment-1099937785",
      "id" : 1099937785,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24357",
      "node_id" : "IC_kwDOABII585Bj7f5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099937785/reactions"
      },
      "updated_at" : "2022-04-15T07:49:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099937785",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK a2c4a7acd1dfb2fb7e3c9dac6b3d8c9354b2e0a6",
      "created_at" : "2022-04-15T08:17:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24357#issuecomment-1099954803",
      "id" : 1099954803,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24357",
      "node_id" : "IC_kwDOABII585Bj_pz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099954803/reactions"
      },
      "updated_at" : "2022-04-15T08:17:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099954803",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
