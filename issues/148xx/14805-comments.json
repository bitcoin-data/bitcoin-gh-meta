[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14805#discussion_r236225247"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14805"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/236225247"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, we could return the added nodes.",
      "commit_id" : "98a1846b00d9c3076d6dcd96244fae6f923e26a0",
      "created_at" : "2018-11-26T11:56:32Z",
      "diff_hunk" : "@@ -292,7 +292,8 @@ def add_nodes(self, num_nodes, extra_args=None, *, rpchost=None, binary=None):\n         assert_equal(len(extra_args), num_nodes)\n         assert_equal(len(binary), num_nodes)\n         for i in range(num_nodes):\n-            self.nodes.append(TestNode(i, get_datadir_path(self.options.tmpdir, i), rpchost=rpchost, timewait=self.rpc_timewait, bitcoind=binary[i], bitcoin_cli=self.options.bitcoincli, mocktime=self.mocktime, coverage_dir=self.options.coveragedir, extra_conf=extra_confs[i], extra_args=extra_args[i], use_cli=self.options.usecli))\n+            numnode = len(self.nodes)\n+            self.nodes.append(TestNode(numnode, get_datadir_path(self.options.tmpdir, numnode), rpchost=rpchost, timewait=self.rpc_timewait, bitcoind=binary[i], bitcoin_cli=self.options.bitcoincli, mocktime=self.mocktime, coverage_dir=self.options.coveragedir, extra_conf=extra_confs[i], extra_args=extra_args[i], use_cli=self.options.usecli))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14805#discussion_r236225247",
      "id" : 236225247,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNjIyNTI0Nw==",
      "original_commit_id" : "98a1846b00d9c3076d6dcd96244fae6f923e26a0",
      "original_position" : 6,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 6,
      "pull_request_review_id" : 178252548,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14805",
      "updated_at" : "2018-11-26T11:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/236225247",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14519](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14519.html) (tests: add utility to easily profile node performance with perf by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-11-26T12:33:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14805#issuecomment-441623236",
      "id" : 441623236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14805",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MTYyMzIzNg==",
      "updated_at" : "2018-11-26T12:33:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/441623236",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14805#discussion_r236452190"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14805"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/236452190"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "if you're not going to use `i`, this is better:\r\n\r\n`for _ in range(num_nodes):`",
      "commit_id" : "98a1846b00d9c3076d6dcd96244fae6f923e26a0",
      "created_at" : "2018-11-26T22:26:33Z",
      "diff_hunk" : "@@ -292,7 +292,8 @@ def add_nodes(self, num_nodes, extra_args=None, *, rpchost=None, binary=None):\n         assert_equal(len(extra_args), num_nodes)\n         assert_equal(len(binary), num_nodes)\n         for i in range(num_nodes):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14805#discussion_r236452190",
      "id" : 236452190,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNjQ1MjE5MA==",
      "original_commit_id" : "98a1846b00d9c3076d6dcd96244fae6f923e26a0",
      "original_position" : 3,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 3,
      "pull_request_review_id" : 178531315,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14805",
      "updated_at" : "2018-11-26T22:26:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/236452190",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/524761?v=4",
         "events_url" : "https://api.github.com/users/jimmysong/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimmysong/followers",
         "following_url" : "https://api.github.com/users/jimmysong/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimmysong/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimmysong",
         "id" : 524761,
         "login" : "jimmysong",
         "node_id" : "MDQ6VXNlcjUyNDc2MQ==",
         "organizations_url" : "https://api.github.com/users/jimmysong/orgs",
         "received_events_url" : "https://api.github.com/users/jimmysong/received_events",
         "repos_url" : "https://api.github.com/users/jimmysong/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimmysong/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimmysong/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimmysong"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14805#discussion_r236456889"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14805"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/236456889"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's used.",
      "commit_id" : "98a1846b00d9c3076d6dcd96244fae6f923e26a0",
      "created_at" : "2018-11-26T22:43:11Z",
      "diff_hunk" : "@@ -292,7 +292,8 @@ def add_nodes(self, num_nodes, extra_args=None, *, rpchost=None, binary=None):\n         assert_equal(len(extra_args), num_nodes)\n         assert_equal(len(binary), num_nodes)\n         for i in range(num_nodes):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14805#discussion_r236456889",
      "id" : 236456889,
      "in_reply_to_id" : 236452190,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNjQ1Njg4OQ==",
      "original_commit_id" : "98a1846b00d9c3076d6dcd96244fae6f923e26a0",
      "original_position" : 3,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 3,
      "pull_request_review_id" : 178536863,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14805",
      "updated_at" : "2018-11-26T22:43:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/236456889",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "LGTM, though we don't *need* it at the moment, this is a sufficiently small and useful change I don't see any reason to consider not merging it.\r\nutACK 98a1846b00d9c3076d6dcd96244fae6f923e26a0\r\n",
      "created_at" : "2018-12-13T14:00:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14805#issuecomment-446978111",
      "id" : 446978111,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14805",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0Njk3ODExMQ==",
      "updated_at" : "2018-12-13T14:00:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/446978111",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "(sorry for the post-merge review. I only just saw this)\r\n\r\nThis isn't really safe and I suggest we revert it. `add_nodes` was designed to only be called once at the top of the test. The idea is that the number of required nodes is declared up front, and each node can then be stopped/started during the test.\r\n\r\nWe *could* relax that restriction if necessary, but I don't think it is necessary. Issues with this implementation:\r\n\r\n- `_initialize_chain()` and `_initialize_chain_clean()` both use the `num_nodes` property to create each node's directory with chainstate and wallet at the start of the test. If an extra node is added later with `add_nodes()` then it won't have this preconfigured directory, which will probably be unexpected and difficult to debug.\r\n- if `add_nodes()` is called later in the test with the `num_nodes` argument set to >1, each of the additional new nodes will have the same index (see `self.nodes.append(TestNode(numnode,...`)\r\n\r\n@stevenroose. I don't think you need this for your test in https://github.com/ElementsProject/elements/pull/458. You can declare the `num_nodes` for your test, override the `setup_nodes()` method to only start the ones you need at the beginning of the test, then update `node.args` for the nodes you want to update the arguments for before starting them.\r\n\r\nApologies - I should have commented the `add_nodes()` method more thoroughly when I added it.",
      "created_at" : "2018-12-13T16:00:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14805#issuecomment-447021398",
      "id" : 447021398,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14805",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0NzAyMTM5OA==",
      "updated_at" : "2018-12-13T16:00:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/447021398",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, without documentation, the name `add_nodes` suggests that you can \"add\" nodes with it, implying it should be able to be called more than once.\r\n\r\n> if add_nodes() is called later in the test with the num_nodes argument set to >1, each of the additional new nodes will have the same index (see self.nodes.append(TestNode(numnode,...)\r\n\r\nThat is not true, that is exactly the issue that I solved.\r\n\r\nSo yeah, regarding your first point, I setup the `num_nodes` variable upfront and then add the nodes one by one, because they are all (4) different.",
      "created_at" : "2018-12-14T10:22:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14805#issuecomment-447281699",
      "id" : 447281699,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14805",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0NzI4MTY5OQ==",
      "updated_at" : "2018-12-14T10:22:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/447281699",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/853468?v=4",
         "events_url" : "https://api.github.com/users/stevenroose/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stevenroose/followers",
         "following_url" : "https://api.github.com/users/stevenroose/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stevenroose/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stevenroose",
         "id" : 853468,
         "login" : "stevenroose",
         "node_id" : "MDQ6VXNlcjg1MzQ2OA==",
         "organizations_url" : "https://api.github.com/users/stevenroose/orgs",
         "received_events_url" : "https://api.github.com/users/stevenroose/received_events",
         "repos_url" : "https://api.github.com/users/stevenroose/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stevenroose/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stevenroose/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stevenroose"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> That is not true, that is exactly the issue that I solved.\r\n\r\nApologies, yes - you're right.\r\n\r\nI believe the first point is still a problem.",
      "created_at" : "2018-12-14T15:38:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14805#issuecomment-447361647",
      "id" : 447361647,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14805",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0NzM2MTY0Nw==",
      "updated_at" : "2018-12-14T15:38:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/447361647",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
