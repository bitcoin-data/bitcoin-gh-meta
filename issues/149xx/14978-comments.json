[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242032923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242032923"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, I thought I was very clever converting this from a std::vector&lt;unsigned char&gt; to a std::string, but the reality appears to be that Clang is happy with this line and g++ hates it, so I'm going to have to massage this back towards the original version a bit, in order to get it to build anywhere but macOS.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2018-12-17T06:00:56Z",
      "diff_hunk" : "@@ -176,10 +177,20 @@ bool DecodeHexBlk(CBlock& block, const std::string& strHexBlk)\n     return true;\n }\n \n-bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n+bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n {\n-    std::vector<unsigned char> tx_data = DecodeBase64(base64_tx.c_str());\n-    CDataStream ss_data(tx_data, SER_NETWORK, PROTOCOL_VERSION);\n+    bool invalid;\n+    std::string tx_data = DecodeBase64(base64_tx, &invalid);\n+    if (invalid) {\n+        error = \"invalid base64\";\n+        return false;\n+    }\n+    return DecodeRawPSBT(psbt, tx_data, error);\n+}\n+\n+bool DecodeRawPSBT(PartiallySignedTransaction& psbt, const std::string& tx_data, std::string& error)\n+{\n+    CDataStream ss_data(tx_data.begin(), tx_data.end(), SER_NETWORK, PROTOCOL_VERSION);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242032923",
      "id" : 242032923,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MjAzMjkyMw==",
      "original_commit_id" : "3c91a3ddf583806b211f576a25994d2182d824df",
      "original_position" : 28,
      "path" : "src/core_read.cpp",
      "position" : null,
      "pull_request_review_id" : 185447650,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242032923",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I cleverly made a small change that apparently g++ does not accept but Clang does, so I will have to fix that before it will build on Linux, oops. (I commented on the offending line in the diff.)",
      "created_at" : "2018-12-17T06:02:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-447731683",
      "id" : 447731683,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0NzczMTY4Mw==",
      "updated_at" : "2018-12-17T06:02:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/447731683",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Hmm, something is also legitimately broken in the tests, will investigate tomorrow. :-\\",
      "created_at" : "2018-12-17T07:39:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-447749926",
      "id" : 447749926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0Nzc0OTkyNg==",
      "updated_at" : "2018-12-17T07:39:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/447749926",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15253](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15253.html) (Net: Consistently log outgoing INV messages by Empact)\n* [#15214](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15214.html) (tests: Check for expected return values when calling functions returning a success code by practicalswift)\n* [#13932](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13932.html) (Additional utility RPCs for PSBT by achow101)\n* [#13541](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13541.html) (wallet/rpc: sendrawtransaction maxfeerate by kallewoof)\n* [#13266](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13266.html) ([moveonly] privatize SignatureExtractorChecker by Empact)\n* [#12461](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/12461.html) (scripted-diff: Rename key size consts to be relative to their class by Empact)\n* [#9152](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/9152.html) (Wallet/RPC: sweepprivkeys method to scan UTXO set and send to local wallet by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-12-17T08:24:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-447759931",
      "id" : 447759931,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0Nzc1OTkzMQ==",
      "updated_at" : "2019-02-13T18:26:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/447759931",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242119943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242119943"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Space before `(`. Applies throughout this PR.\r\n\r\nPlease run all new files through `clang-format` :-)",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2018-12-17T11:57:12Z",
      "diff_hunk" : "@@ -0,0 +1,562 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {\n+    // expose superclass constructors\n+    using std::runtime_error::runtime_error;\n+};\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242119943",
      "id" : 242119943,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MjExOTk0Mw==",
      "original_commit_id" : "2fe27d6e4d78ccf2744be4bd52eb31a1e66f89f5",
      "original_position" : 135,
      "path" : "src/psbt.h",
      "position" : 128,
      "pull_request_review_id" : 185555227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242119943",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242120063"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242120063"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: Drop blank line.",
      "commit_id" : "2fe27d6e4d78ccf2744be4bd52eb31a1e66f89f5",
      "created_at" : "2018-12-17T11:57:40Z",
      "diff_hunk" : "@@ -0,0 +1,562 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {\n+    // expose superclass constructors\n+    using std::runtime_error::runtime_error;\n+};\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_IN_NON_WITNESS_UTXO:\n+                {\n+                    if (non_witness_utxo) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input non-witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Non-witness utxo key is more than one byte type\");\n+                    }\n+                    // Set the stream to unserialize with witness since this is always a valid network transaction\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() & ~SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, non_witness_utxo);\n+                    break;\n+                }\n+                case PSBT_IN_WITNESS_UTXO:\n+                    if (!witness_utxo.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Witness utxo key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, witness_utxo);\n+                    break;\n+                case PSBT_IN_PARTIAL_SIG:\n+                {\n+                    // Make sure that the key is the size of pubkey + 1\n+                    if (key.size() != CPubKey::PUBLIC_KEY_SIZE + 1 && key.size() != CPubKey::COMPRESSED_PUBLIC_KEY_SIZE + 1) {\n+                        throw std::ios_base::failure(\"Size of key was not the expected size for the type partial signature pubkey\");\n+                    }\n+                    // Read in the pubkey from key\n+                    CPubKey pubkey(key.begin() + 1, key.end());\n+                    if (!pubkey.IsFullyValid()) {\n+                       throw std::ios_base::failure(\"Invalid pubkey\");\n+                    }\n+                    if (partial_sigs.count(pubkey.GetID()) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input partial signature for pubkey already provided\");\n+                    }\n+\n+                    // Read in the signature from value\n+                    std::vector<unsigned char> sig;\n+                    s >> sig;\n+\n+                    // Add to list\n+                    partial_sigs.emplace(pubkey.GetID(), SigPair(pubkey, std::move(sig)));\n+                    break;\n+                }\n+                case PSBT_IN_SIGHASH:\n+                    if (sighash_type > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input sighash type already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Sighash type key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, sighash_type);\n+                    break;\n+                case PSBT_IN_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_IN_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_IN_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTSIG:\n+                {\n+                    if (!final_script_sig.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptSig already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptSig key is more than one byte type\");\n+                    }\n+                    s >> final_script_sig;\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTWITNESS:\n+                {\n+                    if (!final_script_witness.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptWitness already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptWitness key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, final_script_witness.stack);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default:\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an input map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTInput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A structure for PSBTs which contains per output information */\n+struct PSBTOutput\n+{\n+    CScript redeem_script;\n+    CScript witness_script;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTOutput& output);\n+    bool IsSane() const;\n+    PSBTOutput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the redeem script\n+        if (!redeem_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_REDEEMSCRIPT);\n+            s << redeem_script;\n+        }\n+\n+        // Write the witness script\n+        if (!witness_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_WITNESSSCRIPT);\n+            s << witness_script;\n+        }\n+\n+        // Write any hd keypaths\n+        SerializeHDKeypaths(s, hd_keypaths, PSBT_OUT_BIP32_DERIVATION);\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_OUT_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_OUT_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_OUT_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an output map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTOutput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A version of CTransaction with the PSBT format*/\n+struct PartiallySignedTransaction\n+{\n+    boost::optional<CMutableTransaction> tx;\n+    std::vector<PSBTInput> inputs;\n+    std::vector<PSBTOutput> outputs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);\n+    bool IsSane() const;\n+    PartiallySignedTransaction() {}\n+    PartiallySignedTransaction(const PartiallySignedTransaction& psbt_in) : tx(psbt_in.tx), inputs(psbt_in.inputs), outputs(psbt_in.outputs), unknown(psbt_in.unknown) {}\n+    explicit PartiallySignedTransaction(const CTransaction& tx);\n+\n+    // Checks if they refer to the same underlying CTransaction\n+    bool SameTx(const PartiallySignedTransaction& psbt) {\n+        return tx->GetHash() == psbt.tx->GetHash();\n+    }\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242120063",
      "id" : 242120063,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MjEyMDA2Mw==",
      "original_commit_id" : "2fe27d6e4d78ccf2744be4bd52eb31a1e66f89f5",
      "original_position" : 407,
      "path" : "src/psbt.h",
      "position" : 407,
      "pull_request_review_id" : 185555375,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2018-12-17T11:57:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242120063",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\n> for use in GUI code\r\n\r\nCan you detail the GUI part?\r\n\r\n> which is already under development and working-ish.\r\n\r\nIs it available?",
      "created_at" : "2018-12-17T14:36:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-447867073",
      "id" : 447867073,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0Nzg2NzA3Mw==",
      "updated_at" : "2018-12-17T14:36:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/447867073",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242232019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242232019"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is moved code, none of this code is new -- I expect I should not actually clang-format it, to preserve move-detection?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2018-12-17T17:01:27Z",
      "diff_hunk" : "@@ -0,0 +1,562 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {\n+    // expose superclass constructors\n+    using std::runtime_error::runtime_error;\n+};\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242232019",
      "id" : 242232019,
      "in_reply_to_id" : 242119943,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MjIzMjAxOQ==",
      "original_commit_id" : "2fe27d6e4d78ccf2744be4bd52eb31a1e66f89f5",
      "original_position" : 135,
      "path" : "src/psbt.h",
      "position" : 128,
      "pull_request_review_id" : 185695567,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242232019",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242234962"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242234962"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2018-12-17T17:09:02Z",
      "diff_hunk" : "@@ -0,0 +1,562 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {\n+    // expose superclass constructors\n+    using std::runtime_error::runtime_error;\n+};\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242234962",
      "id" : 242234962,
      "in_reply_to_id" : 242119943,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MjIzNDk2Mg==",
      "original_commit_id" : "2fe27d6e4d78ccf2744be4bd52eb31a1e66f89f5",
      "original_position" : 135,
      "path" : "src/psbt.h",
      "position" : 128,
      "pull_request_review_id" : 185699100,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242234962",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242236541"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242236541"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Makes sense!",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2018-12-17T17:13:01Z",
      "diff_hunk" : "@@ -0,0 +1,562 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {\n+    // expose superclass constructors\n+    using std::runtime_error::runtime_error;\n+};\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r242236541",
      "id" : 242236541,
      "in_reply_to_id" : 242119943,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MjIzNjU0MQ==",
      "original_commit_id" : "2fe27d6e4d78ccf2744be4bd52eb31a1e66f89f5",
      "original_position" : 135,
      "path" : "src/psbt.h",
      "position" : 128,
      "pull_request_review_id" : 185701028,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/242236541",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Can you detail the GUI part?\r\n\r\nI'm adding an interface for offline and multisig signing in the GUI, using PSBT as the on-disk format for the intermediate files. See e.g. how Bitcoin Armory handles offline transactions, which I'm basically copying.\r\n\r\n> Is it available?\r\n\r\nI pasted it into #bitcoin-core-dev awhile ago -- I will link it here in the comment thread once I'm sure the tip of my branch is still actually building. ",
      "created_at" : "2018-12-17T22:51:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-448029296",
      "id" : 448029296,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0ODAyOTI5Ng==",
      "updated_at" : "2018-12-17T22:51:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/448029296",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@gwillen writes:\n> * Move most PSBT definitions into psbt.h.\n> * Move most PSBT RPC utilities into psbt.{h,cpp}.\n> * Move wallet-touching PSBT RPC utilities (FillPSBT) into\n>     wallet/psbtwallet.{h,cpp}.\n> * Switch exceptions from JSONRPCError() to new PSBTException class.\n> * Split DecodePSBT into DecodeBase64PSBT (old behavior) and DecodeRawPSBT.\n> * Add one new version of DecodeBase64 utility in strencodings.h (and\n>     corresponding DecodeBase32 for completeness).\n> * Factor BroadcastTransaction utility function out of sendrawtransaction RPC\n>     handler in rpc/rawtransaction.cpp\n\nIs it possible to split this commit into one for each of the points\nhere? It makes review harder when everything is squashed into a single commit.\n",
      "created_at" : "2018-12-18T03:02:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-448079641",
      "id" : 448079641,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0ODA3OTY0MQ==",
      "updated_at" : "2018-12-18T03:02:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/448079641",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The GUI work is WIP here: https://github.com/gwillen/bitcoin/tree/feature-offline-v1 . I made that branch at a known-working version, since I'm making significant changes to it right now.\r\n\r\nIt's not currently based on this PR, which I will have to rebase it onto later; this PR is an extraction of some refactoring that also appears in that PR, plus some other stuff that doesn't yet.",
      "created_at" : "2018-12-18T04:15:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-448090750",
      "id" : 448090750,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0ODA5MDc1MA==",
      "updated_at" : "2018-12-18T04:15:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/448090750",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jb55 Yeah, I can definitely split it out if people prefer. Will take a day or two to get to. I might ask slight forgiveness in some cases where a reasonable intermediate state between two combined changes never existed, and would be hard to recreate.",
      "created_at" : "2018-12-18T04:16:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-448090866",
      "id" : 448090866,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0ODA5MDg2Ng==",
      "updated_at" : "2018-12-18T04:17:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/448090866",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Would be helpful to split the commit up, for review now and for intelligibility when looking back in the future.",
      "created_at" : "2018-12-18T07:49:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-448127504",
      "id" : 448127504,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0ODEyNzUwNA==",
      "updated_at" : "2018-12-18T07:49:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/448127504",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Agree with above, split this into multiple commits.",
      "created_at" : "2018-12-19T04:49:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-448468508",
      "id" : 448468508,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0ODQ2ODUwOA==",
      "updated_at" : "2018-12-19T04:49:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/448468508",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I definitely agree in splitting it.\r\n\r\n@gwillen checked out the branch and looks promising.\r\n\r\n",
      "created_at" : "2018-12-19T14:09:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-448608549",
      "id" : 448608549,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0ODYwODU0OQ==",
      "updated_at" : "2018-12-19T14:09:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/448608549",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Sorry for the delay. I have split the PR into more reasonable commits. The one that does the bulk of the code movement between files (\"Move PSBT definitions and code to separate files\") is now _only_ movement (and adjusting headers / Makefile), and no other substantive changes. \r\n\r\nThe final result is exactly the same as before, except for a single stray blank line I had accidentally introduced in the previous version, which is removed.\r\n\r\nEvery intermediate step is intended to be sane and self-contained (and buildable), but I haven't actually verified (by compiler rather than by eye) that every intermediate step cleanly builds yet.\r\n\r\n(EDIT: Wellll, I was pretty close. All intermediate states now build and pass tests.)",
      "created_at" : "2019-01-09T11:13:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-452660611",
      "id" : 452660611,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1MjY2MDYxMQ==",
      "updated_at" : "2019-01-09T11:58:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/452660611",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This looks much better now! Thanks! \r\n\r\nutACK dd45d3febacb40cf68f58eff08f76db2854fc340\r\n\r\nThe refactorings look pretty good in general.\r\n\r\nI did a quick skim of the code, I didn't see anything obviously wrong but I'm no expert on this part of the codebase.",
      "created_at" : "2019-01-09T16:48:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-452766732",
      "id" : 452766732,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1Mjc2NjczMg==",
      "updated_at" : "2019-01-09T16:48:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/452766732",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r246489067"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/246489067"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: variable name should be snake_case. See doc/developer-notes.md for naming convention.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-09T18:22:01Z",
      "diff_hunk" : "@@ -188,9 +188,9 @@ std::vector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n     return ret;\n }\n \n-std::string DecodeBase64(const std::string& str)\n+std::string DecodeBase64(const std::string& str, bool* pfInvalid)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r246489067",
      "id" : 246489067,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NjQ4OTA2Nw==",
      "original_commit_id" : "65cb85e625e11850d21ff133420259a6993d7992",
      "original_position" : 5,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 190864363,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/246489067",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r246499022"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/246499022"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This results in RPC errors with a code `RPC_MISC_ERROR`. I think it would be better if you could somehow make the error code more specific (the message still comes through).",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-09T18:54:03Z",
      "diff_hunk" : "@@ -36,6 +36,14 @@ static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n // as a 0 length key which indicates that this is the separator. The separator has no value.\n static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n \n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r246499022",
      "id" : 246499022,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NjQ5OTAyMg==",
      "original_commit_id" : "0edb99e6819fcf36d03558a6ed25a56aa46c936c",
      "original_position" : 7,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 190864363,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/246499022",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r246574699"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/246574699"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This was copied from surrounding context (it just wraps the c_str version of the same function, which has the same parameter named the same thing, and I'm propagating it outwards to the wrapper.)",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-09T22:43:14Z",
      "diff_hunk" : "@@ -188,9 +188,9 @@ std::vector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n     return ret;\n }\n \n-std::string DecodeBase64(const std::string& str)\n+std::string DecodeBase64(const std::string& str, bool* pfInvalid)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r246574699",
      "id" : 246574699,
      "in_reply_to_id" : 246489067,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NjU3NDY5OQ==",
      "original_commit_id" : "65cb85e625e11850d21ff133420259a6993d7992",
      "original_position" : 5,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 190975008,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/246574699",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r246575002"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/246575002"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, I'd love any thoughts on how to accomplish this without gunking up non-RPC code too much when it calls this codepath. I don't really want this to depend on the RPC stuff.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-09T22:44:21Z",
      "diff_hunk" : "@@ -36,6 +36,14 @@ static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n // as a 0 length key which indicates that this is the separator. The separator has no value.\n static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n \n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r246575002",
      "id" : 246575002,
      "in_reply_to_id" : 246499022,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NjU3NTAwMg==",
      "original_commit_id" : "0edb99e6819fcf36d03558a6ed25a56aa46c936c",
      "original_position" : 7,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 190975384,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/246575002",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "FWIW I believe the travis failure is spurious -- it failed a single unrelated test, on a single platform, and the code hasn't changed since the last time it succeeded.",
      "created_at" : "2019-01-09T22:45:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-452898011",
      "id" : 452898011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1Mjg5ODAxMQ==",
      "updated_at" : "2019-01-09T22:45:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/452898011",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "(Minor edit to remove a single unnecessary #include line that was bugging me, no significant change.)",
      "created_at" : "2019-01-16T00:32:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-454605365",
      "id" : 454605365,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NDYwNTM2NQ==",
      "updated_at" : "2019-01-16T00:32:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/454605365",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248217728"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248217728"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 801333b\r\n\r\nCould add test for this new error?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:01:47Z",
      "diff_hunk" : "@@ -176,10 +176,20 @@ bool DecodeHexBlk(CBlock& block, const std::string& strHexBlk)\n     return true;\n }\n \n-bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n+bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n {\n-    std::vector<unsigned char> tx_data = DecodeBase64(base64_tx.c_str());\n-    CDataStream ss_data(tx_data, SER_NETWORK, PROTOCOL_VERSION);\n+    bool invalid;\n+    std::string tx_data = DecodeBase64(base64_tx, &invalid);\n+    if (invalid) {\n+        error = \"invalid base64\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248217728",
      "id" : 248217728,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIxNzcyOA==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 12,
      "path" : "src/core_read.cpp",
      "position" : 20,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248217728",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248218346"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248218346"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 801333b\r\n\r\nTo avoid changing this line you could add a commit before with something along:\r\n```diff\r\n--- a/src/streams.h\r\n+++ b/src/streams.h\r\n@@ -236,17 +236,8 @@ public:\r\n         Init(nTypeIn, nVersionIn);\r\n     }\r\n\r\n-    CDataStream(const vector_type& vchIn, int nTypeIn, int nVersionIn) : vch(vchIn.begin(), vchIn.end())\r\n-    {\r\n-        Init(nTypeIn, nVersionIn);\r\n-    }\r\n-\r\n-    CDataStream(const std::vector<char>& vchIn, int nTypeIn, int nVersionIn) : vch(vchIn.begin(), vchIn.end())\r\n-    {\r\n-        Init(nTypeIn, nVersionIn);\r\n-    }\r\n-\r\n-    CDataStream(const std::vector<unsigned char>& vchIn, int nTypeIn, int nVersionIn) : vch(vchIn.begin(), vchIn.end())\r\n+    template <typename T>\r\n+    CDataStream(const T& vchIn, int nTypeIn, int nVersionIn) : vch(vchIn.begin(), vchIn.end())\r\n     {\r\n         Init(nTypeIn, nVersionIn);\r\n     }\r\n```",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:03:37Z",
      "diff_hunk" : "@@ -176,10 +176,20 @@ bool DecodeHexBlk(CBlock& block, const std::string& strHexBlk)\n     return true;\n }\n \n-bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n+bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n {\n-    std::vector<unsigned char> tx_data = DecodeBase64(base64_tx.c_str());\n-    CDataStream ss_data(tx_data, SER_NETWORK, PROTOCOL_VERSION);\n+    bool invalid;\n+    std::string tx_data = DecodeBase64(base64_tx, &invalid);\n+    if (invalid) {\n+        error = \"invalid base64\";\n+        return false;\n+    }\n+    return DecodeRawPSBT(psbt, tx_data, error);\n+}\n+\n+bool DecodeRawPSBT(PartiallySignedTransaction& psbt, const std::string& tx_data, std::string& error)\n+{\n+    CDataStream ss_data(tx_data.data(), tx_data.data() + tx_data.size(), SER_NETWORK, PROTOCOL_VERSION);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248218346",
      "id" : 248218346,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIxODM0Ng==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 20,
      "path" : "src/core_read.cpp",
      "position" : 28,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248218346",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248220308"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248220308"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 801333b\r\n\r\nnit, would be nice see brief comments.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:09:33Z",
      "diff_hunk" : "@@ -37,7 +37,8 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248220308",
      "id" : 248220308,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIyMDMwOA==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 5,
      "path" : "src/core_io.h",
      "position" : null,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248220308",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248220479"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248220479"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 801333b\r\n\r\nnit, s/tx_data/raw_tx?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:10:05Z",
      "diff_hunk" : "@@ -37,7 +37,8 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeRawPSBT(PartiallySignedTransaction& psbt, const std::string& tx_data, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248220479",
      "id" : 248220479,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIyMDQ3OQ==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 6,
      "path" : "src/core_io.h",
      "position" : null,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248220479",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248222592"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248222592"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 745c540\r\n\r\nShouldn't this be elsewhere if the goal is to use in the GUI?\r\n\r\nI think this should return `uint256`.\r\n\r\nnit, could document that the transaction id is returned.\r\n\r\nnit, s/allowhighfees/allow_high_fees.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:16:35Z",
      "diff_hunk" : "@@ -13,6 +13,9 @@ namespace interfaces {\n class Chain;\n } // namespace interfaces\n \n+/** Broadcast a transaction */\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees = false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248222592",
      "id" : 248222592,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIyMjU5Mg==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 5,
      "path" : "src/rpc/rawtransaction.h",
      "position" : null,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248222592",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248223984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248223984"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 745c540\r\n\r\nnit, despite being valid I think it's more readable in the form:\r\n```cpp\r\nbool allowhighfees = false;\r\nif (!request.params[1].isNull()) allowhighfees = request.params[1].get_bool();\r\n```\r\nBecause it is more clear the default value.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:20:11Z",
      "diff_hunk" : "@@ -1030,19 +1030,24 @@ static UniValue sendrawtransaction(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"sendrawtransaction\", \"\\\"signedhex\\\"\")\n         );\n \n-    std::promise<void> promise;\n-\n     RPCTypeCheck(request.params, {UniValue::VSTR, UniValue::VBOOL});\n \n     // parse hex string from parameter\n     CMutableTransaction mtx;\n     if (!DecodeHexTx(mtx, request.params[0].get_str()))\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"TX decode failed\");\n     CTransactionRef tx(MakeTransactionRef(std::move(mtx)));\n+\n+    bool allowhighfees = !request.params[1].isNull() && request.params[1].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248223984",
      "id" : 248223984,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIyMzk4NA==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 14,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248223984",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248233535"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248233535"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thread https://github.com/bitcoin/bitcoin/pull/14978/commits/617247cbc1622667a493772214fc8416066b3908#r246575002\r\n\r\nOne simple way this could be achieved is to add custom error handler to `CRPCCommand` which would translate this exception to the desired output.\r\n\r\nOne non intrusive way to add the error handler is to set it in\r\nhttps://github.com/bitcoin/bitcoin/blob/391a27376b30492f55b398fc220ee96cf3769a32/src/wallet/rpcwallet.cpp#L4194-L4197\r\n\r\nThis way all desired commands would share the same error handling and then we can start removing duplicate error messages in the code by introducing more specific exceptions.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:48:18Z",
      "diff_hunk" : "@@ -36,6 +36,14 @@ static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n // as a 0 length key which indicates that this is the separator. The separator has no value.\n static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n \n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248233535",
      "id" : 248233535,
      "in_reply_to_id" : 246499022,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIzMzUzNQ==",
      "original_commit_id" : "0edb99e6819fcf36d03558a6ed25a56aa46c936c",
      "original_position" : 7,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248233535",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248234110"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248234110"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 08ef528\r\n\r\nIf this is only used once and you now it's called from `Merge` then I suggest to inline it there.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:50:12Z",
      "diff_hunk" : "@@ -391,20 +391,15 @@ struct PartiallySignedTransaction\n     std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n \n     bool IsNull() const;\n-    void Merge(const PartiallySignedTransaction& psbt);\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);\n     bool IsSane() const;\n     PartiallySignedTransaction() {}\n     PartiallySignedTransaction(const PartiallySignedTransaction& psbt_in) : tx(psbt_in.tx), inputs(psbt_in.inputs), outputs(psbt_in.outputs), unknown(psbt_in.unknown) {}\n     explicit PartiallySignedTransaction(const CTransaction& tx);\n \n-    // Only checks if they refer to the same transaction\n-    friend bool operator==(const PartiallySignedTransaction& a, const PartiallySignedTransaction &b)\n-    {\n-        return a.tx->GetHash() == b.tx->GetHash();\n-    }\n-    friend bool operator!=(const PartiallySignedTransaction& a, const PartiallySignedTransaction &b)\n-    {\n-        return !(a == b);\n+    // Checks if they refer to the same underlying CTransaction\n+    bool SameTx(const PartiallySignedTransaction& psbt) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248234110",
      "id" : 248234110,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIzNDExMA==",
      "original_commit_id" : "08ef528c044ecea74a4d1bff75389afbdd3b7a2f",
      "original_position" : 20,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248234110",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248236086"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248236086"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit 08ef528\r\n\r\nAdd comment explaining the return value.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T10:56:18Z",
      "diff_hunk" : "@@ -391,20 +391,15 @@ struct PartiallySignedTransaction\n     std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n \n     bool IsNull() const;\n-    void Merge(const PartiallySignedTransaction& psbt);\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248236086",
      "id" : 248236086,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIzNjA4Ng==",
      "original_commit_id" : "08ef528c044ecea74a4d1bff75389afbdd3b7a2f",
      "original_position" : 5,
      "path" : "src/psbt.h",
      "position" : 390,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248236086",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248238602"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248238602"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Commit c062d74\r\n\r\nMake the argument a const reference.\r\n\r\nnit, brace on new line.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-16T11:04:13Z",
      "diff_hunk" : "@@ -232,3 +232,44 @@ bool SignPSBTInput(const SigningProvider& provider, PartiallySignedTransaction&\n \n     return sig_complete;\n }\n+\n+void FinalizePSBT(PartiallySignedTransaction& psbtx, bool extract, std::string& result, bool& complete) {\n+    // Finalize input signatures -- in case we have partial signatures that add up to a complete\n+    //   signature, but have not combined them yet (e.g. because the combiner that created this\n+    //   PartiallySignedTransaction did not understand them), this will combine them into a final\n+    //   script.\n+    complete = true;\n+    for (unsigned int i = 0; i < psbtx.tx->vin.size(); ++i) {\n+        complete &= SignPSBTInput(DUMMY_SIGNING_PROVIDER, psbtx, i, SIGHASH_ALL);\n+    }\n+\n+    CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);\n+    if (complete && extract) {\n+        CMutableTransaction mtx(*psbtx.tx);\n+        for (unsigned int i = 0; i < mtx.vin.size(); ++i) {\n+            mtx.vin[i].scriptSig = psbtx.inputs[i].final_script_sig;\n+            mtx.vin[i].scriptWitness = psbtx.inputs[i].final_script_witness;\n+        }\n+        ssTx << mtx;\n+        result = HexStr(ssTx.str());\n+    } else {\n+        ssTx << psbtx;\n+        result = EncodeBase64(ssTx.str());\n+    }\n+}\n+\n+PartiallySignedTransaction CombinePSBTs(std::vector<PartiallySignedTransaction> psbtxs) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248238602",
      "id" : 248238602,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODIzODYwMg==",
      "original_commit_id" : "c062d74e1187e481960ca6868a46642b8bbfbd2e",
      "original_position" : 30,
      "path" : "src/psbt.cpp",
      "position" : null,
      "pull_request_review_id" : 193054911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248238602",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248499054"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248499054"
         }
      },
      "author_association" : "MEMBER",
      "body" : "From https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md:\r\n\r\n> When writing patches, favor the new style over attempting to mimic the surrounding style, except for move-only commits.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-17T00:11:44Z",
      "diff_hunk" : "@@ -188,9 +188,9 @@ std::vector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n     return ret;\n }\n \n-std::string DecodeBase64(const std::string& str)\n+std::string DecodeBase64(const std::string& str, bool* pfInvalid)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248499054",
      "id" : 248499054,
      "in_reply_to_id" : 246489067,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODQ5OTA1NA==",
      "original_commit_id" : "65cb85e625e11850d21ff133420259a6993d7992",
      "original_position" : 5,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 193412608,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248499054",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248499937"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248499937"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Returning uint256 seems more natural indeed.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-17T00:16:14Z",
      "diff_hunk" : "@@ -13,6 +13,9 @@ namespace interfaces {\n class Chain;\n } // namespace interfaces\n \n+/** Broadcast a transaction */\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees = false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248499937",
      "id" : 248499937,
      "in_reply_to_id" : 248222592,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODQ5OTkzNw==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 5,
      "path" : "src/rpc/rawtransaction.h",
      "position" : null,
      "pull_request_review_id" : 193412608,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248499937",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248500788"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248500788"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm slightly worried about the use of exceptions in code that use usable in more places than just RPC, as C++ can't guarantee that all possible exceptions are being dealt with at the right layer.\r\n\r\nWould an enum with PSBT-related error codes, plus a enum to string conversion function (like in script/script_error) make sense?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-17T00:21:12Z",
      "diff_hunk" : "@@ -36,6 +36,14 @@ static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n // as a 0 length key which indicates that this is the separator. The separator has no value.\n static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n \n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r248500788",
      "id" : 248500788,
      "in_reply_to_id" : 246499022,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0ODUwMDc4OA==",
      "original_commit_id" : "0edb99e6819fcf36d03558a6ed25a56aa46c936c",
      "original_position" : 7,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 193412608,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/248500788",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\nFunny enough, yesterday I ran into an issue where I needed to reuse `sendrawtransaction`.\r\n\r\n@sipa wrote:\r\n> I'm slightly worried about the use of exceptions in code that use usable in more places than just RPC, as C++ can't guarantee that all possible exceptions are being dealt with at the right layer.\r\n\r\n> Would an enum with PSBT-related error codes, plus a enum to string conversion function (like in script/script_error) make sense?\r\n\r\nI'm also introducing an exception system for `ExternalSigner` in #14912:\r\n\r\n```cpp\r\nclass ExternalSignerException : public std::runtime_error {\r\n public:\r\n     using std::runtime_error::runtime_error;\r\n };\r\n\r\nthrow ExternalSignerException(strprintf(\"Some error with detail '%s'\", details));\r\n```\r\n\r\nI then map that to an RPC error like so:\r\n```cpp\r\n    try {\r\n        ExternalSigner::DoSomething(...);\r\n    } catch (const ExternalSignerException& e) {\r\n        throw JSONRPCError(RPC_WALLET_ERROR, e.what());\r\n    }\r\n```\r\n\r\n It's probably a good idea to agree on a single good way to do this.",
      "created_at" : "2019-01-18T17:35:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-455627335",
      "id" : 455627335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1NTYyNzMzNQ==",
      "updated_at" : "2019-01-18T17:39:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/455627335",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249129561"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249129561"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: we're only calling `DecodeBase64` in a handful of places, so you could also change the return type to `bool` and pass the output string as a reference param. Though it also makes sense to remain consistent with the existing (char*) methods.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-18T17:45:42Z",
      "diff_hunk" : "@@ -188,9 +188,9 @@ std::vector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n     return ret;\n }\n \n-std::string DecodeBase64(const std::string& str)\n+std::string DecodeBase64(const std::string& str, bool* pfInvalid)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249129561",
      "id" : 249129561,
      "in_reply_to_id" : 246489067,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTEyOTU2MQ==",
      "original_commit_id" : "65cb85e625e11850d21ff133420259a6993d7992",
      "original_position" : 5,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 194209720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249129561",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249132854"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249132854"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Both `tx_data` and `raw_tx` suggest a transaction hex. Something like `raw_psbt` is probably more clear, and consistent with the function name.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-18T17:56:36Z",
      "diff_hunk" : "@@ -37,7 +37,8 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeRawPSBT(PartiallySignedTransaction& psbt, const std::string& tx_data, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249132854",
      "id" : 249132854,
      "in_reply_to_id" : 248220479,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTEzMjg1NA==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 6,
      "path" : "src/core_io.h",
      "position" : null,
      "pull_request_review_id" : 194209720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249132854",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249133382"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249133382"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: `base64_psbt` (see next comment)",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-18T17:58:27Z",
      "diff_hunk" : "@@ -37,7 +37,8 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249133382",
      "id" : 249133382,
      "in_reply_to_id" : 248220308,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTEzMzM4Mg==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 5,
      "path" : "src/core_io.h",
      "position" : null,
      "pull_request_review_id" : 194209720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249133382",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249134420"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249134420"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Currently in 745c540d05f4a21810eccc5e9450e9b321560560, wrong commit?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-18T18:01:54Z",
      "diff_hunk" : "@@ -1030,19 +1030,24 @@ static UniValue sendrawtransaction(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"sendrawtransaction\", \"\\\"signedhex\\\"\")\n         );\n \n-    std::promise<void> promise;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249134420",
      "id" : 249134420,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTEzNDQyMA==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 4,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 31,
      "pull_request_review_id" : 194209720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249134420",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249134860"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249134860"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I also need access to this function in #14912 from other wallet RPC methods. Not really an issue, because I can always include `src/rpc/rawtransaction.h`. But perhaps create a new `src/wallet/transaction.cpp`?\r\n\r\nI might add `BroadcastTransaction(PartiallySignedTransaction psbt, bool allowhighfees = false)` in my own PR.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-18T18:03:38Z",
      "diff_hunk" : "@@ -13,6 +13,9 @@ namespace interfaces {\n class Chain;\n } // namespace interfaces\n \n+/** Broadcast a transaction */\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees = false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r249134860",
      "id" : 249134860,
      "in_reply_to_id" : 248222592,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0OTEzNDg2MA==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 5,
      "path" : "src/rpc/rawtransaction.h",
      "position" : null,
      "pull_request_review_id" : 194209720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/249134860",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r250597281"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250597281"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you add parameter info here? Try:\r\n\r\n```cpp\r\n/**\r\n * Finalizes a PSBT if possible, combining partial signatures and optionally\r\n * extracting to a signed transaction ready for sending.\r\n *\r\n * @param[in] &psbtx  reference to PartiallySignedTransaction\r\n * @param[in] extract whether to extract the transaction as a hex string\r\n * @param[in] &result PSBT as base64 or transaction as hex string\r\n * @param[in] &complete  \r\n */\r\n```\r\n\r\nAlso, in some other places in the code I see a convention of starting with output parameters and moving optional stuff to the end. So in that case maybe switch `complete` with `extract`.\r\n\r\nFinally I think `extract_tx` would be more clear. Would also rather leave result empty if extract is false. In that case `std::string& result` can be renamed to `tx_hex`.\r\n\r\nThough maybe that's too much refactoring for this PR.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-24T13:07:00Z",
      "diff_hunk" : "@@ -0,0 +1,562 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {\n+    // expose superclass constructors\n+    using std::runtime_error::runtime_error;\n+};\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_IN_NON_WITNESS_UTXO:\n+                {\n+                    if (non_witness_utxo) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input non-witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Non-witness utxo key is more than one byte type\");\n+                    }\n+                    // Set the stream to unserialize with witness since this is always a valid network transaction\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() & ~SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, non_witness_utxo);\n+                    break;\n+                }\n+                case PSBT_IN_WITNESS_UTXO:\n+                    if (!witness_utxo.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Witness utxo key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, witness_utxo);\n+                    break;\n+                case PSBT_IN_PARTIAL_SIG:\n+                {\n+                    // Make sure that the key is the size of pubkey + 1\n+                    if (key.size() != CPubKey::PUBLIC_KEY_SIZE + 1 && key.size() != CPubKey::COMPRESSED_PUBLIC_KEY_SIZE + 1) {\n+                        throw std::ios_base::failure(\"Size of key was not the expected size for the type partial signature pubkey\");\n+                    }\n+                    // Read in the pubkey from key\n+                    CPubKey pubkey(key.begin() + 1, key.end());\n+                    if (!pubkey.IsFullyValid()) {\n+                       throw std::ios_base::failure(\"Invalid pubkey\");\n+                    }\n+                    if (partial_sigs.count(pubkey.GetID()) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input partial signature for pubkey already provided\");\n+                    }\n+\n+                    // Read in the signature from value\n+                    std::vector<unsigned char> sig;\n+                    s >> sig;\n+\n+                    // Add to list\n+                    partial_sigs.emplace(pubkey.GetID(), SigPair(pubkey, std::move(sig)));\n+                    break;\n+                }\n+                case PSBT_IN_SIGHASH:\n+                    if (sighash_type > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input sighash type already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Sighash type key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, sighash_type);\n+                    break;\n+                case PSBT_IN_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_IN_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_IN_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTSIG:\n+                {\n+                    if (!final_script_sig.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptSig already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptSig key is more than one byte type\");\n+                    }\n+                    s >> final_script_sig;\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTWITNESS:\n+                {\n+                    if (!final_script_witness.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptWitness already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptWitness key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, final_script_witness.stack);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default:\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an input map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTInput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A structure for PSBTs which contains per output information */\n+struct PSBTOutput\n+{\n+    CScript redeem_script;\n+    CScript witness_script;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTOutput& output);\n+    bool IsSane() const;\n+    PSBTOutput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the redeem script\n+        if (!redeem_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_REDEEMSCRIPT);\n+            s << redeem_script;\n+        }\n+\n+        // Write the witness script\n+        if (!witness_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_WITNESSSCRIPT);\n+            s << witness_script;\n+        }\n+\n+        // Write any hd keypaths\n+        SerializeHDKeypaths(s, hd_keypaths, PSBT_OUT_BIP32_DERIVATION);\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_OUT_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_OUT_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_OUT_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an output map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTOutput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A version of CTransaction with the PSBT format*/\n+struct PartiallySignedTransaction\n+{\n+    boost::optional<CMutableTransaction> tx;\n+    std::vector<PSBTInput> inputs;\n+    std::vector<PSBTOutput> outputs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);\n+    bool IsSane() const;\n+    PartiallySignedTransaction() {}\n+    PartiallySignedTransaction(const PartiallySignedTransaction& psbt_in) : tx(psbt_in.tx), inputs(psbt_in.inputs), outputs(psbt_in.outputs), unknown(psbt_in.unknown) {}\n+    explicit PartiallySignedTransaction(const CTransaction& tx);\n+\n+    // Checks if they refer to the same underlying CTransaction\n+    bool SameTx(const PartiallySignedTransaction& psbt) {\n+        return tx->GetHash() == psbt.tx->GetHash();\n+    }\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+\n+        // magic bytes\n+        s << PSBT_MAGIC_BYTES;\n+\n+        // unsigned tx flag\n+        SerializeToVector(s, PSBT_GLOBAL_UNSIGNED_TX);\n+\n+        // Write serialized tx to a stream\n+        OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+        SerializeToVector(os, *tx);\n+\n+        // Write the unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        // Separator\n+        s << PSBT_SEPARATOR;\n+\n+        // Write inputs\n+        for (const PSBTInput& input : inputs) {\n+            s << input;\n+        }\n+        // Write outputs\n+        for (const PSBTOutput& output : outputs) {\n+            s << output;\n+        }\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read the magic bytes\n+        uint8_t magic[5];\n+        s >> magic;\n+        if (!std::equal(magic, magic + 5, PSBT_MAGIC_BYTES)) {\n+            throw std::ios_base::failure(\"Invalid PSBT magic bytes\");\n+        }\n+\n+        // Read global data\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_GLOBAL_UNSIGNED_TX:\n+                {\n+                    if (tx) {\n+                        throw std::ios_base::failure(\"Duplicate Key, unsigned tx already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Global unsigned tx key is more than one byte type\");\n+                    }\n+                    CMutableTransaction mtx;\n+                    // Set the stream to serialize with non-witness since this should always be non-witness\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, mtx);\n+                    tx = std::move(mtx);\n+                    // Make sure that all scriptSigs and scriptWitnesses are empty\n+                    for (const CTxIn& txin : tx->vin) {\n+                        if (!txin.scriptSig.empty() || !txin.scriptWitness.IsNull()) {\n+                            throw std::ios_base::failure(\"Unsigned tx does not have empty scriptSigs and scriptWitnesses.\");\n+                        }\n+                    }\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of the global map\");\n+        }\n+\n+        // Make sure that we got an unsigned tx\n+        if (!tx) {\n+            throw std::ios_base::failure(\"No unsigned transcation was provided\");\n+        }\n+\n+        // Read input data\n+        unsigned int i = 0;\n+        while (!s.empty() && i < tx->vin.size()) {\n+            PSBTInput input;\n+            s >> input;\n+            inputs.push_back(input);\n+\n+            // Make sure the non-witness utxo matches the outpoint\n+            if (input.non_witness_utxo && input.non_witness_utxo->GetHash() != tx->vin[i].prevout.hash) {\n+                throw std::ios_base::failure(\"Non-witness UTXO does not match outpoint hash\");\n+            }\n+            ++i;\n+        }\n+        // Make sure that the number of inputs matches the number of inputs in the transaction\n+        if (inputs.size() != tx->vin.size()) {\n+            throw std::ios_base::failure(\"Inputs provided does not match the number of inputs in transaction.\");\n+        }\n+\n+        // Read output data\n+        i = 0;\n+        while (!s.empty() && i < tx->vout.size()) {\n+            PSBTOutput output;\n+            s >> output;\n+            outputs.push_back(output);\n+            ++i;\n+        }\n+        // Make sure that the number of outputs matches the number of outputs in the transaction\n+        if (outputs.size() != tx->vout.size()) {\n+            throw std::ios_base::failure(\"Outputs provided does not match the number of outputs in transaction.\");\n+        }\n+        // Sanity check\n+        if (!IsSane()) {\n+            throw std::ios_base::failure(\"PSBT is not sane.\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PartiallySignedTransaction(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** Checks whether a PSBTInput is already signed. */\n+bool PSBTInputSigned(PSBTInput& input);\n+\n+/** Signs a PSBTInput, verifying that all provided data matches what is being signed. */\n+bool SignPSBTInput(const SigningProvider& provider, PartiallySignedTransaction& psbt, int index, int sighash = SIGHASH_ALL);\n+\n+/** Finalizes a PSBT if possible, combining partial signatures and optionally extracting to a signed transaction ready for sending. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r250597281",
      "id" : 250597281,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MDU5NzI4MQ==",
      "original_commit_id" : "c062d74e1187e481960ca6868a46642b8bbfbd2e",
      "original_position" : 556,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 196018112,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250597281",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r250610209"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250610209"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: const params",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-24T13:46:44Z",
      "diff_hunk" : "@@ -1030,19 +1030,24 @@ static UniValue sendrawtransaction(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"sendrawtransaction\", \"\\\"signedhex\\\"\")\n         );\n \n-    std::promise<void> promise;\n-\n     RPCTypeCheck(request.params, {UniValue::VSTR, UniValue::VBOOL});\n \n     // parse hex string from parameter\n     CMutableTransaction mtx;\n     if (!DecodeHexTx(mtx, request.params[0].get_str()))\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"TX decode failed\");\n     CTransactionRef tx(MakeTransactionRef(std::move(mtx)));\n+\n+    bool allowhighfees = !request.params[1].isNull() && request.params[1].get_bool();\n+    return BroadcastTransaction(tx, allowhighfees);\n+}\n+\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r250610209",
      "id" : 250610209,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MDYxMDIwOQ==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 18,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 196018112,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/250610209",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251696573"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251696573"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I will fix the argument name, but otherwise leave things alone unless you would strongly prefer the more invasive changes. (I am changing pfInvalid to pf_invalid everywhere in the surrounding context, because it will drive me completely nuts to make it inconsistent. Please don't make me do that.)",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T05:33:21Z",
      "diff_hunk" : "@@ -188,9 +188,9 @@ std::vector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n     return ret;\n }\n \n-std::string DecodeBase64(const std::string& str)\n+std::string DecodeBase64(const std::string& str, bool* pfInvalid)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251696573",
      "id" : 251696573,
      "in_reply_to_id" : 246489067,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTY5NjU3Mw==",
      "original_commit_id" : "65cb85e625e11850d21ff133420259a6993d7992",
      "original_position" : 5,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 197383327,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251696573",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251703558"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251703558"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it's the right commit? It moves into BroadcastTransaction.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T06:16:52Z",
      "diff_hunk" : "@@ -1030,19 +1030,24 @@ static UniValue sendrawtransaction(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"sendrawtransaction\", \"\\\"signedhex\\\"\")\n         );\n \n-    std::promise<void> promise;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251703558",
      "id" : 251703558,
      "in_reply_to_id" : 249134420,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTcwMzU1OA==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 4,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 31,
      "pull_request_review_id" : 197391347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251703558",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@promag @sipa @Sjors Can you have an argument, here or elsewhere, about how error handling should work in cases like this, and then tell me what to do? :-) I am ambivalent between \"better exceptions\" and \"switch to return values\". It seems like Sjors and maybe promag favor door number 1, whereas sipa favors door number 2 for reasons I find entirely defensible, but the result is a little harder to work with, though perhaps less hazardous.",
      "created_at" : "2019-01-29T06:18:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-458421067",
      "id" : 458421067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1ODQyMTA2Nw==",
      "updated_at" : "2019-01-29T06:21:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/458421067",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251712255"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251712255"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is this safe (does it not \"prove too much\")? Certainly I can imagine it might cause worse error messages in some cases. I assume it wasn't done that way for some reason originally?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T07:04:07Z",
      "diff_hunk" : "@@ -176,10 +176,20 @@ bool DecodeHexBlk(CBlock& block, const std::string& strHexBlk)\n     return true;\n }\n \n-bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n+bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n {\n-    std::vector<unsigned char> tx_data = DecodeBase64(base64_tx.c_str());\n-    CDataStream ss_data(tx_data, SER_NETWORK, PROTOCOL_VERSION);\n+    bool invalid;\n+    std::string tx_data = DecodeBase64(base64_tx, &invalid);\n+    if (invalid) {\n+        error = \"invalid base64\";\n+        return false;\n+    }\n+    return DecodeRawPSBT(psbt, tx_data, error);\n+}\n+\n+bool DecodeRawPSBT(PartiallySignedTransaction& psbt, const std::string& tx_data, std::string& error)\n+{\n+    CDataStream ss_data(tx_data.data(), tx_data.data() + tx_data.size(), SER_NETWORK, PROTOCOL_VERSION);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251712255",
      "id" : 251712255,
      "in_reply_to_id" : 248218346,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTcxMjI1NQ==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 20,
      "path" : "src/core_read.cpp",
      "position" : 28,
      "pull_request_review_id" : 197401608,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251712255",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251712533"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251712533"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Agreed that this should be elsewhere, I will create src/wallet/transaction.cpp for it. (I was reluctant to be too original just to move a single function, but I prefer it that way also.) And agree regarding the return value, will change it.\r\n\r\nI don't think there's too much additional value in taking a PartiallySignedTransaction, since finalization always results in a CTransaction.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T07:05:38Z",
      "diff_hunk" : "@@ -13,6 +13,9 @@ namespace interfaces {\n class Chain;\n } // namespace interfaces\n \n+/** Broadcast a transaction */\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees = false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251712533",
      "id" : 251712533,
      "in_reply_to_id" : 248222592,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTcxMjUzMw==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 5,
      "path" : "src/rpc/rawtransaction.h",
      "position" : null,
      "pull_request_review_id" : 197401950,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251712533",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251713802"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251713802"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T07:11:54Z",
      "diff_hunk" : "@@ -37,7 +37,8 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251713802",
      "id" : 251713802,
      "in_reply_to_id" : 248220308,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTcxMzgwMg==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 5,
      "path" : "src/core_io.h",
      "position" : null,
      "pull_request_review_id" : 197403378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251713802",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251713815"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251713815"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T07:11:59Z",
      "diff_hunk" : "@@ -37,7 +37,8 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+NODISCARD bool DecodeRawPSBT(PartiallySignedTransaction& psbt, const std::string& tx_data, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251713815",
      "id" : 251713815,
      "in_reply_to_id" : 248220479,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTcxMzgxNQ==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 6,
      "path" : "src/core_io.h",
      "position" : null,
      "pull_request_review_id" : 197403398,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251713815",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251713828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251713828"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T07:12:04Z",
      "diff_hunk" : "@@ -176,10 +176,20 @@ bool DecodeHexBlk(CBlock& block, const std::string& strHexBlk)\n     return true;\n }\n \n-bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n+bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n {\n-    std::vector<unsigned char> tx_data = DecodeBase64(base64_tx.c_str());\n-    CDataStream ss_data(tx_data, SER_NETWORK, PROTOCOL_VERSION);\n+    bool invalid;\n+    std::string tx_data = DecodeBase64(base64_tx, &invalid);\n+    if (invalid) {\n+        error = \"invalid base64\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251713828",
      "id" : 251713828,
      "in_reply_to_id" : 248217728,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTcxMzgyOA==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 12,
      "path" : "src/core_read.cpp",
      "position" : 20,
      "pull_request_review_id" : 197403416,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251713828",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251883895"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251883895"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, let's not do too much in this PR.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T15:33:03Z",
      "diff_hunk" : "@@ -188,9 +188,9 @@ std::vector<unsigned char> DecodeBase64(const char* p, bool* pfInvalid)\n     return ret;\n }\n \n-std::string DecodeBase64(const std::string& str)\n+std::string DecodeBase64(const std::string& str, bool* pfInvalid)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251883895",
      "id" : 251883895,
      "in_reply_to_id" : 246489067,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTg4Mzg5NQ==",
      "original_commit_id" : "65cb85e625e11850d21ff133420259a6993d7992",
      "original_position" : 5,
      "path" : "src/util/strencodings.cpp",
      "position" : null,
      "pull_request_review_id" : 197617203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251883895",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251884271"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251884271"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@achow101 thoughts?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T15:33:54Z",
      "diff_hunk" : "@@ -176,10 +176,20 @@ bool DecodeHexBlk(CBlock& block, const std::string& strHexBlk)\n     return true;\n }\n \n-bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n+bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n {\n-    std::vector<unsigned char> tx_data = DecodeBase64(base64_tx.c_str());\n-    CDataStream ss_data(tx_data, SER_NETWORK, PROTOCOL_VERSION);\n+    bool invalid;\n+    std::string tx_data = DecodeBase64(base64_tx, &invalid);\n+    if (invalid) {\n+        error = \"invalid base64\";\n+        return false;\n+    }\n+    return DecodeRawPSBT(psbt, tx_data, error);\n+}\n+\n+bool DecodeRawPSBT(PartiallySignedTransaction& psbt, const std::string& tx_data, std::string& error)\n+{\n+    CDataStream ss_data(tx_data.data(), tx_data.data() + tx_data.size(), SER_NETWORK, PROTOCOL_VERSION);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251884271",
      "id" : 251884271,
      "in_reply_to_id" : 248218346,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTg4NDI3MQ==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 20,
      "path" : "src/core_read.cpp",
      "position" : 28,
      "pull_request_review_id" : 197617703,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251884271",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251884855"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251884855"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(agree with the latter, I ended up with a different approach too, the seperate file is useful enough)",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T15:35:07Z",
      "diff_hunk" : "@@ -13,6 +13,9 @@ namespace interfaces {\n class Chain;\n } // namespace interfaces\n \n+/** Broadcast a transaction */\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees = false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r251884855",
      "id" : 251884855,
      "in_reply_to_id" : 248222592,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTg4NDg1NQ==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 5,
      "path" : "src/rpc/rawtransaction.h",
      "position" : null,
      "pull_request_review_id" : 197618467,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251884855",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gwillen I'd avoid using exceptions to control flow. For instance, you have:\r\n```cpp\r\nbool FillPSBT(const CWallet* pwallet, PartiallySignedTransaction& psbtx, int sighash_type = 1 /* SIGHASH_ALL */, bool sign = true, bool bip32derivs = false)\r\n```\r\nAnd looks like it returns `false` if it fails, but that's wrong. In fact, it throws if some error occurs and returns whether the transaction has a complete set of signatures.\r\n\r\nLooking the existing calls you see the semantic difference:\r\nhttps://github.com/bitcoin/bitcoin/blob/7275365c9bc7e7ebd6bbf7dcb251946aac44b5de/src/wallet/rpcwallet.cpp#L4035\r\nhttps://github.com/bitcoin/bitcoin/blob/7275365c9bc7e7ebd6bbf7dcb251946aac44b5de/src/wallet/rpcwallet.cpp#L4149",
      "created_at" : "2019-01-29T16:55:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-458618307",
      "id" : 458618307,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1ODYxODMwNw==",
      "updated_at" : "2019-01-29T16:55:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/458618307",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252028851"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252028851"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: use `//!` or equivalent for doxygen",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-29T21:40:13Z",
      "diff_hunk" : "@@ -37,7 +37,11 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+\n+// Decode a base64ed PSBT into a PartiallySignedTransaction\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& decoded_psbt, const std::string& base64_psbt, std::string& error);\n+// Decode a raw (binary blob) PSBT into a PartiallySignedTransaction",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252028851",
      "id" : 252028851,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjAyODg1MQ==",
      "original_commit_id" : "ed465d8f9bddc16d4bfd9a183b2c69ff78a0f636",
      "original_position" : 8,
      "path" : "src/core_io.h",
      "position" : null,
      "pull_request_review_id" : 197798332,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252028851",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252121272"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252121272"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Aha, right. Done.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T05:32:21Z",
      "diff_hunk" : "@@ -37,7 +37,11 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+\n+// Decode a base64ed PSBT into a PartiallySignedTransaction\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& decoded_psbt, const std::string& base64_psbt, std::string& error);\n+// Decode a raw (binary blob) PSBT into a PartiallySignedTransaction",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252121272",
      "id" : 252121272,
      "in_reply_to_id" : 252028851,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEyMTI3Mg==",
      "original_commit_id" : "ed465d8f9bddc16d4bfd9a183b2c69ff78a0f636",
      "original_position" : 8,
      "path" : "src/core_io.h",
      "position" : null,
      "pull_request_review_id" : 197909819,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252121272",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252122624"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252122624"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just for fun, I went and checked -- this code is essentially unchanged since the repo was first imported to github in 2009. So the rationale is probably lost to history...",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T05:41:56Z",
      "diff_hunk" : "@@ -176,10 +176,20 @@ bool DecodeHexBlk(CBlock& block, const std::string& strHexBlk)\n     return true;\n }\n \n-bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n+bool DecodeBase64PSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error)\n {\n-    std::vector<unsigned char> tx_data = DecodeBase64(base64_tx.c_str());\n-    CDataStream ss_data(tx_data, SER_NETWORK, PROTOCOL_VERSION);\n+    bool invalid;\n+    std::string tx_data = DecodeBase64(base64_tx, &invalid);\n+    if (invalid) {\n+        error = \"invalid base64\";\n+        return false;\n+    }\n+    return DecodeRawPSBT(psbt, tx_data, error);\n+}\n+\n+bool DecodeRawPSBT(PartiallySignedTransaction& psbt, const std::string& tx_data, std::string& error)\n+{\n+    CDataStream ss_data(tx_data.data(), tx_data.data() + tx_data.size(), SER_NETWORK, PROTOCOL_VERSION);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252122624",
      "id" : 252122624,
      "in_reply_to_id" : 248218346,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEyMjYyNA==",
      "original_commit_id" : "801333b36360e7137d682836041b61883f70909e",
      "original_position" : 20,
      "path" : "src/core_read.cpp",
      "position" : 28,
      "pull_request_review_id" : 197911429,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252122624",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252122891"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252122891"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Makes sense, done.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T05:44:03Z",
      "diff_hunk" : "@@ -1030,19 +1030,24 @@ static UniValue sendrawtransaction(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"sendrawtransaction\", \"\\\"signedhex\\\"\")\n         );\n \n-    std::promise<void> promise;\n-\n     RPCTypeCheck(request.params, {UniValue::VSTR, UniValue::VBOOL});\n \n     // parse hex string from parameter\n     CMutableTransaction mtx;\n     if (!DecodeHexTx(mtx, request.params[0].get_str()))\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"TX decode failed\");\n     CTransactionRef tx(MakeTransactionRef(std::move(mtx)));\n+\n+    bool allowhighfees = !request.params[1].isNull() && request.params[1].get_bool();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252122891",
      "id" : 252122891,
      "in_reply_to_id" : 248223984,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEyMjg5MQ==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 14,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 197911745,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252122891",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252123372"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252123372"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Can you clarify? These are both by-value, so I wouldn't ordinarily bother marking them const. Am I supposed to?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T05:47:11Z",
      "diff_hunk" : "@@ -1030,19 +1030,24 @@ static UniValue sendrawtransaction(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"sendrawtransaction\", \"\\\"signedhex\\\"\")\n         );\n \n-    std::promise<void> promise;\n-\n     RPCTypeCheck(request.params, {UniValue::VSTR, UniValue::VBOOL});\n \n     // parse hex string from parameter\n     CMutableTransaction mtx;\n     if (!DecodeHexTx(mtx, request.params[0].get_str()))\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"TX decode failed\");\n     CTransactionRef tx(MakeTransactionRef(std::move(mtx)));\n+\n+    bool allowhighfees = !request.params[1].isNull() && request.params[1].get_bool();\n+    return BroadcastTransaction(tx, allowhighfees);\n+}\n+\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252123372",
      "id" : 252123372,
      "in_reply_to_id" : 250610209,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEyMzM3Mg==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 18,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 197912307,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252123372",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252124825"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252124825"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There is little point in doing so, as constness of by-value arguments doesn't even affect the function signature.\r\n\r\nYou can if you really want to make sure the local variables associated with them don't change during the function execution, but that's unusual in our codebase, and not very important.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T05:56:15Z",
      "diff_hunk" : "@@ -1030,19 +1030,24 @@ static UniValue sendrawtransaction(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"sendrawtransaction\", \"\\\"signedhex\\\"\")\n         );\n \n-    std::promise<void> promise;\n-\n     RPCTypeCheck(request.params, {UniValue::VSTR, UniValue::VBOOL});\n \n     // parse hex string from parameter\n     CMutableTransaction mtx;\n     if (!DecodeHexTx(mtx, request.params[0].get_str()))\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"TX decode failed\");\n     CTransactionRef tx(MakeTransactionRef(std::move(mtx)));\n+\n+    bool allowhighfees = !request.params[1].isNull() && request.params[1].get_bool();\n+    return BroadcastTransaction(tx, allowhighfees);\n+}\n+\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252124825",
      "id" : 252124825,
      "in_reply_to_id" : 250610209,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEyNDgyNQ==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 18,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 197914062,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252124825",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gwillen My preference is an enum over exceptions (but both are used in the codebase, so if others feel strongly, feel free to ignore me).",
      "created_at" : "2019-01-30T05:56:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-458821958",
      "id" : 458821958,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1ODgyMTk1OA==",
      "updated_at" : "2019-01-30T05:57:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/458821958",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252130275"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252130275"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done, but this now makes it more obvious that BroadcastTransaction has the same question as the PSBT functions as to how it shall signal an error, since right now it throws UniValues like the other RPC stuff.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T06:28:46Z",
      "diff_hunk" : "@@ -13,6 +13,9 @@ namespace interfaces {\n class Chain;\n } // namespace interfaces\n \n+/** Broadcast a transaction */\n+std::string BroadcastTransaction(CTransactionRef tx, bool allowhighfees = false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252130275",
      "id" : 252130275,
      "in_reply_to_id" : 248222592,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEzMDI3NQ==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 5,
      "path" : "src/rpc/rawtransaction.h",
      "position" : null,
      "pull_request_review_id" : 197920370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252130275",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252131014"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252131014"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Makes sense, done.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T06:33:20Z",
      "diff_hunk" : "@@ -391,20 +391,15 @@ struct PartiallySignedTransaction\n     std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n \n     bool IsNull() const;\n-    void Merge(const PartiallySignedTransaction& psbt);\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);\n     bool IsSane() const;\n     PartiallySignedTransaction() {}\n     PartiallySignedTransaction(const PartiallySignedTransaction& psbt_in) : tx(psbt_in.tx), inputs(psbt_in.inputs), outputs(psbt_in.outputs), unknown(psbt_in.unknown) {}\n     explicit PartiallySignedTransaction(const CTransaction& tx);\n \n-    // Only checks if they refer to the same transaction\n-    friend bool operator==(const PartiallySignedTransaction& a, const PartiallySignedTransaction &b)\n-    {\n-        return a.tx->GetHash() == b.tx->GetHash();\n-    }\n-    friend bool operator!=(const PartiallySignedTransaction& a, const PartiallySignedTransaction &b)\n-    {\n-        return !(a == b);\n+    // Checks if they refer to the same underlying CTransaction\n+    bool SameTx(const PartiallySignedTransaction& psbt) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252131014",
      "id" : 252131014,
      "in_reply_to_id" : 248234110,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEzMTAxNA==",
      "original_commit_id" : "08ef528c044ecea74a4d1bff75389afbdd3b7a2f",
      "original_position" : 20,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 197921295,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252131014",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252131768"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252131768"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T06:38:30Z",
      "diff_hunk" : "@@ -391,20 +391,15 @@ struct PartiallySignedTransaction\n     std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n \n     bool IsNull() const;\n-    void Merge(const PartiallySignedTransaction& psbt);\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252131768",
      "id" : 252131768,
      "in_reply_to_id" : 248236086,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEzMTc2OA==",
      "original_commit_id" : "08ef528c044ecea74a4d1bff75389afbdd3b7a2f",
      "original_position" : 5,
      "path" : "src/psbt.h",
      "position" : 390,
      "pull_request_review_id" : 197922314,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252131768",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252135154"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252135154"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T06:58:09Z",
      "diff_hunk" : "@@ -232,3 +232,44 @@ bool SignPSBTInput(const SigningProvider& provider, PartiallySignedTransaction&\n \n     return sig_complete;\n }\n+\n+void FinalizePSBT(PartiallySignedTransaction& psbtx, bool extract, std::string& result, bool& complete) {\n+    // Finalize input signatures -- in case we have partial signatures that add up to a complete\n+    //   signature, but have not combined them yet (e.g. because the combiner that created this\n+    //   PartiallySignedTransaction did not understand them), this will combine them into a final\n+    //   script.\n+    complete = true;\n+    for (unsigned int i = 0; i < psbtx.tx->vin.size(); ++i) {\n+        complete &= SignPSBTInput(DUMMY_SIGNING_PROVIDER, psbtx, i, SIGHASH_ALL);\n+    }\n+\n+    CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);\n+    if (complete && extract) {\n+        CMutableTransaction mtx(*psbtx.tx);\n+        for (unsigned int i = 0; i < mtx.vin.size(); ++i) {\n+            mtx.vin[i].scriptSig = psbtx.inputs[i].final_script_sig;\n+            mtx.vin[i].scriptWitness = psbtx.inputs[i].final_script_witness;\n+        }\n+        ssTx << mtx;\n+        result = HexStr(ssTx.str());\n+    } else {\n+        ssTx << psbtx;\n+        result = EncodeBase64(ssTx.str());\n+    }\n+}\n+\n+PartiallySignedTransaction CombinePSBTs(std::vector<PartiallySignedTransaction> psbtxs) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252135154",
      "id" : 252135154,
      "in_reply_to_id" : 248238602,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjEzNTE1NA==",
      "original_commit_id" : "c062d74e1187e481960ca6868a46642b8bbfbd2e",
      "original_position" : 30,
      "path" : "src/psbt.cpp",
      "position" : null,
      "pull_request_review_id" : 197926544,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252135154",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252145692"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252145692"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : ">Though maybe that's too much refactoring for this PR.\r\n\r\nNo, it's too late, you've got me thinking about it now. The \"finalize and maybe extract\" interface is kind of weird as it stands, and the string-handling stuff belongs in the rpc handler, not in the general-purpose functions. I clearly drew the abstraction boundaries in the wrong place.\r\n\r\nI've reworked this in a way that feels a bit better to me. It's not perfect but it no longer obviously feels to me like I can improve it.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T07:50:08Z",
      "diff_hunk" : "@@ -0,0 +1,562 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** An exception in PSBT processing that represents a problem with the input data --\n+    when the input data is user-supplied, it is appropriate to catch() this and use\n+    e.what() to retrieve a human-readable error message. */\n+class PSBTException: public std::runtime_error {\n+    // expose superclass constructors\n+    using std::runtime_error::runtime_error;\n+};\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_IN_NON_WITNESS_UTXO:\n+                {\n+                    if (non_witness_utxo) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input non-witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Non-witness utxo key is more than one byte type\");\n+                    }\n+                    // Set the stream to unserialize with witness since this is always a valid network transaction\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() & ~SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, non_witness_utxo);\n+                    break;\n+                }\n+                case PSBT_IN_WITNESS_UTXO:\n+                    if (!witness_utxo.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Witness utxo key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, witness_utxo);\n+                    break;\n+                case PSBT_IN_PARTIAL_SIG:\n+                {\n+                    // Make sure that the key is the size of pubkey + 1\n+                    if (key.size() != CPubKey::PUBLIC_KEY_SIZE + 1 && key.size() != CPubKey::COMPRESSED_PUBLIC_KEY_SIZE + 1) {\n+                        throw std::ios_base::failure(\"Size of key was not the expected size for the type partial signature pubkey\");\n+                    }\n+                    // Read in the pubkey from key\n+                    CPubKey pubkey(key.begin() + 1, key.end());\n+                    if (!pubkey.IsFullyValid()) {\n+                       throw std::ios_base::failure(\"Invalid pubkey\");\n+                    }\n+                    if (partial_sigs.count(pubkey.GetID()) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input partial signature for pubkey already provided\");\n+                    }\n+\n+                    // Read in the signature from value\n+                    std::vector<unsigned char> sig;\n+                    s >> sig;\n+\n+                    // Add to list\n+                    partial_sigs.emplace(pubkey.GetID(), SigPair(pubkey, std::move(sig)));\n+                    break;\n+                }\n+                case PSBT_IN_SIGHASH:\n+                    if (sighash_type > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input sighash type already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Sighash type key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, sighash_type);\n+                    break;\n+                case PSBT_IN_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_IN_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_IN_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTSIG:\n+                {\n+                    if (!final_script_sig.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptSig already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptSig key is more than one byte type\");\n+                    }\n+                    s >> final_script_sig;\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTWITNESS:\n+                {\n+                    if (!final_script_witness.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptWitness already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptWitness key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, final_script_witness.stack);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default:\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an input map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTInput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A structure for PSBTs which contains per output information */\n+struct PSBTOutput\n+{\n+    CScript redeem_script;\n+    CScript witness_script;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTOutput& output);\n+    bool IsSane() const;\n+    PSBTOutput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the redeem script\n+        if (!redeem_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_REDEEMSCRIPT);\n+            s << redeem_script;\n+        }\n+\n+        // Write the witness script\n+        if (!witness_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_WITNESSSCRIPT);\n+            s << witness_script;\n+        }\n+\n+        // Write any hd keypaths\n+        SerializeHDKeypaths(s, hd_keypaths, PSBT_OUT_BIP32_DERIVATION);\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_OUT_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_OUT_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_OUT_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an output map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTOutput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A version of CTransaction with the PSBT format*/\n+struct PartiallySignedTransaction\n+{\n+    boost::optional<CMutableTransaction> tx;\n+    std::vector<PSBTInput> inputs;\n+    std::vector<PSBTOutput> outputs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);\n+    bool IsSane() const;\n+    PartiallySignedTransaction() {}\n+    PartiallySignedTransaction(const PartiallySignedTransaction& psbt_in) : tx(psbt_in.tx), inputs(psbt_in.inputs), outputs(psbt_in.outputs), unknown(psbt_in.unknown) {}\n+    explicit PartiallySignedTransaction(const CTransaction& tx);\n+\n+    // Checks if they refer to the same underlying CTransaction\n+    bool SameTx(const PartiallySignedTransaction& psbt) {\n+        return tx->GetHash() == psbt.tx->GetHash();\n+    }\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+\n+        // magic bytes\n+        s << PSBT_MAGIC_BYTES;\n+\n+        // unsigned tx flag\n+        SerializeToVector(s, PSBT_GLOBAL_UNSIGNED_TX);\n+\n+        // Write serialized tx to a stream\n+        OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+        SerializeToVector(os, *tx);\n+\n+        // Write the unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        // Separator\n+        s << PSBT_SEPARATOR;\n+\n+        // Write inputs\n+        for (const PSBTInput& input : inputs) {\n+            s << input;\n+        }\n+        // Write outputs\n+        for (const PSBTOutput& output : outputs) {\n+            s << output;\n+        }\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read the magic bytes\n+        uint8_t magic[5];\n+        s >> magic;\n+        if (!std::equal(magic, magic + 5, PSBT_MAGIC_BYTES)) {\n+            throw std::ios_base::failure(\"Invalid PSBT magic bytes\");\n+        }\n+\n+        // Read global data\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_GLOBAL_UNSIGNED_TX:\n+                {\n+                    if (tx) {\n+                        throw std::ios_base::failure(\"Duplicate Key, unsigned tx already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Global unsigned tx key is more than one byte type\");\n+                    }\n+                    CMutableTransaction mtx;\n+                    // Set the stream to serialize with non-witness since this should always be non-witness\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, mtx);\n+                    tx = std::move(mtx);\n+                    // Make sure that all scriptSigs and scriptWitnesses are empty\n+                    for (const CTxIn& txin : tx->vin) {\n+                        if (!txin.scriptSig.empty() || !txin.scriptWitness.IsNull()) {\n+                            throw std::ios_base::failure(\"Unsigned tx does not have empty scriptSigs and scriptWitnesses.\");\n+                        }\n+                    }\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of the global map\");\n+        }\n+\n+        // Make sure that we got an unsigned tx\n+        if (!tx) {\n+            throw std::ios_base::failure(\"No unsigned transcation was provided\");\n+        }\n+\n+        // Read input data\n+        unsigned int i = 0;\n+        while (!s.empty() && i < tx->vin.size()) {\n+            PSBTInput input;\n+            s >> input;\n+            inputs.push_back(input);\n+\n+            // Make sure the non-witness utxo matches the outpoint\n+            if (input.non_witness_utxo && input.non_witness_utxo->GetHash() != tx->vin[i].prevout.hash) {\n+                throw std::ios_base::failure(\"Non-witness UTXO does not match outpoint hash\");\n+            }\n+            ++i;\n+        }\n+        // Make sure that the number of inputs matches the number of inputs in the transaction\n+        if (inputs.size() != tx->vin.size()) {\n+            throw std::ios_base::failure(\"Inputs provided does not match the number of inputs in transaction.\");\n+        }\n+\n+        // Read output data\n+        i = 0;\n+        while (!s.empty() && i < tx->vout.size()) {\n+            PSBTOutput output;\n+            s >> output;\n+            outputs.push_back(output);\n+            ++i;\n+        }\n+        // Make sure that the number of outputs matches the number of outputs in the transaction\n+        if (outputs.size() != tx->vout.size()) {\n+            throw std::ios_base::failure(\"Outputs provided does not match the number of outputs in transaction.\");\n+        }\n+        // Sanity check\n+        if (!IsSane()) {\n+            throw std::ios_base::failure(\"PSBT is not sane.\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PartiallySignedTransaction(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** Checks whether a PSBTInput is already signed. */\n+bool PSBTInputSigned(PSBTInput& input);\n+\n+/** Signs a PSBTInput, verifying that all provided data matches what is being signed. */\n+bool SignPSBTInput(const SigningProvider& provider, PartiallySignedTransaction& psbt, int index, int sighash = SIGHASH_ALL);\n+\n+/** Finalizes a PSBT if possible, combining partial signatures and optionally extracting to a signed transaction ready for sending. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252145692",
      "id" : 252145692,
      "in_reply_to_id" : 250597281,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjE0NTY5Mg==",
      "original_commit_id" : "c062d74e1187e481960ca6868a46642b8bbfbd2e",
      "original_position" : 556,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 197939619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252145692",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think I've addressed everything except the error-handling / exceptions stuff, which I'm still thinking about and will punt to tomorrow.\r\n\r\nI significantly reworked the FinalizePSBT interface, so it deserves another look. Everything else was relatively minor.",
      "created_at" : "2019-01-30T07:57:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-458846994",
      "id" : 458846994,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1ODg0Njk5NA==",
      "updated_at" : "2019-01-30T07:57:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/458846994",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252258040"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252258040"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You're right, looks good.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-30T13:37:04Z",
      "diff_hunk" : "@@ -1030,19 +1030,24 @@ static UniValue sendrawtransaction(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"sendrawtransaction\", \"\\\"signedhex\\\"\")\n         );\n \n-    std::promise<void> promise;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252258040",
      "id" : 252258040,
      "in_reply_to_id" : 249134420,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjI1ODA0MA==",
      "original_commit_id" : "745c540d05f4a21810eccc5e9450e9b321560560",
      "original_position" : 4,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 31,
      "pull_request_review_id" : 198079167,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252258040",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I agree that using an enum would be better. We already use enums for other errors  like script_error, etc. So I think it would make sense to continue that pattern here as well.",
      "created_at" : "2019-01-30T20:28:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-459096637",
      "id" : 459096637,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTA5NjYzNw==",
      "updated_at" : "2019-01-30T20:28:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459096637",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, I ended up doing something that feels a little gross and unorthodox for the error handling.\r\n\r\nThe problems with a new enum are several-fold: Most notably, it would be at least two new enums, since BroadcastTransaction and the various PSBT functions are not really of the same sort, unless we want something like a general-purpose TransactionError type (which I wouldn't be totally against.) The ONLY consumer of error codes in any form (as far as I can tell) would be RPC callers, which means the only point of making a bunch of new error constants is to immediately turn around and define a mapping of them to RPC error constants.\r\n\r\n(ScriptErrors get handled a little differently, as far as I can tell -- they just get converted to strings when they are stuffed into RPC responses, and the numeric codes discarded. As far as I can tell, the _only_ other use for them is in tests. If we were going to go that route here, I would just advocate for pure string errors, since the constants wouldn't have any interesting producers or consumers at that point.)\r\n\r\nAnyway, on the theory that the only consumer of error codes is the RPC subsystem, my approach is this: I retained the use of RPCErrorCode and JSONRPCError. Instead of throwing the resulting UniValue objects, I am using out parameters for them. Then when I am back in the RPC codepath, I take the object and throw it. In the GUI codepath, I expect to extract the error message from it to display to the user, and ignore the code.\r\n\r\nThis is definitely a little bit crazy, but I was having trouble coming up with any better ideas. Thoughts?",
      "created_at" : "2019-01-31T03:44:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-459203945",
      "id" : 459203945,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTIwMzk0NQ==",
      "updated_at" : "2019-01-31T03:45:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459203945",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, and I think the Travis failure is real -- I think the problem is that actually BroadcastTransaction does NOT belong under wallet/ and needs to be linked even when the wallet is disabled. So right now disabling the wallet causes the link to fail.\r\n\r\nSuggestions for where to move it? Right now it's a pair of new files named wallet/transaction.{h,cpp}.",
      "created_at" : "2019-01-31T04:01:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-459206704",
      "id" : 459206704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTIwNjcwNA==",
      "updated_at" : "2019-01-31T04:01:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459206704",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> The ONLY consumer of error codes in any form (as far as I can tell) would be RPC callers,\r\n\r\nIn #14912 I plan to move more code into the `ExternalSigner` class, which will be used by both RPC and the GUI.\r\n\r\n> general-purpose TransactionError type\r\n\r\nWorks for me\r\n\r\n> I retained the use of RPCErrorCode and JSONRPCError. Instead of throwing the resulting UniValue objects, I am using out parameters for them. Then when I am back in the RPC codepath, I take the object and throw it\r\n\r\nI like your previous approach better. I'm also not a fan of using `UniValue` outside of RPC input & output processing.\r\n \r\n> that actually BroadcastTransaction does NOT belong under `wallet/`\r\n\r\nIndeed it doesn't. Nodes without a wallet can also broadcast transactions and do various things with PSBT. Maybe `src/node/transaction.{h,c}`? @ryanofsky what makes sense given #10973? I'm assuming it doesn't really belong in `src/interfaces`?",
      "created_at" : "2019-01-31T09:37:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-459278864",
      "id" : 459278864,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTI3ODg2NA==",
      "updated_at" : "2019-01-31T09:40:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459278864",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252594448"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252594448"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yuck pseudo-circular dependency? :-) ",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-01-31T09:41:04Z",
      "diff_hunk" : "@@ -2,14 +2,14 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n-#include <rpc/protocol.h>\n+#include <rpc/protocol.h> // For JSONRPCError and RPCErrorCode",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r252594448",
      "id" : 252594448,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjU5NDQ0OA==",
      "original_commit_id" : "eb1c459f40b74fb1e6fb054f950ba7dd7086980e",
      "original_position" : 5,
      "path" : "src/wallet/psbtwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 198497755,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252594448",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > that actually BroadcastTransaction does NOT belong under wallet/\r\n\r\n> Indeed it doesn't. Nodes without a wallet can also broadcast transactions and do various things with PSBT. Maybe src/node/transaction.{h,c}? @ryanofsky what makes sense given #10973? I'm assuming it doesn't really belong in src/interfaces?\r\n\r\nIt would be reasonable to make `BroadcastTransaction` an `interfaces::Chain` method. (`Chain` is the object a wallet process uses to communicate with a node process in #10102), and I've actually kind of done this already in 9eee26ef6071451ee426f71beb6b77184bc8b073 and 02022184aa98ad27ba4338dd0f7a8e4d20180818 from #15288. It would also be reasonable to move `BroadcastTransaction` somewhere else if it can't stay in wallet because it will be used by non-wallet code. Whatever you decide should be fine.",
      "created_at" : "2019-01-31T14:56:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-459373984",
      "id" : 459373984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTM3Mzk4NA==",
      "updated_at" : "2019-01-31T14:59:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459373984",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ryanofsky The reason I need something like BroadcastTransaction is that, currently, none of the interfaces:: stuff exports a way to broadcast a transaction that didn't come from the wallet (and I need the RPC-like ability to do it with a blob I was handed.) So probably these codepaths should eventually merge! :-)",
      "created_at" : "2019-02-01T01:03:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-459566924",
      "id" : 459566924,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTU2NjkyNA==",
      "updated_at" : "2019-02-01T01:03:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459566924",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "By the way `wallet/transaction.{h,cpp}` is still useful, even if not for this PR. E.g. I have a need to move `FundTransaction(CWallet* const pwallet, CMutableTransaction& tx...` out of `rpcwallet.{h,cpp}`\r\n\r\nI would probably also wrap that inside a `FundPSBT` method in `wallet/psbtwallet.{h,cpp}`, so that `walletcreatefundedpsbt` doesn't have to deal directly with `CMutableTransaction`. ",
      "created_at" : "2019-02-01T12:56:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-459714289",
      "id" : 459714289,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1OTcxNDI4OQ==",
      "updated_at" : "2019-02-01T12:56:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/459714289",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ryanofsky Now that I'm actually trying to do it -- why interfaces::Chain and not interfaces::Node? That seems like a better fit. (Especially since the GUI ClientModel object has a Node interface handy, but I don't see where the GUI easily gets access to a Chain, although I'm not totally sure where to look.)\r\n\r\n(Noting that specifically I need to do this in a non-wallet context, for a transaction that's not necessarily in or from the wallet.)",
      "created_at" : "2019-02-04T22:48:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-460444291",
      "id" : 460444291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MDQ0NDI5MQ==",
      "updated_at" : "2019-02-04T23:03:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/460444291",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Why interfaces::Chain and not interfaces::Node? That seems like a better fit.\r\n\r\nYou're right. I didn't look at this PR closely enough and assumed that it was calling `BroadcastTransaction` from the wallet. In this case, a `Chain` method would have to be added at some point (like in #15288), because the `Chain` interface is the only way a separate wallet process can access the node process. After you had a `Chain` method, you could also allow the GUI to be able to broadcast transactions by adding a`Node` method which forwarded to `m_interfaces.chain->broadcastTransaction(...)`.\r\n\r\nBut actually looking at this PR, `BroadcastTransaction` isn't called from either the wallet or the gui, only from the `sendrawtransaction` RPC. So I think it makes most sense for `BroadcastTransaction` to remain a standalone function so it can be conveniently called from `sendrawtransaction`.",
      "created_at" : "2019-02-04T23:28:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-460455108",
      "id" : 460455108,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MDQ1NTEwOA==",
      "updated_at" : "2019-02-04T23:31:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/460455108",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, good point. So I'm going ahead with creating src/node for it to live in, and then later I will forward from interfaces::Node (when I actually add a GUI use of it.)",
      "created_at" : "2019-02-05T00:10:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-460464163",
      "id" : 460464163,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MDQ2NDE2Mw==",
      "updated_at" : "2019-02-05T00:10:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/460464163",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, I think I have fixed the issue with BroadcastTransaction linking, by moving it out of the wallet stuff.\r\n\r\nI have made another attempt at the error stuff. :-) This time we have a TransactionError enum, and a translation table from TransactionError to RPCErrorCode, as well as strings for each TransactionError.\r\n\r\nThe result is _almost_ faithful, for RPC clients, to how it was before, except:\r\n- I have reclassified syntactically-valid but semantically-invalid PSBTs, from RPC_DESERIALIZATION_ERROR to RPC_INVALID_PARAMETER, in one case (we were being inconsistent)\r\n- When AcceptToMemoryPool fails, we can extract a string from the failure using FormatStateMessage. But we no longer have an easy way to pass that message back to the RPC caller, so right now we don't. Probably I should add another out param to fix this or something. Yes? No?\r\n\r\nI think we are almost at the finish line. :-)",
      "created_at" : "2019-02-06T22:42:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-461217722",
      "id" : 461217722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MTIxNzcyMg==",
      "updated_at" : "2019-02-06T22:43:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/461217722",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "In fact, it turns out that changing the error message wording of BroadcastTransaction at all breaks a bunch of functional tests. Working on it.\r\n\r\nEDIT: Yeah the tests definitely require the failure strings from FormatStateMessage. So I'm going to think about how to plumb those through.",
      "created_at" : "2019-02-07T03:27:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-461275858",
      "id" : 461275858,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MTI3NTg1OA==",
      "updated_at" : "2019-02-07T09:25:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/461275858",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "There we go! Ready for another look.",
      "created_at" : "2019-02-07T11:57:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-461390320",
      "id" : 461390320,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MTM5MDMyMA==",
      "updated_at" : "2019-02-07T11:57:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/461390320",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254947978"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254947978"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It seems a bit strange that `raw_psbt` is a string and not a `std::vector<unsigned char>`. The `DecodeBase64` call below also returns a `std::vector<unsigned char>`, so changing this would avoid a conversion (which I'm a bit surprised happens automatically).",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-08T03:40:58Z",
      "diff_hunk" : "@@ -37,7 +37,11 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+\n+//! Decode a base64ed PSBT into a PartiallySignedTransaction\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& decoded_psbt, const std::string& base64_psbt, std::string& error);\n+//! Decode a raw (binary blob) PSBT into a PartiallySignedTransaction\n+NODISCARD bool DecodeRawPSBT(PartiallySignedTransaction& decoded_psbt, const std::string& raw_psbt, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254947978",
      "id" : 254947978,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NDk0Nzk3OA==",
      "original_commit_id" : "6a1570ad97ea6405a14e205bc05a7862808013c4",
      "original_position" : 9,
      "path" : "src/core_io.h",
      "position" : 9,
      "pull_request_review_id" : 201422403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254947978",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254948713"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254948713"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This changes the error code for TRANSACTION_ERR_INVALID_PSBT from RPC_DESERIALIZATION_ERROR to RPC_INVALID_PARAMETER. Is that intentional?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-08T03:48:06Z",
      "diff_hunk" : "@@ -139,6 +139,8 @@ RPCErrorCode RPCErrorFromTransactionError(TransactionError terr)\n         case TRANSACTION_ERR_P2P_DISABLED:\n             return RPC_CLIENT_P2P_DISABLED;\n         case TRANSACTION_ERR_INVALID_PSBT:\n+        case TRANSACTION_ERR_PSBT_MISMATCH:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254948713",
      "id" : 254948713,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NDk0ODcxMw==",
      "original_commit_id" : "acac678ebe6e105e0a775b6eff37b1583139bf21",
      "original_position" : 4,
      "path" : "src/rpc/util.cpp",
      "position" : null,
      "pull_request_review_id" : 201422403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254948713",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254966363"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254966363"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, because there are two cases where we return an RPC error for a PSBT being semantically invalid, and we were returning DESERIALIZATION_ERROR in one case (when the invalid PSBT was given as a parameter) and INVALID_PARAMETER in the other (when the invalid PSBT was the result of a merge), and the I though the latter seemed more reasonable. My sense was that DESERIALIZATION_ERROR is only meant for syntactically invalid arguments? I'd be willing to change it back though. It would be easier if the two cases were treated the same.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-08T06:28:50Z",
      "diff_hunk" : "@@ -139,6 +139,8 @@ RPCErrorCode RPCErrorFromTransactionError(TransactionError terr)\n         case TRANSACTION_ERR_P2P_DISABLED:\n             return RPC_CLIENT_P2P_DISABLED;\n         case TRANSACTION_ERR_INVALID_PSBT:\n+        case TRANSACTION_ERR_PSBT_MISMATCH:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254966363",
      "id" : 254966363,
      "in_reply_to_id" : 254948713,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NDk2NjM2Mw==",
      "original_commit_id" : "acac678ebe6e105e0a775b6eff37b1583139bf21",
      "original_position" : 4,
      "path" : "src/rpc/util.cpp",
      "position" : null,
      "pull_request_review_id" : 201444770,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254966363",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254971323"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254971323"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't have any strong opinion on the RPC codes. I just wanted to make sure this was intentional (as it could easily have been a copypaste error or so).",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-08T07:03:45Z",
      "diff_hunk" : "@@ -139,6 +139,8 @@ RPCErrorCode RPCErrorFromTransactionError(TransactionError terr)\n         case TRANSACTION_ERR_P2P_DISABLED:\n             return RPC_CLIENT_P2P_DISABLED;\n         case TRANSACTION_ERR_INVALID_PSBT:\n+        case TRANSACTION_ERR_PSBT_MISMATCH:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254971323",
      "id" : 254971323,
      "in_reply_to_id" : 254948713,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NDk3MTMyMw==",
      "original_commit_id" : "acac678ebe6e105e0a775b6eff37b1583139bf21",
      "original_position" : 4,
      "path" : "src/rpc/util.cpp",
      "position" : null,
      "pull_request_review_id" : 201450565,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254971323",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254974356"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254974356"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In fact, DecodeBase64 does not return a vector&lt;uchar>, it does return a std::string when given a std::string, which I imagine is why I ended up doing it this way, to avoid having to convert it. (When given a char*, it returns a vector&lt;uchar>. Your guess why it was done this way is as good as mine.)\r\n\r\nI did carefully check that std::string is just a binary-safe as vector&lt;uchar>. I'm fine leaving it or changing it as you prefer.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-08T07:23:51Z",
      "diff_hunk" : "@@ -37,7 +37,11 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+\n+//! Decode a base64ed PSBT into a PartiallySignedTransaction\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& decoded_psbt, const std::string& base64_psbt, std::string& error);\n+//! Decode a raw (binary blob) PSBT into a PartiallySignedTransaction\n+NODISCARD bool DecodeRawPSBT(PartiallySignedTransaction& decoded_psbt, const std::string& raw_psbt, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r254974356",
      "id" : 254974356,
      "in_reply_to_id" : 254947978,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NDk3NDM1Ng==",
      "original_commit_id" : "6a1570ad97ea6405a14e205bc05a7862808013c4",
      "original_position" : 9,
      "path" : "src/core_io.h",
      "position" : 9,
      "pull_request_review_id" : 201454280,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/254974356",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255276868"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255276868"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh, you're right. That's weird, but probably out of scope for this PR. I'm fine with leaving this as is.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-09T00:45:50Z",
      "diff_hunk" : "@@ -37,7 +37,11 @@ bool DecodeHexBlockHeader(CBlockHeader&, const std::string& hex_header);\n  */\n bool ParseHashStr(const std::string& strHex, uint256& result);\n std::vector<unsigned char> ParseHexUV(const UniValue& v, const std::string& strName);\n-NODISCARD bool DecodePSBT(PartiallySignedTransaction& psbt, const std::string& base64_tx, std::string& error);\n+\n+//! Decode a base64ed PSBT into a PartiallySignedTransaction\n+NODISCARD bool DecodeBase64PSBT(PartiallySignedTransaction& decoded_psbt, const std::string& base64_psbt, std::string& error);\n+//! Decode a raw (binary blob) PSBT into a PartiallySignedTransaction\n+NODISCARD bool DecodeRawPSBT(PartiallySignedTransaction& decoded_psbt, const std::string& raw_psbt, std::string& error);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255276868",
      "id" : 255276868,
      "in_reply_to_id" : 254947978,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTI3Njg2OA==",
      "original_commit_id" : "6a1570ad97ea6405a14e205bc05a7862808013c4",
      "original_position" : 9,
      "path" : "src/core_io.h",
      "position" : 9,
      "pull_request_review_id" : 201838420,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255276868",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255279060"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255279060"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This looks like a C-ism. You can just use `enum TransactionError { ... };` in C++ with (I think) the same effect.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-09T01:08:12Z",
      "diff_hunk" : "@@ -0,0 +1,43 @@\n+// Copyright (c) 2017-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NODE_TRANSACTION_H\n+#define BITCOIN_NODE_TRANSACTION_H\n+\n+#include <primitives/transaction.h>\n+#include <uint256.h>\n+\n+typedef enum TransactionError_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255279060",
      "id" : 255279060,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTI3OTA2MA==",
      "original_commit_id" : "acac678ebe6e105e0a775b6eff37b1583139bf21",
      "original_position" : 11,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 201840933,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255279060",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255279289"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255279289"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: `CMutableTransaction`.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-09T01:10:57Z",
      "diff_hunk" : "@@ -0,0 +1,574 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <node/transaction.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_IN_NON_WITNESS_UTXO:\n+                {\n+                    if (non_witness_utxo) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input non-witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Non-witness utxo key is more than one byte type\");\n+                    }\n+                    // Set the stream to unserialize with witness since this is always a valid network transaction\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() & ~SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, non_witness_utxo);\n+                    break;\n+                }\n+                case PSBT_IN_WITNESS_UTXO:\n+                    if (!witness_utxo.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Witness utxo key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, witness_utxo);\n+                    break;\n+                case PSBT_IN_PARTIAL_SIG:\n+                {\n+                    // Make sure that the key is the size of pubkey + 1\n+                    if (key.size() != CPubKey::PUBLIC_KEY_SIZE + 1 && key.size() != CPubKey::COMPRESSED_PUBLIC_KEY_SIZE + 1) {\n+                        throw std::ios_base::failure(\"Size of key was not the expected size for the type partial signature pubkey\");\n+                    }\n+                    // Read in the pubkey from key\n+                    CPubKey pubkey(key.begin() + 1, key.end());\n+                    if (!pubkey.IsFullyValid()) {\n+                       throw std::ios_base::failure(\"Invalid pubkey\");\n+                    }\n+                    if (partial_sigs.count(pubkey.GetID()) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input partial signature for pubkey already provided\");\n+                    }\n+\n+                    // Read in the signature from value\n+                    std::vector<unsigned char> sig;\n+                    s >> sig;\n+\n+                    // Add to list\n+                    partial_sigs.emplace(pubkey.GetID(), SigPair(pubkey, std::move(sig)));\n+                    break;\n+                }\n+                case PSBT_IN_SIGHASH:\n+                    if (sighash_type > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input sighash type already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Sighash type key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, sighash_type);\n+                    break;\n+                case PSBT_IN_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_IN_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_IN_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTSIG:\n+                {\n+                    if (!final_script_sig.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptSig already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptSig key is more than one byte type\");\n+                    }\n+                    s >> final_script_sig;\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTWITNESS:\n+                {\n+                    if (!final_script_witness.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptWitness already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptWitness key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, final_script_witness.stack);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default:\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an input map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTInput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A structure for PSBTs which contains per output information */\n+struct PSBTOutput\n+{\n+    CScript redeem_script;\n+    CScript witness_script;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTOutput& output);\n+    bool IsSane() const;\n+    PSBTOutput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the redeem script\n+        if (!redeem_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_REDEEMSCRIPT);\n+            s << redeem_script;\n+        }\n+\n+        // Write the witness script\n+        if (!witness_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_WITNESSSCRIPT);\n+            s << witness_script;\n+        }\n+\n+        // Write any hd keypaths\n+        SerializeHDKeypaths(s, hd_keypaths, PSBT_OUT_BIP32_DERIVATION);\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_OUT_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_OUT_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_OUT_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an output map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTOutput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A version of CTransaction with the PSBT format*/\n+struct PartiallySignedTransaction\n+{\n+    boost::optional<CMutableTransaction> tx;\n+    std::vector<PSBTInput> inputs;\n+    std::vector<PSBTOutput> outputs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+\n+    /** Merge psbt into this. The two psbts must have the same underlying CTransaction (i.e. the\n+      * same actual Bitcoin transaction.) Returns true if the merge succeeded, false otherwise. */\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);\n+    bool IsSane() const;\n+    PartiallySignedTransaction() {}\n+    PartiallySignedTransaction(const PartiallySignedTransaction& psbt_in) : tx(psbt_in.tx), inputs(psbt_in.inputs), outputs(psbt_in.outputs), unknown(psbt_in.unknown) {}\n+    explicit PartiallySignedTransaction(const CMutableTransaction& tx);\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+\n+        // magic bytes\n+        s << PSBT_MAGIC_BYTES;\n+\n+        // unsigned tx flag\n+        SerializeToVector(s, PSBT_GLOBAL_UNSIGNED_TX);\n+\n+        // Write serialized tx to a stream\n+        OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+        SerializeToVector(os, *tx);\n+\n+        // Write the unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        // Separator\n+        s << PSBT_SEPARATOR;\n+\n+        // Write inputs\n+        for (const PSBTInput& input : inputs) {\n+            s << input;\n+        }\n+        // Write outputs\n+        for (const PSBTOutput& output : outputs) {\n+            s << output;\n+        }\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read the magic bytes\n+        uint8_t magic[5];\n+        s >> magic;\n+        if (!std::equal(magic, magic + 5, PSBT_MAGIC_BYTES)) {\n+            throw std::ios_base::failure(\"Invalid PSBT magic bytes\");\n+        }\n+\n+        // Read global data\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_GLOBAL_UNSIGNED_TX:\n+                {\n+                    if (tx) {\n+                        throw std::ios_base::failure(\"Duplicate Key, unsigned tx already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Global unsigned tx key is more than one byte type\");\n+                    }\n+                    CMutableTransaction mtx;\n+                    // Set the stream to serialize with non-witness since this should always be non-witness\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, mtx);\n+                    tx = std::move(mtx);\n+                    // Make sure that all scriptSigs and scriptWitnesses are empty\n+                    for (const CTxIn& txin : tx->vin) {\n+                        if (!txin.scriptSig.empty() || !txin.scriptWitness.IsNull()) {\n+                            throw std::ios_base::failure(\"Unsigned tx does not have empty scriptSigs and scriptWitnesses.\");\n+                        }\n+                    }\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of the global map\");\n+        }\n+\n+        // Make sure that we got an unsigned tx\n+        if (!tx) {\n+            throw std::ios_base::failure(\"No unsigned transcation was provided\");\n+        }\n+\n+        // Read input data\n+        unsigned int i = 0;\n+        while (!s.empty() && i < tx->vin.size()) {\n+            PSBTInput input;\n+            s >> input;\n+            inputs.push_back(input);\n+\n+            // Make sure the non-witness utxo matches the outpoint\n+            if (input.non_witness_utxo && input.non_witness_utxo->GetHash() != tx->vin[i].prevout.hash) {\n+                throw std::ios_base::failure(\"Non-witness UTXO does not match outpoint hash\");\n+            }\n+            ++i;\n+        }\n+        // Make sure that the number of inputs matches the number of inputs in the transaction\n+        if (inputs.size() != tx->vin.size()) {\n+            throw std::ios_base::failure(\"Inputs provided does not match the number of inputs in transaction.\");\n+        }\n+\n+        // Read output data\n+        i = 0;\n+        while (!s.empty() && i < tx->vout.size()) {\n+            PSBTOutput output;\n+            s >> output;\n+            outputs.push_back(output);\n+            ++i;\n+        }\n+        // Make sure that the number of outputs matches the number of outputs in the transaction\n+        if (outputs.size() != tx->vout.size()) {\n+            throw std::ios_base::failure(\"Outputs provided does not match the number of outputs in transaction.\");\n+        }\n+        // Sanity check\n+        if (!IsSane()) {\n+            throw std::ios_base::failure(\"PSBT is not sane.\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PartiallySignedTransaction(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** Checks whether a PSBTInput is already signed. */\n+bool PSBTInputSigned(PSBTInput& input);\n+\n+/** Signs a PSBTInput, verifying that all provided data matches what is being signed. */\n+bool SignPSBTInput(const SigningProvider& provider, PartiallySignedTransaction& psbt, int index, int sighash = SIGHASH_ALL);\n+\n+/**\n+ * Finalizes a PSBT if possible, combining partial signatures.\n+ *\n+ * @param[in,out] &psbtx reference to PartiallySignedTransaction to finalize\n+ * return True if the PSBT is now complete, false otherwise\n+ */\n+bool FinalizePSBT(PartiallySignedTransaction& psbtx);\n+\n+/**\n+ * Finalizes a PSBT if possible, and extracts it to a CTransaction if it could be finalized.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255279289",
      "id" : 255279289,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTI3OTI4OQ==",
      "original_commit_id" : "acac678ebe6e105e0a775b6eff37b1583139bf21",
      "original_position" : 556,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 201840933,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255279289",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255286183"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255286183"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In my defense I copied it from ScriptError_t. I'll change it.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-09T03:45:35Z",
      "diff_hunk" : "@@ -0,0 +1,43 @@\n+// Copyright (c) 2017-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NODE_TRANSACTION_H\n+#define BITCOIN_NODE_TRANSACTION_H\n+\n+#include <primitives/transaction.h>\n+#include <uint256.h>\n+\n+typedef enum TransactionError_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255286183",
      "id" : 255286183,
      "in_reply_to_id" : 255279060,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTI4NjE4Mw==",
      "original_commit_id" : "acac678ebe6e105e0a775b6eff37b1583139bf21",
      "original_position" : 11,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 201849264,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255286183",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255286215"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255286215"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, you're right, I think I had to change it for #14906 and forgot to change the comment. Will fix.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-09T03:46:40Z",
      "diff_hunk" : "@@ -0,0 +1,574 @@\n+// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_PSBT_H\n+#define BITCOIN_PSBT_H\n+\n+#include <attributes.h>\n+#include <node/transaction.h>\n+#include <primitives/transaction.h>\n+#include <pubkey.h>\n+#include <script/sign.h>\n+\n+// Magic bytes\n+static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n+\n+// Global types\n+static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+\n+// Input types\n+static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n+static constexpr uint8_t PSBT_IN_WITNESS_UTXO = 0x01;\n+static constexpr uint8_t PSBT_IN_PARTIAL_SIG = 0x02;\n+static constexpr uint8_t PSBT_IN_SIGHASH = 0x03;\n+static constexpr uint8_t PSBT_IN_REDEEMSCRIPT = 0x04;\n+static constexpr uint8_t PSBT_IN_WITNESSSCRIPT = 0x05;\n+static constexpr uint8_t PSBT_IN_BIP32_DERIVATION = 0x06;\n+static constexpr uint8_t PSBT_IN_SCRIPTSIG = 0x07;\n+static constexpr uint8_t PSBT_IN_SCRIPTWITNESS = 0x08;\n+\n+// Output types\n+static constexpr uint8_t PSBT_OUT_REDEEMSCRIPT = 0x00;\n+static constexpr uint8_t PSBT_OUT_WITNESSSCRIPT = 0x01;\n+static constexpr uint8_t PSBT_OUT_BIP32_DERIVATION = 0x02;\n+\n+// The separator is 0x00. Reading this in means that the unserializer can interpret it\n+// as a 0 length key which indicates that this is the separator. The separator has no value.\n+static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n+\n+/** A structure for PSBTs which contain per-input information */\n+struct PSBTInput\n+{\n+    CTransactionRef non_witness_utxo;\n+    CTxOut witness_utxo;\n+    CScript redeem_script;\n+    CScript witness_script;\n+    CScript final_script_sig;\n+    CScriptWitness final_script_witness;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<CKeyID, SigPair> partial_sigs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+    int sighash_type = 0;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTInput& input);\n+    bool IsSane() const;\n+    PSBTInput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the utxo\n+        // If there is a non-witness utxo, then don't add the witness one.\n+        if (non_witness_utxo) {\n+            SerializeToVector(s, PSBT_IN_NON_WITNESS_UTXO);\n+            OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+            SerializeToVector(os, non_witness_utxo);\n+        } else if (!witness_utxo.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_WITNESS_UTXO);\n+            SerializeToVector(s, witness_utxo);\n+        }\n+\n+        if (final_script_sig.empty() && final_script_witness.IsNull()) {\n+            // Write any partial signatures\n+            for (auto sig_pair : partial_sigs) {\n+                SerializeToVector(s, PSBT_IN_PARTIAL_SIG, MakeSpan(sig_pair.second.first));\n+                s << sig_pair.second.second;\n+            }\n+\n+            // Write the sighash type\n+            if (sighash_type > 0) {\n+                SerializeToVector(s, PSBT_IN_SIGHASH);\n+                SerializeToVector(s, sighash_type);\n+            }\n+\n+            // Write the redeem script\n+            if (!redeem_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_REDEEMSCRIPT);\n+                s << redeem_script;\n+            }\n+\n+            // Write the witness script\n+            if (!witness_script.empty()) {\n+                SerializeToVector(s, PSBT_IN_WITNESSSCRIPT);\n+                s << witness_script;\n+            }\n+\n+            // Write any hd keypaths\n+            SerializeHDKeypaths(s, hd_keypaths, PSBT_IN_BIP32_DERIVATION);\n+        }\n+\n+        // Write script sig\n+        if (!final_script_sig.empty()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTSIG);\n+            s << final_script_sig;\n+        }\n+        // write script witness\n+        if (!final_script_witness.IsNull()) {\n+            SerializeToVector(s, PSBT_IN_SCRIPTWITNESS);\n+            SerializeToVector(s, final_script_witness.stack);\n+        }\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_IN_NON_WITNESS_UTXO:\n+                {\n+                    if (non_witness_utxo) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input non-witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Non-witness utxo key is more than one byte type\");\n+                    }\n+                    // Set the stream to unserialize with witness since this is always a valid network transaction\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() & ~SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, non_witness_utxo);\n+                    break;\n+                }\n+                case PSBT_IN_WITNESS_UTXO:\n+                    if (!witness_utxo.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witness utxo already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Witness utxo key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, witness_utxo);\n+                    break;\n+                case PSBT_IN_PARTIAL_SIG:\n+                {\n+                    // Make sure that the key is the size of pubkey + 1\n+                    if (key.size() != CPubKey::PUBLIC_KEY_SIZE + 1 && key.size() != CPubKey::COMPRESSED_PUBLIC_KEY_SIZE + 1) {\n+                        throw std::ios_base::failure(\"Size of key was not the expected size for the type partial signature pubkey\");\n+                    }\n+                    // Read in the pubkey from key\n+                    CPubKey pubkey(key.begin() + 1, key.end());\n+                    if (!pubkey.IsFullyValid()) {\n+                       throw std::ios_base::failure(\"Invalid pubkey\");\n+                    }\n+                    if (partial_sigs.count(pubkey.GetID()) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input partial signature for pubkey already provided\");\n+                    }\n+\n+                    // Read in the signature from value\n+                    std::vector<unsigned char> sig;\n+                    s >> sig;\n+\n+                    // Add to list\n+                    partial_sigs.emplace(pubkey.GetID(), SigPair(pubkey, std::move(sig)));\n+                    break;\n+                }\n+                case PSBT_IN_SIGHASH:\n+                    if (sighash_type > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input sighash type already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Sighash type key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, sighash_type);\n+                    break;\n+                case PSBT_IN_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_IN_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Input witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_IN_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTSIG:\n+                {\n+                    if (!final_script_sig.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptSig already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptSig key is more than one byte type\");\n+                    }\n+                    s >> final_script_sig;\n+                    break;\n+                }\n+                case PSBT_IN_SCRIPTWITNESS:\n+                {\n+                    if (!final_script_witness.IsNull()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, input final scriptWitness already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Final scriptWitness key is more than one byte type\");\n+                    }\n+                    UnserializeFromVector(s, final_script_witness.stack);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default:\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an input map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTInput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A structure for PSBTs which contains per output information */\n+struct PSBTOutput\n+{\n+    CScript redeem_script;\n+    CScript witness_script;\n+    std::map<CPubKey, KeyOriginInfo> hd_keypaths;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+    void FillSignatureData(SignatureData& sigdata) const;\n+    void FromSignatureData(const SignatureData& sigdata);\n+    void Merge(const PSBTOutput& output);\n+    bool IsSane() const;\n+    PSBTOutput() {}\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+        // Write the redeem script\n+        if (!redeem_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_REDEEMSCRIPT);\n+            s << redeem_script;\n+        }\n+\n+        // Write the witness script\n+        if (!witness_script.empty()) {\n+            SerializeToVector(s, PSBT_OUT_WITNESSSCRIPT);\n+            s << witness_script;\n+        }\n+\n+        // Write any hd keypaths\n+        SerializeHDKeypaths(s, hd_keypaths, PSBT_OUT_BIP32_DERIVATION);\n+\n+        // Write unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        s << PSBT_SEPARATOR;\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read loop\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_OUT_REDEEMSCRIPT:\n+                {\n+                    if (!redeem_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output redeemScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output redeemScript key is more than one byte type\");\n+                    }\n+                    s >> redeem_script;\n+                    break;\n+                }\n+                case PSBT_OUT_WITNESSSCRIPT:\n+                {\n+                    if (!witness_script.empty()) {\n+                        throw std::ios_base::failure(\"Duplicate Key, output witnessScript already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Output witnessScript key is more than one byte type\");\n+                    }\n+                    s >> witness_script;\n+                    break;\n+                }\n+                case PSBT_OUT_BIP32_DERIVATION:\n+                {\n+                    DeserializeHDKeypaths(s, key, hd_keypaths);\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                    break;\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of an output map\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PSBTOutput(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** A version of CTransaction with the PSBT format*/\n+struct PartiallySignedTransaction\n+{\n+    boost::optional<CMutableTransaction> tx;\n+    std::vector<PSBTInput> inputs;\n+    std::vector<PSBTOutput> outputs;\n+    std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n+\n+    bool IsNull() const;\n+\n+    /** Merge psbt into this. The two psbts must have the same underlying CTransaction (i.e. the\n+      * same actual Bitcoin transaction.) Returns true if the merge succeeded, false otherwise. */\n+    NODISCARD bool Merge(const PartiallySignedTransaction& psbt);\n+    bool IsSane() const;\n+    PartiallySignedTransaction() {}\n+    PartiallySignedTransaction(const PartiallySignedTransaction& psbt_in) : tx(psbt_in.tx), inputs(psbt_in.inputs), outputs(psbt_in.outputs), unknown(psbt_in.unknown) {}\n+    explicit PartiallySignedTransaction(const CMutableTransaction& tx);\n+\n+    template <typename Stream>\n+    inline void Serialize(Stream& s) const {\n+\n+        // magic bytes\n+        s << PSBT_MAGIC_BYTES;\n+\n+        // unsigned tx flag\n+        SerializeToVector(s, PSBT_GLOBAL_UNSIGNED_TX);\n+\n+        // Write serialized tx to a stream\n+        OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+        SerializeToVector(os, *tx);\n+\n+        // Write the unknown things\n+        for (auto& entry : unknown) {\n+            s << entry.first;\n+            s << entry.second;\n+        }\n+\n+        // Separator\n+        s << PSBT_SEPARATOR;\n+\n+        // Write inputs\n+        for (const PSBTInput& input : inputs) {\n+            s << input;\n+        }\n+        // Write outputs\n+        for (const PSBTOutput& output : outputs) {\n+            s << output;\n+        }\n+    }\n+\n+\n+    template <typename Stream>\n+    inline void Unserialize(Stream& s) {\n+        // Read the magic bytes\n+        uint8_t magic[5];\n+        s >> magic;\n+        if (!std::equal(magic, magic + 5, PSBT_MAGIC_BYTES)) {\n+            throw std::ios_base::failure(\"Invalid PSBT magic bytes\");\n+        }\n+\n+        // Read global data\n+        bool found_sep = false;\n+        while(!s.empty()) {\n+            // Read\n+            std::vector<unsigned char> key;\n+            s >> key;\n+\n+            // the key is empty if that was actually a separator byte\n+            // This is a special case for key lengths 0 as those are not allowed (except for separator)\n+            if (key.empty()) {\n+                found_sep = true;\n+                break;\n+            }\n+\n+            // First byte of key is the type\n+            unsigned char type = key[0];\n+\n+            // Do stuff based on type\n+            switch(type) {\n+                case PSBT_GLOBAL_UNSIGNED_TX:\n+                {\n+                    if (tx) {\n+                        throw std::ios_base::failure(\"Duplicate Key, unsigned tx already provided\");\n+                    } else if (key.size() != 1) {\n+                        throw std::ios_base::failure(\"Global unsigned tx key is more than one byte type\");\n+                    }\n+                    CMutableTransaction mtx;\n+                    // Set the stream to serialize with non-witness since this should always be non-witness\n+                    OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n+                    UnserializeFromVector(os, mtx);\n+                    tx = std::move(mtx);\n+                    // Make sure that all scriptSigs and scriptWitnesses are empty\n+                    for (const CTxIn& txin : tx->vin) {\n+                        if (!txin.scriptSig.empty() || !txin.scriptWitness.IsNull()) {\n+                            throw std::ios_base::failure(\"Unsigned tx does not have empty scriptSigs and scriptWitnesses.\");\n+                        }\n+                    }\n+                    break;\n+                }\n+                // Unknown stuff\n+                default: {\n+                    if (unknown.count(key) > 0) {\n+                        throw std::ios_base::failure(\"Duplicate Key, key for unknown value already provided\");\n+                    }\n+                    // Read in the value\n+                    std::vector<unsigned char> val_bytes;\n+                    s >> val_bytes;\n+                    unknown.emplace(std::move(key), std::move(val_bytes));\n+                }\n+            }\n+        }\n+\n+        if (!found_sep) {\n+            throw std::ios_base::failure(\"Separator is missing at the end of the global map\");\n+        }\n+\n+        // Make sure that we got an unsigned tx\n+        if (!tx) {\n+            throw std::ios_base::failure(\"No unsigned transcation was provided\");\n+        }\n+\n+        // Read input data\n+        unsigned int i = 0;\n+        while (!s.empty() && i < tx->vin.size()) {\n+            PSBTInput input;\n+            s >> input;\n+            inputs.push_back(input);\n+\n+            // Make sure the non-witness utxo matches the outpoint\n+            if (input.non_witness_utxo && input.non_witness_utxo->GetHash() != tx->vin[i].prevout.hash) {\n+                throw std::ios_base::failure(\"Non-witness UTXO does not match outpoint hash\");\n+            }\n+            ++i;\n+        }\n+        // Make sure that the number of inputs matches the number of inputs in the transaction\n+        if (inputs.size() != tx->vin.size()) {\n+            throw std::ios_base::failure(\"Inputs provided does not match the number of inputs in transaction.\");\n+        }\n+\n+        // Read output data\n+        i = 0;\n+        while (!s.empty() && i < tx->vout.size()) {\n+            PSBTOutput output;\n+            s >> output;\n+            outputs.push_back(output);\n+            ++i;\n+        }\n+        // Make sure that the number of outputs matches the number of outputs in the transaction\n+        if (outputs.size() != tx->vout.size()) {\n+            throw std::ios_base::failure(\"Outputs provided does not match the number of outputs in transaction.\");\n+        }\n+        // Sanity check\n+        if (!IsSane()) {\n+            throw std::ios_base::failure(\"PSBT is not sane.\");\n+        }\n+    }\n+\n+    template <typename Stream>\n+    PartiallySignedTransaction(deserialize_type, Stream& s) {\n+        Unserialize(s);\n+    }\n+};\n+\n+/** Checks whether a PSBTInput is already signed. */\n+bool PSBTInputSigned(PSBTInput& input);\n+\n+/** Signs a PSBTInput, verifying that all provided data matches what is being signed. */\n+bool SignPSBTInput(const SigningProvider& provider, PartiallySignedTransaction& psbt, int index, int sighash = SIGHASH_ALL);\n+\n+/**\n+ * Finalizes a PSBT if possible, combining partial signatures.\n+ *\n+ * @param[in,out] &psbtx reference to PartiallySignedTransaction to finalize\n+ * return True if the PSBT is now complete, false otherwise\n+ */\n+bool FinalizePSBT(PartiallySignedTransaction& psbtx);\n+\n+/**\n+ * Finalizes a PSBT if possible, and extracts it to a CTransaction if it could be finalized.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255286215",
      "id" : 255286215,
      "in_reply_to_id" : 255279289,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTI4NjIxNQ==",
      "original_commit_id" : "acac678ebe6e105e0a775b6eff37b1583139bf21",
      "original_position" : 556,
      "path" : "src/psbt.h",
      "position" : null,
      "pull_request_review_id" : 201849295,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255286215",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255298221"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255298221"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should be `enum class`?",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-09T13:05:41Z",
      "diff_hunk" : "@@ -0,0 +1,43 @@\n+// Copyright (c) 2017-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NODE_TRANSACTION_H\n+#define BITCOIN_NODE_TRANSACTION_H\n+\n+#include <primitives/transaction.h>\n+#include <uint256.h>\n+\n+enum TransactionError {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255298221",
      "id" : 255298221,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTI5ODIyMQ==",
      "original_commit_id" : "9f2297d4decb3c6a19a74945696acae573ac2bd0",
      "original_position" : 11,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 201862403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255298221",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255323007"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255323007"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, I've never used that before but it looks cool.\r\n\r\nIt looks like if I made that change, all references to the enum constants would have to be qualified with the name of the enum? So I should remove all the TRANSACTION_ERR prefixes, so e.g. TRANSACTION_ERR_MISSING_INPUTS would become TransactionError::MISSING_INPUTS?\r\n\r\nI'm always in favor of adding more compile-time checks when it's easy, so I'm happy to make the change if that's the preferred approach.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-10T04:18:05Z",
      "diff_hunk" : "@@ -0,0 +1,43 @@\n+// Copyright (c) 2017-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NODE_TRANSACTION_H\n+#define BITCOIN_NODE_TRANSACTION_H\n+\n+#include <primitives/transaction.h>\n+#include <uint256.h>\n+\n+enum TransactionError {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255323007",
      "id" : 255323007,
      "in_reply_to_id" : 255298221,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTMyMzAwNw==",
      "original_commit_id" : "9f2297d4decb3c6a19a74945696acae573ac2bd0",
      "original_position" : 11,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 201887918,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255323007",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255323715"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255323715"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated.",
      "commit_id" : "102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-10T05:10:12Z",
      "diff_hunk" : "@@ -0,0 +1,43 @@\n+// Copyright (c) 2017-2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NODE_TRANSACTION_H\n+#define BITCOIN_NODE_TRANSACTION_H\n+\n+#include <primitives/transaction.h>\n+#include <uint256.h>\n+\n+enum TransactionError {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#discussion_r255323715",
      "id" : 255323715,
      "in_reply_to_id" : 255298221,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTMyMzcxNQ==",
      "original_commit_id" : "9f2297d4decb3c6a19a74945696acae573ac2bd0",
      "original_position" : 11,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 201888717,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14978",
      "updated_at" : "2019-02-11T22:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/255323715",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-utACK 6097ae0, main changes since my last review:\r\n* moved `BroadcastTransaction` to `src/node` instead of `src/wallet/transaction.cpp`, because it's not a wallet thing.\r\n* switched away from exceptions d988f06\r\n* `CombinePSBTs` now returns boolean and has an `&out` and `&error` param",
      "created_at" : "2019-02-10T15:52:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-462144019",
      "id" : 462144019,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MjE0NDAxOQ==",
      "updated_at" : "2019-02-10T15:52:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/462144019",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased.",
      "created_at" : "2019-02-11T22:23:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-462519173",
      "id" : 462519173,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MjUxOTE3Mw==",
      "updated_at" : "2019-02-11T22:23:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/462519173",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Can 1-2 people who already acked, but haven't looked in awhile, take a quick look and give a reack? I do not expect further changes unless I am forced to rebase again.",
      "created_at" : "2019-02-14T02:32:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-463461849",
      "id" : 463461849,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MzQ2MTg0OQ==",
      "updated_at" : "2019-02-14T02:32:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/463461849",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 102faad81efa1cb12c29c466cfe81fc8c7351e1d",
      "created_at" : "2019-02-14T03:28:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-463473599",
      "id" : 463473599,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MzQ3MzU5OQ==",
      "updated_at" : "2019-02-14T03:28:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/463473599",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gwillen thanks for being so proactive with addressing review comments :)",
      "created_at" : "2019-02-14T08:47:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14978#issuecomment-463543262",
      "id" : 463543262,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14978",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2MzU0MzI2Mg==",
      "updated_at" : "2019-02-14T08:47:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/463543262",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   }
]
