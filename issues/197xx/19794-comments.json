[
   {
      "author_association" : "MEMBER",
      "body" : "concept ACK",
      "created_at" : "2020-08-24T21:54:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-679386340",
      "id" : 679386340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3OTM4NjM0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-24T21:54:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/679386340",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #17785 (p2p: Unify Send and Receive protocol versions by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-08-25T07:20:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-679851573",
      "id" : 679851573,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3OTg1MTU3Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-03T19:59:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/679851573",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the review! I pushed an update, implementing both style suggestions and copying the PR description into the commit message.",
      "created_at" : "2020-08-25T20:32:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-680254918",
      "id" : 680254918,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MDI1NDkxOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-25T20:33:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/680254918",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK ef9855580098654cdfc5844f8922518e6602878f.\r\n\r\nIt's good to get rid of the useless code. Even though it's only a couple lines, the burden of this variable is massive: I spent 10 minutes figuring what does it do, even after reading the PR description.\r\n\r\nI tried to make sure we don't miss any corner cases, and I think this PR works correctly.\r\n\r\nRegarding your commit message:\r\n>2.) If the response to GETADDR is small  (<=10 addresses), it will be relayed to peers just as any other ADDR message of that size.\r\n\r\nI'm not sure it's a bug in master. I always thought of `<=10` check as something to limit the forwarding of unsolicited ADDRs. Now it may also forward a solicited ADDR. May it leak privacy somehow? I guess not, because we don't send them out immediately anyway.\r\n\r\n----------\r\n\r\nAs a side note, is this possible?\r\n1. Victim node V starts and connects to their peers\r\n2. An attacker spams V with a lot of unsolicited ADDR messages (of size <10 but from different Sybils) to make sure all ADDRs V sends to their peers is of size 11 at least.\r\n3. V's self-announcements (and other unsolicited ADDRs from V) are never forwarded by their peers, so only immediate peers ever learn about V.\r\n\r\nThis PR doesn't address this issue as a whole, but it removes one out of two mechanisms making this possible I believe :)\r\nI think we should look further and see if we can fix it in full, perhaps in another PR.",
      "created_at" : "2020-08-26T11:56:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-680833892",
      "id" : 680833892,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MDgzMzg5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-26T11:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/680833892",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'm not sure it's a bug in master. I always thought of <=10 check as something to limit the forwarding of unsolicited ADDRs. Now it may also forward a solicited ADDR. May it leak privacy somehow? I guess not, because we don't send them out immediately anyway.\r\n\r\nI just wanted to note that it is a small change in behaviour, not sure if it is a bug. In any case, I don't think that this will occur often, because with `MAX_PCT_ADDR_TO_SEND = 23` it would mean that an honest peer would need to have a really small addrman with less than 50 addresses  to send such a small response - usually, GETADDR responses should be considerably larger.\r\n\r\nRegarding your scenario:\r\nI think this is a very interesting scenario and probably worth addressing (V's address  could still be part of a GETADDR response though, even if it not forwarded).\r\nI don't see though how this PR helps with this even a little. On current master, `fGetAddr` is set in the VERSION processing with an outbound peer, and immediately unset as soon as we get a single ADDR with size < 1000 from the peer (and can never be set again for the duration of the connection) - while your scenario entails repeated messages.\r\n ",
      "created_at" : "2020-08-26T22:22:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-681154335",
      "id" : 681154335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MTE1NDMzNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-26T22:22:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/681154335",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Though I had an idea what it was for, I don't think I've ever thoroughly understood this flag. Thanks for the explanation and ACK on removing it.\r\nACK ef9855580098654cdfc5844f8922518e6602878f",
      "created_at" : "2020-08-27T11:36:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-681893374",
      "id" : 681893374,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MTg5MzM3NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-27T11:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/681893374",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK the code changes in ef9855580098654cdfc5844f8922518e6602878f\r\n\r\nIf you touch this again, could you line-wrap the body of your commit log at 80 chars? (also no need to credit me in the commit log - this is your work!)",
      "created_at" : "2020-09-01T08:47:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-684594748",
      "id" : 684594748,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NDU5NDc0OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-01T08:47:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/684594748",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-09-03T13:20:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-686485791",
      "id" : 686485791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NjQ4NTc5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-03T13:20:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/686485791",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "strong concept ACK! thank you! that variable is a distraction.",
      "created_at" : "2020-09-03T15:21:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-686565903",
      "id" : 686565903,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NjU2NTkwMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-03T15:21:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/686565903",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased and reformatted the commit message as suggested by @jnewbery .",
      "created_at" : "2020-09-03T18:51:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-686693103",
      "id" : 686693103,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NjY5MzEwMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-03T18:51:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/686693103",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK d3eaaf40541d1ef7b64bdc354c5ac23c3ad9c9e2\r\n\r\n---------------\r\n\r\nAnother behavior change, or rather an elaboration over \"If the response to GETADDR is small (<=10 addresses), it will be relayed to peers just as any other ADDR message of that size.\"\r\n\r\n1. We just connected to the peer and send them a `GETADDR`\r\n2. Before getting `GETADDR`, they schedule their self-announcement for us by adding their addr to vAddrToSend\r\n3. Their ADDR sending is triggered (see `pto->m_next_addr_send < current_time`)\r\n4. *We receive their self-announcement containing only 1 addr and ~~keep fGetAddr=true~~ set fGetAddr=false*\r\n5. They finally receive our `GETADDR` and schedule their response (can be flipped with (4))\r\n\r\nI think this order of events is unlikely (need much luck for (3) to happen before (5)) but possible.\r\n\r\nIn that case,\r\n- before this PR, we would not forward their self-announcement, because `fGetAddr=true` at the time we receive it (we update it right at the end of processing it)\r\n- after this PR, we would forward their self-announcement\r\n\r\nI think this is actually an improvement. I don't see any reason to withhold an initial announcement of the peer instead of forwarding it to other nodes.\r\n\r\nEven if this had any privacy benefits as a side-effect (e.g., somehow less revealing of new connections), it had a very low chance of working. Maybe this should be a real feature tho.",
      "created_at" : "2020-09-04T06:55:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-686953704",
      "id" : 686953704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4Njk1MzcwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T10:50:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/686953704",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK d3eaaf40541d1ef7b64bdc354c5ac23c3ad9c9e2",
      "created_at" : "2020-09-04T07:39:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-686973215",
      "id" : 686973215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4Njk3MzIxNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-04T07:39:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/686973215",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK d3eaaf4054 \r\n\r\nCI failures look unrelated. ",
      "created_at" : "2020-09-04T23:23:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-687463182",
      "id" : 687463182,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NzQ2MzE4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-04T23:23:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687463182",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> since #5419, we do not get more than one ADDR message in response to GETADDR because vAddrToSend cannot have more than 1000 elements.\r\n\r\nIf I'm understanding you correctly, you're saying that we can't get more than one ADDR message in response because our own software wouldn't do it.  But what about other software on the network?\r\n\r\nAt any rate, I think the reason we have this variable is to track whether an ADDR message is likely in response to a getaddr message we send, in which case we don't want to relay the learned addresses to other peers, or if an addr message is an unsolicited relay from our peer, in which case we also want to try to relay.  (The reason to not relay messages with more than 10 entries is to rate limit the addr relay, so that a spammer can't use up all the network's bandwidth by blasting out addr messages.)\r\n\r\nI think one downside to relaying getaddr responses is a privacy leak - if you started up with a small addrman, and learned only a small set of nodes to connect to from one peer (and relayed that whole thing to another peer), that other peer might have a pretty good idea of who you're going to be connecting to.\r\n\r\nAnyway I'd be hesitant to remove this bool without talking through how we view this scenario, as it seems odd to me to relay addresses that are in response to a getaddr message, since we expect those to be of a very different nature than unsolicited addresses being relayed to us, which you expect to be originating with some peer announcing itself.  (I wish the response to a getaddr was a different message type than an unsolicited address being relayed to us!)",
      "created_at" : "2020-09-04T23:49:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-687476649",
      "id" : 687476649,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NzQ3NjY0OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-04T23:49:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687476649",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sdaftuar hmm interesting, I'm trying to evaluate this concern, do I have the scenario right: \r\n- Node A starts up, connects to Node B \r\n- When Node A receives the `VERSION` message, it sends a `GETADDR` message to Node B \r\n- Node B has an addrman with < 43 addresses, fulfills the request, sends back 9 addresses randomly selected from its addrman (based on 23 percent calculation)\r\n- Node A receives an ADDR message with 9 addresses, passes misc checks in `ProcessMessage`, invokes `RelayAddress`, which then sends it out to 1 or 2 nodes? (if I'm understanding the role of `nRelayNodes` correctly), including Node C \r\n\r\nand then your concern is at this point, that Node C is able to deduce private information? the connection between Node A and Node B? or more generally what Node A's options for connections are? ",
      "created_at" : "2020-09-05T00:28:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-687490594",
      "id" : 687490594,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NzQ5MDU5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-05T00:28:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687490594",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I just realized that `fGetAddr` seems to be completely broken/ineffective after setting up a node with extra logging for `fGetAddr` on mainnet with current master:\r\n\r\nThe problem is that the first ADDR we receive in the lifetime of a typical connection is the initial self-announcement of our peer! After receiving this ADDR message of size 1, `fGetAddr` will be cleared - it wasn't active a single time by the time I received the actual GETADDR response from a peer. This is exactly what @naumenkogs  described in his earlier comment (https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-686953704), however it is not rare because `m_next_addr_send` is 0 initially.\r\n\r\nTherefore, what this flag currently seems to do is prevent initial self-announcements of outbound peers from being relayed to other peers.\r\n\r\nI'll update the PR description with above info later this weekend and will also address @sdaftuar's comment - marking the PR as Draft until then.",
      "created_at" : "2020-09-05T07:02:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-687563344",
      "id" : 687563344,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NzU2MzM0NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-05T08:01:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687563344",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I just realized that fGetAddr seems to be completely broken/ineffective after setting up a node with extra logging for fGetAddr on mainnet with current master...\r\n\r\nWow, good observation. So, this flag doesn't even do what it was introduced for. Strong ACK on improving the comments/logic here, but I also still think removing it entirely is fine. Our \"don't relay getaddr responses\" logic is enforced by the `vAddr.size() <= 10` clause.",
      "created_at" : "2020-09-05T09:38:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-687580019",
      "id" : 687580019,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NzU4MDAxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-05T09:38:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687580019",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "To elaborate on my last comment: The typical behavior seems to be that in the first `SendMessages()` loop after being successfullyÂ connected, our peer will self-advertise (becauseÂ `m_next_local_addr_send == 0`  initially) and send us an ADDR without further delayÂ  (becauseÂ `m_next_addr_send == 0` initially), sending the GETADDR response later. It probably depends on the timing of when the VERACK vs. GETADDR messages are received by our peer, but from my node logs, this is the order of events in almost all cases.\r\n\r\nSo I think that there are now two separate issues:\r\n1.) Considering that thisÂ flag mainly prevents initial self-announcements from being gossip-relayed and seems to have little to no interaction with GETADDR: Should we embrace this unintended change in behavior and rename the flag to `fDontRelayInitialSelfAnnouncements` or similar? AsÂ @naumenkogs above, I don't really see a good reason toÂ do this.\r\n\r\n2.)Â Even though `fGetAddr` doesn't seem to work as intended, @sdaftuar's privacy concerns still poses the question if there should be some mechanism suppressing relay of GETADDR answers beyond the `vAddr.size() <= 10 `limit. I think that it should be an extremely rare event for our outbound peer to have an addrman with < 43 addresses. Even starting with an empty addrman and querying some DNS seeds should get us over that limit, which should be no issue after having completed the first GETADDR interaction with a typical outbound peer. So I am not sure how realistic the scenario is.\r\n\r\nI think it might be more problematic for privacy _sending_ GETADDR responses < 1000, because we communicate the size of our addrman (via 23% factor) and signal that we might be susceptive to an eclipse attack if our addrman is small.\r\n\r\nI'll update the commit message and the PR description (will leave the originally assumed changes in behavior in for now, because they were quoted in this discussion).\r\n",
      "created_at" : "2020-09-06T22:02:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-687913615",
      "id" : 687913615,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NzkxMzYxNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T10:38:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687913615",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 628812a34ea0d6ac6ed17abaa06fb8e4758c4c5f",
      "created_at" : "2020-09-07T09:07:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-688184042",
      "id" : 688184042,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODE4NDA0Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T09:07:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688184042",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "So there are 2 issues pointed out by sdaftuar, I'd consider them separately:\r\n\r\n1. Privacy of a Bitcoin Core node with few AddrMan records making a new connection to a Bitcoin Core node.\r\nI agree with the concern, but according to mzumsande experiments above, the `fGetAddr` flag is ineffective here, so we already have this problem. The problem probably should be addressed in a different PR. If we can't come up with something better, we always can expand `ADDR` message to say it's unsolicited (not `GETADDR` response), I don't see any (privacy) issues with it.\r\n\r\n2. Some other software on the network. The right thing here would be to consider *all* more or less reasonable scenarios of the communication between our Bitcoin Core node and other software. For example, if that software don't self-advertise at all, it *will* actually get the privacy benefit described in (1), because `fGetAddr` flag won't be cleared on initial self-ad. Now, maybe that software relied on this privacy benefit? (I doubt though).\r\n\r\nI'm leaning towards reACK, but before that I'd rather us make some efforts to make sure (2) is not a concern (maybe an ML post is sufficient).",
      "created_at" : "2020-09-08T07:53:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-688689687",
      "id" : 688689687,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODY4OTY4Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T07:53:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688689687",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Actually, `fGetAddr` as currently working (set to `false` after initial peer's self-ad) are protecting the initial self-ad from the privacy leak I've pointed out [here](https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-686953704). But I'd repeat that this feature should be made explicit in a follow-up rather than a random side-effect.",
      "created_at" : "2020-09-08T09:53:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-688757750",
      "id" : 688757750,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODc1Nzc1MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T09:53:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688757750",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@naumenkogs , I don't understand this:\r\n\r\n> 4. We receive their self-announcement containing only 1 addr and keep fGetAddr=true\r\n\r\nWhy would fGetAddr stay as true? I think it's flipped to false in this scenario.",
      "created_at" : "2020-09-08T10:37:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-688781562",
      "id" : 688781562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODc4MTU2Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T10:37:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688781562",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery this was a mistake (see I updated it), but the example remains valid. ",
      "created_at" : "2020-09-08T10:50:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-688788045",
      "id" : 688788045,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODc4ODA0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T10:50:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688788045",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rather than remove the `fGetAddr` flag, what do you think about improving our behavior instead on the other end, eg by my suggestion [here](https://github.com/bitcoin/bitcoin/issues/19694#issuecomment-671438244) to delay the initial addr message we send out to inbound peers in order to mitigate the ambiguity between the response to an initial `getaddr` and the advertising of the peer's own address?",
      "created_at" : "2020-09-10T23:20:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-690781832",
      "id" : 690781832,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDc4MTgzMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T23:20:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690781832",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sdaftuar \r\n>Rather than remove the fGetAddr flag, what do you think about improving our behavior instead on the other end, eg by my suggestion here to delay the initial addr message we send out to inbound peers in order to mitigate the ambiguity between the response to an initial getaddr and the advertising of the peer's own address?\r\n\r\nI'm not 100% persuaded that `fGetAddr` better stays (the only valid justification I see at the moment is potentially breaking other software?), but I think this idea would make the flag work as intended.",
      "created_at" : "2020-09-11T13:57:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-691110899",
      "id" : 691110899,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MTExMDg5OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-11T13:57:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691110899",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm not 100% persuaded that fGetAddr better stays (the only valid justification I see at the moment is potentially breaking other software?), but I think this idea would make the flag work as intended.\r\n\r\nIt seems like it should be a reasonably good guess that if you send someone a `getaddr`, the next `addr` you get is probably in response.  However, since we send out a `getaddr` to outbound peers on connection, and because we send out an addr for ourselves to inbound peers, also usually on connection, we've created a natural race condition between nodes running our same software.\r\n\r\nFixing that race condition (usually) for our own software is pretty easy; and that then reduces the question posed by this PR to \"is it important to keep track of when an addr message is in response to a getaddr, or not?\"  And I tend to think that the answer is probably yes; although addr relay is not something specified in any BIPs, it makes sense to me that responses to a `getaddr` are of a different quality than general addr-relay, so we might as well try to detect those situations when reasonably possible and relay differently.  \r\n\r\nAs for what other software might exist: in addition to other full-node implementations out there, I think the dns seednodes can be used as addr-fetch peers by Bitcoin Core, in some situations?  I haven't tried to exercise it carefully, but my understanding is that the seednodes are custom software, which potentially differ from each other and from Bitcoin Core.\r\n",
      "created_at" : "2020-09-11T16:10:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-691184578",
      "id" : 691184578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MTE4NDU3OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-11T16:10:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691184578",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Rather than remove the fGetAddr flag, what do you think about improving our behavior instead on the other end.\r\n\r\nIn this case, I think that we should change the `if (vAddr.size() < 1000) pfrom.fGetAddr = false;` condition which, in the typical case of receiving a single GETADDR answer of size 1000, prevents us from relaying the next ADDR message of our peer, even though this one would not be related to the GETADDR interaction at all.\r\n\r\nI think of `fGetAddr` as an heuristic machanism meant to cover the typical case (obviously it does not help at all with adversarial situations), so I think it is justified to adapt it, if the typical case has changed a long time ago - especially if we have a second mechanism (size limit <=10) preventing GETADDR answer relay, which, even though not direct, seems less fragile in many respects compared to a timing-based one.\r\n",
      "created_at" : "2020-09-11T17:32:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-691222888",
      "id" : 691222888,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MTIyMjg4OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-11T17:32:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691222888",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> In this case, I think that we should change the if (vAddr.size() < 1000) pfrom.fGetAddr = false; condition which, in the typical case of receiving a single GETADDR answer of size 1000, prevents us from relaying the next ADDR message of our peer, even though this one would not be related to the GETADDR interaction at all.\r\n\r\nYes, I agree that makes sense and better matches what we typically are seeing on the network.",
      "created_at" : "2020-09-11T17:47:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-691229674",
      "id" : 691229674,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MTIyOTY3NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-11T17:47:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691229674",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok - I will open a PR in the next days for that. Will close this one and link it from the new one, because it would become a bit  confusing with another change in the PR description and discussion referring to old versions.",
      "created_at" : "2020-09-15T19:02:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-692916364",
      "id" : 692916364,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjkxNjM2NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-15T19:02:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692916364",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There is some more discussion here, BTW: https://github.com/bitcoin/bips/pull/907",
      "created_at" : "2020-09-15T19:04:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-692917320",
      "id" : 692917320,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MjkxNzMyMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-15T19:04:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692917320",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
