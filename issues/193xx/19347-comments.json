[
   {
      "author_association" : "MEMBER",
      "body" : "@hebasto : you seem to be on a mutex-cleaning spree. Perhaps you'd be interested in this?",
      "created_at" : "2020-06-21T13:24:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-647128075",
      "id" : 647128075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzEyODA3NQ==",
      "updated_at" : "2020-06-21T13:24:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647128075",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Made a link here from the tracking issue #19303.",
      "created_at" : "2020-06-21T13:30:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-647128751",
      "id" : 647128751,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzEyODc1MQ==",
      "updated_at" : "2020-06-21T13:30:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647128751",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443231429"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443231429"
         }
      },
      "author_association" : "MEMBER",
      "body" : "From commit message\r\n> Therefore, cs_inventory can never be locked when the TRY_LOCK(cs_inventory) is reached in DisconnectNodes(). Remove the TRY_LOCK.\r\n\r\nI understand that `if (lockInv)` is never true, and the code block `TRY_LOCK(pnode->cs_vSend, lockSend); ...` is dead in master. This commit makes this code always reachable, right?",
      "commit_id" : "e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-06-21T15:38:16Z",
      "diff_hunk" : "@@ -1103,12 +1103,9 @@ void CConnman::DisconnectNodes()\n             if (pnode->GetRefCount() <= 0) {\n                 bool fDelete = false;\n                 {\n-                    TRY_LOCK(pnode->cs_inventory, lockInv);\n-                    if (lockInv) {\n-                        TRY_LOCK(pnode->cs_vSend, lockSend);\n-                        if (lockSend) {\n-                            fDelete = true;\n-                        }\n+                    TRY_LOCK(pnode->cs_vSend, lockSend);\n+                    if (lockSend) {\n+                        fDelete = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443231429",
      "id" : 443231429,
      "line" : 1108,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzMTQyOQ==",
      "original_commit_id" : "8c372dd1cc1efbb6b968b06c0c4d70441bf65aef",
      "original_line" : 1108,
      "original_position" : 12,
      "original_start_line" : 1106,
      "path" : "src/net.cpp",
      "position" : 12,
      "pull_request_review_id" : 434511606,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347",
      "side" : "RIGHT",
      "start_line" : 1106,
      "start_side" : "LEFT",
      "updated_at" : "2020-06-23T12:50:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443231429",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443234173"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443234173"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the comment says \"Therefore, cs_inventory can never be locked *by another thread* ...\", so it is always true (success).",
      "commit_id" : "e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-06-21T16:11:49Z",
      "diff_hunk" : "@@ -1103,12 +1103,9 @@ void CConnman::DisconnectNodes()\n             if (pnode->GetRefCount() <= 0) {\n                 bool fDelete = false;\n                 {\n-                    TRY_LOCK(pnode->cs_inventory, lockInv);\n-                    if (lockInv) {\n-                        TRY_LOCK(pnode->cs_vSend, lockSend);\n-                        if (lockSend) {\n-                            fDelete = true;\n-                        }\n+                    TRY_LOCK(pnode->cs_vSend, lockSend);\n+                    if (lockSend) {\n+                        fDelete = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443234173",
      "id" : 443234173,
      "in_reply_to_id" : 443231429,
      "line" : 1108,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNDE3Mw==",
      "original_commit_id" : "8c372dd1cc1efbb6b968b06c0c4d70441bf65aef",
      "original_line" : 1108,
      "original_position" : 12,
      "original_start_line" : 1106,
      "path" : "src/net.cpp",
      "position" : 12,
      "pull_request_review_id" : 434513971,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347",
      "side" : "RIGHT",
      "start_line" : 1106,
      "start_side" : "LEFT",
      "updated_at" : "2020-06-23T12:50:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443234173",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443235694"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443235694"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sorry, you're right that this commit message is unclear. Marco is correct that I meant \"cs_inventory can never be locked by another thread\". I'll update the commit message.",
      "commit_id" : "e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-06-21T16:31:28Z",
      "diff_hunk" : "@@ -1103,12 +1103,9 @@ void CConnman::DisconnectNodes()\n             if (pnode->GetRefCount() <= 0) {\n                 bool fDelete = false;\n                 {\n-                    TRY_LOCK(pnode->cs_inventory, lockInv);\n-                    if (lockInv) {\n-                        TRY_LOCK(pnode->cs_vSend, lockSend);\n-                        if (lockSend) {\n-                            fDelete = true;\n-                        }\n+                    TRY_LOCK(pnode->cs_vSend, lockSend);\n+                    if (lockSend) {\n+                        fDelete = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443235694",
      "id" : 443235694,
      "in_reply_to_id" : 443231429,
      "line" : 1108,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNTY5NA==",
      "original_commit_id" : "8c372dd1cc1efbb6b968b06c0c4d70441bf65aef",
      "original_line" : 1108,
      "original_position" : 12,
      "original_start_line" : 1106,
      "path" : "src/net.cpp",
      "position" : 12,
      "pull_request_review_id" : 434515339,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347",
      "side" : "RIGHT",
      "start_line" : 1106,
      "start_side" : "LEFT",
      "updated_at" : "2020-06-23T12:50:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443235694",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443236860"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443236860"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've made the commit log clearer.",
      "commit_id" : "e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-06-21T16:46:01Z",
      "diff_hunk" : "@@ -1103,12 +1103,9 @@ void CConnman::DisconnectNodes()\n             if (pnode->GetRefCount() <= 0) {\n                 bool fDelete = false;\n                 {\n-                    TRY_LOCK(pnode->cs_inventory, lockInv);\n-                    if (lockInv) {\n-                        TRY_LOCK(pnode->cs_vSend, lockSend);\n-                        if (lockSend) {\n-                            fDelete = true;\n-                        }\n+                    TRY_LOCK(pnode->cs_vSend, lockSend);\n+                    if (lockSend) {\n+                        fDelete = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443236860",
      "id" : 443236860,
      "in_reply_to_id" : 443231429,
      "line" : 1108,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIzNjg2MA==",
      "original_commit_id" : "8c372dd1cc1efbb6b968b06c0c4d70441bf65aef",
      "original_line" : 1108,
      "original_position" : 12,
      "original_start_line" : 1106,
      "path" : "src/net.cpp",
      "position" : 12,
      "pull_request_review_id" : 434516356,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347",
      "side" : "RIGHT",
      "start_line" : 1106,
      "start_side" : "LEFT",
      "updated_at" : "2020-06-23T12:50:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443236860",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "nit: s/`cs_inventory`/`m_inventory_mutex`/",
      "created_at" : "2020-06-21T18:30:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-647164281",
      "id" : 647164281,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzE2NDI4MQ==",
      "updated_at" : "2020-06-21T18:30:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647164281",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> nit: s/cs_inventory/m_inventory_mutex\r\n\r\nI agree! I'm planning to move this mutex into net processing where it belongs. I'll do the rename at the same time. See https://github.com/jnewbery/bitcoin/commits/2020-06-cs-main-split",
      "created_at" : "2020-06-21T18:36:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-647164961",
      "id" : 647164961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzE2NDk2MQ==",
      "updated_at" : "2020-06-21T18:36:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647164961",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443754624"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443754624"
         }
      },
      "author_association" : "MEMBER",
      "body" : "When doing this anyway, woulid it make sense to move this lock outside the (inner) loop? Re-taking it for every `node Ã every block` seems overkill.",
      "commit_id" : "e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-06-22T18:40:31Z",
      "diff_hunk" : "@@ -1330,7 +1330,7 @@ void PeerLogicValidation::UpdatedBlockTip(const CBlockIndex *pindexNew, const CB\n         connman->ForEachNode([nNewHeight, &vHashes](CNode* pnode) {\n             if (nNewHeight > (pnode->nStartingHeight != -1 ? pnode->nStartingHeight - 2000 : 0)) {\n                 for (const uint256& hash : reverse_iterate(vHashes)) {\n-                    pnode->PushBlockHash(hash);\n+                    WITH_LOCK(pnode->cs_inventory, pnode->vBlockHashesToAnnounce.push_back(hash));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443754624",
      "id" : 443754624,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc1NDYyNA==",
      "original_commit_id" : "e335e4fcc881260906fb561f23a1b5017ed04d91",
      "original_line" : 1333,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 435181578,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-23T12:50:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443754624",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443782058"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443782058"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good idea. Done.",
      "commit_id" : "e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-06-22T19:36:48Z",
      "diff_hunk" : "@@ -1330,7 +1330,7 @@ void PeerLogicValidation::UpdatedBlockTip(const CBlockIndex *pindexNew, const CB\n         connman->ForEachNode([nNewHeight, &vHashes](CNode* pnode) {\n             if (nNewHeight > (pnode->nStartingHeight != -1 ? pnode->nStartingHeight - 2000 : 0)) {\n                 for (const uint256& hash : reverse_iterate(vHashes)) {\n-                    pnode->PushBlockHash(hash);\n+                    WITH_LOCK(pnode->cs_inventory, pnode->vBlockHashesToAnnounce.push_back(hash));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r443782058",
      "id" : 443782058,
      "in_reply_to_id" : 443754624,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc4MjA1OA==",
      "original_commit_id" : "e335e4fcc881260906fb561f23a1b5017ed04d91",
      "original_line" : 1333,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 435217067,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-23T12:50:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443782058",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Does the recent [change](https://github.com/bitcoin/bitcoin/compare/eaced81501f035193523d1abde4569dfc73ae327..6db15a8b79597a0f311490acd89ee50db298c6e8) decrease concurrentness of the code? It seems like a premature optimization a bit, no?",
      "created_at" : "2020-06-22T21:03:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-647768365",
      "id" : 647768365,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0Nzc2ODM2NQ==",
      "updated_at" : "2020-06-22T21:03:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647768365",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Does the recent change decrease concurrentness of the code?\r\n\r\nI think it's fine to expand the lock scope:\r\n\r\n- it's _extremely_ unlikely that this'll increase contention for this lock. `UpdatedBlockTip()` is only called once every ten minutes on average, it's very unlikely that it'll push two block hashes onto the `vBlockHashesToAnnounce` vector (only if there's a re-org), and the time it takes to push an extra hash onto the vector is tiny.\r\n- in the very unlikely case we do block the other thread, it's probably an improvement. Rather than sending one hash in a headers message to the peer, and then another hash in a second headers message, we'll send both in the same message.",
      "created_at" : "2020-06-22T21:44:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-647784842",
      "id" : 647784842,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0Nzc4NDg0Mg==",
      "updated_at" : "2020-06-22T21:44:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647784842",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r444087873"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/444087873"
         }
      },
      "author_association" : "MEMBER",
      "body" : "e335e4fcc881260906fb561f23a1b5017ed04d91\r\n\r\nThe suggestion was done in 6db15a8b79597a0f311490acd89ee50db298c6e8, but IMO should be in e335e4fcc881260906fb561f23a1b5017ed04d91.",
      "commit_id" : "e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-06-23T09:26:06Z",
      "diff_hunk" : "@@ -1330,7 +1330,7 @@ void PeerLogicValidation::UpdatedBlockTip(const CBlockIndex *pindexNew, const CB\n         connman->ForEachNode([nNewHeight, &vHashes](CNode* pnode) {\n             if (nNewHeight > (pnode->nStartingHeight != -1 ? pnode->nStartingHeight - 2000 : 0)) {\n                 for (const uint256& hash : reverse_iterate(vHashes)) {\n-                    pnode->PushBlockHash(hash);\n+                    WITH_LOCK(pnode->cs_inventory, pnode->vBlockHashesToAnnounce.push_back(hash));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r444087873",
      "id" : 444087873,
      "in_reply_to_id" : 443754624,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA4Nzg3Mw==",
      "original_commit_id" : "e335e4fcc881260906fb561f23a1b5017ed04d91",
      "original_line" : 1333,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 435603559,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-23T12:50:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/444087873",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r444197371"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/444197371"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-06-23T12:50:16Z",
      "diff_hunk" : "@@ -1330,7 +1330,7 @@ void PeerLogicValidation::UpdatedBlockTip(const CBlockIndex *pindexNew, const CB\n         connman->ForEachNode([nNewHeight, &vHashes](CNode* pnode) {\n             if (nNewHeight > (pnode->nStartingHeight != -1 ? pnode->nStartingHeight - 2000 : 0)) {\n                 for (const uint256& hash : reverse_iterate(vHashes)) {\n-                    pnode->PushBlockHash(hash);\n+                    WITH_LOCK(pnode->cs_inventory, pnode->vBlockHashesToAnnounce.push_back(hash));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#discussion_r444197371",
      "id" : 444197371,
      "in_reply_to_id" : 443754624,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDE5NzM3MQ==",
      "original_commit_id" : "e335e4fcc881260906fb561f23a1b5017ed04d91",
      "original_line" : 1333,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 435747103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19347",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-23T12:50:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/444197371",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've moved the lock scope change to the correct commit, and also moved it one line up, outside the surrounding if block. It doesn't make any difference here, but makes a commit in a future branch tidier.",
      "created_at" : "2020-06-23T12:51:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-648124539",
      "id" : 648124539,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0ODEyNDUzOQ==",
      "updated_at" : "2020-06-23T12:51:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/648124539",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK e8a2822119233ade0de84f791a9e92918a3d6896",
      "created_at" : "2020-07-07T18:33:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-655046772",
      "id" : 655046772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NTA0Njc3Mg==",
      "updated_at" : "2020-07-07T18:33:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/655046772",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK e8a2822119233ade0de84f791a9e92918a3d6896 ð¬\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nACK e8a2822119233ade0de84f791a9e92918a3d6896 ð¬\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUgLcQv/SQmH5S8+LYeoatDRRklzvqBa7vDSX+1JFkyauaibxrGa2j0CT5pmbrQi\r\nVBQSMZNrfC3F7g0hydzbplkkDzTciuj0rJGK6ScTmPLJA1X1ytCCoOjncCB+hz5O\r\nL250NVZCJRsbESdtIzqfmJZcl/ANYbxeM9ZF+sgVFvG5tq+OMmHy1zWN6Yejxnxh\r\nvryK7Ke16Mny2QLmrgohTQTyYicHzX0wrKDV2v7J1DQL6TaN4nVAsmPV7eKbIAI6\r\nwTPl8msWKfknfrGU2SEurFEdfKN0IapV8KxM+trbjKpakIGcF3sFaP60cHzf1haG\r\nHjfckGlwx9hiYWs6d6RwM9mGI+t8k4UkdPbxrAwjW/OnK0jAw6Zp/NOJK7VX19Em\r\nDcoKZXMHmrdNvIV5sxxXkGJtEQJsknuyIyjmbOB9HezJG+obnSNGuMvdqF7WLV20\r\nUQpV+WhV07LlYz4akXZ/SGsDvRJkFzIskaIc4u2tKVVHM/HIHjsrB7Vy2DTd8A4J\r\nXLhWoDVu\r\n=9k86\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `19ea9d208bf92e8a00c6a74b291941159f29e27a9ad985a83fc50fb9e7eeb14a  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e89294010819ea9d208bf92e8a00c6a74b291941159f29e27a9ad985a83fc50fb9e7eeb14af0108df50901dbda9abb6da7ebacc3340c3308fff0102fd60bd06ce468d455f1b5a4105cf06108f1045f0624f4f0080e222e4787965af90083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6dfff0106dcf23eaf62794540a9b5c3f34cee70e08f1045f0624f4f0082527e637c980e8150083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6dfff010b561711d9277ebacb3f41eba5075c00808f1045f0624f5f008b398429856ae78fb0083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267f010e760ef17026c64cb1aa6dd772c2d0ded08f1045f0624f4f008ac0ec51240f25e420083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267)\r\n\r\n</details>\r\n",
      "created_at" : "2020-07-08T19:57:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19347#issuecomment-655724407",
      "id" : 655724407,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19347",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NTcyNDQwNw==",
      "updated_at" : "2020-07-08T19:57:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/655724407",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
