{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "It seems strange that linux host definition in depends just calls the native system compiler with -m32/-m64 flags, instead of supporting cross compilers, and that it doesn't use a -sysroot value to prevent picking up system libraries:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/master/depends/hosts/linux.mk\r\n\r\nThis is pretty different than the other windows/darwin/android hosts defined in the same directory, and seems like it would prevent `make HOST=x86_64-pc-linux-gnu` from working on anything other than a matching native platform.\r\n\r\nAnother side-effect of using the native compiler without a -sysroot value is that the build currently pick ups system libraries like BDB. From [#bitcoin-builds](http://gnusha.org/bitcoin-builds/2020-05-04.log):\r\n\r\n> [19:57:12] \\<achow101> when I build with the depends system, is it supposed to fallback to my system libs if the depends build misses a dependendency?\r\n> [22:40:02] \\<dongcarl> achow101: What's the full context?\r\n> [22:45:13] \\<achow101> dongcarl: I modified depends to build a version of bdb that we didn't support. configure then ignored that version and used my system lib instead of erroring as i was expecting it to\r\n\r\nThis is also causing headaches in #18677. I first added new packages there not even using `host_CC` etc variables, so native builds on linux and mac worked fine, but the cross compiled linux->mac build didn't work, which fanquake reported. To fix that, I started using the `host_CC` etc variables and passing along `-sysroot` values for host packages to fix the reported [linux->mac cross-compile](https://github.com/bitcoin/bitcoin/pull/18677#pullrequestreview-395075571) problem. But this turned out to break the i686-linux-gnu build on travis, because specifying `-sysroot` prevents gcc from using include files like `stdio.h` from `/usr/include/` and instead only use `/usr/x86_64-linux-gnu/include/stdio.h`. This worked fine on my system, but didn't work on travis because the [libc6-dev-amd64-cross package](https://packages.ubuntu.com/bionic/libc6-dev-amd64-cross) wasn't installed. So I added that package and travis turned green.\r\n\r\nBut now hebasto is reporting the same error I was seeing on travis in an local linux mint build https://github.com/bitcoin/bitcoin/pull/18677#issuecomment-625674673 and it seems like linux mint might not have a `libc6-dev-amd64-cross` package.\r\n\r\nI fixed this by [not setting -sysroot for the new packages for the native linux build](https://github.com/bitcoin/bitcoin/pull/18677#issuecomment-627022845), and I probably should have done this before to respect the `host_CC` etc variables more. But it would also be good to understand why the linux host variables are set the way they are to begin with. Are they actually intended to pick up outside system libraries and not support cross compiling?\r\n\r\nIt's unclear if they're set the current way for expediency, or if there's a different design goal for the linux host compared to the other hosts.",
   "closed_at" : "2020-10-27T18:19:03Z",
   "closed_by" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
      "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
      "followers_url" : "https://api.github.com/users/ryanofsky/followers",
      "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/ryanofsky",
      "id" : 7133040,
      "login" : "ryanofsky",
      "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
      "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
      "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
      "repos_url" : "https://api.github.com/users/ryanofsky/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/ryanofsky"
   },
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18915/comments",
   "created_at" : "2020-05-08T14:12:50Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18915/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/18915",
   "id" : 614768292,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "description" : null,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      },
      {
         "color" : "5319e7",
         "default" : false,
         "description" : null,
         "id" : 61889416,
         "name" : "Build system",
         "node_id" : "MDU6TGFiZWw2MTg4OTQxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18915/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU2MTQ3NjgyOTI=",
   "number" : 18915,
   "performed_via_github_app" : null,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "depends: should linux host should be using -sysroot?",
   "updated_at" : "2020-10-27T18:46:48Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18915",
   "user" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
      "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
      "followers_url" : "https://api.github.com/users/ryanofsky/followers",
      "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/ryanofsky",
      "id" : 7133040,
      "login" : "ryanofsky",
      "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
      "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
      "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
      "repos_url" : "https://api.github.com/users/ryanofsky/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/ryanofsky"
   }
}
