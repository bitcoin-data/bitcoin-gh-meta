[
   {
      "author_association" : "NONE",
      "body" : "Hii @fanquake  I would like to be assigned to work on this issue as my first contribution to bitcoin-core.\r\n\r\nThanks.\r\n\r\nEdit : Started working on this :) ",
      "created_at" : "2020-05-08T09:55:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-625738713",
      "id" : 625738713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNTczODcxMw==",
      "updated_at" : "2020-05-08T09:56:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/625738713",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/53647194?v=4",
         "events_url" : "https://api.github.com/users/MrSquanchee/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MrSquanchee/followers",
         "following_url" : "https://api.github.com/users/MrSquanchee/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MrSquanchee/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MrSquanchee",
         "id" : 53647194,
         "login" : "MrSquanchee",
         "node_id" : "MDQ6VXNlcjUzNjQ3MTk0",
         "organizations_url" : "https://api.github.com/users/MrSquanchee/orgs",
         "received_events_url" : "https://api.github.com/users/MrSquanchee/received_events",
         "repos_url" : "https://api.github.com/users/MrSquanchee/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MrSquanchee/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MrSquanchee/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MrSquanchee"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @MrSquanchee!\r\n\r\nI've added most of my thoughts on this in the closed issue above. As of now, the FD counts are pretty much hardcoded in, and I think it would be nice to get away from that in a modular way if we want things like a configurable number of inbound/outbound/feeler connections, lots of RPC threads, FDs used by future changes that will have possibly missed modifying the initial FD count, etc. \r\n\r\nThere's also the concept of \"soft limits\" of FDs, which is currently implemented in a way that reduces the possible maximum of 125 inbound connections when we allocate them to *some* other stuff, but I think this \"soft limit\" should be applied to the maximum number of FDs available to the process. This would be nice, as most Linux distros give you 1024 FDs, which would allow for much more varied configurations and eliminate the need to reduce the 125 inbound count.\r\n\r\nThere's also an assumption that every system will use the same count, which I'm not sure will be true in the future, or is true now (I didn't really have a large enough test bed of OSes when I opened the issue, which was kind of discouraging). Something that actually measures the number of FDs open by the process might also be helpful, instead of assuming we've measured correctly.\r\n\r\nWith that in mind, something that tells us the number of required, requested, and allocated FDs on startup would be informative. Similar to what I had in the closed issue, which is what causes the bug above (the allocated number of FDs returned gets reduced lower than the required number of FDs). So if we don't get our requested amount, we can *possibly* revamp our counts in such a way that we still meet the required amount. \r\n\r\nOn another note: arbitrarily changing FD counts to critical things is not a solution in my mind, but in support of more robust configs, there's at least some bigger nodes that need to vary these counts, and probably a sane minimum we can use for most stuff (current values could be a sane minimum and default maximum for some things, ie. feeler connections).",
      "created_at" : "2020-05-18T18:30:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-630361008",
      "id" : 630361008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMDM2MTAwOA==",
      "updated_at" : "2020-05-18T19:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630361008",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/8435003?v=4",
         "events_url" : "https://api.github.com/users/tryphe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tryphe/followers",
         "following_url" : "https://api.github.com/users/tryphe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tryphe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tryphe",
         "id" : 8435003,
         "login" : "tryphe",
         "node_id" : "MDQ6VXNlcjg0MzUwMDM=",
         "organizations_url" : "https://api.github.com/users/tryphe/orgs",
         "received_events_url" : "https://api.github.com/users/tryphe/received_events",
         "repos_url" : "https://api.github.com/users/tryphe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tryphe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tryphe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tryphe"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Also, don't hesitate to pick our brains in #bitcoin-core-dev on freenode or pm me on there! :)",
      "created_at" : "2020-05-18T19:04:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-630379011",
      "id" : 630379011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMDM3OTAxMQ==",
      "updated_at" : "2020-05-18T19:04:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630379011",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/8435003?v=4",
         "events_url" : "https://api.github.com/users/tryphe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tryphe/followers",
         "following_url" : "https://api.github.com/users/tryphe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tryphe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tryphe",
         "id" : 8435003,
         "login" : "tryphe",
         "node_id" : "MDQ6VXNlcjg0MzUwMDM=",
         "organizations_url" : "https://api.github.com/users/tryphe/orgs",
         "received_events_url" : "https://api.github.com/users/tryphe/received_events",
         "repos_url" : "https://api.github.com/users/tryphe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tryphe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tryphe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tryphe"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "There is no formal assignment process on Bitcoin Core @MrSquanchee so we can't stop somebody else from working on it if they want to. But it is helpful to know you are working on it.",
      "created_at" : "2020-05-18T19:29:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-630391157",
      "id" : 630391157,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMDM5MTE1Nw==",
      "updated_at" : "2020-05-18T19:29:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630391157",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Hii Guys, Thanks for reminding me about this. I have been a bit busy. I would not mind if anyone else would want to work on this Issue.\r\nMight start working on bitcoin later :)",
      "created_at" : "2020-05-18T19:47:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-630399186",
      "id" : 630399186,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMDM5OTE4Ng==",
      "updated_at" : "2020-05-18T19:47:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630399186",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/53647194?v=4",
         "events_url" : "https://api.github.com/users/MrSquanchee/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MrSquanchee/followers",
         "following_url" : "https://api.github.com/users/MrSquanchee/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MrSquanchee/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MrSquanchee",
         "id" : 53647194,
         "login" : "MrSquanchee",
         "node_id" : "MDQ6VXNlcjUzNjQ3MTk0",
         "organizations_url" : "https://api.github.com/users/MrSquanchee/orgs",
         "received_events_url" : "https://api.github.com/users/MrSquanchee/received_events",
         "repos_url" : "https://api.github.com/users/MrSquanchee/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MrSquanchee/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MrSquanchee/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MrSquanchee"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If anyone is looking for somewhere to get started, I've cleaned up the file descriptor code in `init.cpp` a little [here](https://github.com/troygiorshev/bitcoin/commit/d9e1c1e83afc29782e26c1ae020539dc15444f75).",
      "created_at" : "2020-08-07T21:23:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-670718724",
      "id" : 670718724,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MDcxODcyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-07T21:23:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/670718724",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5553787?v=4",
         "events_url" : "https://api.github.com/users/troygiorshev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/troygiorshev/followers",
         "following_url" : "https://api.github.com/users/troygiorshev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/troygiorshev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/troygiorshev",
         "id" : 5553787,
         "login" : "troygiorshev",
         "node_id" : "MDQ6VXNlcjU1NTM3ODc=",
         "organizations_url" : "https://api.github.com/users/troygiorshev/orgs",
         "received_events_url" : "https://api.github.com/users/troygiorshev/received_events",
         "repos_url" : "https://api.github.com/users/troygiorshev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/troygiorshev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/troygiorshev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/troygiorshev"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> If anyone is looking for somewhere to get started, I've cleaned up the file descriptor code in `init.cpp` a little [here](https://github.com/troygiorshev/bitcoin/commit/d9e1c1e83afc29782e26c1ae020539dc15444f75).\r\n\r\nI've also taken the liberty to meddle with this: here's a [branch](https://github.com/NelsonFrancisco/bitcoin/compare/master...NelsonFrancisco:n2021-31-03-fd)\r\n\r\nMade a branch with a \"sanitizing\" of this code before trying to achieve the issue here. I found the \"nMaxConnections\" variable value to be really hard to track, so I've thrown an error, if -maxconnections is less than 0, and used a temporary variable before finally defining nMaxConnections. So, I believe I changed no behavior besides the error throwing.\r\n\r\nI believe also, that \"AppInitParameterInteraction\" should be divided into several functions. It simply does too much, IMO. Maybe in a separated commit, what do you think?\r\n\r\nSo, for the problem in itself: is it possible for the nMaxConnections variable to get a negative value? What's the best approach to solve this? Change the following calculation `nFD - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS - NUM_FDS_MESSAGE_CAPTURE` ?",
      "created_at" : "2021-03-31T16:00:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-811181017",
      "id" : 811181017,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMTE4MTAxNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-31T16:00:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811181017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/31771519?v=4",
         "events_url" : "https://api.github.com/users/NelsonFrancisco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NelsonFrancisco/followers",
         "following_url" : "https://api.github.com/users/NelsonFrancisco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NelsonFrancisco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NelsonFrancisco",
         "id" : 31771519,
         "login" : "NelsonFrancisco",
         "node_id" : "MDQ6VXNlcjMxNzcxNTE5",
         "organizations_url" : "https://api.github.com/users/NelsonFrancisco/orgs",
         "received_events_url" : "https://api.github.com/users/NelsonFrancisco/received_events",
         "repos_url" : "https://api.github.com/users/NelsonFrancisco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NelsonFrancisco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NelsonFrancisco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NelsonFrancisco"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Is anyone working on this? I am very new to open source and would like to start networking :)\r\n",
      "created_at" : "2021-05-04T20:24:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-832219150",
      "id" : 832219150,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgzMjIxOTE1MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-04T20:24:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/832219150",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32168250?v=4",
         "events_url" : "https://api.github.com/users/Tmarlow98/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Tmarlow98/followers",
         "following_url" : "https://api.github.com/users/Tmarlow98/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Tmarlow98/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Tmarlow98",
         "id" : 32168250,
         "login" : "Tmarlow98",
         "node_id" : "MDQ6VXNlcjMyMTY4MjUw",
         "organizations_url" : "https://api.github.com/users/Tmarlow98/orgs",
         "received_events_url" : "https://api.github.com/users/Tmarlow98/received_events",
         "repos_url" : "https://api.github.com/users/Tmarlow98/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Tmarlow98/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Tmarlow98/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Tmarlow98"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In addition to improving fd planning, I wonder if we should have all our fd allocations check if they exceed our known limitations, and if so, close the new fd, kill a random p2p socket, and try again?",
      "created_at" : "2022-03-10T02:27:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18911#issuecomment-1063589012",
      "id" : 1063589012,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18911",
      "node_id" : "IC_kwDOABII584_ZRSU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1063589012/reactions"
      },
      "updated_at" : "2022-03-10T02:27:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1063589012",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   }
]
