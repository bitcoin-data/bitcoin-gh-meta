{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "This PR adds a way to persist the coins cache on shutdown to a file named `coinscache.dat`, similar to what is done for the mempool. On startup this file is used to warm the cache so it doesn't get cold between restarts. This can be useful for users who want to connect blocks quickly with a high `-dbcache` value.\r\n\r\nThis introduces a new config arg, `-persistcoinscache`, that is defaulted to false. With a higher cache value the amount of disk space used for the file could be very large, so it defaults to off to prevent any footguns. With lower cache values this configuration could cause the cache to flush sooner than necessary and would probably not provide any benefit.\r\n\r\nWith a max dbcache after a reindex or IBD it will dump the entire utxo set and load it into memory on startup. Testing this today I had a file size of 2.4GB and it took ~22 minutes to fully reinsert the utxo set into the cache with an SSD.\r\n\r\nAfter #17487 we can [add a change to not wipe the cache on periodic flushes](https://github.com/bitcoin/bitcoin/pull/17487#issuecomment-629929852). Users could then run the node continuously with the entire utxo set in memory. [Benchmarking](https://github.com/bitcoin/bitcoin/pull/18941#issuecomment-633684774) shows running in this configuration could save several hundred milliseconds when connecting blocks, vs an empty cache that is cleared periodically or during restarts.",
   "closed_at" : "2020-06-18T01:29:06Z",
   "closed_by" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
      "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
      "followers_url" : "https://api.github.com/users/andrewtoth/followers",
      "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
      "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/andrewtoth",
      "id" : 237213,
      "login" : "andrewtoth",
      "node_id" : "MDQ6VXNlcjIzNzIxMw==",
      "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
      "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
      "repos_url" : "https://api.github.com/users/andrewtoth/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/andrewtoth"
   },
   "comments" : 9,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18941/comments",
   "created_at" : "2020-05-11T02:46:53Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18941/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/18941",
   "id" : 615548919,
   "labels" : [
      {
         "color" : "6060aa",
         "default" : false,
         "description" : null,
         "id" : 118379652,
         "name" : "Validation",
         "node_id" : "MDU6TGFiZWwxMTgzNzk2NTI=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18941/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0NDE1ODM1NDY1",
   "number" : 18941,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/18941.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18941",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/18941.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18941"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "validation: Persist coins cache to disk and load on startup",
   "updated_at" : "2020-06-18T01:29:07Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18941",
   "user" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/237213?v=4",
      "events_url" : "https://api.github.com/users/andrewtoth/events{/privacy}",
      "followers_url" : "https://api.github.com/users/andrewtoth/followers",
      "following_url" : "https://api.github.com/users/andrewtoth/following{/other_user}",
      "gists_url" : "https://api.github.com/users/andrewtoth/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/andrewtoth",
      "id" : 237213,
      "login" : "andrewtoth",
      "node_id" : "MDQ6VXNlcjIzNzIxMw==",
      "organizations_url" : "https://api.github.com/users/andrewtoth/orgs",
      "received_events_url" : "https://api.github.com/users/andrewtoth/received_events",
      "repos_url" : "https://api.github.com/users/andrewtoth/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/andrewtoth/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/andrewtoth/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/andrewtoth"
   }
}
