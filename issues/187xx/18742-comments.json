[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18531 (rpc: Assert that RPCArg names are equal to CRPCCommand ones by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-04-22T19:34:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-617987356",
      "id" : 617987356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNzk4NzM1Ng==",
      "updated_at" : "2020-05-14T04:53:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617987356",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Oh, great find!\r\n\r\nHow did you find this one and in what commit was it introduced? :)",
      "created_at" : "2020-04-22T19:54:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-618000451",
      "id" : 618000451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxODAwMDQ1MQ==",
      "updated_at" : "2020-04-22T19:54:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/618000451",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "\r\n<details><summary>Good question. This is the traceback:</summary>\r\n\r\n\r\n\r\n\r\n```\r\n118/145 - rpc_getblockstats.py failed, Duration: 3 s\r\n\r\nstdout:\r\n\r\n2020-04-15T15:10:09.960000Z TestFramework (INFO): Initializing test directory /home/travis/build/bitcoin/bitcoin/ci/scratch/test_runner/test_runner_â¿_ð_20200415_145914/rpc_getblockstats_25\r\n\r\n2020-04-15T15:10:12.198000Z TestFramework (ERROR): Unexpected exception caught during testing\r\n\r\nTraceback (most recent call last):\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/authproxy.py\", line 108, in _request\r\n\r\n    return self._get_response()\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/authproxy.py\", line 166, in _get_response\r\n\r\n    http_response = self.__conn.getresponse()\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 1346, in getresponse\r\n\r\n    response.begin()\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 307, in begin\r\n\r\n    version, status, reason = self._read_status()\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 276, in _read_status\r\n\r\n    raise RemoteDisconnected(\"Remote end closed connection without\"\r\n\r\nhttp.client.RemoteDisconnected: Remote end closed connection without response\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/test_framework.py\", line 112, in main\r\n\r\n    self.run_test()\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/rpc_getblockstats.py\", line 97, in run_test\r\n\r\n    self.load_test_data(test_data)\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/rpc_getblockstats.py\", line 89, in load_test_data\r\n\r\n    self.nodes[0].submitblock(b)\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/coverage.py\", line 47, in __call__\r\n\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/authproxy.py\", line 142, in __call__\r\n\r\n    response, status = self._request('POST', self.__url.path, postdata.encode('utf-8'))\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/authproxy.py\", line 113, in _request\r\n\r\n    self.__conn.request(method, path, postdata, headers)\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 1254, in request\r\n\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 1300, in _send_request\r\n\r\n    self.endheaders(body, encode_chunked=encode_chunked)\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 1249, in endheaders\r\n\r\n    self._send_output(message_body, encode_chunked=encode_chunked)\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 1036, in _send_output\r\n\r\n    self.send(msg)\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 974, in send\r\n\r\n    self.connect()\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 946, in connect\r\n\r\n    (self.host,self.port), self.timeout, self.source_address)\r\n\r\n  File \"/usr/lib/python3.6/socket.py\", line 724, in create_connection\r\n\r\n    raise err\r\n\r\n  File \"/usr/lib/python3.6/socket.py\", line 713, in create_connection\r\n\r\n    sock.connect(sa)\r\n\r\nConnectionRefusedError: [Errno 111] Connection refused\r\n\r\n2020-04-15T15:10:12.261000Z TestFramework (INFO): Stopping nodes\r\n\r\n2020-04-15T15:10:12.261000Z TestFramework.node0 (ERROR): Unable to stop node.\r\n\r\nTraceback (most recent call last):\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/test_node.py\", line 266, in stop_node\r\n\r\n    self.stop(wait=wait)\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/coverage.py\", line 47, in __call__\r\n\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/authproxy.py\", line 142, in __call__\r\n\r\n    response, status = self._request('POST', self.__url.path, postdata.encode('utf-8'))\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/authproxy.py\", line 107, in _request\r\n\r\n    self.__conn.request(method, path, postdata, headers)\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 1254, in request\r\n\r\n    self._send_request(method, url, body, headers, encode_chunked)\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 1265, in _send_request\r\n\r\n    self.putrequest(method, url, **skips)\r\n\r\n  File \"/usr/lib/python3.6/http/client.py\", line 1118, in putrequest\r\n\r\n    raise CannotSendRequest(self.__state)\r\n\r\nhttp.client.CannotSendRequest: Request-sent\r\n\r\n[node 0] Cleaning up leftover process\r\n\r\nstderr:\r\n\r\nTraceback (most recent call last):\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/rpc_getblockstats.py\", line 165, in <module>\r\n\r\n    GetblockstatsTest().main()\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/test_framework.py\", line 135, in main\r\n\r\n    exit_code = self.shutdown()\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/test_framework.py\", line 242, in shutdown\r\n\r\n    self.stop_nodes()\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/test_framework.py\", line 453, in stop_nodes\r\n\r\n    node.stop_node(wait=wait)\r\n\r\n  File \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/test/functional/test_framework/test_node.py\", line 280, in stop_node\r\n\r\n    raise AssertionError(\"Unexpected stderr {} != {}\".format(stderr, expected_stderr))\r\n\r\nAssertionError: Unexpected stderr =================================================================\r\n\r\n==3550==ERROR: AddressSanitizer: stack-use-after-return on address 0x7fdbfbb7dc40 at pc 0x5567a688f34f bp 0x7fdbfee66f10 sp 0x7fdbfee66f08\r\n\r\nREAD of size 8 at 0x7fdbfbb7dc40 thread T4 (b-httpworker.0)\r\n\r\n    #0 0x5567a688f34e in CMainSignals::NewPoWValidBlock(CBlockIndex const*, std::shared_ptr<CBlock const> const&)::$_15::operator()(CValidationInterface&) const /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/validationinterface.cpp:246:75\r\n\r\n    #1 0x5567a688f34e in void MainSignalsInstance::Iterate<CMainSignals::NewPoWValidBlock(CBlockIndex const*, std::shared_ptr<CBlock const> const&)::$_15>(CMainSignals::NewPoWValidBlock(CBlockIndex const*, std::shared_ptr<CBlock const> const&)::$_15&&) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/validationinterface.cpp:83\r\n\r\n    #2 0x5567a688f34e in CMainSignals::NewPoWValidBlock(CBlockIndex const*, std::shared_ptr<CBlock const> const&) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/validationinterface.cpp:246\r\n\r\n    #3 0x5567a67a6cf1 in CChainState::AcceptBlock(std::shared_ptr<CBlock const> const&, BlockValidationState&, CChainParams const&, CBlockIndex**, bool, FlatFilePos const*, bool*) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/validation.cpp:3758:26\r\n\r\n    #4 0x5567a67aa38c in ProcessNewBlock(CChainParams const&, std::shared_ptr<CBlock const>, bool, bool*) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/validation.cpp:3798:40\r\n\r\n    #5 0x5567a64467b6 in submitblock(JSONRPCRequest const&) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/rpc/mining.cpp:947:21\r\n\r\n    #6 0x5567a63fe3e6 in CRPCCommand::CRPCCommand(char const*, char const*, UniValue (*)(JSONRPCRequest const&), std::initializer_list<char const*>)::'lambda'(JSONRPCRequest const&, UniValue&, bool)::operator()(JSONRPCRequest const&, UniValue&, bool) const /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/./rpc/server.h:104:94\r\n\r\n    #7 0x5567a63fdce8 in std::_Function_handler<bool (JSONRPCRequest const&, UniValue&, bool), CRPCCommand::CRPCCommand(char const*, char const*, UniValue (*)(JSONRPCRequest const&), std::initializer_list<char const*>)::'lambda'(JSONRPCRequest const&, UniValue&, bool)>::_M_invoke(std::_Any_data const&, JSONRPCRequest const&, UniValue&, bool&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/std_function.h:301:9\r\n\r\n    #8 0x5567a602f02e in std::function<bool (JSONRPCRequest const&, UniValue&, bool)>::operator()(JSONRPCRequest const&, UniValue&, bool) const /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/std_function.h:706:14\r\n\r\n    #9 0x5567a654f18f in ExecuteCommand(CRPCCommand const&, JSONRPCRequest const&, UniValue&, bool) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/rpc/server.cpp:452:20\r\n\r\n    #10 0x5567a654ea20 in CRPCTable::execute(JSONRPCRequest const&) const /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/rpc/server.cpp:435:17\r\n\r\n    #11 0x5567a6942a88 in HTTPReq_JSONRPC(HTTPRequest*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/httprpc.cpp:208:40\r\n\r\n    #12 0x5567a6386af0 in std::_Function_handler<bool (HTTPRequest*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&), bool (*)(HTTPRequest*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)>::_M_invoke(std::_Any_data const&, HTTPRequest*&&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/std_function.h:301:9\r\n\r\n    #13 0x5567a69631e9 in std::function<bool (HTTPRequest*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)>::operator()(HTTPRequest*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) const /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/std_function.h:706:14\r\n\r\n    #14 0x5567a6962e2b in HTTPWorkItem::operator()() /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/httpserver.cpp:55:9\r\n\r\n    #15 0x5567a696c777 in WorkQueue<HTTPClosure>::Run() /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/httpserver.cpp:114:13\r\n\r\n    #16 0x5567a695507f in HTTPWorkQueueRun(WorkQueue<HTTPClosure>*, int) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/httpserver.cpp:342:12\r\n\r\n    #17 0x5567a6972c29 in void std::__invoke_impl<void, void (*)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*, int>(std::__invoke_other, void (*&&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&&, int&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/invoke.h:60:14\r\n\r\n    #18 0x5567a6972aba in std::__invoke_result<void (*)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*, int>::type std::__invoke<void (*)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*, int>(void (*&&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&&, int&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/invoke.h:95:14\r\n\r\n    #19 0x5567a6972881 in decltype(std::__invoke(_S_declval<0ul>(), _S_declval<1ul>(), _S_declval<2ul>())) std::thread::_Invoker<std::tuple<void (*)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*, int> >::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/thread:234:13\r\n\r\n    #20 0x5567a6971fe1 in std::thread::_Invoker<std::tuple<void (*)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*, int> >::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/thread:243:11\r\n\r\n    #21 0x5567a6971fe1 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*, int> > >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/thread:186\r\n\r\n    #22 0x7fdc0a3a76de  (/usr/lib/x86_64-linux-gnu/libstdc++.so.6+0xbd6de)\r\n\r\n    #23 0x7fdc0b3436da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)\r\n\r\n    #24 0x7fdc0965888e in clone (/lib/x86_64-linux-gnu/libc.so.6+0x12188e)\r\n\r\nAddress 0x7fdbfbb7dc40 is located in stack of thread T6 (b-httpworker.2) at offset 3136 in frame\r\n\r\n    #0 0x5567a6445a2f in submitblock(JSONRPCRequest const&) /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/rpc/mining.cpp:896\r\n\r\n  This frame has 57 object(s):\r\n\r\n    [32, 33) 'ref.tmp.i'\r\n\r\n    [48, 192) 'ref.tmp' (line 898)\r\n\r\n    [256, 288) 'agg.tmp'\r\n\r\n    [320, 321) 'ref.tmp1' (line 898)\r\n\r\n    [336, 368) 'agg.tmp6'\r\n\r\n    [400, 401) 'ref.tmp7' (line 898)\r\n\r\n    [416, 440) 'agg.tmp16'\r\n\r\n    [480, 864) 'ref.tmp18' (line 898)\r\n\r\n    [928, 960) 'agg.tmp19'\r\n\r\n    [992, 993) 'ref.tmp20' (line 898)\r\n\r\n    [1008, 1048) 'agg.tmp29'\r\n\r\n    [1088, 1092) 'ref.tmp30' (line 898)\r\n\r\n    [1104, 1136) 'agg.tmp37'\r\n\r\n    [1168, 1169) 'ref.tmp38' (line 898)\r\n\r\n    [1184, 1216) 'agg.tmp47'\r\n\r\n    [1248, 1249) 'ref.tmp48' (line 898)\r\n\r\n    [1264, 1288) 'agg.tmp57'\r\n\r\n    [1328, 1360) 'agg.tmp64'\r\n\r\n    [1392, 1393) 'ref.tmp65' (line 898)\r\n\r\n    [1408, 1448) 'agg.tmp74'\r\n\r\n    [1488, 1520) 'agg.tmp81'\r\n\r\n    [1552, 1553) 'ref.tmp82' (line 898)\r\n\r\n    [1568, 1600) 'agg.tmp91'\r\n\r\n    [1632, 1633) 'ref.tmp92' (line 898)\r\n\r\n    [1648, 1672) 'agg.tmp101'\r\n\r\n    [1712, 1713) 'ref.tmp108' (line 898)\r\n\r\n    [1728, 1752) 'agg.tmp117'\r\n\r\n    [1792, 1928) 'agg.tmp118'\r\n\r\n    [2000, 2032) 'agg.tmp119'\r\n\r\n    [2064, 2065) 'ref.tmp120' (line 898)\r\n\r\n    [2080, 2112) 'agg.tmp129'\r\n\r\n    [2144, 2145) 'ref.tmp130' (line 898)\r\n\r\n    [2160, 2184) 'agg.tmp139'\r\n\r\n    [2224, 2256) 'agg.tmp150'\r\n\r\n    [2288, 2320) 'agg.tmp151'\r\n\r\n    [2352, 2384) 'ref.tmp152' (line 898)\r\n\r\n    [2416, 2448) 'ref.tmp153' (line 898)\r\n\r\n    [2480, 2481) 'ref.tmp154' (line 898)\r\n\r\n    [2496, 2528) 'ref.tmp165' (line 898)\r\n\r\n    [2560, 2561) 'ref.tmp166' (line 898)\r\n\r\n    [2576, 2608) 'ref.tmp181' (line 898)\r\n\r\n    [2640, 2672) 'ref.tmp182' (line 898)\r\n\r\n    [2704, 2705) 'ref.tmp183' (line 898)\r\n\r\n    [2720, 2752) 'ref.tmp194' (line 898)\r\n\r\n    [2784, 2785) 'ref.tmp195' (line 898)\r\n\r\n    [2800, 2816) 'blockptr' (line 912)\r\n\r\n    [2832, 2864) 'ref.tmp326' (line 915)\r\n\r\n    [2896, 2897) 'ref.tmp327' (line 915)\r\n\r\n    [2912, 2944) 'ref.tmp369' (line 919)\r\n\r\n    [2976, 2977) 'ref.tmp370' (line 919)\r\n\r\n    [2992, 3024) 'hash' (line 922)\r\n\r\n    [3056, 3072) 'criticalblock37' (line 924)\r\n\r\n    [3088, 3104) 'criticalblock38' (line 937)\r\n\r\n    [3120, 3121) 'new_block' (line 944)\r\n\r\n    [3136, 3256) 'sc' (line 945) <== Memory access at offset 3136 is inside this variable\r\n\r\n    [3296, 3328) 'ref.tmp469' (line 945)\r\n\r\n    [3360, 3376) 'agg.tmp491'\r\n\r\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork\r\n\r\n      (longjmp and C++ exceptions *are* supported)\r\n\r\nThread T6 (b-httpworker.2) created by T0 here:\r\n\r\n    #0 0x5567a5fbe02d in pthread_create (/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/bitcoind+0x1bc202d)\r\n\r\n    #1 0x7fdc0a3a7994 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/usr/lib/x86_64-linux-gnu/libstdc++.so.6+0xbd994)\r\n\r\n    #2 0x5567a69717a0 in void __gnu_cxx::new_allocator<std::thread>::construct<std::thread, void (&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&, int&>(std::thread*, void (&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&, int&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/ext/new_allocator.h:136:23\r\n\r\n    #3 0x5567a695c31b in void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<void (&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&, int&>(void (&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&, int&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/vector.tcc:105:4\r\n\r\nSUMMARY: AddressSanitizer: stack-use-after-return /home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/validationinterface.cpp:246:75 in CMainSignals::NewPoWValidBlock(CBlockIndex const*, std::shared_ptr<CBlock const> const&)::$_15::operator()(CValidationInterface&) const\r\n\r\nShadow bytes around the buggy address:\r\n\r\n  0x0ffbff767b30: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767b40: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767b50: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767b60: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767b70: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n=>0x0ffbff767b80: f5 f5 f5 f5 f5 f5 f5 f5[f5]f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767b90: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767ba0: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767bb0: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767bc0: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\n  0x0ffbff767bd0: f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5 f5\r\n\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n\r\n  Addressable:           00\r\n\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n\r\n  Heap left redzone:       fa\r\n\r\n  Freed heap region:       fd\r\n\r\n  Stack left redzone:      f1\r\n\r\n  Stack mid redzone:       f2\r\n\r\n  Stack right redzone:     f3\r\n\r\n  Stack after return:      f5\r\n\r\n  Stack use after scope:   f8\r\n\r\n  Global redzone:          f9\r\n\r\n  Global init order:       f6\r\n\r\n  Poisoned by user:        f7\r\n\r\n  Container overflow:      fc\r\n\r\n  Array cookie:            ac\r\n\r\n  Intra object redzone:    bb\r\n\r\n  ASan internal:           fe\r\n\r\n  Left alloca redzone:     ca\r\n\r\n  Right alloca redzone:    cb\r\n\r\n  Shadow gap:              cc\r\n\r\nThread T4 (b-httpworker.0) created by T0 here:\r\n\r\n    #0 0x5567a5fbe02d in pthread_create (/home/travis/build/bitcoin/bitcoin/build/bitcoin-x86_64-pc-linux-gnu/src/bitcoind+0x1bc202d)\r\n\r\n    #1 0x7fdc0a3a7994 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/usr/lib/x86_64-linux-gnu/libstdc++.so.6+0xbd994)\r\n\r\n    #2 0x5567a69717a0 in void __gnu_cxx::new_allocator<std::thread>::construct<std::thread, void (&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&, int&>(std::thread*, void (&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&, int&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/ext/new_allocator.h:136:23\r\n\r\n    #3 0x5567a695c31b in void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<void (&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&, int&>(void (&)(WorkQueue<HTTPClosure>*, int), WorkQueue<HTTPClosure>*&, int&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/vector.tcc:105:4\r\n\r\n==3550==ABORTING != \r\n```\r\n\r\n\r\n</details>",
      "created_at" : "2020-04-22T20:39:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-618027664",
      "id" : 618027664,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxODAyNzY2NA==",
      "updated_at" : "2020-04-22T20:40:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/618027664",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I might write a test tomorrow with steps to reproduce",
      "created_at" : "2020-04-22T20:54:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-618035042",
      "id" : 618035042,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxODAzNTA0Mg==",
      "updated_at" : "2020-04-22T20:54:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/618035042",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@practicalswift This is a race, so I couldn't find a test that is reproducible. Though, I have attached a unit test, that fails when run long enough in a loop.\r\n\r\nAll you need to do is `./configure  --with-sanitizers=address` and then run the tests with\r\n\r\n```\r\nexport ASAN_OPTIONS=detect_leaks=0\r\nmake\r\nwhile ./src/test/test_bitcoin -t validationinterface_tests/unregister_validation_interface_race --catch_system_errors=no  ; do true; done",
      "created_at" : "2020-04-23T18:24:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-618569936",
      "id" : 618569936,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxODU2OTkzNg==",
      "updated_at" : "2020-04-23T18:24:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/618569936",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If someone has issues reproducing the crash in the unit test, the following diff might help:\r\n\r\n```diff\r\ndiff --git a/src/validationinterface.cpp b/src/validationinterface.cpp\r\nindex 11000774c0..6a311eeb44 100644\r\n--- a/src/validationinterface.cpp\r\n+++ b/src/validationinterface.cpp\r\n@@ -11,6 +11,7 @@\r\n #include <primitives/block.h>\r\n #include <primitives/transaction.h>\r\n #include <scheduler.h>\r\n+#include <util/time.h>\r\n \r\n #include <future>\r\n #include <unordered_map>\r\n@@ -80,6 +81,7 @@ public:\r\n             ++it->count;\r\n             {\r\n                 REVERSE_LOCK(lock);\r\n+                UninterruptibleSleep(std::chrono::microseconds(500));\r\n                 f(*it->callbacks);\r\n             }\r\n             it = --it->count ? std::next(it) : m_list.erase(it);\r\n",
      "created_at" : "2020-04-23T20:47:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-618660696",
      "id" : 618660696,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxODY2MDY5Ng==",
      "updated_at" : "2020-04-23T20:47:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/618660696",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Running just fa9f3a51897d5457492f84f7c8a41fea783d687d (no additional patch), I generally see a crash between 5 - 20 iterations:\r\n```bash\r\n/bitcoin# while ./src/test/test_bitcoin -t validationinterface_tests/unregister_validation_interface_race --catch_system_errors=no  ; do true; done\r\nRunning 1 test case...\r\n\r\n*** No errors detected\r\nRunning 1 test case...\r\n\r\n*** No errors detected\r\nRunning 1 test case...\r\n\r\n*** No errors detected\r\nRunning 1 test case...\r\n\r\n*** No errors detected\r\nRunning 1 test case...\r\n=================================================================\r\n==95792==ERROR: AddressSanitizer: unknown-crash on address 0x7f8f04f60dc0 at pc 0x55abc9388623 bp 0x7f8f057777f0 sp 0x7f8f057777e8\r\nREAD of size 8 at 0x7f8f04f60dc0 thread T4\r\n    #0 0x55abc9388622 in CMainSignals::BlockChecked(CBlock const&, BlockValidationState const&)::$_14::operator()(CValidationInterface&) const /bitcoin/src/validationinterface.cpp:241:75\r\n    #1 0x55abc9388622 in void MainSignalsInstance::Iterate<CMainSignals::BlockChecked(CBlock const&, BlockValidationState const&)::$_14>(CMainSignals::BlockChecked(CBlock const&, BlockValidationState const&)::$_14&&) /bitcoin/src/validationinterface.cpp:83\r\n    #2 0x55abc9388622 in CMainSignals::BlockChecked(CBlock const&, BlockValidationState const&) /bitcoin/src/validationinterface.cpp:241\r\n    #3 0x55abc8b9c94c in validationinterface_tests::unregister_validation_interface_race::test_method()::$_0::operator()() const /bitcoin/src/test/validationinterface_tests.cpp:28:30\r\n    #4 0x55abc8b9c94c in void std::__invoke_impl<void, validationinterface_tests::unregister_validation_interface_race::test_method()::$_0>(std::__invoke_other, validationinterface_tests::unregister_validation_interface_race::test_method()::$_0&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/invoke.h:60\r\n    #5 0x55abc8b9c94c in std::__invoke_result<validationinterface_tests::unregister_validation_interface_race::test_method()::$_0>::type std::__invoke<validationinterface_tests::unregister_validation_interface_race::test_method()::$_0>(validationinterface_tests::unregister_validation_interface_race::test_method()::$_0&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/invoke.h:95\r\n    #6 0x55abc8b9c94c in decltype(std::__invoke(_S_declval<0ul>())) std::thread::_Invoker<std::tuple<validationinterface_tests::unregister_validation_interface_race::test_method()::$_0> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/thread:244\r\n    #7 0x55abc8b9c94c in std::thread::_Invoker<std::tuple<validationinterface_tests::unregister_validation_interface_race::test_method()::$_0> >::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/thread:253\r\n    #8 0x55abc8b9c94c in std::thread::_State_impl<std::thread::_Invoker<std::tuple<validationinterface_tests::unregister_validation_interface_race::test_method()::$_0> > >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/thread:196\r\n    #9 0x7f8f0c6d4b2e  (/usr/lib/x86_64-linux-gnu/libstdc++.so.6+0xbbb2e)\r\n    #10 0x7f8f0cccefa2 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x7fa2)\r\n    #11 0x7f8f0c3a34ce in clone (/lib/x86_64-linux-gnu/libc.so.6+0xf94ce)\r\n\r\nAddress 0x7f8f04f60dc0 is located in stack of thread T5 at offset 32 in frame\r\n    #0 0x55abc8b9d1af in std::thread::_State_impl<std::thread::_Invoker<std::tuple<validationinterface_tests::unregister_validation_interface_race::test_method()::$_1> > >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/thread:196\r\n\r\n  This frame has 1 object(s):\r\n    [32, 40) 'sub.i.i.i.i.i' <== Memory access at offset 32 is inside this variable\r\nHINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork\r\n      (longjmp and C++ exceptions *are* supported)\r\nThread T5 created by T0 here:\r\n    #0 0x55abc7d1002d in pthread_create (/bitcoin/src/test/test_bitcoin+0x37702d)\r\n    #1 0x7f8f0c6d4db4 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/usr/lib/x86_64-linux-gnu/libstdc++.so.6+0xbbdb4)\r\n    #2 0x55abc8b97b1e in validationinterface_tests::unregister_validation_interface_race_invoker() /bitcoin/src/test/validationinterface_tests.cpp:19:1\r\n    #3 0x55abc7ded77f in boost::detail::function::void_function_invoker0<void (*)(), void>::invoke(boost::detail::function::function_buffer&) /usr/include/boost/function/function_template.hpp:118:11\r\n\r\nSUMMARY: AddressSanitizer: unknown-crash /bitcoin/src/validationinterface.cpp:241:75 in CMainSignals::BlockChecked(CBlock const&, BlockValidationState const&)::$_14::operator()(CValidationInterface&) const\r\nShadow bytes around the buggy address:\r\n  0x0ff2609e4160: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0ff2609e4170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0ff2609e4180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0ff2609e4190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0ff2609e41a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n=>0x0ff2609e41b0: 00 00 00 00 00 00 00 00[00]00 00 00 00 00 00 00\r\n  0x0ff2609e41c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0ff2609e41d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0ff2609e41e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0ff2609e41f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0ff2609e4200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n  Shadow gap:              cc\r\nThread T4 created by T0 here:\r\n    #0 0x55abc7d1002d in pthread_create (/bitcoin/src/test/test_bitcoin+0x37702d)\r\n    #1 0x7f8f0c6d4db4 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/usr/lib/x86_64-linux-gnu/libstdc++.so.6+0xbbdb4)\r\n    #2 0x55abc8b97b1e in validationinterface_tests::unregister_validation_interface_race_invoker() /bitcoin/src/test/validationinterface_tests.cpp:19:1\r\n    #3 0x55abc7ded77f in boost::detail::function::void_function_invoker0<void (*)(), void>::invoke(boost::detail::function::function_buffer&) /usr/include/boost/function/function_template.hpp:118:11\r\n\r\n==95792==ABORTING\r\n```",
      "created_at" : "2020-04-26T05:36:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-619485764",
      "id" : 619485764,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxOTQ4NTc2NA==",
      "updated_at" : "2020-04-26T05:36:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/619485764",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @promag , @ryanofsky You seem qualified to review this?",
      "created_at" : "2020-04-26T11:47:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-619536472",
      "id" : 619536472,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxOTUzNjQ3Mg==",
      "updated_at" : "2020-04-26T11:47:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/619536472",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415610307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415610307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "An alternative is to call `SyncWithValidationInterfaceQueue` here.",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T08:22:09Z",
      "diff_hunk" : "@@ -942,17 +942,17 @@ static UniValue submitblock(const JSONRPCRequest& request)\n     }\n \n     bool new_block;\n-    submitblock_StateCatcher sc(block.GetHash());\n-    RegisterValidationInterface(&sc);\n+    auto sc = std::make_shared<submitblock_StateCatcher>(block.GetHash());\n+    RegisterSharedValidationInterface(sc);\n     bool accepted = ProcessNewBlock(Params(), blockptr, /* fForceProcessing */ true, /* fNewBlock */ &new_block);\n-    UnregisterValidationInterface(&sc);\n+    UnregisterSharedValidationInterface(sc);\n     if (!new_block && accepted) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415610307",
      "id" : 415610307,
      "line" : 949,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTYxMDMwNw==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 949,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 20,
      "pull_request_review_id" : 400728543,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415610307",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415737404"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415737404"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Alternative to what? The notification we are listening to is never put in the queue.",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T11:36:38Z",
      "diff_hunk" : "@@ -942,17 +942,17 @@ static UniValue submitblock(const JSONRPCRequest& request)\n     }\n \n     bool new_block;\n-    submitblock_StateCatcher sc(block.GetHash());\n-    RegisterValidationInterface(&sc);\n+    auto sc = std::make_shared<submitblock_StateCatcher>(block.GetHash());\n+    RegisterSharedValidationInterface(sc);\n     bool accepted = ProcessNewBlock(Params(), blockptr, /* fForceProcessing */ true, /* fNewBlock */ &new_block);\n-    UnregisterValidationInterface(&sc);\n+    UnregisterSharedValidationInterface(sc);\n     if (!new_block && accepted) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415737404",
      "id" : 415737404,
      "in_reply_to_id" : 415610307,
      "line" : 949,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTczNzQwNA==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 949,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 20,
      "pull_request_review_id" : 400867383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415737404",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415746758"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415746758"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I mean that after `UnregisterValidationInterface + SyncWithValidationInterfaceQueue` there is no pointer to `sc` in validation queue.",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T11:52:08Z",
      "diff_hunk" : "@@ -942,17 +942,17 @@ static UniValue submitblock(const JSONRPCRequest& request)\n     }\n \n     bool new_block;\n-    submitblock_StateCatcher sc(block.GetHash());\n-    RegisterValidationInterface(&sc);\n+    auto sc = std::make_shared<submitblock_StateCatcher>(block.GetHash());\n+    RegisterSharedValidationInterface(sc);\n     bool accepted = ProcessNewBlock(Params(), blockptr, /* fForceProcessing */ true, /* fNewBlock */ &new_block);\n-    UnregisterValidationInterface(&sc);\n+    UnregisterSharedValidationInterface(sc);\n     if (!new_block && accepted) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415746758",
      "id" : 415746758,
      "in_reply_to_id" : 415610307,
      "line" : 949,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc0Njc1OA==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 949,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 20,
      "pull_request_review_id" : 400877297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415746758",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415748007"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415748007"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How does `SyncWithValidationInterfaceQueue` prevent new notifications from being scheduled for `sc`?",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T11:54:05Z",
      "diff_hunk" : "@@ -942,17 +942,17 @@ static UniValue submitblock(const JSONRPCRequest& request)\n     }\n \n     bool new_block;\n-    submitblock_StateCatcher sc(block.GetHash());\n-    RegisterValidationInterface(&sc);\n+    auto sc = std::make_shared<submitblock_StateCatcher>(block.GetHash());\n+    RegisterSharedValidationInterface(sc);\n     bool accepted = ProcessNewBlock(Params(), blockptr, /* fForceProcessing */ true, /* fNewBlock */ &new_block);\n-    UnregisterValidationInterface(&sc);\n+    UnregisterSharedValidationInterface(sc);\n     if (!new_block && accepted) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415748007",
      "id" : 415748007,
      "in_reply_to_id" : 415610307,
      "line" : 949,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc0ODAwNw==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 949,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 20,
      "pull_request_review_id" : 400878666,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415748007",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415753443"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415753443"
         }
      },
      "author_association" : "MEMBER",
      "body" : "New notifications won't be scheduled because the `UnregisterValidationInterface` above. Only problem is a concurrent notification being called, so `SyncWithValidationInterfaceQueue` ensures that case doesn't happen.",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T12:02:50Z",
      "diff_hunk" : "@@ -942,17 +942,17 @@ static UniValue submitblock(const JSONRPCRequest& request)\n     }\n \n     bool new_block;\n-    submitblock_StateCatcher sc(block.GetHash());\n-    RegisterValidationInterface(&sc);\n+    auto sc = std::make_shared<submitblock_StateCatcher>(block.GetHash());\n+    RegisterSharedValidationInterface(sc);\n     bool accepted = ProcessNewBlock(Params(), blockptr, /* fForceProcessing */ true, /* fNewBlock */ &new_block);\n-    UnregisterValidationInterface(&sc);\n+    UnregisterSharedValidationInterface(sc);\n     if (!new_block && accepted) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415753443",
      "id" : 415753443,
      "in_reply_to_id" : 415610307,
      "line" : 949,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc1MzQ0Mw==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 949,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 20,
      "pull_request_review_id" : 400884532,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415753443",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415763255"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415763255"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Now I understand. Yeah, correct.",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T12:19:05Z",
      "diff_hunk" : "@@ -942,17 +942,17 @@ static UniValue submitblock(const JSONRPCRequest& request)\n     }\n \n     bool new_block;\n-    submitblock_StateCatcher sc(block.GetHash());\n-    RegisterValidationInterface(&sc);\n+    auto sc = std::make_shared<submitblock_StateCatcher>(block.GetHash());\n+    RegisterSharedValidationInterface(sc);\n     bool accepted = ProcessNewBlock(Params(), blockptr, /* fForceProcessing */ true, /* fNewBlock */ &new_block);\n-    UnregisterValidationInterface(&sc);\n+    UnregisterSharedValidationInterface(sc);\n     if (!new_block && accepted) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415763255",
      "id" : 415763255,
      "in_reply_to_id" : 415610307,
      "line" : 949,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc2MzI1NQ==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 949,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 20,
      "pull_request_review_id" : 400895571,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415763255",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Could you revert or move formatting changes in validationinterface.h/cpp files to a separate commit? I'm starting at that looking for actual changes but is it all reformatting?",
      "created_at" : "2020-04-27T13:46:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-619996817",
      "id" : 619996817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxOTk5NjgxNw==",
      "updated_at" : "2020-04-27T13:46:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/619996817",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415827675"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415827675"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is also unrelated cleanup?",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T13:48:17Z",
      "diff_hunk" : "@@ -874,7 +874,7 @@ static UniValue getblocktemplate(const JSONRPCRequest& request)\n     return result;\n }\n \n-class submitblock_StateCatcher : public CValidationInterface\n+class submitblock_StateCatcher final : public CValidationInterface",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415827675",
      "id" : 415827675,
      "line" : 877,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgyNzY3NQ==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 877,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 5,
      "pull_request_review_id" : 400968783,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415827675",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415828236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415828236"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is part of the bugfix or an optimization? Or a different bugfix?",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T13:49:00Z",
      "diff_hunk" : "@@ -204,14 +204,12 @@ BOOST_AUTO_TEST_CASE(processnewblock_signals_ordering)\n     for (auto& t : threads) {\n         t.join();\n     }\n-    while (GetMainSignals().CallbacksPending() > 0) {\n-        UninterruptibleSleep(std::chrono::milliseconds{100});\n-    }\n+    SyncWithValidationInterfaceQueue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415828236",
      "id" : 415828236,
      "line" : 207,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgyODIzNg==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 207,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/test/validation_block_tests.cpp",
      "position" : 27,
      "pull_request_review_id" : 400969440,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415828236",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. This is a good find and all changes look ok, but there's so much going on it's a headache to reverse engineer everything that's happening. Suggest making one change per commit or perhaps dropping some of the changes",
      "created_at" : "2020-04-27T13:51:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-619999960",
      "id" : 619999960,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxOTk5OTk2MA==",
      "updated_at" : "2020-04-27T13:51:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/619999960",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It is also interesting if the bug described https://github.com/bitcoin/bitcoin/pull/18742#issue-407482998 started happening recently. Unless I missed something, it seems like the bug has been present a very long time, and I wonder if #18524 made it more likely to happen.",
      "created_at" : "2020-04-27T13:55:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-620002392",
      "id" : 620002392,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMDAwMjM5Mg==",
      "updated_at" : "2020-04-27T13:55:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/620002392",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415856554"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415856554"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't know, the compiler told me to do it IIRC",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T14:23:41Z",
      "diff_hunk" : "@@ -874,7 +874,7 @@ static UniValue getblocktemplate(const JSONRPCRequest& request)\n     return result;\n }\n \n-class submitblock_StateCatcher : public CValidationInterface\n+class submitblock_StateCatcher final : public CValidationInterface",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415856554",
      "id" : 415856554,
      "in_reply_to_id" : 415827675,
      "line" : 877,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTg1NjU1NA==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 877,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 5,
      "pull_request_review_id" : 401002931,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415856554",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415857001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415857001"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, split the optimization into a separate commit",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T14:24:16Z",
      "diff_hunk" : "@@ -204,14 +204,12 @@ BOOST_AUTO_TEST_CASE(processnewblock_signals_ordering)\n     for (auto& t : threads) {\n         t.join();\n     }\n-    while (GetMainSignals().CallbacksPending() > 0) {\n-        UninterruptibleSleep(std::chrono::milliseconds{100});\n-    }\n+    SyncWithValidationInterfaceQueue();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415857001",
      "id" : 415857001,
      "in_reply_to_id" : 415828236,
      "line" : 207,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTg1NzAwMQ==",
      "original_commit_id" : "bbbbf387d9a35f095a80985810a461f87a21ebde",
      "original_line" : 207,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/test/validation_block_tests.cpp",
      "position" : 27,
      "pull_request_review_id" : 401003477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415857001",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Addressed feedback by @ryanofsky. No code changes, just more commits.",
      "created_at" : "2020-04-27T14:25:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-620020964",
      "id" : 620020964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMDAyMDk2NA==",
      "updated_at" : "2020-04-27T14:25:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/620020964",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415882262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415882262"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"test: Add unregister_validation_interface_race test\" (fa9f3a51897d5457492f84f7c8a41fea783d687d)\r\n\r\nNote: This commit is (intentionally) adding a broken test. The test is broken because it registering a subscriber object that can go out of scope while events are still being sent.\r\n\r\nMight be worth saying in the commit message that if the test happens to fail during a git bisect, failure is expected and commit can be marked skip.",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T14:53:21Z",
      "diff_hunk" : "@@ -12,6 +12,40 @@\n \n BOOST_FIXTURE_TEST_SUITE(validationinterface_tests, TestingSetup)\n \n+struct TestSubscriberNoop final : public CValidationInterface {\n+    void BlockChecked(const CBlock&, const BlockValidationState&) override {}\n+};\n+\n+BOOST_AUTO_TEST_CASE(unregister_validation_interface_race)\n+{\n+    std::atomic<bool> generate{true};\n+\n+    // Start thread to generate notifications\n+    std::thread gen{[&] {\n+        const CBlock block_dummy;\n+        const BlockValidationState state_dummy;\n+        while (generate) {\n+            GetMainSignals().BlockChecked(block_dummy, state_dummy);\n+        }\n+    }};\n+\n+    // Start thread to consume notifications\n+    std::thread sub{[&] {\n+        // keep going for about 1 sec, which is 250k iterations\n+        for (int i = 0; i < 250000; i++) {\n+            TestSubscriberNoop sub{};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415882262",
      "id" : 415882262,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTg4MjI2Mg==",
      "original_commit_id" : "fa9f3a51897d5457492f84f7c8a41fea783d687d",
      "original_line" : 36,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/test/validationinterface_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 401032474,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415882262",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415893114"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415893114"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks. Fixed.",
      "commit_id" : "fa6d1a04ed91514bb70e1c861888ea50c2b30e93",
      "created_at" : "2020-04-27T15:05:49Z",
      "diff_hunk" : "@@ -12,6 +12,40 @@\n \n BOOST_FIXTURE_TEST_SUITE(validationinterface_tests, TestingSetup)\n \n+struct TestSubscriberNoop final : public CValidationInterface {\n+    void BlockChecked(const CBlock&, const BlockValidationState&) override {}\n+};\n+\n+BOOST_AUTO_TEST_CASE(unregister_validation_interface_race)\n+{\n+    std::atomic<bool> generate{true};\n+\n+    // Start thread to generate notifications\n+    std::thread gen{[&] {\n+        const CBlock block_dummy;\n+        const BlockValidationState state_dummy;\n+        while (generate) {\n+            GetMainSignals().BlockChecked(block_dummy, state_dummy);\n+        }\n+    }};\n+\n+    // Start thread to consume notifications\n+    std::thread sub{[&] {\n+        // keep going for about 1 sec, which is 250k iterations\n+        for (int i = 0; i < 250000; i++) {\n+            TestSubscriberNoop sub{};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#discussion_r415893114",
      "id" : 415893114,
      "in_reply_to_id" : 415882262,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTg5MzExNA==",
      "original_commit_id" : "fa9f3a51897d5457492f84f7c8a41fea783d687d",
      "original_line" : 36,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/test/validationinterface_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 401044911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18742",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-27T15:05:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415893114",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Force pushed again. Still no code changes, just more text in commit bodies.",
      "created_at" : "2020-04-27T15:06:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-620044888",
      "id" : 620044888,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMDA0NDg4OA==",
      "updated_at" : "2020-04-27T15:06:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/620044888",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Open-Close to re-run ci. See https://github.com/bitcoin/bitcoin/issues/15847#issuecomment-487591130",
      "created_at" : "2020-04-28T12:57:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-620589423",
      "id" : 620589423,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMDU4OTQyMw==",
      "updated_at" : "2020-04-28T12:57:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/620589423",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag @fanquake  Mind to re-ACK?",
      "created_at" : "2020-05-06T13:06:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-624637352",
      "id" : 624637352,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNDYzNzM1Mg==",
      "updated_at" : "2020-05-06T13:06:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/624637352",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> This commit is (intentionally) adding a broken test. The test is broken\r\n> because it registering a subscriber object that can go out of scope\r\n> while events are still being sent.\r\n> \r\n> If the test happens to fail (e.g. during a git bisect), failure is\r\n> expected and commit can be marked skip.\r\n\r\nWhy add a broken test to the git history? Can't you just add the test as the final commit?",
      "created_at" : "2020-05-13T22:31:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628279682",
      "id" : 628279682,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODI3OTY4Mg==",
      "updated_at" : "2020-05-13T22:31:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628279682",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery you have to rebase the test without the fix to see the test failing. What you suggest is simpler with functional tests - you can go back and forth on python tests while using the same binary.\r\n\r\nMaybe add `[skip ci]` to commit.",
      "created_at" : "2020-05-13T22:35:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628281410",
      "id" : 628281410,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODI4MTQxMA==",
      "updated_at" : "2020-05-13T22:37:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628281410",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This still doesn't prevent new cases right? I think the following would fix current cases and prevent new ones:\r\n```diff\r\n@@ -129,12 +129,15 @@ void RegisterValidationInterface(CValidationInterface* callbacks)\r\n\r\n void UnregisterSharedValidationInterface(std::shared_ptr<CValidationInterface> callbacks)\r\n {\r\n-    UnregisterValidationInterface(callbacks.get());\r\n+    if (g_signals.m_internals) {\r\n+        g_signals.m_internals->Unregister(callbacks.get());\r\n+    }\r\n }\r\n\r\n void UnregisterValidationInterface(CValidationInterface* pwalletIn) {\r\n     if (g_signals.m_internals) {\r\n         g_signals.m_internals->Unregister(pwalletIn);\r\n+        SyncWithValidationInterfaceQueue();\r\n     }\r\n }\r\n```",
      "created_at" : "2020-05-13T22:48:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628285489",
      "id" : 628285489,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODI4NTQ4OQ==",
      "updated_at" : "2020-05-13T22:49:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628285489",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> you have to rebase the test without the fix to see the test failing.\r\n\r\n@promag - yes, I understand that, but the guidance I've always heard is to add tests afterwards in order to not break git bisect. That seems like a good policy to me. I don't understand what's different about this PR than others.",
      "created_at" : "2020-05-13T22:55:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628287865",
      "id" : 628287865,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODI4Nzg2NQ==",
      "updated_at" : "2020-05-13T22:55:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628287865",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery in this case it's the test that's fixed so what you suggest is to just add the ~~file~~ test and then explain how it could be broken. ",
      "created_at" : "2020-05-13T22:59:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628288900",
      "id" : 628288900,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODI4ODkwMA==",
      "updated_at" : "2020-05-13T22:59:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628288900",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I can put the test in `/** ... */` in the first commit. This way:\r\n\r\n* People can still reproduce by removing the `/**` and `*/` and then running the test in a loop until it fails.\r\n* The diff in the last commit is applied to the test in the same way that it is applied to the miner, \"proving\" the fix is correct.\r\n* It doesn't break git bisect (well to some extent, as the bug will always exist in the functional tests in previous commit until the fix commit, and the unit test passes anyway most of the time with address sanitizer enabled and probably passes all the time without sanitizers enabled)",
      "created_at" : "2020-05-13T23:50:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628304743",
      "id" : 628304743,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODMwNDc0Mw==",
      "updated_at" : "2020-05-13T23:50:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628304743",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Pushed an empty diff to defuse the test. Added instructions to the commit message on how to add the fuse back in.\r\n\r\n```\r\n$ git diff fa6d1a04ed 7777f2a4bb | wc\r\n      0       0       0\r\n",
      "created_at" : "2020-05-14T00:00:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628307538",
      "id" : 628307538,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODMwNzUzOA==",
      "updated_at" : "2020-05-14T00:00:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628307538",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke did you see https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628285489?",
      "created_at" : "2020-05-14T00:48:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628321002",
      "id" : 628321002,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODMyMTAwMg==",
      "updated_at" : "2020-05-14T00:48:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628321002",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag Yes, but that causes a deadlock on shutdown. Also the shutdown sequence should be bug free right now because the message handler is stopped before any unregisters should happen. I still like your idea, but I think it should be prepared, reviewed and merged for 0.21, not as a backport.\r\n\r\nFor the backport we should aim at a fix that has little chance of breaking stuff. The fix here should satisfy this because the same fix has already been applied to the wallet in #18338, which is also in 0.20",
      "created_at" : "2020-05-14T10:57:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628557221",
      "id" : 628557221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODU1NzIyMQ==",
      "updated_at" : "2020-05-14T10:57:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628557221",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 7777f2a4bb1f9d843bc50a4e35085cfbb2808780",
      "created_at" : "2020-05-14T11:21:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628568075",
      "id" : 628568075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODU2ODA3NQ==",
      "updated_at" : "2020-05-14T11:21:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628568075",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 7777f2a4bb1f9d843bc50a4e35085cfbb2808780.",
      "created_at" : "2020-05-14T11:43:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628578705",
      "id" : 628578705,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODU3ODcwNQ==",
      "updated_at" : "2020-05-14T11:43:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628578705",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "For backport, only the first and last commit are needed.",
      "created_at" : "2020-05-14T12:44:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628609299",
      "id" : 628609299,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODYwOTI5OQ==",
      "updated_at" : "2020-05-14T12:44:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628609299",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> For backport, only the first and last commit are needed.\r\n\r\nThanks. Will have this up in #18973 shortly.",
      "created_at" : "2020-05-14T12:48:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628611515",
      "id" : 628611515,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODYxMTUxNQ==",
      "updated_at" : "2020-05-14T12:48:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628611515",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "post merge code review ACK 7777f2a4bb1f9d843bc50a4e35085cfbb2808780",
      "created_at" : "2020-05-14T13:02:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18742#issuecomment-628619284",
      "id" : 628619284,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18742",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODYxOTI4NA==",
      "updated_at" : "2020-05-14T13:02:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628619284",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   }
]
