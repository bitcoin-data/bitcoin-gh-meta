[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20546 (policy, wallet, refactor: check for non-representable CFeeRates by jonatack)\n* #20323 (tests: Create or use existing properly initialized NodeContexts by dongcarl)\n* #20228 (addrman: Make addrman a top-level component by jnewbery)\n* #20217 (net: Remove g_relay_txes by jnewbery)\n* #19806 (validation: UTXO snapshot activation by jamesob)\n* #19652 (Avoid locking CTxMemPool::cs recursively in Mempool{Info}ToJSON() by hebasto)\n* #13990 (Allow fee estimation to work with lower fees by ajtowns)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-04-25T17:36:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-619414860",
      "id" : 619414860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxOTQxNDg2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-07T01:55:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/619414860",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r415650678"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415650678"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why read the file then? You could early check like:\r\n```cpp\r\n// Don't initialize fee estimation if we don't relay transactions.\r\nif (!g_relay_txes) {\r\n    fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\r\n    CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\r\n    if (!est_filein.IsNull()) ::feeEstimator.Read(est_filein);\r\n    fFeeEstimatesInitialized = true;\r\n}\r\n```\r\nThis also avoids writing to estimates file in `Shutdown`.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-04-27T09:20:00Z",
      "diff_hunk" : "@@ -1750,8 +1750,10 @@ bool AppInitMain(NodeContext& node)\n \n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n-    // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n+    // Allowed to fail as this file IS missing on first startup. Also, don't initialize\n+    // fee estimation with old data if we don't relay transactions, as they would never be\n+    // updated.\n+    if (!est_filein.IsNull() && g_relay_txes)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r415650678",
      "id" : 415650678,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY1MDY3OA==",
      "original_commit_id" : "9cf5c47e351054a2557f10732080d0abd7ce85be",
      "original_line" : 1756,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 400772886,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415650678",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r415668117"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415668117"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think\r\n```cpp\r\nfFeeEstimatesInitialized = true;\r\n```\r\nshould be set anyway ?\r\n\r\nWhat do you think about this conceptually ?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-04-27T09:45:46Z",
      "diff_hunk" : "@@ -1750,8 +1750,10 @@ bool AppInitMain(NodeContext& node)\n \n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n-    // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n+    // Allowed to fail as this file IS missing on first startup. Also, don't initialize\n+    // fee estimation with old data if we don't relay transactions, as they would never be\n+    // updated.\n+    if (!est_filein.IsNull() && g_relay_txes)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r415668117",
      "id" : 415668117,
      "in_reply_to_id" : 415650678,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY2ODExNw==",
      "original_commit_id" : "9cf5c47e351054a2557f10732080d0abd7ce85be",
      "original_line" : 1756,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 400792228,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415668117",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r415672000"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415672000"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think `fFeeEstimatesInitialized` exists to handle early shutdowns. But if you don't read estimates then writing will clear it right?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-04-27T09:51:31Z",
      "diff_hunk" : "@@ -1750,8 +1750,10 @@ bool AppInitMain(NodeContext& node)\n \n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n-    // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n+    // Allowed to fail as this file IS missing on first startup. Also, don't initialize\n+    // fee estimation with old data if we don't relay transactions, as they would never be\n+    // updated.\n+    if (!est_filein.IsNull() && g_relay_txes)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r415672000",
      "id" : 415672000,
      "in_reply_to_id" : 415650678,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY3MjAwMA==",
      "original_commit_id" : "9cf5c47e351054a2557f10732080d0abd7ce85be",
      "original_line" : 1756,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 400796497,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415672000",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r415677781"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415677781"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hmm right",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-04-27T10:00:03Z",
      "diff_hunk" : "@@ -1750,8 +1750,10 @@ bool AppInitMain(NodeContext& node)\n \n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n-    // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n+    // Allowed to fail as this file IS missing on first startup. Also, don't initialize\n+    // fee estimation with old data if we don't relay transactions, as they would never be\n+    // updated.\n+    if (!est_filein.IsNull() && g_relay_txes)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r415677781",
      "id" : 415677781,
      "in_reply_to_id" : 415650678,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY3Nzc4MQ==",
      "original_commit_id" : "9cf5c47e351054a2557f10732080d0abd7ce85be",
      "original_line" : 1756,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 400802965,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/415677781",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@promag : addressed your feedback. Would be interested about what do you think about disabling the fee estimation in `blocksonly` conceptually though.",
      "created_at" : "2020-04-27T10:28:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-619889201",
      "id" : 619889201,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxOTg4OTIwMQ==",
      "updated_at" : "2020-04-27T10:28:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/619889201",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK / Sounds reasonable.",
      "created_at" : "2020-04-30T17:37:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-621999260",
      "id" : 621999260,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMTk5OTI2MA==",
      "updated_at" : "2020-04-30T17:37:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/621999260",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. ",
      "created_at" : "2020-05-01T10:48:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-622341098",
      "id" : 622341098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjM0MTA5OA==",
      "updated_at" : "2020-05-01T10:48:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622341098",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, but I don't know enough about the underlying mechanism to be sure if this is a reasonable way to accomplish it.",
      "created_at" : "2020-05-04T14:37:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-623503344",
      "id" : 623503344,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMzUwMzM0NA==",
      "updated_at" : "2020-05-04T14:37:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/623503344",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Would be interested about what do you think about disabling the fee estimation in `blocksonly` conceptually though.\r\n\r\nSame opinion as above.",
      "created_at" : "2020-05-04T14:48:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-623509291",
      "id" : 623509291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMzUwOTI5MQ==",
      "updated_at" : "2020-05-04T14:48:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/623509291",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, while the fee estimation should work for some limited time after the mempool has been turned off (see https://github.com/bitcoin/bitcoin/issues/16840#issuecomment-529904220), I can see the point to fail early on startup instead of later at runtime.",
      "created_at" : "2020-05-04T15:03:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-623518006",
      "id" : 623518006,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMzUxODAwNg==",
      "updated_at" : "2020-05-04T15:03:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/623518006",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK 33ca35902435a162c526bf6c8bd82145585dfbd9",
      "created_at" : "2020-05-04T15:04:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-623518645",
      "id" : 623518645,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMzUxODY0NQ==",
      "updated_at" : "2020-05-04T15:04:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/623518645",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sdaftuar (ping because you reviewed the previous PR) : what do you think of this approach compared to the previous one ?\r\n\r\n@morcos (ping because you implemented the fee estimation) : what do you think of it implementation-wise ?",
      "created_at" : "2020-06-12T09:14:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-643168066",
      "id" : 643168066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MzE2ODA2Ng==",
      "updated_at" : "2020-06-12T09:14:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/643168066",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This was intended to be a \"quick fix\", but the approach seems to be too much of a workaround.\r\n\r\nI've reworked this to opt for a more involved approach based on #19556. This now:\r\n- Removes the fee estimator related globals.\r\n- Conditionally creates the fee estimator: if we don't relay transactions we don't even bother to allocate the `CBlockPolicyEstimator`.\r\n\r\nThis is rebased on top of #19556 (which i itself rebased on top of #19604).",
      "created_at" : "2020-07-29T16:14:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-665759886",
      "id" : 665759886,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NTc1OTg4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-29T16:14:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/665759886",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-07-30T14:29:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-666400604",
      "id" : 666400604,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NjQwMDYwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-30T14:29:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/666400604",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased on  #19556 now that the remove-mempool-global series is almost over.",
      "created_at" : "2020-09-06T20:07:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-687887730",
      "id" : 687887730,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4Nzg4NzczMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-06T20:07:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687887730",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, will review after 19556 goes in. ",
      "created_at" : "2020-09-06T20:16:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-687889938",
      "id" : 687889938,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4Nzg4OTkzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-06T20:16:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687889938",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-09-06T20:31:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-687893655",
      "id" : 687893655,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4Nzg5MzY1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-06T20:31:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687893655",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Intuitively, I don't think the mempool should 'own' the fee estimator, but rather I see the fee estimator as a client of the mempool. I'd suggest constructing the fee estimator in `AppInitMain()` and owning the memory in `NodeContext`, like the other components.",
      "created_at" : "2020-09-06T20:52:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-687898700",
      "id" : 687898700,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4Nzg5ODcwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-06T20:52:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687898700",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-09-07T09:15:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-688189666",
      "id" : 688189666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODE4OTY2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T09:15:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688189666",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Intuitively, I don't think the mempool should 'own' the fee estimator, but rather I see the fee estimator as a client of the mempool. I'd suggest constructing the fee estimator in AppInitMain() and owning the memory in NodeContext, like the other components.\r\n\r\nIt seems more intuitive to me for the mempool to own the fee estimator as the latter can not exist without the former, and it would otherwise be a potentially-uninitialized globally-accessible \"second class\" object ? I think of this as \"the mempool *may* provide fee estimation\".",
      "created_at" : "2020-09-08T10:04:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-688764055",
      "id" : 688764055,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODc2NDA1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T10:04:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688764055",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> it would otherwise be a potentially-uninitialized globally-accessible \"second class\" object\r\n\r\nThat depends on how you write the code. `NodeContext` holds (mostly) unique ptrs which may or may not be initialized. It's up to the components to make sure that they're using a component that is enabled (see, for example, the usage of banman in net_processing).\r\n\r\nFee estimator is currently a separate component from the mempool. Let's not add unnecessary coupling between the components by moving it inside the mempool. Decoupled components with well defined interfaces make it easier to reason about and test the code.",
      "created_at" : "2020-09-08T10:30:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-688777863",
      "id" : 688777863,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODc3Nzg2Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T10:30:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688777863",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Refactored to keep the feeEstimator as a separate component as per @jnewbery request (spoiler: it's cleaner now, i could even squash the first two commits).",
      "created_at" : "2020-09-08T17:07:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-689015609",
      "id" : 689015609,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4OTAxNTYwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-09T09:16:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/689015609",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485454601"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485454601"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is unused.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:02:00Z",
      "diff_hunk" : "@@ -577,6 +578,9 @@ class CTxMemPool\n     typedef std::set<txiter, CompareIteratorByHash> setEntries;\n \n     uint64_t CalculateDescendantMaximum(txiter entry) const EXCLUSIVE_LOCKS_REQUIRED(cs);\n+\n+    void initFeeEstimator(CAutoFile& est_file);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485454601",
      "id" : 485454601,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ1NDYwMQ==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 582,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/txmempool.h",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485454601",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485456244"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485456244"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why is this added?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:04:29Z",
      "diff_hunk" : "@@ -20,6 +20,7 @@\n #include <optional.h>\n #include <policy/feerate.h>\n #include <primitives/transaction.h>\n+#include <streams.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485456244",
      "id" : 485456244,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ1NjI0NA==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 23,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/txmempool.h",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485456244",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485458249"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485458249"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Join lines to fix up with current code style:\r\n\r\n`if (node.feeEstimator) {`\r\n\r\n(see https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#coding-style-c)",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:07:22Z",
      "diff_hunk" : "@@ -235,18 +234,18 @@ void Shutdown(NodeContext& node)\n         DumpMempool(*node.mempool);\n     }\n \n-    if (fFeeEstimatesInitialized)\n+    if (node.feeEstimator)\n     {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485458249",
      "id" : 485458249,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ1ODI0OQ==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 238,
      "original_position" : 14,
      "original_start_line" : 237,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485458249",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485458615"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485458615"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Again, fix up braces when touching adjacent lines.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:07:52Z",
      "diff_hunk" : "@@ -235,18 +234,18 @@ void Shutdown(NodeContext& node)\n         DumpMempool(*node.mempool);\n     }\n \n-    if (fFeeEstimatesInitialized)\n+    if (node.feeEstimator)\n     {\n-        ::feeEstimator.FlushUnconfirmed();\n+        node.feeEstimator->FlushUnconfirmed();\n         fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n         CAutoFile est_fileout(fsbridge::fopen(est_path, \"wb\"), SER_DISK, CLIENT_VERSION);\n         if (!est_fileout.IsNull())\n-            ::feeEstimator.Write(est_fileout);\n+            node.feeEstimator->Write(est_fileout);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485458615",
      "id" : 485458615,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ1ODYxNQ==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 242,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485458615",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485459450"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485459450"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think only `g_relay_txes` needs to be moved up here.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:09:07Z",
      "diff_hunk" : "@@ -1356,15 +1355,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485459450",
      "id" : 485459450,
      "line" : 1376,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ1OTQ1MA==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1376,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 49,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485459450",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485459823"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485459823"
         }
      },
      "author_association" : "MEMBER",
      "body" : "use braces for if block.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:09:36Z",
      "diff_hunk" : "@@ -1768,9 +1774,8 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n     // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n-        ::feeEstimator.Read(est_filein);\n-    fFeeEstimatesInitialized = true;\n+    if (node.feeEstimator && !est_filein.IsNull())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485459823",
      "id" : 485459823,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ1OTgyMw==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1777,
      "original_position" : 79,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485459823",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485460221"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485460221"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you can just use default initialization of `CFeeRate`:\r\n\r\n```suggestion\r\n        if (!m_node.feeEstimator) return {};\r\n```",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:10:11Z",
      "diff_hunk" : "@@ -327,11 +327,13 @@ class ChainImpl : public Chain\n     }\n     CFeeRate estimateSmartFee(int num_blocks, bool conservative, FeeCalculation* calc) override\n     {\n-        return ::feeEstimator.estimateSmartFee(num_blocks, calc, conservative);\n+        if (!m_node.feeEstimator) return CFeeRate(0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485460221",
      "id" : 485460221,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2MDIyMQ==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 330,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485460221",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485460740"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485460740"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why does this need to be shared? `NodeContext` should have unique ownership of the feeEstimator object.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:10:54Z",
      "diff_hunk" : "@@ -36,6 +37,7 @@ class WalletClient;\n struct NodeContext {\n     std::unique_ptr<CConnman> connman;\n     std::unique_ptr<CTxMemPool> mempool;\n+    std::shared_ptr<CBlockPolicyEstimator> feeEstimator;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485460740",
      "id" : 485460740,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2MDc0MA==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 40,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/node/context.h",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485460740",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485461954"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485461954"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How about extracting this to an `EnsureFeeEstimator()` function? (see `EnsureMemPool` and `EnsureChainman`)",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:12:40Z",
      "diff_hunk" : "@@ -1064,7 +1064,13 @@ static RPCHelpMan estimatesmartfee()\n {\n     RPCTypeCheck(request.params, {UniValue::VNUM, UniValue::VSTR});\n     RPCTypeCheckArgument(request.params[0], UniValue::VNUM);\n-    unsigned int max_target = ::feeEstimator.HighestTargetTracked(FeeEstimateHorizon::LONG_HALFLIFE);\n+\n+    NodeContext& node = EnsureNodeContext(request.context);\n+    if (!node.feeEstimator) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Fee estimation disabled\");\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485461954",
      "id" : 485461954,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2MTk1NA==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1071,
      "original_position" : 9,
      "original_start_line" : 1068,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485461954",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485464307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485464307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You don't need to make this change. The fee estimator's memory/lifetime is owned by `NodeContext`. This can continue being a raw pointer to that object (in the same way that `PeerManager` holds pointers and references to other components).\r\n\r\nNot making this change should reduce the diff of this PR considerably.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:15:57Z",
      "diff_hunk" : "@@ -331,7 +331,7 @@ void CTxMemPoolEntry::UpdateAncestorState(int64_t modifySize, CAmount modifyFee,\n     assert(int(nSigOpCostWithAncestors) >= 0);\n }\n \n-CTxMemPool::CTxMemPool(CBlockPolicyEstimator* estimator)\n+CTxMemPool::CTxMemPool(std::shared_ptr<CBlockPolicyEstimator> estimator)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485464307",
      "id" : 485464307,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2NDMwNw==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 334,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/txmempool.cpp",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485464307",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485466714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485466714"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Consider joining into one line for simple one-statement if blocks:\r\n\r\n```suggestion\r\n    if (g_relay_txes) node.feeEstimator = std::make_shared<CBlockPolicyEstimator>();\r\n```",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:19:45Z",
      "diff_hunk" : "@@ -1356,15 +1355,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    // Don't initialize fee estimation with old data if we don't relay transactions,\n+    // as they would never get updated.\n+    assert(!node.feeEstimator);\n+    if (g_relay_txes) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485466714",
      "id" : 485466714,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2NjcxNA==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1362,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485466714",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485467428"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485467428"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You're constructing the fee estimator here. You should destruct it on shutdown. At line 304 (after the `node.mempool` unique ptr is reset), you should reset this ptr too.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:20:51Z",
      "diff_hunk" : "@@ -1356,15 +1355,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    // Don't initialize fee estimation with old data if we don't relay transactions,\n+    // as they would never get updated.\n+    assert(!node.feeEstimator);\n+    if (g_relay_txes) {\n+        node.feeEstimator = std::make_shared<CBlockPolicyEstimator>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485467428",
      "id" : 485467428,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2NzQyOA==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1372,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485467428",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485468022"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485468022"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You only need to test this on one node.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:21:54Z",
      "diff_hunk" : "@@ -263,6 +264,13 @@ def run_test(self):\n         self.log.info(\"Final estimates after emptying mempools\")\n         check_estimates(self.nodes[1], self.fees_per_kb)\n \n+        self.log.info(\"Testing that fee estimation is disabled in blocksonly.\")\n+        self.stop_nodes()\n+        self.start_nodes(extra_args=[[\"-blocksonly\"]] * len(self.nodes))\n+        for node in self.nodes:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485468022",
      "id" : 485468022,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2ODAyMg==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 270,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 484805297,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485468022",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485469249"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485469249"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Argh, leftover from the refactor..",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:23:48Z",
      "diff_hunk" : "@@ -577,6 +578,9 @@ class CTxMemPool\n     typedef std::set<txiter, CompareIteratorByHash> setEntries;\n \n     uint64_t CalculateDescendantMaximum(txiter entry) const EXCLUSIVE_LOCKS_REQUIRED(cs);\n+\n+    void initFeeEstimator(CAutoFile& est_file);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485469249",
      "id" : 485469249,
      "in_reply_to_id" : 485454601,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2OTI0OQ==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 582,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/txmempool.h",
      "position" : null,
      "pull_request_review_id" : 484823756,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485469249",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485469773"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485469773"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Same, was for CAutoFile",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:24:36Z",
      "diff_hunk" : "@@ -20,6 +20,7 @@\n #include <optional.h>\n #include <policy/feerate.h>\n #include <primitives/transaction.h>\n+#include <streams.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485469773",
      "id" : 485469773,
      "in_reply_to_id" : 485456244,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ2OTc3Mw==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 23,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/txmempool.h",
      "position" : null,
      "pull_request_review_id" : 484824437,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485469773",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485471403"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485471403"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah but it made sense to keep them all grouped imho",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:27:00Z",
      "diff_hunk" : "@@ -1356,15 +1355,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485471403",
      "id" : 485471403,
      "in_reply_to_id" : 485459450,
      "line" : 1376,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ3MTQwMw==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1376,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 49,
      "pull_request_review_id" : 484826364,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485471403",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485472650"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485472650"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I thought `EnsureXX()` were used for components that should not be absent, while the fee estimator may be ?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:29:03Z",
      "diff_hunk" : "@@ -1064,7 +1064,13 @@ static RPCHelpMan estimatesmartfee()\n {\n     RPCTypeCheck(request.params, {UniValue::VNUM, UniValue::VSTR});\n     RPCTypeCheckArgument(request.params[0], UniValue::VNUM);\n-    unsigned int max_target = ::feeEstimator.HighestTargetTracked(FeeEstimateHorizon::LONG_HALFLIFE);\n+\n+    NodeContext& node = EnsureNodeContext(request.context);\n+    if (!node.feeEstimator) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Fee estimation disabled\");\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485472650",
      "id" : 485472650,
      "in_reply_to_id" : 485461954,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ3MjY1MA==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1071,
      "original_position" : 9,
      "original_start_line" : 1068,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 484827984,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485472650",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485474344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485474344"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Dropped this somehow.. Fixing now.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:31:45Z",
      "diff_hunk" : "@@ -1356,15 +1355,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    // Don't initialize fee estimation with old data if we don't relay transactions,\n+    // as they would never get updated.\n+    assert(!node.feeEstimator);\n+    if (g_relay_txes) {\n+        node.feeEstimator = std::make_shared<CBlockPolicyEstimator>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485474344",
      "id" : 485474344,
      "in_reply_to_id" : 485467428,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ3NDM0NA==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1372,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 484830116,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485474344",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485477681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485477681"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it's fine to add `EnsureXX()` for components that may not be enabled. Does that sound right to you @MarcoFalke ?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T09:37:18Z",
      "diff_hunk" : "@@ -1064,7 +1064,13 @@ static RPCHelpMan estimatesmartfee()\n {\n     RPCTypeCheck(request.params, {UniValue::VNUM, UniValue::VSTR});\n     RPCTypeCheckArgument(request.params[0], UniValue::VNUM);\n-    unsigned int max_target = ::feeEstimator.HighestTargetTracked(FeeEstimateHorizon::LONG_HALFLIFE);\n+\n+    NodeContext& node = EnsureNodeContext(request.context);\n+    if (!node.feeEstimator) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Fee estimation disabled\");\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485477681",
      "id" : 485477681,
      "in_reply_to_id" : 485461954,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ3NzY4MQ==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1071,
      "original_position" : 9,
      "original_start_line" : 1068,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 484834509,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485477681",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485492587"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485492587"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It doesn't make sense to call `estimatesmartfee` without the fee estimator. So yes, `EnsureFeeEstimator` is the way to go right now. (In the future the fee estimator can register the RPC itself, so when it is missing, the RPC won't even be there)",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T10:02:11Z",
      "diff_hunk" : "@@ -1064,7 +1064,13 @@ static RPCHelpMan estimatesmartfee()\n {\n     RPCTypeCheck(request.params, {UniValue::VNUM, UniValue::VSTR});\n     RPCTypeCheckArgument(request.params[0], UniValue::VNUM);\n-    unsigned int max_target = ::feeEstimator.HighestTargetTracked(FeeEstimateHorizon::LONG_HALFLIFE);\n+\n+    NodeContext& node = EnsureNodeContext(request.context);\n+    if (!node.feeEstimator) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Fee estimation disabled\");\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485492587",
      "id" : 485492587,
      "in_reply_to_id" : 485461954,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ5MjU4Nw==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1071,
      "original_position" : 9,
      "original_start_line" : 1068,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 484853837,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485492587",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485494099"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485494099"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, fixed",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T10:04:46Z",
      "diff_hunk" : "@@ -36,6 +37,7 @@ class WalletClient;\n struct NodeContext {\n     std::unique_ptr<CConnman> connman;\n     std::unique_ptr<CTxMemPool> mempool;\n+    std::shared_ptr<CBlockPolicyEstimator> feeEstimator;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485494099",
      "id" : 485494099,
      "in_reply_to_id" : 485460740,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ5NDA5OQ==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 40,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/node/context.h",
      "position" : null,
      "pull_request_review_id" : 484855831,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485494099",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485500587"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485500587"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> In the future the fee estimator can register the RPC itself, so when it is missing, the RPC won't even be there\r\n\r\nHmm that would be particularly nice, as for example applications up the stack relying on fee estimation would be able to just error at startup rather than \"check and see if it errors\". Might propose a follow-up implementing this.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T10:15:59Z",
      "diff_hunk" : "@@ -1064,7 +1064,13 @@ static RPCHelpMan estimatesmartfee()\n {\n     RPCTypeCheck(request.params, {UniValue::VNUM, UniValue::VSTR});\n     RPCTypeCheckArgument(request.params[0], UniValue::VNUM);\n-    unsigned int max_target = ::feeEstimator.HighestTargetTracked(FeeEstimateHorizon::LONG_HALFLIFE);\n+\n+    NodeContext& node = EnsureNodeContext(request.context);\n+    if (!node.feeEstimator) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Fee estimation disabled\");\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485500587",
      "id" : 485500587,
      "in_reply_to_id" : 485461954,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTUwMDU4Nw==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 1071,
      "original_position" : 9,
      "original_start_line" : 1068,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 484863980,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485500587",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485503096"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485503096"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, amended to only start and test on one node.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T10:20:47Z",
      "diff_hunk" : "@@ -263,6 +264,13 @@ def run_test(self):\n         self.log.info(\"Final estimates after emptying mempools\")\n         check_estimates(self.nodes[1], self.fees_per_kb)\n \n+        self.log.info(\"Testing that fee estimation is disabled in blocksonly.\")\n+        self.stop_nodes()\n+        self.start_nodes(extra_args=[[\"-blocksonly\"]] * len(self.nodes))\n+        for node in self.nodes:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485503096",
      "id" : 485503096,
      "in_reply_to_id" : 485468022,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTUwMzA5Ng==",
      "original_commit_id" : "3ac3a2f3c8ad24567ad0c961f8815af71912eda4",
      "original_line" : 270,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 484867155,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485503096",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485543436"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485543436"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this flag might protect us from overwriting the estimates.dat file in case we abort start-up for some reason. Rather than removing it entirely, I think it should be moved to CBlockPolicyEstimator, and then checked on destruction.\r\n\r\nIf you really wanted to encaptulate this better, you could move this file read logic to the feeEstimator constructor, and the flush logic to a public flush method in CBlockPolicyEstimator, and hide all the construction/destruction logic from init.cpp.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T11:39:31Z",
      "diff_hunk" : "@@ -1768,10 +1774,9 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n     // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n-        ::feeEstimator.Read(est_filein);\n-    fFeeEstimatesInitialized = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485543436",
      "id" : 485543436,
      "line" : 1793,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTU0MzQzNg==",
      "original_commit_id" : "6e3313019010c27868da4925bf48d141c3e0208c",
      "original_line" : 1793,
      "original_position" : 88,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 92,
      "pull_request_review_id" : 484919437,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485543436",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485588776"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485588776"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    std::unique_ptr<CBlockPolicyEstimator> fee_estimator;\r\n```\r\nfor new code",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T12:56:14Z",
      "diff_hunk" : "@@ -36,6 +37,7 @@ class WalletClient;\n struct NodeContext {\n     std::unique_ptr<CConnman> connman;\n     std::unique_ptr<CTxMemPool> mempool;\n+    std::unique_ptr<CBlockPolicyEstimator> feeEstimator;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485588776",
      "id" : 485588776,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTU4ODc3Ng==",
      "original_commit_id" : "6e3313019010c27868da4925bf48d141c3e0208c",
      "original_line" : 40,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/node/context.h",
      "position" : null,
      "pull_request_review_id" : 484978123,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485588776",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485590033"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485590033"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    CBlockPolicyEstimator& fee_estimator = EnsureFeeEstimator(request.context);\r\n```\r\n\r\nsnake case for new code ;)",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T12:58:13Z",
      "diff_hunk" : "@@ -1064,7 +1064,10 @@ static RPCHelpMan estimatesmartfee()\n {\n     RPCTypeCheck(request.params, {UniValue::VNUM, UniValue::VSTR});\n     RPCTypeCheckArgument(request.params[0], UniValue::VNUM);\n-    unsigned int max_target = ::feeEstimator.HighestTargetTracked(FeeEstimateHorizon::LONG_HALFLIFE);\n+\n+    CBlockPolicyEstimator& feeEstimator = EnsureFeeEstimator(request.context);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485590033",
      "id" : 485590033,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTU5MDAzMw==",
      "original_commit_id" : "6e3313019010c27868da4925bf48d141c3e0208c",
      "original_line" : 1068,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 484979800,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485590033",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485626919"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485626919"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good catch. Went for the encapsulation way, will push a commit.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T13:49:44Z",
      "diff_hunk" : "@@ -1768,10 +1774,9 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n     // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n-        ::feeEstimator.Read(est_filein);\n-    fFeeEstimatesInitialized = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485626919",
      "id" : 485626919,
      "in_reply_to_id" : 485543436,
      "line" : 1793,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTYyNjkxOQ==",
      "original_commit_id" : "6e3313019010c27868da4925bf48d141c3e0208c",
      "original_line" : 1793,
      "original_position" : 88,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 92,
      "pull_request_review_id" : 485028663,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485626919",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485655086"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485655086"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks! Amended",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T14:26:06Z",
      "diff_hunk" : "@@ -1064,7 +1064,10 @@ static RPCHelpMan estimatesmartfee()\n {\n     RPCTypeCheck(request.params, {UniValue::VNUM, UniValue::VSTR});\n     RPCTypeCheckArgument(request.params[0], UniValue::VNUM);\n-    unsigned int max_target = ::feeEstimator.HighestTargetTracked(FeeEstimateHorizon::LONG_HALFLIFE);\n+\n+    CBlockPolicyEstimator& feeEstimator = EnsureFeeEstimator(request.context);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485655086",
      "id" : 485655086,
      "in_reply_to_id" : 485590033,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTY1NTA4Ng==",
      "original_commit_id" : "6e3313019010c27868da4925bf48d141c3e0208c",
      "original_line" : 1068,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 485066417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485655086",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Amended to use snake case, and added a commit to encapsulate the management of the fee estimation file in `CBlockPolicyEstimator`.",
      "created_at" : "2020-09-09T15:35:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-689642600",
      "id" : 689642600,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4OTY0MjYwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-09T15:35:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/689642600",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485720809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485720809"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You don't need a separate function for this since it's only called in one place. You can just insert this code into the constructor.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T15:53:27Z",
      "diff_hunk" : "@@ -886,8 +902,14 @@ bool CBlockPolicyEstimator::Write(CAutoFile& fileout) const\n     return true;\n }\n \n-bool CBlockPolicyEstimator::Read(CAutoFile& filein)\n-{\n+bool CBlockPolicyEstimator::ReadEstFile() {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485720809",
      "id" : 485720809,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTcyMDgwOQ==",
      "original_commit_id" : "941806deef3224ae0e7548bc33abfd041b40730b",
      "original_line" : 905,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 485153270,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485720809",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485721671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485721671"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Moving this code to the destructor may be a behaviour change, since there will have been changes to the mempool in the intervening period. I suggest adding a public flush method and calling it here to avoid the behaviour change.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T15:54:41Z",
      "diff_hunk" : "@@ -1768,10 +1774,9 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n     // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n-        ::feeEstimator.Read(est_filein);\n-    fFeeEstimatesInitialized = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485721671",
      "id" : 485721671,
      "in_reply_to_id" : 485543436,
      "line" : 1793,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTcyMTY3MQ==",
      "original_commit_id" : "6e3313019010c27868da4925bf48d141c3e0208c",
      "original_line" : 1793,
      "original_position" : 88,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 92,
      "pull_request_review_id" : 485153270,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485721671",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485722181"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485722181"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you move this line inside the constructor and avoid changing the signature of the constructor?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T15:55:22Z",
      "diff_hunk" : "@@ -1356,15 +1344,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    // Don't initialize fee estimation with old data if we don't relay transactions,\n+    // as they would never get updated.\n+    if (g_relay_txes) {\n+        fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485722181",
      "id" : 485722181,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTcyMjE4MQ==",
      "original_commit_id" : "941806deef3224ae0e7548bc33abfd041b40730b",
      "original_line" : 1363,
      "original_position" : 52,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 485153270,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485722181",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485734447"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485734447"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thought it would be better to keep the filename constants in init ?..",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T16:09:50Z",
      "diff_hunk" : "@@ -1356,15 +1344,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    // Don't initialize fee estimation with old data if we don't relay transactions,\n+    // as they would never get updated.\n+    if (g_relay_txes) {\n+        fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485734447",
      "id" : 485734447,
      "in_reply_to_id" : 485722181,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTczNDQ0Nw==",
      "original_commit_id" : "941806deef3224ae0e7548bc33abfd041b40730b",
      "original_line" : 1363,
      "original_position" : 52,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 485179727,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485734447",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485741177"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485741177"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, i initially swapped the two calls to `reset()`, but as you prefer.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T16:16:54Z",
      "diff_hunk" : "@@ -1768,10 +1774,9 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n     // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n-        ::feeEstimator.Read(est_filein);\n-    fFeeEstimatesInitialized = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485741177",
      "id" : 485741177,
      "in_reply_to_id" : 485543436,
      "line" : 1793,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc0MTE3Nw==",
      "original_commit_id" : "6e3313019010c27868da4925bf48d141c3e0208c",
      "original_line" : 1793,
      "original_position" : 88,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 92,
      "pull_request_review_id" : 485185677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485741177",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485748468"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485748468"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No need. If it's only used in policy/fees.cpp you can move the constant there.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-09T16:25:16Z",
      "diff_hunk" : "@@ -1356,15 +1344,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    // Don't initialize fee estimation with old data if we don't relay transactions,\n+    // as they would never get updated.\n+    if (g_relay_txes) {\n+        fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r485748468",
      "id" : 485748468,
      "in_reply_to_id" : 485722181,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc0ODQ2OA==",
      "original_commit_id" : "941806deef3224ae0e7548bc33abfd041b40730b",
      "original_line" : 1363,
      "original_position" : 52,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 485192508,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485748468",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This is very confusing. In your latest branch you're now calling `FlushUnconfirmed()` twice, which is definitely a behaviour change. I don't think you need to change the dtor at all, or the interface for the ctor.\r\n\r\nSee https://github.com/jnewbery/bitcoin/tree/pr18766.1. The only thing that has to change is a new `flush()` function is added and some logic is moved inside the `CBlockPolicyEstimator` class.",
      "created_at" : "2020-09-10T09:47:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-690120291",
      "id" : 690120291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDEyMDI5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T09:47:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690120291",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> This is very confusing. In your latest branch you're now calling FlushUnconfirmed() twice, which is definitely a behaviour change. I don't think you need to change the dtor at all, or the interface for the ctor.\r\n\r\nI pushed in a hurry yesterday, and noticed this afterwards. Will fix this and the rest as soon as possible, but want to take some time for that to avoid wasting your time (and potentially others' too) again by pushing half-baked patches. Coming back to it soon (:tm:)",
      "created_at" : "2020-09-10T10:42:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-690147319",
      "id" : 690147319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDE0NzMxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T10:42:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690147319",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486319537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486319537"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, done.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-10T13:05:35Z",
      "diff_hunk" : "@@ -1356,15 +1344,27 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    // Don't initialize fee estimation with old data if we don't relay transactions,\n+    // as they would never get updated.\n+    if (g_relay_txes) {\n+        fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486319537",
      "id" : 486319537,
      "in_reply_to_id" : 485722181,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMxOTUzNw==",
      "original_commit_id" : "941806deef3224ae0e7548bc33abfd041b40730b",
      "original_line" : 1363,
      "original_position" : 52,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 485907719,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486319537",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, it should be in a reviewable state now. This:\r\n- Moves the fee estimator from a global to the node context.\r\n- Encapsulates the `fee_estimates.dat` logic in CBlockPolicyEstimator.\r\n- Avoid creating the fee estimator at all if we don't relay transactions.",
      "created_at" : "2020-09-10T13:10:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-690276791",
      "id" : 690276791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDI3Njc5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T13:10:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690276791",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486334984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486334984"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why are you moving this to the destructor? Are we sure that nothing happens to the fee estimator's state between  https://github.com/bitcoin/bitcoin/pull/18766/files#diff-c865a8939105e6350a50af02766291b7R236 and https://github.com/bitcoin/bitcoin/pull/18766/files#diff-c865a8939105e6350a50af02766291b7R294?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-10T13:27:23Z",
      "diff_hunk" : "@@ -504,10 +507,27 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"rb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Read(est_file)) {\n+        LogPrintf(\"%s: Failed to read fee estimates from %s\\n\", __func__, est_filepath.string());\n+    }\n }\n \n CBlockPolicyEstimator::~CBlockPolicyEstimator()\n {\n+    // If the fee estimation file is present, record current estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"wb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Write(est_file)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486334984",
      "id" : 486334984,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMzNDk4NA==",
      "original_commit_id" : "d84b4b9d66c06361c40f033bee0a6ddbddd549a4",
      "original_line" : 528,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 485927978,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486334984",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486415217"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486415217"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right. What do you think of instead exposing a `RecordEstimation()` method to the `CBlockPolicyEstimator` ?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-10T15:01:58Z",
      "diff_hunk" : "@@ -504,10 +507,27 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"rb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Read(est_file)) {\n+        LogPrintf(\"%s: Failed to read fee estimates from %s\\n\", __func__, est_filepath.string());\n+    }\n }\n \n CBlockPolicyEstimator::~CBlockPolicyEstimator()\n {\n+    // If the fee estimation file is present, record current estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"wb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Write(est_file)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486415217",
      "id" : 486415217,
      "in_reply_to_id" : 486334984,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQxNTIxNw==",
      "original_commit_id" : "d84b4b9d66c06361c40f033bee0a6ddbddd549a4",
      "original_line" : 528,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 486030196,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486415217",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486470802"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486470802"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Was there a reason you didn't like the flush() method in https://github.com/jnewbery/bitcoin/tree/pr18766.1?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-10T16:18:43Z",
      "diff_hunk" : "@@ -504,10 +507,27 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"rb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Read(est_file)) {\n+        LogPrintf(\"%s: Failed to read fee estimates from %s\\n\", __func__, est_filepath.string());\n+    }\n }\n \n CBlockPolicyEstimator::~CBlockPolicyEstimator()\n {\n+    // If the fee estimation file is present, record current estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"wb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Write(est_file)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486470802",
      "id" : 486470802,
      "in_reply_to_id" : 486334984,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3MDgwMg==",
      "original_commit_id" : "d84b4b9d66c06361c40f033bee0a6ddbddd549a4",
      "original_line" : 528,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 486103090,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486470802",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486479894"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486479894"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok didn't see this. Had a version with both the FlushUnconfirmed() and RecordEstimation() separated locally. Grouping them and pushing in a minute !",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-09-10T16:32:46Z",
      "diff_hunk" : "@@ -504,10 +507,27 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"rb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Read(est_file)) {\n+        LogPrintf(\"%s: Failed to read fee estimates from %s\\n\", __func__, est_filepath.string());\n+    }\n }\n \n CBlockPolicyEstimator::~CBlockPolicyEstimator()\n {\n+    // If the fee estimation file is present, record current estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"wb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Write(est_file)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r486479894",
      "id" : 486479894,
      "in_reply_to_id" : 486334984,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3OTg5NA==",
      "original_commit_id" : "d84b4b9d66c06361c40f033bee0a6ddbddd549a4",
      "original_line" : 528,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 486114381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486479894",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 4105c63a67a40fe109b2f2c020c9fbf25d1fc250\r\n\r\nIf you retouch this, you can remove the policy/fees.h #include in validation.cpp:\r\n\r\n```diff\r\ndiff --git a/src/validation.cpp b/src/validation.cpp\r\nindex 86d18a9d7f..7d60dd6e20 100644\r\n--- a/src/validation.cpp\r\n+++ b/src/validation.cpp\r\n@@ -22,7 +22,6 @@\r\n #include <logging/timer.h>\r\n #include <node/ui_interface.h>\r\n #include <optional.h>\r\n-#include <policy/fees.h>\r\n #include <policy/policy.h>\r\n #include <policy/settings.h>\r\n #include <pow.h>\r\n```",
      "created_at" : "2020-09-11T12:55:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-691077647",
      "id" : 691077647,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MTA3NzY0Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-11T12:55:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691077647",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Code review ACK 4105c63a67a40fe109b2f2c020c9fbf25d1fc250\r\n\r\nIf you retouch you could also check the description of 4105c63a67a40fe109b2f2c020c9fbf25d1fc250, which saying logic has move to the destructor while it is actually in the `Flush()` method now.",
      "created_at" : "2020-09-12T12:28:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-691480388",
      "id" : 691480388,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MTQ4MDM4OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-12T12:28:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691480388",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "~Oh, one more thing - you could make the git commit logs just a little more verbose. No need to write an essay, but just a short justification for the changes.~\r\n\r\nEDIT: oops. I left this comment on the wrong PR. The commit logs look fine. Sorry for the noise.",
      "created_at" : "2020-10-21T09:15:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-713430502",
      "id" : 713430502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMzQzMDUwMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-21T10:25:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/713430502",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, did not want to invalidate the ACKs but now it didn't make it in before the feature freeze, i'll address both your comments.\n\nâââââââ Original Message âââââââ\nLe mercredi, octobre 21, 2020 11:16 AM, John Newbery <notifications@github.com> a Ã©crit :\n\n> Oh, one more thing - you could make the git commit logs just a little more verbose. No need to write an essay, but just a short justification for the changes.\n>\n> â\n> You are receiving this because you authored the thread.\n> Reply to this email directly, [view it on GitHub](https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-713430502), or [unsubscribe](https://github.com/notifications/unsubscribe-auth/AFLK3F7VQKCDVYV26ZFRYSDSL2RFNANCNFSM4MQ2ROMA).",
      "created_at" : "2020-10-21T09:19:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-713432721",
      "id" : 713432721,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMzQzMjcyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-21T09:19:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/713432721",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-10-21T13:33:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-713578102",
      "id" : 713578102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMzU3ODEwMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-21T13:33:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/713578102",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510085372"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510085372"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you should keep this assert.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-10-22T11:28:13Z",
      "diff_hunk" : "@@ -1384,13 +1384,19 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n-    assert(!node.fee_estimator);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510085372",
      "id" : 510085372,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4NTM3Mg==",
      "original_commit_id" : "c3c145b72bcab57455f84dcab20dd040d2c42936",
      "original_line" : 1392,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 514624012,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510085372",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased. Addressed @jnewbery and @fjahr nits.",
      "created_at" : "2020-10-22T11:30:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-714429714",
      "id" : 714429714,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNDQyOTcxNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-22T11:30:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714429714",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510089535"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510089535"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good catch, will re-add it if i have to retouch.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-10-22T11:36:07Z",
      "diff_hunk" : "@@ -1384,13 +1384,19 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n-    assert(!node.fee_estimator);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510089535",
      "id" : 510089535,
      "in_reply_to_id" : 510085372,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4OTUzNQ==",
      "original_commit_id" : "c3c145b72bcab57455f84dcab20dd040d2c42936",
      "original_line" : 1392,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 514629529,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510089535",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510104576"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510104576"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just re-add it now. I'm the only person who's ACKed the latest head and I'm happy to reACK.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-10-22T12:03:16Z",
      "diff_hunk" : "@@ -1384,13 +1384,19 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n-    assert(!node.fee_estimator);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510104576",
      "id" : 510104576,
      "in_reply_to_id" : 510085372,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEwNDU3Ng==",
      "original_commit_id" : "c3c145b72bcab57455f84dcab20dd040d2c42936",
      "original_line" : 1392,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 514648920,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510104576",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510105898"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510105898"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, done.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-10-22T12:05:27Z",
      "diff_hunk" : "@@ -1384,13 +1384,19 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n-    assert(!node.fee_estimator);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510105898",
      "id" : 510105898,
      "in_reply_to_id" : 510085372,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEwNTg5OA==",
      "original_commit_id" : "c3c145b72bcab57455f84dcab20dd040d2c42936",
      "original_line" : 1392,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 514650618,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510105898",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 4aaad74c4c8a24c4b67af4e92c29805b923f2225",
      "created_at" : "2020-10-22T12:23:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-714456924",
      "id" : 714456924,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNDQ1NjkyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-22T12:23:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714456924",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510117016"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510117016"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks!",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-10-22T12:23:55Z",
      "diff_hunk" : "@@ -1384,13 +1384,19 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     // is not yet setup and may end up being set up twice if we\n     // need to reindex later.\n \n+    // see Step 2: parameter interactions for more information about these\n+    fListen = args.GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n+    fDiscover = args.GetBoolArg(\"-discover\", true);\n+    g_relay_txes = !args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);\n+\n     assert(!node.banman);\n     node.banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", &uiInterface, args.GetArg(\"-bantime\", DEFAULT_MISBEHAVING_BANTIME));\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n-    assert(!node.fee_estimator);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r510117016",
      "id" : 510117016,
      "in_reply_to_id" : 510085372,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDExNzAxNg==",
      "original_commit_id" : "c3c145b72bcab57455f84dcab20dd040d2c42936",
      "original_line" : 1392,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 514665688,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510117016",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Code review ACK 4aaad74c4c8a24c4b67af4e92c29805b923f2225",
      "created_at" : "2020-10-25T11:06:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-716129113",
      "id" : 716129113,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNjEyOTExMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-25T11:06:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/716129113",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Hi @darosior :) quick question: Will serving outdated fee data not also be a problem if the node has been off for a while and the fee estimation files are just stale in general? i.e would it not perhaps be useful to look at 'last-updated' time on the data and then starting fresh if the data is too old?",
      "created_at" : "2020-10-31T10:03:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-719912391",
      "id" : 719912391,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxOTkxMjM5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-31T10:03:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/719912391",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/25280249?v=4",
         "events_url" : "https://api.github.com/users/ellemouton/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ellemouton/followers",
         "following_url" : "https://api.github.com/users/ellemouton/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ellemouton/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ellemouton",
         "id" : 25280249,
         "login" : "ellemouton",
         "node_id" : "MDQ6VXNlcjI1MjgwMjQ5",
         "organizations_url" : "https://api.github.com/users/ellemouton/orgs",
         "received_events_url" : "https://api.github.com/users/ellemouton/received_events",
         "repos_url" : "https://api.github.com/users/ellemouton/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ellemouton/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ellemouton/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ellemouton"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Hi @ellemouton, fortunately we discard these estimations already. If the node has been off for a while, we'll exponentially [decay the estimation as we connect new blocks](https://github.com/bitcoin/bitcoin/blob/42b66a6b814bca130a9ccf0a3f747cf33d628232/src/policy/fees.cpp#L575-L622) :).\r\n\r\nEDIT: to give slightly more context, if however the node is turned back on after a short period of time the estimation will instead be relatively quickly updated as we are sent new unconfirmed transaction. This PR fixes the edge case introduced by blocksonly (which was turned into a bug by fee sensitive applications such as the Lightning Network): the estimation isn't yet decayed and we told our peer not to send us unconfirmed transactions, so we are stuck we the stalled estimation!",
      "created_at" : "2020-10-31T11:42:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-719922447",
      "id" : 719922447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxOTkyMjQ0Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-31T11:49:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/719922447",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Aha! That makes sense. Thanks for the context @darosior ð ",
      "created_at" : "2020-10-31T13:50:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-719936855",
      "id" : 719936855,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxOTkzNjg1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-31T13:50:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/719936855",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/25280249?v=4",
         "events_url" : "https://api.github.com/users/ellemouton/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ellemouton/followers",
         "following_url" : "https://api.github.com/users/ellemouton/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ellemouton/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ellemouton",
         "id" : 25280249,
         "login" : "ellemouton",
         "node_id" : "MDQ6VXNlcjI1MjgwMjQ5",
         "organizations_url" : "https://api.github.com/users/ellemouton/orgs",
         "received_events_url" : "https://api.github.com/users/ellemouton/received_events",
         "repos_url" : "https://api.github.com/users/ellemouton/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ellemouton/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ellemouton/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ellemouton"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533133324"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533133324"
         }
      },
      "author_association" : "MEMBER",
      "body" : "cc21167415aa01db862035cd07b6b9b35fb53f35\r\n\r\nThis is not a refactor. Shutting down before this line will wipe the estimates on disk",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T07:53:36Z",
      "diff_hunk" : "@@ -1795,10 +1798,9 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n     // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n-        ::feeEstimator.Read(est_filein);\n-    fFeeEstimatesInitialized = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533133324",
      "id" : 533133324,
      "line" : 1793,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzEzMzMyNA==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 1793,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 92,
      "pull_request_review_id" : 541563210,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533133324",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533149720"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533149720"
         }
      },
      "author_association" : "MEMBER",
      "body" : "cc21167415aa01db862035cd07b6b9b35fb53f35\r\n\r\nwould be nice if new code used `std::make_unique` instead of the deprecated wrapper\r\n\r\n(needs rebase for that)",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T08:24:57Z",
      "diff_hunk" : "@@ -1389,10 +1389,13 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    assert(!node.fee_estimator);\n+    node.fee_estimator = MakeUnique<CBlockPolicyEstimator>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533149720",
      "id" : 533149720,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzE0OTcyMA==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 1393,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 541563210,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533149720",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533149926"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533149926"
         }
      },
      "author_association" : "MEMBER",
      "body" : "same",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T08:25:15Z",
      "diff_hunk" : "@@ -141,7 +142,9 @@ TestingSetup::TestingSetup(const std::string& chainName, const std::vector<const\n \n     pblocktree.reset(new CBlockTreeDB(1 << 20, true));\n \n-    m_node.mempool = MakeUnique<CTxMemPool>(&::feeEstimator);\n+    m_node.fee_estimator = MakeUnique<CBlockPolicyEstimator>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533149926",
      "id" : 533149926,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzE0OTkyNg==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 145,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/test/util/setup_common.cpp",
      "position" : null,
      "pull_request_review_id" : 541563210,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533149926",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533150770"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533150770"
         }
      },
      "author_association" : "MEMBER",
      "body" : "cc21167415aa01db862035cd07b6b9b35fb53f35\r\n\r\n```\r\n  CXX      libbitcoin_server_a-init.o\r\ninit.cpp:238:14: error: no member named 'feeEstimator' in 'NodeContext'; did you mean 'fee_estimator'?\r\n    if (node.feeEstimator) {\r\n             ^~~~~~~~~~~~\r\n             fee_estimator\r\n./node/context.h:40:44: note: 'fee_estimator' declared here\r\n    std::unique_ptr<CBlockPolicyEstimator> fee_estimator;\r\n                                           ^\r\ninit.cpp:239:14: error: no member named 'feeEstimator' in 'NodeContext'; did you mean 'fee_estimator'?\r\n        node.feeEstimator->FlushUnconfirmed();\r\n             ^~~~~~~~~~~~\r\n             fee_estimator\r\n./node/context.h:40:44: note: 'fee_estimator' declared here\r\n    std::unique_ptr<CBlockPolicyEstimator> fee_estimator;\r\n                                           ^\r\ninit.cpp:243:18: error: no member named 'feeEstimator' in 'NodeContext'; did you mean 'fee_estimator'?\r\n            node.feeEstimator->Write(est_fileout);\r\n                 ^~~~~~~~~~~~\r\n                 fee_estimator\r\n./node/context.h:40:44: note: 'fee_estimator' declared here\r\n    std::unique_ptr<CBlockPolicyEstimator> fee_estimator;\r\n                                           ^\r\ninit.cpp:1801:14: error: no member named 'feeEstimator' in 'NodeContext'; did you mean 'fee_estimator'?\r\n    if (node.feeEstimator && !est_filein.IsNull()) {\r\n             ^~~~~~~~~~~~\r\n             fee_estimator\r\n./node/context.h:40:44: note: 'fee_estimator' declared here\r\n    std::unique_ptr<CBlockPolicyEstimator> fee_estimator;\r\n                                           ^\r\ninit.cpp:1802:14: error: no member named 'feeEstimator' in 'NodeContext'; did you mean 'fee_estimator'?\r\n        node.feeEstimator->Read(est_filein);\r\n             ^~~~~~~~~~~~\r\n             fee_estimator\r\n./node/context.h:40:44: note: 'fee_estimator' declared here\r\n    std::unique_ptr<CBlockPolicyEstimator> fee_estimator;\r\n                                           ^\r\n5 errors generated.\r\n",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T08:26:39Z",
      "diff_hunk" : "@@ -236,18 +235,18 @@ void Shutdown(NodeContext& node)\n         DumpMempool(*node.mempool);\n     }\n \n-    if (fFeeEstimatesInitialized)\n-    {\n-        ::feeEstimator.FlushUnconfirmed();\n+    if (node.feeEstimator) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533150770",
      "id" : 533150770,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzE1MDc3MA==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 238,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 541563210,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533150770",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533151482"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533151482"
         }
      },
      "author_association" : "MEMBER",
      "body" : "cc21167415aa01db862035cd07b6b9b35fb53f35\r\n\r\nthis is unused. Instead of shuffling code around, you may add a commit that removes it.\r\n\r\n```diff\r\ndiff --git a/src/interfaces/node.cpp b/src/interfaces/node.cpp\r\nindex 2c5f8627e6..a9ca4f9cf8 100644\r\n--- a/src/interfaces/node.cpp\r\n+++ b/src/interfaces/node.cpp\r\n@@ -205,15 +205,6 @@ public:\r\n         }\r\n     }\r\n     bool getNetworkActive() override { return m_context->connman && m_context->connman->GetNetworkActive(); }\r\n-    CFeeRate estimateSmartFee(int num_blocks, bool conservative, int* returned_target = nullptr) override\r\n-    {\r\n-        FeeCalculation fee_calc;\r\n-        CFeeRate result = ::feeEstimator.estimateSmartFee(num_blocks, &fee_calc, conservative);\r\n-        if (returned_target) {\r\n-            *returned_target = fee_calc.returnedTarget;\r\n-        }\r\n-        return result;\r\n-    }\r\n     CFeeRate getDustRelayFee() override { return ::dustRelayFee; }\r\n     UniValue executeRpc(const std::string& command, const UniValue& params, const std::string& uri) override\r\n     {\r\ndiff --git a/src/interfaces/node.h b/src/interfaces/node.h\r\nindex 5079be038e..36f76aeb4f 100644\r\n--- a/src/interfaces/node.h\r\n+++ b/src/interfaces/node.h\r\n@@ -151,9 +151,6 @@ public:\r\n     //! Get network active.\r\n     virtual bool getNetworkActive() = 0;\r\n \r\n-    //! Estimate smart fee.\r\n-    virtual CFeeRate estimateSmartFee(int num_blocks, bool conservative, int* returned_target = nullptr) = 0;\r\n-\r\n     //! Get dust relay fee.\r\n     virtual CFeeRate getDustRelayFee() = 0;\r\n \r\n",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T08:27:54Z",
      "diff_hunk" : "@@ -207,8 +207,9 @@ class NodeImpl : public Node\n     bool getNetworkActive() override { return m_context->connman && m_context->connman->GetNetworkActive(); }\n     CFeeRate estimateSmartFee(int num_blocks, bool conservative, int* returned_target = nullptr) override\n     {\n+        if (!m_context->fee_estimator) return {};\n         FeeCalculation fee_calc;\n-        CFeeRate result = ::feeEstimator.estimateSmartFee(num_blocks, &fee_calc, conservative);\n+        CFeeRate result = m_context->fee_estimator->estimateSmartFee(num_blocks, &fee_calc, conservative);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533151482",
      "id" : 533151482,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzE1MTQ4Mg==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 212,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : null,
      "pull_request_review_id" : 541563210,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533151482",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-12-01T09:44:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-736359184",
      "id" : 736359184,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNjM1OTE4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-01T09:44:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/736359184",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533319866"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533319866"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, removed the \"refactor\" prefix from the commit.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T10:57:30Z",
      "diff_hunk" : "@@ -1795,10 +1798,9 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     fs::path est_path = GetDataDir() / FEE_ESTIMATES_FILENAME;\n     CAutoFile est_filein(fsbridge::fopen(est_path, \"rb\"), SER_DISK, CLIENT_VERSION);\n     // Allowed to fail as this file IS missing on first startup.\n-    if (!est_filein.IsNull())\n-        ::feeEstimator.Read(est_filein);\n-    fFeeEstimatesInitialized = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533319866",
      "id" : 533319866,
      "in_reply_to_id" : 533133324,
      "line" : 1793,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzMxOTg2Ng==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 1793,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 92,
      "pull_request_review_id" : 541781900,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533319866",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533319972"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533319972"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Included, had to rebase anyway. Used it for CTxMemPool too as it was free diff-wise.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T10:57:41Z",
      "diff_hunk" : "@@ -1389,10 +1389,13 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     assert(!node.connman);\n     node.connman = MakeUnique<CConnman>(GetRand(std::numeric_limits<uint64_t>::max()), GetRand(std::numeric_limits<uint64_t>::max()), args.GetBoolArg(\"-networkactive\", true));\n \n+    assert(!node.fee_estimator);\n+    node.fee_estimator = MakeUnique<CBlockPolicyEstimator>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533319972",
      "id" : 533319972,
      "in_reply_to_id" : 533149720,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzMxOTk3Mg==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 1393,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 541782047,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533319972",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533320082"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533320082"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed..",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T10:57:52Z",
      "diff_hunk" : "@@ -236,18 +235,18 @@ void Shutdown(NodeContext& node)\n         DumpMempool(*node.mempool);\n     }\n \n-    if (fFeeEstimatesInitialized)\n-    {\n-        ::feeEstimator.FlushUnconfirmed();\n+    if (node.feeEstimator) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533320082",
      "id" : 533320082,
      "in_reply_to_id" : 533150770,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzMyMDA4Mg==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 238,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 541782197,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533320082",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533320127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533320127"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, i didn't notice.. Cherry-picked your patch and adapted it to the new interface path post-rebase.\r\n```patch\r\nAuthor: Antoine Poinsot <darosior@protonmail.com>\r\nDate:   Tue Dec 1 11:24:33 2020 +0100\r\n\r\n    interface: remove unused estimateSmartFee method from node\r\n    \r\n    Co-Authored-by: MarcoFalke <falke.marco@gmail.com>\r\n    Signed-off-by: Antoine Poinsot <darosior@protonmail.com>\r\n\r\ndiff --git a/src/interfaces/node.h b/src/interfaces/node.h\r\nindex 5079be038..36f76aeb4 100644\r\n--- a/src/interfaces/node.h\r\n+++ b/src/interfaces/node.h\r\n@@ -151,9 +151,6 @@ public:\r\n     //! Get network active.\r\n     virtual bool getNetworkActive() = 0;\r\n \r\n-    //! Estimate smart fee.\r\n-    virtual CFeeRate estimateSmartFee(int num_blocks, bool conservative, int* returned_target = nullptr) = 0;\r\n-\r\n     //! Get dust relay fee.\r\n     virtual CFeeRate getDustRelayFee() = 0;\r\n \r\ndiff --git a/src/node/interfaces.cpp b/src/node/interfaces.cpp\r\nindex 77a5957a5..3cd9c6fda 100644\r\n--- a/src/node/interfaces.cpp\r\n+++ b/src/node/interfaces.cpp\r\n@@ -221,15 +221,6 @@ public:\r\n         }\r\n     }\r\n     bool getNetworkActive() override { return m_context->connman && m_context->connman->GetNetworkActive(); }\r\n-    CFeeRate estimateSmartFee(int num_blocks, bool conservative, int* returned_target = nullptr) override\r\n-    {\r\n-        FeeCalculation fee_calc;\r\n-        CFeeRate result = ::feeEstimator.estimateSmartFee(num_blocks, &fee_calc, conservative);\r\n-        if (returned_target) {\r\n-            *returned_target = fee_calc.returnedTarget;\r\n-        }\r\n-        return result;\r\n-    }\r\n     CFeeRate getDustRelayFee() override { return ::dustRelayFee; }\r\n     UniValue executeRpc(const std::string& command, const UniValue& params, const std::string& uri) override\r\n     {\r\n```",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-01T10:57:58Z",
      "diff_hunk" : "@@ -207,8 +207,9 @@ class NodeImpl : public Node\n     bool getNetworkActive() override { return m_context->connman && m_context->connman->GetNetworkActive(); }\n     CFeeRate estimateSmartFee(int num_blocks, bool conservative, int* returned_target = nullptr) override\n     {\n+        if (!m_context->fee_estimator) return {};\n         FeeCalculation fee_calc;\n-        CFeeRate result = ::feeEstimator.estimateSmartFee(num_blocks, &fee_calc, conservative);\n+        CFeeRate result = m_context->fee_estimator->estimateSmartFee(num_blocks, &fee_calc, conservative);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r533320127",
      "id" : 533320127,
      "in_reply_to_id" : 533151482,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzMyMDEyNw==",
      "original_commit_id" : "cc21167415aa01db862035cd07b6b9b35fb53f35",
      "original_line" : 212,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : null,
      "pull_request_review_id" : 541782266,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/533320127",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "created_at" : "2020-12-01T12:07:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-736511297",
      "id" : 736511297,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNjUxMTI5Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-01T12:07:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/736511297",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r534116032"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534116032"
         }
      },
      "author_association" : "MEMBER",
      "body" : "can be written shorter with `self.restart_node(1, [\"-bla\"])`",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-02T12:05:07Z",
      "diff_hunk" : "@@ -262,6 +263,13 @@ def run_test(self):\n         self.log.info(\"Final estimates after emptying mempools\")\n         check_estimates(self.nodes[1], self.fees_per_kb)\n \n+        self.log.info(\"Testing that fee estimation is disabled in blocksonly.\")\n+        self.stop_nodes()\n+        self.nodes[0].start(extra_args=[\"-blocksonly\"])\n+        self.nodes[0].wait_for_rpc_connection()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r534116032",
      "id" : 534116032,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDExNjAzMg==",
      "original_commit_id" : "8527183fde72d097700da18600eb7dc37c1ba206",
      "original_line" : 269,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 542769277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534116032",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r534118318"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534118318"
         }
      },
      "author_association" : "MEMBER",
      "body" : "can you explain what this line of code is doing and why it is needed?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-02T12:09:25Z",
      "diff_hunk" : "@@ -500,6 +503,15 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r534118318",
      "id" : 534118318,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDExODMxOA==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 509,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 542769277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534118318",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r534120330"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534120330"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why is `__func__` needed here? It should already be possible to find the function name with `git grep -W \"Failed to read fee est\"`.\r\n\r\nSee also #19809 which makes this redundant.\r\n\r\nAlso the log message could be suffixed with `\". Continue anyway.\\n\"` to clarify that this failure does not hinder program execution and is normally hit on first start.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-02T12:13:03Z",
      "diff_hunk" : "@@ -500,6 +503,15 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"rb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Read(est_file)) {\n+        LogPrintf(\"%s: Failed to read fee estimates from %s\\n\", __func__, est_filepath.string());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r534120330",
      "id" : 534120330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDEyMDMzMA==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 513,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 542769277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534120330",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r534270639"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534270639"
         }
      },
      "author_association" : "MEMBER",
      "body" : "same",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-02T15:45:03Z",
      "diff_hunk" : "@@ -856,6 +868,17 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n     return CFeeRate(llround(median));\n }\n \n+void CBlockPolicyEstimator::Flush() {\n+    FlushUnconfirmed();\n+\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"wb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Write(est_file)) {\n+        LogPrintf(\"%s: Failed to write fee estimates to %s\\n\", __func__, est_filepath.string());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r534270639",
      "id" : 534270639,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI3MDYzOQ==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 879,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 542769277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534270639",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535105514"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535105514"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done, thanks",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-03T11:03:05Z",
      "diff_hunk" : "@@ -262,6 +263,13 @@ def run_test(self):\n         self.log.info(\"Final estimates after emptying mempools\")\n         check_estimates(self.nodes[1], self.fees_per_kb)\n \n+        self.log.info(\"Testing that fee estimation is disabled in blocksonly.\")\n+        self.stop_nodes()\n+        self.nodes[0].start(extra_args=[\"-blocksonly\"])\n+        self.nodes[0].wait_for_rpc_connection()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535105514",
      "id" : 535105514,
      "in_reply_to_id" : 534116032,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEwNTUxNA==",
      "original_commit_id" : "8527183fde72d097700da18600eb7dc37c1ba206",
      "original_line" : 269,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "test/functional/feature_fee_estimation.py",
      "position" : null,
      "pull_request_review_id" : 543840350,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535105514",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535105587"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535105587"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Well, there is a comment just above.. If the file isn't present (likely first start), don't report a failure to read fee estimates: it's expected. Kind of the echo of the `// Allowed to fail as this file IS missing on first startup.` [comment in the red part of the diff](https://github.com/bitcoin/bitcoin/pull/18766/files/8527183fde72d097700da18600eb7dc37c1ba206..01e39989f23b26a23cea26e5ec4d8dfc2010bc97#diff-b1e19192258d83199d8adaa5ac31f067af98f63554bfdd679bd8e8073815e69dL1795-L1798).\r\n\r\nThanks, you however ringed a bell in my head: this check should *not* be present in Flush or the file would never be created!",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-03T11:03:08Z",
      "diff_hunk" : "@@ -500,6 +503,15 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535105587",
      "id" : 535105587,
      "in_reply_to_id" : 534118318,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEwNTU4Nw==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 509,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 543840401,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535105587",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535105750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535105750"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> is normally hit on first start.\r\n\r\n~~It's not, on first start we would have returned just above.~~ EDIT: i'm wrong, it's not properly checked!\r\n\r\nRemoved the `__func__`.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-03T11:03:17Z",
      "diff_hunk" : "@@ -500,6 +503,15 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"rb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Read(est_file)) {\n+        LogPrintf(\"%s: Failed to read fee estimates from %s\\n\", __func__, est_filepath.string());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535105750",
      "id" : 535105750,
      "in_reply_to_id" : 534120330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEwNTc1MA==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 513,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 543840504,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535105750",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535105929"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535105929"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-03T11:03:27Z",
      "diff_hunk" : "@@ -856,6 +868,17 @@ CFeeRate CBlockPolicyEstimator::estimateSmartFee(int confTarget, FeeCalculation\n     return CFeeRate(llround(median));\n }\n \n+void CBlockPolicyEstimator::Flush() {\n+    FlushUnconfirmed();\n+\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"wb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Write(est_file)) {\n+        LogPrintf(\"%s: Failed to write fee estimates to %s\\n\", __func__, est_filepath.string());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535105929",
      "id" : 535105929,
      "in_reply_to_id" : 534270639,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEwNTkyOQ==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 879,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 543840624,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535105929",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed all @MarcoFalke 's remaining nits.",
      "created_at" : "2020-12-03T11:17:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-737877241",
      "id" : 737877241,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNzg3NzI0MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-03T11:17:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/737877241",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535121803"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535121803"
         }
      },
      "author_association" : "MEMBER",
      "body" : "what I mean is that a path representation that is (not) empty (https://en.cppreference.com/w/cpp/filesystem/path/empty) doesn't imply anything about the presence of a file.\r\n\r\nYou can think of fs::path as a \"fancy string\". empty means the string is empty. non-empty means the string is non-empty, but it doesn't imply the file exists (or even any of the parent folders)",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-03T11:17:48Z",
      "diff_hunk" : "@@ -500,6 +503,15 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535121803",
      "id" : 535121803,
      "in_reply_to_id" : 534118318,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEyMTgwMw==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 509,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 543851252,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535121803",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-12-03T11:32:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-737885138",
      "id" : 737885138,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczNzg4NTEzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-03T11:32:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/737885138",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535146288"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535146288"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks.. That was clearly stupid..\r\nRemoved as i don't think i can use C++17's `fs::exists()` instead?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-03T11:41:37Z",
      "diff_hunk" : "@@ -500,6 +503,15 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535146288",
      "id" : 535146288,
      "in_reply_to_id" : 534118318,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE0NjI4OA==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 509,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 543869143,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535146288",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535155705"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535155705"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Also the log message could be suffixed with \". Continue anyway.\\n\" to clarify that this failure does not hinder program execution and is normally hit on first start.\r\n\r\nHas this been addressed or responded to?",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-03T11:51:14Z",
      "diff_hunk" : "@@ -500,6 +503,15 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"rb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Read(est_file)) {\n+        LogPrintf(\"%s: Failed to read fee estimates from %s\\n\", __func__, est_filepath.string());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535155705",
      "id" : 535155705,
      "in_reply_to_id" : 534120330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE1NTcwNQ==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 513,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 543876121,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535155705",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535170056"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535170056"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "No, this was missed. Done now.",
      "commit_id" : "4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-03T12:07:15Z",
      "diff_hunk" : "@@ -500,6 +503,15 @@ CBlockPolicyEstimator::CBlockPolicyEstimator()\n     feeStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, MED_BLOCK_PERIODS, MED_DECAY, MED_SCALE));\n     shortStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, SHORT_BLOCK_PERIODS, SHORT_DECAY, SHORT_SCALE));\n     longStats = std::unique_ptr<TxConfirmStats>(new TxConfirmStats(buckets, bucketMap, LONG_BLOCK_PERIODS, LONG_DECAY, LONG_SCALE));\n+\n+    // If the fee estimation file is present, read recorded estimations\n+    fs::path est_filepath = GetDataDir() / FEE_ESTIMATES_FILENAME;\n+    if (est_filepath.empty()) return;\n+\n+    CAutoFile est_file(fsbridge::fopen(est_filepath, \"rb\"), SER_DISK, CLIENT_VERSION);\n+    if (est_file.IsNull() || !Read(est_file)) {\n+        LogPrintf(\"%s: Failed to read fee estimates from %s\\n\", __func__, est_filepath.string());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#discussion_r535170056",
      "id" : 535170056,
      "in_reply_to_id" : 534120330,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE3MDA1Ng==",
      "original_commit_id" : "01e39989f23b26a23cea26e5ec4d8dfc2010bc97",
      "original_line" : 513,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/policy/fees.cpp",
      "position" : null,
      "pull_request_review_id" : 543887685,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-03T12:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/535170056",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-ACK 4e28753f60 ð\r\nonly changes:\r\n* Small test fixup (restart_node)\r\n* Small log fixups\r\n* Remove dead code (empty path check)\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nre-ACK 4e28753f60 ð\r\nonly changes:\r\n* Small test fixup (restart_node)\r\n* Small log fixups\r\n* Remove dead code (empty path check)\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUiivwwAvP/ngY1HjLgcIUIL6koFzy3aWPRMQhVCyB4gj6n7rHQoETxZZKMrgk4Z\r\nsoRCvS8dCX1B9OMgJ7B4iBcyX2ywfw7nAA4PwUSPMJLbNitqzPkpxuG1RNLtLfwt\r\n4loau6a5ZZJlKYhLoR8Q6NEdYwCC/OfpZYRIjlQd2+waGdaki1/G86Q6LKGe5xAZ\r\nTM4VW89RpnHofXm5zxJZq3CiUExZMMSGVMwp+4eGpk0h9/eeYoKr1IGFh7qGzTSe\r\nX5U/t5z6EmygD3gL1QaVWSb73TTeaU2Iux3U7JR9pYJgK4dNjZr3WKTCY7NJORqv\r\nkCcW3ZHL4E3w8Oz9hnU6uSHsj+xOONTRxffHzsP7e1nkYTRSqEjqAohO1u2jL0Ho\r\n2FSyXyDtp2uC0mn64JW0duVZI88FT6fRqyt/HiUHvnFzLSdTg90mDMtWMF/qQcb2\r\njXpEvjaKGI129CgdlHRxVpUFmAK6bOdHxrx9fgcwD1L6hHo1PQX8N59ulLP2uano\r\ng2unQ65X\r\n=AMhQ\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `3d9e3dc48bc4d73872a862f7eccfe39d2af942484475d2f8af25b52833aa2031  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e8929401083d9e3dc48bc4d73872a862f7eccfe39d2af942484475d2f8af25b52833aa2031f01085bbf7ed73edc39d6b0270c6467f6ae908fff01023189a9538d482ef1509eac479de34e908f1045fcddfd3f0083d753d5612d257010083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff010b5f0af50342e1c06a6c2cedc7ed14c0408f1045fcddfd3f008df58306c2d6616f50083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6dfff010c4e18b40b114f76de75adea74e6825cf08f1045fcddfd3f008800afeb339ab296c0083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267f010d2443f3163d2e6e09e16762a63ffdff808f1045fcddfd3f008b0e533220428eaf80083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6d)\r\n\r\n</details>\r\n",
      "created_at" : "2020-12-07T07:55:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-739741516",
      "id" : 739741516,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczOTc0MTUxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-07T07:55:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/739741516",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 4e28753f60613ecd35cdef87bef5f99c302c3fbd",
      "created_at" : "2020-12-07T11:22:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18766#issuecomment-739855921",
      "id" : 739855921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczOTg1NTkyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-07T11:22:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/739855921",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
