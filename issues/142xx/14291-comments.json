[
   {
      "author_association" : "MEMBER",
      "body" : "After https://github.com/bitcoin/bitcoin/pull/11485#issuecomment-423683042 decided to push this.\r\n\r\nConsider the following:\r\n```\r\n$ find wallets\r\nwallets\r\nwallets/wallet.dat\r\nwallets/db.log\r\nwallets/x1\r\nwallets/x1/wallet.dat\r\nwallets/x1/db.log\r\nwallets/x1/.walletlock\r\nwallets/x2\r\nwallets/x2/wallet.dat\r\nwallets/x2/db.log\r\nwallets/x2/.walletlock\r\nwallets/.walletlock\r\nwallets/w\r\nwallets/w/x3\r\nwallets/w/x3/wallet.dat\r\nwallets/w/x3/db.log\r\nwallets/w/x3/.walletlock\r\n```\r\n`ListWalletDir()` gives\r\n```\r\nwallet.dat\r\nx1\r\nx2\r\nw/x3\r\n```",
      "created_at" : "2018-09-21T23:33:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-423696829",
      "id" : 423696829,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyMzY5NjgyOQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423696829/reactions"
      },
      "updated_at" : "2018-09-22T00:04:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423696829",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->Reviewers, this pull request conflicts with the following ones:\n\n* #13100 (gui: Add dynamic wallets support by promag)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-09-22T03:59:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-423714517",
      "id" : 423714517,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyMzcxNDUxNw==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423714517/reactions"
      },
      "updated_at" : "2018-10-10T01:05:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423714517",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219663917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219663917"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "How about moving these functions to `interfaces/wallet.cpp`. I think they don't belong here.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-22T07:18:01Z",
      "diff_hunk" : "@@ -218,6 +219,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219663917",
      "id" : 219663917,
      "line" : 234,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2MzkxNw==",
      "original_commit_id" : "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
      "original_line" : 234,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 24,
      "pull_request_review_id" : 157901916,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219663917/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219663917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219664892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219664892"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should cite the source of this information (https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75) to give credit upstream and make this code easier to understand / debug / update in the future.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-22T08:05:22Z",
      "diff_hunk" : "@@ -25,3 +25,32 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const unsigned char bdb_magic[4] = {0x62, 0x31, 0x05, 0x00}; // Berkeley DB Btree magic bytes",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219664892",
      "id" : 219664892,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2NDg5Mg==",
      "original_commit_id" : "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
      "original_line" : 31,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 157902949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219664892/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219664892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219666816"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666816"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Since this is declared as bytes, the `memcmp` below will only look for little-endian btree files, even on big endian platforms. It seems like it would make more sense to look for little endian files on little-endian platforms, and big endian files on big endian platforms. Changing this to `uint32_t bdb_magic = 0x00053162` and passing `&bdb_magic` to `memcmp` should accomplish this.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-22T09:44:44Z",
      "diff_hunk" : "@@ -25,3 +25,32 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const unsigned char bdb_magic[4] = {0x62, 0x31, 0x05, 0x00}; // Berkeley DB Btree magic bytes",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219666816",
      "id" : 219666816,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2NjgxNg==",
      "original_commit_id" : "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
      "original_line" : 31,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 157902949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666816/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219666958"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666958"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There are a number of problems with this implementation:\r\n\r\n1) Because this opens files recursively, it will return btree paths not in the top directory which CWallet::Verify will reject: https://github.com/bitcoin/bitcoin/blob/920c090f63f4990bf0f3b3d1a6d3d8a8bcd14ba0/src/wallet/wallet.cpp#L3824-L3829\r\n2) Because is_regular_file will return true for symlinks pointing to files, this will return symlink paths which CWallet::Verify will reject\r\n3) Because recursive_directory_iterator order is unspecified, on systems where it does postorder instead of preorder traversal, this will return `<wallet>/wallet.dat` instead of `<wallet>` paths, which CWallet::Verify will reject.\r\n4) Less serious, but this returns \"wallet.dat\" instead of \"\" as the path for the top level wallet. This is inconsistent with top level wallet path returned in current `listwallets` and `getwalletinfo` rpcs in the default bitcoin configuration.\r\n5) This is less efficient than it needs to be. Instead of only opening files called `wallet.dat` in subdirectories, it will read logs and other random files which bitcoin would never open as wallets. It also reads `wallet.dat` files in subdirectories twice and then uses a `std::set` to filter out the duplicates after they are read, which is unnecessary.\r\n\r\nFollowing alternate implementation is untested, but I think would avoid these problems:\r\n\r\n```c++\r\nstd::vector<fs::path> wallets;\r\nfor (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\r\n    if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\r\n        // Found a directory which contains wallet.dat btree file, add it as a wallet.\r\n        wallets.emplace_back(it->path());\r\n    } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {\r\n        if (it->path() == \"wallet.dat\") {\r\n            // Found top-level wallet.dat btree file, add top level directory \"\"\r\n            // as a wallet.\r\n            wallets.emplace_back();\r\n        } else {\r\n            // Found top-level btree file not called wallet.dat. Current bitcoin\r\n            // software will never create these files but will allow them to be\r\n            // opened in a shared database environment for backwards compatibility.\r\n            // Add it to the list of available wallets.\r\n            wallets.emplace_back(it->path());\r\n        }\r\n    }\r\n}\r\nreturn wallets;\r\n```",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-22T09:51:55Z",
      "diff_hunk" : "@@ -25,3 +25,32 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const unsigned char bdb_magic[4] = {0x62, 0x31, 0x05, 0x00}; // Berkeley DB Btree magic bytes\n+\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+    std::set<fs::path> dbs;\n+\n+    for (auto& entry : fs::recursive_directory_iterator(wallet_dir)) {\n+        const fs::path& path = entry.path();\n+        const fs::path db = fs::is_regular_file(entry) ? path : path / \"wallet.dat\";\n+\n+        std::ifstream file(db.string(), std::ios::binary);\n+        if (!file.is_open()) continue;\n+\n+        file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+        unsigned char file_bytes[4] = {0};\n+        file.read((char*)file_bytes, sizeof(file_bytes)); // Read 4 bytes of file to compare against magic\n+        if (memcmp(file_bytes, bdb_magic, sizeof(bdb_magic)) != 0) continue;\n+\n+        // avoid duplicates due to the recursive iteration\n+        if (!dbs.insert(db).second) continue;\n+\n+        paths.push_back(fs::relative(path, wallet_dir));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219666958",
      "id" : 219666958,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2Njk1OA==",
      "original_commit_id" : "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
      "original_line" : 52,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 157902949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666958/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666958",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219667374"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219667374"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> How about moving these functions to interfaces/wallet.cpp. I think they don't belong here.\r\n\r\nThis is a reasonable place. These methods fit in with the existing `getWallets` and `handleLoadWallet` methods. The `Node` interface is somewhat monolithic and we could consider breaking it up in various ways. But the `Wallet` interface would be the wrong place to add these methods. `Wallet` methods operate on individual wallets, not collections of wallets. And these methods need to be available before any `Wallet` object is constructed.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-22T10:17:10Z",
      "diff_hunk" : "@@ -218,6 +219,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219667374",
      "id" : 219667374,
      "in_reply_to_id" : 219663917,
      "line" : 234,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2NzM3NA==",
      "original_commit_id" : "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
      "original_line" : 234,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 24,
      "pull_request_review_id" : 157902949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219667374/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219667374",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks @ryanofsky, will update accordingly.",
      "created_at" : "2018-09-22T13:11:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-423743185",
      "id" : 423743185,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyMzc0MzE4NQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423743185/reactions"
      },
      "updated_at" : "2018-09-22T13:11:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423743185",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219671843"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219671843"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: Add some trivial test for `ListWalletDir` to make it technically in use.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-22T13:34:04Z",
      "diff_hunk" : "@@ -11,4 +11,7 @@\n //! Get the path of the wallet directory.\n fs::path GetWalletDir();\n \n+//! Get wallets in wallet directory.\n+std::vector<fs::path> ListWalletDir();\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219671843",
      "id" : 219671843,
      "line" : 17,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY3MTg0Mw==",
      "original_commit_id" : "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.h",
      "position" : 15,
      "pull_request_review_id" : 157910115,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219671843/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219671843",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky updated to used your suggested code with some minor details fixed. The result is still relative paths to `-walletdir`.\r\n\r\n@practicalswift will add test.",
      "created_at" : "2018-09-24T17:41:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-424061725",
      "id" : 424061725,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNDA2MTcyNQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424061725/reactions"
      },
      "updated_at" : "2018-09-24T17:41:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424061725",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220147402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220147402"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There is `listwaletdir` RPC, which has some tests.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T11:02:19Z",
      "diff_hunk" : "@@ -11,4 +11,7 @@\n //! Get the path of the wallet directory.\n fs::path GetWalletDir();\n \n+//! Get wallets in wallet directory.\n+std::vector<fs::path> ListWalletDir();\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220147402",
      "id" : 220147402,
      "in_reply_to_id" : 219671843,
      "line" : 17,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE0NzQwMg==",
      "original_commit_id" : "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
      "original_line" : 17,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.h",
      "position" : 15,
      "pull_request_review_id" : 158485225,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220147402/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220147402",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220161367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220161367"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: `throwNotWalletBuild()`?",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T11:56:15Z",
      "diff_hunk" : "@@ -34,6 +34,16 @@ void DummyWalletInit::AddWalletOptions() const\n \n const WalletInitInterface& g_wallet_init_interface = DummyWalletInit();\n \n+fs::path GetWalletDir()\n+{\n+    throw std::logic_error(\"Wallet function called in non-wallet build.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220161367",
      "id" : 220161367,
      "line" : 39,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE2MTM2Nw==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 39,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/dummywallet.cpp",
      "position" : 6,
      "pull_request_review_id" : 158502639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220161367/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220161367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220162889"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220162889"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I find this function name confusing. How about `listWallets()`? A future version of this function could take a directory argument and the name would still make sense.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T12:01:34Z",
      "diff_hunk" : "@@ -173,6 +173,12 @@ class Node\n     //! Get unspent outputs associated with a transaction.\n     virtual bool getUnspentOutput(const COutPoint& output, Coin& coin) = 0;\n \n+    //! Return default wallet directory.\n+    virtual std::string getWalletDir() = 0;\n+\n+    //! Return available wallets in wallet directory.\n+    virtual std::vector<std::string> listWalletDir() = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220162889",
      "id" : 220162889,
      "line" : 180,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE2Mjg4OQ==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 180,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/interfaces/node.h",
      "position" : 8,
      "pull_request_review_id" : 158502639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220162889/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220162889",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220165978"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220165978"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ditto as above, but unfortunately it's too late to rename `listwallets` to `listloadedwallets`. Overloading `listwallets` doesn't seem like a good idea.\r\n\r\nWhat about `lswallets`, `listwalletfiles` or `findwallets`?  ",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T12:12:13Z",
      "diff_hunk" : "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220165978",
      "id" : 220165978,
      "line" : 2453,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE2NTk3OA==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 2453,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 158502639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220165978/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220165978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220167677"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220167677"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sort alphabetically?",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T12:17:28Z",
      "diff_hunk" : "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220167677",
      "id" : 220167677,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE2NzY3Nw==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 233,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 23,
      "pull_request_review_id" : 158502639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220167677/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220167677",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220186712"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220186712"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think that's something for the UI to handle. It can sort by other attribute, like last modified, transaction count, balance, etc.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T13:15:33Z",
      "diff_hunk" : "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220186712",
      "id" : 220186712,
      "in_reply_to_id" : 220167677,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE4NjcxMg==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 233,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 23,
      "pull_request_review_id" : 158534090,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220186712/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220186712",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220187294"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220187294"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I like the pairing between `getWalletDir`, `listWalletDir` and `-walletdir`, but I don't have a strong preference. Let's see what others say.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T13:17:12Z",
      "diff_hunk" : "@@ -173,6 +173,12 @@ class Node\n     //! Get unspent outputs associated with a transaction.\n     virtual bool getUnspentOutput(const COutPoint& output, Coin& coin) = 0;\n \n+    //! Return default wallet directory.\n+    virtual std::string getWalletDir() = 0;\n+\n+    //! Return available wallets in wallet directory.\n+    virtual std::vector<std::string> listWalletDir() = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220187294",
      "id" : 220187294,
      "in_reply_to_id" : 220162889,
      "line" : 180,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE4NzI5NA==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 180,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/interfaces/node.h",
      "position" : 8,
      "pull_request_review_id" : 158534882,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220187294/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220187294",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220189697"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220189697"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree in not overloading `listwallets`. There are more alternatives in #11485 discussion thread.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T13:23:17Z",
      "diff_hunk" : "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220189697",
      "id" : 220189697,
      "in_reply_to_id" : 220165978,
      "line" : 2453,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE4OTY5Nw==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 2453,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 158537918,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220189697/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220189697",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220193984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220193984"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's fine, as long as the RPC interface does it, that's also a User Interface :-)",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T13:34:31Z",
      "diff_hunk" : "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220193984",
      "id" : 220193984,
      "in_reply_to_id" : 220167677,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE5Mzk4NA==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 233,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 23,
      "pull_request_review_id" : 158543537,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220193984/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220193984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220195529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220195529"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should we sort `listwallets` result too? ",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T13:38:37Z",
      "diff_hunk" : "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220195529",
      "id" : 220195529,
      "in_reply_to_id" : 220167677,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE5NTUyOQ==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 233,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 23,
      "pull_request_review_id" : 158545603,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220195529/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220195529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220218050"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220218050"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That could be a nice improvement. Not necessarily in this PR, but perhaps there could be a common function to render the list of wallets in RPC, to make sure they're consistent.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-25T14:33:17Z",
      "diff_hunk" : "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220218050",
      "id" : 220218050,
      "in_reply_to_id" : 220167677,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDIxODA1MA==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 233,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 23,
      "pull_request_review_id" : 158574435,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220218050/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220218050",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220438850"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220438850"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit \"wallet: Add ListWalletDir utility\" (90adb2cd6149af1869e624a2060ec8c4a543cf08)\r\n\r\nProbably delete this line, it looks leftover from debugging.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T06:28:45Z",
      "diff_hunk" : "@@ -25,3 +25,47 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return memcmp(&data, &bdb_magic, sizeof(bdb_magic)) == 0;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        std::cout << it->path().string() << '-' << it.level() << std::endl;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220438850",
      "id" : 220438850,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQzODg1MA==",
      "original_commit_id" : "90adb2cd6149af1869e624a2060ec8c4a543cf08",
      "original_line" : 51,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 158846389,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220438850/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220438850",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220441099"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220441099"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think I agree with promag. `listWalletDir` describes more specifically what the function does than `listWallets` and it fits in with the other names cited. I don't imagine us adding a gui feature that would call for the gui asking the node to list wallets in a directory other than `-walletdir`, but even if we did and this method gained an optional argument,  `listWalletDir` would still seem like a sensible name.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T06:40:46Z",
      "diff_hunk" : "@@ -173,6 +173,12 @@ class Node\n     //! Get unspent outputs associated with a transaction.\n     virtual bool getUnspentOutput(const COutPoint& output, Coin& coin) = 0;\n \n+    //! Return default wallet directory.\n+    virtual std::string getWalletDir() = 0;\n+\n+    //! Return available wallets in wallet directory.\n+    virtual std::vector<std::string> listWalletDir() = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220441099",
      "id" : 220441099,
      "in_reply_to_id" : 220162889,
      "line" : 180,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ0MTA5OQ==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 180,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/interfaces/node.h",
      "position" : 8,
      "pull_request_review_id" : 158846389,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220441099/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220441099",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220446254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446254"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit \"rpc: Add listwalletdir RPC\" (963eb27e8598e2746966ee4056f177ed332f0279)\r\n\r\nI would consider avoiding a mistake we've made previously with other api's (listwallets, listaccounts) where we limited extensibility by returning lists of strings instead of list of json objects. Specifically, I think it'd be better to return\r\n\r\n```json\r\n[ {\"wallet\": \"\"}, {\"wallet\": \"foo\"}, {\"wallet\": \"bar\"} ]\r\n```\r\n\r\ninstead of:\r\n\r\n```json\r\n[ \"\", \"foo\", \"bar\" ]\r\n```\r\n\r\nBecause there's more metadata we could be returning about these wallets even without opening them, such as last modified times from the filesystem, status strings indicating whether wallets are presently loaded and locked, and path types indicating whether wallet paths refer to directories, symlinks, or legacy btree files.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T07:05:59Z",
      "diff_hunk" : "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 0) {\n+        throw std::runtime_error(\n+            \"listwalletdir\\n\"\n+            \"Returns a list of wallets in the wallet directory.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[                         (json array of strings)\\n\"\n+            \"  \\\"walletname\\\"            (string) the wallet name\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220446254",
      "id" : 220446254,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ0NjI1NA==",
      "original_commit_id" : "963eb27e8598e2746966ee4056f177ed332f0279",
      "original_line" : 2461,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 158846389,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446254/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220446805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446805"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't see a problem with `listwalletdir`. It describes the thing this RPC does, which is to list the contents of the `-walletdir` directory. (I do think it would have been clearer if that directory would have been called `-walletsdir` instead of `-walletdir`, but surprising to me as a native english speaker, other people seemed to think `-walletsdir` was clumsy and not grammatical in #12221).",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T07:08:28Z",
      "diff_hunk" : "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220446805",
      "id" : 220446805,
      "in_reply_to_id" : 220165978,
      "line" : 2453,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ0NjgwNQ==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 2453,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 158846389,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446805/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220453514"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220453514"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ops",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T07:35:00Z",
      "diff_hunk" : "@@ -25,3 +25,47 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return memcmp(&data, &bdb_magic, sizeof(bdb_magic)) == 0;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        std::cout << it->path().string() << '-' << it.level() << std::endl;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220453514",
      "id" : 220453514,
      "in_reply_to_id" : 220438850,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ1MzUxNA==",
      "original_commit_id" : "90adb2cd6149af1869e624a2060ec8c4a543cf08",
      "original_line" : 51,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 158864119,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220453514/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220453514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220471896"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220471896"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Absolutely, my initial response was like:\r\n```json\r\n{\r\n    \"wallets\": [\r\n        { \"name\": \"\" }\r\n    ]\r\n}\r\n```\r\nwhich permits adding, for instance, `walletdir`, `count`, `offset`..",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T08:36:49Z",
      "diff_hunk" : "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 0) {\n+        throw std::runtime_error(\n+            \"listwalletdir\\n\"\n+            \"Returns a list of wallets in the wallet directory.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[                         (json array of strings)\\n\"\n+            \"  \\\"walletname\\\"            (string) the wallet name\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220471896",
      "id" : 220471896,
      "in_reply_to_id" : 220446254,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ3MTg5Ng==",
      "original_commit_id" : "963eb27e8598e2746966ee4056f177ed332f0279",
      "original_line" : 2461,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 158885891,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220471896/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220471896",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220522510"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220522510"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@ryanofsky does this looks good to you?",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T11:22:04Z",
      "diff_hunk" : "@@ -39,7 +39,7 @@ static bool IsBerkeleyBtree(const fs::path& path)\n     uint32_t data = 0;\n     file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n \n-    return memcmp(&data, &bdb_magic, sizeof(bdb_magic)) == 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220522510",
      "id" : 220522510,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDUyMjUxMA==",
      "original_commit_id" : "5e3a14d42726f4a526b6e69bc2d12c561afe7e34",
      "original_line" : 42,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 158946677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220522510/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220522510",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220528757"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220528757"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should it ignore case? Should have an option to support numeric/date prefixes?\r\n\r\nFrom the cli point of view, you can do stuff like `bitcoin-cli -regtest listwalletdir | jq -r '.wallets | map(.name) | join(\"\\n\")' | sort ...`.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T11:49:19Z",
      "diff_hunk" : "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220528757",
      "id" : 220528757,
      "in_reply_to_id" : 220167677,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDUyODc1Nw==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 233,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 23,
      "pull_request_review_id" : 158955119,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220528757/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220528757",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220543207"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220543207"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Don't most alphabetical sort functions ignore case (unless it's a tie) and put numbers before letters? I'm a fan of `jq`, but seems overkill for a simple list. It doesn't seem terribly complicated in C++11 even with [UTF-8](https://www.quora.com/How-do-I-sort-an-array-of-strings-in-alphabetical-order-in-C) (1st answer, 3rd example):\r\n\r\n```cpp\r\nstd::wstring a[] = {L\"Ð¨Ð»Ð°\", L\"Ð¡Ð°ÑÐ°\", L\"Ð¿Ð¾\", L\"ÑÐ¾ÑÑÐµ\", L\"Ð¸\", L\"ÑÐ¾ÑÐ°Ð»Ð°\", L\"ÑÑÑÐºÑ\"};\r\nstd::sort(std::begin(a), std::end(a), std::locale(\"en_US.utf8\"));\r\nstd::wstring_convert<std::codecvt_utf8<wchar_t>> cvt;\r\nfor(auto& s: a) std::cout << cvt.to_bytes(s) << ' ';\r\n```",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T12:39:51Z",
      "diff_hunk" : "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220543207",
      "id" : 220543207,
      "in_reply_to_id" : 220167677,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDU0MzIwNw==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 233,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 23,
      "pull_request_review_id" : 158973449,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220543207/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220543207",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220749366"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220749366"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If you don't mind I prefer to follow up that discussion and possible implementation in both RPC. In this PR I'm just following `listwallets` ordering and for now having the functionality is enough.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-09-26T23:02:17Z",
      "diff_hunk" : "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220749366",
      "id" : 220749366,
      "in_reply_to_id" : 220167677,
      "line" : 233,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDc0OTM2Ng==",
      "original_commit_id" : "20db275b250189cfd2200df8e5535aa92afa594a",
      "original_line" : 233,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/interfaces/node.cpp",
      "position" : 23,
      "pull_request_review_id" : 159230702,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220749366/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220749366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Squashed and added release notes.",
      "created_at" : "2018-09-26T23:06:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-424898567",
      "id" : 424898567,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNDg5ODU2Nw==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424898567/reactions"
      },
      "updated_at" : "2018-09-26T23:06:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424898567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> the test node could dynamically create a wallet, and then try to find it. That way at least some developer will see that test fail on their machine if they compile with a future BDB version that's somehow different.\r\n\r\n@Sjors does the test change looks good to you?\r\n",
      "created_at" : "2018-09-27T20:35:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425233400",
      "id" : 425233400,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNTIzMzQwMA==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425233400/reactions"
      },
      "updated_at" : "2018-09-27T20:35:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425233400",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "<!--32850dd3fdea838b4049e64f46995ea2-->\n| Coverage  | Change ([pull 14291](https://drahtbot.github.io/reports/coverage/bitcoin/bitcoin/14291/total.coverage/index.html)) | Reference ([master](https://drahtbot.github.io/reports/coverage/bitcoin/bitcoin/master/total.coverage/index.html))   |\n|-----------|-------------------------|--------------------|\n| Lines     | -0.0043 %            | 87.0361 %        |\n| Functions | -0.0186 %            | 84.1130 %        |\n| Branches  | -0.0052 %            | 51.5451 %        |\n",
      "created_at" : "2018-09-28T05:52:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425328769",
      "id" : 425328769,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNTMyODc2OQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425328769/reactions"
      },
      "updated_at" : "2018-09-28T05:52:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425328769",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag it covers the second part of my suggestion yes:  the wallets are generated by the test framework (using whatever version of BDB is on the dev machine), and then listed.\r\n\r\n> Can you add BDB4 and BDB5 wallet payloads to the test suite?\r\n\r\nThis isn't explicitly tested, but because some/most Travis machines use bdb4, it's covered regardless. We're not officially supporting BDB>4 wallets, so that's not important.\r\n\r\ntACK fc40216e1b0a3e0462b4119f6e4380ac368ed828 for macOS, modulo `wallet.dat` being shown as `\"\"` (though that can be fixed later).",
      "created_at" : "2018-09-28T10:55:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425399728",
      "id" : 425399728,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNTM5OTcyOA==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425399728/reactions"
      },
      "updated_at" : "2018-09-28T10:55:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425399728",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> modulo wallet.dat being shown as \"\" (though that can be fixed later).\r\n\r\nThat's the name of the default wallet, so it doesn't needs fix. Try:\r\n```\r\nbitcoind -regtest &\r\nbitcoin-cli -regtest unloadwallet \"\"\r\n```\r\n\r\n> tACK fc40216 for macOS\r\n\r\nThanks @Sjors ð ",
      "created_at" : "2018-09-28T11:22:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425405356",
      "id" : 425405356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNTQwNTM1Ng==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425405356/reactions"
      },
      "updated_at" : "2018-09-28T11:22:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425405356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag that's weird, but unrelated to this change. When you do `listwallets` it shows up as `wallet.dat`. And can you load it with `loadwallet \"\"`?",
      "created_at" : "2018-09-28T12:01:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425413546",
      "id" : 425413546,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNTQxMzU0Ng==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425413546/reactions"
      },
      "updated_at" : "2018-09-28T12:01:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425413546",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors here I have:\r\n```\r\nbitcoind -regtest\r\nbitcoin-cli -regtest  listwallets\r\n[\r\n  \"\"\r\n]\r\n```",
      "created_at" : "2018-09-28T12:10:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425415570",
      "id" : 425415570,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNTQxNTU3MA==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425415570/reactions"
      },
      "updated_at" : "2018-09-28T12:10:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425415570",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Try adding a second wallet to `bitcoin.conf`, then it shows up as `\"wallet.dat\"`. But in that case you can unload with `unloadwallet \"wallet.dat\"`. In case you don't have wallets in `bitcoin.conf`, there's never a need to load `wallet.dat`, so then it doesn't matter that it's called `\"\"`.",
      "created_at" : "2018-09-28T12:34:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425421371",
      "id" : 425421371,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNTQyMTM3MQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425421371/reactions"
      },
      "updated_at" : "2018-09-28T12:34:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425421371",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r223220733"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/223220733"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Any concerns about the endianness of `data` as compared to `bdb_magic` here?",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-07T17:06:50Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r223220733",
      "id" : 223220733,
      "line" : 43,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMzIyMDczMw==",
      "original_commit_id" : "c3acd2b69069e4718f26d34241c8ea10b3cd96ea",
      "original_line" : 43,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 26,
      "pull_request_review_id" : 162297341,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/223220733/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/223220733",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69561?v=4",
         "events_url" : "https://api.github.com/users/etscrivner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/etscrivner/followers",
         "following_url" : "https://api.github.com/users/etscrivner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/etscrivner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/etscrivner",
         "id" : 69561,
         "login" : "etscrivner",
         "node_id" : "MDQ6VXNlcjY5NTYx",
         "organizations_url" : "https://api.github.com/users/etscrivner/orgs",
         "received_events_url" : "https://api.github.com/users/etscrivner/received_events",
         "repos_url" : "https://api.github.com/users/etscrivner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/etscrivner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/etscrivner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/etscrivner"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "created_at" : "2018-10-07T22:48:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-427693823",
      "id" : 427693823,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzY5MzgyMw==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427693823/reactions"
      },
      "updated_at" : "2018-10-07T22:48:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427693823",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69561?v=4",
         "events_url" : "https://api.github.com/users/etscrivner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/etscrivner/followers",
         "following_url" : "https://api.github.com/users/etscrivner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/etscrivner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/etscrivner",
         "id" : 69561,
         "login" : "etscrivner",
         "node_id" : "MDQ6VXNlcjY5NTYx",
         "organizations_url" : "https://api.github.com/users/etscrivner/orgs",
         "received_events_url" : "https://api.github.com/users/etscrivner/received_events",
         "repos_url" : "https://api.github.com/users/etscrivner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/etscrivner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/etscrivner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/etscrivner"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "created_at" : "2018-10-09T01:02:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-428025595",
      "id" : 428025595,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyODAyNTU5NQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/428025595/reactions"
      },
      "updated_at" : "2018-10-09T01:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/428025595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225486459"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225486459"
         }
      },
      "author_association" : "MEMBER",
      "body" : "so if i get this right: in the legacy case where walletdir == datadir, this will scan **every** file in the data directory recursively, and check it for BDB version magic?\r\nthis includes LevelDB database files, block files, debug log files, authcookie files, lock files â¦ can see tons of ways in which this can go wrong\r\nor this is somehow avoided?\r\n\r\nif not, I'd strongly suggest it should just fail in that caseâif the user wants to list non-default wallets, let them create a wallets directory",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T10:38:08Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225486459",
      "id" : 225486459,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTQ4NjQ1OQ==",
      "original_commit_id" : "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "original_line" : 61,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 44,
      "pull_request_review_id" : 165093120,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225486459/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225486459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225491304"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225491304"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No, it only recursively scans directories to try to open `wallet.dat` inside and then check magic bytes.\r\n\r\nIt checks magic bytes on all files in the walletdir (datadir in the legacy case) â not recursively.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T10:55:42Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225491304",
      "id" : 225491304,
      "in_reply_to_id" : 225486459,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTQ5MTMwNA==",
      "original_commit_id" : "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "original_line" : 61,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 44,
      "pull_request_review_id" : 165099174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225491304/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225491304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225531394"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225531394"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Any concerns about the endianness of data as compared to bdb_magic here?\r\n\r\nCould add a comment here, but this checks for databases in the native format. On big endian systems, the magic bytes are `00 05 31 62`, and on little endian systems they are `62 31 05 00`.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T13:10:10Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225531394",
      "id" : 225531394,
      "in_reply_to_id" : 223220733,
      "line" : 43,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTUzMTM5NA==",
      "original_commit_id" : "c3acd2b69069e4718f26d34241c8ea10b3cd96ea",
      "original_line" : 43,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 26,
      "pull_request_review_id" : 165148976,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225531394/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225531394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225534223"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225534223"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It still might be good to prevent this from opening too many files if there happen to be a lot of stray files in the root directory, or a lot of directories in the tree. Maybe add `&& (++count)` before `&& IsBerkeleyBtree` checks, and `if (count > 1000) throw std::runtime_error(\"Can't list wallets, too many files in walletdir\")` and the end of the loop as a sanity check.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T13:17:13Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225534223",
      "id" : 225534223,
      "in_reply_to_id" : 225486459,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTUzNDIyMw==",
      "original_commit_id" : "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "original_line" : 61,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 44,
      "pull_request_review_id" : 165148976,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225534223/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225534223",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225544502"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225544502"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@ryanofsky an alternative solution is to scan only if walletdir != datadir, WDYT?",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T13:42:40Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225544502",
      "id" : 225544502,
      "in_reply_to_id" : 225486459,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTU0NDUwMg==",
      "original_commit_id" : "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "original_line" : 61,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 44,
      "pull_request_review_id" : 165165458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225544502/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225544502",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225613639"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225613639"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> @ryanofsky an alternative solution is to scan only if walletdir != datadir, WDYT?\r\n\r\nThat seems like a worse solution. It doesn't provide protection if there's a looping directory structure or a lot of junk files in the wallet directory. It's less user friendly if users with old datadirs have to manually move database files around in order for this one rpc method to work. It also seems like it would be more complicated to test and explain.\r\n\r\nI think my suggestion is better because it would _just work_ in the all the normal cases, and provide a straightforward error message in the unusual case laanwj is concerned about.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T16:24:39Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225613639",
      "id" : 225613639,
      "in_reply_to_id" : 225486459,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTYxMzYzOQ==",
      "original_commit_id" : "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "original_line" : 61,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 44,
      "pull_request_review_id" : 165252150,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225613639/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225613639",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225624325"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225624325"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> It doesn't provide protection if there's a looping directory structure\r\n\r\nFrom the [docs](https://www.boost.org/doc/libs/1_67_0/libs/filesystem/doc/reference.html#Class-recursive_directory_iterator):\r\n> By default, recursive_directory_iterator does not follow directory symlinks\r\n\r\nIIUC considering the above looping would't happen.\r\n\r\n",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T16:55:28Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225624325",
      "id" : 225624325,
      "in_reply_to_id" : 225486459,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTYyNDMyNQ==",
      "original_commit_id" : "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "original_line" : 61,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 44,
      "pull_request_review_id" : 165265151,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225624325/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225624325",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225629987"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225629987"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> By default, recursive_directory_iterator does not follow directory symlinks\r\n\r\nI know, I was thinking about more about FUSE mounts and such. Anyway, if you think it complicates code too much to deal with unexpected filesystem stuff and provide a nice error message, I don't personally think you need to add any error handling here. I was just trying to suggest a way to deal with laanwj's concern.\r\n\r\nBut since you asked WDYT, I think special casing datadir=walletdir is a bad user experience and confusing and ugly and hard to explain.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T17:11:32Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225629987",
      "id" : 225629987,
      "in_reply_to_id" : 225486459,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTYyOTk4Nw==",
      "original_commit_id" : "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
      "original_line" : 61,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 44,
      "pull_request_review_id" : 165271682,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225629987/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225629987",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225632683"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225632683"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@ryanofsky @laanwj added these 2 checks to avoid opening unnecessary files.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T17:16:21Z",
      "diff_hunk" : "@@ -25,3 +25,50 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    if (!fs::exists(path)) return false;\n+    if (fs::file_size(path) < 1024) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225632683",
      "id" : 225632683,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTYzMjY4Mw==",
      "original_commit_id" : "47a229e920187dd90af7bba52cc0bfe4baab735c",
      "original_line" : 36,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 165273667,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225632683/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225632683",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225646785"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225646785"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure what purpose these checks serve. Are they supposed to be an optimization? Is the second check supposed to guard against opening lock files? I would suggest adding a comment here or dropping these. \r\n\r\nThe first check actually seems like the opposite of an optimization, since file_size/ifstream calls below inherently have to check that the file exists, so it seems like this just checks the same condition twice.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T17:57:51Z",
      "diff_hunk" : "@@ -25,3 +25,50 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    if (!fs::exists(path)) return false;\n+    if (fs::file_size(path) < 1024) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225646785",
      "id" : 225646785,
      "in_reply_to_id" : 225632683,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY0Njc4NQ==",
      "original_commit_id" : "47a229e920187dd90af7bba52cc0bfe4baab735c",
      "original_line" : 36,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 165291511,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225646785/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225646785",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225653862"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225653862"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The first check `fs::exists(path)` was there to prevent exceptions from the 2nd check `fs::file_size(path)`. Fixed and added comment.",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-16T18:19:27Z",
      "diff_hunk" : "@@ -25,3 +25,50 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    if (!fs::exists(path)) return false;\n+    if (fs::file_size(path) < 1024) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225653862",
      "id" : 225653862,
      "in_reply_to_id" : 225632683,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY1Mzg2Mg==",
      "original_commit_id" : "47a229e920187dd90af7bba52cc0bfe4baab735c",
      "original_line" : 36,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 165300757,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225653862/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225653862",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks, rebased to remove fixup.",
      "created_at" : "2018-10-17T23:24:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-430823215",
      "id" : 430823215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMDgyMzIxNQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430823215/reactions"
      },
      "updated_at" : "2018-10-17T23:24:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430823215",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226188328"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226188328"
         }
      },
      "author_association" : "MEMBER",
      "body" : "agree with regard to adding comment; at least I too had no idea that BerkeleyDB files generated on big-endian systems are incompatible!\r\n\r\nedit: another theory on IRC is that BerkeleyDB creates the file in native endian but accepts both (does byteswaps if needed)! if this is true, you need to check for both orderings here\r\n\r\nhere's Oracle's magic file for id'ing BDB files; https://docs.oracle.com/cd/E17275_01/html/programmer_reference/magic.txt\r\ntl;dr; check *both* ways around\r\n",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-18T07:04:26Z",
      "diff_hunk" : "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226188328",
      "id" : 226188328,
      "in_reply_to_id" : 223220733,
      "line" : 43,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjE4ODMyOA==",
      "original_commit_id" : "c3acd2b69069e4718f26d34241c8ea10b3cd96ea",
      "original_line" : 43,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 26,
      "pull_request_review_id" : 165948727,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226188328/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226188328",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226215537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226215537"
         }
      },
      "author_association" : "MEMBER",
      "body" : "switch to `fs::ifstream` post-#13878",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-18T08:38:18Z",
      "diff_hunk" : "@@ -25,3 +25,52 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    // A Berkeley DB Btree file has at least 4K.\n+    // This check also prevents opening lock files.\n+    boost::system::error_code ec;\n+    if (fs::file_size(path, ec) < 4096) return false;\n+\n+    std::ifstream file(path.string(), std::ios::binary);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226215537",
      "id" : 226215537,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjIxNTUzNw==",
      "original_commit_id" : "f27a767846997540cb459fc06a38348ded2cfbf2",
      "original_line" : 40,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : null,
      "pull_request_review_id" : 165981169,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226215537/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226215537",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK after nits ",
      "created_at" : "2018-10-18T08:46:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-430927131",
      "id" : 430927131,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMDkyNzEzMQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430927131/reactions"
      },
      "updated_at" : "2018-10-18T08:46:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430927131",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226315105"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226315105"
         }
      },
      "author_association" : "MEMBER",
      "body" : "LGTM now",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-18T13:57:31Z",
      "diff_hunk" : "@@ -25,3 +27,51 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // A Berkeley DB Btree file has at least 4K.\n+    // This check also prevents opening lock files.\n+    boost::system::error_code ec;\n+    if (fs::file_size(path, ec) < 4096) return false;\n+\n+    fs::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    //  - big endian systems - 00 05 31 62\n+    //  - little endian systems - 62 31 05 00\n+    return data == 0x00053162 || data == 0x62310500;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226315105",
      "id" : 226315105,
      "line" : 49,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjMxNTEwNQ==",
      "original_commit_id" : "b791ef12c3605c185432e391e1571853b07a7441",
      "original_line" : 49,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 32,
      "pull_request_review_id" : 166106719,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226315105/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-18T22:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226315105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK b791ef12c3605c185432e391e1571853b07a7441. Changes since last review were adding minimum file size check, switching to fs::ifstream, and no longer omitting big-endian btree files. It seems that berkeley supports loading databases with any byte order, with native byte order just being slightly more efficient: https://docs.oracle.com/cd/E17276_01/html/programmer_reference/general_am_conf.html#am_conf_byteorder",
      "created_at" : "2018-10-18T18:02:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-431106014",
      "id" : 431106014,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMTEwNjAxNA==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431106014/reactions"
      },
      "updated_at" : "2018-10-18T18:02:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431106014",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re-utACK after squash",
      "created_at" : "2018-10-18T22:21:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-431183954",
      "id" : 431183954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMTE4Mzk1NA==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431183954/reactions"
      },
      "updated_at" : "2018-10-18T22:21:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431183954",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK https://github.com/bitcoin/bitcoin/commit/d56a0689354fb814510c6c393f3e07ac9362dc1f\r\n\r\nLet's merge ð",
      "created_at" : "2018-10-18T22:38:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-431187542",
      "id" : 431187542,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMTE4NzU0Mg==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431187542/reactions"
      },
      "updated_at" : "2018-10-18T22:39:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431187542",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226823679"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226823679"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\nwallet/walletutil.cpp:71:36: error: ârelativeâ is not a member of âfsâ\r\n                 paths.emplace_back(fs::relative(it->path(), wallet_dir));\r\n                                    ^\r\n```\r\n\r\nSee: #14528 (travis: Compile once on xenial)",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-20T10:57:40Z",
      "diff_hunk" : "@@ -25,3 +27,51 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // A Berkeley DB Btree file has at least 4K.\n+    // This check also prevents opening lock files.\n+    boost::system::error_code ec;\n+    if (fs::file_size(path, ec) < 4096) return false;\n+\n+    fs::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    //  - big endian systems - 00 05 31 62\n+    //  - little endian systems - 62 31 05 00\n+    return data == 0x00053162 || data == 0x62310500;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {\n+            if (it->path().filename() == \"wallet.dat\") {\n+                // Found top-level wallet.dat btree file, add top level directory \"\"\n+                // as a wallet.\n+                paths.emplace_back();\n+            } else {\n+                // Found top-level btree file not called wallet.dat. Current bitcoin\n+                // software will never create these files but will allow them to be\n+                // opened in a shared database environment for backwards compatibility.\n+                // Add it to the list of available wallets.\n+                paths.emplace_back(fs::relative(it->path(), wallet_dir));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226823679",
      "id" : 226823679,
      "line" : 71,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjgyMzY3OQ==",
      "original_commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "original_line" : 71,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 54,
      "pull_request_review_id" : 166746134,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226823679/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-20T10:57:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226823679",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226843422"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226843422"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is wrong, `fs::relative` resolves symlinks but we allow symlinks to be specified as wallet names. I guess `listwalletdir` should list both `w7` and `w7_symlink` but in runtime only one could be loaded (actually it's the same wallet but with different names). @ryanofsky @laanwj should I fix this in #14531 or fix in a separate PR?",
      "commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "created_at" : "2018-10-20T23:32:55Z",
      "diff_hunk" : "@@ -68,6 +70,8 @@ def wallet_file(name):\n         wallet_names = ['w1', 'w2', 'w3', 'w', 'sub/w5', os.path.join(self.options.tmpdir, 'extern/w6'), 'w7_symlink', 'w8', '']\n         extra_args = ['-wallet={}'.format(n) for n in wallet_names]\n         self.start_node(0, extra_args)\n+        assert_equal(set(map(lambda w: w['name'], self.nodes[0].listwalletdir()['wallets'])), set(['', 'w3', 'w2', 'sub/w5', 'w7', 'w7', 'w1', 'w8', 'w']))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226843422",
      "id" : 226843422,
      "line" : 73,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjg0MzQyMg==",
      "original_commit_id" : "d56a0689354fb814510c6c393f3e07ac9362dc1f",
      "original_line" : 73,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/wallet_multiwallet.py",
      "position" : 13,
      "pull_request_review_id" : 166765678,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226843422/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-10-20T23:32:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226843422",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "On Debian Jessie PowerPC (Big endian) system (endianness probably unrelated):\r\n```\r\nwallet/walletutil.cpp: In function âstd::vector<boost::filesystem::path> ListWalletDir()â:\r\nwallet/walletutil.cpp:57:78: error: âendâ was not declared in this scope\r\n     for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\r\n                                                                              ^\r\nwallet/walletutil.cpp:57:78: note: suggested alternative:\r\nIn file included from /usr/include/c++/4.9/bits/basic_string.h:42:0,\r\n                 from /usr/include/c++/4.9/string:52,\r\n                 from ./fs.h:9,\r\n                 from ./wallet/walletutil.h:8,\r\n                 from wallet/walletutil.cpp:5:\r\n/usr/include/c++/4.9/initializer_list:99:5: note:   âstd::endâ\r\n     end(initializer_list<_Tp> __ils) noexcept\r\n     ^\r\nwallet/walletutil.cpp:60:32: error: ârelativeâ is not a member of âfsâ\r\n             paths.emplace_back(fs::relative(it->path(), wallet_dir));\r\n                                ^\r\nwallet/walletutil.cpp:71:36: error: ârelativeâ is not a member of âfsâ\r\n                 paths.emplace_back(fs::relative(it->path(), wallet_dir));\r\n                                    ^\r\nMakefile:6919: recipe for target 'wallet/libbitcoin_wallet_a-walletutil.o' failed\r\nmake[2]: *** [wallet/libbitcoin_wallet_a-walletutil.o] Error 1\r\nmake[2]: Leaving directory '/root/workspace/bitcoin/src'\r\nMakefile:10219: recipe for target 'all-recursive' failed\r\nmake[1]: *** [all-recursive] Error 1\r\nmake[1]: Leaving directory '/root/workspace/bitcoin/src'\r\nMakefile:697: recipe for target 'all-recursive' failed\r\nmake: *** [all-recursive] Error 1\r\n```",
      "created_at" : "2018-10-22T03:22:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-431733291",
      "id" : 431733291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMTczMzI5MQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431733291/reactions"
      },
      "updated_at" : "2018-10-22T03:22:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431733291",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   }
]
