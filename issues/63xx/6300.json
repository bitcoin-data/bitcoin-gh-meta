{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "Based on IRC talks, renamed RPC_INVALID_ADDRESS_OR_KEY to RPC_NOT_FOUND and made getblockhash return NOT_FOUND when block is above the current height.\n\nSome chat excerpts, which started earlier on the fact the error code changed in 10.x for out of range getblockhash requests:\n\n```\n<wumpus> RPC_INVALID_PARAMETER           = -8,  //! Invalid, missing or duplicate parameter\n<wumpus> that's a strange error code to return for a non-existing block\n* splix has quit (Remote host closed the connection)\n<dermoth> https://github.com/bitcoin/bitcoin.git\n<wumpus> are you providing a valid hash?\n<dermoth> oops\n<dermoth> 2ffdf21ce39fc3133fc\n<dermoth> that's the commit\n* Aido (~Aido@178.167.130.193.threembb.ie) has joined #bitcoin-dev\n<dermoth> parameter is a block number, app used to rely on error -1 to know when it reached the most recent block\n<wumpus> -1 is the general error, -8 is a more specialized one\n<dermoth> I see\n* hsmiths has quit (Quit: END OF LINE)\n<gmaxwell> error: {\"code\":-8,\"message\":\"Block height out of range\"}\n<wumpus> I think a NOT_FOUND code would be more appropriate than invalid parameter (which hints at a parse error),but don't be afraid I won't change it again...\n<dermoth> agreed\n<wumpus> at least the message is clear\n```\n\nand later on...\n\n```\n<dermoth> closest error IMHO, in existing code, is RPC_INVALID_ADDRESS_OR_KEY\n<wumpus> indeed. We've been using that as a NOT_FOUND.\n<wumpus> maybe renaming it would be an idea\n<wumpus> as said, those error names are back-projected by me, the original codebase used bare numbers without any explanation\n<dermoth> would you keep the current one as an alias? I can submit a pr\n<wumpus> yes, good idea\n<dermoth> if (nHeight < 0... should be NOT FOUND too?\n<dermoth> I see where the invalid param comes from, maybe split it up then\n<wumpus> bleh.\n<wumpus> see why this was never addressed? you lift it in one place, and notice the whole fabric is coming apart :-)\n<wumpus> I mean I'm sure RPC_INVALID_ADDRESS_OR_KEY is also used in many cases where it really means RPC_INVALID_PARAMETER\n<wumpus> before you know it, you're breaking the entire API\n* abossard (~andre@46.140.123.2) has joined #bitcoin-dev\n<wumpus> (and maybe that's for the best, but then it will be a fully fledged RPC return values redesign, and you would have accomplished exactly what you were coming here to complain about in the first place - hehe)\n<wumpus> but maybe there's a middle way, I don't know, thanks for looking into it.\n```\n\nThe change has been tested with the backward-compatible alias commented out:\n\n```\n<dermoth> wumpus, tested ok\n<dermoth> $ ~/bitcoin/bitcoin/bin/bitcoin-cli getblockhash -1\n<dermoth> error: {\"code\":-8,\"message\":\"Negative block height\"}\n<wumpus> great, time to submit a PR then\n<dermoth> $ ~/bitcoin/bitcoin/bin/bitcoin-cli getblockhash 361428\n<dermoth> error: {\"code\":-5,\"message\":\"Block height out of range\"}\n<dermoth> $ ~/bitcoin/bitcoin/bin/bitcoin-cli getblockhash 361424\n<dermoth> 000000000000000004fd86600f6a12e5186ec18f11d7502afba3b7f7e00cae1a\n<dermoth> used the 10.2 client though, but was runnign the 0.11-blarhs-dirty one (dirty bc of the commented out alias)\n<dermoth> v0.11.99.0-fa19502-dirty (64-bit)\n```\n",
   "closed_at" : "2015-11-11T17:21:52Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 10,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6300/comments",
   "created_at" : "2015-06-18T06:18:03Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6300/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/6300",
   "id" : 89210381,
   "labels" : [
      {
         "color" : "0052cc",
         "default" : false,
         "id" : 98279177,
         "name" : "RPC/REST/ZMQ",
         "node_id" : "MDU6TGFiZWw5ODI3OTE3Nw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6300/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0Mzc5NzQ1NzE=",
   "number" : 6300,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/6300.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6300",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/6300.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6300"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "getblockhash: Return RPC_NOT_FOUND when nHeight > chainActive.Height()",
   "updated_at" : "2015-11-11T17:21:52Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6300",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/403890?v=4",
      "events_url" : "https://api.github.com/users/dermoth/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dermoth/followers",
      "following_url" : "https://api.github.com/users/dermoth/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dermoth/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dermoth",
      "id" : 403890,
      "login" : "dermoth",
      "node_id" : "MDQ6VXNlcjQwMzg5MA==",
      "organizations_url" : "https://api.github.com/users/dermoth/orgs",
      "received_events_url" : "https://api.github.com/users/dermoth/received_events",
      "repos_url" : "https://api.github.com/users/dermoth/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dermoth/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dermoth/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dermoth"
   }
}
