[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, will review ",
      "created_at" : "2021-03-31T11:58:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-811007463",
      "id" : 811007463,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMTAwNzQ2Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-31T11:58:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811007463",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r604889799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604889799"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I ran https://gist.github.com/laanwj/b3d7b01ef61ce07c2eff0a72a6b90183 on my node:\r\n\r\n* Extra addresses I have that are not on this list:\r\n```\r\n2g5qfdkn2vvcbqhzcyvyiitg4ceukybxklraxjnu7atlhd22gdwywaid.onion:8333\r\n2jmtxvyup3ijr7u6uvu7ijtnojx4g5wodvaedivbv74w4vzntxbrhvad.onion:8333\r\n37m62wn7dz3uqpathpc4qfmgrbupachj52nt3jbtbjugpbu54kbud7yd.onion:8333\r\n7cgwjuwi5ehvcay4tazy7ya6463bndjk6xzrttw5t3xbpq4p22q6fyid.onion:8333\r\nfjdyxicpm4o42xmedlwl3uvk5gmqdfs5j37wir52327vncjzvtpfv7yd.onion:8333\r\nfzhn4uoxfbfss7h7d6ffbn266ca432ekbbzvqtsdd55ylgxn4jucm5qd.onion:8333\r\nifdu5qvbofrt4ekui2iyb3kbcyzcsglazhx2hn4wfskkrx2v24qxriid.onion:8333\r\nm7cbpjolo662uel7rpaid46as2otcj44vvwg3gccodnvaeuwbm3anbyd.onion:8333\r\nowjsdxmzla6d7lrwkbmetywqym5cyswpihciesfl5qdv2vrmwsgy4uqd.onion:8333\r\nvi5bnbxkleeqi6hfccjochnn65lcxlfqs4uwgmhudph554zibiusqnad.onion:8333\r\n```\r\n\r\n* Addresses that are on this list, but not on my node:\r\n```\r\n7pyrpvqdhmayxggpcyqn5l3m5vqkw3qubnmgwlpya2mdo6x7pih7r7id.onion:8333\r\nb64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion:8333\r\nfpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion:8333\r\ngxo5anvfnffnftfy5frkgvplq3rpga2ie3tcblo2vl754fvnhgorn5yd.onion:8333\r\nitz3oxsihs62muvknc237xabl5f6w6rfznfhbpayrslv2j2ubels47yd.onion:8333\r\nlrjh6fywjqttmlifuemq3puhvmshxzzyhoqx7uoufali57eypuenzzid.onion:8333\r\nopnyfyeiibe5qo5a3wbxzbb4xdiagc32bbce46owmertdknta5mi7uyd.onion:8333\r\nq7kgmd7n7h27ds4fg7wocgniuqb3oe2zxp4nfe4skd5da6wyipibqzqd.onion:8333\r\nsys54sv4xv3hn3sdiv3oadmzqpgyhd4u4xphv4xqk64ckvaxzm57a7yd.onion:8333\r\ntddeij4qigtjr6jfnrmq6btnirmq5msgwcsdpcdjr7atftm7cxlqztid.onion:8333\r\nxqt25cobm5zqucac3634zfght72he6u3eagfyej5ellbhcdgos7t2had.onion:8333\r\n```\r\nI can connect to all of them except `opnyfyeiibe5qo5a3wbxzbb4xdiagc32bbce46owmertdknta5mi7uyd.onion:8333`.\r\n\r\n* Addresses on both this list and my node:\r\n```\r\n5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion:8333\r\nejxefzf5fpst4mg2rib7grksvscl7p6fvjp6agzgfc2yglxnjtxc3aid.onion:8333\r\nrp7k2go3s5lyj3fnj6zn62ktarlrsft2ohlsxkyd7v3e3idqyptvread.onion:8333\r\n```\r\n\r\nIt makes things a bit easier if the list is sorted.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T13:19:42Z",
      "diff_hunk" : "@@ -1162,3 +1162,19 @@ zuytrfevzjcpizli.onion:8333\n zvq6dpt3i2ofdp3g.onion:8333\n zwwm6ga7u2hqe2sd.onion:8333\n zyqb4lenfspntj5m.onion:8333\n+\n+# manually added 2021-03 for minimal torv3 bootstrap support",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r604889799",
      "id" : 604889799,
      "line" : 1166,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDg4OTc5OQ==",
      "original_commit_id" : "1007a73402128acd55fd4658c5f90fc50b103d4f",
      "original_line" : 1166,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "contrib/seeds/nodes_main.txt",
      "position" : 5,
      "pull_request_review_id" : 625278654,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604889799",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r604981372"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604981372"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thank you. I pushed a squashme commit to add your nodes and sort the list. I have also adapted the script to print a sorted list.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T15:06:59Z",
      "diff_hunk" : "@@ -1162,3 +1162,19 @@ zuytrfevzjcpizli.onion:8333\n zvq6dpt3i2ofdp3g.onion:8333\n zwwm6ga7u2hqe2sd.onion:8333\n zyqb4lenfspntj5m.onion:8333\n+\n+# manually added 2021-03 for minimal torv3 bootstrap support",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r604981372",
      "id" : 604981372,
      "in_reply_to_id" : 604889799,
      "line" : 1166,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDk4MTM3Mg==",
      "original_commit_id" : "1007a73402128acd55fd4658c5f90fc50b103d4f",
      "original_line" : 1166,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "contrib/seeds/nodes_main.txt",
      "position" : 5,
      "pull_request_review_id" : 625404085,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604981372",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605071657"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605071657"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: I guess `len(addr)>6 and ` can be removed - python's `endswith()` will return false if the string is too short.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:04:45Z",
      "diff_hunk" : "@@ -13,44 +13,47 @@\n \n These files must consist of lines in the format\n \n-    <ip>\n     <ip>:<port>\n-    [<ipv6>]\n     [<ipv6>]:<port>\n-    <onion>.onion\n-    0xDDBBCCAA (IPv4 little-endian old pnSeeds format)\n+    <onion>.onion:<port>\n \n The output will be two data structures with the peers in binary format:\n \n-   static SeedSpec6 pnSeed6_main[]={\n-   ...\n-   }\n-   static SeedSpec6 pnSeed6_test[]={\n+   static const uint8_t chainparams_seed_{main,test}[]={\n    ...\n    }\n \n These should be pasted into `src/chainparamsseeds.h`.\n '''\n \n from base64 import b32decode\n-from binascii import a2b_hex\n+from enum import Enum\n+import struct\n import sys\n import os\n import re\n \n-# ipv4 in ipv6 prefix\n-pchIPv4 = bytearray([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff])\n-# tor-specific ipv6 prefix\n-pchOnionCat = bytearray([0xFD,0x87,0xD8,0x7E,0xEB,0x43])\n+class BIP155Network(Enum):\n+    IPV4 = 1\n+    IPV6 = 2\n+    TORV2 = 3\n+    TORV3 = 4\n+    I2P = 5\n+    CJDNS = 6\n \n-def name_to_ipv6(addr):\n+def name_to_bip155(addr):\n+    '''Convert address string to BIP155 (networkID, addr) tuple.'''\n     if len(addr)>6 and addr.endswith('.onion'):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605071657",
      "id" : 605071657,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA3MTY1Nw==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 46,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : null,
      "pull_request_review_id" : 625525052,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605071657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605073289"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605073289"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This will brick with `foo.b32.i2p`. I guess out of the scope of this PR.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:07:15Z",
      "diff_hunk" : "@@ -13,44 +13,47 @@\n \n These files must consist of lines in the format\n \n-    <ip>\n     <ip>:<port>\n-    [<ipv6>]\n     [<ipv6>]:<port>\n-    <onion>.onion\n-    0xDDBBCCAA (IPv4 little-endian old pnSeeds format)\n+    <onion>.onion:<port>\n \n The output will be two data structures with the peers in binary format:\n \n-   static SeedSpec6 pnSeed6_main[]={\n-   ...\n-   }\n-   static SeedSpec6 pnSeed6_test[]={\n+   static const uint8_t chainparams_seed_{main,test}[]={\n    ...\n    }\n \n These should be pasted into `src/chainparamsseeds.h`.\n '''\n \n from base64 import b32decode\n-from binascii import a2b_hex\n+from enum import Enum\n+import struct\n import sys\n import os\n import re\n \n-# ipv4 in ipv6 prefix\n-pchIPv4 = bytearray([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff])\n-# tor-specific ipv6 prefix\n-pchOnionCat = bytearray([0xFD,0x87,0xD8,0x7E,0xEB,0x43])\n+class BIP155Network(Enum):\n+    IPV4 = 1\n+    IPV6 = 2\n+    TORV2 = 3\n+    TORV3 = 4\n+    I2P = 5\n+    CJDNS = 6\n \n-def name_to_ipv6(addr):\n+def name_to_bip155(addr):\n+    '''Convert address string to BIP155 (networkID, addr) tuple.'''\n     if len(addr)>6 and addr.endswith('.onion'):\n         vchAddr = b32decode(addr[0:-6], True)\n-        if len(vchAddr) != 16-len(pchOnionCat):\n+        if len(vchAddr) == 10:\n+            return (BIP155Network.TORV2, vchAddr)\n+        elif len(vchAddr) == 35:\n+            assert(vchAddr[34] == 3)\n+            return (BIP155Network.TORV3, vchAddr[:32])\n+        else:\n             raise ValueError('Invalid onion %s' % vchAddr)\n-        return pchOnionCat + vchAddr\n     elif '.' in addr: # IPv4",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605073289",
      "id" : 605073289,
      "line" : 55,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA3MzI4OQ==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 55,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : 68,
      "pull_request_review_id" : 625525052,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605073289",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605078670"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605078670"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Can this reuse `ser_compact_size()` from `test/functional/test_framework/messages.py`? Or move it to another place so that both can use it?",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:15:24Z",
      "diff_hunk" : "@@ -85,32 +87,52 @@ def parse_spec(s, defaultport):\n         (host,_,port) = s.partition(':')\n \n     if not port:\n-        port = defaultport\n+        port = 0\n     else:\n         port = int(port)\n \n-    host = name_to_ipv6(host)\n+    host = name_to_bip155(host)\n \n-    return (host,port)\n+    return host + (port, )\n \n-def process_nodes(g, f, structname, defaultport):\n-    g.write('static SeedSpec6 %s[] = {\\n' % structname)\n-    first = True\n+def ser_compact_size(l):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605078670",
      "id" : 605078670,
      "line" : 98,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA3ODY3MA==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 98,
      "original_position" : 100,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : 109,
      "pull_request_review_id" : 625525052,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605078670",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605082017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605082017"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "note: very similar to `CAddress::serialize_v2()` from `test/functional/test_framework/messages.py`.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:20:14Z",
      "diff_hunk" : "@@ -85,32 +87,52 @@ def parse_spec(s, defaultport):\n         (host,_,port) = s.partition(':')\n \n     if not port:\n-        port = defaultport\n+        port = 0\n     else:\n         port = int(port)\n \n-    host = name_to_ipv6(host)\n+    host = name_to_bip155(host)\n \n-    return (host,port)\n+    return host + (port, )\n \n-def process_nodes(g, f, structname, defaultport):\n-    g.write('static SeedSpec6 %s[] = {\\n' % structname)\n-    first = True\n+def ser_compact_size(l):\n+    r = b\"\"\n+    if l < 253:\n+        r = struct.pack(\"B\", l)\n+    elif l < 0x10000:\n+        r = struct.pack(\"<BH\", 253, l)\n+    elif l < 0x100000000:\n+        r = struct.pack(\"<BI\", 254, l)\n+    else:\n+        r = struct.pack(\"<BQ\", 255, l)\n+    return r\n+\n+def bip155_serialize(spec):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605082017",
      "id" : 605082017,
      "line" : 110,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA4MjAxNw==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 110,
      "original_position" : 112,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : 121,
      "pull_request_review_id" : 625525052,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605082017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605086076"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605086076"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "After these changes `contrib/seeds/nodes_test.txt` needs to have `:8333` appended to its addresses.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:26:13Z",
      "diff_hunk" : "@@ -13,44 +13,47 @@\n \n These files must consist of lines in the format\n \n-    <ip>\n     <ip>:<port>\n-    [<ipv6>]\n     [<ipv6>]:<port>\n-    <onion>.onion\n-    0xDDBBCCAA (IPv4 little-endian old pnSeeds format)\n+    <onion>.onion:<port>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605086076",
      "id" : 605086076,
      "line" : 18,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA4NjA3Ng==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 18,
      "original_position" : 10,
      "original_start_line" : 16,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : 17,
      "pull_request_review_id" : 625525052,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : 16,
      "start_side" : "LEFT",
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605086076",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605090859"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605090859"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I would like to keep this script self-contained. It is simple enough logic.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:32:50Z",
      "diff_hunk" : "@@ -85,32 +87,52 @@ def parse_spec(s, defaultport):\n         (host,_,port) = s.partition(':')\n \n     if not port:\n-        port = defaultport\n+        port = 0\n     else:\n         port = int(port)\n \n-    host = name_to_ipv6(host)\n+    host = name_to_bip155(host)\n \n-    return (host,port)\n+    return host + (port, )\n \n-def process_nodes(g, f, structname, defaultport):\n-    g.write('static SeedSpec6 %s[] = {\\n' % structname)\n-    first = True\n+def ser_compact_size(l):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605090859",
      "id" : 605090859,
      "in_reply_to_id" : 605078670,
      "line" : 98,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA5MDg1OQ==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 98,
      "original_position" : 100,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : 109,
      "pull_request_review_id" : 625549869,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605090859",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605091270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605091270"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same comment as above. Jumping though hoops to share code between this script and the tests is not worth it for such trivial functionality imo.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:33:32Z",
      "diff_hunk" : "@@ -85,32 +87,52 @@ def parse_spec(s, defaultport):\n         (host,_,port) = s.partition(':')\n \n     if not port:\n-        port = defaultport\n+        port = 0\n     else:\n         port = int(port)\n \n-    host = name_to_ipv6(host)\n+    host = name_to_bip155(host)\n \n-    return (host,port)\n+    return host + (port, )\n \n-def process_nodes(g, f, structname, defaultport):\n-    g.write('static SeedSpec6 %s[] = {\\n' % structname)\n-    first = True\n+def ser_compact_size(l):\n+    r = b\"\"\n+    if l < 253:\n+        r = struct.pack(\"B\", l)\n+    elif l < 0x10000:\n+        r = struct.pack(\"<BH\", 253, l)\n+    elif l < 0x100000000:\n+        r = struct.pack(\"<BI\", 254, l)\n+    else:\n+        r = struct.pack(\"<BQ\", 255, l)\n+    return r\n+\n+def bip155_serialize(spec):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605091270",
      "id" : 605091270,
      "in_reply_to_id" : 605082017,
      "line" : 110,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA5MTI3MA==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 110,
      "original_position" : 112,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : 121,
      "pull_request_review_id" : 625550471,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605091270",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605092122"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605092122"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good catch! s/8333/18333/ofc ",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:34:47Z",
      "diff_hunk" : "@@ -13,44 +13,47 @@\n \n These files must consist of lines in the format\n \n-    <ip>\n     <ip>:<port>\n-    [<ipv6>]\n     [<ipv6>]:<port>\n-    <onion>.onion\n-    0xDDBBCCAA (IPv4 little-endian old pnSeeds format)\n+    <onion>.onion:<port>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605092122",
      "id" : 605092122,
      "in_reply_to_id" : 605086076,
      "line" : 18,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA5MjEyMg==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 18,
      "original_position" : 10,
      "original_start_line" : 16,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : 17,
      "pull_request_review_id" : 625551528,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : 16,
      "start_side" : "LEFT",
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605092122",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605092577"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605092577"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, adding I2P hardcoded seeds can be done in a follow-up PR.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:35:29Z",
      "diff_hunk" : "@@ -13,44 +13,47 @@\n \n These files must consist of lines in the format\n \n-    <ip>\n     <ip>:<port>\n-    [<ipv6>]\n     [<ipv6>]:<port>\n-    <onion>.onion\n-    0xDDBBCCAA (IPv4 little-endian old pnSeeds format)\n+    <onion>.onion:<port>\n \n The output will be two data structures with the peers in binary format:\n \n-   static SeedSpec6 pnSeed6_main[]={\n-   ...\n-   }\n-   static SeedSpec6 pnSeed6_test[]={\n+   static const uint8_t chainparams_seed_{main,test}[]={\n    ...\n    }\n \n These should be pasted into `src/chainparamsseeds.h`.\n '''\n \n from base64 import b32decode\n-from binascii import a2b_hex\n+from enum import Enum\n+import struct\n import sys\n import os\n import re\n \n-# ipv4 in ipv6 prefix\n-pchIPv4 = bytearray([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff])\n-# tor-specific ipv6 prefix\n-pchOnionCat = bytearray([0xFD,0x87,0xD8,0x7E,0xEB,0x43])\n+class BIP155Network(Enum):\n+    IPV4 = 1\n+    IPV6 = 2\n+    TORV2 = 3\n+    TORV3 = 4\n+    I2P = 5\n+    CJDNS = 6\n \n-def name_to_ipv6(addr):\n+def name_to_bip155(addr):\n+    '''Convert address string to BIP155 (networkID, addr) tuple.'''\n     if len(addr)>6 and addr.endswith('.onion'):\n         vchAddr = b32decode(addr[0:-6], True)\n-        if len(vchAddr) != 16-len(pchOnionCat):\n+        if len(vchAddr) == 10:\n+            return (BIP155Network.TORV2, vchAddr)\n+        elif len(vchAddr) == 35:\n+            assert(vchAddr[34] == 3)\n+            return (BIP155Network.TORV3, vchAddr[:32])\n+        else:\n             raise ValueError('Invalid onion %s' % vchAddr)\n-        return pchOnionCat + vchAddr\n     elif '.' in addr: # IPv4",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605092577",
      "id" : 605092577,
      "in_reply_to_id" : 605073289,
      "line" : 55,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA5MjU3Nw==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 55,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : 68,
      "pull_request_review_id" : 625552129,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605092577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605093305"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605093305"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, that could be removed (done in squashme pr).",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T17:36:33Z",
      "diff_hunk" : "@@ -13,44 +13,47 @@\n \n These files must consist of lines in the format\n \n-    <ip>\n     <ip>:<port>\n-    [<ipv6>]\n     [<ipv6>]:<port>\n-    <onion>.onion\n-    0xDDBBCCAA (IPv4 little-endian old pnSeeds format)\n+    <onion>.onion:<port>\n \n The output will be two data structures with the peers in binary format:\n \n-   static SeedSpec6 pnSeed6_main[]={\n-   ...\n-   }\n-   static SeedSpec6 pnSeed6_test[]={\n+   static const uint8_t chainparams_seed_{main,test}[]={\n    ...\n    }\n \n These should be pasted into `src/chainparamsseeds.h`.\n '''\n \n from base64 import b32decode\n-from binascii import a2b_hex\n+from enum import Enum\n+import struct\n import sys\n import os\n import re\n \n-# ipv4 in ipv6 prefix\n-pchIPv4 = bytearray([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff])\n-# tor-specific ipv6 prefix\n-pchOnionCat = bytearray([0xFD,0x87,0xD8,0x7E,0xEB,0x43])\n+class BIP155Network(Enum):\n+    IPV4 = 1\n+    IPV6 = 2\n+    TORV2 = 3\n+    TORV3 = 4\n+    I2P = 5\n+    CJDNS = 6\n \n-def name_to_ipv6(addr):\n+def name_to_bip155(addr):\n+    '''Convert address string to BIP155 (networkID, addr) tuple.'''\n     if len(addr)>6 and addr.endswith('.onion'):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605093305",
      "id" : 605093305,
      "in_reply_to_id" : 605071657,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTA5MzMwNQ==",
      "original_commit_id" : "213a740fe4a3dab41380e05f29219a888114988c",
      "original_line" : 46,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : null,
      "pull_request_review_id" : 625553061,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605093305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2021-03-31T18:07:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-811298193",
      "id" : 811298193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMTI5ODE5Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-01T09:48:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811298193",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605265988"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605265988"
         }
      },
      "author_association" : "MEMBER",
      "body" : "With a `VectorReader` here you'd avoid copying the encoded bytes.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-03-31T22:42:04Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605265988",
      "id" : 605265988,
      "line" : 154,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTI2NTk4OA==",
      "original_commit_id" : "1007a73402128acd55fd4658c5f90fc50b103d4f",
      "original_line" : 154,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 21,
      "pull_request_review_id" : 625774926,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605265988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605425973"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605425973"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeaâa lot of optimizations could be made here; it's a byte array in rodata, we could return it as `span<uint8_t>`, and deserialize directly from there, making it zero-copy. That said, this happens once in the lifetime of a node (ideally) and it's not that much data, so i'm not sure.\r\nBut if it's just a matter of swapping the type used i'm in :smile: ",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-01T07:12:54Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605425973",
      "id" : 605425973,
      "in_reply_to_id" : 605265988,
      "line" : 154,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTQyNTk3Mw==",
      "original_commit_id" : "1007a73402128acd55fd4658c5f90fc50b103d4f",
      "original_line" : 154,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 21,
      "pull_request_review_id" : 625961348,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605425973",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm ok with squashing.\r\n\r\nRight i'll squash the `squashme:` commits into the appropriate top-level commits once it seems the (first round of) review is over. I think this is somewhat friendlier on reviewers in progress than squashing all the time.",
      "created_at" : "2021-04-01T07:14:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-811700335",
      "id" : 811700335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMTcwMDMzNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-01T07:14:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811700335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605434972"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605434972"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think I'm not sure how to use it. At least the obvious change gives a lot of compiler errors:\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 52e35b56077bf6562202461f73a93e03097c91f9..507d61df0cd541e0696ead1c22cc582380bb1521 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -151,8 +151,8 @@ static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\r\n     const int64_t nOneWeek = 7*24*60*60;\r\n     std::vector<CAddress> vSeedsOut;\r\n     FastRandomContext rng;\r\n-    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);\r\n-    while (!s.eof()) {\r\n+    VectorReader s(SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT, vSeedsIn, 0);\r\n+    while (!s.empty()) {\r\n         CService endpoint;\r\n         s >> endpoint;\r\n         CAddress addr(endpoint, GetDesirableServiceFlags(NODE_NONE));\r\n```\r\n\r\n```\r\n/â¦/bitcoin/src/netaddress.h:430:15: error: invalid operands to binary expression ('VectorReader' and 'Wrapper<CompactSizeFormatter<true>, unsigned long &>')                            \r\n            s >> COMPACTSIZE(address_size);\r\n            ~ ^  ~~~~~~~~~~~~~~~~~~~~~~~~~                                                                                                                                                                                          \r\n```",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-01T07:29:04Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605434972",
      "id" : 605434972,
      "in_reply_to_id" : 605265988,
      "line" : 154,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTQzNDk3Mg==",
      "original_commit_id" : "1007a73402128acd55fd4658c5f90fc50b103d4f",
      "original_line" : 154,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 21,
      "pull_request_review_id" : 625972752,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605434972",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605439255"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605439255"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok, never mind then. We can figure out how to make this work in a follow-up (there are probably several other cases in the codebase where this is done).",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-01T07:37:05Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605439255",
      "id" : 605439255,
      "in_reply_to_id" : 605265988,
      "line" : 154,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTQzOTI1NQ==",
      "original_commit_id" : "1007a73402128acd55fd4658c5f90fc50b103d4f",
      "original_line" : 154,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 21,
      "pull_request_review_id" : 625978444,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605439255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605566426"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605566426"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This printed 1188 lines to the log. I think it is ok.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-01T11:01:42Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);\n+    while (!s.eof()) {\n+        CService endpoint;\n+        s >> endpoint;\n+        CAddress addr(endpoint, GetDesirableServiceFlags(NODE_NONE));\n         addr.nTime = GetTime() - rng.randrange(nOneWeek) - nOneWeek;\n+        LogPrint(BCLog::NET, \"Added hardcoded seed: %s\\n\", addr.ToString());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605566426",
      "id" : 605566426,
      "line" : 160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTU2NjQyNg==",
      "original_commit_id" : "ede28e76c6ddf5da5518d834c3c3a18ce69cfb6f",
      "original_line" : 160,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 27,
      "pull_request_review_id" : 626144060,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605566426",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605571516"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605571516"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: the corresponding line in the test framework uses `B` instead of `>B`:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/80a699fda9ff1129546cabbf17e955680a1cc705/test/functional/test_framework/messages.py#L273\r\n\r\nsince this is duplicated code, I think it is good to keep it \"the same\" and since byte order is irrelevant for one-byte fields, maybe remove the `>` from here.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-01T11:11:52Z",
      "diff_hunk" : "@@ -85,32 +87,52 @@ def parse_spec(s, defaultport):\n         (host,_,port) = s.partition(':')\n \n     if not port:\n-        port = defaultport\n+        port = 0\n     else:\n         port = int(port)\n \n-    host = name_to_ipv6(host)\n+    host = name_to_bip155(host)\n \n-    return (host,port)\n+    return host + (port, )\n \n-def process_nodes(g, f, structname, defaultport):\n-    g.write('static SeedSpec6 %s[] = {\\n' % structname)\n-    first = True\n+def ser_compact_size(l):\n+    r = b\"\"\n+    if l < 253:\n+        r = struct.pack(\"B\", l)\n+    elif l < 0x10000:\n+        r = struct.pack(\"<BH\", 253, l)\n+    elif l < 0x100000000:\n+        r = struct.pack(\"<BI\", 254, l)\n+    else:\n+        r = struct.pack(\"<BQ\", 255, l)\n+    return r\n+\n+def bip155_serialize(spec):\n+    '''\n+    Serialize (networkID, addr, port) tuple to BIP155 binary format.\n+    '''\n+    r = b\"\"\n+    r += struct.pack('>B', spec[0].value)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605571516",
      "id" : 605571516,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTU3MTUxNg==",
      "original_commit_id" : "ede28e76c6ddf5da5518d834c3c3a18ce69cfb6f",
      "original_line" : 115,
      "original_position" : 126,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : null,
      "pull_request_review_id" : 626144060,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605571516",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605584917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605584917"
         }
      },
      "author_association" : "MEMBER",
      "body" : "AHHH good catch, this is just to debug / test, it's convenient to be able to check if it matches the generated data. I'm not sure there is any point to it for end users :smile: But if you think it's ok we can leave it in.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-01T11:36:14Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);\n+    while (!s.eof()) {\n+        CService endpoint;\n+        s >> endpoint;\n+        CAddress addr(endpoint, GetDesirableServiceFlags(NODE_NONE));\n         addr.nTime = GetTime() - rng.randrange(nOneWeek) - nOneWeek;\n+        LogPrint(BCLog::NET, \"Added hardcoded seed: %s\\n\", addr.ToString());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605584917",
      "id" : 605584917,
      "in_reply_to_id" : 605566426,
      "line" : 160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTU4NDkxNw==",
      "original_commit_id" : "ede28e76c6ddf5da5518d834c3c3a18ce69cfb6f",
      "original_line" : 160,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 27,
      "pull_request_review_id" : 626168597,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605584917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605585662"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605585662"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sure, will remove it. Myself I tend to use \">\" symbolically in any kind of big-endian structure just in case I don't forget it when adding fields later (but there is not really any risk of that here).\r\n\r\nEdit: done in a9ee5683ce4013904f6e53f29e37632969926b0d",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-01T11:37:44Z",
      "diff_hunk" : "@@ -85,32 +87,52 @@ def parse_spec(s, defaultport):\n         (host,_,port) = s.partition(':')\n \n     if not port:\n-        port = defaultport\n+        port = 0\n     else:\n         port = int(port)\n \n-    host = name_to_ipv6(host)\n+    host = name_to_bip155(host)\n \n-    return (host,port)\n+    return host + (port, )\n \n-def process_nodes(g, f, structname, defaultport):\n-    g.write('static SeedSpec6 %s[] = {\\n' % structname)\n-    first = True\n+def ser_compact_size(l):\n+    r = b\"\"\n+    if l < 253:\n+        r = struct.pack(\"B\", l)\n+    elif l < 0x10000:\n+        r = struct.pack(\"<BH\", 253, l)\n+    elif l < 0x100000000:\n+        r = struct.pack(\"<BI\", 254, l)\n+    else:\n+        r = struct.pack(\"<BQ\", 255, l)\n+    return r\n+\n+def bip155_serialize(spec):\n+    '''\n+    Serialize (networkID, addr, port) tuple to BIP155 binary format.\n+    '''\n+    r = b\"\"\n+    r += struct.pack('>B', spec[0].value)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605585662",
      "id" : 605585662,
      "in_reply_to_id" : 605571516,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTU4NTY2Mg==",
      "original_commit_id" : "ede28e76c6ddf5da5518d834c3c3a18ce69cfb6f",
      "original_line" : 115,
      "original_position" : 126,
      "original_start_line" : null,
      "path" : "contrib/seeds/generate-seeds.py",
      "position" : null,
      "pull_request_review_id" : 626169546,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605585662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605667769"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605667769"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "There are also a lot of `IP ... mapped to AS0 belongs to new bucket ...` messages printed by `-debug=net`. ~0 on this new printout.",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-01T13:42:07Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);\n+    while (!s.eof()) {\n+        CService endpoint;\n+        s >> endpoint;\n+        CAddress addr(endpoint, GetDesirableServiceFlags(NODE_NONE));\n         addr.nTime = GetTime() - rng.randrange(nOneWeek) - nOneWeek;\n+        LogPrint(BCLog::NET, \"Added hardcoded seed: %s\\n\", addr.ToString());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r605667769",
      "id" : 605667769,
      "in_reply_to_id" : 605566426,
      "line" : 160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNTY2Nzc2OQ==",
      "original_commit_id" : "ede28e76c6ddf5da5518d834c3c3a18ce69cfb6f",
      "original_line" : 160,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 27,
      "pull_request_review_id" : 626280953,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/605667769",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r606381505"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/606381505"
         }
      },
      "author_association" : "MEMBER",
      "body" : "1007a73 naming nit, this function only has one caller so could be easily updated to the current style\r\n```suggestion\r\nstatic std::vector<CAddress> ConvertSeeds(const std::vector<uint8_t> &vSeedsIn)\r\n```",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-02T19:16:59Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r606381505",
      "id" : 606381505,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNjM4MTUwNQ==",
      "original_commit_id" : "a9ee5683ce4013904f6e53f29e37632969926b0d",
      "original_line" : 145,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 627218805,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/606381505",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r606381809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/606381809"
         }
      },
      "author_association" : "MEMBER",
      "body" : "1007a73 could use braced initialization\r\n```suggestion\r\n        CAddress addr{endpoint, GetDesirableServiceFlags(NODE_NONE)};\r\n```",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-02T19:17:44Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);\n+    while (!s.eof()) {\n+        CService endpoint;\n+        s >> endpoint;\n+        CAddress addr(endpoint, GetDesirableServiceFlags(NODE_NONE));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r606381809",
      "id" : 606381809,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNjM4MTgwOQ==",
      "original_commit_id" : "a9ee5683ce4013904f6e53f29e37632969926b0d",
      "original_line" : 158,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 627218805,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/606381809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm running the gist (had to update the file perms for it to run) and it's taking a while as I have many (nearly 1835 and increasing) tor v3 addresses\r\n\r\nThe gist script finished. It checked 1836 v3 addresses and returned 1523 of them, sorted. I saved it in a text file if useful.",
      "created_at" : "2021-04-03T10:18:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-812845248",
      "id" : 812845248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMjg0NTI0OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-03T13:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/812845248",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Update:\r\n```json\r\n$ ./src/bitcoin-cli -addressinfo\r\n{\r\n  \"addresses known\": {\r\n    \"ipv4\": 185,\r\n    \"ipv6\": 0,\r\n    \"torv2\": 5597,\r\n    \"torv3\": 2220,\r\n    \"i2p\": 7,\r\n    \"total\": 8009\r\n  }\r\n}\r\n```\r\n",
      "created_at" : "2021-04-04T11:04:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-813014057",
      "id" : 813014057,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMzAxNDA1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-04T11:04:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813014057",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I'll pick up #20648 again after this is merged.",
      "created_at" : "2021-04-04T12:08:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-813022184",
      "id" : 813022184,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMzAyMjE4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-04T12:08:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813022184",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> The gist script finished. It checked 1836 v3 addresses and returned 1523 of them, sorted. I saved it in a text file if useful.\r\n\r\nMaybe! The scope of this PR is just to get things started in that regard, not to add as many nodes as possible.  We'd have to decide on how many, and which ones to use; as a guide `makeseeds.py` limits to 512 seeds per net, but how do we want to divide this over TorV2 and TorV3?\r\n\r\nWe could do that kind of process to create a list of I2P and Tor seed nodes for 0.22.\r\nI've openened  sipa/bitcoin-seeder#92 but am not sure that is the best approach. I mean it's not rational for the DNS seeder's crawler to collect addresses it can't do anything with.\r\n\r\nThe advantage of the dedicated crawler approach to my gist is that it applies some more stringent conditions to the nodes. For example it samples uptime and gets the node's version information. But maybe that can be added, too.\r\n\r\n> ./src/bitcoin-cli -addressinfo\r\n\r\nNice!",
      "created_at" : "2021-04-05T11:50:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-813356162",
      "id" : 813356162,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMzM1NjE2Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-05T11:52:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813356162",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r607054074"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/607054074"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, done",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-05T12:03:40Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r607054074",
      "id" : 607054074,
      "in_reply_to_id" : 606381505,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNzA1NDA3NA==",
      "original_commit_id" : "a9ee5683ce4013904f6e53f29e37632969926b0d",
      "original_line" : 145,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 627800089,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/607054074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r607054108"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/607054108"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, done",
      "commit_id" : "b2ee8b207de78f03356905bd60b7b00b6f49c252",
      "created_at" : "2021-04-05T12:03:48Z",
      "diff_hunk" : "@@ -141,22 +141,23 @@ bool GetLocal(CService& addr, const CNetAddr *paddrPeer)\n     return nBestScore >= 0;\n }\n \n-//! Convert the pnSeed6 array into usable address objects.\n-static std::vector<CAddress> convertSeed6(const std::vector<SeedSpec6> &vSeedsIn)\n+//! Convert the serialized seeds into usable address objects.\n+static std::vector<CAddress> convertSeeds(const std::vector<uint8_t> &vSeedsIn)\n {\n     // It'll only connect to one or two seed nodes because once it connects,\n     // it'll get a pile of addresses with newer timestamps.\n     // Seed nodes are given a random 'last seen time' of between one and two\n     // weeks ago.\n     const int64_t nOneWeek = 7*24*60*60;\n     std::vector<CAddress> vSeedsOut;\n-    vSeedsOut.reserve(vSeedsIn.size());\n     FastRandomContext rng;\n-    for (const auto& seed_in : vSeedsIn) {\n-        struct in6_addr ip;\n-        memcpy(&ip, seed_in.addr, sizeof(ip));\n-        CAddress addr(CService(ip, seed_in.port), GetDesirableServiceFlags(NODE_NONE));\n+    CDataStream s(vSeedsIn, SER_NETWORK, PROTOCOL_VERSION | ADDRV2_FORMAT);\n+    while (!s.eof()) {\n+        CService endpoint;\n+        s >> endpoint;\n+        CAddress addr(endpoint, GetDesirableServiceFlags(NODE_NONE));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#discussion_r607054108",
      "id" : 607054108,
      "in_reply_to_id" : 606381809,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNzA1NDEwOA==",
      "original_commit_id" : "a9ee5683ce4013904f6e53f29e37632969926b0d",
      "original_line" : 158,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 627800148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21560",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-05T12:03:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/607054108",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Squashed all the squashme's into the appropriate commits [a9ee5683ce4013904f6e53f29e37632969926b0d..b2ee8b207de78f03356905bd60b7b00b6f49c252](https://github.com/bitcoin/bitcoin/compare/a9ee5683ce4013904f6e53f29e37632969926b0d..b2ee8b207de78f03356905bd60b7b00b6f49c252)\r\n\r\nThe only overall differences are @jonatack's latest comments.",
      "created_at" : "2021-04-05T12:08:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-813362000",
      "id" : 813362000,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMzM2MjAwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-05T12:08:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813362000",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK b2ee8b207de78f03356905bd60b7b00b6f49c252 \r\n\r\nTested hitting `ConvertSeeds()` on mainnet and testnet.\r\n",
      "created_at" : "2021-04-05T17:52:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21560#issuecomment-813535327",
      "id" : 813535327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21560",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMzUzNTMyNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-05T17:52:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813535327",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
