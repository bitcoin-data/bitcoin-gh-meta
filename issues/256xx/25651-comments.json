[
   {
      "author_association" : "MEMBER",
      "body" : "Some notes:\r\n\r\n* The whole file is in an unnamed namespace, so everything in it is already \"private\" for all other files.\r\n* I can't imagine code that instantiates this class in this file *and* calls methods on it, so I don't think `private`/`public` makes any difference in practise.\r\n* As no methods are called (and will ever be called directly), except the constructor, everything else could be `private` as well. Though, as this makes no difference in practise, I am not sure if this even makes sense conceptually.",
      "created_at" : "2022-07-20T16:52:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1190520843",
      "id" : 1190520843,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585G9egL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190520843/reactions"
      },
      "updated_at" : "2022-07-20T16:52:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190520843",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for having a look, Marco. It seems some of those things could change in the future, so this change looks preferable to me.\r\n\r\nIn addition to the motivations in the OP, having `m_node` next to the already private `ChainstateManager& chainman() { return *Assert(m_node.chainman); }` method seems easier to reason about. This is what made me look for `m_node` in the first place and wonder why it was placed there.",
      "created_at" : "2022-07-20T17:02:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1190530756",
      "id" : 1190530756,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585G9g7E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190530756/reactions"
      },
      "updated_at" : "2022-07-20T17:02:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190530756",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  It seems some of those things could change in the future\r\n\r\nI don't think any of the things could change in the future, unless I am missing something or you have examples where it would change.\r\n\r\nSo to me this mostly seems like a stylistic change, as I can't imagine a real-world example where this could make any difference.",
      "created_at" : "2022-07-20T17:12:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1190539888",
      "id" : 1190539888,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585G9jJw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190539888/reactions"
      },
      "updated_at" : "2022-07-20T17:12:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190539888",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I guess I have a mild preference for making everything public, but this change seems fine.\r\n\r\nBy design everything in ChainImpl NodeImpl WalletImpl has been public since the classes were written because the classes themselves are private. IMO it is only meaningful to distinguish between overridden and non-overridden members and private/public seems like noise in this context.\r\n\r\nWhatever style you land on though I do think would be good to consistently apply it to all the `*Impl` classes in `src/node/interfaces.cpp` and `src/wallet/interfaces.cpp`",
      "created_at" : "2022-07-20T17:41:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1190570030",
      "id" : 1190570030,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585G9qgu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190570030/reactions"
      },
      "updated_at" : "2022-07-20T17:41:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190570030",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks, I'm convinced. Nothing in `src/wallet/interfaces.cpp` is private. Making everything in `src/node/interfaces.cpp` public (and maybe documenting why) makes sense.  ",
      "created_at" : "2022-07-20T18:10:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1190597559",
      "id" : 1190597559,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585G9xO3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190597559/reactions"
      },
      "updated_at" : "2022-07-20T18:10:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190597559",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated per review feedback (thank you).",
      "created_at" : "2022-07-20T19:08:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1190650968",
      "id" : 1190650968,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585G9-RY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190650968/reactions"
      },
      "updated_at" : "2022-07-20T19:08:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1190650968",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a second commit removing unnecessary and verbose temporaries in `NodeImpl` and `ChainImpl` methods in `src/node/interfaces.cpp` to make the code easier to read and understand and avoid unnecessary move operations. Updated the pull title and description. Refactoring only, no change in behavior; should be easy to review.",
      "created_at" : "2022-07-27T13:42:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1196779882",
      "id" : 1196779882,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585HVWlq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1196779882/reactions"
      },
      "updated_at" : "2022-07-27T13:42:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1196779882",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25673](https://github.com/bitcoin/bitcoin/pull/25673) (refactor: make member functions const when applicable by aureleoules)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-07-27T22:16:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1197429821",
      "id" : 1197429821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585HX1Q9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1197429821/reactions"
      },
      "updated_at" : "2022-07-27T22:16:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1197429821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25651#discussion_r932518567"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25651"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932518567"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: make all NodeImpl and ChainImpl members public\" (b9a715ea03506bc6aa647d3df1cd177221d30dd0)\r\n\r\nWould encourage putting class member variables all together and not interspersing them with methods. If I'm trying to understand what a class does and what its role is in the application, knowing what data it contains is maybe the single most important piece of information I could have, and it's harder to see if the data fields aren't declared in a single place.\r\n\r\n#21525 messed up the style a bit but the original style and style I'd recommend would be:\r\n\r\n```c++\r\nclass NodeImpl : public Node\r\n{\r\npublic:\r\n  // ... virtual methods first ...\r\n  // ... nonvirtual helper methods next ...\r\n  // ... data fields last ...\r\n};\r\n```",
      "commit_id" : "4bedfd702ad878645c51bea6ee8ce40d8c0bd3da",
      "created_at" : "2022-07-28T17:47:51Z",
      "diff_hunk" : "@@ -384,12 +383,13 @@ class NodeImpl : public Node\n                     /* verification progress is unused when a header was received */ 0);\n             }));\n     }\n+    NodeContext* m_context{nullptr};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#discussion_r932518567",
      "id" : 932518567,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5843lRqn",
      "original_commit_id" : "b9a715ea03506bc6aa647d3df1cd177221d30dd0",
      "original_line" : 386,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 1054522533,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25651",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932518567/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T17:47:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932518567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25651#discussion_r932522595"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25651"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932522595"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: remove unneeded temporaries in node/interfaces, simplify code\" (d742ebbc91e5ca40389a3923bffba3e24911cc6f)\r\n\r\nNice simplification!",
      "commit_id" : "d742ebbc91e5ca40389a3923bffba3e24911cc6f",
      "created_at" : "2022-07-28T17:52:51Z",
      "diff_hunk" : "@@ -505,34 +500,24 @@ class ChainImpl : public Chain\n     explicit ChainImpl(NodeContext& node) : m_node(node) {}\n     std::optional<int> getHeight() override\n     {\n-        LOCK(::cs_main);\n-        const CChain& active = chainman().ActiveChain();\n-        int height = active.Height();\n-        if (height >= 0) {\n-            return height;\n-        }\n-        return std::nullopt;\n+        const int height{WITH_LOCK(::cs_main, return chainman().ActiveChain().Height())};\n+        return height >= 0 ? std::optional{height} : std::nullopt;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#discussion_r932522595",
      "id" : 932522595,
      "line" : 504,
      "node_id" : "PRRC_kwDOABII5843lSpj",
      "original_commit_id" : "d742ebbc91e5ca40389a3923bffba3e24911cc6f",
      "original_line" : 504,
      "original_position" : 26,
      "original_start_line" : 503,
      "path" : "src/node/interfaces.cpp",
      "position" : 26,
      "pull_request_review_id" : 1054522533,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25651",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932522595/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 503,
      "start_side" : "RIGHT",
      "updated_at" : "2022-07-28T17:55:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932522595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25651#discussion_r933478958"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25651"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/933478958"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done, and it's a smaller diff too. Thanks for clarifying!",
      "commit_id" : "4bedfd702ad878645c51bea6ee8ce40d8c0bd3da",
      "created_at" : "2022-07-29T17:25:31Z",
      "diff_hunk" : "@@ -384,12 +383,13 @@ class NodeImpl : public Node\n                     /* verification progress is unused when a header was received */ 0);\n             }));\n     }\n+    NodeContext* m_context{nullptr};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#discussion_r933478958",
      "id" : 933478958,
      "in_reply_to_id" : 932518567,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5843o8Iu",
      "original_commit_id" : "b9a715ea03506bc6aa647d3df1cd177221d30dd0",
      "original_line" : 386,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : null,
      "pull_request_review_id" : 1055866187,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25651",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/933478958/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-29T17:25:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/933478958",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated the first commit with @ryanofsky's suggestion (thanks!) and the second commit with a simplification.\r\n\r\n<details><summary><code>git diff d742ebb 4bedfd7</code></summary><p>\r\n\r\n```diff\r\ndiff --git a/src/node/interfaces.cpp b/src/node/interfaces.cpp\r\nindex bd819cf53e..699dca0a73 100644\r\n--- a/src/node/interfaces.cpp\r\n+++ b/src/node/interfaces.cpp\r\n@@ -73,9 +73,9 @@ namespace {\r\n class ExternalSignerImpl : public interfaces::ExternalSigner\r\n {\r\n public:\r\n-    ::ExternalSigner m_signer;\r\n     ExternalSignerImpl(::ExternalSigner signer) : m_signer(std::move(signer)) {}\r\n     std::string getName() override { return m_signer.m_name; }\r\n+    ::ExternalSigner m_signer;\r\n };\r\n #endif\r\n \r\n@@ -378,13 +378,13 @@ public:\r\n                     /* verification progress is unused when a header was received */ 0);\r\n             }));\r\n     }\r\n-    NodeContext* m_context{nullptr};\r\n     NodeContext* context() override { return m_context; }\r\n     void setContext(NodeContext* context) override\r\n     {\r\n         m_context = context;\r\n     }\r\n     ChainstateManager& chainman() { return *Assert(m_context->chainman); }\r\n+    NodeContext* m_context{nullptr};\r\n };\r\n \r\n bool FillBlock(const CBlockIndex* index, const FoundBlock& block, UniqueLock<RecursiveMutex>& lock, const CChain& active)\r\n@@ -702,10 +702,7 @@ public:\r\n     }\r\n     void waitForNotificationsIfTipChanged(const uint256& old_tip) override\r\n     {\r\n-        if (!old_tip.IsNull()) {\r\n-            LOCK(::cs_main);\r\n-            if (old_tip == chainman().ActiveChain().Tip()->GetBlockHash()) return;\r\n-        }\r\n+        if (!old_tip.IsNull() && old_tip == WITH_LOCK(::cs_main, return chainman().ActiveChain().Tip()->GetBlockHash())) return;\r\n         SyncWithValidationInterfaceQueue();\r\n     }\r\n     std::unique_ptr<Handler> handleRpc(const CRPCCommand& command) override\r\n@@ -760,9 +757,9 @@ public:\r\n         return chainman().IsSnapshotActive();\r\n     }\r\n \r\n-    NodeContext& m_node;\r\n     NodeContext* context() override { return &m_node; }\r\n     ChainstateManager& chainman() { return *Assert(m_node.chainman); }\r\n+    NodeContext& m_node;\r\n };\r\n```\r\n</p></details>\r\n",
      "created_at" : "2022-07-29T17:47:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25651#issuecomment-1199798663",
      "id" : 1199798663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25651",
      "node_id" : "IC_kwDOABII585Hg3mH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1199798663/reactions"
      },
      "updated_at" : "2022-07-29T17:47:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1199798663",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
