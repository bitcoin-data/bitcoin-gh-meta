{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "The per-connection transient address feature in 24.0.1 is, we are pretty sure, putting a large load on the I2P network. Starting on Dec. 19 the number of tunnels in the network started to increase, and as measured at one router, it peaked at about 3x normal levels on Dec. 26. While the load is manageable for now, if the transient feature becomes popular, it has the potential to get much much worse.\r\n\r\nI2P isn't really designed to work that way, and some limit on the number of addresses (aka destinations or tunnels) built by the bitcoin client is necessary. I2P Destinations are designed to be long-lived, it's not like in Tor where you can create tons of circuits. Waiting for tunnels to be built for each connection also adds a huge amount of delay to connection setup time. \r\n\r\nA high number of addresses will also result in excessive CPU and bandwidth usage by your router to build the tunnels for each.\r\nAdditionally, other routers will reject your excessive tunnel building, which will increase your resource usage even more as your router retries. And, of course, the overhead applies to every connection attempt, not just every successful connection.\r\n\r\nDepending on your security goals, and the max number of i2p connections you wish to support, there's a few options for you to consider:\r\n\r\n- Use a single transient address, created at startup\r\n- Hard limit the number of i2p connections if configured for transient\r\n- Group several connections into one of several addresses in a pool\r\n- Rate limit new connections or creation of new addresses\r\n\r\nThe i2pd router does not currently limit the number of local destinations, I don't think.\r\nThe Java router limits to 100 by default and will reject addresses over that limit.\r\n\r\nIf you do choose to continue using multiple addresses, we recommend a reasonable maximum number of addresses of around 16 or so, together with a rate limit on how frequently you create new ones.\r\n\r\n\r\nUnfortunately I did not realize this was happening when I reviewed your transient changes, but your 24.0.1 release notes confirm it.\r\nWe ask that you please fix and include this in your next point release.\r\n\r\nIn the meantime, please update your i2p doc to discourage the transient option.\r\nAlso in that doc, in the bandwidth section at the bottom, please encourage people to share as much bandwidth and transittunnels as they can, to increase their anonymity with the cover traffic, and so that bitcoin users contribute more to the i2p network than they consume.\r\n\r\nIf a popular application uses more network resources than it contributes, it has the potential to take down the entire network.\r\n\r\nReference files:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/master/src/net.cpp#L499\r\nhttps://github.com/bitcoin/bitcoin/blob/master/doc/i2p.md\r\n\r\n\r\n\r\nThank you very much for considering this change.\r\n\r\nGraph of number of tunnels on a typical high-speed i2p router, Dec. 15-26:\r\n(edit, replaced link) https://i2pd.xyz/partTunnels-12days.png\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 4,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26754/comments",
   "created_at" : "2022-12-26T18:16:48Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26754/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/26754",
   "id" : 1511137380,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "description" : null,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26754/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII585aEiBk",
   "number" : 26754,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 5,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 5,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26754/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26754/timeline",
   "title" : "I2P: Limit transient addresses",
   "updated_at" : "2022-12-26T22:42:40Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26754",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/62618568?v=4",
      "events_url" : "https://api.github.com/users/zzzi2p/events{/privacy}",
      "followers_url" : "https://api.github.com/users/zzzi2p/followers",
      "following_url" : "https://api.github.com/users/zzzi2p/following{/other_user}",
      "gists_url" : "https://api.github.com/users/zzzi2p/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/zzzi2p",
      "id" : 62618568,
      "login" : "zzzi2p",
      "node_id" : "MDQ6VXNlcjYyNjE4NTY4",
      "organizations_url" : "https://api.github.com/users/zzzi2p/orgs",
      "received_events_url" : "https://api.github.com/users/zzzi2p/received_events",
      "repos_url" : "https://api.github.com/users/zzzi2p/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/zzzi2p/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/zzzi2p/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/zzzi2p"
   }
}
