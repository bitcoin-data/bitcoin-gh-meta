{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "In #22558 @sipa [suggested](https://github.com/bitcoin/bitcoin/pull/22558#issuecomment-1058426300) some possible changes to [BIP 371](https://github.com/bitcoin/bips/blob/master/bip-0371.mediawiki).\r\n\r\n> Thinking about later integration with MuSig(2), I think it's somewhat unfortunate that the currently suggested PSBT_IN_TAP_BIP32_DERIVATION field conveys both (a) which keys are participating in which leaves and (b) how those are derived. Post-MuSig2, I expect that often keys will be present that aren't directly BIP32-derived, but are a MuSig* aggregate of BIP32-derived keys. It's not impossible to integrate that on top here, but it'd involve some duplication.\r\n> \r\n> My suggestion would be to have these fields:\r\n> \r\n> PSBT_IN_TAP_KEY_SIG: unmodified\r\n> PSBT_IN_TAP_SCRIPT_SIG: unmodified\r\n> PSBT_IN_TAP_LEAF_SCRIPT: unmodified\r\n> PSBT_IN_TAP_KEY_TWEAK: concatenation of PSBT_IN_TAP_INTERNAL_KEY and PSBT_IN_TAP_MERKLE_ROOT; it conveys \"the output key is a tweak of this key with this Merkle root\".\r\n> PSBT_IN_TAP_KEY_IN_SCRIPT: like PSBT_IN_TAP_BIP32_DERIVATION now, but without the BIP32 path; it just conveys \"this key occurs in these leaves\".\r\n> PSBT_IN_TAP_BIP32_DERIVATION: like PSBT_IN_TAP_BIP32_DERIVATION, but without the list of leaf hashes. It can be used for (a) the output key directly (b) the internal key (provided in PSBT_IN_TAP_KEY_TWEAK) of (c) a key occurring in a leaf script (provided by PSBT_IN_TAP_KEY_IN_SCRIPT).\r\n> I'm also happy to take this to the ML if you think this deserves more discussion.\r\n\r\nIt was noted that BIP 371 is already in use in production by Ledger but the only Taproot field Ledger currently relies on is PSBT_IN_TAP_BIP32_DERIVATION. @bigspider added:\r\n\r\n> Leaving the 0x00 would not break anything as I understand it.\r\n> If desired in order to have a clean standard, I suppose we can have a reasonable upgrade path by letting the next version of the app to skip the 0x00 if present and keeping this loose check for some time.\r\n\r\nAnd @sanket1729:\r\n\r\n> I was thinking most keys would be BIP32 derived keys of a Musig2 aggregate like musig2(A,B,C)/* or BIP32 derived keys of a Musig2 aggregate of BIP32-derived keys, like musig2(A/*, B/*, C/*)/*? The case you mention seems like musgi2(A/*, B/*, C/*)\r\n",
   "closed_at" : "2022-03-11T19:29:58Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
      "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
      "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
      "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
      "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/michaelfolkson",
      "id" : 16323900,
      "login" : "michaelfolkson",
      "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
      "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
      "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
      "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/michaelfolkson"
   },
   "comments" : 5,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24492/comments",
   "created_at" : "2022-03-07T12:42:21Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24492/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/24492",
   "id" : 1161370284,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24492/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII585FORqs",
   "number" : 24492,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24492/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24492/timeline",
   "title" : "Possible modifications to BIP 371",
   "updated_at" : "2022-03-11T19:29:59Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24492",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
      "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
      "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
      "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
      "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/michaelfolkson",
      "id" : 16323900,
      "login" : "michaelfolkson",
      "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
      "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
      "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
      "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/michaelfolkson"
   }
}
