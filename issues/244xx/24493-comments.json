[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This seems ok, but on first impression I don't like this. There are so many other functions and path methods that return `std::filesystem::path` types instead of `fs::path` types that it's seems inconsistent and pointless to just override this single function.\r\n\r\nI think people are getting lost in the sauce over these locale conversion issues. The point of introducing the `fs::path` class in #22937 was to fix real bugs. Not imaginary bugs, not possible bugs, but _actual, real_ bugs and changes in behavior that would on running bitcoin core software on windows with i18n paths and code pages due to the fact that boost provided a `boost::filesystem::path::imbue` function, and `std::filesystem::path` has no equivalent.\r\n\r\nThe point of adding the `fs::path` class in #22937 was _not_ to make it impossible to write crazy things like `\"tests_â¿_ð\"` or do intentionally bad locale conversions. If that is your goal, there is a better way of achieving it: stop making `fs::path` inherit from `std::filesystem::path`, and instead let it contain a private `std::filesystem::path` member, and whitelist all the methods our application code calls on this class instead of taking the #22937 blacklist approach.\r\n\r\nI didn't do this in #22937 because it would have made the PR substantially bigger. I still don't think it worth doing now because I think the practical benefit is basically 0. But I wouldn't object if someone wants to take that more principled approach.\r\n\r\nI think this PR and the comments about adding u8path conversions around every ASCII string https://github.com/bitcoin/bitcoin/pull/24469#pullrequestreview-900999083 and https://github.com/bitcoin/bitcoin/pull/24469#pullrequestreview-901089587 are overzealous. I think #24469 is a good PR because it fixes a theoretically real test bug. I think #24470 is a questionable PR for the same reason this PR is questionable. But I think it it better motivated, because it is preventing implicit std::string -> path decodings and we know these can be dangerous. I think this PR is less useful because it is not directly preventing any decodings, but just trying to replace `std::filesystem::path` temporaries with `fs::path` temporaries, which was never a goal of #22937, and which this PR doesn't actually come close to accomplishing.",
      "created_at" : "2022-03-07T17:15:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24493#issuecomment-1060926539",
      "id" : 1060926539,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24493",
      "node_id" : "IC_kwDOABII584_PHRL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060926539/reactions"
      },
      "updated_at" : "2022-03-07T17:15:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060926539",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, closing.\r\n\r\nThis patch will also be required as part of #24169, so I will just leave it there.",
      "created_at" : "2022-03-07T17:23:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24493#issuecomment-1060935048",
      "id" : 1060935048,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24493",
      "node_id" : "IC_kwDOABII584_PJWI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060935048/reactions"
      },
      "updated_at" : "2022-03-07T17:23:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060935048",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Fair enough. I can only imagine the extra levels of bug prevention c++20 constexpr and concept features will allow. If anybody even *thinks* about introducing a path encoding bug, c++20 can trigger a compile error in their brain",
      "created_at" : "2022-03-07T19:01:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24493#issuecomment-1061025277",
      "id" : 1061025277,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24493",
      "node_id" : "IC_kwDOABII584_PfX9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1061025277/reactions"
      },
      "updated_at" : "2022-03-07T19:01:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1061025277",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The thing with the current \"mixed wrapper approach\" as opposed to a \"full wrapper approach\" is that changing one line of code may result in compile errors in another part of the code. Beside the \"theoretical\" one mentioned in this pull, there is already at least one in our codebase, which was fixed with a c-style-cast to fs::path https://github.com/bitcoin/bitcoin/pull/24201/files#diff-a86c3e4f3b8f46384cbbbc5104be50f5637a030ffeb52a83bd207abeb0e72fabR200 . It wonder how long it will take until one of those bites us into the foot.",
      "created_at" : "2022-03-16T14:26:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24493#issuecomment-1069188761",
      "id" : 1069188761,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24493",
      "node_id" : "IC_kwDOABII584_uoaZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069188761/reactions"
      },
      "updated_at" : "2022-03-16T14:26:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069188761",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
