[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "cc @AnthonyRonning @prakash1512 @sipa @practicalswift",
      "created_at" : "2022-03-04T04:33:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#issuecomment-1058818572",
      "id" : 1058818572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24472",
      "node_id" : "IC_kwDOABII584_HEoM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058818572/reactions"
      },
      "updated_at" : "2022-03-04T04:33:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1058818572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2022-03-07T10:48:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#issuecomment-1060493834",
      "id" : 1060493834,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24472",
      "node_id" : "IC_kwDOABII584_NdoK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060493834/reactions"
      },
      "updated_at" : "2022-03-07T10:48:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1060493834",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "ACK. \r\n\r\nLooks good to me, sorry for dropping that originally. Ran through some of the same tests I was doing before, all working as expected. \r\n\r\nExample of that:\r\n\r\n```\r\nFUZZ=process_messages src/test/fuzz/fuzz ../qa-assets/fuzz_seed_corpus/process_messages/\r\nprocess_messages: succeeded against 14024 files in 153s.\r\n\r\n\r\nFUZZ=process_messages src/test/fuzz/fuzz ../qa-assets/fuzz_seed_corpus/process_messages/11265df2b1a0c93629515a880a2a851d6ceb133c\r\nprocess_messages: succeeded against 1 files in 0s.\r\n\r\nfor a in ../qa-assets/fuzz_seed_corpus/*; do echo ${a##*/}; done | xargs -P8 -I {} /bin/sh -c \"FUZZ={} src/test/fuzz/fuzz ../qa-assets/fuzz_seed_corpus/{}\"\r\naddition_overflow: succeeded against 1047 files in 0s.\r\naddress_deserialize_v1_withtime: succeeded against 420 files in 0s.\r\naddress_deserialize_v1_notime: succeeded against 400 files in 0s.\r\naddr_info_deserialize: succeeded against 1232 files in 1s.\r\naddress_deserialize_v2: succeeded against 949 files in 1s.\r\n...\r\n```",
      "created_at" : "2022-03-09T05:06:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#issuecomment-1062558443",
      "id" : 1062558443,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24472",
      "node_id" : "IC_kwDOABII584_VVrr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1062558443/reactions"
      },
      "updated_at" : "2022-03-09T05:06:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1062558443",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10763569?v=4",
         "events_url" : "https://api.github.com/users/AnthonyRonning/events{/privacy}",
         "followers_url" : "https://api.github.com/users/AnthonyRonning/followers",
         "following_url" : "https://api.github.com/users/AnthonyRonning/following{/other_user}",
         "gists_url" : "https://api.github.com/users/AnthonyRonning/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/AnthonyRonning",
         "id" : 10763569,
         "login" : "AnthonyRonning",
         "node_id" : "MDQ6VXNlcjEwNzYzNTY5",
         "organizations_url" : "https://api.github.com/users/AnthonyRonning/orgs",
         "received_events_url" : "https://api.github.com/users/AnthonyRonning/received_events",
         "repos_url" : "https://api.github.com/users/AnthonyRonning/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/AnthonyRonning/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/AnthonyRonning/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/AnthonyRonning"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828278866"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828278866"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit:\r\n\r\n```suggestion\r\nstatic std::string_view g_fuzz_target;\r\n```",
      "commit_id" : "f59bee3fb242c9e02781a35272cf9644f37e7fc1",
      "created_at" : "2022-03-16T17:32:09Z",
      "diff_hunk" : "@@ -59,6 +61,7 @@ void FuzzFrameworkRegisterTarget(std::string_view name, TypeTestOneInput target,\n     Assert(it_ins.second);\n }\n \n+std::string_view g_fuzz_target;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828278866",
      "id" : 828278866,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xXohS",
      "original_commit_id" : "80dd3013e06b2e5ad9c926aac88f0015d1a8cc02",
      "original_line" : 64,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : null,
      "pull_request_review_id" : 912027388,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828278866/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T17:51:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828278866",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828281867"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828281867"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit:\r\n\r\n```suggestion\r\n        std::exit(EXIT_FAILURE);\r\n```\r\n\r\nhttps://en.cppreference.com/w/cpp/utility/program/EXIT_status\r\nhttps://en.cppreference.com/w/cpp/utility/program/exit",
      "commit_id" : "f59bee3fb242c9e02781a35272cf9644f37e7fc1",
      "created_at" : "2022-03-16T17:35:34Z",
      "diff_hunk" : "@@ -92,9 +95,12 @@ void initialize()\n         should_abort = true;\n     }\n     Assert(!should_abort);\n-    std::string_view fuzz_target{Assert(std::getenv(\"FUZZ\"))};\n-    const auto it = FuzzTargets().find(fuzz_target);\n-    Assert(it != FuzzTargets().end());\n+    g_fuzz_target = Assert(std::getenv(\"FUZZ\"));\n+    const auto it = FuzzTargets().find(g_fuzz_target);\n+    if (it == FuzzTargets().end()) {\n+        std::cerr << \"No fuzzer for \" << g_fuzz_target << \".\" << std::endl;\n+        exit(1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828281867",
      "id" : 828281867,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xXpQL",
      "original_commit_id" : "80dd3013e06b2e5ad9c926aac88f0015d1a8cc02",
      "original_line" : 102,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : null,
      "pull_request_review_id" : 912027388,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828281867/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T17:51:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828281867",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828292263"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828292263"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Will have to call `std::signal`, if the signal calls `std::_Exit`, otherwise it might be UB?",
      "commit_id" : "f59bee3fb242c9e02781a35272cf9644f37e7fc1",
      "created_at" : "2022-03-16T17:48:00Z",
      "diff_hunk" : "@@ -151,10 +186,37 @@ int main(int argc, char** argv)\n     }\n #else\n     std::vector<uint8_t> buffer;\n-    if (!read_stdin(buffer)) {\n+    if (argc <= 1) {\n+        if (!read_stdin(buffer)) {\n+            return 0;\n+        }\n+        test_one_input(buffer);\n         return 0;\n     }\n-    test_one_input(buffer);\n+    signal(SIGABRT, signal_handler);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828292263",
      "id" : 828292263,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xXryn",
      "original_commit_id" : "80dd3013e06b2e5ad9c926aac88f0015d1a8cc02",
      "original_line" : 196,
      "original_position" : 89,
      "original_start_line" : null,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : null,
      "pull_request_review_id" : 912027388,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828292263/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T17:51:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828292263",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828292859"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828292859"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Unclear if this stl call is allowed? Might be UB, but I guess it doesn't matter either way?",
      "commit_id" : "f59bee3fb242c9e02781a35272cf9644f37e7fc1",
      "created_at" : "2022-03-16T17:48:42Z",
      "diff_hunk" : "@@ -112,6 +118,35 @@ static bool read_stdin(std::vector<uint8_t>& data)\n }\n #endif\n \n+#if defined(PROVIDE_FUZZ_MAIN_FUNCTION) && !defined(__AFL_LOOP)\n+static bool read_file(fs::path p, std::vector<uint8_t>& data)\n+{\n+    uint8_t buffer[1024];\n+    FILE* f = fsbridge::fopen(p, \"rb\");\n+    if (f == nullptr) return false;\n+    do {\n+        const size_t length = fread(buffer, sizeof(uint8_t), sizeof(buffer), f);\n+        if (ferror(f)) return false;\n+        data.insert(data.end(), buffer, buffer + length);\n+    } while (!feof(f));\n+    fclose(f);\n+    return true;\n+}\n+#endif\n+\n+#if defined(PROVIDE_FUZZ_MAIN_FUNCTION) && !defined(__AFL_LOOP)\n+fs::path g_seed_path;\n+void signal_handler(int signal)\n+{\n+    if (signal == SIGABRT) {\n+        std::cerr << \"Error processing seed \" << g_seed_path << std::endl;\n+    } else {\n+        std::cerr << \"Unexpected signal \" << signal << \" received\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828292859",
      "id" : 828292859,
      "line" : 144,
      "node_id" : "PRRC_kwDOABII584xXr77",
      "original_commit_id" : "80dd3013e06b2e5ad9c926aac88f0015d1a8cc02",
      "original_line" : 144,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : 61,
      "pull_request_review_id" : 912027388,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828292859/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T17:51:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828292859",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828293541"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828293541"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: I think when simply iterating over inputs, they are not called seeds?\r\n\r\n```suggestion\r\n        std::cerr << \"Error processing input \" << g_input_path << std::endl;\r\n```",
      "commit_id" : "f59bee3fb242c9e02781a35272cf9644f37e7fc1",
      "created_at" : "2022-03-16T17:49:31Z",
      "diff_hunk" : "@@ -112,6 +118,35 @@ static bool read_stdin(std::vector<uint8_t>& data)\n }\n #endif\n \n+#if defined(PROVIDE_FUZZ_MAIN_FUNCTION) && !defined(__AFL_LOOP)\n+static bool read_file(fs::path p, std::vector<uint8_t>& data)\n+{\n+    uint8_t buffer[1024];\n+    FILE* f = fsbridge::fopen(p, \"rb\");\n+    if (f == nullptr) return false;\n+    do {\n+        const size_t length = fread(buffer, sizeof(uint8_t), sizeof(buffer), f);\n+        if (ferror(f)) return false;\n+        data.insert(data.end(), buffer, buffer + length);\n+    } while (!feof(f));\n+    fclose(f);\n+    return true;\n+}\n+#endif\n+\n+#if defined(PROVIDE_FUZZ_MAIN_FUNCTION) && !defined(__AFL_LOOP)\n+fs::path g_seed_path;\n+void signal_handler(int signal)\n+{\n+    if (signal == SIGABRT) {\n+        std::cerr << \"Error processing seed \" << g_seed_path << std::endl;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828293541",
      "id" : 828293541,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xXsGl",
      "original_commit_id" : "80dd3013e06b2e5ad9c926aac88f0015d1a8cc02",
      "original_line" : 142,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : null,
      "pull_request_review_id" : 912027388,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828293541/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T17:51:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828293541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828299518"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828299518"
         }
      },
      "author_association" : "MEMBER",
      "body" : "( https://github.com/google/fuzzing/blob/master/docs/glossary.md#test-input )",
      "commit_id" : "f59bee3fb242c9e02781a35272cf9644f37e7fc1",
      "created_at" : "2022-03-16T17:56:53Z",
      "diff_hunk" : "@@ -112,6 +118,35 @@ static bool read_stdin(std::vector<uint8_t>& data)\n }\n #endif\n \n+#if defined(PROVIDE_FUZZ_MAIN_FUNCTION) && !defined(__AFL_LOOP)\n+static bool read_file(fs::path p, std::vector<uint8_t>& data)\n+{\n+    uint8_t buffer[1024];\n+    FILE* f = fsbridge::fopen(p, \"rb\");\n+    if (f == nullptr) return false;\n+    do {\n+        const size_t length = fread(buffer, sizeof(uint8_t), sizeof(buffer), f);\n+        if (ferror(f)) return false;\n+        data.insert(data.end(), buffer, buffer + length);\n+    } while (!feof(f));\n+    fclose(f);\n+    return true;\n+}\n+#endif\n+\n+#if defined(PROVIDE_FUZZ_MAIN_FUNCTION) && !defined(__AFL_LOOP)\n+fs::path g_seed_path;\n+void signal_handler(int signal)\n+{\n+    if (signal == SIGABRT) {\n+        std::cerr << \"Error processing seed \" << g_seed_path << std::endl;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828299518",
      "id" : 828299518,
      "in_reply_to_id" : 828293541,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584xXtj-",
      "original_commit_id" : "80dd3013e06b2e5ad9c926aac88f0015d1a8cc02",
      "original_line" : 142,
      "original_position" : 65,
      "original_start_line" : null,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : null,
      "pull_request_review_id" : 912055532,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828299518/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T17:56:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828299518",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828454165"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828454165"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It matches the code in https://en.cppreference.com/w/cpp/utility/program/abort so should be mostly okay hopefully?\r\n\r\nI suppose in theory you could setup worker threads, and have a monitor thread watch for them aborting -- then you could do multiple inputs in parallel, and report on multiple failures rather than exiting after the first one.",
      "commit_id" : "f59bee3fb242c9e02781a35272cf9644f37e7fc1",
      "created_at" : "2022-03-16T21:12:34Z",
      "diff_hunk" : "@@ -112,6 +118,35 @@ static bool read_stdin(std::vector<uint8_t>& data)\n }\n #endif\n \n+#if defined(PROVIDE_FUZZ_MAIN_FUNCTION) && !defined(__AFL_LOOP)\n+static bool read_file(fs::path p, std::vector<uint8_t>& data)\n+{\n+    uint8_t buffer[1024];\n+    FILE* f = fsbridge::fopen(p, \"rb\");\n+    if (f == nullptr) return false;\n+    do {\n+        const size_t length = fread(buffer, sizeof(uint8_t), sizeof(buffer), f);\n+        if (ferror(f)) return false;\n+        data.insert(data.end(), buffer, buffer + length);\n+    } while (!feof(f));\n+    fclose(f);\n+    return true;\n+}\n+#endif\n+\n+#if defined(PROVIDE_FUZZ_MAIN_FUNCTION) && !defined(__AFL_LOOP)\n+fs::path g_seed_path;\n+void signal_handler(int signal)\n+{\n+    if (signal == SIGABRT) {\n+        std::cerr << \"Error processing seed \" << g_seed_path << std::endl;\n+    } else {\n+        std::cerr << \"Unexpected signal \" << signal << \" received\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#discussion_r828454165",
      "id" : 828454165,
      "in_reply_to_id" : 828292859,
      "line" : 144,
      "node_id" : "PRRC_kwDOABII584xYTUV",
      "original_commit_id" : "80dd3013e06b2e5ad9c926aac88f0015d1a8cc02",
      "original_line" : 144,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : 61,
      "pull_request_review_id" : 912277699,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24472",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828454165/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-03-16T21:12:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828454165",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Renamed seed to input, added static/std, switched from signal.h to csignal header.",
      "created_at" : "2022-03-16T21:30:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24472#issuecomment-1069655391",
      "id" : 1069655391,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24472",
      "node_id" : "IC_kwDOABII584_waVf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069655391/reactions"
      },
      "updated_at" : "2022-03-16T21:30:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069655391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
