[
   {
      "body" : "ut ACK on this part, but please consider that as long as CKey is used in the interface(ish) class, it's still dependent on app-state and cannot be used for libs. Any suggestions there?",
      "created_at" : "2014-11-12T00:05:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-62645119",
      "id" : 62645119,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-12T00:05:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62645119",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Not verified move-only yet, btw.",
      "created_at" : "2014-11-12T00:06:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-62645221",
      "id" : 62645221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-12T00:06:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62645221",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni what do you mean by \"app state\"?",
      "created_at" : "2014-11-12T12:06:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-62708716",
      "id" : 62708716,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-12T12:06:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62708716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "utACK, verified move-only. This is an improvement regardless of what we do with #5208 and @theuni's suggestions.",
      "created_at" : "2014-11-12T12:45:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-62712718",
      "id" : 62712718,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-12T12:45:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62712718",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Thanks for the acks, I don't think this really needs any testing at all besides compiling.\r\nAs for using Ckey in the abstract class, @theuni, I don't really have any suggestions but I would like to understand the problem better. Can you elaborate a little bit on that?\r\nIs it the problem that key depends on allocators.h (and thus boost/thread/mutex.hpp and boost/thread/once.hpp? \r\nIf so, the only thing that comes to mind is creating yet another interface that CKey implements (inherits from).\r\nWould that solve the concerns?\r\n",
      "created_at" : "2014-11-15T13:59:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63173211",
      "id" : 63173211,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-15T13:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63173211",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Sorry for the delay. As @sipa mentioned on the other PR, by \"app state\", I mean that the allocators pull in the global singleton which is fine for bitcoind and friends, but I'd very much like to avoid that for libs.\r\n\r\nYea, a base class beneath CKey would solve the problem I should think. Imo, it'd be nice to have it somewhat storage-agnostic, so that a lib could potentially pass in its own backing store. Ultimately the key would have to be accessed (obviously), but we could at least limit how much it's passed around so that the caller could retain as much control over the sensitive bits as possible.\r\n\r\nRunning with that idea a bit, would it be feasible for CKey to retain only a pointer, and we pass in a pointer from our securely-allocated buffer which is held elsewhere?",
      "created_at" : "2014-11-17T18:11:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63348208",
      "id" : 63348208,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-17T18:11:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63348208",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Sounds all good, but out of scope here :)",
      "created_at" : "2014-11-17T18:28:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63350818",
      "id" : 63350818,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-17T18:28:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63350818",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Sure, I've ACK'd this change, I only mentioned the app state in case there was a chance of solving both issues at once here. Looks like there's not, so I have no problem with doing that later.",
      "created_at" : "2014-11-17T18:35:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63351888",
      "id" : 63351888,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-17T18:35:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63351888",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r20455602"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20455602"
         }
      },
      "body" : "Nit: Should be BITCOIN_BASIC_KEYSTORE_H, if you want to use the new naming that was recently introduced in all other headers (not by me ^^).",
      "commit_id" : "6192efb02b4af73912bf6b7eaf50677a53a14ae2",
      "created_at" : "2014-11-17T18:57:19Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef H_BASIC_BITCOIN_KEYSTORE",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r20455602",
      "id" : 20455602,
      "original_commit_id" : "70536c3092dc2dcb5238f7d410217162d8e3da9f",
      "original_position" : 6,
      "path" : "src/basic_keystore.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251",
      "updated_at" : "2014-12-27T18:17:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20455602",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r20469490"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20469490"
         }
      },
      "body" : "When was that introduced? I've seen many other files with the H at the beginning instead of the end, which I find much more convenient when creating new files (just copy from an old file, and replace the end). ",
      "commit_id" : "6192efb02b4af73912bf6b7eaf50677a53a14ae2",
      "created_at" : "2014-11-17T22:11:36Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef H_BASIC_BITCOIN_KEYSTORE",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r20469490",
      "id" : 20469490,
      "original_commit_id" : "70536c3092dc2dcb5238f7d410217162d8e3da9f",
      "original_position" : 6,
      "path" : "src/basic_keystore.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251",
      "updated_at" : "2014-12-27T18:17:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20469490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "@sipa @theuni Yes, solving that belongs to another PR but there's no harm starting to discussing it here.\r\nI'm not sure I fully understand the solution with the pointer.",
      "created_at" : "2014-11-17T22:14:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63386270",
      "id" : 63386270,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-17T22:14:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63386270",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r20477204"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20477204"
         }
      },
      "body" : "@jtimon In #5196",
      "commit_id" : "6192efb02b4af73912bf6b7eaf50677a53a14ae2",
      "created_at" : "2014-11-18T00:21:16Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef H_BASIC_BITCOIN_KEYSTORE",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r20477204",
      "id" : 20477204,
      "original_commit_id" : "70536c3092dc2dcb5238f7d410217162d8e3da9f",
      "original_position" : 6,
      "path" : "src/basic_keystore.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251",
      "updated_at" : "2014-12-27T18:17:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20477204",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=3",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "body" : "@jtimon  I think it's basically:\r\n\r\n- Remove CPrivKey from key.h\r\n- Remove LockObject/UnlockObject from key.h/cpp\r\n- Teach CKey Load()/GetPrivKey()/etc to use pointers rather than CPrivKey\r\n- Teach CKey to use a passed-in buffer rather than its internal vch[32]\r\n\r\nAt that point it's up to the caller (app-level) to lock the data before sending it into CKey and to maintain its backing store. I'm sure all of that could be organized somehow into something that doesn't involve actually messing with pointers all over the place.\r\n\r\nI do think we should probably discuss this elsewhere though, I don't want to slow down this PR for something unrelated. I'll see if I can throw together a quick (ugly) POC as a starting point.",
      "created_at" : "2014-11-18T01:17:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63407206",
      "id" : 63407206,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-18T01:17:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63407206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni @jtimon here is an alternative: https://github.com/sipa/bitcoin/commits/keynoalloc\r\n\r\nI'm not entirely happy with it, and I'm not sure how much it solves, but it sounds like what you were aiming to do?",
      "created_at" : "2014-11-19T10:06:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63616815",
      "id" : 63616815,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-19T10:06:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63616815",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa After discussing on IRC, yes, very much so. Most of what remains will be worked out by #5227. Thanks!",
      "created_at" : "2014-11-20T03:58:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63757968",
      "id" : 63757968,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-20T03:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63757968",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Fixed @Diapolo 's nit.",
      "created_at" : "2014-11-20T12:48:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-63802800",
      "id" : 63802800,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-11-20T12:48:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63802800",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Needed rebase.\r\nSquashed nit commit.",
      "created_at" : "2014-12-27T18:17:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-68185875",
      "id" : 68185875,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2014-12-27T18:17:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68185875",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r23233094"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23233094"
         }
      },
      "body" : "If the new keystore is meant to be a simple private key store for e.g. raw transaction API usage, then do `*WatchOnly` methods still belong on it?",
      "commit_id" : "6192efb02b4af73912bf6b7eaf50677a53a14ae2",
      "created_at" : "2015-01-20T16:17:46Z",
      "diff_hunk" : "@@ -19,21 +15,28 @@ class CScriptID;\n /** A virtual base class for key stores */\n class CKeyStore\n {\n-protected:\n-    mutable CCriticalSection cs_KeyStore;\n-\n public:\n     virtual ~CKeyStore() {}\n \n     //! Add a key to the store.\n     virtual bool AddKeyPubKey(const CKey &key, const CPubKey &pubkey) =0;\n-    virtual bool AddKey(const CKey &key);\n+    bool AddKey(const CKey &key) \n+    {\n+        return AddKeyPubKey(key, key.GetPubKey());\n+    }\n \n     //! Check whether a key corresponding to a given address is present in the store.\n     virtual bool HaveKey(const CKeyID &address) const =0;\n     virtual bool GetKey(const CKeyID &address, CKey& keyOut) const =0;\n     virtual void GetKeys(std::set<CKeyID> &setAddress) const =0;\n-    virtual bool GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const;\n+    bool GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n+    {\n+        CKey key;\n+        if (!GetKey(address, key))\n+            return false;\n+        vchPubKeyOut = key.GetPubKey();\n+        return true;\n+    }\n \n     //! Support for BIP 0013 : see https://github.com/bitcoin/bips/blob/master/bip-0013.mediawiki\n     virtual bool AddCScript(const CScript& redeemScript) =0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r23233094",
      "id" : 23233094,
      "original_commit_id" : "6192efb02b4af73912bf6b7eaf50677a53a14ae2",
      "original_position" : 44,
      "path" : "src/keystore.h",
      "position" : 44,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251",
      "updated_at" : "2015-01-20T16:17:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23233094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r24058275"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24058275"
         }
      },
      "body" : "Sorry for not answering earlier. If you comment those methods you'll get this errors:\r\n```\r\nwallet_ismine.cpp: In function Ã¢ÂÂisminetype IsMine(const CKeyStore&, const CScript&)Ã¢ÂÂ:\r\nwallet_ismine.cpp:42:22: error: Ã¢ÂÂconst class CKeyStoreÃ¢ÂÂ has no member named Ã¢ÂÂHaveWatchOnlyÃ¢ÂÂ\r\n         if (keystore.HaveWatchOnly(scriptPubKey))\r\n                      ^\r\nwallet_ismine.cpp:88:18: error: Ã¢ÂÂconst class CKeyStoreÃ¢ÂÂ has no member named Ã¢ÂÂHaveWatchOnlyÃ¢ÂÂ\r\n     if (keystore.HaveWatchOnly(scriptPubKey))\r\n```\r\nThe other 3 methods can be safely removed from the interface.\r\nI mean, it's not unsolvable but I wanted to keep this simple...",
      "commit_id" : "6192efb02b4af73912bf6b7eaf50677a53a14ae2",
      "created_at" : "2015-02-04T02:11:03Z",
      "diff_hunk" : "@@ -19,21 +15,28 @@ class CScriptID;\n /** A virtual base class for key stores */\n class CKeyStore\n {\n-protected:\n-    mutable CCriticalSection cs_KeyStore;\n-\n public:\n     virtual ~CKeyStore() {}\n \n     //! Add a key to the store.\n     virtual bool AddKeyPubKey(const CKey &key, const CPubKey &pubkey) =0;\n-    virtual bool AddKey(const CKey &key);\n+    bool AddKey(const CKey &key) \n+    {\n+        return AddKeyPubKey(key, key.GetPubKey());\n+    }\n \n     //! Check whether a key corresponding to a given address is present in the store.\n     virtual bool HaveKey(const CKeyID &address) const =0;\n     virtual bool GetKey(const CKeyID &address, CKey& keyOut) const =0;\n     virtual void GetKeys(std::set<CKeyID> &setAddress) const =0;\n-    virtual bool GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const;\n+    bool GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n+    {\n+        CKey key;\n+        if (!GetKey(address, key))\n+            return false;\n+        vchPubKeyOut = key.GetPubKey();\n+        return true;\n+    }\n \n     //! Support for BIP 0013 : see https://github.com/bitcoin/bips/blob/master/bip-0013.mediawiki\n     virtual bool AddCScript(const CScript& redeemScript) =0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#discussion_r24058275",
      "id" : 24058275,
      "original_commit_id" : "6192efb02b4af73912bf6b7eaf50677a53a14ae2",
      "original_position" : 44,
      "path" : "src/keystore.h",
      "position" : 44,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5251",
      "updated_at" : "2015-02-04T02:11:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24058275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Needs rebase but @theuni was working on a better alternative. Should I rebase it or not?",
      "created_at" : "2015-03-26T16:29:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-86605182",
      "id" : 86605182,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2015-03-26T16:29:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/86605182",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "I have something but I'm not sure if it's worth using. I'm away until\nMonday so don't hold on me if this blocks further work.\n",
      "created_at" : "2015-03-27T11:21:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-86905603",
      "id" : 86905603,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2015-03-27T11:21:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/86905603",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "I think CBasicKeyStore can actually just go in script/sign; it's basically the interface that users of script/sign need to implement to enable arbitrary-key signing.",
      "created_at" : "2015-03-27T18:15:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-87038519",
      "id" : 87038519,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2015-03-27T18:15:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/87038519",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa that makes sense to me. Anyway, it already needs rebase and I would probably close this in favor of @theuni 's improved proposal once it's ready, so I'm closing for now.",
      "created_at" : "2015-04-08T23:57:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5251#issuecomment-91071675",
      "id" : 91071675,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5251",
      "updated_at" : "2015-04-08T23:57:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/91071675",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   }
]
