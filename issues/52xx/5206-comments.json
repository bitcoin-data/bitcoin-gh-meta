[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5206#discussion_r20050280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5206"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20050280"
         }
      },
      "body" : "By initializing this last gcc complains about initialization out of order (yes, that is an actual warning...), I'd prefer we not add new warning messages.",
      "commit_id" : "81b99ba5f6edd27a9a0e66494ab7a08b9bc015d4",
      "created_at" : "2014-11-08T06:58:25Z",
      "diff_hunk" : "@@ -633,7 +633,10 @@ void CTxMemPool::ClearPrioritisation(const uint256 hash)\n }\n \n \n-CCoinsViewMemPool::CCoinsViewMemPool(CCoinsView *baseIn, CTxMemPool &mempoolIn) : CCoinsViewBacked(baseIn), mempool(mempoolIn) { }\n+CCoinsViewMemPool::CCoinsViewMemPool(CCoinsView *baseIn, CTxMemPool &mempoolIn)\n+    : CCoinsViewBacked(baseIn),\n+      mempool(mempoolIn),\n+      criticalBlock(mempoolIn.cs, \"CCoinsViewMemPool_lock\", __FILE__, __LINE__) {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#discussion_r20050280",
      "id" : 20050280,
      "original_commit_id" : "377f674491230b5bce8308fde6189f7439866921",
      "original_position" : 8,
      "path" : "src/txmempool.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5206",
      "updated_at" : "2014-11-08T13:51:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20050280",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Aside from gcc warnings, tested ACK only commithash 377f674491230b5bce8308fde6189f7439866921: http://bitcoin.ninja/TheBlueMatt-5206.txt",
      "created_at" : "2014-11-08T19:30:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-62273660",
      "id" : 62273660,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-11-08T19:30:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62273660",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2014-11-17T16:19:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-63329674",
      "id" : 63329674,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-11-17T16:19:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63329674",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Some further optimizations may be possible later, as AcceptToMemoryPool may need less code now to detect missing inputs; unsure.",
      "created_at" : "2014-11-18T13:59:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-63474275",
      "id" : 63474275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-11-18T13:59:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63474275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "You can at least remove the block at https://github.com/bitcoin/bitcoin/blob/master/src/main.cpp#L925",
      "created_at" : "2014-11-21T22:14:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-64046550",
      "id" : 64046550,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-11-21T22:14:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64046550",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Alternatively, have a LOCK_INIT(cs) macro that does initialize the cs variable, but does not declare it, and use that in the mempool constructor.",
      "created_at" : "2014-11-23T11:37:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-64114966",
      "id" : 64114966,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-11-23T11:37:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64114966",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "`CCoinsViewMemPool::GetCoins` is actually called multiple places in the code base, and this pull causes changes in behavior.  For instance, using the rpc signrawtransaction, it used to be possible to sign a double spend using a zero-conf transaction as input when the first spend was in the mempool, but now that is not possible.   For reference, it is still possible to sign a double spend with a confirmed transaction as input.",
      "created_at" : "2014-11-26T17:31:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-64681917",
      "id" : 64681917,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-11-26T17:31:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64681917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Not tested, but I think the pruning change breaks spending unconfirmed outputs because pruned ``CCoins`` wind up in the ``CCoinsViewCache`` in ``AcceptToMemoryPool``.\r\n\r\nWhen accepting the child, the call to ``view.HaveCoins(txin.prevout.hash))`` results in a call to ``CCoinsViewMemPool::GetCoins`` via ``CCoinsViewCache::FetchCoins``, and a pruned version of the unconfirmed parent is cached.\r\n\r\nThen, ``view.HaveInputs(tx)`` will see the coins as being already spent.",
      "created_at" : "2014-11-30T20:10:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-64998215",
      "id" : 64998215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-11-30T20:10:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64998215",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "@dgenr8 Are you sure about that? A pruned entry should still result in a true for HaveInputs as the unspent entry itself shouldnt be removed, and thats the only one HaveInputs cares about.",
      "created_at" : "2014-11-30T20:35:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-64999171",
      "id" : 64999171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-11-30T20:35:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64999171",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Ok, no pruning happens in ``view.HaveCoins(txin.prevout.hash))`` because the child is not yet accepted (duh).  If a conflicting child arrives later, it should correctly fail HaveInputs .  So it seems this may work as a way to detect intra-mempool conflicts (not all conflicts though).  This also explains @morcos finding above.\r\n\r\nWhat about @sipa comment at [line 649](https://github.com/bitcoin/bitcoin/blob/47cb3606a3c6496f80368b28d178e42c93271a54/src/txmempool.cpp#L649)?  For some reason he thought it was important not to return a pruned entry but the change explicitly does that.\r\n\r\n\r\n",
      "created_at" : "2014-12-01T15:45:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-65083217",
      "id" : 65083217,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-01T15:45:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65083217",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "> You can at least remove the block at https://github.com/bitcoin/bitcoin/blob/master/src/main.cpp#L925\r\n\r\n@TheBlueMatt Removing the check at [line 954](https://github.com/bitcoin/bitcoin/blob/master/src/main.cpp#L954) instead should be considered.  It literally says \"if tx is spendable, don't let it into the mempool!\" and only works as a duplicate check because 'spendable' has been defined locally to include the mempool.  The earlier check is more efficient (and more expressive IMHO).\r\n",
      "created_at" : "2014-12-01T16:11:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-65087834",
      "id" : 65087834,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-01T16:11:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65087834",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "@dgenr8 You misread the comment at line 649. The problem is that a pruned transaction may exist in pcoinsTip (perhaps because it used to be there and reorganized away), so if a transaction exists in the mempool, we have to return that one, even if a HaveCoins on the underlying cache may be true. The mempool consistency guarantees that in that case the underlying coin is fully spent anyway.",
      "created_at" : "2014-12-01T16:15:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-65088504",
      "id" : 65088504,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-01T16:15:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65088504",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "The check on line 954 (as @dgenr8 mentions) is actually worrysome. It is possible that HaveCoins returns true while there is actually no entry there (because it was reorganized away). This may possibly currently result in rejecting completely valid transactions.",
      "created_at" : "2014-12-01T16:18:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-65088986",
      "id" : 65088986,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-01T16:18:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65088986",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Just to add one more question about how this is all supposed to work.  It seems to me that if you see a double spend of a transaction that is already confirmed it will fail the HaveCoins check on its inputs in line 961 and therefore be treated as an orphan transaction.   Is that the desired behavior?  It doesn't seem like the HaveInputs check in line 969 gets used until we remove the explicit conflict check in #5347 (@dgenr8, this is what he meant by the block at line 925).       ",
      "created_at" : "2014-12-01T17:38:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-65102914",
      "id" : 65102914,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-01T17:38:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65102914",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "@morcos The risk currently already exists that a double-spending transaction is treated as an orphan. The correct solution for that is keeping track of recently-spent transactions, rather than relying on mempool/UTXOset logic to detect it. Unspent outputs are pretty much by definition a bad way to keep tracking of spent coins...",
      "created_at" : "2014-12-01T17:54:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-65105593",
      "id" : 65105593,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-01T17:54:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65105593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : ": ), oh yeah, guess that makes sense.",
      "created_at" : "2014-12-01T18:09:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-65107874",
      "id" : 65107874,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-01T18:09:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65107874",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "@apoelstra Can you move the pruneSpent call to also apply to transactions fetched from the underlying cache?",
      "created_at" : "2014-12-01T19:29:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-65120420",
      "id" : 65120420,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-01T19:36:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65120420",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa, @apoelstra already did in #5347.",
      "created_at" : "2014-12-21T02:50:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-67758234",
      "id" : 67758234,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2014-12-21T02:50:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/67758234",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Closing in favor of #5347",
      "created_at" : "2015-03-20T11:17:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5206#issuecomment-83988336",
      "id" : 83988336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5206",
      "updated_at" : "2015-03-20T11:17:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/83988336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
