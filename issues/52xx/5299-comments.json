[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm not clear on what problem is being described here.  How is connecting via addnode different?\n",
      "created_at" : "2015-04-01T10:23:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5299#issuecomment-88429353",
      "id" : 88429353,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5299",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4NDI5MzUz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88429353/reactions"
      },
      "updated_at" : "2015-04-01T10:23:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88429353",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Scenario 1:\n\nSet the appropriate \"addnode\" / \"connect\" args in bitcoin.conf for both nodes, pointing them at each other as described above. Fire them up. Observe the number of peers. Result incongruous (3).\n\nScenario 2:\n\nFire both nodes up, without setting the \"addnode\" / \"connect\" args in bitcoin.conf. Connect Node A to Node B, or vice versÄ, via the addnode CLI command. Observe the number of peers. Result as expected (1).\n",
      "created_at" : "2015-04-02T00:14:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5299#issuecomment-88672490",
      "id" : 88672490,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5299",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4NjcyNDkw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88672490/reactions"
      },
      "updated_at" : "2015-04-02T00:14:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88672490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=4",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "node_id" : "MDQ6VXNlcjEwMTM3",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks. How can there be a non-even number of connections with two nodes?  Can you give me the (anonymized) getpeerinfo from each?\n",
      "created_at" : "2015-04-02T02:27:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5299#issuecomment-88702468",
      "id" : 88702468,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5299",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4NzAyNDY4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88702468/reactions"
      },
      "updated_at" : "2015-04-02T02:27:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88702468",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "That is the question of course. Haven't stepped through GDB yet.\n\nSummary: Regtest. NODEB fired up first, NODEC follows. Common IP, separate ports (PORTB, PORTC). Connections 3 on both. If one experiments with the settings, and the startup sequenece, a wide range of peer counts is observed (1,2,3).\n\nRequested (pseudo-cleaned up & _running off of the latest master_ 4/1/2015, leaving the timestamps untouched) info:\nNODE B\nbitcoin.conf\n    addnode=IP1:PORTC\n    connect=IP1:PORTC\n\n$ ./bitcoin-cli getinfo\n{\n    \"version\" : 109900,\n    \"protocolversion\" : 70002,\n    \"walletversion\" : 60000,\n    \"balance\" : 1000.00000000,\n    \"blocks\" : 937,\n    \"timeoffset\" : 0,\n    \"connections\" : 3,\n    \"proxy\" : \"\",\n    \"difficulty\" : 0.00000000,\n    \"testnet\" : false,\n    \"keypoololdest\" : 1416286280,\n    \"keypoolsize\" : 101,\n    \"paytxfee\" : 0.00000000,\n    \"relayfee\" : 0.00001000,\n    \"errors\" : \"This is a pre-release test build - use at your own risk - do not use for mining or merchant applications\"\n}\n$ ./bitcoin-cli getpeerinfo\n[\n    {\n        \"id\" : 1,\n        \"addr\" : \"IP1:PORT1\",\n        \"services\" : \"0000000000000001\",\n        \"lastsend\" : 1427943077,\n        \"lastrecv\" : 1427943077,\n        \"bytessent\" : 1022,\n        \"bytesrecv\" : 1046,\n        \"conntime\" : 1427943077,\n        \"timeoffset\" : 0,\n        \"pingtime\" : 0.05142700,\n        \"version\" : 70002,\n        \"subver\" : \"/Satoshi:0.10.99/\",\n        \"inbound\" : true,\n        \"startingheight\" : 937,\n        \"banscore\" : 0,\n        \"synced_headers\" : 937,\n        \"synced_blocks\" : 937,\n        \"inflight\" : [\n        ],\n        \"whitelisted\" : false\n    },\n    {\n        \"id\" : 2,\n        \"addr\" : \"IP1:PORT1+1\",\n        \"services\" : \"0000000000000001\",\n        \"lastsend\" : 1427943077,\n        \"lastrecv\" : 1427943077,\n        \"bytessent\" : 215,\n        \"bytesrecv\" : 239,\n        \"conntime\" : 1427943077,\n        \"timeoffset\" : 0,\n        \"pingtime\" : 0.05049700,\n        \"version\" : 70002,\n        \"subver\" : \"/Satoshi:0.10.99/\",\n        \"inbound\" : true,\n        \"startingheight\" : 937,\n        \"banscore\" : 0,\n        \"synced_headers\" : -1,\n        \"synced_blocks\" : -1,\n        \"inflight\" : [\n        ],\n        \"whitelisted\" : false\n    },\n    {\n        \"id\" : 3,\n        \"addr\" : \"IP1:PORTC\",\n        \"services\" : \"0000000000000001\",\n        \"lastsend\" : 1427943077,\n        \"lastrecv\" : 1427943077,\n        \"bytessent\" : 239,\n        \"bytesrecv\" : 215,\n        \"conntime\" : 1427943077,\n        \"timeoffset\" : 0,\n        \"pingtime\" : 0.05015800,\n        \"version\" : 70002,\n        \"subver\" : \"/Satoshi:0.10.99/\",\n        \"inbound\" : false,\n        \"startingheight\" : 937,\n        \"banscore\" : 0,\n        \"synced_headers\" : -1,\n        \"synced_blocks\" : -1,\n        \"inflight\" : [\n        ],\n        \"whitelisted\" : false\n    }\n]\n\n---\n\nNODE C\nbitcoin.conf:\n    addnode=IP1:PORTB\n    connect=IP1:PORTB\n\n$ ./bitcoin-cli getinfo\n{\n    \"version\" : 109900,\n    \"protocolversion\" : 70002,\n    \"walletversion\" : 60000,\n    \"balance\" : 2000.00000000,\n    \"blocks\" : 937,\n    \"timeoffset\" : 0,\n    \"connections\" : 3,\n    \"proxy\" : \"\",\n    \"difficulty\" : 0.00000000,\n    \"testnet\" : false,\n    \"keypoololdest\" : 1416201679,\n    \"keypoolsize\" : 101,\n    \"paytxfee\" : 0.00000000,\n    \"relayfee\" : 0.00001000,\n    \"errors\" : \"This is a pre-release test build - use at your own risk - do not use for mining or merchant applications\"\n}\n$ ./bitcoin-cli getpeerinfo\n[\n    {\n        \"id\" : 1,\n        \"addr\" : \"IP1:PORTB\",\n        \"services\" : \"0000000000000001\",\n        \"lastsend\" : 1427943077,\n        \"lastrecv\" : 1427943077,\n        \"bytessent\" : 1046,\n        \"bytesrecv\" : 1022,\n        \"conntime\" : 1427943077,\n        \"timeoffset\" : 0,\n        \"pingtime\" : 0.05212700,\n        \"version\" : 70002,\n        \"subver\" : \"/Satoshi:0.10.99/\",\n        \"inbound\" : false,\n        \"startingheight\" : 937,\n        \"banscore\" : 0,\n        \"synced_headers\" : 937,\n        \"synced_blocks\" : 937,\n        \"inflight\" : [\n        ],\n        \"whitelisted\" : false\n    },\n    {\n        \"id\" : 2,\n        \"addr\" : \"IP1:PORTB\",\n        \"services\" : \"0000000000000001\",\n        \"lastsend\" : 1427943077,\n        \"lastrecv\" : 1427943077,\n        \"bytessent\" : 239,\n        \"bytesrecv\" : 215,\n        \"conntime\" : 1427943077,\n        \"timeoffset\" : 0,\n        \"pingtime\" : 0.05145200,\n        \"version\" : 70002,\n        \"subver\" : \"/Satoshi:0.10.99/\",\n        \"inbound\" : false,\n        \"startingheight\" : 937,\n        \"banscore\" : 0,\n        \"synced_headers\" : -1,\n        \"synced_blocks\" : -1,\n        \"inflight\" : [\n        ],\n        \"whitelisted\" : false\n    },\n    {\n        \"id\" : 3,\n        \"addr\" : \"IP1:PORT2\",\n        \"services\" : \"0000000000000001\",\n        \"lastsend\" : 1427943077,\n        \"lastrecv\" : 1427943077,\n        \"bytessent\" : 215,\n        \"bytesrecv\" : 239,\n        \"conntime\" : 1427943077,\n        \"timeoffset\" : 0,\n        \"pingtime\" : 0.05165500,\n        \"version\" : 70002,\n        \"subver\" : \"/Satoshi:0.10.99/\",\n        \"inbound\" : true,\n        \"startingheight\" : 937,\n        \"banscore\" : 0,\n        \"synced_headers\" : -1,\n        \"synced_blocks\" : -1,\n        \"inflight\" : [\n        ],\n        \"whitelisted\" : false\n    }\n]\n",
      "created_at" : "2015-04-02T03:17:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5299#issuecomment-88712788",
      "id" : 88712788,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5299",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4NzEyNzg4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88712788/reactions"
      },
      "updated_at" : "2015-04-02T03:17:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88712788",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=4",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "node_id" : "MDQ6VXNlcjEwMTM3",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "The [initial reporting of this issue](https://github.com/bitcoin/bitcoin/issues/5299#issue-49187331) makes it seem like the use of `addnode` **or** `connect` as args in bitcoin.conf results to this behaviour. What's [shown later](https://github.com/bitcoin/bitcoin/issues/5299#issuecomment-88712788) is that this multiple-connections from/to the same peer behavior occurs when `addnode` **and** `connect` are used together in the configuration. \r\n\r\nI've tried different scenarios of options (combinations of `addnode`/`connect` in bitcoin.conf and connecting via the \"addnode\" RPC call) on regtest and I was **only** able to reproduce this behavior with 2 peers having their peer's address in both `addnode` and `connect`args. (on current master branch)\r\n\r\nThe observed behavior (using `getpeerinfo` RPC) is 3 connections on each node. The startup sequence defines the type of connections. The node that will start second will create 2 outbound connections to the first node. \r\n\r\nâ¤ How to reproduce with 2 peers on regtest:\r\n- Create directories and bitcoin.conf files\r\n  ```\r\n  mkdir -p /tmp/node1-datadir\r\n  mkdir -p /tmp/node2-datadir\r\n  ```\r\n  ```\r\n  # node1 bitcoin.conf\r\n  regtest=1\r\n  listen=1 # default is 0 when using `connect`\r\n  [regtest]\r\n  connect=127.0.0.1:18400\r\n  addnode=127.0.0.1:18400\r\n\r\n  # node2 bitcoin.conf\r\n  regtest=1\r\n  listen=1 \r\n  [regtest]\r\n  connect=127.0.0.1:18445\r\n  addnode=127.0.0.1:18445\r\n  ```\r\n- Start nodes\r\n  ```\r\n  # terminal1\r\n  src/bitcoind -datadir=/tmp/node1-datadir\r\n  \r\n  # terminal2 (non-default ports)\r\n  src/bitcoind -datadir=/tmp/node2-datadir -rpcport=18300 -port=18400\r\n  ```\r\n- Observe connections using bitcoin-cli. \r\n  <img width=\"421\" alt=\"tldr\" src=\"https://user-images.githubusercontent.com/18506343/181566063-bd91a527-e613-4455-8c34-46583c343129.png\">\r\n\r\n  ```\r\n  src/bitcoin-cli -datadir=/tmp/node1-datadir getpeerinfo\r\n  ```\r\n\r\n  <details><summary>command output (node1 peers)</summary>\r\n\r\n  ```\r\n  [\r\n    {\r\n      \"id\": 0,\r\n      \"addr\": \"127.0.0.1:50176\",\r\n      \"addrbind\": \"127.0.0.1:18445\",\r\n      \"network\": \"onion\",\r\n      \"services\": \"0000000000000409\",\r\n      \"servicesnames\": [\r\n        \"NETWORK\",\r\n        \"WITNESS\",\r\n        \"NETWORK_LIMITED\"\r\n      ],\r\n      \"lastsend\": 1659017341,\r\n      \"lastrecv\": 1659017341,\r\n      \"last_transaction\": 0,\r\n      \"last_block\": 0,\r\n      \"bytessent\": 470,\r\n      \"bytesrecv\": 494,\r\n      \"conntime\": 1659017341,\r\n      \"timeoffset\": 0,\r\n      \"pingtime\": 0.001835,\r\n      \"minping\": 0.001835,\r\n      \"version\": 70016,\r\n      \"subver\": \"/Satoshi:23.99.0/\",\r\n      \"inbound\": true,\r\n      \"bip152_hb_to\": false,\r\n      \"bip152_hb_from\": false,\r\n      \"startingheight\": 0,\r\n      \"synced_headers\": -1,\r\n      \"synced_blocks\": -1,\r\n      \"inflight\": [\r\n      ],\r\n      \"relaytxes\": true,\r\n      \"minfeefilter\": 0.09170997,\r\n      \"addr_relay_enabled\": true,\r\n      \"addr_processed\": 0,\r\n      \"addr_rate_limited\": 0,\r\n      \"permissions\": [\r\n      ],\r\n      \"bytessent_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"getheaders\": 93,\r\n        \"headers\": 25,\r\n        \"ping\": 32,\r\n        \"pong\": 32,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"bytesrecv_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"getaddr\": 24,\r\n        \"getheaders\": 93,\r\n        \"headers\": 25,\r\n        \"ping\": 32,\r\n        \"pong\": 32,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"connection_type\": \"inbound\"\r\n    },\r\n    {\r\n      \"id\": 1,\r\n      \"addr\": \"127.0.0.1:50177\",\r\n      \"addrbind\": \"127.0.0.1:18445\",\r\n      \"network\": \"onion\",\r\n      \"services\": \"0000000000000409\",\r\n      \"servicesnames\": [\r\n        \"NETWORK\",\r\n        \"WITNESS\",\r\n        \"NETWORK_LIMITED\"\r\n      ],\r\n      \"lastsend\": 1659017341,\r\n      \"lastrecv\": 1659017341,\r\n      \"last_transaction\": 0,\r\n      \"last_block\": 0,\r\n      \"bytessent\": 352,\r\n      \"bytesrecv\": 376,\r\n      \"conntime\": 1659017341,\r\n      \"timeoffset\": 0,\r\n      \"pingtime\": 0.000515,\r\n      \"minping\": 0.000515,\r\n      \"version\": 70016,\r\n      \"subver\": \"/Satoshi:23.99.0/\",\r\n      \"inbound\": true,\r\n      \"bip152_hb_to\": false,\r\n      \"bip152_hb_from\": false,\r\n      \"startingheight\": 0,\r\n      \"synced_headers\": -1,\r\n      \"synced_blocks\": -1,\r\n      \"inflight\": [\r\n      ],\r\n      \"relaytxes\": true,\r\n      \"minfeefilter\": 0.09170997,\r\n      \"addr_relay_enabled\": true,\r\n      \"addr_processed\": 0,\r\n      \"addr_rate_limited\": 0,\r\n      \"permissions\": [\r\n      ],\r\n      \"bytessent_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"ping\": 32,\r\n        \"pong\": 32,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"bytesrecv_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"getaddr\": 24,\r\n        \"ping\": 32,\r\n        \"pong\": 32,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"connection_type\": \"inbound\"\r\n    },\r\n    {\r\n      \"id\": 2,\r\n      \"addr\": \"127.0.0.1:18400\",\r\n      \"addrbind\": \"127.0.0.1:50182\",\r\n      \"network\": \"not_publicly_routable\",\r\n      \"services\": \"0000000000000409\",\r\n      \"servicesnames\": [\r\n        \"NETWORK\",\r\n        \"WITNESS\",\r\n        \"NETWORK_LIMITED\"\r\n      ],\r\n      \"lastsend\": 1659017346,\r\n      \"lastrecv\": 1659017346,\r\n      \"last_transaction\": 0,\r\n      \"last_block\": 0,\r\n      \"bytessent\": 376,\r\n      \"bytesrecv\": 352,\r\n      \"conntime\": 1659017346,\r\n      \"timeoffset\": 0,\r\n      \"pingtime\": 0.00078,\r\n      \"minping\": 0.00078,\r\n      \"version\": 70016,\r\n      \"subver\": \"/Satoshi:23.99.0/\",\r\n      \"inbound\": false,\r\n      \"bip152_hb_to\": false,\r\n      \"bip152_hb_from\": false,\r\n      \"startingheight\": 0,\r\n      \"synced_headers\": -1,\r\n      \"synced_blocks\": -1,\r\n      \"inflight\": [\r\n      ],\r\n      \"relaytxes\": true,\r\n      \"minfeefilter\": 0.09170997,\r\n      \"addr_relay_enabled\": true,\r\n      \"addr_processed\": 0,\r\n      \"addr_rate_limited\": 0,\r\n      \"permissions\": [\r\n      ],\r\n      \"bytessent_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"getaddr\": 24,\r\n        \"ping\": 32,\r\n        \"pong\": 32,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"bytesrecv_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"ping\": 32,\r\n        \"pong\": 32,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"connection_type\": \"manual\"\r\n    }\r\n  ]\r\n  ```\r\n  </details>\r\n\r\n  ```\r\n  src/bitcoin-cli -rpcport=18300 -datadir=/tmp/node2-datadir getpeerinfo\r\n  ```\r\n\r\n  <details><summary>command output (node2 peers)</summary>\r\n\r\n  ```\r\n  [\r\n    {\r\n      \"id\": 0,\r\n      \"addr\": \"127.0.0.1:18445\",\r\n      \"addrbind\": \"127.0.0.1:50176\",\r\n      \"network\": \"not_publicly_routable\",\r\n      \"services\": \"0000000000000409\",\r\n      \"servicesnames\": [\r\n        \"NETWORK\",\r\n        \"WITNESS\",\r\n        \"NETWORK_LIMITED\"\r\n      ],\r\n      \"lastsend\": 1659018421,\r\n      \"lastrecv\": 1659018421,\r\n      \"last_transaction\": 0,\r\n      \"last_block\": 0,\r\n      \"bytessent\": 1070,\r\n      \"bytesrecv\": 1046,\r\n      \"conntime\": 1659017341,\r\n      \"timeoffset\": 0,\r\n      \"pingtime\": 0.000634,\r\n      \"minping\": 0.000252,\r\n      \"version\": 70016,\r\n      \"subver\": \"/Satoshi:23.99.0/\",\r\n      \"inbound\": false,\r\n      \"bip152_hb_to\": false,\r\n      \"bip152_hb_from\": false,\r\n      \"startingheight\": 0,\r\n      \"synced_headers\": -1,\r\n      \"synced_blocks\": -1,\r\n      \"inflight\": [\r\n      ],\r\n      \"relaytxes\": true,\r\n      \"minfeefilter\": 0.09170997,\r\n      \"addr_relay_enabled\": true,\r\n      \"addr_processed\": 0,\r\n      \"addr_rate_limited\": 0,\r\n      \"permissions\": [\r\n      ],\r\n      \"bytessent_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"getaddr\": 24,\r\n        \"getheaders\": 93,\r\n        \"headers\": 25,\r\n        \"ping\": 320,\r\n        \"pong\": 320,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"bytesrecv_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"getheaders\": 93,\r\n        \"headers\": 25,\r\n        \"ping\": 320,\r\n        \"pong\": 320,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"connection_type\": \"manual\"\r\n    },\r\n    {\r\n      \"id\": 1,\r\n      \"addr\": \"127.0.0.1:18445\",\r\n      \"addrbind\": \"127.0.0.1:50177\",\r\n      \"network\": \"not_publicly_routable\",\r\n      \"services\": \"0000000000000409\",\r\n      \"servicesnames\": [\r\n        \"NETWORK\",\r\n        \"WITNESS\",\r\n        \"NETWORK_LIMITED\"\r\n      ],\r\n      \"lastsend\": 1659018421,\r\n      \"lastrecv\": 1659018421,\r\n      \"last_transaction\": 0,\r\n      \"last_block\": 0,\r\n      \"bytessent\": 952,\r\n      \"bytesrecv\": 928,\r\n      \"conntime\": 1659017341,\r\n      \"timeoffset\": 0,\r\n      \"pingtime\": 0.000401,\r\n      \"minping\": 0.000222,\r\n      \"version\": 70016,\r\n      \"subver\": \"/Satoshi:23.99.0/\",\r\n      \"inbound\": false,\r\n      \"bip152_hb_to\": false,\r\n      \"bip152_hb_from\": false,\r\n      \"startingheight\": 0,\r\n      \"synced_headers\": -1,\r\n      \"synced_blocks\": -1,\r\n      \"inflight\": [\r\n      ],\r\n      \"relaytxes\": true,\r\n      \"minfeefilter\": 0.09170997,\r\n      \"addr_relay_enabled\": true,\r\n      \"addr_processed\": 0,\r\n      \"addr_rate_limited\": 0,\r\n      \"permissions\": [\r\n      ],\r\n      \"bytessent_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"getaddr\": 24,\r\n        \"ping\": 320,\r\n        \"pong\": 320,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"bytesrecv_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"ping\": 320,\r\n        \"pong\": 320,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"connection_type\": \"manual\"\r\n    },\r\n    {\r\n      \"id\": 2,\r\n      \"addr\": \"127.0.0.1:50182\",\r\n      \"addrbind\": \"127.0.0.1:18400\",\r\n      \"network\": \"not_publicly_routable\",\r\n      \"services\": \"0000000000000409\",\r\n      \"servicesnames\": [\r\n        \"NETWORK\",\r\n        \"WITNESS\",\r\n        \"NETWORK_LIMITED\"\r\n      ],\r\n      \"lastsend\": 1659018427,\r\n      \"lastrecv\": 1659018427,\r\n      \"last_transaction\": 0,\r\n      \"last_block\": 0,\r\n      \"bytessent\": 928,\r\n      \"bytesrecv\": 952,\r\n      \"conntime\": 1659017346,\r\n      \"timeoffset\": 0,\r\n      \"pingtime\": 0.000166,\r\n      \"minping\": 0.000166,\r\n      \"version\": 70016,\r\n      \"subver\": \"/Satoshi:23.99.0/\",\r\n      \"inbound\": true,\r\n      \"bip152_hb_to\": false,\r\n      \"bip152_hb_from\": false,\r\n      \"startingheight\": 0,\r\n      \"synced_headers\": -1,\r\n      \"synced_blocks\": -1,\r\n      \"inflight\": [\r\n      ],\r\n      \"relaytxes\": true,\r\n      \"minfeefilter\": 0.09170997,\r\n      \"addr_relay_enabled\": true,\r\n      \"addr_processed\": 0,\r\n      \"addr_rate_limited\": 0,\r\n      \"permissions\": [\r\n      ],\r\n      \"bytessent_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"ping\": 320,\r\n        \"pong\": 320,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"bytesrecv_per_msg\": {\r\n        \"feefilter\": 32,\r\n        \"getaddr\": 24,\r\n        \"ping\": 320,\r\n        \"pong\": 320,\r\n        \"sendaddrv2\": 24,\r\n        \"sendcmpct\": 33,\r\n        \"sendheaders\": 24,\r\n        \"verack\": 24,\r\n        \"version\": 127,\r\n        \"wtxidrelay\": 24\r\n      },\r\n      \"connection_type\": \"inbound\"\r\n    }\r\n  ]\r\n  ```\r\n  </details>\r\n      \r\nI think that this mgiht be some kind of concurrency issue, as this is happening during startup initialization and a manual connection to the same peer is not allowed under any other circumstances.",
      "created_at" : "2022-07-28T15:10:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5299#issuecomment-1198288049",
      "id" : 1198288049,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5299",
      "node_id" : "IC_kwDOABII585HbGyx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198288049/reactions"
      },
      "updated_at" : "2022-07-28T15:10:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198288049",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18506343?v=4",
         "events_url" : "https://api.github.com/users/kouloumos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kouloumos/followers",
         "following_url" : "https://api.github.com/users/kouloumos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kouloumos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kouloumos",
         "id" : 18506343,
         "login" : "kouloumos",
         "node_id" : "MDQ6VXNlcjE4NTA2MzQz",
         "organizations_url" : "https://api.github.com/users/kouloumos/orgs",
         "received_events_url" : "https://api.github.com/users/kouloumos/received_events",
         "repos_url" : "https://api.github.com/users/kouloumos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kouloumos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kouloumos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kouloumos"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I wonder if it's being added twice here:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/c540f07ec3846b43f3af8a74820fd055ada5dfe5/src/net.cpp#L1876-L1902\r\n\r\nOnce via `m_added_nodes` and once from the existing (incoming) connection in `m_nodes`. This might cause `ThreadOpenAddedConnections()` to outbound connect to it twice?\r\n\r\nPosting here now so I (or someone else) can investigate later...",
      "created_at" : "2022-11-03T13:15:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5299#issuecomment-1302101298",
      "id" : 1302101298,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5299",
      "node_id" : "IC_kwDOABII585NnH0y",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302101298/reactions"
      },
      "updated_at" : "2022-11-03T13:15:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302101298",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   }
]
