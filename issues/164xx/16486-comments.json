[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r308353904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308353904"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style-nit:\r\n```suggestion\r\n    bool assume_valid = false;\r\n```",
      "commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "created_at" : "2019-07-29T17:43:38Z",
      "diff_hunk" : "@@ -1715,7 +1715,7 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n \n     nBlocksTotal++;\n \n-    bool fScriptChecks = true;\n+    bool fAssumeValid = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r308353904",
      "id" : 308353904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwODM1MzkwNA==",
      "original_commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "original_position" : 5,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 267936609,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486",
      "updated_at" : "2019-07-29T17:51:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308353904",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r308357588"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308357588"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If the assumevalid block (which is command-line specifiable) is not on the chain that builds off the BIP34Hash, then I think not enforcing BIP 30 would be a bug that could prevent us from reorging to the honest chain.  ",
      "commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "created_at" : "2019-07-29T17:51:45Z",
      "diff_hunk" : "@@ -1819,6 +1819,8 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(chainparams.GetConsensus().BIP34Height);\n     //Only continue to enforce if we're below BIP34 activation height or the block hash at that height doesn't correspond.\n     fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == chainparams.GetConsensus().BIP34Hash));\n+    // And we're not assuming the block is valid.\n+    fEnforceBIP30 = fEnforceBIP30 && !fAssumeValid;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r308357588",
      "id" : 308357588,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwODM1NzU4OA==",
      "original_commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "original_position" : 23,
      "path" : "src/validation.cpp",
      "position" : 23,
      "pull_request_review_id" : 267941030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486",
      "updated_at" : "2019-07-29T18:01:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308357588",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16658](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16658.html) ([WIP] validation: Rename CheckInputs to CheckInputScripts by jnewbery)\n* [#13868](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13868.html) (Remove unused fScriptChecks parameter from CheckInputs by Empact)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-07-29T21:30:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-516169991",
      "id" : 516169991,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjE2OTk5MQ==",
      "updated_at" : "2019-08-26T05:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516169991",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jamesob Could you run bitcoin perf over this PR?",
      "created_at" : "2019-07-30T03:53:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-516250057",
      "id" : 516250057,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjI1MDA1Nw==",
      "updated_at" : "2019-07-30T03:53:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516250057",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've done a single, simple (maybe too simple) benchmark of running `time src/bitcoind -stopatheight=227931` for master (33894612c0de953b75b41dbfcc643986e4ac177e) and this PR. Starting with an empty data dir on each run, except for a `bitcoin.conf` which contained `par=8` and `dbcache=2048`. Master took `16m27s` and this PR took `16m43s`.",
      "created_at" : "2019-07-30T06:22:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-516280898",
      "id" : 516280898,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjI4MDg5OA==",
      "updated_at" : "2019-07-30T06:22:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516280898",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "time ./src/bitcoind -reindex-chainstate -stopatheight=227931 -dbcache=1024\r\n\r\nthis pr: 3m25.503s\r\nmaster: 3m47.508s\r\n\r\nie 10% faster",
      "created_at" : "2019-07-30T17:47:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-516522713",
      "id" : 516522713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjUyMjcxMw==",
      "updated_at" : "2019-07-30T17:48:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516522713",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/620611?v=4",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "node_id" : "MDQ6VXNlcjYyMDYxMQ==",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r308903147"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308903147"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, but in the exact same way that an assumevalid chain with invalid scripts would cause that today.\r\n\r\nI don't see a incentives issue, as violating bip30 really only allows you to destroy coins.\r\n\r\nAm I missing something?",
      "commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "created_at" : "2019-07-30T19:33:06Z",
      "diff_hunk" : "@@ -1819,6 +1819,8 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(chainparams.GetConsensus().BIP34Height);\n     //Only continue to enforce if we're below BIP34 activation height or the block hash at that height doesn't correspond.\n     fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == chainparams.GetConsensus().BIP34Hash));\n+    // And we're not assuming the block is valid.\n+    fEnforceBIP30 = fEnforceBIP30 && !fAssumeValid;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r308903147",
      "id" : 308903147,
      "in_reply_to_id" : 308357588,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwODkwMzE0Nw==",
      "original_commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "original_position" : 23,
      "path" : "src/validation.cpp",
      "position" : 23,
      "pull_request_review_id" : 268619684,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486",
      "updated_at" : "2019-07-30T19:33:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308903147",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/620611?v=4",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "node_id" : "MDQ6VXNlcjYyMDYxMQ==",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r308920972"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308920972"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Currently, if a bad assumevalid hash was given, we could still reorg to the honest chain if it had more work and we found a peer advertising it. The way this code is written would preclude that if an assumevalid hash was given for a chain where bip 30 was violated, which can prevent us from correctly reorging.",
      "commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "created_at" : "2019-07-30T20:13:03Z",
      "diff_hunk" : "@@ -1819,6 +1819,8 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(chainparams.GetConsensus().BIP34Height);\n     //Only continue to enforce if we're below BIP34 activation height or the block hash at that height doesn't correspond.\n     fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == chainparams.GetConsensus().BIP34Hash));\n+    // And we're not assuming the block is valid.\n+    fEnforceBIP30 = fEnforceBIP30 && !fAssumeValid;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r308920972",
      "id" : 308920972,
      "in_reply_to_id" : 308357588,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwODkyMDk3Mg==",
      "original_commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "original_position" : 23,
      "path" : "src/validation.cpp",
      "position" : 23,
      "pull_request_review_id" : 268639818,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486",
      "updated_at" : "2019-07-30T20:13:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308920972",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Since that quantity (22 seconds) doesnât scale as the chain grows, this performance benefit doesnât seem worth it to me (even though I think this change could be made to be correct, this is complex enough that we should have a higher bar for making this kind of change).",
      "created_at" : "2019-07-30T20:14:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-516578196",
      "id" : 516578196,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjU3ODE5Ng==",
      "updated_at" : "2019-07-30T20:14:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516578196",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r309284185"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/309284185"
         }
      },
      "author_association" : "MEMBER",
      "body" : "From IRC:\r\n\r\n> [08:29] <sdaftuar> Anyway this would be a simple fix to your PR â just ensure that you only skip the bip30 checks if assume valid is set and the assume valid block hash builds on the known bip34 activation block hash; that would ensure that we only skip the bip30 checks on blocks we know to be safe from this issue\r\n",
      "commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "created_at" : "2019-07-31T15:24:36Z",
      "diff_hunk" : "@@ -1819,6 +1819,8 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(chainparams.GetConsensus().BIP34Height);\n     //Only continue to enforce if we're below BIP34 activation height or the block hash at that height doesn't correspond.\n     fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == chainparams.GetConsensus().BIP34Hash));\n+    // And we're not assuming the block is valid.\n+    fEnforceBIP30 = fEnforceBIP30 && !fAssumeValid;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#discussion_r309284185",
      "id" : 309284185,
      "in_reply_to_id" : 308357588,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwOTI4NDE4NQ==",
      "original_commit_id" : "071fd86f0a04d6ea3d260e732fd415da323017c5",
      "original_position" : 23,
      "path" : "src/validation.cpp",
      "position" : 23,
      "pull_request_review_id" : 269093726,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16486",
      "updated_at" : "2019-07-31T15:24:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/309284185",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Running `time ./src/bitcoind -reindex-chainstate -stopatheight=227931 -dbcache=1024` I do see the speedup:\r\n\r\nmaster e653eeff7651d823407e2e31a89176cc0b240c62: `6m8s`\r\nthis PR: `5m48s`",
      "created_at" : "2019-08-02T06:56:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-517579663",
      "id" : 517579663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNzU3OTY2Mw==",
      "updated_at" : "2019-08-02T06:56:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/517579663",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "-0 on this since it doesn't speed up the non-trivial parts of IBD and introduces more varied behavior to consensus-critical code. Benching the first 200k blocks is deceptive since that's such a small part of total IBD time. Benching a more meaningful part of the chain (almost by definition) shows no improvement:\r\n\r\n![ibd local range 500000 501500](https://user-images.githubusercontent.com/73197/62373852-a854b400-b508-11e9-9ae0-bf81ab33864f.png)\r\n",
      "created_at" : "2019-08-02T13:35:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-517703094",
      "id" : 517703094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNzcwMzA5NA==",
      "updated_at" : "2019-08-02T13:35:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/517703094",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think I'm in agreement with @sdaftuar and @jamesob, even though this may bring a slight speedup to a small portion of IBD.\r\n\r\n@laanwj Can you weigh in here?\r\n\r\n@sdaftuar \r\n> (even though I think this change could be made to be correct, this is complex enough that we should have a higher bar for making this kind of change).\r\n\r\nI'd be interested in hearing more of your thoughts on this. i.e what do you think that bar looks like? If this change was a 30% speedup would that be acceptable? 50%? Or would you only consider optimizations that would affect all of IBD etc.",
      "created_at" : "2019-08-05T05:25:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-518090519",
      "id" : 518090519,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxODA5MDUxOQ==",
      "updated_at" : "2019-08-05T05:25:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/518090519",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-09-02T09:48:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16486#issuecomment-527082733",
      "id" : 527082733,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16486",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyNzA4MjczMw==",
      "updated_at" : "2019-09-02T09:48:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/527082733",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
