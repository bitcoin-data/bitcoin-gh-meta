{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "**Is your feature request related to a problem? Please describe.**\r\n<!-- A clear and concise description of what the problem is. Ex. I'm always frustrated when [...] -->\r\nI want this to be VERY clear,  this is not from an experience of being hacked (well, yet anyway,  knock on wood).  This is completely theoretical based on my experience creating a webapp that interacts with bitcoind via RPC calls and thus it got me to thinking about how the hotwallet could be hacked,  how to prevent it,  etc.\r\n\r\nUnlocking the wallet for X amount of time is a MASSIVE security flaw imo.  Let's say you have 10 'withdraw' processes running and they all have to 'unlock' the wallet to processes their sends.  Thats fine if they finish quickly (this isnt always the case btw).  But what if you have 100s or 1000s or something just causes it to go slowly and you have to increase the unlock period for some reason?  Then what you've got is a wallet that is essentially in an \"unlocked\" stated almost constantly.  This is a really bad idea.  It would be better to ask for the pw on specific functions instead of a global scope.\r\n\r\nUse case:\r\nServer 1:  Apache webserver, maybe has other services on it like mysql, ssh, etc,  something that's vulnerable to be hacked\r\nServer 2: Hotwallet server, has absolutely nothing on it other than bitcoind in RPC mode,  it's buttoned down as much as possible short of actually unplugging it from the router.\r\n\r\nServer 1 has RPC creds on it so that some application (like a web app) can interact with a BTC wallet.  It does NOT have the BTC wallet encryption pw on it however.  So it's only means of sending out BTC or creating transactions is when Server 2 checks a queue that resides on server 1......... Months go by and one day the machine is HACKED.  The hacker then monitors the server and notices that they can make RPC calls to the wallet (oh crap).  But the wallet is encrypted so we're good right?!  HA.  WRONG.  They have access to the queue which seems to take a long time to empty.  Then they notice that the wallet is being unlocked consistently to empty the queue...... It this point it's game over for mr wallet.\r\n\r\nServer 2 \r\n**Describe the solution you'd like**\r\n<!-- A clear and concise description of what you want to happen. -->\r\nI'd like to see at minimum sendtoaddress, sendmany, sendrawtransaction, send, and createrawtransaction refuse to function if a pw on an encrypted wallet is detected.  Essentially anything that isnt a Read (except for something like dumping keys, obviously that should be as well).\r\n\r\n**Describe alternatives you've considered**\r\n<!-- A clear and concise description of any alternative solutions or features you've considered. -->\r\nThere are alternatives but I'm not interested in ANY of them as they are overly convoluted, difficult to setup, and just not a good user experience as a developer at all,  all the while solving no security problems at all,  at some point on some device (whether connected to other devices or not) that unlock period is going to come into play and when it does, this vulnerability rears it's head.  I realize I can setup a 'read only' wallet (and I have),  but had bitcoind not had this issue,  I would not have had to do this for my purposes.  I can see other use cases involving cell phones as well.\r\n\r\n**Additional context**\r\n<!-- Add any other context or screenshots about the feature request here. -->\r\n",
   "closed_at" : "2021-12-23T14:59:48Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
      "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
      "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/MarcoFalke",
      "id" : 6399679,
      "login" : "MarcoFalke",
      "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
      "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
      "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
      "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/MarcoFalke"
   },
   "comments" : 29,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23620/comments",
   "created_at" : "2021-11-28T21:36:36Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23620/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/23620",
   "id" : 1065443093,
   "labels" : [
      {
         "color" : "7cf575",
         "default" : false,
         "description" : null,
         "id" : 64583,
         "name" : "Feature",
         "node_id" : "MDU6TGFiZWw2NDU4Mw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23620/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII584_gV8V",
   "number" : 23620,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23620/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23620/timeline",
   "title" : "Password for encrypted wallets on all pw protected functions (such as sendtoaddress, dumpprivkey, etc)",
   "updated_at" : "2021-12-23T14:59:48Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23620",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/7891142?v=4",
      "events_url" : "https://api.github.com/users/Lancelight/events{/privacy}",
      "followers_url" : "https://api.github.com/users/Lancelight/followers",
      "following_url" : "https://api.github.com/users/Lancelight/following{/other_user}",
      "gists_url" : "https://api.github.com/users/Lancelight/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/Lancelight",
      "id" : 7891142,
      "login" : "Lancelight",
      "node_id" : "MDQ6VXNlcjc4OTExNDI=",
      "organizations_url" : "https://api.github.com/users/Lancelight/orgs",
      "received_events_url" : "https://api.github.com/users/Lancelight/received_events",
      "repos_url" : "https://api.github.com/users/Lancelight/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/Lancelight/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/Lancelight/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/Lancelight"
   }
}
