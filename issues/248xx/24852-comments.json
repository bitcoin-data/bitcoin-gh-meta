[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r850114267"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850114267"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason for not using the static constexpr array as removed below?\r\n```\r\n    static constexpr char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\r\n```\r\nIt clearly can be static, and that makes more sense than a string (which will be zero-terminated) to me.",
      "commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "created_at" : "2022-04-14T06:13:29Z",
      "diff_hunk" : "@@ -508,17 +509,36 @@ std::string Capitalize(std::string str)\n     return str;\n }\n \n+namespace {\n+\n+using ByteAsHex = std::array<char, 2>;\n+\n+constexpr std::array<ByteAsHex, 256> CreateByteToHexMap()\n+{\n+    std::array<ByteAsHex, 256> byte_to_hex{};\n+    for (size_t i = 0; i < byte_to_hex.size(); ++i) {\n+        char const* hex = \"0123456789abcdef\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r850114267",
      "id" : 850114267,
      "line" : 520,
      "node_id" : "PRRC_kwDOABII584yq7bb",
      "original_commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "original_line" : 520,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 20,
      "pull_request_review_id" : 941828180,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850114267/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-14T06:14:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850114267",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r850116277"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850116277"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Mind that we already have a test for HexStr in `src/test/util_tests.cpp`. Might want to remove that one, or at least move it into here.",
      "commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "created_at" : "2022-04-14T06:17:32Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <util/strencodings.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <array>\n+#include <string>\n+#include <string_view>\n+\n+BOOST_AUTO_TEST_SUITE(strencodings_tests)\n+\n+BOOST_AUTO_TEST_CASE(util_HexStr)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r850116277",
      "id" : 850116277,
      "line" : 16,
      "node_id" : "PRRC_kwDOABII584yq761",
      "original_commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "original_line" : 16,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/test/strencodings_tests.cpp",
      "position" : 16,
      "pull_request_review_id" : 941830901,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850116277/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-14T06:17:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850116277",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. This doesn't have the problems that #23364 has.",
      "created_at" : "2022-04-14T06:18:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#issuecomment-1098748906",
      "id" : 1098748906,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24852",
      "node_id" : "IC_kwDOABII585BfZPq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098748906/reactions"
      },
      "updated_at" : "2022-04-14T06:18:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098748906",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r850165219"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850165219"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Linter complains about trailing whitespace on this line",
      "commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "created_at" : "2022-04-14T07:34:04Z",
      "diff_hunk" : "@@ -137,6 +137,7 @@ BITCOIN_TESTS =\\\n   test/skiplist_tests.cpp \\\n   test/sock_tests.cpp \\\n   test/streams_tests.cpp \\\n+  test/strencodings_tests.cpp \\  ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r850165219",
      "id" : 850165219,
      "line" : 140,
      "node_id" : "PRRC_kwDOABII584yrH3j",
      "original_commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "original_line" : 140,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/Makefile.test.include",
      "position" : 4,
      "pull_request_review_id" : 941896216,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850165219/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-14T07:34:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850165219",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851207843"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851207843"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        const auto& h{byte_to_hex[v]};\r\n        it = std::copy(h.begin(),h.end(), it);\r\n```\r\n\r\nSide-note: Looks like it requires gcc-12 to get the same binary if this is written with `std::copy`.",
      "commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "created_at" : "2022-04-15T10:46:44Z",
      "diff_hunk" : "@@ -508,17 +509,36 @@ std::string Capitalize(std::string str)\n     return str;\n }\n \n+namespace {\n+\n+using ByteAsHex = std::array<char, 2>;\n+\n+constexpr std::array<ByteAsHex, 256> CreateByteToHexMap()\n+{\n+    std::array<ByteAsHex, 256> byte_to_hex{};\n+    for (size_t i = 0; i < byte_to_hex.size(); ++i) {\n+        char const* hex = \"0123456789abcdef\";\n+        byte_to_hex[i][0] = hex[i >> 4];\n+        byte_to_hex[i][1] = hex[i & 15];\n+    }\n+    return byte_to_hex;\n+}\n+\n+} // namespace\n+\n std::string HexStr(const Span<const uint8_t> s)\n {\n     std::string rv(s.size() * 2, '\\0');\n-    static constexpr char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n-                                         '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n-    auto it = rv.begin();\n+    static constexpr auto byte_to_hex = CreateByteToHexMap();\n+    static_assert(sizeof(byte_to_hex) == 512);\n+\n+    char* it = rv.data();\n     for (uint8_t v : s) {\n-        *it++ = hexmap[v >> 4];\n-        *it++ = hexmap[v & 15];\n+        std::memcpy(it, byte_to_hex[v].data(), 2);\n+        it += 2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851207843",
      "id" : 851207843,
      "line" : 538,
      "node_id" : "PRRC_kwDOABII584yvGaj",
      "original_commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "original_line" : 538,
      "original_position" : 43,
      "original_start_line" : 537,
      "path" : "src/util/strencodings.cpp",
      "position" : 43,
      "pull_request_review_id" : 943336579,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851207843/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 537,
      "start_side" : "RIGHT",
      "updated_at" : "2022-04-15T10:46:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851207843",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851747095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851747095"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It can't be `static` here because I'm using that function in a `constexpr` way. With `static constexpr char...` I get that error message:\r\n\r\n```\r\nutil/strencodings.cpp:520:31: error: static variable not permitted in a constexpr function\r\n        static constexpr char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\r\n                              ^\r\n```\r\n\r\nI can use `constexpr char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };` though. I just used a string though because it's less typing :slightly_smiling_face: ",
      "commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "created_at" : "2022-04-17T12:10:59Z",
      "diff_hunk" : "@@ -508,17 +509,36 @@ std::string Capitalize(std::string str)\n     return str;\n }\n \n+namespace {\n+\n+using ByteAsHex = std::array<char, 2>;\n+\n+constexpr std::array<ByteAsHex, 256> CreateByteToHexMap()\n+{\n+    std::array<ByteAsHex, 256> byte_to_hex{};\n+    for (size_t i = 0; i < byte_to_hex.size(); ++i) {\n+        char const* hex = \"0123456789abcdef\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851747095",
      "id" : 851747095,
      "in_reply_to_id" : 850114267,
      "line" : 520,
      "node_id" : "PRRC_kwDOABII584yxKEX",
      "original_commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "original_line" : 520,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 20,
      "pull_request_review_id" : 943941882,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851747095/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-17T12:11:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851747095",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851747172"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851747172"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ah, I didn't see that! I'll move the test over that checks each character and remove the rest",
      "commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "created_at" : "2022-04-17T12:11:42Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/util/setup_common.h>\n+#include <util/strencodings.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <array>\n+#include <string>\n+#include <string_view>\n+\n+BOOST_AUTO_TEST_SUITE(strencodings_tests)\n+\n+BOOST_AUTO_TEST_CASE(util_HexStr)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851747172",
      "id" : 851747172,
      "in_reply_to_id" : 850116277,
      "line" : 16,
      "node_id" : "PRRC_kwDOABII584yxKFk",
      "original_commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "original_line" : 16,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/test/strencodings_tests.cpp",
      "position" : 16,
      "pull_request_review_id" : 943941952,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851747172/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-17T12:11:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851747172",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851753345"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851753345"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Huh, TIL\r\n\r\n> I can use constexpr char hexmap[16] = { '0', '\r\n\r\nI prefer that, then. I mean it's not used as a C string so it shouldn't be a C string. The amount of typing shouldn't be a consideration :stuck_out_tongue:",
      "commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "created_at" : "2022-04-17T13:04:20Z",
      "diff_hunk" : "@@ -508,17 +509,36 @@ std::string Capitalize(std::string str)\n     return str;\n }\n \n+namespace {\n+\n+using ByteAsHex = std::array<char, 2>;\n+\n+constexpr std::array<ByteAsHex, 256> CreateByteToHexMap()\n+{\n+    std::array<ByteAsHex, 256> byte_to_hex{};\n+    for (size_t i = 0; i < byte_to_hex.size(); ++i) {\n+        char const* hex = \"0123456789abcdef\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851753345",
      "id" : 851753345,
      "in_reply_to_id" : 850114267,
      "line" : 520,
      "node_id" : "PRRC_kwDOABII584yxLmB",
      "original_commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "original_line" : 520,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/util/strencodings.cpp",
      "position" : 20,
      "pull_request_review_id" : 943946932,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851753345/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-17T13:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851753345",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851768843"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851768843"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I also find it interesting that clang unrolls the loop, but gcc doesn't. I tried to force unrollment with `#pragma GCC unroll 8` and that does the job, but still the code that comes out is not faster in my benchmark. \r\nhttps://godbolt.org/z/GEfYze9ob (I've replaced `Span` with `string_view` but it should be practically the same)",
      "commit_id" : "5e61532e72c1021fda9c7b213bd9cf397cb3a802",
      "created_at" : "2022-04-17T15:09:12Z",
      "diff_hunk" : "@@ -508,17 +509,36 @@ std::string Capitalize(std::string str)\n     return str;\n }\n \n+namespace {\n+\n+using ByteAsHex = std::array<char, 2>;\n+\n+constexpr std::array<ByteAsHex, 256> CreateByteToHexMap()\n+{\n+    std::array<ByteAsHex, 256> byte_to_hex{};\n+    for (size_t i = 0; i < byte_to_hex.size(); ++i) {\n+        char const* hex = \"0123456789abcdef\";\n+        byte_to_hex[i][0] = hex[i >> 4];\n+        byte_to_hex[i][1] = hex[i & 15];\n+    }\n+    return byte_to_hex;\n+}\n+\n+} // namespace\n+\n std::string HexStr(const Span<const uint8_t> s)\n {\n     std::string rv(s.size() * 2, '\\0');\n-    static constexpr char hexmap[16] = { '0', '1', '2', '3', '4', '5', '6', '7',\n-                                         '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };\n-    auto it = rv.begin();\n+    static constexpr auto byte_to_hex = CreateByteToHexMap();\n+    static_assert(sizeof(byte_to_hex) == 512);\n+\n+    char* it = rv.data();\n     for (uint8_t v : s) {\n-        *it++ = hexmap[v >> 4];\n-        *it++ = hexmap[v & 15];\n+        std::memcpy(it, byte_to_hex[v].data(), 2);\n+        it += 2;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r851768843",
      "id" : 851768843,
      "in_reply_to_id" : 851207843,
      "line" : 539,
      "node_id" : "PRRC_kwDOABII584yxPYL",
      "original_commit_id" : "4d7b193af5e06963bcdd6dd509a15aba236f0dd2",
      "original_line" : 539,
      "original_position" : 43,
      "original_start_line" : 537,
      "path" : "src/util/strencodings.cpp",
      "position" : 44,
      "pull_request_review_id" : 943959037,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851768843/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 538,
      "start_side" : "RIGHT",
      "updated_at" : "2022-04-17T15:09:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/851768843",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 5e61532e72c1021fda9c7b213bd9cf397cb3a802",
      "created_at" : "2022-04-18T13:38:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#issuecomment-1101416013",
      "id" : 1101416013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24852",
      "node_id" : "IC_kwDOABII585BpkZN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1101416013/reactions"
      },
      "updated_at" : "2022-04-18T13:38:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1101416013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r853400885"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853400885"
         }
      },
      "author_association" : "NONE",
      "body" : "```suggestion\r\n        for (size_t i = 0; i < 256; ++i) {\r\n```\r\nnit",
      "commit_id" : "5e61532e72c1021fda9c7b213bd9cf397cb3a802",
      "created_at" : "2022-04-19T19:09:02Z",
      "diff_hunk" : "@@ -198,6 +198,24 @@ BOOST_AUTO_TEST_CASE(util_HexStr)\n         BOOST_CHECK_EQUAL(HexStr(in_s), out_exp);\n         BOOST_CHECK_EQUAL(HexStr(in_b), out_exp);\n     }\n+\n+    {\n+        auto input = std::string();\n+        for (size_t i=0; i<256; ++i) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r853400885",
      "id" : 853400885,
      "line" : 204,
      "node_id" : "PRRC_kwDOABII584y3d01",
      "original_commit_id" : "5e61532e72c1021fda9c7b213bd9cf397cb3a802",
      "original_line" : 204,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 7,
      "pull_request_review_id" : 946174498,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853400885/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-19T19:32:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853400885",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r853401233"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853401233"
         }
      },
      "author_association" : "NONE",
      "body" : "```suggestion\r\n            BOOST_TEST_REQUIRE(i == upper * 16 + lower);\r\n```\r\nnit",
      "commit_id" : "5e61532e72c1021fda9c7b213bd9cf397cb3a802",
      "created_at" : "2022-04-19T19:09:21Z",
      "diff_hunk" : "@@ -198,6 +198,24 @@ BOOST_AUTO_TEST_CASE(util_HexStr)\n         BOOST_CHECK_EQUAL(HexStr(in_s), out_exp);\n         BOOST_CHECK_EQUAL(HexStr(in_b), out_exp);\n     }\n+\n+    {\n+        auto input = std::string();\n+        for (size_t i=0; i<256; ++i) {\n+            input.push_back(static_cast<char>(i));\n+        }\n+\n+        auto hex = HexStr(input);\n+        BOOST_TEST_REQUIRE(hex.size() == 512);\n+        static constexpr auto hexmap = std::string_view(\"0123456789abcdef\");\n+        for (size_t i = 0; i < 256; ++i) {\n+            auto upper = hexmap.find(hex[i * 2]);\n+            auto lower = hexmap.find(hex[i * 2 + 1]);\n+            BOOST_TEST_REQUIRE(upper != std::string_view::npos);\n+            BOOST_TEST_REQUIRE(lower != std::string_view::npos);\n+            BOOST_TEST_REQUIRE(i == upper*16 + lower);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24852#discussion_r853401233",
      "id" : 853401233,
      "line" : 216,
      "node_id" : "PRRC_kwDOABII584y3d6R",
      "original_commit_id" : "5e61532e72c1021fda9c7b213bd9cf397cb3a802",
      "original_line" : 216,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 19,
      "pull_request_review_id" : 946174498,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24852",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853401233/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-19T19:32:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853401233",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   }
]
