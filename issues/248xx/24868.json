{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "`RPCHelpMan setwalletflag()` returns a different structure in response according to the value of the flag. This causes an error since the structure is well defined in RPCResult.\r\nThis PR  changes the answer to use the same structure in both cases.\r\n\r\nIn master branch:\r\n```\r\n$ bitcoin-cli -regtest setwalletflag \"avoid_reuse\" true\r\n{\r\n  \"flag_name\": \"avoid_reuse\",\r\n  \"flag_state\": true,\r\n  \"warnings\": \"You need to rescan the blockchain in order to correctly mark used destinations in the past. Until this is done, some destinations may be considered unused, even if the opposite is the case.\"\r\n}\r\n\r\n$ bitcoin-cli -regtest setwalletflag \"avoid_reuse\" false\r\nerror code: -1\r\nerror message:\r\nInternal bug detected: 'std::any_of(m_results.m_results.begin(), m_results.m_results.end(), [ret](const RPCResult& res) { return res.MatchesType(ret); })'\r\nrpc/util.cpp:587 (HandleRequest)\r\nYou may report this issue here: https://github.com/bitcoin/bitcoin/issues\r\n```\r\nIn PR branch:\r\n```\r\n$ bitcoin-cli -regtest setwalletflag \"avoid_reuse\" true\r\n{\r\n  \"flag_name\": \"avoid_reuse\",\r\n  \"flag_state\": true,\r\n  \"warnings\": \"You need to rescan the blockchain in order to correctly mark used destinations in the past. Until this is done, some destinations may be considered unused, even if the opposite is the case.\"\r\n}\r\n\r\n$ bitcoin-cli -regtest setwalletflag \"avoid_reuse\" false\r\n{\r\n  \"flag_name\": \"avoid_reuse\",\r\n  \"flag_state\": false,\r\n  \"warnings\": \"\"\r\n}\r\n```\r\n",
   "closed_at" : "2022-04-16T07:15:25Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/94266259?v=4",
      "events_url" : "https://api.github.com/users/w0xlt/events{/privacy}",
      "followers_url" : "https://api.github.com/users/w0xlt/followers",
      "following_url" : "https://api.github.com/users/w0xlt/following{/other_user}",
      "gists_url" : "https://api.github.com/users/w0xlt/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/w0xlt",
      "id" : 94266259,
      "login" : "w0xlt",
      "node_id" : "U_kgDOBZ5jkw",
      "organizations_url" : "https://api.github.com/users/w0xlt/orgs",
      "received_events_url" : "https://api.github.com/users/w0xlt/received_events",
      "repos_url" : "https://api.github.com/users/w0xlt/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/w0xlt/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/w0xlt/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/w0xlt"
   },
   "comments" : 2,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24868/comments",
   "created_at" : "2022-04-16T06:17:50Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24868/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/24868",
   "id" : 1206028047,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24868/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII5842T_3d",
   "number" : 24868,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/24868.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24868",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/24868.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24868"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24868/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24868/timeline",
   "title" : "rpc, wallet: Keep the same response from `RPCHelpMan setwalletflag()` regardless of whether the flag is false or true",
   "updated_at" : "2022-04-16T07:15:26Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24868",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/94266259?v=4",
      "events_url" : "https://api.github.com/users/w0xlt/events{/privacy}",
      "followers_url" : "https://api.github.com/users/w0xlt/followers",
      "following_url" : "https://api.github.com/users/w0xlt/following{/other_user}",
      "gists_url" : "https://api.github.com/users/w0xlt/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/w0xlt",
      "id" : 94266259,
      "login" : "w0xlt",
      "node_id" : "U_kgDOBZ5jkw",
      "organizations_url" : "https://api.github.com/users/w0xlt/orgs",
      "received_events_url" : "https://api.github.com/users/w0xlt/received_events",
      "repos_url" : "https://api.github.com/users/w0xlt/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/w0xlt/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/w0xlt/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/w0xlt"
   }
}
