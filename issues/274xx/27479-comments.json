[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/27479#pullrequestreview-1396744957) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27580](https://github.com/bitcoin/bitcoin/pull/27580) (msvc: Cleanup after upgrading libsecp256k1 up to 0.3.0 by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-04-17T22:17:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#issuecomment-1512159343",
      "id" : 1512159343,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27479",
      "node_id" : "IC_kwDOABII585aIbhv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512159343/reactions"
      },
      "updated_at" : "2023-05-12T06:02:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512159343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm in the process of taking over the BIP324 PRs from @dhruv.\r\n\r\nNote for reviewers:\r\n* Previously, the EllSwift encoding/decoding/creation was in #23432, while the ECDH logic was in #23561. I've opted here to merge all EllSwift-related functionality into 1 PR, as the integration is now tighter at the libsecp256k1 too compared to when the PRs were first opened (libsecp256k1 has functions for directly performing ECDH on the EllSwift-encoded keys).\r\n* `EllSwiftPubKey` is now a proper class that exposes a few utility functions, and only read-only access to the encoding.\r\n* Introduction of `FastRandomContext::fillrand` to fill `Span<std::byte>` with randomness.\r\n* Extended `UCharCast` to support `std::byte*` -> `unsigned char*` conversion, which removes the need for lots of `reinterpret_cast`s.\r\n",
      "created_at" : "2023-04-17T22:34:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#issuecomment-1512175200",
      "id" : 1512175200,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27479",
      "node_id" : "IC_kwDOABII585aIfZg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512175200/reactions"
      },
      "updated_at" : "2023-04-17T22:35:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512175200",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171357368"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171357368"
         }
      },
      "author_association" : "MEMBER",
      "body" : "normal *compressed* key",
      "commit_id" : "37d31e334f80f21d612b120418e19c3ac48962e0",
      "created_at" : "2023-04-19T13:36:51Z",
      "diff_hunk" : "@@ -291,6 +291,30 @@ class XOnlyPubKey\n     SERIALIZE_METHODS(XOnlyPubKey, obj) { READWRITE(obj.m_keydata); }\n };\n \n+/** An ElligatorSwift-encoded public key. */\n+struct EllSwiftPubKey\n+{\n+public:\n+    static constexpr size_t ELLSWIFT_ENCODED_SIZE = 64;\n+\n+private:\n+    std::array<std::byte, ELLSWIFT_ENCODED_SIZE> m_pubkey;\n+\n+public:\n+    /** Construct a new ellswift public key from a given serialization. */\n+    EllSwiftPubKey(const std::array<std::byte, ELLSWIFT_ENCODED_SIZE>& ellswift) :\n+        m_pubkey(ellswift) {}\n+\n+    /** Decode to normal key (for debugging purposes). */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171357368",
      "id" : 1171357368,
      "line" : 311,
      "node_id" : "PRRC_kwDOABII585F0X64",
      "original_commit_id" : "2ecd571c958db45608cae0361d14552a11fb709b",
      "original_line" : 311,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/pubkey.h",
      "position" : 21,
      "pull_request_review_id" : 1392091186,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171357368/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-19T14:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171357368",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171362440"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171362440"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Took me too long to figure out what \"ent\" referred to, just putting the full word \"entropy\" in the comment would help. If the entropy is not unpredictable this would result in a not uniformly random(?) series of bytes in the resulting pubkey?",
      "commit_id" : "37d31e334f80f21d612b120418e19c3ac48962e0",
      "created_at" : "2023-04-19T13:40:31Z",
      "diff_hunk" : "@@ -156,6 +162,21 @@ class CKey\n \n     //! Load private key and check that public key matches.\n     bool Load(const CPrivKey& privkey, const CPubKey& vchPubKey, bool fSkipCheck);\n+\n+    /** Create an ellswift-encoded public key for this key, with specified entropy.\n+     *  This must be a valid private key. Ent32 must be 32 bytes. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171362440",
      "id" : 1171362440,
      "line" : 167,
      "node_id" : "PRRC_kwDOABII585F0ZKI",
      "original_commit_id" : "2ecd571c958db45608cae0361d14552a11fb709b",
      "original_line" : 167,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/key.h",
      "position" : 19,
      "pull_request_review_id" : 1392091186,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171362440/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-19T14:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171362440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171373891"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373891"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/64/EllSwiftPubKey::size()/",
      "commit_id" : "37d31e334f80f21d612b120418e19c3ac48962e0",
      "created_at" : "2023-04-19T13:48:55Z",
      "diff_hunk" : "@@ -331,6 +332,57 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+EllSwiftPubKey CKey::EllSwiftCreate(Span<const std::byte> ent32) const\n+{\n+    assert(fValid);\n+    assert(ent32.size() == 32);\n+    std::array<std::byte, EllSwiftPubKey::size()> encoded_pubkey;\n+\n+    auto success = secp256k1_ellswift_create(secp256k1_context_sign,\n+                                             UCharCast(encoded_pubkey.data()),\n+                                             keydata.data(),\n+                                             UCharCast(ent32.data()));\n+\n+    // Should always succeed for valid keys (asserted above).\n+    assert(success);\n+    return {encoded_pubkey};\n+}\n+\n+static const HashWriter HASHER_BIP324_ECDH = TaggedHash(\"bip324_ellswift_xonly_ecdh\");\n+\n+extern \"C\" {\n+\n+static int BIP324ECDHHash(unsigned char* output, const unsigned char* x32, const unsigned char* ours, const unsigned char* theirs, void* data)\n+{\n+    bool initiating = *(bool*)data;\n+    HashWriter writer{HASHER_BIP324_ECDH};\n+    writer << Span{initiating ? ours : theirs, 64};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171373891",
      "id" : 1171373891,
      "line" : 359,
      "node_id" : "PRRC_kwDOABII585F0b9D",
      "original_commit_id" : "2ecd571c958db45608cae0361d14552a11fb709b",
      "original_line" : 359,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/key.cpp",
      "position" : 36,
      "pull_request_review_id" : 1392091186,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373891/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-19T14:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171373986"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373986"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/64/EllSwiftPubKey::size()/",
      "commit_id" : "37d31e334f80f21d612b120418e19c3ac48962e0",
      "created_at" : "2023-04-19T13:48:59Z",
      "diff_hunk" : "@@ -331,6 +332,57 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+EllSwiftPubKey CKey::EllSwiftCreate(Span<const std::byte> ent32) const\n+{\n+    assert(fValid);\n+    assert(ent32.size() == 32);\n+    std::array<std::byte, EllSwiftPubKey::size()> encoded_pubkey;\n+\n+    auto success = secp256k1_ellswift_create(secp256k1_context_sign,\n+                                             UCharCast(encoded_pubkey.data()),\n+                                             keydata.data(),\n+                                             UCharCast(ent32.data()));\n+\n+    // Should always succeed for valid keys (asserted above).\n+    assert(success);\n+    return {encoded_pubkey};\n+}\n+\n+static const HashWriter HASHER_BIP324_ECDH = TaggedHash(\"bip324_ellswift_xonly_ecdh\");\n+\n+extern \"C\" {\n+\n+static int BIP324ECDHHash(unsigned char* output, const unsigned char* x32, const unsigned char* ours, const unsigned char* theirs, void* data)\n+{\n+    bool initiating = *(bool*)data;\n+    HashWriter writer{HASHER_BIP324_ECDH};\n+    writer << Span{initiating ? ours : theirs, 64};\n+    writer << Span{initiating ? theirs : ours, 64};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171373986",
      "id" : 1171373986,
      "line" : 360,
      "node_id" : "PRRC_kwDOABII585F0b-i",
      "original_commit_id" : "2ecd571c958db45608cae0361d14552a11fb709b",
      "original_line" : 360,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/key.cpp",
      "position" : 37,
      "pull_request_review_id" : 1392091186,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373986/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-19T14:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171373986",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171402620"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171402620"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Actually, no, the \"create ellswift encoding\" algorithm in libsecp256k1 uses an internal RNG which is always at least seeded with the private key; the `ent32` argument here is just auxiliary randomness that gets fed to that RNG.\r\n\r\nThe output of the encoding is in fact indistinguishable from uniformly random to anyone who doesn't know the private key already, even without additional entropy. Adding actual randomness is a more belt-and-suspenders step to make sure the result is actually close to uniformly random, rather than just indistinguishable from random.\r\n\r\nThis deserves some extra comments, will add soon.",
      "commit_id" : "37d31e334f80f21d612b120418e19c3ac48962e0",
      "created_at" : "2023-04-19T14:08:36Z",
      "diff_hunk" : "@@ -156,6 +162,21 @@ class CKey\n \n     //! Load private key and check that public key matches.\n     bool Load(const CPrivKey& privkey, const CPubKey& vchPubKey, bool fSkipCheck);\n+\n+    /** Create an ellswift-encoded public key for this key, with specified entropy.\n+     *  This must be a valid private key. Ent32 must be 32 bytes. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171402620",
      "id" : 1171402620,
      "in_reply_to_id" : 1171362440,
      "line" : 167,
      "node_id" : "PRRC_kwDOABII585F0i98",
      "original_commit_id" : "2ecd571c958db45608cae0361d14552a11fb709b",
      "original_line" : 167,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/key.h",
      "position" : 19,
      "pull_request_review_id" : 1392161620,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171402620/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-19T14:11:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171402620",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171962843"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171962843"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "tiny nit: could be put in the \"private:\" section, since there is a static constexpr `size()` function returning this value below anyway.",
      "commit_id" : "37d31e334f80f21d612b120418e19c3ac48962e0",
      "created_at" : "2023-04-20T00:19:10Z",
      "diff_hunk" : "@@ -291,6 +291,30 @@ class XOnlyPubKey\n     SERIALIZE_METHODS(XOnlyPubKey, obj) { READWRITE(obj.m_keydata); }\n };\n \n+/** An ElligatorSwift-encoded public key. */\n+struct EllSwiftPubKey\n+{\n+public:\n+    static constexpr size_t ELLSWIFT_ENCODED_SIZE = 64;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171962843",
      "id" : 1171962843,
      "line" : 298,
      "node_id" : "PRRC_kwDOABII585F2rvb",
      "original_commit_id" : "fd04a2baec77b97cfb36ec488cec58811ea1ad45",
      "original_line" : 298,
      "original_position" : 8,
      "original_start_line" : 297,
      "path" : "src/pubkey.h",
      "position" : 8,
      "pull_request_review_id" : 1393040022,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171962843/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 297,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-04-20T00:46:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171962843",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171972333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171972333"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "There's a theoretical possibility that this call crashes due to failed assertion `assert(fValid)`, if the generated key from the previous round (=first 32 bytes of ellswift encoded pubkey) was not valid. Due to the practical low probably for this to ever happen (if my math isn't off, on average every 2^(127,65) randomly generated key is invalid), I guess it's not worth it to add any checks here, especially since it's only a benchmark?",
      "commit_id" : "37d31e334f80f21d612b120418e19c3ac48962e0",
      "created_at" : "2023-04-20T00:43:15Z",
      "diff_hunk" : "@@ -0,0 +1,32 @@\n+// Copyright (c) 2022-2023 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+\n+#include <key.h>\n+#include <random.h>\n+\n+#include <array>\n+\n+static void EllSwiftCreate(benchmark::Bench& bench)\n+{\n+    ECC_Start();\n+\n+    CKey key;\n+    key.MakeNewKey(true);\n+\n+    uint256 entropy = GetRandHash();\n+\n+    bench.batch(1).unit(\"pubkey\").run([&] {\n+        auto ret = key.EllSwiftCreate(AsBytes(Span{entropy}));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#discussion_r1171972333",
      "id" : 1171972333,
      "line" : 22,
      "node_id" : "PRRC_kwDOABII585F2uDt",
      "original_commit_id" : "e1ddcb416ace0c4a8d7da29c89454928b93c2c9e",
      "original_line" : 22,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/bench/ellswift.cpp",
      "position" : 22,
      "pull_request_review_id" : 1393040022,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27479",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171972333/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-20T00:50:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1171972333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @stratospher ",
      "created_at" : "2023-05-12T08:49:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27479#issuecomment-1545400377",
      "id" : 1545400377,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27479",
      "node_id" : "IC_kwDOABII585cHPA5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545400377/reactions"
      },
      "updated_at" : "2023-05-12T08:49:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545400377",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
