[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept NACK | [ghost](https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1507446950), [0xB10C](https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1529678174) |\n| Concept ACK | [dergoegge](https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1498115249), [glozow](https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1499006887), [jnewbery](https://github.com/bitcoin/bitcoin/pull/27426#pullrequestreview-1381043081), [instagibbs](https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1505589569), [earuak](https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1505730664), [darosior](https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1512920984), [michaelfolkson](https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1529711107) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27114](https://github.com/bitcoin/bitcoin/pull/27114) (p2p: Allow whitelisting outgoing connections by brunoerg)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-04-05T20:10:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1498068949",
      "id" : 1498068949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585ZSrfV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498068949/reactions"
      },
      "updated_at" : "2023-05-01T13:26:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498068949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\n(I would like to see us do the same for BIP37 at some point)",
      "created_at" : "2023-04-05T20:31:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1498115249",
      "id" : 1498115249,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585ZS2yx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498115249/reactions"
      },
      "updated_at" : "2023-04-05T20:31:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498115249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I agree there should be a mailing list post.",
      "created_at" : "2023-04-06T12:41:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1499006887",
      "id" : 1499006887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585ZWQen",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1499006887/reactions"
      },
      "updated_at" : "2023-04-06T12:41:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1499006887",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The [BIP35](https://github.com/bitcoin/bips/blob/master/bip-0035.mediawiki) mempool P2P message can be used to share the txids in a node's mempool (motivation in BIP35). However it is no longer used (?), is bad for privacy, and we can simplify our P2P code by removing it.\r\n\r\nIt is still possible to guess mempool transactions using `getdata` by maintaining mempool with no restrictions. I dont think sharing mempool affects privacy particularly in this case as its behind `NetPermissionFlags::Mempool flag`. If privacy needs to be improved at mempool level it should be possible to make all transactions look similar until included in block except fee rate however that is out of scope for discussion here.\r\n\r\n> Subsequently the service was gated behind the NetPermissionFlags::Mempool flag, meaning that the original BIP identitifcation method is no longer sufficient to determine that a node will offer this service to you (the node operator must whitelist or otherwise elevate your net permissions before they will respond to it). Therefore I think that it is safe to remove without any change in protocol version.\r\n\r\nIt could still be helpful in testing. Since we have lot of inconsistencies in mempool policies recently for political reasons, I think we should keep this P2P message available at least for testing if `NetPermissionFlags::Mempool` flag cannot be removed.",
      "created_at" : "2023-04-07T06:34:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1499987244",
      "id" : 1499987244,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585ZZ_0s",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1499987244/reactions"
      },
      "updated_at" : "2023-04-07T06:54:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1499987244",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It is still possible to guess mempool transactions using `getdata` by maintaining mempool with no restrictions.\r\n\r\nThis doesn't work for new transactions, a node answers a `getdata` request for a tx it didn't announce to a peer via an `inv` if that transaction is older than `UNCONDITIONAL_RELAY_DELAY` (2 minutes), see [here](https://github.com/bitcoin/bitcoin/blob/d544d03ba6c7ed3c5879c8bc1108f45d0aac2798/src/net_processing.cpp#L2261-L2263). This is meant to protect against transaction origin detection.",
      "created_at" : "2023-04-10T21:02:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1502320345",
      "id" : 1502320345,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585Zi5bZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1502320345/reactions"
      },
      "updated_at" : "2023-04-10T21:02:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1502320345",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Personally, I don't use this too much, but I have used it in the past (for a while I maintained a patch for myself to allow me to sync one node's mempool from another by using an RPC command).  Supporting a mempool sync between two nodes that you control, to bootstrap newly started nodes, seems like a useful thing conceptually.\r\n\r\nI don't feel strongly though, and if this is a mostly rarely or never used feature, then I'm not opposed to removing it.\r\n\r\nI'd be curious to know how people feel about a \"mempool-sync\" functionality -- let's say we came up with a way to use Erlay's set reconciliation (or some other method, like weak blocks) to try to sync the top of node mempools from time to time.  Is there a reason that would be a bad idea (assuming we can prevent DoS)?  And if not, would that imply that the mempool command (for whitelisted peers, to avoid DoS or privacy attacks) isn't so bad to have either?",
      "created_at" : "2023-04-11T12:42:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1503258229",
      "id" : 1503258229,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585ZmeZ1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1503258229/reactions"
      },
      "updated_at" : "2023-04-11T12:42:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1503258229",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In the pull description NODE_NETWORK should say NODE_BLOOM?\r\n\r\n\r\n>  Supporting a mempool sync between two nodes that you control, to bootstrap newly started nodes, seems like a useful thing conceptually.\r\n\r\nIf you control both nodes, wouldn't it be easier to run the RPC on the sending side directly to fan out all transactions instead of going an extra hop over P2P? If the receiving node is offline, you can copy the mempool dat (see https://github.com/bitcoin/bitcoin/issues/25018#issuecomment-1112505941), but I guess that replaces the mempool, instead of only appending transactions. Maybe there is also a use case for syncing from a publicly accessible  3rd party node via a P2P message?",
      "created_at" : "2023-04-11T13:05:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1503313635",
      "id" : 1503313635,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585Zmr7j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1503313635/reactions"
      },
      "updated_at" : "2023-04-11T13:05:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1503313635",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> However it is no longer used (?), is bad for privacy, and we can simplify our P2P code by removing it.\r\n\r\nNot knowing whether it's used seems a bad starting point? And it's only an extra boolean and 20 something lines of code, which doesn't seem like a big deal? I would have expected it to be kept around until BIP 37 (bloom filtering) support was dropped entirely, but don't really have a justification for that.\r\n\r\n> let's say we came up with a way [...] to try to sync the top of node mempools from time to time. Is there a reason that would be a bad idea\r\n\r\nI think that's a different way of describing \"rebroadcast\", which seems like a good idea: it improves miner revenue, improves tx propagation, improves block propagation, makes eclipse and pinning attacks harder... At least assuming it can be implemented without too many terrible tradeoffs.\r\n\r\n> And if not, would that imply that the mempool command (for whitelisted peers, to avoid DoS or privacy attacks) isn't so bad to have either?\r\n\r\nI'd like to have a better way to sync mempools between my own nodes (eg, if my signet inquisition miner goes down and misses some transactions, they generally won't just reappear automatically). Dumping the entire mempool and then running sendrawtransaction a bunch of times is a bit annoying...\r\n\r\n> If you control both nodes, wouldn't it be easier to run the RPC on the sending side directly to fan out all transactions\r\n\r\nSyncing core nodes by sending INV messages and doing regular tx relay effectively rebroadcasts the transactions, potentially resetting their expiry time. Having either a p2p command or an rpc command that lets you just sync mempools without necessarily also rebroadcasting the different transactions would be nice.\r\n\r\nSo I guess I'm -0.1 on this; but would be +0.5 on keeping it and adding a \"sendmempoolcmdtopeer\" rpc so that it can be used?",
      "created_at" : "2023-04-12T04:37:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1504598010",
      "id" : 1504598010,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585Zrlf6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1504598010/reactions"
      },
      "updated_at" : "2023-04-12T04:37:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1504598010",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Syncing core nodes by sending INV messages and doing regular tx relay effectively rebroadcasts the transactions, potentially resetting their expiry time. Having either a p2p command or an rpc command that lets you just sync mempools without necessarily also rebroadcasting the different transactions would be nice.\r\n\r\nMaybe I am missing something, but I fail to see how the expiry time can be synced over p2p. My understanding is that the receiving node sets the expiry for newly accepted transactions and leaves it as-is for existing mempool transactions. Also, the reply to a mempool msg is an inv msg, so I also fail to see how an inv message is handled differently on the receiving side whether or not a mempool msg was sent prior?",
      "created_at" : "2023-04-12T07:19:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1504787771",
      "id" : 1504787771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585ZsT07",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1504787771/reactions"
      },
      "updated_at" : "2023-04-12T07:19:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1504787771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> If you control both nodes, wouldn't it be easier to run the RPC on the sending side directly to fan out all transactions instead of going an extra hop over P2P?\r\n\r\n@MarcoFalke Yeah I think this is a fair point...  And I guess really if there were a use case, it would be for users of other software interacting with Bitcoin Core and wanting some functionality like this without having to recompile their Bitcoin Core node to run a custom patch (a situation that does not apply to me!).",
      "created_at" : "2023-04-12T08:23:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1504865608",
      "id" : 1504865608,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585Zsm1I",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1504865608/reactions"
      },
      "updated_at" : "2023-04-12T08:23:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1504865608",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the comments all. I am currently editing a ML post to get feedback from a wider audience too, as sensibly suggested.\r\n\r\nReplies to some comments below:\r\n\r\n> It could still be helpful in testing. Since we have lot of inconsistencies in mempool policies recently for political reasons, I think we should keep this P2P message available at least for testing if NetPermissionFlags::Mempool flag cannot be removed.\r\n\r\nAFAIK even for use in \"testing\" this would require custom code or a patched node (to send and handle the messages) as Bitcoin Core cannot send them. Even if we did remove this message anyone wanting the same functionality for testing could either again run a custom-patched node and/or change their test code to dump the entire mempool from the host node using `savemempool` and then parse/feed transactions to the client node.\r\n\r\n> I'd be curious to know how people feel about a \"mempool-sync\" functionality -- let's say we came up with a way to use Erlay's set reconciliation (or some other method, like weak blocks) to try to sync the top of node mempools from time to time. Is there a reason that would be a bad idea (assuming we can prevent DoS)? And if not, would that imply that the mempool command (for whitelisted peers, to avoid DoS or privacy attacks) isn't so bad to have either?\r\n\r\nThis is a very nice thought experiment which I would like to think about more, thanks. My gut tells me that querying arbitrary mempools via P2P is likely to damage tx origin privacy if not very carfeully implemented, as nodes _may_ not end up with as much control over when they broadcast transactions -- something we currently rely on for network privacy.\r\n\r\n> Not knowing whether it's used seems a bad starting point? And it's only an extra boolean and 20 something lines of code, which doesn't seem like a big deal? I would have expected it to be kept around until BIP 37 (bloom filtering) support was dropped entirely, but don't really have a justification for that.\r\n\r\nTo be clear here, I know it's not used by Bitcoin Core, but the idea of this request for comments is to find out if it's used by any end-users/services which is something we can't find out any other way? Whilst I agree wrt BIP37, I think that would be more controversial as it likely still sees (ill-advised) use, but again, this is un-measured by myself and my long-running node has not had bloom filters enabled for some time.\r\n\r\n> I'd like to have a better way to sync mempools between my own nodes (eg, if my signet inquisition miner goes down and misses some transactions, they generally won't just reappear automatically). Dumping the entire mempool and then running sendrawtransaction a bunch of times is a bit annoying...\r\n\r\nHow do you do this currently? I agree that a mempool sync would be nice to have but I don't think P2P messages are the best way for it to work...\r\n\r\n> So I guess I'm -0.1 on this; but would be +0.5 on keeping it and adding a \"sendmempoolcmdtopeer\" rpc so that it can be used?|\r\n\r\nAgree that if people want this functionality that this UX would be better even than dumping and loading the mempool, even if slightly less efficient and incomplete (see next reply).\r\n\r\n> Maybe I am missing something, but I fail to see how the expiry time can be synced over p2p. My understanding is that the receiving node sets the expiry for newly accepted transactions and leaves it as-is for existing mempool transactions. Also, the reply to a mempool msg is an inv msg, so I also fail to see how an inv message is handled differently on the receiving side whether or not a mempool msg was sent prior?\r\n\r\nThis is where `savemempool` paired with complementary `loadmempool` would be superior, as the `TxMempoolInfo`'s `m_time`is part of the dump.",
      "created_at" : "2023-04-12T10:02:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1505002617",
      "id" : 1505002617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585ZtIR5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505002617/reactions"
      },
      "updated_at" : "2023-04-12T10:02:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505002617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > let's say we came up with a way [...] to try to sync the top of node mempools from time to time. Is there a reason that would be a bad idea\r\n> \r\n> I think that's a different way of describing \"rebroadcast\", which seems like a good idea: it improves miner revenue, improves tx propagation, improves block propagation, makes eclipse and pinning attacks harder... At least assuming it can be implemented without too many terrible tradeoffs.\r\n\r\n+1. I don't think it implies BIP35 support is good, though. Revealing the top transactions is pretty different from revealing the entire mempool privacy-wise. The only one that benefits here is the node that sends the mempool request. So these seem like pretty different use cases to me.\r\n\r\n> Dumping the entire mempool and then running sendrawtransaction a bunch of times is a bit annoying...\r\n\r\n> This is where savemempool paired with complementary loadmempool would be superior, as the TxMempoolInfo's m_timeis part of the dump.\r\n\r\nAdding a loadmempool RPC seems to be exactly what we want here? The timestamps sync, it's relatively convenient (a few rpc commands and no restarts), the syncing node can keep the transactions that are already there (assuming no conflicts), and we don't need to go over p2p.",
      "created_at" : "2023-04-12T14:32:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1505385773",
      "id" : 1505385773,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585Zul0t",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505385773/reactions"
      },
      "updated_at" : "2023-04-12T14:32:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505385773",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Adding a loadmempool RPC seems to be exactly what we want here?\r\n\r\nconcept ACK on this, if that's the only use-case. We should probably offer a similar service over RPC first, in addition to information gathering that it's not actually being used in meaningful amounts in production. I've never come across usage myself in my production work.\r\n\r\nI'm not sure where \"20 lines of code\" came from as it looks like at least a few multiples of that, but in general, removing a service no one uses to make code more readable will be a win, especially in net_processing.\r\n",
      "created_at" : "2023-04-12T16:38:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1505589569",
      "id" : 1505589569,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585ZvXlB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505589569/reactions"
      },
      "updated_at" : "2023-04-12T16:38:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505589569",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "\r\nConcept ACK \r\n\r\nThe BIP35 mempool P2P message, as you mentioned, was originally introduced as a way to share the txids in a node's mempool. However, as you also mentioned, it is no longer widely used and has been closed behind the NetPermissionFlags::Mempool flag due to privacy concerns.\r\n\r\nBased on this, it seems reasonable to simplify the P2P code by removing this message, as long as this can be done without changing the protocol version. However, before doing so, it is important to ensure that there are no major use cases for this message that could be affected by its removal.\r\n\r\nYou suggested looking for feedback from Concept ACKs or anyone who is still actively using this message to find out more about your use cases. This is a good idea and can help ensure that removing the message doesn't negatively affect any major use cases. In addition, it can also be helpful to perform careful testing to ensure that removing the message does not cause unexpected problems or interruptions in the protocol's functioning.",
      "created_at" : "2023-04-12T18:21:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1505730664",
      "id" : 1505730664,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585Zv6Bo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505730664/reactions"
      },
      "updated_at" : "2023-04-12T19:14:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505730664",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/85800864?v=4",
         "events_url" : "https://api.github.com/users/earuak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/earuak/followers",
         "following_url" : "https://api.github.com/users/earuak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/earuak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/earuak",
         "id" : 85800864,
         "login" : "earuak",
         "node_id" : "MDQ6VXNlcjg1ODAwODY0",
         "organizations_url" : "https://api.github.com/users/earuak/orgs",
         "received_events_url" : "https://api.github.com/users/earuak/received_events",
         "repos_url" : "https://api.github.com/users/earuak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/earuak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/earuak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/earuak"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > Adding a loadmempool RPC seems to be exactly what we want here?\r\n> \r\n> concept ACK on this, if that's the only use-case. We should probably offer a similar service over RPC first, in addition to information gathering that it's not actually being used in meaningful amounts in production. I've never come across usage myself in my production work.\r\n\r\n#27460",
      "created_at" : "2023-04-13T11:24:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1506796551",
      "id" : 1506796551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585Zz-QH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1506796551/reactions"
      },
      "updated_at" : "2023-04-13T11:24:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1506796551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I retract my NACK\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/27426#pullrequestreview-1381688305\r\n\r\nACK for removing this useless p2p message ",
      "created_at" : "2023-04-13T18:37:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1507446950",
      "id" : 1507446950,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585Z2dCm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507446950/reactions"
      },
      "updated_at" : "2023-04-13T18:37:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507446950",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=4",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "node_id" : "MDQ6VXNlcjEwMTM3",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK but i think BTCPay is using it. cc @NicolasDorier",
      "created_at" : "2023-04-18T11:34:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1512920984",
      "id" : 1512920984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585aLVeY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512920984/reactions"
      },
      "updated_at" : "2023-04-18T11:34:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1512920984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Linking here this response to the ML request for feedback.\r\n\r\nhttps://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-April/021563.html",
      "created_at" : "2023-04-24T15:38:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1520408121",
      "id" : 1520408121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585an5Y5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1520408121/reactions"
      },
      "updated_at" : "2023-04-24T15:38:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1520408121",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@schildbach - this would be problematic for BitcoinJ, no?",
      "created_at" : "2023-04-28T01:56:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1526869942",
      "id" : 1526869942,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585bAi-2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1526869942/reactions"
      },
      "updated_at" : "2023-04-28T01:56:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1526869942",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/116298498?v=4",
         "events_url" : "https://api.github.com/users/HenrikJannsen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/HenrikJannsen/followers",
         "following_url" : "https://api.github.com/users/HenrikJannsen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/HenrikJannsen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/HenrikJannsen",
         "id" : 116298498,
         "login" : "HenrikJannsen",
         "node_id" : "U_kgDOBu6TAg",
         "organizations_url" : "https://api.github.com/users/HenrikJannsen/orgs",
         "received_events_url" : "https://api.github.com/users/HenrikJannsen/received_events",
         "repos_url" : "https://api.github.com/users/HenrikJannsen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/HenrikJannsen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/HenrikJannsen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/HenrikJannsen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The mempool message is used by all wallets based on bitcoinj to learn about pending transactions, in both full blocks mode and also in filtered mode. The estimated install base is 10M+.\r\n",
      "created_at" : "2023-04-28T13:08:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1527540750",
      "id" : 1527540750,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585bDGwO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1527540750/reactions"
      },
      "updated_at" : "2023-04-28T13:08:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1527540750",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/743306?v=4",
         "events_url" : "https://api.github.com/users/schildbach/events{/privacy}",
         "followers_url" : "https://api.github.com/users/schildbach/followers",
         "following_url" : "https://api.github.com/users/schildbach/following{/other_user}",
         "gists_url" : "https://api.github.com/users/schildbach/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/schildbach",
         "id" : 743306,
         "login" : "schildbach",
         "node_id" : "MDQ6VXNlcjc0MzMwNg==",
         "organizations_url" : "https://api.github.com/users/schildbach/orgs",
         "received_events_url" : "https://api.github.com/users/schildbach/received_events",
         "repos_url" : "https://api.github.com/users/schildbach/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/schildbach/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/schildbach/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/schildbach"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> The mempool message is used by all wallets based on bitcoinj to learn about pending transactions, in both full blocks mode and also in filtered mode. The estimated install base is 10M+.\r\n\r\nI guess the large install base should be reason enough to drop that proposal.\r\n\r\n[Bisq](https://bisq.network/) is using BitcoinJ and would be affected by that proposed change as well. ",
      "created_at" : "2023-04-29T03:38:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1528610256",
      "id" : 1528610256,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585bHL3Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1528610256/reactions"
      },
      "updated_at" : "2023-04-29T03:38:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1528610256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/116298498?v=4",
         "events_url" : "https://api.github.com/users/HenrikJannsen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/HenrikJannsen/followers",
         "following_url" : "https://api.github.com/users/HenrikJannsen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/HenrikJannsen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/HenrikJannsen",
         "id" : 116298498,
         "login" : "HenrikJannsen",
         "node_id" : "U_kgDOBu6TAg",
         "organizations_url" : "https://api.github.com/users/HenrikJannsen/orgs",
         "received_events_url" : "https://api.github.com/users/HenrikJannsen/received_events",
         "repos_url" : "https://api.github.com/users/HenrikJannsen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/HenrikJannsen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/HenrikJannsen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/HenrikJannsen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Its original intention was to be publicly callable, but it is now (in Bitcoin Core) gated behind stricter Net Permissions which make it accessible to trusted peers only.\r\n> \r\n> Subsequently the service was gated behind the NetPermissionFlags::Mempool flag, meaning that the original BIP identitifcation method is no longer sufficient to determine that a node will offer this service to you (the node operator must whitelist or otherwise elevate your net permissions before they will respond to it). Therefore I think that it is safe to remove without any change in protocol version.\r\n\r\nThis is incorrect. A Bitcoin Core node with bloom filters enabled (off by default; enable with `-peerbloomfilters=1`) **does** respond to `mempool` messages with INV messages containing mempool transactions.  Clients **do not** need special permissions. However, I too found [this](https://github.com/bitcoin/bitcoin/blob/d89aca1bdbe52406f000e3fa8dda12c46dca9bdd/src/net_processing.cpp#LL4603C52-L4603) if-statement to be hard to reason about.\r\n\r\nAccording to [DSN KIT data](https://gist.github.com/0xB10C/4bd642db1b9710ae31e626c3d6143ff9) about 22% of the reachable nodes (they only connect to IPv4 and IPv6) set the `NODE_BLOOM` service flag and [bitnodes data](https://bitnodes.io/dashboard/#services) (also includes onion nodes) shows about 6100 nodes out of 17554 (35%) having the `NODE_BLOOM` service flag set. For example, [Umbrel](https://github.com/getumbrel/umbrel-apps/blob/b6a398041315464a128c313c811bf0712548b906/bitcoin/exports.sh#L110) and [raspiblitz](https://github.com/rootzoll/raspiblitz/blob/f8f9d467ba919b633eac96fc443cf23350604d6e/home.admin/assets/bitcoin.conf#L12) nodes do. Given these numbers, a wallet/light-client probably doesn't have a hard time finding a peer that responds to `mempool` messages. Removing the handling of `mempool` messages from Bitcoin Core would probably impact these clients.\r\n\r\n>> However it is no longer used (?), is bad for privacy, and we can simplify our P2P code by removing it.\r\n>\r\n> Not knowing whether it's used seems a bad starting point?\r\n\r\nI configured one of my p2p monitoring nodes to capture some `mempool`-message related statistics a few days ago. The Bitcoin Core node runs a recent `master` commit and is and has been advertising the bloom filter service bit (via `-peerbloomfilters=1`) for >30 days. I assume it is well-known to other nodes and light-clients on the network. The inbound connection slots are usually full.\r\n\r\nThis node has been receiving on average 18.6 `mempool`-messages per hour (Ï = 10.9). With fewer messages on the weekend. The client IP addresses seem to mostly belong to residential ISPs. However, there's also a noticeable amount of requests from Linode servers (VPN? something else?) and some from known VPN providers. \r\n\r\n![image](https://user-images.githubusercontent.com/19157360/235453455-1edf11ff-c08e-4af6-9cb0-a1951f5935d7.png)\r\n\r\n\r\nThe most common user agents (in descending frequency) are `/BitcoinKit:0.1.0/` from [bitcoin-kit-ios](https://github.com/horizontalsystems/bitcoin-kit-ios/blob/569e87ac53fa8d023ba2275adf01d41d6018436f/BitcoinCore/Classes/Network/Peer/Peer.swift#L70),   `/bitcoinj:0.*.*/Bitcoin Wallet:*/` (different versions, but seemingly more recent than the [LinkingLion bitcoinj user-agents](https://b10c.me/data/observations/06-linkinglion/linkinglion-user-agents.txt)) from the @schildbach wallet, `/WalletKit:0.1.0/` by [unstoppable-wallet-android](https://github.com/horizontalsystems/unstoppable-wallet-android/issues/3933#issuecomment-887259132), and `/bread:2.1/` by [breadwallet-core](https://github.com/breadwallet/breadwallet-core/blob/73566cb79f753954eccbf07d5ab25ca54741198e/bitcoin/BRPeer.h#L60-L61). I've also received a single `mempool` message from the user agents `/libbitcoin:3.7.0/`, `/BQS:0.0.1/`, and `/Bither1.6.1/`.\r\n\r\nI'm seeing INV responses with up to 50k (`MAX_INV_SZ`) entries. There are also seem to be INVs to clients which loaded a filter before. The difference in entries per INV too a node without bloom filters is clearly [visible](https://user-images.githubusercontent.com/19157360/235449290-7d275062-5bc0-4025-90f6-6499a7e64061.png).\r\n\r\n![image](https://user-images.githubusercontent.com/19157360/235448790-6a1448bd-64b3-4c41-89d3-1ca5bf0cf76d.png)\r\n\r\n\r\n> The mempool message is used by all wallets based on bitcoinj to learn about pending transactions, in both full blocks mode and also in filtered mode. The estimated install base is 10M+.\r\n\r\nI think \"10M+\" is the number of installations over the last 10 years or so? I this doesn't necessarily comes close to 10M active installations and isn't really a compelling statistic for this PR. I think, for Google Play Store installations, you could actually get a somewhat accurate number of active installations from the Google developer console. \r\n\r\nAlso, I think it would be useful to hear for what the `mempool` message is being use for in bitcoinj-based wallets. Listing unconfirmed transactions? Would it break the wallet if there wouldn't be any NODE_BLOOM nodes or nodes which respond to `mempool` messages?\r\n\r\n---\r\n\r\nI'm generally in favor of slimming down and removing the message (and also the BIP-37 implementation) at some point. Given that the `mempool` message can and is being used by clients/wallets I don't think it's a good idea to remove it at the moment. However, removing it probably shouldn't render the clients and wallets completely useless.\r\n\r\nStill, this leaves me with a tendency towards a **Concept NACK** for now because it can and is being used.\r\n",
      "created_at" : "2023-05-01T12:48:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1529678174",
      "id" : 1529678174,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585bLQle",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529678174/reactions"
      },
      "updated_at" : "2023-05-01T15:03:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529678174",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@0xB10C: Thanks for this, great analysis.\r\n\r\n> I'm generally in favor of slimming down and removing the message (and also the BIP-37 implementation) at some point.\r\n\r\nI read that as a longer term Concept ACK for removal but you'd like a deprecation release schedule rather than removing it immediately in say the next major version release. Presumably something like a deprecation warning in the next major version release before actual ~~deprecation~~ removal in the following major version release could work for the removal of P2P messages.  I previously tried to document the thinking on how the project does/should treat deprecation generally [here](https://bitcoin.stackexchange.com/questions/113008/what-are-the-considerations-when-assessing-whether-to-deprecate-a-feature-in-bit) but not sure whether P2P messages fit into a generalized deprecation process or whether they should be treated uniquely.",
      "created_at" : "2023-05-01T13:26:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1529711107",
      "id" : 1529711107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585bLYoD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529711107/reactions"
      },
      "updated_at" : "2023-05-01T13:34:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529711107",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for your statistics on the usage of this message @0xB10C, they show a compelling amount of use for the BIP35 protocol still.\r\n\r\nAs David Harding suggested on the mailing list, which I agree with, removing an actively-used feature in absence of an alternative would be undesirable, and therefore will close this PR for now.",
      "created_at" : "2023-05-01T14:18:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27426#issuecomment-1529767111",
      "id" : 1529767111,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27426",
      "node_id" : "IC_kwDOABII585bLmTH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 3,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 3,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529767111/reactions"
      },
      "updated_at" : "2023-05-01T14:18:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1529767111",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   }
]
