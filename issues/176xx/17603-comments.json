[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for reporting this! I have suggested a fix for the issue related to coin selection and I will submit an improvement for `getbalances` as well.",
      "created_at" : "2019-12-29T13:50:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17603#issuecomment-569507447",
      "id" : 569507447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17603",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTUwNzQ0Nw==",
      "updated_at" : "2019-12-29T13:50:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569507447",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The reason why you are only seeing one single input is because you are creating exactly 31 outputs. The code will create up to 10 size groups for a single destination, to avoid inadvertently creating massive transactions.\r\n\r\nIn your case, you will receive groups of 10, 10, 10, and 1 UTXO. The last one will obviously result in the most efficient transaction as it is 10x smaller than the others.\r\n\r\nUnfortunately, this results in 1499 btc being marked as dirty in this particular case, but I don't believe this is particularly common in the wild. It is not ideal for a regtest with avoidreuse enabled, though, that's for sure.\r\n\r\nTo see what I mean, change the 31 to 30 in your initial generate to $addr, then txid should give a tx with 10 inputs, not 1.",
      "created_at" : "2019-12-31T05:31:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17603#issuecomment-569867141",
      "id" : 569867141,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17603",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg2NzE0MQ==",
      "updated_at" : "2019-12-31T05:35:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569867141",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It has been a while since I reported this, but wasn't the point to defeat chain analysis companies that spam our wallets with dust? If so, those companies can spam us with 10 pieces of dust per address to trigger this issue.\r\n\r\nI used regtest because it's quicker and cheaper than doing the same thing on mainnet but I think the result would be the same whichever network I used wouldn't it?\r\n\r\nEither way, having the remaining balance show up as \"trusted\" when it should show as \"used\" seems wrong to me.",
      "created_at" : "2019-12-31T15:11:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17603#issuecomment-569943251",
      "id" : 569943251,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17603",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTk0MzI1MQ==",
      "updated_at" : "2019-12-31T15:11:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569943251",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It has been a while since I reported this, but wasn't the point to defeat chain analysis companies that spam our wallets with dust? If so, those companies can spam us with 10 pieces of dust per address to trigger this issue.\r\n\r\nIt is not that easy. It works in your example only because the amount you send in the transaction is smaller than each one of the outputs in the destination (1 BTC < 50 BTC block reward). If you keep everything else the same and send 51 BTC instead of 1 BTC the transaction should have 10 inputs as intended. So the attack is still possible but it would be much more expensive because dust outputs would not be enough to be selected as the input in most normal transactions and, as you said, they would have to send at least 10 of them if the address had not been reused before. Essentially the chain analysis company would have to spam a used destination with 10 outputs and then hope that the wallet user sends a transaction that is smaller than each one of the 10 outputs and that then one of the 10 outputs is selected as the input.\r\n\r\nThe other outputs are not showing up as \"used\" because cached values are used when that should not be the case. I am working on improving this.\r\n",
      "created_at" : "2019-12-31T15:55:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17603#issuecomment-569949624",
      "id" : 569949624,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17603",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTk0OTYyNA==",
      "updated_at" : "2019-12-31T15:55:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569949624",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "What is left to do here?",
      "created_at" : "2020-01-15T16:14:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17603#issuecomment-574733006",
      "id" : 574733006,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17603",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NDczMzAwNg==",
      "updated_at" : "2020-01-15T16:14:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/574733006",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Oh, #17824 is not yet merged",
      "created_at" : "2020-01-15T16:15:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17603#issuecomment-574733333",
      "id" : 574733333,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17603",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NDczMzMzMw==",
      "updated_at" : "2020-01-15T16:15:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/574733333",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
