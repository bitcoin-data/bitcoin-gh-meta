[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I was originally going to follow up on this change by making RescanFromTime rescan any missed blocks if a scan stopped early because of a reorg (8add443be1c4b82f75d0eca4763fc928b8dbcf08), but I don't think this should be needed because notifications from the reorg should scan all the relevant blocks.",
      "created_at" : "2018-01-26T15:15:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-360811532",
      "id" : 360811532,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12275",
      "updated_at" : "2018-01-26T15:15:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/360811532",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "[Dejavu](https://github.com/bitcoin/bitcoin/pull/9827).",
      "created_at" : "2018-01-26T15:19:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-360812893",
      "id" : 360812893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12275",
      "updated_at" : "2018-01-26T15:19:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/360812893",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the follow up.\r\nConcept ACK.\r\nDo we need this for 0.16?",
      "created_at" : "2018-01-26T18:12:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-360861167",
      "id" : 360861167,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12275",
      "updated_at" : "2018-01-26T18:12:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/360861167",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Do we need this for 0.16?\r\n\r\nI don't think it should block 0.16, but technically there is a minor regression in 0.16 which this fixes.\r\n\r\nSince #11281, if you call importmulti with rescan=True during a re-org and are very unlucky, there is a chance you could see \"Rescan failed for key...\" errors returned without this fix. The errors are spurious and do not indicate a real problem. It'd also be possible the fix the problem with a one line-fix, just dropping this line:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/2ae7cf8ef5be67e085abc1b1dc71bc44865a71b3/src/wallet/wallet.cpp#L1698",
      "created_at" : "2018-01-26T18:25:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-360864576",
      "id" : 360864576,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12275",
      "updated_at" : "2018-01-26T18:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/360864576",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12275#discussion_r179381559"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12275"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/179381559"
         }
      },
      "author_association" : "OWNER",
      "body" : "can be static",
      "commit_id" : "d3b58f0cfb853aae3640bae7a833bbd58384cb7d",
      "created_at" : "2018-04-05T08:13:45Z",
      "diff_hunk" : "@@ -1625,31 +1625,44 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n     }\n \n     if (startBlock) {\n-        const CBlockIndex* const failedBlock = ScanForWalletTransactions(startBlock, nullptr, reserver, update);\n+        const CBlockIndex* const failedBlock = ScanForWalletTransactions(startBlock, nullptr, reserver, update).last_failed;\n         if (failedBlock) {\n             return failedBlock->GetBlockTimeMax() + TIMESTAMP_WINDOW + 1;\n         }\n     }\n     return startTime;\n }\n \n+void UpdateResult(CWallet::ScanResult& result, const CBlockIndex& block, bool failed)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#discussion_r179381559",
      "id" : 179381559,
      "original_commit_id" : "d3b58f0cfb853aae3640bae7a833bbd58384cb7d",
      "original_position" : 13,
      "path" : "src/wallet/wallet.cpp",
      "position" : 13,
      "pull_request_review_id" : 109612794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12275",
      "updated_at" : "2018-04-05T08:13:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/179381559",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "> Return more information about scan status from ScanForWalletTransactions and\r\ntry to describe the return value more clearly.\r\n\r\nWhere is this extra return information (intended to) be used?\r\n\r\n> Edit: have you considered keeping the return value but adding a CWallet::ScanResult* scan_result = nullptr parameter?\r\n\r\nI prefer returning a tuple or structure to that kind of quasi out-args.",
      "created_at" : "2018-04-05T08:18:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-378856550",
      "id" : 378856550,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12275",
      "updated_at" : "2018-04-05T08:18:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378856550",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just want to call out the PR I just opened, #13076, which conflicts with this in that it returns true or false for success or failure (inspired by #11450). An alternative is to return an object like this PR, in which case I would include a few more fields:\r\n* completed\r\n* aborted",
      "created_at" : "2018-04-25T23:52:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-384468958",
      "id" : 384468958,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12275",
      "updated_at" : "2018-04-25T23:54:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384468958",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "In either case, I would bias toward only returning values that are used by the callers and add other fields as needed, in the spirit of YAGNI.",
      "created_at" : "2018-04-25T23:55:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-384469447",
      "id" : 384469447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12275",
      "updated_at" : "2018-04-25T23:55:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384469447",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, will close. Regarding YAGNI, I was using the returned status to implement a retry loop in scanfortime which would handle reorgs, but I dropped that commit because I figured incomplete rescans were probably harmless with regular block notifications enabled.",
      "created_at" : "2018-04-26T00:13:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-384472336",
      "id" : 384472336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12275",
      "updated_at" : "2018-04-26T00:13:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384472336",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
