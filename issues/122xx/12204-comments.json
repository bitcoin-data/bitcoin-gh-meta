[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161864379"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161864379"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe put \"block\" in front of blocks being named by number. (and everywhere else)\r\n\r\nI was reading it as the the height in coinbase aka the number 176,684 in the block's coinbase at height 490,897.",
      "commit_id" : "3f3b9913107ab59610e733c25e871206d3980656",
      "created_at" : "2018-01-16T19:37:21Z",
      "diff_hunk" : "@@ -1858,12 +1858,58 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n+\n+    // The exception to this logic is if there are coinbases from blocks before\n+    // the BIP34 height of 227,931 which have a scriptSig with a valid-looking\n+    // BIP34 height for a later block height. These coinbases run the risk of\n+    // being duplicated when we reach that later block height. An exhaustive\n+    // search of all mainnet coinbases before the BIP34 height which have a\n+    // scriptSig indicating a later block height reveals 2 cases where the later\n+    // block height is before 1,983,702.\n+\n+    // There are many cases which indicate block height 1,983,702 or later, so\n+    // we simply remove the optimiztion to skip BIP30 checking for blocks at\n+    // height 1,983,702 or higher.  Before we reach that block in another 25\n+    // years or so, we should take advantage of a future consensus change to do\n+    // a new and improved version of BIP34 that will actually prevent ever\n+    // creating any duplicate coinbases in the future.\n+\n+    // The first earlier case is block 209,920 and the indicated height is\n+    // 209,921, so we do not need to be concerned with this case because 209,921\n+    // is under the BIP34 height and so BIP30 is active already.\n+\n+    // The second case is block 176,684 which has an indicated block height of\n+    // 490,897. Unfortunately this issue was not discovered until about 2 weeks\n+    // before block 490,897 so there was not much opportunity to address this\n+    // case other than to carefully analyze it and determine it would not be a\n+    // problem. Block 490,897 was, in fact, mined with a different coinbase\n+    // than 176,684, but it is important to note that even if it hadn't",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161864379",
      "id" : 161864379,
      "original_commit_id" : "9ab7fe0b3f50b2cc3514975b26eb7c63134bdd40",
      "original_position" : 29,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 89222376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204",
      "updated_at" : "2018-01-25T16:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161864379",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161875402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161875402"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is the significance of 1,938,702 just that it is the third lowest height found encoded in the old coinbases? The sentence doesn't say where 1,938,702 comes from, and this is written like it should be obvious what the number means.\r\n\r\nIf it is just the third lowest height found in the search, I think it would be clearer to say something like \"An exhaustive search of all blocks before the BIP34 height found that the lowest height values indicated in coinbase scriptSigs were: 209,921, 490,897, and 1,983,702.\"",
      "commit_id" : "3f3b9913107ab59610e733c25e871206d3980656",
      "created_at" : "2018-01-16T20:20:29Z",
      "diff_hunk" : "@@ -1858,12 +1858,58 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n+\n+    // The exception to this logic is if there are coinbases from blocks before\n+    // the BIP34 height of 227,931 which have a scriptSig with a valid-looking\n+    // BIP34 height for a later block height. These coinbases run the risk of\n+    // being duplicated when we reach that later block height. An exhaustive\n+    // search of all mainnet coinbases before the BIP34 height which have a\n+    // scriptSig indicating a later block height reveals 2 cases where the later\n+    // block height is before 1,983,702.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161875402",
      "id" : 161875402,
      "original_commit_id" : "9ab7fe0b3f50b2cc3514975b26eb7c63134bdd40",
      "original_position" : 11,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 89235281,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204",
      "updated_at" : "2018-01-25T16:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161875402",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161886460"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161886460"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Rather than start your new comment explaining where the previous comment is incorrect, I think it makes sense to remove/reword the paragraph above.\r\n\r\nI also think it would make the whole comment clearer if you explicitly introduced terminology at the top of the comment. Something like:\r\n\r\n```\r\n- block height: the height of the block in the blockchain\r\n- coinbase height: the height indicated in the coinbase transaction's scriptSig under BIP34 rules.\r\n\r\nAll blocks with block height >= 227,931 must have coinbase height equal to block height. This is a consensus rule.\r\n```\r\nrather than sprinkling the rest of the comment with multiple terms for the same concept: `a scriptSig with a valid-looking BIP34 height...`, `scriptSig indicating...`, `indicated block height`, `coinbase with indicated height`.",
      "commit_id" : "3f3b9913107ab59610e733c25e871206d3980656",
      "created_at" : "2018-01-16T21:07:27Z",
      "diff_hunk" : "@@ -1858,12 +1858,58 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n+\n+    // The exception to this logic is if there are coinbases from blocks before",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161886460",
      "id" : 161886460,
      "original_commit_id" : "9ab7fe0b3f50b2cc3514975b26eb7c63134bdd40",
      "original_position" : 5,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 89248523,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204",
      "updated_at" : "2018-01-25T16:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161886460",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161935352"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161935352"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "typo: optimization",
      "commit_id" : "3f3b9913107ab59610e733c25e871206d3980656",
      "created_at" : "2018-01-17T01:26:13Z",
      "diff_hunk" : "@@ -1858,12 +1858,58 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n+\n+    // The exception to this logic is if there are coinbases from blocks before\n+    // the BIP34 height of 227,931 which have a scriptSig with a valid-looking\n+    // BIP34 height for a later block height. These coinbases run the risk of\n+    // being duplicated when we reach that later block height. An exhaustive\n+    // search of all mainnet coinbases before the BIP34 height which have a\n+    // scriptSig indicating a later block height reveals 2 cases where the later\n+    // block height is before 1,983,702.\n+\n+    // There are many cases which indicate block height 1,983,702 or later, so\n+    // we simply remove the optimiztion to skip BIP30 checking for blocks at",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161935352",
      "id" : 161935352,
      "original_commit_id" : "9ab7fe0b3f50b2cc3514975b26eb7c63134bdd40",
      "original_position" : 14,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 89304860,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204",
      "updated_at" : "2018-01-25T16:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161935352",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2018-01-17T11:32:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-358277892",
      "id" : 358277892,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-01-17T11:32:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358277892",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Though, I have never checked if any of the heights or hashes make sense. Wouldn't it help review if #6931 or this pull actually included the code that was used to determine those magic numbers?",
      "created_at" : "2018-01-18T23:49:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-358820635",
      "id" : 358820635,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-01-18T23:49:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358820635",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My analysis matches yours exactly. The pre-BIP34 blocks with coinbase height > block height are (in ascending order):\r\n\r\nblock_height | coinbase_height\r\n209920 | 209921\r\n176684 | 490897\r\n164384 | 1983702\r\n169895 | 3708179 **<---- I expect to be dead before this height**\r\n....\r\n\r\nso you're right that the only heights that we should care about are 209921, 490897 and 1983702.",
      "created_at" : "2018-01-19T22:25:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-359106628",
      "id" : 359106628,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-01-19T22:25:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359106628",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If anyone wants to re-run the analysis, the gist with my code is here: https://gist.github.com/jnewbery/df0a98f3d2fea52e487001bf2b9ef1fd\r\n\r\n(this is quite slow since it's hitting the RPC interface 3 times for each block. It'd be faster to deserialize block files directly, patch bitcoind to print this data itself, or use BlockSci or a similar block analysis tool)",
      "created_at" : "2018-01-19T22:44:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-359110595",
      "id" : 359110595,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-01-19T22:44:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359110595",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "code utACK, haven't actually read through the whole comment.\r\n\r\nI agree with the above analysis that block 1983702 is the lowest block height that we need to worry about. We could soft fork in something prior to that block to guarantee that the txids will be different, e.g. block height in the nLockTime field.",
      "created_at" : "2018-01-20T06:06:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-359148679",
      "id" : 359148679,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-01-20T06:06:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359148679",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Comment updated to hopefully be clearer.  Code unchanged.\r\n\r\nFor reference here is how I double checked the possible violations.  I patched bitcoind with this snippet and then ran with -reindex-chainstate.\r\n```\r\n@@ -1724,6 +1724,16 @@ static bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockInd\r\n                 }\r\n             }\r\n         }\r\n+        if (block.vtx[0]->vin[0].scriptSig.size() >= 4 && block.vtx[0]->vin[0].scriptSig[0] == 3) {\r\n+            std::vector<unsigned char> vch;\r\n+            for (int i=1;i<4;i++)\r\n+                vch.push_back( block.vtx[0]->vin[0].scriptSig[i]);\r\n+            CScriptNum height(vch,false);\r\n+            int height_indicated = height.getint();\r\n+            if (height_indicated > pindex->nHeight) {\r\n+                fprintf(stdout,\"Potential future duplicate: block %d has indicated height %d\\n\",pindex->nHeight,height_indicated);\r\n+            }\r\n+        }\r\n     }\r\n \r\n     // Start enforcing BIP68 (sequence locks) and BIP112 (CHECKSEQUENCEVERIFY) using versionbits logic.\r\n```",
      "created_at" : "2018-01-25T16:28:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-360520343",
      "id" : 360520343,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-01-25T16:28:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/360520343",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r163895211"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163895211"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it is useful to understand the basic logic that BIP 34 implies BIP 30 is met and doesn't need to be checked.  But then understand why it's not quite that simple.  It also matches the historical evolution of the code.  So I left this comment as correction to the previous one.",
      "commit_id" : "3f3b9913107ab59610e733c25e871206d3980656",
      "created_at" : "2018-01-25T16:30:01Z",
      "diff_hunk" : "@@ -1858,12 +1858,58 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n+\n+    // The exception to this logic is if there are coinbases from blocks before",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r163895211",
      "id" : 163895211,
      "in_reply_to_id" : 161886460,
      "original_commit_id" : "9ab7fe0b3f50b2cc3514975b26eb7c63134bdd40",
      "original_position" : 5,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 91584258,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204",
      "updated_at" : "2018-01-25T16:30:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163895211",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested ACK 3f3b991",
      "created_at" : "2018-01-26T19:16:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-360878031",
      "id" : 360878031,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-01-26T19:16:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/360878031",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Looks sensible to me. Although I think we should definitely make this a chain parameter, or at least define a constant, instead of hardcoding this magic number:\r\n```\r\nOptional TODO: Have BIP30 checking activate at a per chain block height.\r\n```\r\nI don't think we're in enough of a hurry here to skip that.",
      "created_at" : "2018-02-08T15:48:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-364153444",
      "id" : 364153444,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-02-08T15:48:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/364153444",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj I'm happy to define it as a constant locally, but it seems like adding it as a chain parameter just adds unnecessary cruft to the code.  This is such an obscure (and irrelevant for decades) element of the consensus that it seems better to keep it entirely contained to one spot in the code base, so it doesn't occupy mental energy in other places.   That said, will defer to your judgement...\r\n\r\nEDIT: Or if we think testnet3 will get longer than 1.9 million blocks, then I suppose that's an argument for per chain so we don't do unnecessary calculations on testnet3.",
      "created_at" : "2018-02-15T15:04:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-365954055",
      "id" : 365954055,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-02-15T15:15:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/365954055",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Nono I'm OK with that, but if we actively argue against making it a chain parameter we should remove the TODO as well, otherwise it's inviting someone else to make that change. My only point is that there is no hurry to merge this, so no reason to leave unfinished TODOs in the code.",
      "created_at" : "2018-02-15T18:01:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-366010582",
      "id" : 366010582,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-02-15T18:02:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/366010582",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "updated to a constant and removed optional TODO, I believe its better to keep this mess contained to one section of the code",
      "created_at" : "2018-02-15T18:35:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-366020268",
      "id" : 366020268,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-02-15T18:35:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/366020268",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/12204/commits/5b8b387752e8c493a8e87795ae6ddb78b45b1a5d",
      "created_at" : "2018-02-15T18:44:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-366022787",
      "id" : 366022787,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-02-15T18:44:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/366022787",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 5b8b387752e8c493a8e87795ae6ddb78b45b1a5d\r\n\r\nDifference is that there is now a `constexpr int BIP34_IMPLIES_BIP30_LIMIT` and the comment has been updated.\r\n\r\nTravis failed because of a timeout. I'll kick it.",
      "created_at" : "2018-02-16T14:49:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-366255483",
      "id" : 366255483,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-02-16T14:49:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/366255483",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK",
      "created_at" : "2018-03-07T14:11:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#issuecomment-371149920",
      "id" : 371149920,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12204",
      "updated_at" : "2018-03-07T14:11:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/371149920",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   }
]
