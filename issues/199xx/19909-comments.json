[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Mind elaborating \"useless calls\" in fa947ccbd4579c866760b3b2a032bd3765043835 \"validation: Remove useless call to mempool->clear()\"?",
      "created_at" : "2020-09-07T15:42:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-688400759",
      "id" : 688400759,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODQwMDc1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T15:42:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688400759",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The `mempool.clear()` in `UnloadBlockIndex` has been added in commit 51598b26319bf1ee98b399dee8152b902c62891a to clear global state between unit tests. Now that there is no global mempool anymore, this it not needed anymore. Also, I couldn't find it to be useful for anything else.",
      "created_at" : "2020-09-07T15:59:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-688409592",
      "id" : 688409592,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODQwOTU5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T15:59:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688409592",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r484874230"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484874230"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What is the difference between clearing and just instantiating a new mempool?",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2020-09-08T12:23:54Z",
      "diff_hunk" : "@@ -761,7 +762,7 @@ BOOST_AUTO_TEST_CASE(MempoolAncestryTests)\n     tb = make_tx(/* output_values */ {5 * COIN, 3 * COIN}, /* inputs */  {ta});\n     tc = make_tx(/* output_values */ {2 * COIN}, /* inputs */ {tb}, /* input_indices */ {1});\n     td = make_tx(/* output_values */ {6 * COIN}, /* inputs */ {tb, tc}, /* input_indices */ {0, 0});\n-    pool.clear();\n+    pool.clearTxs();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r484874230",
      "id" : 484874230,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDg3NDIzMA==",
      "original_commit_id" : "fa0fbb3e5ef0f029224c5cacb6bab82da14b2809",
      "original_line" : 765,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/mempool_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 484078548,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484874230/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-28T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484874230",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-09-08T12:24:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-688831736",
      "id" : 688831736,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODgzMTczNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T12:24:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688831736",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r484931399"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484931399"
         }
      },
      "author_association" : "MEMBER",
      "body" : "May I suggest to name this struct more generally, say `TxMemPoolTesting`, as it seems more functions could be added to it.\r\nE.g., a special version of `GetTransactionAncestry()` that requires external `CTxMemPool::cs` locking, see https://github.com/bitcoin/bitcoin/pull/19872#discussion_r484841181.",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2020-09-08T13:44:04Z",
      "diff_hunk" : "@@ -0,0 +1,23 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_TEST_UTIL_TXMEMPOOL_H\n+#define BITCOIN_TEST_UTIL_TXMEMPOOL_H\n+\n+#include <txmempool.h>\n+\n+struct TxMemPoolClearable : public CTxMemPool {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r484931399",
      "id" : 484931399,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDkzMTM5OQ==",
      "original_commit_id" : "fad3a7c5b9118d4d190401c0fbbd3e2068dffadc",
      "original_line" : 10,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/test/util/txmempool.h",
      "position" : null,
      "pull_request_review_id" : 484154121,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484931399/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-28T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484931399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485095479"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485095479"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ignore all above. It won't work.",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2020-09-08T17:50:24Z",
      "diff_hunk" : "@@ -0,0 +1,23 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_TEST_UTIL_TXMEMPOOL_H\n+#define BITCOIN_TEST_UTIL_TXMEMPOOL_H\n+\n+#include <txmempool.h>\n+\n+struct TxMemPoolClearable : public CTxMemPool {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485095479",
      "id" : 485095479,
      "in_reply_to_id" : 484931399,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA5NTQ3OQ==",
      "original_commit_id" : "fad3a7c5b9118d4d190401c0fbbd3e2068dffadc",
      "original_line" : 10,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/test/util/txmempool.h",
      "position" : null,
      "pull_request_review_id" : 484366626,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485095479/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-28T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485095479",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Wrt to preserving recursive locking of `CTxMemPool::cs` mind considering the following patch:\r\n```diff\r\n--- a/src/test/txvalidationcache_tests.cpp\r\n+++ b/src/test/txvalidationcache_tests.cpp\r\n@@ -73,7 +73,7 @@ BOOST_FIXTURE_TEST_CASE(tx_mempool_block_doublespend, TestChain100Setup)\r\n         LOCK(cs_main);\r\n         BOOST_CHECK(::ChainActive().Tip()->GetBlockHash() != block.GetHash());\r\n     }\r\n-    tx_pool.clearTxs();\r\n+    WITH_LOCK(tx_pool.cs, tx_pool.clearTxs());\r\n \r\n     // Test 3: ... and should be rejected if spend2 is in the memory pool\r\n     BOOST_CHECK(ToMemPool(spends[1]));\r\n@@ -82,7 +82,7 @@ BOOST_FIXTURE_TEST_CASE(tx_mempool_block_doublespend, TestChain100Setup)\r\n         LOCK(cs_main);\r\n         BOOST_CHECK(::ChainActive().Tip()->GetBlockHash() != block.GetHash());\r\n     }\r\n-    tx_pool.clearTxs();\r\n+    WITH_LOCK(tx_pool.cs, tx_pool.clearTxs());\r\n \r\n     // Final sanity test: first spend in tx_pool, second in block, that's OK:\r\n     std::vector<CMutableTransaction> oneSpend;\r\ndiff --git a/src/test/util/txmempool.h b/src/test/util/txmempool.h\r\nindex 7edc6d607..db52377b0 100644\r\n--- a/src/test/util/txmempool.h\r\n+++ b/src/test/util/txmempool.h\r\n@@ -9,9 +9,9 @@\r\n \r\n struct TxMemPoolClearable : public CTxMemPool {\r\n     /** Clear added transactions */\r\n-    void clearTxs()\r\n+    void clearTxs() EXCLUSIVE_LOCKS_REQUIRED(cs)\r\n     {\r\n-        LOCK(cs);\r\n+        AssertLockHeld(cs);\r\n         mapTx.clear();\r\n         mapNextTx.clear();\r\n         totalTxSize = 0;\r\n```\r\n?",
      "created_at" : "2020-09-08T17:52:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-689038928",
      "id" : 689038928,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4OTAzODkyOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-08T17:52:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/689038928",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485162533"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485162533"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No difference. Though, a new mempool needs the old `cs` released and the fresh `cs`  taken, so would be a bit more code ",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2020-09-08T19:57:53Z",
      "diff_hunk" : "@@ -761,7 +762,7 @@ BOOST_AUTO_TEST_CASE(MempoolAncestryTests)\n     tb = make_tx(/* output_values */ {5 * COIN, 3 * COIN}, /* inputs */  {ta});\n     tc = make_tx(/* output_values */ {2 * COIN}, /* inputs */ {tb}, /* input_indices */ {1});\n     td = make_tx(/* output_values */ {6 * COIN}, /* inputs */ {tb, tc}, /* input_indices */ {0, 0});\n-    pool.clear();\n+    pool.clearTxs();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485162533",
      "id" : 485162533,
      "in_reply_to_id" : 484874230,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTE2MjUzMw==",
      "original_commit_id" : "fa0fbb3e5ef0f029224c5cacb6bab82da14b2809",
      "original_line" : 765,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/mempool_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 484450602,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 2,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485162533/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-28T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485162533",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485206081"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485206081"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> needs the old `cs` released\r\n\r\nWhy?",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2020-09-08T21:28:19Z",
      "diff_hunk" : "@@ -761,7 +762,7 @@ BOOST_AUTO_TEST_CASE(MempoolAncestryTests)\n     tb = make_tx(/* output_values */ {5 * COIN, 3 * COIN}, /* inputs */  {ta});\n     tc = make_tx(/* output_values */ {2 * COIN}, /* inputs */ {tb}, /* input_indices */ {1});\n     td = make_tx(/* output_values */ {6 * COIN}, /* inputs */ {tb, tc}, /* input_indices */ {0, 0});\n-    pool.clear();\n+    pool.clearTxs();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485206081",
      "id" : 485206081,
      "in_reply_to_id" : 484874230,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIwNjA4MQ==",
      "original_commit_id" : "fa0fbb3e5ef0f029224c5cacb6bab82da14b2809",
      "original_line" : 765,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/mempool_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 484505153,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485206081/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-28T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485206081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485510249"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485510249"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok, it is not needed if the scope of `pool` is kept the same. Though, it is still a larger diff to instantiate a new mempool `pool2`, lock it and replace `pool` with `pool2`. Happy to do whatever reviewers want, so let me know if I should keep this or change it.",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2020-09-09T10:34:40Z",
      "diff_hunk" : "@@ -761,7 +762,7 @@ BOOST_AUTO_TEST_CASE(MempoolAncestryTests)\n     tb = make_tx(/* output_values */ {5 * COIN, 3 * COIN}, /* inputs */  {ta});\n     tc = make_tx(/* output_values */ {2 * COIN}, /* inputs */ {tb}, /* input_indices */ {1});\n     td = make_tx(/* output_values */ {6 * COIN}, /* inputs */ {tb, tc}, /* input_indices */ {0, 0});\n-    pool.clear();\n+    pool.clearTxs();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485510249",
      "id" : 485510249,
      "in_reply_to_id" : 484874230,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTUxMDI0OQ==",
      "original_commit_id" : "fa0fbb3e5ef0f029224c5cacb6bab82da14b2809",
      "original_line" : 765,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/mempool_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 484876407,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485510249/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-28T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485510249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485512067"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485512067"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I was just asking. It doesn't need to be a big change, something like:\r\n```\r\n{\r\nCTxMemPool pool;\r\n// ...\r\n}\r\n\r\n{\r\nCTxMemPool pool;\r\n// ...\r\n}\r\n```",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2020-09-09T10:38:04Z",
      "diff_hunk" : "@@ -761,7 +762,7 @@ BOOST_AUTO_TEST_CASE(MempoolAncestryTests)\n     tb = make_tx(/* output_values */ {5 * COIN, 3 * COIN}, /* inputs */  {ta});\n     tc = make_tx(/* output_values */ {2 * COIN}, /* inputs */ {tb}, /* input_indices */ {1});\n     td = make_tx(/* output_values */ {6 * COIN}, /* inputs */ {tb, tc}, /* input_indices */ {0, 0});\n-    pool.clear();\n+    pool.clearTxs();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485512067",
      "id" : 485512067,
      "in_reply_to_id" : 484874230,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTUxMjA2Nw==",
      "original_commit_id" : "fa0fbb3e5ef0f029224c5cacb6bab82da14b2809",
      "original_line" : 765,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/mempool_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 484878707,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485512067/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-28T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485512067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@hebasto It hasn't been decided for the project whether to switch the mempool.cs to non-recursive mutex, nor in what way to do it, so I'll leave that test patch for later.",
      "created_at" : "2020-09-09T10:42:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-689479582",
      "id" : 689479582,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4OTQ3OTU4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-09T10:42:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/689479582",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Force pushed to add explanation to commit body. No other changes",
      "created_at" : "2020-09-09T10:42:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-689479824",
      "id" : 689479824,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4OTQ3OTgyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-09T10:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/689479824",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485640893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485640893"
         }
      },
      "author_association" : "MEMBER",
      "body" : "thx, fixed",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2020-09-09T14:07:52Z",
      "diff_hunk" : "@@ -761,7 +762,7 @@ BOOST_AUTO_TEST_CASE(MempoolAncestryTests)\n     tb = make_tx(/* output_values */ {5 * COIN, 3 * COIN}, /* inputs */  {ta});\n     tc = make_tx(/* output_values */ {2 * COIN}, /* inputs */ {tb}, /* input_indices */ {1});\n     td = make_tx(/* output_values */ {6 * COIN}, /* inputs */ {tb, tc}, /* input_indices */ {0, 0});\n-    pool.clear();\n+    pool.clearTxs();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r485640893",
      "id" : 485640893,
      "in_reply_to_id" : 484874230,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTY0MDg5Mw==",
      "original_commit_id" : "fa0fbb3e5ef0f029224c5cacb6bab82da14b2809",
      "original_line" : 765,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/mempool_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 485047559,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485640893/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-28T19:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485640893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm not very familiar with these tests, so I may be completely off the mark here. However, it seems to me like the purpose of `clearTxs` is to reset the mempool without re-instantiating it. I wonder if we shouldn't consider just re-instantiating the mempool every time we want to clear it, as:\r\n\r\n1. If there were a performance penalty, it wouldn't matter too much as it's in the test code\r\n2. We wouldn't have to have the burden of keeping `TxMemPoolClearable::clearTxs()` and `CTxMemPool` in sync.",
      "created_at" : "2020-09-10T16:48:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-690489819",
      "id" : 690489819,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDQ4OTgxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T17:07:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690489819",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@dongcarl This was also my idea in the discussion here, but there wasn't really a decision: https://github.com/bitcoin/bitcoin/pull/19909#discussion_r484874230\r\n",
      "created_at" : "2020-09-10T16:59:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-690512698",
      "id" : 690512698,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDUxMjY5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T16:59:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690512698",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The `mempool.clear()` in `UnloadBlockIndex` has been added in commit [51598b2](https://github.com/bitcoin/bitcoin/commit/51598b26319bf1ee98b399dee8152b902c62891a) to clear global state between unit tests. Now that there is no global mempool anymore, this it not needed anymore. Also, I couldn't find it to be useful for anything else.\r\n\r\nDoes the call to `UnloadBlockIndex` here: https://github.com/bitcoin/bitcoin/blob/a47e5964861dfb98d61719c9852e12fd6da84c31/src/init.cpp#L1562\r\nMake any difference to the `mempool` that we should keep in mind?",
      "created_at" : "2020-09-10T18:07:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-690589581",
      "id" : 690589581,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDU4OTU4MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T18:07:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690589581",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is this refactor important to other work?  Having the ability to clear the mempool seems useful to me; even though we've never exposed it, I could imagine some situations where invoking the clear() function somehow (say via rpc) might be useful.\r\n\r\nAlternatively -- and even more speculatively -- in thinking about how we update the mempool after a reorg, I've wondered if there might be solutions where clearing the mempool and re-adding things back might be better in some scenarios.\r\n\r\nI don't think either of those is pressing though so if there's some good reason to get rid of it to help with other work in progress, then that's fine with me, we can always revisit the right design if the functionality I suggest might actually be useful.   Just not sure if this might be wasted effort, if there's no important reason or followup work motivating this change?",
      "created_at" : "2020-09-10T23:47:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-690789590",
      "id" : 690789590,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDc4OTU5MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T23:47:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690789590",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think you have a point there @sdaftuar. I'm not sure in how far it's here the case (there is no standard definition of the expectation for a \"mempool interface\"), but in some cases some methods just belong in an API (say, add/lookup/delete in a table) even if they're temporarily not used, and going over the top to clean APIs to the minimum set can make future changes harder.",
      "created_at" : "2020-09-11T13:48:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-691106337",
      "id" : 691106337,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MTEwNjMzNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-11T13:48:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691106337",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24538](https://github.com/bitcoin/bitcoin/pull/24538) (miner: bug fix? update for ancestor inclusion using modified fees, not base by glozow)\n* [#23897](https://github.com/bitcoin/bitcoin/pull/23897) (refactor: Move calculation logic out from `CheckSequenceLocksAtTip()` by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-09-19T13:47:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-695215625",
      "id" : 695215625,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTIxNTYyNQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695215625/reactions"
      },
      "updated_at" : "2022-04-29T07:29:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695215625",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The `clear` method as currently implemented doesn't help with implementing a RPC that clears the mempool, because it also clears the fee estimates. If the method is kept, it should be renamed to `ReInit` (or similar), because all it does is (re-)initialize the member variables of the mempool.\r\n\r\nThough, according to our release notes, member variables should be initialized inline via C++11 initializers to avoid uninitialized values. (This is what is being done in this pull)\r\n\r\nAlso, I can not imagine a single use case where clearing the whole mempool over RPC is useful. At most sniping a single tx might be useful. Though even that has been rejected at least twice in the past. Please refer to #15873 and #16523.",
      "created_at" : "2020-09-19T14:25:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-695219766",
      "id" : 695219766,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTIxOTc2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-19T14:25:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695219766",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If youâre a miner, I could imagine it is possible that clearing the mempool could be helpful in the event of a dos-attack where pathological transaction chains (for example) cause block template creation to be very slow. So a use case could be to empty it and use other rpcs to manually refill it.\r\n\r\nThatâs just an example, and I donât know if it is likely weâd support that anytime soon, but I could imagine the use case.\r\n\r\n(Your point about fee estimation is a reasonable one, but I believe there is work happening elsewhere to decouple that from the mempool? )\r\n\r\nAt any rate I donât feel strongly about this, if removing this function is helpful for other work I am not opposed either.",
      "created_at" : "2020-09-19T15:15:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-695248403",
      "id" : 695248403,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTI0ODQwMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-19T15:15:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695248403",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-09-23T20:26:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-697953920",
      "id" : 697953920,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5Nzk1MzkyMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-23T20:26:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/697953920",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased, but I'll revisit this some other day",
      "created_at" : "2020-09-28T19:31:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-700236813",
      "id" : 700236813,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDIzNjgxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-28T19:31:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700236813",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Removing test-only code from the product is generally useful. Partly because it reduces the complexity of interfaces, reduces the binary size, etc, but more so because relying on test-only code paths increases the risk that the test logic diverges from the live logic. For example, if some initialization code was added to the mempool constructor, but not `clear()`, and tests assume that a call to `clear()` gives a completely freshly initialized mempool, then the test setup is not testing what we want it to.",
      "created_at" : "2020-10-30T08:24:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-719405245",
      "id" : 719405245,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxOTQwNTI0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-30T08:24:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/719405245",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK for the reasons @jnewbery mentioned.",
      "created_at" : "2020-10-30T12:52:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-719534550",
      "id" : 719534550,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxOTUzNDU1MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-30T12:52:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/719534550",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">> I wonder if we shouldn't consider just re-instantiating the mempool every time we want to clear it, as:\r\n\r\n> @dongcarl This was also my idea in the discussion here, but there wasn't really a decision: https://github.com/bitcoin/bitcoin/pull/19909#discussion_r484874230\r\n\r\n@MarcoFalke did you consider this approach? On the face of it, it seems better to reinstantiate a mempool every time you want to clear it rather than having custom test code to reach into the object's members.",
      "created_at" : "2022-04-29T07:47:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-1112975773",
      "id" : 1112975773,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "IC_kwDOABII585CVqmd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1112975773/reactions"
      },
      "updated_at" : "2022-04-29T07:47:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1112975773",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yeah, I'll look into this. First part of that is #25024",
      "created_at" : "2022-04-29T08:14:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-1113008597",
      "id" : 1113008597,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "IC_kwDOABII585CVynV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113008597/reactions"
      },
      "updated_at" : "2022-04-29T08:14:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113008597",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In reply to Suhas point that the clear method could be used to wipe the txs for example during a reorg or by a miner to speed up block template creation: I am still doubtful that this method can actually achieve this goal, as it also resets other members of mempool. I think it would be sufficient and clearer to just use the existing removeRecursive functionality of the mempool to wipe all txs?",
      "created_at" : "2022-04-29T08:26:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-1113017495",
      "id" : 1113017495,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "IC_kwDOABII585CV0yX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113017495/reactions"
      },
      "updated_at" : "2022-04-29T08:26:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113017495",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-04-29T12:04:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-1113235121",
      "id" : 1113235121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "IC_kwDOABII585CWp6x",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113235121/reactions"
      },
      "updated_at" : "2022-04-29T12:04:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113235121",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2022-10-10T14:04:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-1273365421",
      "id" : 1273365421,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
      "node_id" : "IC_kwDOABII585L5gOt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1273365421/reactions"
      },
      "updated_at" : "2022-10-10T14:04:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1273365421",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r1045917771"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045917771"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Question: is there a reason you are calling `removeRecursive()` instead of the approach from #25073 / https://github.com/bitcoin/bitcoin/pull/19909#issuecomment-1112975773 of instantiating a new mempool between test cases?",
      "commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "created_at" : "2022-12-12T14:45:14Z",
      "diff_hunk" : "@@ -77,7 +77,9 @@ BOOST_FIXTURE_TEST_CASE(tx_mempool_block_doublespend, Dersig100Setup)\n         LOCK(cs_main);\n         BOOST_CHECK(m_node.chainman->ActiveChain().Tip()->GetBlockHash() != block.GetHash());\n     }\n-    m_node.mempool->clear();\n+    BOOST_CHECK_EQUAL(m_node.mempool->size(), 1U);\n+    WITH_LOCK(m_node.mempool->cs, m_node.mempool->removeRecursive(CTransaction{spends[0]}, MemPoolRemovalReason::CONFLICT));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r1045917771",
      "id" : 1045917771,
      "line" : 81,
      "node_id" : "PRRC_kwDOABII584-V3BL",
      "original_commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "original_line" : 81,
      "original_position" : 6,
      "original_start_line" : 80,
      "path" : "src/test/txvalidationcache_tests.cpp",
      "position" : 6,
      "pull_request_review_id" : 1213716776,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045917771/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 80,
      "start_side" : "LEFT",
      "updated_at" : "2022-12-12T14:46:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1045917771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r1047084030"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047084030"
         }
      },
      "author_association" : "MEMBER",
      "body" : "25073 is using a mempool local to the test only (and passing it to the miner). However, here the \"global\" mempool is used, which is also used by validation. So creating a new mempool would also require updating the pointer in validation.\r\n\r\nI don't think this is worth it, but I am happy to work on this, if reviewers want me to.",
      "commit_id" : "fa818e103c0ddb515f29ae9ce8de44931e12e69e",
      "created_at" : "2022-12-13T12:19:09Z",
      "diff_hunk" : "@@ -77,7 +77,9 @@ BOOST_FIXTURE_TEST_CASE(tx_mempool_block_doublespend, Dersig100Setup)\n         LOCK(cs_main);\n         BOOST_CHECK(m_node.chainman->ActiveChain().Tip()->GetBlockHash() != block.GetHash());\n     }\n-    m_node.mempool->clear();\n+    BOOST_CHECK_EQUAL(m_node.mempool->size(), 1U);\n+    WITH_LOCK(m_node.mempool->cs, m_node.mempool->removeRecursive(CTransaction{spends[0]}, MemPoolRemovalReason::CONFLICT));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19909#discussion_r1047084030",
      "id" : 1047084030,
      "in_reply_to_id" : 1045917771,
      "line" : 81,
      "node_id" : "PRRC_kwDOABII584-aTv-",
      "original_commit_id" : "fa299b39eebc1cdbf465496c14e08f2744554492",
      "original_line" : 81,
      "original_position" : 6,
      "original_start_line" : 80,
      "path" : "src/test/txvalidationcache_tests.cpp",
      "position" : 6,
      "pull_request_review_id" : 1215359761,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047084030/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 80,
      "start_side" : "LEFT",
      "updated_at" : "2022-12-13T12:19:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1047084030",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
