[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489433313"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/489433313"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: s/forward/forwards",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-16T13:23:47Z",
      "diff_hunk" : "@@ -74,6 +73,10 @@ def run_test(self):\n \n         self.log.info('Check that the tx from forcerelay first_peer is relayed to others (ie.second_peer)')\n         with self.nodes[0].assert_debug_log([\"received getdata\"]):\n+            # NB: in practice, first_peer would never send us transactions since we're a blocksonly node.\n+            # But if first_peer runs a modified version of Bitcoin Core to bypass relay checks and forward",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489433313",
      "id" : 489433313,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQzMzMxMw==",
      "original_commit_id" : "e483b06187635b209eef32fca7711e4e9999dc8d",
      "original_line" : 77,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 489619949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/489433313",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489539109"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/489539109"
         }
      },
      "author_association" : "NONE",
      "body" : "My thinking was that `forward` was going in pair with `bypass` (both infinitive), but I'm not a native speaker, I can definitely apply that.",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-16T15:43:03Z",
      "diff_hunk" : "@@ -74,6 +73,10 @@ def run_test(self):\n \n         self.log.info('Check that the tx from forcerelay first_peer is relayed to others (ie.second_peer)')\n         with self.nodes[0].assert_debug_log([\"received getdata\"]):\n+            # NB: in practice, first_peer would never send us transactions since we're a blocksonly node.\n+            # But if first_peer runs a modified version of Bitcoin Core to bypass relay checks and forward",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489539109",
      "id" : 489539109,
      "in_reply_to_id" : 489433313,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUzOTEwOQ==",
      "original_commit_id" : "e483b06187635b209eef32fca7711e4e9999dc8d",
      "original_line" : 77,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 489760088,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/489539109",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489544220"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/489544220"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah first_peer is running a modified version of Bitcoin Core to bypass relay checks. Once it has done that the first_peer forwards the transactions. But as I said I don't think we are fussy on grammar for comments on this project and I wouldn't want to put people like you off from adding comments in future! So feel free to leave it. We'll see if Gleb has more substantial suggestions.",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-16T15:50:21Z",
      "diff_hunk" : "@@ -74,6 +73,10 @@ def run_test(self):\n \n         self.log.info('Check that the tx from forcerelay first_peer is relayed to others (ie.second_peer)')\n         with self.nodes[0].assert_debug_log([\"received getdata\"]):\n+            # NB: in practice, first_peer would never send us transactions since we're a blocksonly node.\n+            # But if first_peer runs a modified version of Bitcoin Core to bypass relay checks and forward",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489544220",
      "id" : 489544220,
      "in_reply_to_id" : 489433313,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU0NDIyMA==",
      "original_commit_id" : "e483b06187635b209eef32fca7711e4e9999dc8d",
      "original_line" : 77,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 489766814,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/489544220",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "1. What's \"NB\"?\r\n2. This part of the test is confusing in the first place: it should have nothing to do with \"forcerelay\". It's about \"relay\" permission. It works just because \"forcerelay\" enables \"relay\" permission automatically. Can you modify this chunk of the test to talk about \"relay\"?\r\n3. I would prefer to expand the following description: \"first_peer would never send us transactions since we're a blocksonly node.\". Say that we tell them we don't need transactions, so Bitcoin Core node would adhere to this suggestion and not send us transactions. And normally we'd disconnect them (unless we enabled \"relay\" permission, see next)\r\n4. Also expand this: \"But if first_peer runs a modified version of Bitcoin Core to bypass relay checks\" -> something along the lines \"if, for some reason, first_peer decides to relay transactions to us, we should relay them forward per RELAY permission we assigned to first_peer\".",
      "created_at" : "2020-09-17T07:14:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-694018515",
      "id" : 694018515,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19963",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NDAxODUxNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-17T07:14:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694018515",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Done, let me know if that's better.",
      "created_at" : "2020-09-17T13:26:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-694231737",
      "id" : 694231737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19963",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NDIzMTczNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-17T13:26:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694231737",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r490864501"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490864501"
         }
      },
      "author_association" : "MEMBER",
      "body" : "\"Forcerelay' clearly meant a peer with FORCERELAY permission.\r\nNow that you call it \"relay\", it's not clear it's about permissions, because we commonly use \"relay\" in many contexts. I would prefer \"RELAY-whitelisted\" or something like that hereinafter.",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-18T10:51:23Z",
      "diff_hunk" : "@@ -56,33 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from relay peers are not rejected and relayed to others')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r490864501",
      "id" : 490864501,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg2NDUwMQ==",
      "original_commit_id" : "7d5cf26e9998854afdc54e436dfa6e7d07b7642f",
      "original_line" : 59,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 491354946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490864501",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Still no idea what's \"NB\" :)\r\nOtherwise looks good if you see my new suggestion.",
      "created_at" : "2020-09-18T10:52:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-694799575",
      "id" : 694799575,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19963",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NDc5OTU3NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-18T10:52:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694799575",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r490876098"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490876098"
         }
      },
      "author_association" : "NONE",
      "body" : "You're right, that was confusing. Fixed in https://github.com/bitcoin/bitcoin/pull/19963/commits/3abe9f866c17fb4fde623d410d59f269b673645f",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-18T11:14:11Z",
      "diff_hunk" : "@@ -56,33 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from relay peers are not rejected and relayed to others')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r490876098",
      "id" : 490876098,
      "in_reply_to_id" : 490864501,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg3NjA5OA==",
      "original_commit_id" : "7d5cf26e9998854afdc54e436dfa6e7d07b7642f",
      "original_line" : 59,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 491369817,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/490876098",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Still no idea what's \"NB\" :)\r\n\r\nHeh, it's \"Nota Bene\", we probably use that latin abbreviation too often in France :)",
      "created_at" : "2020-09-18T11:15:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-694808699",
      "id" : 694808699,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19963",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NDgwODY5OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-18T11:15:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694808699",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19770 (RPC: getpeerinfo: Deprecate \"whitelisted\" field (replaced by \"permissions\") by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-09-19T13:27:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-695213506",
      "id" : 695213506,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19963",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTIxMzUwNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-19T13:27:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695213506",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662392"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491662392"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can't this be written shorter as:\r\n\r\n```suggestion\r\n        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=relay@127.0.0.1\", \"-blocksonly\"])\r\n```",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-20T07:16:10Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistrelay\", \"-blocksonly\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662392",
      "id" : 491662392,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY2MjM5Mg==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 62,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492177632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491662392",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662468"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491662468"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        self.log.info('Check that txs from peers with relay-permission are not rejected and relayed to others')\r\n```\r\n\r\nWould prefer to use lowercase (identical to the flag name for the whitelist setting)",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-20T07:17:09Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662468",
      "id" : 491662468,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY2MjQ2OA==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 59,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492177632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491662468",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491662547"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think pep-8 wants two lines here",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-20T07:18:33Z",
      "diff_hunk" : "@@ -9,7 +9,6 @@\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import assert_equal\n \n-",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662547",
      "id" : 491662547,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY2MjU0Nw==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 12,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492177632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491662547",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816153"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491816153"
         }
      },
      "author_association" : "NONE",
      "body" : "Done",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T06:30:37Z",
      "diff_hunk" : "@@ -9,7 +9,6 @@\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import assert_equal\n \n-",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816153",
      "id" : 491816153,
      "in_reply_to_id" : 491662547,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxNjE1Mw==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 12,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492305658,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491816153",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816213"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491816213"
         }
      },
      "author_association" : "NONE",
      "body" : "Done",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T06:30:45Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816213",
      "id" : 491816213,
      "in_reply_to_id" : 491662468,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxNjIxMw==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 59,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492305719,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491816213",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816448"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491816448"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I agree with Marco even though it was my suggestion to use the uppercase.\r\nWe definitely use lowercase for permissions, I was just referring to the enum, which has less prio in this case.",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T06:31:24Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816448",
      "id" : 491816448,
      "in_reply_to_id" : 491662468,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxNjQ0OA==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 59,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492306100,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491816448",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "We normally don't commit \"fixup fixup\" like that, so please squash into 1 commit after you address marco's comments :)",
      "created_at" : "2020-09-21T06:31:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-695927451",
      "id" : 695927451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19963",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTkyNzQ1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-21T06:31:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695927451",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816767"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491816767"
         }
      },
      "author_association" : "NONE",
      "body" : "I thought so too, but interestingly it doesn't work.\r\nWhen setting `whitelist=relay@127.0.0.1` and doing a `getpeerinfo`, the `permissions` are correctly set to `relay`, but `whitelisted` is set to `false`...",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T06:32:20Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistrelay\", \"-blocksonly\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816767",
      "id" : 491816767,
      "in_reply_to_id" : 491662392,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxNjc2Nw==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 62,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492307127,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491816767",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491825386"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491825386"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`whitelisted` is there for backward compatibility only:\r\n`// If this flag is present, the user probably expect that RPC and QT report it as whitelisted (backward compatibility)`.\r\n\r\nYour test should still work even after marco's suggestion? You just have to update the following stuff too: drop the legacy `assert_equal(peer_1_info['whitelisted'], True)` stuff",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T06:56:44Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistrelay\", \"-blocksonly\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491825386",
      "id" : 491825386,
      "in_reply_to_id" : 491662392,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgyNTM4Ng==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 62,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492317948,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491825386",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491825482"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491825482"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(I'm fine keeping it as is too)",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T06:57:03Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistrelay\", \"-blocksonly\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491825482",
      "id" : 491825482,
      "in_reply_to_id" : 491662392,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgyNTQ4Mg==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 62,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492318092,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491825482",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491826298"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491826298"
         }
      },
      "author_association" : "NONE",
      "body" : "Great, thanks for the explanation, the rest of the test indeed works fine once changed.\r\nI'll remove that check if that is a deprecated flag, it can be misleading for newcomers.",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T06:59:22Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistrelay\", \"-blocksonly\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491826298",
      "id" : 491826298,
      "in_reply_to_id" : 491662392,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgyNjI5OA==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 62,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492319184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491826298",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491827031"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491827031"
         }
      },
      "author_association" : "NONE",
      "body" : "Done in https://github.com/bitcoin/bitcoin/pull/19963/commits/f59681ecc422bbfe32d470ef96bbd25199ec14d0",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T07:01:15Z",
      "diff_hunk" : "@@ -57,29 +56,35 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from RELAY-whitelisted peers are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistrelay\", \"-blocksonly\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491827031",
      "id" : 491827031,
      "in_reply_to_id" : 491662392,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgyNzAzMQ==",
      "original_commit_id" : "3abe9f866c17fb4fde623d410d59f269b673645f",
      "original_line" : 62,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492320107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491827031",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491838231"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491838231"
         }
      },
      "author_association" : "MEMBER",
      "body" : "still uppercase :)",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T07:28:16Z",
      "diff_hunk" : "@@ -57,29 +57,33 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from peers with relay-permission are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=relay@127.0.0.1\", \"-blocksonly\"])\n         assert_equal(self.nodes[0].getrawmempool(), [])\n         first_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n         second_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n         peer_1_info = self.nodes[0].getpeerinfo()[0]\n-        assert_equal(peer_1_info['whitelisted'], True)\n-        assert_equal(peer_1_info['permissions'], ['noban', 'forcerelay', 'relay', 'mempool', 'download'])\n+        assert_equal(peer_1_info['permissions'], ['relay'])\n         peer_2_info = self.nodes[0].getpeerinfo()[1]\n-        assert_equal(peer_2_info['whitelisted'], True)\n-        assert_equal(peer_2_info['permissions'], ['noban', 'forcerelay', 'relay', 'mempool', 'download'])\n+        assert_equal(peer_2_info['permissions'], ['relay'])\n         assert_equal(self.nodes[0].testmempoolaccept([sigtx])[0]['allowed'], True)\n         txid = self.nodes[0].testmempoolaccept([sigtx])[0]['txid']\n \n-        self.log.info('Check that the tx from forcerelay first_peer is relayed to others (ie.second_peer)')\n+        self.log.info('Check that the tx from first_peer with relay-permission is relayed to others (ie.second_peer)')\n         with self.nodes[0].assert_debug_log([\"received getdata\"]):\n+            # Note that normally, first_peer would never send us transactions since we're a blocksonly node.\n+            # By activating blocksonly, we explicitly tell our peers that they should not send us transactions,\n+            # and Bitcoin Core respects that choice and will not send transactions.\n+            # But if, for some reason, first_peer decides to relay transactions to us anyway, we should relay them to\n+            # second_peer since we gave RELAY permission to first_peer.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491838231",
      "id" : 491838231,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgzODIzMQ==",
      "original_commit_id" : "f59681ecc422bbfe32d470ef96bbd25199ec14d0",
      "original_line" : 79,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492334638,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491838231",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491848035"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491848035"
         }
      },
      "author_association" : "NONE",
      "body" : "Woops sorry, fixed in https://github.com/bitcoin/bitcoin/pull/19963/commits/a44ad7cfbe8ba89edfb7642e72d1938413021ed5",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T07:48:05Z",
      "diff_hunk" : "@@ -57,29 +57,33 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from peers with relay-permission are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=relay@127.0.0.1\", \"-blocksonly\"])\n         assert_equal(self.nodes[0].getrawmempool(), [])\n         first_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n         second_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n         peer_1_info = self.nodes[0].getpeerinfo()[0]\n-        assert_equal(peer_1_info['whitelisted'], True)\n-        assert_equal(peer_1_info['permissions'], ['noban', 'forcerelay', 'relay', 'mempool', 'download'])\n+        assert_equal(peer_1_info['permissions'], ['relay'])\n         peer_2_info = self.nodes[0].getpeerinfo()[1]\n-        assert_equal(peer_2_info['whitelisted'], True)\n-        assert_equal(peer_2_info['permissions'], ['noban', 'forcerelay', 'relay', 'mempool', 'download'])\n+        assert_equal(peer_2_info['permissions'], ['relay'])\n         assert_equal(self.nodes[0].testmempoolaccept([sigtx])[0]['allowed'], True)\n         txid = self.nodes[0].testmempoolaccept([sigtx])[0]['txid']\n \n-        self.log.info('Check that the tx from forcerelay first_peer is relayed to others (ie.second_peer)')\n+        self.log.info('Check that the tx from first_peer with relay-permission is relayed to others (ie.second_peer)')\n         with self.nodes[0].assert_debug_log([\"received getdata\"]):\n+            # Note that normally, first_peer would never send us transactions since we're a blocksonly node.\n+            # By activating blocksonly, we explicitly tell our peers that they should not send us transactions,\n+            # and Bitcoin Core respects that choice and will not send transactions.\n+            # But if, for some reason, first_peer decides to relay transactions to us anyway, we should relay them to\n+            # second_peer since we gave RELAY permission to first_peer.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491848035",
      "id" : 491848035,
      "in_reply_to_id" : 491838231,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg0ODAzNQ==",
      "original_commit_id" : "f59681ecc422bbfe32d470ef96bbd25199ec14d0",
      "original_line" : 79,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492347364,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491848035",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491855142"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491855142"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ready to ack, please squash :)",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T08:01:45Z",
      "diff_hunk" : "@@ -57,29 +57,33 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from peers with relay-permission are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=relay@127.0.0.1\", \"-blocksonly\"])\n         assert_equal(self.nodes[0].getrawmempool(), [])\n         first_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n         second_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n         peer_1_info = self.nodes[0].getpeerinfo()[0]\n-        assert_equal(peer_1_info['whitelisted'], True)\n-        assert_equal(peer_1_info['permissions'], ['noban', 'forcerelay', 'relay', 'mempool', 'download'])\n+        assert_equal(peer_1_info['permissions'], ['relay'])\n         peer_2_info = self.nodes[0].getpeerinfo()[1]\n-        assert_equal(peer_2_info['whitelisted'], True)\n-        assert_equal(peer_2_info['permissions'], ['noban', 'forcerelay', 'relay', 'mempool', 'download'])\n+        assert_equal(peer_2_info['permissions'], ['relay'])\n         assert_equal(self.nodes[0].testmempoolaccept([sigtx])[0]['allowed'], True)\n         txid = self.nodes[0].testmempoolaccept([sigtx])[0]['txid']\n \n-        self.log.info('Check that the tx from forcerelay first_peer is relayed to others (ie.second_peer)')\n+        self.log.info('Check that the tx from first_peer with relay-permission is relayed to others (ie.second_peer)')\n         with self.nodes[0].assert_debug_log([\"received getdata\"]):\n+            # Note that normally, first_peer would never send us transactions since we're a blocksonly node.\n+            # By activating blocksonly, we explicitly tell our peers that they should not send us transactions,\n+            # and Bitcoin Core respects that choice and will not send transactions.\n+            # But if, for some reason, first_peer decides to relay transactions to us anyway, we should relay them to\n+            # second_peer since we gave RELAY permission to first_peer.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491855142",
      "id" : 491855142,
      "in_reply_to_id" : 491838231,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg1NTE0Mg==",
      "original_commit_id" : "f59681ecc422bbfe32d470ef96bbd25199ec14d0",
      "original_line" : 79,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492356522,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491855142",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491862922"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491862922"
         }
      },
      "author_association" : "NONE",
      "body" : "Done!",
      "commit_id" : "e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T08:16:53Z",
      "diff_hunk" : "@@ -57,29 +57,33 @@ def run_test(self):\n             self.nodes[0].p2p.wait_for_tx(txid)\n             assert_equal(self.nodes[0].getmempoolinfo()['size'], 1)\n \n-        self.log.info('Check that txs from forcerelay peers are not rejected and relayed to others')\n-        self.log.info(\"Restarting node 0 with forcerelay permission and blocksonly\")\n-        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=127.0.0.1\", \"-whitelistforcerelay\", \"-blocksonly\"])\n+        self.log.info('Check that txs from peers with relay-permission are not rejected and relayed to others')\n+        self.log.info(\"Restarting node 0 with relay permission and blocksonly\")\n+        self.restart_node(0, [\"-persistmempool=0\", \"-whitelist=relay@127.0.0.1\", \"-blocksonly\"])\n         assert_equal(self.nodes[0].getrawmempool(), [])\n         first_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n         second_peer = self.nodes[0].add_p2p_connection(P2PInterface())\n         peer_1_info = self.nodes[0].getpeerinfo()[0]\n-        assert_equal(peer_1_info['whitelisted'], True)\n-        assert_equal(peer_1_info['permissions'], ['noban', 'forcerelay', 'relay', 'mempool', 'download'])\n+        assert_equal(peer_1_info['permissions'], ['relay'])\n         peer_2_info = self.nodes[0].getpeerinfo()[1]\n-        assert_equal(peer_2_info['whitelisted'], True)\n-        assert_equal(peer_2_info['permissions'], ['noban', 'forcerelay', 'relay', 'mempool', 'download'])\n+        assert_equal(peer_2_info['permissions'], ['relay'])\n         assert_equal(self.nodes[0].testmempoolaccept([sigtx])[0]['allowed'], True)\n         txid = self.nodes[0].testmempoolaccept([sigtx])[0]['txid']\n \n-        self.log.info('Check that the tx from forcerelay first_peer is relayed to others (ie.second_peer)')\n+        self.log.info('Check that the tx from first_peer with relay-permission is relayed to others (ie.second_peer)')\n         with self.nodes[0].assert_debug_log([\"received getdata\"]):\n+            # Note that normally, first_peer would never send us transactions since we're a blocksonly node.\n+            # By activating blocksonly, we explicitly tell our peers that they should not send us transactions,\n+            # and Bitcoin Core respects that choice and will not send transactions.\n+            # But if, for some reason, first_peer decides to relay transactions to us anyway, we should relay them to\n+            # second_peer since we gave RELAY permission to first_peer.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491862922",
      "id" : 491862922,
      "in_reply_to_id" : 491838231,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg2MjkyMg==",
      "original_commit_id" : "f59681ecc422bbfe32d470ef96bbd25199ec14d0",
      "original_line" : 79,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/p2p_blocksonly.py",
      "position" : null,
      "pull_request_review_id" : 492367035,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19963",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-21T08:16:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/491862922",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK e15344889aac50aadee9211ac34e466867d5862b",
      "created_at" : "2020-09-21T09:16:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-695997691",
      "id" : 695997691,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19963",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTk5NzY5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-21T09:16:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695997691",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   }
]
