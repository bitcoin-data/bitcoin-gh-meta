[
   {
      "body" : "Very cool. I went to go make some random suggestions but found you implemented them already. I'll give this more review soon.",
      "created_at" : "2014-08-14T22:06:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-52251508",
      "id" : 52251508,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-08-14T22:06:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52251508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16630227"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16630227"
         }
      },
      "body" : "Nit: \"Prune old blocks\" may be an easier explanation for the flag.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-23T11:28:20Z",
      "diff_hunk" : "@@ -225,6 +225,7 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += \"  -maxorphanblocks=<n>   \" + strprintf(_(\"Keep at most <n> unconnectable blocks in memory (default: %u)\"), DEFAULT_MAX_ORPHAN_BLOCKS) + \"\\n\";\n     strUsage += \"  -par=<n>               \" + strprintf(_(\"Set the number of script verification threads (%u to %d, 0 = auto, <0 = leave that many cores free, default: %d)\"), -(int)boost::thread::hardware_concurrency(), MAX_SCRIPTCHECK_THREADS, DEFAULT_SCRIPTCHECK_THREADS) + \"\\n\";\n     strUsage += \"  -pid=<file>            \" + _(\"Specify pid file (default: bitcoind.pid)\") + \"\\n\";\n+    strUsage += \"  -pruned                \" + _(\"Run in a pruned state\") + \"\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16630227",
      "id" : 16630227,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16630227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16630232"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16630232"
         }
      },
      "body" : "I think you should disconnect such peers (for their sake) rather than just ignoring. ",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-23T11:31:04Z",
      "diff_hunk" : "@@ -3424,30 +3517,37 @@ void static ProcessGetData(CNode* pfrom)\n                 {\n                     // Send block from disk\n                     CBlock block;\n-                    if (!ReadBlockFromDisk(block, (*mi).second))\n-                        assert(!\"cannot load block from disk\");\n-                    if (inv.type == MSG_BLOCK)\n-                        pfrom->PushMessage(\"block\", block);\n-                    else // MSG_FILTERED_BLOCK)\n-                    {\n-                        LOCK(pfrom->cs_filter);\n-                        if (pfrom->pfilter)\n-                        {\n-                            CMerkleBlock merkleBlock(block, *pfrom->pfilter);\n-                            pfrom->PushMessage(\"merkleblock\", merkleBlock);\n-                            // CMerkleBlock just contains hashes, so also push any transactions in the block the client did not see\n-                            // This avoids hurting performance by pointlessly requiring a round-trip\n-                            // Note that there is currently no way for a node to request any single transactions we didnt send here -\n-                            // they must either disconnect and retry or request the full block.\n-                            // Thus, the protocol spec specified allows for us to provide duplicate txn here,\n-                            // however we MUST always provide at least what the remote peer needs\n-                            typedef std::pair<unsigned int, uint256> PairType;\n-                            BOOST_FOREACH(PairType& pair, merkleBlock.vMatchedTxn)\n-                                if (!pfrom->setInventoryKnown.count(CInv(MSG_TX, pair.second)))\n-                                    pfrom->PushMessage(\"tx\", block.vtx[pair.first]);\n+                    if (!ReadBlockFromDisk(block, (*mi).second)) {\n+                        if (fPruned) {\n+                            // Ignore requests which ask us for blocks we don't have any more\n+                            // Peers shouldn't ask, anyway, as we unset NODE_NETWORK on this mode.\n+                            LogPrintf(\"cannot load block from disk, ignoring request from peer=%d\\n\", pfrom->id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16630232",
      "id" : 16630232,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 207,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16630232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16633181"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16633181"
         }
      },
      "body" : "Actually, I might just always InitError here. Its not obvious that -pruned will disable wallet from the explanation given and it may be overly confusing.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-23T23:00:44Z",
      "diff_hunk" : "@@ -582,6 +583,15 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+#ifdef ENABLE_WALLET\n+    if ((GetBoolArg(\"-pruned\", false)) && !GetBoolArg(\"-disablewallet\", false)) {\n+        if (SoftSetBoolArg(\"-disablewallet\", true))\n+            LogPrintf(\"AppInit2 : parameter interaction: -pruned=1 -> setting -disablewallet=1\\n\");\n+        else\n+            return InitError(_(\"Can't run with a wallet in pruned mode.\"));\n+    }\n+#endif",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16633181",
      "id" : 16633181,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 19,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16633181",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16633202"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16633202"
         }
      },
      "body" : "Should probably warn of the destructive nature of -pruned?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-23T23:05:47Z",
      "diff_hunk" : "@@ -950,6 +961,14 @@ bool AppInit2(boost::thread_group& threadGroup)\n                     break;\n                 }\n \n+                if (!CheckAndPruneBlockFiles()) {\n+                    if (!fPruned)\n+                        strLoadError = _(\"Error checking required block files. You might try to run in -pruned mode, or try to rebuild the block database\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16633202",
      "id" : 16633202,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 38,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16633202",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16633209"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16633209"
         }
      },
      "body" : "Maybe this should be configurable? -pruned 500 to keep all blocks in the main chain at height 500+ vs -pruned -500 to keep the last 500?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-23T23:08:11Z",
      "diff_hunk" : "@@ -2997,7 +2996,101 @@ bool static LoadBlockIndexDB()\n         chainActive.Tip()->GetBlockHash().ToString(), chainActive.Height(),\n         DateTimeStrFormat(\"%Y-%m-%d %H:%M:%S\", chainActive.Tip()->GetBlockTime()),\n         Checkpoints::GuessVerificationProgress(chainActive.Tip()));\n+    \n+    return true;\n+}\n \n+bool CheckAndPruneBlockFiles()\n+{\n+    // Check presence of essential data\n+    int nKeepBlksFromHeight = fPruned ? (max((int)(chainActive.Height() - MIN_BLOCKS_TO_KEEP), 0)) : 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16633209",
      "id" : 16633209,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 87,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16633209",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16633217"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16633217"
         }
      },
      "body" : "Why not?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-23T23:09:08Z",
      "diff_hunk" : "@@ -582,6 +583,15 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+#ifdef ENABLE_WALLET\n+    if ((GetBoolArg(\"-pruned\", false)) && !GetBoolArg(\"-disablewallet\", false)) {\n+        if (SoftSetBoolArg(\"-disablewallet\", true))\n+            LogPrintf(\"AppInit2 : parameter interaction: -pruned=1 -> setting -disablewallet=1\\n\");\n+        else\n+            return InitError(_(\"Can't run with a wallet in pruned mode.\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16633217",
      "id" : 16633217,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 17,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16633217",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "luke: wrt pruning depth, probably what would be good eventually is a size target and then the software can make use of the size target usefully... but I don't know that it makes sense at this point since we don't yet have a good way to make use of a sparse blockchain. ",
      "created_at" : "2014-08-24T00:30:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-53172016",
      "id" : 53172016,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-08-24T00:30:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/53172016",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "We have to use it for reorgs. Setting a default prune depth is probably dangerous enough to becoming an (inconsistent) consensus rule already.",
      "created_at" : "2014-08-24T01:00:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-53172814",
      "id" : 53172814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-08-24T01:00:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/53172814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "By sparse I mean containing any blocks other than the last N. If you'll note, the number 288 above comes from my comments on the prior PR as a minimum number I'd consider acceptable as an absolute minimum for the purpose of reorgs.",
      "created_at" : "2014-08-24T01:12:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-53173114",
      "id" : 53173114,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-08-24T01:12:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/53173114",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16637955"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16637955"
         }
      },
      "body" : "Because otherwise people can very easily shoot themselves in the foot by plugging in an old wallet which silently fails rescanning, getting in an inconsistent state.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-24T20:59:03Z",
      "diff_hunk" : "@@ -582,6 +583,15 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+#ifdef ENABLE_WALLET\n+    if ((GetBoolArg(\"-pruned\", false)) && !GetBoolArg(\"-disablewallet\", false)) {\n+        if (SoftSetBoolArg(\"-disablewallet\", true))\n+            LogPrintf(\"AppInit2 : parameter interaction: -pruned=1 -> setting -disablewallet=1\\n\");\n+        else\n+            return InitError(_(\"Can't run with a wallet in pruned mode.\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16637955",
      "id" : 16637955,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 17,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16637955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16638034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16638034"
         }
      },
      "body" : "Could just fail if it needs a rescan...",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-24T21:11:31Z",
      "diff_hunk" : "@@ -582,6 +583,15 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+#ifdef ENABLE_WALLET\n+    if ((GetBoolArg(\"-pruned\", false)) && !GetBoolArg(\"-disablewallet\", false)) {\n+        if (SoftSetBoolArg(\"-disablewallet\", true))\n+            LogPrintf(\"AppInit2 : parameter interaction: -pruned=1 -> setting -disablewallet=1\\n\");\n+        else\n+            return InitError(_(\"Can't run with a wallet in pruned mode.\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16638034",
      "id" : 16638034,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 17,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16638034",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16638252"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16638252"
         }
      },
      "body" : "Yeah, but I would better leave that for another pull, when such a case has been more extensively tested.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-24T22:05:44Z",
      "diff_hunk" : "@@ -582,6 +583,15 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+#ifdef ENABLE_WALLET\n+    if ((GetBoolArg(\"-pruned\", false)) && !GetBoolArg(\"-disablewallet\", false)) {\n+        if (SoftSetBoolArg(\"-disablewallet\", true))\n+            LogPrintf(\"AppInit2 : parameter interaction: -pruned=1 -> setting -disablewallet=1\\n\");\n+        else\n+            return InitError(_(\"Can't run with a wallet in pruned mode.\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16638252",
      "id" : 16638252,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 17,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16638252",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16638259"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16638259"
         }
      },
      "body" : "A proper explanation has been added.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-24T22:07:01Z",
      "diff_hunk" : "@@ -582,6 +583,15 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+#ifdef ENABLE_WALLET\n+    if ((GetBoolArg(\"-pruned\", false)) && !GetBoolArg(\"-disablewallet\", false)) {\n+        if (SoftSetBoolArg(\"-disablewallet\", true))\n+            LogPrintf(\"AppInit2 : parameter interaction: -pruned=1 -> setting -disablewallet=1\\n\");\n+        else\n+            return InitError(_(\"Can't run with a wallet in pruned mode.\"));\n+    }\n+#endif",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16638259",
      "id" : 16638259,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 19,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16638259",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16638263"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16638263"
         }
      },
      "body" : "Added rejection and disconnection.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-24T22:07:53Z",
      "diff_hunk" : "@@ -3424,30 +3517,37 @@ void static ProcessGetData(CNode* pfrom)\n                 {\n                     // Send block from disk\n                     CBlock block;\n-                    if (!ReadBlockFromDisk(block, (*mi).second))\n-                        assert(!\"cannot load block from disk\");\n-                    if (inv.type == MSG_BLOCK)\n-                        pfrom->PushMessage(\"block\", block);\n-                    else // MSG_FILTERED_BLOCK)\n-                    {\n-                        LOCK(pfrom->cs_filter);\n-                        if (pfrom->pfilter)\n-                        {\n-                            CMerkleBlock merkleBlock(block, *pfrom->pfilter);\n-                            pfrom->PushMessage(\"merkleblock\", merkleBlock);\n-                            // CMerkleBlock just contains hashes, so also push any transactions in the block the client did not see\n-                            // This avoids hurting performance by pointlessly requiring a round-trip\n-                            // Note that there is currently no way for a node to request any single transactions we didnt send here -\n-                            // they must either disconnect and retry or request the full block.\n-                            // Thus, the protocol spec specified allows for us to provide duplicate txn here,\n-                            // however we MUST always provide at least what the remote peer needs\n-                            typedef std::pair<unsigned int, uint256> PairType;\n-                            BOOST_FOREACH(PairType& pair, merkleBlock.vMatchedTxn)\n-                                if (!pfrom->setInventoryKnown.count(CInv(MSG_TX, pair.second)))\n-                                    pfrom->PushMessage(\"tx\", block.vtx[pair.first]);\n+                    if (!ReadBlockFromDisk(block, (*mi).second)) {\n+                        if (fPruned) {\n+                            // Ignore requests which ask us for blocks we don't have any more\n+                            // Peers shouldn't ask, anyway, as we unset NODE_NETWORK on this mode.\n+                            LogPrintf(\"cannot load block from disk, ignoring request from peer=%d\\n\", pfrom->id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16638263",
      "id" : 16638263,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 207,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16638263",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16715734"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16715734"
         }
      },
      "body" : "Nit: no need for the intermediate variable.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-26T14:19:55Z",
      "diff_hunk" : "@@ -2881,11 +2884,17 @@ bool CheckDiskSpace(uint64_t nAdditionalBytes)\n     return true;\n }\n \n+boost::filesystem::path GetBlockFilePath(const CDiskBlockPos &pos, const char *prefix)\n+{\n+    boost::filesystem::path path = GetDataDir() / \"blocks\" / strprintf(\"%s%05u.dat\", prefix, pos.nFile);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16715734",
      "id" : 16715734,
      "original_commit_id" : "8ba326b852d06556d7bcf8cced20ba9c9e5a00f2",
      "original_position" : 23,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16715734",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16715809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16715809"
         }
      },
      "body" : "No need for the ? true : false.\r\nboost::filesystem::remove already returns a bool.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-26T14:21:14Z",
      "diff_hunk" : "@@ -2912,6 +2921,14 @@ FILE* OpenUndoFile(const CDiskBlockPos &pos, bool fReadOnly) {\n     return OpenDiskFile(pos, \"rev\", fReadOnly);\n }\n \n+bool RemoveBlockFile(const CDiskBlockPos &pos) {\n+    return boost::filesystem::remove(GetBlockFilePath(pos, \"blk\")) ? true : false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16715809",
      "id" : 16715809,
      "original_commit_id" : "8ba326b852d06556d7bcf8cced20ba9c9e5a00f2",
      "original_position" : 41,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16715809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16715816"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16715816"
         }
      },
      "body" : "Same.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-26T14:21:20Z",
      "diff_hunk" : "@@ -2912,6 +2921,14 @@ FILE* OpenUndoFile(const CDiskBlockPos &pos, bool fReadOnly) {\n     return OpenDiskFile(pos, \"rev\", fReadOnly);\n }\n \n+bool RemoveBlockFile(const CDiskBlockPos &pos) {\n+    return boost::filesystem::remove(GetBlockFilePath(pos, \"blk\")) ? true : false;\n+}\n+\n+bool RemoveUndoFile(const CDiskBlockPos &pos) {\n+    return boost::filesystem::remove(GetBlockFilePath(pos, \"rev\")) ? true : false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16715816",
      "id" : 16715816,
      "original_commit_id" : "8ba326b852d06556d7bcf8cced20ba9c9e5a00f2",
      "original_position" : 45,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16715816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16716273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16716273"
         }
      },
      "body" : "disconnecting",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-26T14:27:22Z",
      "diff_hunk" : "@@ -3430,30 +3523,39 @@ void static ProcessGetData(CNode* pfrom)\n                 {\n                     // Send block from disk\n                     CBlock block;\n-                    if (!ReadBlockFromDisk(block, (*mi).second))\n-                        assert(!\"cannot load block from disk\");\n-                    if (inv.type == MSG_BLOCK)\n-                        pfrom->PushMessage(\"block\", block);\n-                    else // MSG_FILTERED_BLOCK)\n-                    {\n-                        LOCK(pfrom->cs_filter);\n-                        if (pfrom->pfilter)\n-                        {\n-                            CMerkleBlock merkleBlock(block, *pfrom->pfilter);\n-                            pfrom->PushMessage(\"merkleblock\", merkleBlock);\n-                            // CMerkleBlock just contains hashes, so also push any transactions in the block the client did not see\n-                            // This avoids hurting performance by pointlessly requiring a round-trip\n-                            // Note that there is currently no way for a node to request any single transactions we didnt send here -\n-                            // they must either disconnect and retry or request the full block.\n-                            // Thus, the protocol spec specified allows for us to provide duplicate txn here,\n-                            // however we MUST always provide at least what the remote peer needs\n-                            typedef std::pair<unsigned int, uint256> PairType;\n-                            BOOST_FOREACH(PairType& pair, merkleBlock.vMatchedTxn)\n-                                if (!pfrom->setInventoryKnown.count(CInv(MSG_TX, pair.second)))\n-                                    pfrom->PushMessage(\"tx\", block.vtx[pair.first]);\n+                    if (!ReadBlockFromDisk(block, (*mi).second)) {\n+                        if (fPruned) {\n+                            // Reject requests and disconnect peers asking us for blocks we don't have.\n+                            // Doing so we avoid stalling their IBD but they shouldn't ask as we unset NODE_NETWORK on this mode.\n+                            LogPrintf(\"cannot load block from disk, rejecting request and disconnectiong peer:%d\\n\", pfrom->id);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16716273",
      "id" : 16716273,
      "original_commit_id" : "8ba326b852d06556d7bcf8cced20ba9c9e5a00f2",
      "original_position" : 207,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16716273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16716332"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16716332"
         }
      },
      "body" : "mapBlkDataFileReadable[pindex->nFile] = false;\r\n\r\netc",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-26T14:28:14Z",
      "diff_hunk" : "@@ -3003,7 +3002,101 @@ bool static LoadBlockIndexDB()\n         chainActive.Tip()->GetBlockHash().ToString(), chainActive.Height(),\n         DateTimeStrFormat(\"%Y-%m-%d %H:%M:%S\", chainActive.Tip()->GetBlockTime()),\n         Checkpoints::GuessVerificationProgress(chainActive.Tip()));\n+    \n+    return true;\n+}\n \n+bool CheckAndPruneBlockFiles()\n+{\n+    // Check presence of essential data\n+    int nKeepBlksFromHeight = fPruned ? (max((int)(chainActive.Height() - MIN_BLOCKS_TO_KEEP), 0)) : 0;\n+    LogPrintf(\"Checking all required data for active chain is available (mandatory from height %i to %i)\\n\", nKeepBlksFromHeight, max(chainActive.Height(), 0));\n+    map<int, bool> mapBlkDataFileReadable,mapBlkUndoFileReadable;\n+    set<int> setBlockDataPruned,setBlockUndoPruned;\n+    for (CBlockIndex* pindex = chainActive.Tip() ; pindex && pindex->pprev ; pindex = pindex->pprev) {\n+        CDiskBlockPos pos(pindex->nFile, 0);\n+        CBlockFileInfo info;\n+        if (pindex->nStatus & BLOCK_HAVE_DATA) {\n+            if (!mapBlkDataFileReadable.count(pindex->nFile)) {\n+                if (CAutoFile(OpenBlockFile(pos, true), SER_DISK, CLIENT_VERSION)) {\n+                    pblocktree->ReadBlockFileInfo(pindex->nFile, info);\n+                    if (chainActive.Height() > AUTOPRUNE_AFTER_HEIGHT && (int)info.nHeightLast < nKeepBlksFromHeight) {\n+                        if (RemoveBlockFile(pos)) {\n+                            LogPrintf(\"File blk%05u.dat removed\\n\", pindex->nFile);\n+                            mapBlkDataFileReadable.insert(make_pair(pindex->nFile, false));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16716332",
      "id" : 16716332,
      "original_commit_id" : "8ba326b852d06556d7bcf8cced20ba9c9e5a00f2",
      "original_position" : 101,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16716332",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16716412"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16716412"
         }
      },
      "body" : "notfound message instead of reject?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-08-26T14:29:13Z",
      "diff_hunk" : "@@ -3430,30 +3523,39 @@ void static ProcessGetData(CNode* pfrom)\n                 {\n                     // Send block from disk\n                     CBlock block;\n-                    if (!ReadBlockFromDisk(block, (*mi).second))\n-                        assert(!\"cannot load block from disk\");\n-                    if (inv.type == MSG_BLOCK)\n-                        pfrom->PushMessage(\"block\", block);\n-                    else // MSG_FILTERED_BLOCK)\n-                    {\n-                        LOCK(pfrom->cs_filter);\n-                        if (pfrom->pfilter)\n-                        {\n-                            CMerkleBlock merkleBlock(block, *pfrom->pfilter);\n-                            pfrom->PushMessage(\"merkleblock\", merkleBlock);\n-                            // CMerkleBlock just contains hashes, so also push any transactions in the block the client did not see\n-                            // This avoids hurting performance by pointlessly requiring a round-trip\n-                            // Note that there is currently no way for a node to request any single transactions we didnt send here -\n-                            // they must either disconnect and retry or request the full block.\n-                            // Thus, the protocol spec specified allows for us to provide duplicate txn here,\n-                            // however we MUST always provide at least what the remote peer needs\n-                            typedef std::pair<unsigned int, uint256> PairType;\n-                            BOOST_FOREACH(PairType& pair, merkleBlock.vMatchedTxn)\n-                                if (!pfrom->setInventoryKnown.count(CInv(MSG_TX, pair.second)))\n-                                    pfrom->PushMessage(\"tx\", block.vtx[pair.first]);\n+                    if (!ReadBlockFromDisk(block, (*mi).second)) {\n+                        if (fPruned) {\n+                            // Reject requests and disconnect peers asking us for blocks we don't have.\n+                            // Doing so we avoid stalling their IBD but they shouldn't ask as we unset NODE_NETWORK on this mode.\n+                            LogPrintf(\"cannot load block from disk, rejecting request and disconnectiong peer:%d\\n\", pfrom->id);\n+                            pfrom->PushMessage(\"reject\", string(\"getdata\"), REJECT_NOTFOUND, string(\"Not found\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16716412",
      "id" : 16716412,
      "original_commit_id" : "8ba326b852d06556d7bcf8cced20ba9c9e5a00f2",
      "original_position" : 208,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16716412",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "When a block is being disconnected due to a reorg, and its data cannot be loaded from disk, there is currently just a state.Abort with \"Failed to read block\". Exceedingly unlikely, but we need to be able to deal with such situations. I wonder whether crashing with some extra help/debug output may be enough, or whether we need to retry downloading the missing data...\r\n\r\nEDIT: Downloading the missing data might work for block data, but not for undo data, so it will be unlikely to be useful.",
      "created_at" : "2014-08-26T23:39:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-53508821",
      "id" : 53508821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-08-26T23:40:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/53508821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I'd like to re-download, and thought that would be interesting to explore with headers first in placeÃ¢ÂÂ but the problem is that if the undo data is deleted we cannot usefully redownload.\r\n\r\nEdit: ah, you noticed that. Yea, wellÃ¢ÂÂ we could have different retention policies for undo date. I considered that future work. If ever we make the undo data normative we could just store hashes of it and fetch it from peers too.",
      "created_at" : "2014-08-26T23:49:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-53509539",
      "id" : 53509539,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-08-26T23:50:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/53509539",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Of course, we could for example delete blocks data at depth N, but only delete undo data at depth N*3 or so (undo data is 7-10 times smaller than block data). Of course, that just moves the problem further to what to do when an N*3 deep reorg is encountered.",
      "created_at" : "2014-08-26T23:53:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-53509821",
      "id" : 53509821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-08-26T23:53:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/53509821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : " Untested ACK. I guess I'm fine with resolving the missing-block/undo problem for reorgs later.",
      "created_at" : "2014-08-27T00:49:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-53513673",
      "id" : 53513673,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-08-27T00:49:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/53513673",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16967795"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16967795"
         }
      },
      "body" : "I'm working on something like this. The code is still messy, but I would wait for it to be ready before merging this. The default would be -pruned=0 which means do now autoprune, just allow running pruned.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-02T01:56:41Z",
      "diff_hunk" : "@@ -2997,7 +2996,101 @@ bool static LoadBlockIndexDB()\n         chainActive.Tip()->GetBlockHash().ToString(), chainActive.Height(),\n         DateTimeStrFormat(\"%Y-%m-%d %H:%M:%S\", chainActive.Tip()->GetBlockTime()),\n         Checkpoints::GuessVerificationProgress(chainActive.Tip()));\n+    \n+    return true;\n+}\n \n+bool CheckAndPruneBlockFiles()\n+{\n+    // Check presence of essential data\n+    int nKeepBlksFromHeight = fPruned ? (max((int)(chainActive.Height() - MIN_BLOCKS_TO_KEEP), 0)) : 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r16967795",
      "id" : 16967795,
      "original_commit_id" : "73ed2bd6c22559831fff6c4b388e661d9ab66476",
      "original_position" : 87,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/16967795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "Needs rebase.",
      "created_at" : "2014-09-12T17:38:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-55436314",
      "id" : 55436314,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-09-12T17:38:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55436314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Added configure options, refactored a little to improve readability, rebased and fixed some small formatting nits remaining.",
      "created_at" : "2014-09-17T17:46:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-55932295",
      "id" : 55932295,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-09-17T17:46:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55932295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17709303"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17709303"
         }
      },
      "body" : "May I suggest calling this ``-prune`` or ``-autoprune`` and also rephrase the help message for this? It IMHO sounds weird to have an option in that grammar.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-18T05:08:47Z",
      "diff_hunk" : "@@ -229,6 +229,7 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += \"  -maxorphantx=<n>       \" + strprintf(_(\"Keep at most <n> unconnectable transactions in memory (default: %u)\"), DEFAULT_MAX_ORPHAN_TRANSACTIONS) + \"\\n\";\n     strUsage += \"  -par=<n>               \" + strprintf(_(\"Set the number of script verification threads (%u to %d, 0 = auto, <0 = leave that many cores free, default: %d)\"), -(int)boost::thread::hardware_concurrency(), MAX_SCRIPTCHECK_THREADS, DEFAULT_SCRIPTCHECK_THREADS) + \"\\n\";\n     strUsage += \"  -pid=<file>            \" + _(\"Specify pid file (default: bitcoind.pid)\") + \"\\n\";\n+    strUsage += \"  -pruned=<n>            \" + _(\"Run in a pruned state (default: 0 = allow running pruned but do not autoprune; <n> > 0 = automatically prune old block files up to height <n>; <n> < 0 = automatically prune up to last <n> blocks. Warning: going back to be a full node after pruning requires a very expensive resync process. This mode also disables wallet support and is incompatible with txindex)\") + \"\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17709303",
      "id" : 17709303,
      "original_commit_id" : "df41b2d88c2c903186a077a41231b62a3857a0cf",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17709303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17717671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17717671"
         }
      },
      "body" : "Let's not assume that people know what you mean with \"prune\" at the beginning of the message. Also the warning should not be in the (...), and I'd just say \"re-downloading\" instead of \"a very expensive resync process\".\r\n\r\nInstead of \r\n\r\n> Run in a pruned state (default: 0 = allow running pruned but do not autoprune; <n> > 0 = automatically prune old block files up to height <n>; <n> < 0 = automatically prune up to last <n> blocks. Warning: going back to be a full node after pruning requires a very expensive resync process. This mode also disables wallet support and is incompatible with txindex)\r\n\r\nI'd propose:\r\n\r\n> Reduce storage requirements by pruning (deleting) old blocks. This mode disables wallet support and is incompatible with -txindex. Warning: going back to full storage after pruning requires re-downloading the entire blockchain.\r\n> (default: 0 = allow running with missing blocks, but do not delete anything; \r\n> <n> > 0 = delete up to block height &lt;n>; \r\n> <n> < 0 = delete all but last &lt;n> blocks)",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-18T09:39:32Z",
      "diff_hunk" : "@@ -229,6 +229,7 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += \"  -maxorphantx=<n>       \" + strprintf(_(\"Keep at most <n> unconnectable transactions in memory (default: %u)\"), DEFAULT_MAX_ORPHAN_TRANSACTIONS) + \"\\n\";\n     strUsage += \"  -par=<n>               \" + strprintf(_(\"Set the number of script verification threads (%u to %d, 0 = auto, <0 = leave that many cores free, default: %d)\"), -(int)boost::thread::hardware_concurrency(), MAX_SCRIPTCHECK_THREADS, DEFAULT_SCRIPTCHECK_THREADS) + \"\\n\";\n     strUsage += \"  -pid=<file>            \" + _(\"Specify pid file (default: bitcoind.pid)\") + \"\\n\";\n+    strUsage += \"  -pruned=<n>            \" + _(\"Run in a pruned state (default: 0 = allow running pruned but do not autoprune; <n> > 0 = automatically prune old block files up to height <n>; <n> < 0 = automatically prune up to last <n> blocks. Warning: going back to be a full node after pruning requires a very expensive resync process. This mode also disables wallet support and is incompatible with txindex)\") + \"\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17717671",
      "id" : 17717671,
      "original_commit_id" : "df41b2d88c2c903186a077a41231b62a3857a0cf",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17717671",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17741477"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17741477"
         }
      },
      "body" : "Any suggestion about how to make this user facing text better?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-18T17:24:20Z",
      "diff_hunk" : "@@ -962,6 +979,14 @@ bool AppInit2(boost::thread_group& threadGroup)\n                     break;\n                 }\n \n+                if (!CheckAndPruneBlockFiles()) {\n+                    if (!fPruned)\n+                        strLoadError = _(\"Error checking required block files. You might try to run in -pruned mode, or try to rebuild the block database (Warning: please check carefully the implications of running pruned before doing so)\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17741477",
      "id" : 17741477,
      "original_commit_id" : "df41b2d88c2c903186a077a41231b62a3857a0cf",
      "original_position" : 44,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17741477",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17771561"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17771561"
         }
      },
      "body" : "I'd just say \"Error checking required block files\" in both cases. I wouldn't suggest using -pruned as a way to get around errors caused by random disk corruption (for example). Someone that wants to run a pruned node will make a conscious choice to do so.\r\n",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T07:10:51Z",
      "diff_hunk" : "@@ -962,6 +979,14 @@ bool AppInit2(boost::thread_group& threadGroup)\n                     break;\n                 }\n \n+                if (!CheckAndPruneBlockFiles()) {\n+                    if (!fPruned)\n+                        strLoadError = _(\"Error checking required block files. You might try to run in -pruned mode, or try to rebuild the block database (Warning: please check carefully the implications of running pruned before doing so)\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17771561",
      "id" : 17771561,
      "original_commit_id" : "df41b2d88c2c903186a077a41231b62a3857a0cf",
      "original_position" : 44,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17771561",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17787611"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17787611"
         }
      },
      "body" : "Much better, thanks :)! A little nit, you are missing a single space after ``-prune=<n>`` ;).\r\n\r\nMay I also suggest splitting the sentences of the description, like in ``-debug=<category>``? That makes it (IMHO) easier to change the string in the future (translations) and better looking in the output.\r\n\r\nWhile I'm at nitting:\r\n``Warning: going back to full storage after pruning requires re-downloading the entire blockchain. (default: 0 = allow running with missing blocks, but do not delete anything; > 0 = delete up to block height <n>; < 0 = delete all but last <n> blocks)``\r\ncould read:\r\n``Warning: Reverting this setting requires re-downloading the entire blockchain! (default: 0 = allow running with missing blocks, but do not delete anything, >0 = delete up to block height <n>, <0 = delete all but last <n> blocks)``\r\n\r\nI think ``going back to full storage after pruning`` is not that easy to translate and I changed the used ``;`` as separators with ``,`` and remove the spaces before ``>`` and ``<``.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T14:29:52Z",
      "diff_hunk" : "@@ -229,6 +229,7 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += \"  -maxorphantx=<n>       \" + strprintf(_(\"Keep at most <n> unconnectable transactions in memory (default: %u)\"), DEFAULT_MAX_ORPHAN_TRANSACTIONS) + \"\\n\";\n     strUsage += \"  -par=<n>               \" + strprintf(_(\"Set the number of script verification threads (%u to %d, 0 = auto, <0 = leave that many cores free, default: %d)\"), -(int)boost::thread::hardware_concurrency(), MAX_SCRIPTCHECK_THREADS, DEFAULT_SCRIPTCHECK_THREADS) + \"\\n\";\n     strUsage += \"  -pid=<file>            \" + _(\"Specify pid file (default: bitcoind.pid)\") + \"\\n\";\n+    strUsage += \"  -prune=<n>            \" + _(\"Reduce storage requirements by pruning (deleting) old blocks. This mode disables wallet support and is incompatible with -txindex. Warning: going back to full storage after pruning requires re-downloading the entire blockchain. (default: 0 = allow running with missing blocks, but do not delete anything; > 0 = delete up to block height <n>; < 0 = delete all but last <n> blocks)\") + \"\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17787611",
      "id" : 17787611,
      "original_commit_id" : "8e9d6a36b429fc974048853de9944c9e8d7dbfc4",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17787611",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788137"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788137"
         }
      },
      "body" : "This should be moved to parameter interactions in ``Step 2: parameter interactions`` in init.cpp?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T14:39:53Z",
      "diff_hunk" : "@@ -595,6 +596,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (mapArgs.count(\"-prune\")) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Pruned mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788137",
      "id" : 17788137,
      "original_commit_id" : "8e9d6a36b429fc974048853de9944c9e8d7dbfc4",
      "original_position" : 16,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788254"
         }
      },
      "body" : "Wouldn't it be possible to just use ``GetArg(\"-prune\", 0);`` to determine if pruned mode is active? If != 0 it's active and you've got ``<n>``.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T14:42:02Z",
      "diff_hunk" : "@@ -633,6 +647,9 @@ bool AppInit2(boost::thread_group& threadGroup)\n     fPrintToConsole = GetBoolArg(\"-printtoconsole\", false);\n     fLogTimestamps = GetBoolArg(\"-logtimestamps\", true);\n     fLogIPs = GetBoolArg(\"-logips\", false);\n+    fPruned = mapArgs.count(\"-prune\") ? 1 : 0;\n+    if (fPruned)\n+        nPruned = GetArg(\"-prune\", 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788254",
      "id" : 17788254,
      "original_commit_id" : "8e9d6a36b429fc974048853de9944c9e8d7dbfc4",
      "original_position" : 34,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788458"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788458"
         }
      },
      "body" : "I fear that this message is too generic? At least you are using 2 different messages for failing calls to ``!CheckAndPruneBlockFiles()``.\r\n\r\nEdit: This is still true, see below.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T14:45:35Z",
      "diff_hunk" : "@@ -962,6 +979,11 @@ bool AppInit2(boost::thread_group& threadGroup)\n                     break;\n                 }\n \n+                if (!CheckAndPruneBlockFiles()) {\n+                    strLoadError = _(\"Error checking required block files\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788458",
      "id" : 17788458,
      "original_commit_id" : "8e9d6a36b429fc974048853de9944c9e8d7dbfc4",
      "original_position" : 43,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788458",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788716"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788716"
         }
      },
      "body" : "Perhaps use ``GetBlockPosFilename(pos, \"blk\")`` also for the log message? You could perhaps also merge these 2 functions into one by just passing a flag for undo or normal block file, as most code is a duplicate.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T14:50:06Z",
      "diff_hunk" : "@@ -2822,6 +2826,28 @@ boost::filesystem::path GetBlockPosFilename(const CDiskBlockPos &pos, const char\n     return GetDataDir() / \"blocks\" / strprintf(\"%s%05u.dat\", prefix, pos.nFile);\n }\n \n+bool RemoveBlockFile(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    if (boost::filesystem::remove(GetBlockPosFilename(pos, \"blk\"))) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788716",
      "id" : 17788716,
      "original_commit_id" : "8e9d6a36b429fc974048853de9944c9e8d7dbfc4",
      "original_position" : 25,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788806"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788806"
         }
      },
      "body" : "Nit: ``.`` seems unneeded.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T14:51:36Z",
      "diff_hunk" : "@@ -2913,7 +2921,112 @@ bool static LoadBlockIndexDB()\n         chainActive.Tip()->GetBlockHash().ToString(), chainActive.Height(),\n         DateTimeStrFormat(\"%Y-%m-%d %H:%M:%S\", chainActive.Tip()->GetBlockTime()),\n         Checkpoints::GuessVerificationProgress(chainActive.Tip()));\n+    return true;\n+}\n+\n+bool BlockFileReadable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    return CAutoFile(OpenBlockFile(pos, true), SER_DISK, CLIENT_VERSION) ? true : false;\n+}\n+\n+bool UndoFileReadable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    return CAutoFile(OpenUndoFile(pos, true), SER_DISK, CLIENT_VERSION) ? true : false;\n+}\n+\n+bool DataFilesReadable(int nFile)\n+{\n+    if (BlockFileReadable(nFile) && UndoFileReadable(nFile))\n+        return true;\n+    return false;\n+}\n \n+int LastBlockInFile(int nFile)\n+{\n+    CBlockFileInfo info;\n+    pblocktree->ReadBlockFileInfo(nFile, info);\n+    return info.nHeightLast;\n+}\n+\n+bool CheckAndPruneBlockFiles()\n+{\n+    // Check presence of essential data\n+    int nKeepMinBlksFromHeight = fPruned ? (max((int)(chainActive.Height() - MIN_BLOCKS_TO_KEEP), 0)) : 0;\n+    int nAutoPruneUpToHeight = 0;\n+    if (nPruned) {\n+        LogPrintf(\"Autopruning active.\\n\");\n+        if (nPruned > 0) {\n+            LogPrintf(\"Autoprune configured to prune up to height: %i\\n\", nPruned);\n+            nAutoPruneUpToHeight = min(nKeepMinBlksFromHeight, nPruned);\n+        } else if (nPruned < 0) {\n+            LogPrintf(\"Autoprune configured to keep the last: %i blocks\\n\", -nPruned);\n+            nAutoPruneUpToHeight = min((chainActive.Height() + nPruned), nKeepMinBlksFromHeight);\n+        }\n+        LogPrintf(\"Current height: %i.\\n\", chainActive.Height());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17788806",
      "id" : 17788806,
      "original_commit_id" : "8e9d6a36b429fc974048853de9944c9e8d7dbfc4",
      "original_position" : 119,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17788806",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17793196"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17793196"
         }
      },
      "body" : "That's right were it is? :P",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T16:02:39Z",
      "diff_hunk" : "@@ -595,6 +596,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (mapArgs.count(\"-prune\")) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Pruned mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17793196",
      "id" : 17793196,
      "original_commit_id" : "8e9d6a36b429fc974048853de9944c9e8d7dbfc4",
      "original_position" : 16,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17793196",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17793453"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17793453"
         }
      },
      "body" : "But that way you lose the possibility or running pruned without autopruning.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-19T16:07:11Z",
      "diff_hunk" : "@@ -633,6 +647,9 @@ bool AppInit2(boost::thread_group& threadGroup)\n     fPrintToConsole = GetBoolArg(\"-printtoconsole\", false);\n     fLogTimestamps = GetBoolArg(\"-logtimestamps\", true);\n     fLogIPs = GetBoolArg(\"-logips\", false);\n+    fPruned = mapArgs.count(\"-prune\") ? 1 : 0;\n+    if (fPruned)\n+        nPruned = GetArg(\"-prune\", 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r17793453",
      "id" : 17793453,
      "original_commit_id" : "8e9d6a36b429fc974048853de9944c9e8d7dbfc4",
      "original_position" : 34,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/17793453",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "Can someone help me understand the usecase for running pruned without autopruning?  My original expectation was that you'd just tell it to prune and a disk usage limit,  and it would do the right thing(tm) for the network within that limit (subject to the constraint that it won't prune so much that its likely to get stuck).",
      "created_at" : "2014-09-19T16:13:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-56198847",
      "id" : 56198847,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-09-19T16:13:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/56198847",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Agree with @gmaxwell. It seems an artefact of how it got implemented to see \"ability to run without all data\" and \"automatically remove data under some policy\" as separate. Once you delete a single block file, you're already unable to function as a full node (in the traditional NODE_NETWORK sense).",
      "created_at" : "2014-09-19T17:26:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-56207906",
      "id" : 56207906,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-09-19T17:26:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/56207906",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I have been able to successfully sync a non-listening x86_64 node over the network using this patch using very little disk space and the option `prune=-50000`. Node has been stable for 4 days without any problems so far. Was able to do unusual operations like reducing the number of retained blocks during the initial synchronization with no apparent problems. \r\n\r\n    Autopruning active.\r\n    Autoprune configured to keep the last: 50000 blocks\r\n    Current height: 182982.\r\n    Autopruning up to height 132982\r\n    Checking all required data for active chain is available (mandatory from height 182694 to 182982)\r\n    Data for blocks from 1 to 131236 has been pruned\r\n    Undo data for blocks from 1 to 131236 has been pruned\r\n\r\nLogged autoprune messages appear to be sane during sync.",
      "created_at" : "2014-09-22T17:01:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-56404751",
      "id" : 56404751,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-09-22T17:01:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/56404751",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=3",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "body" : "@bitcoinpulltesterhuman thanks for testing\r\n",
      "created_at" : "2014-09-23T09:27:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-56494695",
      "id" : 56494695,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-09-23T09:27:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/56494695",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18075789"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18075789"
         }
      },
      "body" : "You might change this to (so we don't need to rework log strings when function names change in the future):\r\n``LogPrintf(\"%s: parameter interaction: -prune set -> setting -disablewallet=1\\n\", __func__);``",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-26T06:49:18Z",
      "diff_hunk" : "@@ -599,6 +604,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (GetArg(\"-prune\", 0)) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Prune mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {\n+            if (SoftSetBoolArg(\"-disablewallet\", true))\n+                LogPrintf(\"AppInit2 : parameter interaction: -prune -> setting -disablewallet=1\\n\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18075789",
      "id" : 18075789,
      "original_commit_id" : "84529a3e52732074241678294787d830c3b2db8e",
      "original_position" : 22,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18075789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18075818"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18075818"
         }
      },
      "body" : "Talking about that message here ;).",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-26T06:50:41Z",
      "diff_hunk" : "@@ -2186,6 +2187,8 @@ bool FindBlockPos(CValidationState &state, CDiskBlockPos &pos, unsigned int nAdd\n         unsigned int nOldChunks = (pos.nPos + BLOCKFILE_CHUNK_SIZE - 1) / BLOCKFILE_CHUNK_SIZE;\n         unsigned int nNewChunks = (infoLastBlockFile.nSize + BLOCKFILE_CHUNK_SIZE - 1) / BLOCKFILE_CHUNK_SIZE;\n         if (nNewChunks > nOldChunks) {\n+            if (!CheckAndPruneBlockFiles())\n+                return state.Abort(\"Error checking block files\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18075818",
      "id" : 18075818,
      "original_commit_id" : "84529a3e52732074241678294787d830c3b2db8e",
      "original_position" : 13,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18075818",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18075835"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18075835"
         }
      },
      "body" : "@sipa Should such a thing be logged so that it's clear we are not a full node anymore?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-26T06:51:30Z",
      "diff_hunk" : "@@ -1252,6 +1276,8 @@ bool AppInit2(boost::thread_group& threadGroup)\n     LogPrintf(\"mapAddressBook.size() = %u\\n\",  pwalletMain ? pwalletMain->mapAddressBook.size() : 0);\n #endif\n \n+    if (nPrune) // unsetting NODE_NETWORK on prune state\n+        nLocalServices &= ~NODE_NETWORK;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18075835",
      "id" : 18075835,
      "original_commit_id" : "84529a3e52732074241678294787d830c3b2db8e",
      "original_position" : 57,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18075835",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18075968"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18075968"
         }
      },
      "body" : "It is a full nodeÃ¢ÂÂ its validation and security model is the same; its not node-network though. Service bits are show in the rpc info output, no harm in logging something. Just please don't say that it's not a full node.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-26T06:57:16Z",
      "diff_hunk" : "@@ -1252,6 +1276,8 @@ bool AppInit2(boost::thread_group& threadGroup)\n     LogPrintf(\"mapAddressBook.size() = %u\\n\",  pwalletMain ? pwalletMain->mapAddressBook.size() : 0);\n #endif\n \n+    if (nPrune) // unsetting NODE_NETWORK on prune state\n+        nLocalServices &= ~NODE_NETWORK;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18075968",
      "id" : 18075968,
      "original_commit_id" : "84529a3e52732074241678294787d830c3b2db8e",
      "original_position" : 57,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18075968",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18076009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18076009"
         }
      },
      "body" : "I'm sorry, I didn't know the term full node is still correct here!",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-26T06:58:41Z",
      "diff_hunk" : "@@ -1252,6 +1276,8 @@ bool AppInit2(boost::thread_group& threadGroup)\n     LogPrintf(\"mapAddressBook.size() = %u\\n\",  pwalletMain ? pwalletMain->mapAddressBook.size() : 0);\n #endif\n \n+    if (nPrune) // unsetting NODE_NETWORK on prune state\n+        nLocalServices &= ~NODE_NETWORK;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18076009",
      "id" : 18076009,
      "original_commit_id" : "84529a3e52732074241678294787d830c3b2db8e",
      "original_position" : 57,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18076009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18098364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18098364"
         }
      },
      "body" : "Any suggestion?\r\n\r\nAnyway, take into account that in case of failure, the function itself throws a more specific log...",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-09-26T16:21:37Z",
      "diff_hunk" : "@@ -2186,6 +2187,8 @@ bool FindBlockPos(CValidationState &state, CDiskBlockPos &pos, unsigned int nAdd\n         unsigned int nOldChunks = (pos.nPos + BLOCKFILE_CHUNK_SIZE - 1) / BLOCKFILE_CHUNK_SIZE;\n         unsigned int nNewChunks = (infoLastBlockFile.nSize + BLOCKFILE_CHUNK_SIZE - 1) / BLOCKFILE_CHUNK_SIZE;\n         if (nNewChunks > nOldChunks) {\n+            if (!CheckAndPruneBlockFiles())\n+                return state.Abort(\"Error checking block files\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18098364",
      "id" : 18098364,
      "original_commit_id" : "84529a3e52732074241678294787d830c3b2db8e",
      "original_position" : 13,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18098364",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4701_8893254172c8efd807418218dea7a7a4022d3f26/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-09-26T18:41:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-57003437",
      "id" : 57003437,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-09-26T18:41:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57003437",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "I've submitted a patch (#4988) that keeps data about all block files in\r\nmemory, which should simplify making a version of this that functions\r\nas gmaxwell's suggestion (have a disk usage limit instead of a block number\r\nlimit).",
      "created_at" : "2014-09-30T22:05:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-57390617",
      "id" : 57390617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-09-30T23:32:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/57390617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@rdponticelli I'm not convinced 98daccf is quite right. @gmaxwell's suggestion that the limit should be in megabytes of blocks is sound, but defining them as a negative of the amount of disk space is not the right direction to go. Depending how I use my disks I could end up ridiculously overpruning my blocks, which requires an unfriendly resync to rectify. I believe it would be a lot more useful for the limit to be defined as a maximum for the block chain size on disk, or at least give an option between the two.  \r\n\r\nI have tested this latest commit and can't see any troubles yet. ",
      "created_at" : "2014-10-11T05:05:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-58738414",
      "id" : 58738414,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-10-11T05:05:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/58738414",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=3",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "body" : "I agree with @BitcoinPullTesterHuman here. Setting a fixed quota on bitcoind's disk usage would be most useful. Making it about keeping a certain amount of disk space free would make it depend on other factors, and potentially interact very badly with other programs that reason in the same way.",
      "created_at" : "2014-10-11T10:17:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-58744993",
      "id" : 58744993,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-10-11T10:17:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/58744993",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Better now?",
      "created_at" : "2014-10-11T21:07:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-58764562",
      "id" : 58764562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-10-11T21:07:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/58764562",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "Seems to do what it says on the tin. \r\n\r\n    ...\r\n    UpdateTip: new best=000000000000000020cb9c249f38d295031483debe1966608859a8c3576f0be9  height=314903  log2_work=80.125233  tx=44239173  date=2014-08-10 12:50:42 progress=0.800166  cache=6452  \r\n    UpdateTip: new best=000000000000000036e888b57e08c72d2d3c57869e24b759d8f728f87002ee41  height=314904  log2_work=80.125326  tx=44239192  date=2014-08-10 12:49:49 progress=0.800165  cache=6496  \r\n    Autoprune configured to use less than 10000MB on disk for block files  \r\n    Capacity: 80158MB; Available: 5400MB; Used for block files: 9897MB  \r\n    UpdateTip: new best=000000000000000014078ca51becfb85d6104a553ac32bbb9759922125b58f00  height=314905  log2_work=80.125418  tx=44240419  date=2014-08-10 13:25:07 progress=0.800240  cache=0  \r\n    Autoprune configured to use less than 10000MB on disk for block files  \r\n    Capacity: 80158MB; Available: 5393MB; Used for block files: 9897MB  \r\n    Pre-allocating up to position 0x700000 in rev00164.dat  \r\n    UpdateTip: new best=00000000000000000f34337e2854eed6d315dc8f1b2ab27ebc3d1c82abbe2fbb  height=314906  log2_work=80.125511  tx=44240870  date=2014-08-10 13:37:51 progress=0.800268  cache=1321  \r\n    UpdateTip: new best=0000000000000000119c842e1af4e8b3507e7eb21fcdf14263d5524e5946b276  height=314907  log2_work=80.125604  tx=44241044  date=2014-08-10 13:42:24 progress=0.800278  cache=1951  \r\n    UpdateTip: new best=0000000000000000161388f89b8d4caea72dca599bfce374e375b93786cfc651  height=314908  log2_work=80.125697  tx=44241113  date=2014-08-10 13:43:58 progress=0.800281  cache=2100  \r\n    Autoprune configured to use less than 10000MB on disk for block files  \r\n    Capacity: 80158MB; Available: 5392MB; Used for block files: 9898MB  \r\n    Pre-allocating up to position 0x4000000 in blk00164.dat  \r\n    UpdateTip: new best=000000000000000027a296aafdce13174d474c00f88cf55f37e1909304ff42d6  height=314909  log2_work=80.125789  tx=44243223  date=2014-08-10 14:46:51 progress=0.800415  cache=6913  \r\n    Autoprune configured to use less than 10000MB on disk for block files  \r\n    Capacity: 80158MB; Available: 5364MB; Used for block files: 9914MB  \r\n    UpdateTip: new best=00000000000000002d62caf86485a31de7558020fe5dcbb7c3443057a5159bb9  height=314910  log2_work=80.125882  tx=44244883  date=2014-08-10 15:35:13 progress=0.800518  cache=0  \r\n    UpdateTip: new best=00000000000000001736a28c2d8170da93ec7affc9c7bbc9f3e50abbcd392f08  height=314911  log2_work=80.125975  tx=44245395  date=2014-08-10 15:58:44 progress=0.800566  cache=1129  \r\n    UpdateTip: new best=00000000000000001ae4b7f7a7ddc650a8f2ae2ffd3dc5ccab4acb61266f1a44  height=314912  log2_work=80.126067  tx=44245894  date=2014-08-10 15:47:21 progress=0.800550  cache=3173  \r\n    UpdateTip: new best=00000000000000001cd15ea31d92b3704b1d74a4c6f7cdcbb51df303f6f5e640  height=314913  log2_work=80.12616  tx=44246363  date=2014-08-10 15:53:37 progress=0.800566  cache=4598  \r\n    UpdateTip: new best=00000000000000002c34dd824eb4d46d2ab11034316136e9a5f4e3424f2f2a32  height=314914  log2_work=80.126253  tx=44247171  date=2014-08-10 16:06:07 progress=0.800597  cache=6700  \r\n    Autoprune configured to use less than 10000MB on disk for block files  \r\n    Capacity: 80158MB; Available: 5381MB; Used for block files: 9914MB  \r\n    UpdateTip: new best=000000000000000000489b46754c90f3cda614f5a8df17413fd8eb85dad3c1a6  height=314915  log2_work=80.126345  tx=44247610  date=2014-08-10 16:11:11 progress=0.800610  cache=0  \r\n    UpdateTip: new best=00000000000000001fc91469023097e3cad6822abd566f1534495e68232bfed9  height=314916  log2_work=80.126438  tx=44248002  date=2014-08-10 16:16:39 progress=0.800624  cache=1398  \r\n    UpdateTip: new best=00000000000000001fa3937d72ae89092fc9e738fd24c6ebe5341596151f6327  height=314917  log2_work=80.12653  tx=44248456  date=2014-08-10 16:24:41 progress=0.800643  cache=2762  \r\n     ...\r\n\r\nThe logging output is a little verbose but that's a cosmetic issue rather than a functional one. ",
      "created_at" : "2014-10-12T00:47:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-58769739",
      "id" : 58769739,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-10-12T00:47:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/58769739",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=3",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18745256"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18745256"
         }
      },
      "body" : "For sanity you may want to actually add bool operator() to CAutoFIle (the only bool operator declared there is bool operator!()).",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-12T01:41:01Z",
      "diff_hunk" : "@@ -2859,7 +2895,97 @@ bool static LoadBlockIndexDB()\n         chainActive.Tip()->GetBlockHash().ToString(), chainActive.Height(),\n         DateTimeStrFormat(\"%Y-%m-%d %H:%M:%S\", chainActive.Tip()->GetBlockTime()),\n         Checkpoints::GuessVerificationProgress(chainActive.Tip()));\n+    return true;\n+}\n \n+bool BlockFileReadable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    return CAutoFile(OpenBlockFile(pos, true), SER_DISK, CLIENT_VERSION) ? true : false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18745256",
      "id" : 18745256,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 131,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18745256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746514"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746514"
         }
      },
      "body" : "What's the point in running this if not as a wallet?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-12T08:53:09Z",
      "diff_hunk" : "@@ -598,6 +602,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (GetArg(\"-prune\", 0)) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Prune mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {\n+            if (SoftSetBoolArg(\"-disablewallet\", true))\n+                LogPrintf(\"%s : parameter interaction: -prune -> setting -disablewallet=1\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746514",
      "id" : 18746514,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 21,
      "path" : "src/init.cpp",
      "position" : 21,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746671"
         }
      },
      "body" : "Being autopruned is incompatible with a wallet, really. If you need to rescan or load a wallet that's older than the blocks you have on disk, you're going to have to download them and throw them out all over again. As I understand it, it's an implied requirement of having a wallet that you must be able to do a rescan as necessary. ",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-12T09:36:28Z",
      "diff_hunk" : "@@ -598,6 +602,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (GetArg(\"-prune\", 0)) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Prune mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {\n+            if (SoftSetBoolArg(\"-disablewallet\", true))\n+                LogPrintf(\"%s : parameter interaction: -prune -> setting -disablewallet=1\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746671",
      "id" : 18746671,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 21,
      "path" : "src/init.cpp",
      "position" : 21,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746671",
      "user" : null
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746698"
         }
      },
      "body" : "CAutoFile already 'degenerates' into a  FILE*. Let's not add more magic behavior.\r\n\r\n    operator FILE*()            { return file; }\r\n\r\nI'd prefer an explicit method 'bool IsNull() const { return file==0; }'.\r\n",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-12T09:43:34Z",
      "diff_hunk" : "@@ -2859,7 +2895,97 @@ bool static LoadBlockIndexDB()\n         chainActive.Tip()->GetBlockHash().ToString(), chainActive.Height(),\n         DateTimeStrFormat(\"%Y-%m-%d %H:%M:%S\", chainActive.Tip()->GetBlockTime()),\n         Checkpoints::GuessVerificationProgress(chainActive.Tip()));\n+    return true;\n+}\n \n+bool BlockFileReadable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    return CAutoFile(OpenBlockFile(pos, true), SER_DISK, CLIENT_VERSION) ? true : false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746698",
      "id" : 18746698,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 131,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746704"
         }
      },
      "body" : "This isn't so, but the extra things required to do that haven't been implemented yet and shouldn't be part of this patch.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-12T09:45:04Z",
      "diff_hunk" : "@@ -598,6 +602,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (GetArg(\"-prune\", 0)) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Prune mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {\n+            if (SoftSetBoolArg(\"-disablewallet\", true))\n+                LogPrintf(\"%s : parameter interaction: -prune -> setting -disablewallet=1\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746704",
      "id" : 18746704,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 21,
      "path" : "src/init.cpp",
      "position" : 21,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746707"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746707"
         }
      },
      "body" : "Running with wallet usefully with pruned blocks (and still allowing import/rescan) would require SPV support in the wallet.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-12T09:45:20Z",
      "diff_hunk" : "@@ -598,6 +602,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (GetArg(\"-prune\", 0)) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Prune mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {\n+            if (SoftSetBoolArg(\"-disablewallet\", true))\n+                LogPrintf(\"%s : parameter interaction: -prune -> setting -disablewallet=1\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18746707",
      "id" : 18746707,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 21,
      "path" : "src/init.cpp",
      "position" : 21,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18746707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18749025"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18749025"
         }
      },
      "body" : "Sure, that'd be better. Maybe remove the bool operator!() too, since that is strange.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-12T18:18:13Z",
      "diff_hunk" : "@@ -2859,7 +2895,97 @@ bool static LoadBlockIndexDB()\n         chainActive.Tip()->GetBlockHash().ToString(), chainActive.Height(),\n         DateTimeStrFormat(\"%Y-%m-%d %H:%M:%S\", chainActive.Tip()->GetBlockTime()),\n         Checkpoints::GuessVerificationProgress(chainActive.Tip()));\n+    return true;\n+}\n \n+bool BlockFileReadable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    return CAutoFile(OpenBlockFile(pos, true), SER_DISK, CLIENT_VERSION) ? true : false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r18749025",
      "id" : 18749025,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 131,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/18749025",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Rebased. I'm also trying to improve the commits history to make the changes less invasive, and the whole thing more review-able. But meanwhile, this is at least working .",
      "created_at" : "2014-10-18T18:25:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-59624462",
      "id" : 59624462,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-10-18T18:25:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59624462",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140610"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140610"
         }
      },
      "body" : "IMHO the formatting spaces in front of this should be moved out of the translations string.\r\nAlso is there a minimum defined which needs to be set for this to work?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-21T10:47:50Z",
      "diff_hunk" : "@@ -240,6 +240,10 @@ std::string HelpMessage(HelpMessageMode mode)\n #ifndef WIN32\n     strUsage += \"  -pid=<file>            \" + _(\"Specify pid file (default: bitcoind.pid)\") + \"\\n\";\n #endif\n+    strUsage += \"  -prune=<n>             \" + _(\"Reduce storage requirements by pruning (deleting) old blocks. This mode disables wallet support and is incompatible with -txindex.\") + \"\\n\";\n+    strUsage += \"                         \" + _(\"Warning: Reverting this setting requires re-downloading the entire blockchain!\") + \"\\n\";\n+    strUsage += \"                         \" + _(\"(default: 0 = disable pruning blocks,\") + \"\\n\";\n+    strUsage += \"                         \" + _(\"         >0 = max size in MB to use for block files\") + \"\\n\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140610",
      "id" : 19140610,
      "original_commit_id" : "fb82da2b0ace24f8dfe0bdd7a3296a05ad68d7f0",
      "original_position" : 7,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140610",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140655"
         }
      },
      "body" : "Ah, here it is... you could use that in the help message string.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-21T10:49:26Z",
      "diff_hunk" : "@@ -643,6 +660,11 @@ bool AppInit2(boost::thread_group& threadGroup)\n     fPrintToConsole = GetBoolArg(\"-printtoconsole\", false);\n     fLogTimestamps = GetBoolArg(\"-logtimestamps\", true);\n     fLogIPs = GetBoolArg(\"-logips\", false);\n+    if (GetArg(\"-prune\", 0) < 0)\n+        return InitError(_(\"Error: Negative -prune values doesn't make sense.\"));\n+    nPrune = GetArg(\"-prune\", 0) * 1024 * 1024;\n+    if (nPrune && nPrune < MIN_BLOCK_FILES_SIZE)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140655",
      "id" : 19140655,
      "original_commit_id" : "fb82da2b0ace24f8dfe0bdd7a3296a05ad68d7f0",
      "original_position" : 38,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140655",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140710"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140710"
         }
      },
      "body" : "Not sure this needs to be an error, why not set the default instead? See nConnectTimeout for example.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-21T10:50:53Z",
      "diff_hunk" : "@@ -643,6 +660,11 @@ bool AppInit2(boost::thread_group& threadGroup)\n     fPrintToConsole = GetBoolArg(\"-printtoconsole\", false);\n     fLogTimestamps = GetBoolArg(\"-logtimestamps\", true);\n     fLogIPs = GetBoolArg(\"-logips\", false);\n+    if (GetArg(\"-prune\", 0) < 0)\n+        return InitError(_(\"Error: Negative -prune values doesn't make sense.\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140710",
      "id" : 19140710,
      "original_commit_id" : "fb82da2b0ace24f8dfe0bdd7a3296a05ad68d7f0",
      "original_position" : 36,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140755"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140755"
         }
      },
      "body" : "Could also be: ``if (!setDataFilePrunable.empty() && RemoveBlockFile(*setDataFilePrunable.rbegin()))``.\r\nSame for next if clause.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-21T10:52:20Z",
      "diff_hunk" : "@@ -2699,11 +2701,42 @@ uint256 CPartialMerkleTree::ExtractMatches(std::vector<uint256> &vMatch) {\n     return hashMerkleRoot;\n }\n \n+bool RemoveDiskFile(int nFile, const char* prefix)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    if (boost::filesystem::remove(GetBlockPosFilename(pos, prefix))) {\n+        LogPrintf(\"File %s removed\\n\", GetBlockPosFilename(pos, prefix));\n+        return true;\n+    }\n+    LogPrintf(\"Error removing file %s\\n\", GetBlockPosFilename(pos, prefix));\n+    return false;\n+}\n+\n+bool RemoveBlockFile(int nFile)\n+{\n+    return RemoveDiskFile(nFile, \"blk\");\n+}\n \n+bool RemoveUndoFile(int nFile)\n+{\n+    return RemoveDiskFile(nFile, \"rev\");\n+}\n \n \n \n+bool PruneBlockFiles()\n+{\n+    if (!CheckBlockFiles())\n+        return false;\n+    if (!setDataFilePrunable.empty())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140755",
      "id" : 19140755,
      "original_commit_id" : "fb82da2b0ace24f8dfe0bdd7a3296a05ad68d7f0",
      "original_position" : 65,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140755",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140769"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140769"
         }
      },
      "body" : "Nit: I guess that's not intended ;)?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-21T10:52:49Z",
      "diff_hunk" : "@@ -2762,6 +2815,7 @@ boost::filesystem::path GetBlockPosFilename(const CDiskBlockPos &pos, const char\n     return GetDataDir() / \"blocks\" / strprintf(\"%s%05u.dat\", prefix, pos.nFile);\n }\n \n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140769",
      "id" : 19140769,
      "original_commit_id" : "fb82da2b0ace24f8dfe0bdd7a3296a05ad68d7f0",
      "original_position" : 110,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140769",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140798"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140798"
         }
      },
      "body" : "This needs to be changed when @laanwj CAutoFile pull is merged then...",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-10-21T10:53:30Z",
      "diff_hunk" : "@@ -2859,7 +2895,97 @@ bool static LoadBlockIndexDB()\n         chainActive.Tip()->GetBlockHash().ToString(), chainActive.Height(),\n         DateTimeStrFormat(\"%Y-%m-%d %H:%M:%S\", chainActive.Tip()->GetBlockTime()),\n         Checkpoints::GuessVerificationProgress(chainActive.Tip()));\n+    return true;\n+}\n \n+bool BlockFileReadable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    return CAutoFile(OpenBlockFile(pos, true), SER_DISK, CLIENT_VERSION) ? true : false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r19140798",
      "id" : 19140798,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 131,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140798",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Re: txindex, what does txindex track exactly? List of transaction hashes in each block? In that case, how about just saying \"if a pruned transaction is requested, pull that block from a peer to find it\"?",
      "created_at" : "2014-10-30T10:00:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-61068417",
      "id" : 61068417,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-10-30T10:00:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61068417",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2559390?v=3",
         "events_url" : "https://api.github.com/users/Michagogo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Michagogo/followers",
         "following_url" : "https://api.github.com/users/Michagogo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Michagogo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Michagogo",
         "id" : 2559390,
         "login" : "Michagogo",
         "organizations_url" : "https://api.github.com/users/Michagogo/orgs",
         "received_events_url" : "https://api.github.com/users/Michagogo/received_events",
         "repos_url" : "https://api.github.com/users/Michagogo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Michagogo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Michagogo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Michagogo"
      }
   },
   {
      "body" : "@Michagogo easier said than done.",
      "created_at" : "2014-11-04T15:13:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-61654099",
      "id" : 61654099,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-04T15:13:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61654099",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Some commits were pushed addressing the feedback. I'll rebase and squash if there aren't further comments, not to change commits already reviewed.",
      "created_at" : "2014-11-05T22:09:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-61890408",
      "id" : 61890408,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-05T22:09:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61890408",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "Rebased and squashed.",
      "created_at" : "2014-11-07T18:59:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-62194438",
      "id" : 62194438,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-07T18:59:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62194438",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "Just testing with -prune=1000, and I notice that it prefers deleting block files over undo files. That's suboptimal for two reasons:\r\n* undo data is useless without the corresponding block data (unless we have a mechanism in place to redownload missing blocks, which is safe, while undo data can't be reconstructed).\r\n* over time, a larger and larger percentage of the selected disk space will be wasted on (very old) undo data, while less and less is available for block data.\r\n\r\nI'd suggest deleting them simultaneously.",
      "created_at" : "2014-11-10T17:44:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-62423142",
      "id" : 62423142,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-10T17:44:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/62423142",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20206602"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20206602"
         }
      },
      "body" : "I would avoid considering -prune as a mandate, I'd prefer if it was a soft goal (maybe with an option to quit if it gets too large)",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-11-12T08:35:52Z",
      "diff_hunk" : "@@ -2725,8 +2780,23 @@ bool AbortNode(const std::string &strMessage, const std::string &userMessage) {\n     return false;\n }\n \n+uintmax_t BlockFilesSize()\n+{\n+    uintmax_t size = 0;\n+    BOOST_FOREACH(CBlockFileInfo file, vinfoBlockFile)\n+        size += file.nSize + file.nUndoSize;\n+    return size;\n+}\n+\n bool CheckDiskSpace(uint64_t nAdditionalBytes)\n {\n+    if (nPrune) {\n+        while (BlockFilesSize() + nAdditionalBytes > nPrune) {\n+            if (!PruneBlockFiles())\n+                return AbortNode(\"Can't keep block files size as low as requested\", _(\"Can't keep block files size as low as requested\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20206602",
      "id" : 20206602,
      "original_commit_id" : "ef7184713c6de2e6d0d065733bbbcaf8dd4803d3",
      "original_position" : 98,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20206602",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20206860"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20206860"
         }
      },
      "body" : "We already have a quit if you run out of space... which could be made user tunable, though I worry about introducing too many arguments at once. Perhaps in a follow on patch?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-11-12T08:41:42Z",
      "diff_hunk" : "@@ -2725,8 +2780,23 @@ bool AbortNode(const std::string &strMessage, const std::string &userMessage) {\n     return false;\n }\n \n+uintmax_t BlockFilesSize()\n+{\n+    uintmax_t size = 0;\n+    BOOST_FOREACH(CBlockFileInfo file, vinfoBlockFile)\n+        size += file.nSize + file.nUndoSize;\n+    return size;\n+}\n+\n bool CheckDiskSpace(uint64_t nAdditionalBytes)\n {\n+    if (nPrune) {\n+        while (BlockFilesSize() + nAdditionalBytes > nPrune) {\n+            if (!PruneBlockFiles())\n+                return AbortNode(\"Can't keep block files size as low as requested\", _(\"Can't keep block files size as low as requested\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20206860",
      "id" : 20206860,
      "original_commit_id" : "ef7184713c6de2e6d0d065733bbbcaf8dd4803d3",
      "original_position" : 98,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20206860",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20207772"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20207772"
         }
      },
      "body" : "Tried to test, but couldnt get a value for prune that didnt just quit here, and removing the quit resulted in an infinite loop calling CheckBlockFiles.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-11-12T09:04:40Z",
      "diff_hunk" : "@@ -2725,8 +2780,23 @@ bool AbortNode(const std::string &strMessage, const std::string &userMessage) {\n     return false;\n }\n \n+uintmax_t BlockFilesSize()\n+{\n+    uintmax_t size = 0;\n+    BOOST_FOREACH(CBlockFileInfo file, vinfoBlockFile)\n+        size += file.nSize + file.nUndoSize;\n+    return size;\n+}\n+\n bool CheckDiskSpace(uint64_t nAdditionalBytes)\n {\n+    if (nPrune) {\n+        while (BlockFilesSize() + nAdditionalBytes > nPrune) {\n+            if (!PruneBlockFiles())\n+                return AbortNode(\"Can't keep block files size as low as requested\", _(\"Can't keep block files size as low as requested\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20207772",
      "id" : 20207772,
      "original_commit_id" : "ef7184713c6de2e6d0d065733bbbcaf8dd4803d3",
      "original_position" : 98,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20207772",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20219260"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20219260"
         }
      },
      "body" : "Did you run it on a node already pruned by a previous version of this patch, or pruned manually?\r\n\r\nAnyway, I'll fix this behavior.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-11-12T13:54:14Z",
      "diff_hunk" : "@@ -2725,8 +2780,23 @@ bool AbortNode(const std::string &strMessage, const std::string &userMessage) {\n     return false;\n }\n \n+uintmax_t BlockFilesSize()\n+{\n+    uintmax_t size = 0;\n+    BOOST_FOREACH(CBlockFileInfo file, vinfoBlockFile)\n+        size += file.nSize + file.nUndoSize;\n+    return size;\n+}\n+\n bool CheckDiskSpace(uint64_t nAdditionalBytes)\n {\n+    if (nPrune) {\n+        while (BlockFilesSize() + nAdditionalBytes > nPrune) {\n+            if (!PruneBlockFiles())\n+                return AbortNode(\"Can't keep block files size as low as requested\", _(\"Can't keep block files size as low as requested\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20219260",
      "id" : 20219260,
      "original_commit_id" : "ef7184713c6de2e6d0d065733bbbcaf8dd4803d3",
      "original_position" : 98,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20219260",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20247994"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20247994"
         }
      },
      "body" : "Started with a completely fresh datadir.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2014-11-12T20:27:23Z",
      "diff_hunk" : "@@ -2725,8 +2780,23 @@ bool AbortNode(const std::string &strMessage, const std::string &userMessage) {\n     return false;\n }\n \n+uintmax_t BlockFilesSize()\n+{\n+    uintmax_t size = 0;\n+    BOOST_FOREACH(CBlockFileInfo file, vinfoBlockFile)\n+        size += file.nSize + file.nUndoSize;\n+    return size;\n+}\n+\n bool CheckDiskSpace(uint64_t nAdditionalBytes)\n {\n+    if (nPrune) {\n+        while (BlockFilesSize() + nAdditionalBytes > nPrune) {\n+            if (!PruneBlockFiles())\n+                return AbortNode(\"Can't keep block files size as low as requested\", _(\"Can't keep block files size as low as requested\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r20247994",
      "id" : 20247994,
      "original_commit_id" : "ef7184713c6de2e6d0d065733bbbcaf8dd4803d3",
      "original_position" : 98,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T17:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20247994",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "I'm going to bump this to 0.11 - probably an unpopular decision, but the 0.10 split-off is coming very close IMO this hasn't received enough testing yet. I would like to hear more reports from some people that have actually used this first. I've tried to solicit this on twitter and other places, without much success.",
      "created_at" : "2014-11-17T16:41:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-63333513",
      "id" : 63333513,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-17T16:41:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63333513",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "This could really use a written test plan (e.g. test with existing, populated datadir, test with fresh sync, test what happens if prune size is increased or decreased, test on windows, etc). See https://github.com/bitcoin/QA/\r\n\r\nOnce a test plan is written, I'd be happy to pay (out of core dev grant funds) testers 50,000 bits to work through the tests.\r\n",
      "created_at" : "2014-11-17T16:49:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-63334895",
      "id" : 63334895,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-17T16:50:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63334895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Just tested with a clean datadir, with -prune=500, and seems to work as expected (block and undo files are added and deleted in sync, remaining under 500 MB.\r\n\r\nStarting afterwards without -prune (and before full sync is done) results in a:\r\nError checking required block files. There must be missing or unreadable data.\r\n\r\nDo you want to rebuild the block database now?\r\n",
      "created_at" : "2014-11-17T17:17:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-63339637",
      "id" : 63339637,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-17T17:17:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63339637",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Yes. Should I allow it to run on a pruned state even if the -prune switch isn't specified? I thought such behavior has been discouraged on previous comments...",
      "created_at" : "2014-11-17T17:45:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-63344091",
      "id" : 63344091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-17T17:45:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63344091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "Not a criticism; just a test report.",
      "created_at" : "2014-11-17T17:56:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-63345810",
      "id" : 63345810,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-17T17:56:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63345810",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I was trying to test this with a new block-tester, but ran into #5267\n(and some issues here, as mentioned), before I could get very far :(.\n\nOn 11/17/14 16:49, Gavin Andresen wrote:\n> This could really use a written test plan (e.g. test with existing,\n> populated datadir, test with fresh sync, test what happens if prune size\n> is increased or decreased, test on windows, etc). See\n> https://github.com/bitcoin/QA/\n> \n> Once a test plan is written, I'd be happy to pay testers 50,000 bits to\n> work through the tests.\n> \n> Ã¢ÂÂ\n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-63334895>.\n>",
      "created_at" : "2014-11-18T00:52:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-63404964",
      "id" : 63404964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-18T00:52:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63404964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "If a pruned block is being connected or disconnected, the node will just abort with \"Failed to read block\". Is that intentional? With a guaranteed 288-block window that is retained, I guess it's acceptable, but we need IMHO at least some documentation mentioning how to recover from such a state.",
      "created_at" : "2014-11-18T10:00:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-63446763",
      "id" : 63446763,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-18T10:00:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63446763",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Ran my own tests, same setup to sipa. (500 MB)\r\n\r\nEverything worked as expected until I tried to run a full node again \"-prune=0\", and was greeted with the missing data message. Responding with \"yes\" gives me:\r\n\r\n2014-11-24 03:06:39 : Error checking required block files. There must be missing or unreadable data.\r\n\r\nDo you want to rebuild the block database now?\r\n2014-11-24 03:06:39 Aborted block database rebuild. Exiting.\r\n2014-11-24 03:06:39 Shutdown: In progress...\r\n2014-11-24 03:06:39 StopNode()\r\n2014-11-24 03:06:39 Shutdown: done\r\n\r\nNot sure if recovery from this dialoge is supposed to be possible.\r\n\r\nSwapping between prune/not-pruned state is what seems to have erratic behavior.",
      "created_at" : "2014-11-24T03:13:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-64148395",
      "id" : 64148395,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-24T15:16:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64148395",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "Does this pull cause random blocks to be deleted or the oldest blocks?\nHopefully the former!",
      "created_at" : "2014-11-24T06:07:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-64155020",
      "id" : 64155020,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-24T06:07:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64155020",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "Not hopefully the former. Random is quite pessimal, and in the current setup of the system the best behavior (that which maximizes utility given limited space) is to remove the oldest first.  The behavior will change (e.g. to determinstically random segments) when there are facilities for actually make use of different behavior.",
      "created_at" : "2014-11-24T06:42:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-64156467",
      "id" : 64156467,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-24T06:42:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64156467",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@instagibbs Are you sure you answered yes to the question on bitcoin-qt? Working fine here. The issue could be with bitcoind which doesn't have a way of receiving the input. You need a -reindex there to go back to full node.",
      "created_at" : "2014-11-26T18:41:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-64691921",
      "id" : 64691921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-26T18:41:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64691921",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "@rdponticelli that would explain it. I was running bitcoind only. I guess as a bitcoind user I would have expected a message telling me to reindex. But that might be out of scope for this. Thanks. ",
      "created_at" : "2014-11-26T18:56:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-64694141",
      "id" : 64694141,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-26T18:56:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64694141",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "@gmaxwell surely if everyone pruned the oldest blocks, this would be like sharing a video on bittorrent where no-one has the first part of the video...",
      "created_at" : "2014-11-27T01:06:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-64732594",
      "id" : 64732594,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-27T01:06:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64732594",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@rebroad sure, and there is no risk of that currently (this disables node network and the wallet). Not deleting old blocks wouldn't help here, because without extensions to the p2p protocol sparse block possession is not useful, any missing blocks makes the node no longer node-network.\r\n\r\nPlease go read the old discussion about this, back to pieter's first pruning posts on bitcoin development.",
      "created_at" : "2014-11-27T01:24:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-64734219",
      "id" : 64734219,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-27T01:25:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64734219",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "This is different from a video on bittorrent. The demand is not uniform over the block chain. The recent blocks are requested most frequently, the early blocks are only used when a new node wants to catch up which happens less often. So it makes sense to have nodes that can serve recent history only. Of course, that will break if everyone does it, but let's not wield the categorical imperative here.",
      "created_at" : "2014-11-27T08:47:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-64760823",
      "id" : 64760823,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-11-27T08:47:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/64760823",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I merged this into 0.10.0rc1 and built binaries so others can help test: http://luke.dashjr.org/programs/bitcoin/files/bitcoind/misc/0.10.x/0.10.0rc1.autoprune/",
      "created_at" : "2014-12-24T10:11:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68042235",
      "id" : 68042235,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-12-24T10:11:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68042235",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Why are they named 0.10.0rc2?\r\n\r\nOn Wed, Dec 24, 2014 at 12:12 PM, Luke-Jr <notifications@github.com> wrote:\r\n\r\n> I merged this into 0.10.0rc1 and built binaries so others can help test:\r\n> http://luke.dashjr.org/programs/bitcoin/files/bitcoind/misc/0.10.x/0.10.0rc1.autoprune/\r\n>\r\n> Ã¢ÂÂ\r\n> Reply to this email directly or view it on GitHub\r\n> <https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68042235>.\r\n>",
      "created_at" : "2014-12-24T10:13:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68042349",
      "id" : 68042349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-12-24T10:13:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68042349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2559390?v=3",
         "events_url" : "https://api.github.com/users/Michagogo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Michagogo/followers",
         "following_url" : "https://api.github.com/users/Michagogo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Michagogo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Michagogo",
         "id" : 2559390,
         "login" : "Michagogo",
         "organizations_url" : "https://api.github.com/users/Michagogo/orgs",
         "received_events_url" : "https://api.github.com/users/Michagogo/received_events",
         "repos_url" : "https://api.github.com/users/Michagogo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Michagogo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Michagogo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Michagogo"
      }
   },
   {
      "body" : "Typo, will rename.",
      "created_at" : "2014-12-24T10:13:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68042377",
      "id" : 68042377,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-12-24T10:13:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68042377",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Has anyone tried this with a low prune limit and #5422? Last I checked it crashed and burned pretty quick. Also, anything that lets you make your node unable to reorg back at least a week is entirely unacceptable as far as I'm concerned.",
      "created_at" : "2014-12-24T16:27:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68062090",
      "id" : 68062090,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-12-24T16:27:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68062090",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "I would expect handling *any* reorg to be a requirement, even if the node has to begin reindexing from scratch...",
      "created_at" : "2014-12-24T21:09:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68074380",
      "id" : 68074380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-12-24T21:09:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68074380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "I was willing to look the other way for 0.10, but since we missed it and the headers-first work should have made it easier. I do believe that we should correctly respond to a too-long reorg by going into a rebuild.",
      "created_at" : "2014-12-24T21:13:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68074532",
      "id" : 68074532,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2014-12-24T21:13:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68074532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I volunteer to help testing, given instructions. I've been running a full node for a while but I'm not familiar with the code. Linux or Win7 x64.",
      "created_at" : "2015-01-02T05:33:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68509648",
      "id" : 68509648,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-01-02T05:33:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68509648",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7895696?v=3",
         "events_url" : "https://api.github.com/users/welshjf/events{/privacy}",
         "followers_url" : "https://api.github.com/users/welshjf/followers",
         "following_url" : "https://api.github.com/users/welshjf/following{/other_user}",
         "gists_url" : "https://api.github.com/users/welshjf/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/welshjf",
         "id" : 7895696,
         "login" : "welshjf",
         "organizations_url" : "https://api.github.com/users/welshjf/orgs",
         "received_events_url" : "https://api.github.com/users/welshjf/received_events",
         "repos_url" : "https://api.github.com/users/welshjf/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/welshjf/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/welshjf/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/welshjf"
      }
   },
   {
      "body" : "I think it makes sense to move this forward soon by merging this in some form, as long as there are no regressions, it can be improved later.\r\nOr alternatively, @rdponticelli are there preparatory changes that can be merged already to make keeping this rebased easier?\r\n",
      "created_at" : "2015-01-06T19:39:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-68920680",
      "id" : 68920680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-01-06T19:39:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/68920680",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj: #4515 would certainly help. I'll rebase this one soon.",
      "created_at" : "2015-01-10T14:37:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-69457908",
      "id" : 69457908,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-01-10T14:37:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/69457908",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "body" : "Rebased.",
      "created_at" : "2015-01-12T19:03:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-69625257",
      "id" : 69625257,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-01-12T19:03:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/69625257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=3",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r22823206"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22823206"
         }
      },
      "body" : "It seems this doesn't make the distinction between missing a pruned block and a failed read. If a non-pruned block fails to read when pruning is enabled, shouldn't we fail as before?\r\n\r\nAlternatively.. couldn't the pruning check happen before ReadBlockFromDisk(), to avoid the overhead entirely for pruned nodes? If we're comfortable with randomly answering with a notfound, why not do it constantly?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-01-12T21:19:27Z",
      "diff_hunk" : "@@ -3347,30 +3511,36 @@ void static ProcessGetData(CNode* pfrom)\n                 {\n                     // Send block from disk\n                     CBlock block;\n-                    if (!ReadBlockFromDisk(block, (*mi).second))\n-                        assert(!\"cannot load block from disk\");\n-                    if (inv.type == MSG_BLOCK)\n-                        pfrom->PushMessage(\"block\", block);\n-                    else // MSG_FILTERED_BLOCK)\n-                    {\n-                        LOCK(pfrom->cs_filter);\n-                        if (pfrom->pfilter)\n-                        {\n-                            CMerkleBlock merkleBlock(block, *pfrom->pfilter);\n-                            pfrom->PushMessage(\"merkleblock\", merkleBlock);\n-                            // CMerkleBlock just contains hashes, so also push any transactions in the block the client did not see\n-                            // This avoids hurting performance by pointlessly requiring a round-trip\n-                            // Note that there is currently no way for a node to request any single transactions we didnt send here -\n-                            // they must either disconnect and retry or request the full block.\n-                            // Thus, the protocol spec specified allows for us to provide duplicate txn here,\n-                            // however we MUST always provide at least what the remote peer needs\n-                            typedef std::pair<unsigned int, uint256> PairType;\n-                            BOOST_FOREACH(PairType& pair, merkleBlock.vMatchedTxn)\n-                                if (!pfrom->setInventoryKnown.count(CInv(MSG_TX, pair.second)))\n-                                    pfrom->PushMessage(\"tx\", block.vtx[pair.first]);\n+                    if (!ReadBlockFromDisk(block, (*mi).second)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r22823206",
      "id" : 22823206,
      "original_commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "original_position" : 278,
      "path" : "src/main.cpp",
      "position" : 278,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-01-12T21:19:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/22823206",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Testing this from https://github.com/luke-jr/bitcoin/tree/0.10.0rc3.autoprune \r\nJust curious on what is the desired behaviour of -reindex when run on already pruned blocks ?\r\n",
      "created_at" : "2015-01-29T12:47:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72018451",
      "id" : 72018451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-01-29T12:47:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72018451",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/737092?v=3",
         "events_url" : "https://api.github.com/users/shivaenigma/events{/privacy}",
         "followers_url" : "https://api.github.com/users/shivaenigma/followers",
         "following_url" : "https://api.github.com/users/shivaenigma/following{/other_user}",
         "gists_url" : "https://api.github.com/users/shivaenigma/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/shivaenigma",
         "id" : 737092,
         "login" : "shivaenigma",
         "organizations_url" : "https://api.github.com/users/shivaenigma/orgs",
         "received_events_url" : "https://api.github.com/users/shivaenigma/received_events",
         "repos_url" : "https://api.github.com/users/shivaenigma/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/shivaenigma/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/shivaenigma/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/shivaenigma"
      }
   },
   {
      "body" : "I would assume reindexing would force it to redownload all the blocks from\r\nscratch.\r\n\r\nOn Thursday, January 29, 2015, shivaenigma <notifications@github.com> wrote:\r\n\r\n> Testing this from\r\n> https://github.com/luke-jr/bitcoin/tree/0.10.0rc3.autoprune\r\n> Just curious on what is the desired behaviour of -reindex when run on\r\n> already pruned blocks ?\r\n>\r\n> Ã¢ÂÂ\r\n> Reply to this email directly or view it on GitHub\r\n> <https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72018451>.\r\n>",
      "created_at" : "2015-01-29T13:48:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72026107",
      "id" : 72026107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-01-29T13:48:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72026107",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2559390?v=3",
         "events_url" : "https://api.github.com/users/Michagogo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Michagogo/followers",
         "following_url" : "https://api.github.com/users/Michagogo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Michagogo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Michagogo",
         "id" : 2559390,
         "login" : "Michagogo",
         "organizations_url" : "https://api.github.com/users/Michagogo/orgs",
         "received_events_url" : "https://api.github.com/users/Michagogo/received_events",
         "repos_url" : "https://api.github.com/users/Michagogo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Michagogo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Michagogo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Michagogo"
      }
   },
   {
      "body" : "Hi.  I've been testing this also (building from source) and I think the latest commit may have re-introduced the issue of re-opening a block and undo file for each block in the active chain.  Thus, on testnet (about 320k blocks) each call to CheckBlockFiles results in 640k calls to the file system.  I know that @rdponticelli has a separate PR (#4515) which appears to still have the code which should prevent this (using setRequiredDataFilesAreOpenable) - and which autoprune may eventually be built on top of. \r\n\r\nIt seems from the comment on the last commit that it was intended that this check was moved into a different function,  but if so, it doesn't seem to be working as intended? \r\n",
      "created_at" : "2015-01-29T19:59:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72093360",
      "id" : 72093360,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-01-29T19:59:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72093360",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7504522?v=3",
         "events_url" : "https://api.github.com/users/mrbandrews/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mrbandrews/followers",
         "following_url" : "https://api.github.com/users/mrbandrews/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mrbandrews/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mrbandrews",
         "id" : 7504522,
         "login" : "mrbandrews",
         "organizations_url" : "https://api.github.com/users/mrbandrews/orgs",
         "received_events_url" : "https://api.github.com/users/mrbandrews/received_events",
         "repos_url" : "https://api.github.com/users/mrbandrews/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mrbandrews/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mrbandrews/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mrbandrews"
      }
   },
   {
      "body" : "This has been tagged as v0.11. What time frame is that indicative of?",
      "created_at" : "2015-02-01T19:35:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72380007",
      "id" : 72380007,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-01T19:35:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72380007",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8286077?v=3",
         "events_url" : "https://api.github.com/users/21E14/events{/privacy}",
         "followers_url" : "https://api.github.com/users/21E14/followers",
         "following_url" : "https://api.github.com/users/21E14/following{/other_user}",
         "gists_url" : "https://api.github.com/users/21E14/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/21E14",
         "id" : 8286077,
         "login" : "21E14",
         "organizations_url" : "https://api.github.com/users/21E14/orgs",
         "received_events_url" : "https://api.github.com/users/21E14/received_events",
         "repos_url" : "https://api.github.com/users/21E14/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/21E14/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/21E14/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/21E14"
      }
   },
   {
      "body" : "@21E14  presumably and hopefully in the next couple months.  Right now much attention is focused on getting 0.10 out (as it should be), after that you should expect to see more attention on getting this merged from the rest of the contributors.",
      "created_at" : "2015-02-01T20:46:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72383360",
      "id" : 72383360,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-01T20:46:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72383360",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@21E14 July 2015 is the time frame for 0.11. The tag is no guarantee that it will make it into that release though, but just a reminder. If it isn't ready to merge well before 0.11's release date it will be bumped to 0.12.\r\n\r\nYou can help by testing and reviewing the code.\r\n",
      "created_at" : "2015-02-01T20:56:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72383774",
      "id" : 72383774,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-01T20:56:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72383774",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@gmaxwell @laanwj I'm assuming a few minor releases in-between?\r\n\r\nThis PR is looking pretty good so far. Running the daemon though, just for kicks, with the prune option set to less than 300 MiB results in the following awkward message:\r\n\r\n***\r\nAppInit2 : parameter interaction: -prune -> setting -disablewallet=1\r\nAutoprune configured below the minimum of 300MiB. Setting at the maximum possible of 17592186044415MiB, to avoid pruning too much. Please, check your configuration.\r\n***\r\n\r\nMore to the point, why even let a 'misconfigured prune' carry on?",
      "created_at" : "2015-02-02T00:29:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72393510",
      "id" : 72393510,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-02T00:29:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72393510",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8286077?v=3",
         "events_url" : "https://api.github.com/users/21E14/events{/privacy}",
         "followers_url" : "https://api.github.com/users/21E14/followers",
         "following_url" : "https://api.github.com/users/21E14/following{/other_user}",
         "gists_url" : "https://api.github.com/users/21E14/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/21E14",
         "id" : 8286077,
         "login" : "21E14",
         "organizations_url" : "https://api.github.com/users/21E14/orgs",
         "received_events_url" : "https://api.github.com/users/21E14/received_events",
         "repos_url" : "https://api.github.com/users/21E14/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/21E14/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/21E14/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/21E14"
      }
   },
   {
      "body" : "Did more testing from https://github.com/luke-jr/bitcoin/tree/0.10.0rc3.autoprune \r\nTested using -prune=300 and blocks are getting deleted \r\n\r\n\r\nBut sometimes size of .bitcoin/blocks is more than much more than 300\r\n`\r\n2015-02-04 17:34:59 Data for blocks from 1 to 184525 has been pruned\r\n2015-02-04 17:34:59 Undo data for blocks from 1 to 184525 has been pruned`\r\ndu -sh ~/.bitcoin/blocks/ is 496MB\r\n\r\nSwitching from pruned mode to nonpruned mode causes this:\r\n`\r\n Error checking required block files. There must be missing or unreadable data.\r\nDo you want to rebuild the block database now?`\r\n\r\n\r\n",
      "created_at" : "2015-02-04T17:40:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72901059",
      "id" : 72901059,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-04T18:34:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72901059",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/737092?v=3",
         "events_url" : "https://api.github.com/users/shivaenigma/events{/privacy}",
         "followers_url" : "https://api.github.com/users/shivaenigma/followers",
         "following_url" : "https://api.github.com/users/shivaenigma/following{/other_user}",
         "gists_url" : "https://api.github.com/users/shivaenigma/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/shivaenigma",
         "id" : 737092,
         "login" : "shivaenigma",
         "organizations_url" : "https://api.github.com/users/shivaenigma/orgs",
         "received_events_url" : "https://api.github.com/users/shivaenigma/received_events",
         "repos_url" : "https://api.github.com/users/shivaenigma/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/shivaenigma/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/shivaenigma/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/shivaenigma"
      }
   },
   {
      "body" : "@shivaenigma What's the size of the index/ directory? Perhaps that's the rest. I don't know if the index shrinks with a pruned node. A couple hundred megabytes is insignificant compared to 30+ GB, but indeed, with pruned nodes like this that does become a factor. And at the end, do you mean switching to non-pruned mode? In that case, yes, of course you're missing data -- you've just deleted most of the blockchain!",
      "created_at" : "2015-02-04T18:29:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72910211",
      "id" : 72910211,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-04T18:29:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72910211",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2559390?v=3",
         "events_url" : "https://api.github.com/users/Michagogo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Michagogo/followers",
         "following_url" : "https://api.github.com/users/Michagogo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Michagogo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Michagogo",
         "id" : 2559390,
         "login" : "Michagogo",
         "organizations_url" : "https://api.github.com/users/Michagogo/orgs",
         "received_events_url" : "https://api.github.com/users/Michagogo/received_events",
         "repos_url" : "https://api.github.com/users/Michagogo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Michagogo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Michagogo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Michagogo"
      }
   },
   {
      "body" : "@Michagogo \r\nsize of my blocks/index/ 34MB.  I think the parameter -pruned=300MB is misleading, even if after pruning the size end of 496MB . How does the error scale, so if I set 2GB will it take 2.1GB or 3GB\r\n\r\nso I guess its checking all the blocks at startup on non pruned mode and throws an error. I think there should be way to disable this check. Because now I can never switch from pruned mode to nonpruned mode even if I dont care about missing inital blocks",
      "created_at" : "2015-02-04T18:53:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72914789",
      "id" : 72914789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-04T18:53:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72914789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/737092?v=3",
         "events_url" : "https://api.github.com/users/shivaenigma/events{/privacy}",
         "followers_url" : "https://api.github.com/users/shivaenigma/followers",
         "following_url" : "https://api.github.com/users/shivaenigma/following{/other_user}",
         "gists_url" : "https://api.github.com/users/shivaenigma/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/shivaenigma",
         "id" : 737092,
         "login" : "shivaenigma",
         "organizations_url" : "https://api.github.com/users/shivaenigma/orgs",
         "received_events_url" : "https://api.github.com/users/shivaenigma/received_events",
         "repos_url" : "https://api.github.com/users/shivaenigma/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/shivaenigma/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/shivaenigma/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/shivaenigma"
      }
   },
   {
      "body" : "Uh, what? By definition, non-pruned means that you have the entire\nblockchain. So yes, you do need to redownload it. It would be nice, though,\nif it were smart enough to make the switch gracefully and just fill in the\nhistory, with the headers-first mechanism. If you mean you don't want to\nprune *more*, you can just set the threshold to something high (100000000\nor whatever) and you'll be covered for the foreseeable future.\n\nOn Wed, Feb 4, 2015 at 8:54 PM, shivaenigma <notifications@github.com>\nwrote:\n\n> @Michagogo <https://github.com/Michagogo>\n> size of my blocks/index/ 34MB. I think the parameter -pruned=300MB is\n> misleading, even if after pruning the size end of 496MB . How does the\n> error scale, so if I set 2GB will it take 2.1GB or 3GB\n>\n> so I guess its checking all the blocks at startup on non pruned mode and\n> throws an error. I think there should be way to disable this check. Because\n> now I can never switch from pruned mode to nonpruned mode even if I dont\n> care about missing inital blocks\n>\n> Ã¢ÂÂ\n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72914789>.\n>\n",
      "created_at" : "2015-02-04T19:06:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72917081",
      "id" : 72917081,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-04T19:06:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72917081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2559390?v=3",
         "events_url" : "https://api.github.com/users/Michagogo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Michagogo/followers",
         "following_url" : "https://api.github.com/users/Michagogo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Michagogo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Michagogo",
         "id" : 2559390,
         "login" : "Michagogo",
         "organizations_url" : "https://api.github.com/users/Michagogo/orgs",
         "received_events_url" : "https://api.github.com/users/Michagogo/received_events",
         "repos_url" : "https://api.github.com/users/Michagogo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Michagogo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Michagogo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Michagogo"
      }
   },
   {
      "body" : ">If you mean you don't want to prune *more*, you can just set the threshold to something high (100000000 or whatever) and you'll be covered for the foreseeable future\r\n\r\nYes this is actually what I wanted . Thanks\r\n",
      "created_at" : "2015-02-05T06:07:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-72999158",
      "id" : 72999158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-02-05T06:08:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72999158",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/737092?v=3",
         "events_url" : "https://api.github.com/users/shivaenigma/events{/privacy}",
         "followers_url" : "https://api.github.com/users/shivaenigma/followers",
         "following_url" : "https://api.github.com/users/shivaenigma/following{/other_user}",
         "gists_url" : "https://api.github.com/users/shivaenigma/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/shivaenigma",
         "id" : 737092,
         "login" : "shivaenigma",
         "organizations_url" : "https://api.github.com/users/shivaenigma/orgs",
         "received_events_url" : "https://api.github.com/users/shivaenigma/received_events",
         "repos_url" : "https://api.github.com/users/shivaenigma/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/shivaenigma/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/shivaenigma/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/shivaenigma"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24774566"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24774566"
         }
      },
      "body" : "There is a distinction in the expectation of what a node does. If you enable pruning, the node does not promise to the network to behave as a full node, so it's fine to not answer. If a node advertizes as NODE_NETWORK, and can't answer a request for a block, it's buggy.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-02-16T20:41:29Z",
      "diff_hunk" : "@@ -3347,30 +3511,36 @@ void static ProcessGetData(CNode* pfrom)\n                 {\n                     // Send block from disk\n                     CBlock block;\n-                    if (!ReadBlockFromDisk(block, (*mi).second))\n-                        assert(!\"cannot load block from disk\");\n-                    if (inv.type == MSG_BLOCK)\n-                        pfrom->PushMessage(\"block\", block);\n-                    else // MSG_FILTERED_BLOCK)\n-                    {\n-                        LOCK(pfrom->cs_filter);\n-                        if (pfrom->pfilter)\n-                        {\n-                            CMerkleBlock merkleBlock(block, *pfrom->pfilter);\n-                            pfrom->PushMessage(\"merkleblock\", merkleBlock);\n-                            // CMerkleBlock just contains hashes, so also push any transactions in the block the client did not see\n-                            // This avoids hurting performance by pointlessly requiring a round-trip\n-                            // Note that there is currently no way for a node to request any single transactions we didnt send here -\n-                            // they must either disconnect and retry or request the full block.\n-                            // Thus, the protocol spec specified allows for us to provide duplicate txn here,\n-                            // however we MUST always provide at least what the remote peer needs\n-                            typedef std::pair<unsigned int, uint256> PairType;\n-                            BOOST_FOREACH(PairType& pair, merkleBlock.vMatchedTxn)\n-                                if (!pfrom->setInventoryKnown.count(CInv(MSG_TX, pair.second)))\n-                                    pfrom->PushMessage(\"tx\", block.vtx[pair.first]);\n+                    if (!ReadBlockFromDisk(block, (*mi).second)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24774566",
      "id" : 24774566,
      "original_commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "original_position" : 278,
      "path" : "src/main.cpp",
      "position" : 278,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-02-16T20:41:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24774566",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24774757"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24774757"
         }
      },
      "body" : "I think it's more clear if you just say something like \"Leaving pruned mode enabled, but not deleting any more blocks for now\".",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-02-16T20:45:02Z",
      "diff_hunk" : "@@ -673,6 +690,15 @@ bool AppInit2(boost::thread_group& threadGroup)\n         nScriptCheckThreads = MAX_SCRIPTCHECK_THREADS;\n \n     fServer = GetBoolArg(\"-server\", false);\n+    nPrune = GetArg(\"-prune\", 0) * 1024 * 1024;\n+    if (nPrune) {\n+        if (nPrune >= MIN_BLOCK_FILES_SIZE)\n+            LogPrintf(\"Autoprune configured to use less than %uMiB on disk for block files.\\n\", nPrune / 1024 / 1024);\n+        else {\n+            nPrune = ~0;\n+            LogPrintf(\"Autoprune configured below the minimum of %uMiB. Setting at the maximum possible of %uMiB, to avoid pruning too much. Please, check your configuration.\\n\", MIN_BLOCK_FILES_SIZE / 1024 / 1024, nPrune / 1024 / 1024);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24774757",
      "id" : 24774757,
      "original_commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "original_position" : 41,
      "path" : "src/init.cpp",
      "position" : 41,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-02-16T20:45:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24774757",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24775005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24775005"
         }
      },
      "body" : "Is it guaranteed that both setDataFilePrunable and setUndoFilePrunable are both non-empty at this stage? The test above only guarantees that at least one of them is non-empty. Don't dereference begin() of an empty set.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-02-16T20:49:42Z",
      "diff_hunk" : "@@ -2789,6 +2791,80 @@ bool TestBlockValidity(CValidationState &state, const CBlock& block, CBlockIndex\n \n \n \n+void ClearBlockFileInfo(int nFile)\n+{\n+    LOCK(cs_main);\n+    if (vinfoBlockFile[nFile].nUndoSize)\n+        vinfoBlockFile[nFile].nSize = 0;\n+    else\n+        vinfoBlockFile[nFile].SetNull();\n+    setDirtyFileInfo.insert(nFile);\n+}\n+\n+void ClearUndoFileInfo(int nFile)\n+{\n+    LOCK(cs_main);\n+    if (vinfoBlockFile[nFile].nSize)\n+        vinfoBlockFile[nFile].nUndoSize = 0;\n+    else\n+        vinfoBlockFile[nFile].SetNull();\n+    setDirtyFileInfo.insert(nFile);\n+}\n+\n+enum BlockOrUndo {\n+    BLOCK = false,\n+    UNDO = true\n+};\n+\n+bool RemoveDiskFile(int nFile, BlockOrUndo blockOrUndo)\n+{\n+    LOCK(cs_main);\n+    CDiskBlockPos pos(nFile, 0);\n+    const char* prefix = blockOrUndo ? \"rev\" : \"blk\";\n+    if (boost::filesystem::remove(GetBlockPosFilename(pos, prefix))) {\n+        LogPrintf(\"File %s removed\\n\", GetBlockPosFilename(pos, prefix));\n+        blockOrUndo ? ClearUndoFileInfo(nFile) : ClearBlockFileInfo(nFile);\n+        return true;\n+    }\n+    LogPrintf(\"Error removing file %s\\n\", GetBlockPosFilename(pos, prefix));\n+    return false;\n+}\n+\n+bool RemoveBlockFile(int nFile)\n+{\n+    return RemoveDiskFile(nFile, BLOCK);\n+}\n+\n+bool RemoveUndoFile(int nFile)\n+{\n+    return RemoveDiskFile(nFile, UNDO);\n+}\n+\n+\n+\n+bool PruneBlockFiles()\n+{\n+    if (!CheckBlockFiles())\n+        return false;\n+    if (setDataFilePrunable.empty() && setUndoFilePrunable.empty()) {\n+        LogPrintf(\"There's nothing to prune.\\n\");\n+        return false;\n+    }\n+    bool fFileRemoved = false;\n+    int dataPrunable = *setDataFilePrunable.begin(), undoPrunable = *setUndoFilePrunable.begin();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24775005",
      "id" : 24775005,
      "original_commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "original_position" : 80,
      "path" : "src/main.cpp",
      "position" : 80,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-02-16T20:49:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24775005",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24782232"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24782232"
         }
      },
      "body" : "This may lose never-fully-connected branches. I think this condition as a whole should just change to (pindex->nStatus & BLOCK_VALID_TRANSACTIONS && pindex->nTx != 0).",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-02-16T23:16:59Z",
      "diff_hunk" : "@@ -2886,7 +2979,7 @@ bool static LoadBlockIndexDB()\n     {\n         CBlockIndex* pindex = item.second;\n         pindex->nChainWork = (pindex->pprev ? pindex->pprev->nChainWork : 0) + GetBlockProof(*pindex);\n-        if (pindex->nStatus & BLOCK_HAVE_DATA) {\n+        if (pindex->nStatus & BLOCK_HAVE_DATA || pindex->nStatus & BLOCK_VALID_CHAIN) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24782232",
      "id" : 24782232,
      "original_commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "original_position" : 128,
      "path" : "src/main.cpp",
      "position" : 128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-02-16T23:16:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24782232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24782386"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24782386"
         }
      },
      "body" : "This shouldn't require BLOCK_VALID_CHAIN anymore; I think BLOCK_VALID_TRANSACTIONS is enough.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-02-16T23:20:32Z",
      "diff_hunk" : "@@ -2968,6 +3043,95 @@ bool static LoadBlockIndexDB()\n     return true;\n }\n \n+bool BlockFileIsOpenable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    if (!vinfoBlockFile[nFile].nSize)\n+        return false;\n+    if (CAutoFile(OpenBlockFile(pos, true), SER_DISK, CLIENT_VERSION).IsNull()) {\n+        ClearBlockFileInfo(nFile);\n+        return false;\n+    }\n+    return true;\n+}\n+\n+bool UndoFileIsOpenable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    if (!vinfoBlockFile[nFile].nUndoSize)\n+        return false;\n+    if (CAutoFile(OpenUndoFile(pos, true), SER_DISK, CLIENT_VERSION).IsNull()) {\n+        ClearUndoFileInfo(nFile);\n+        return false;\n+    }\n+    return true;\n+}\n+\n+bool DataFilesAreOpenable(int nFile)\n+{\n+    if (BlockFileIsOpenable(nFile) && UndoFileIsOpenable(nFile))\n+        return true;\n+    return false;\n+}\n+\n+int LastBlockInFile(int nFile)\n+{\n+    return vinfoBlockFile[nFile].nHeightLast;\n+}\n+\n+\n+bool CheckBlockFiles()\n+{\n+    LOCK(cs_main);\n+    // Check presence of blk files\n+    int nKeepMinBlksFromHeight = nPrune ? (max((int)(chainActive.Height() - MIN_BLOCKS_TO_KEEP), 0)) : 0;\n+    LogPrintf(\"Checking all required data for active chain is available (mandatory from height %i to %i)\\n\", nKeepMinBlksFromHeight, max(chainActive.Height(), 0));\n+    set<int> setDataPruned, setUndoPruned;\n+    setDataFilePrunable.clear();\n+    setUndoFilePrunable.clear();\n+    for (CBlockIndex* pindex = chainActive.Tip(); pindex && pindex->pprev; pindex = pindex->pprev) {\n+        if (pindex->nHeight > nKeepMinBlksFromHeight) {\n+            if (!(pindex->nStatus & BLOCK_HAVE_DATA) || !(pindex->nStatus & BLOCK_HAVE_UNDO)) { // Fail immediately if required data is missing\n+                LogPrintf(\"Error: Required data for block: %i is missing.\\n\", pindex->nHeight);\n+                return false;\n+            } else if (!DataFilesAreOpenable(pindex->nFile)) { // Or if data is unreadable\n+                LogPrintf(\"Error: Required file for block: %i can't be opened.\\n\", pindex->nHeight);\n+                return false;\n+            }\n+        } else { // Check consistency and pruneability of unrequired data\n+            if (pindex->nStatus & BLOCK_HAVE_DATA) {\n+                if (BlockFileIsOpenable(pindex->nFile)) {\n+                    if (chainActive.Height() > AUTOPRUNE_AFTER_HEIGHT && LastBlockInFile(pindex->nFile) < nKeepMinBlksFromHeight) { // Mark pruneable data\n+                        setDataFilePrunable.insert(pindex->nFile);\n+                    }\n+                } else {\n+                    pindex->nStatus &= ~BLOCK_HAVE_DATA;\n+                    setDirtyBlockIndex.insert(pindex);\n+                }\n+            }\n+            if (pindex->nStatus & BLOCK_HAVE_UNDO) {\n+                if (UndoFileIsOpenable(pindex->nFile)) {\n+                    if (chainActive.Height() > AUTOPRUNE_AFTER_HEIGHT && LastBlockInFile(pindex->nFile) < nKeepMinBlksFromHeight) { // Mark pruneable data\n+                        setUndoFilePrunable.insert(pindex->nFile);\n+                    }\n+                } else {\n+                    pindex->nStatus &= ~BLOCK_HAVE_UNDO;\n+                    setDirtyBlockIndex.insert(pindex);\n+                }\n+            }\n+        }\n+        if (~pindex->nStatus & BLOCK_HAVE_DATA && pindex->nStatus & BLOCK_VALID_CHAIN)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24782386",
      "id" : 24782386,
      "original_commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "original_position" : 238,
      "path" : "src/main.cpp",
      "position" : 238,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-02-16T23:20:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24782386",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24783758"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24783758"
         }
      },
      "body" : "This will not iterate over side branches of the block chain, and may perhaps miss things that way. The chances for that are really low, as this code still checks the last height in each affected file, and then deletes whole files, so unless a file consists solely of side branch blocks, it will still be processed.\r\n\r\nHowever, I think this flaw indicates a conceptual mistake: this function should iterate over files, rather than over blocks. That would be faster too. The concistency check can be done on blocks separately, but only needs to be done for the last blocks I guess?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-02-16T23:57:29Z",
      "diff_hunk" : "@@ -2968,6 +3043,95 @@ bool static LoadBlockIndexDB()\n     return true;\n }\n \n+bool BlockFileIsOpenable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    if (!vinfoBlockFile[nFile].nSize)\n+        return false;\n+    if (CAutoFile(OpenBlockFile(pos, true), SER_DISK, CLIENT_VERSION).IsNull()) {\n+        ClearBlockFileInfo(nFile);\n+        return false;\n+    }\n+    return true;\n+}\n+\n+bool UndoFileIsOpenable(int nFile)\n+{\n+    CDiskBlockPos pos(nFile, 0);\n+    if (!vinfoBlockFile[nFile].nUndoSize)\n+        return false;\n+    if (CAutoFile(OpenUndoFile(pos, true), SER_DISK, CLIENT_VERSION).IsNull()) {\n+        ClearUndoFileInfo(nFile);\n+        return false;\n+    }\n+    return true;\n+}\n+\n+bool DataFilesAreOpenable(int nFile)\n+{\n+    if (BlockFileIsOpenable(nFile) && UndoFileIsOpenable(nFile))\n+        return true;\n+    return false;\n+}\n+\n+int LastBlockInFile(int nFile)\n+{\n+    return vinfoBlockFile[nFile].nHeightLast;\n+}\n+\n+\n+bool CheckBlockFiles()\n+{\n+    LOCK(cs_main);\n+    // Check presence of blk files\n+    int nKeepMinBlksFromHeight = nPrune ? (max((int)(chainActive.Height() - MIN_BLOCKS_TO_KEEP), 0)) : 0;\n+    LogPrintf(\"Checking all required data for active chain is available (mandatory from height %i to %i)\\n\", nKeepMinBlksFromHeight, max(chainActive.Height(), 0));\n+    set<int> setDataPruned, setUndoPruned;\n+    setDataFilePrunable.clear();\n+    setUndoFilePrunable.clear();\n+    for (CBlockIndex* pindex = chainActive.Tip(); pindex && pindex->pprev; pindex = pindex->pprev) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r24783758",
      "id" : 24783758,
      "original_commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "original_position" : 207,
      "path" : "src/main.cpp",
      "position" : 207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-02-16T23:57:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/24783758",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Do you plan to work on this any more in the future? If not, I may try to maintain/update it.",
      "created_at" : "2015-03-01T12:21:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-76594491",
      "id" : 76594491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-03-01T12:21:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/76594491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Closing in favor of #5863",
      "created_at" : "2015-03-09T08:31:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#issuecomment-77815872",
      "id" : 77815872,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4701",
      "updated_at" : "2015-03-09T08:31:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/77815872",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r32412396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32412396"
         }
      },
      "body" : "@laanwj Would it be desirable to add SPV support to Bitcoin Core now that pruning is included?",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-06-15T12:00:02Z",
      "diff_hunk" : "@@ -598,6 +602,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (GetArg(\"-prune\", 0)) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Prune mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {\n+            if (SoftSetBoolArg(\"-disablewallet\", true))\n+                LogPrintf(\"%s : parameter interaction: -prune -> setting -disablewallet=1\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r32412396",
      "id" : 32412396,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 21,
      "path" : "src/init.cpp",
      "position" : 21,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-06-15T12:00:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32412396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r32413098"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32413098"
         }
      },
      "body" : "SPV and autoprune are orthogonal IMO.\r\nI'm working on a SPV mode for bitcoin-cores wallet.",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-06-15T12:11:14Z",
      "diff_hunk" : "@@ -598,6 +602,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (GetArg(\"-prune\", 0)) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Prune mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {\n+            if (SoftSetBoolArg(\"-disablewallet\", true))\n+                LogPrintf(\"%s : parameter interaction: -prune -> setting -disablewallet=1\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r32413098",
      "id" : 32413098,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 21,
      "path" : "src/init.cpp",
      "position" : 21,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-06-15T12:11:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32413098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r32413345"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32413345"
         }
      },
      "body" : "I was wrong in my above comment, it is possible to use the wallet with pruning as of #6057. It just excludes some operations such as rescanning which need the entire chain.\r\n\r\nSPV mode is orthogonal to that, though. That has always been desirable, and pruning hasn't changed that.\r\n",
      "commit_id" : "bbb769c5c1d7c13f1edc11de3209da10184897d5",
      "created_at" : "2015-06-15T12:15:06Z",
      "diff_hunk" : "@@ -598,6 +602,19 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    if (GetArg(\"-prune\", 0)) {\n+        if (GetBoolArg(\"-txindex\", false))\n+            return InitError(_(\"Prune mode is incompatible with -txindex.\"));\n+#ifdef ENABLE_WALLET\n+        if (!GetBoolArg(\"-disablewallet\", false)) {\n+            if (SoftSetBoolArg(\"-disablewallet\", true))\n+                LogPrintf(\"%s : parameter interaction: -prune -> setting -disablewallet=1\\n\", __func__);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4701#discussion_r32413345",
      "id" : 32413345,
      "original_commit_id" : "df07387e469810f59ecd20ec4d155156f7e2e9fb",
      "original_position" : 21,
      "path" : "src/init.cpp",
      "position" : 21,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4701",
      "updated_at" : "2015-06-15T12:15:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/32413345",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
