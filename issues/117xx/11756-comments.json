[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Wouldn't be better to rescan the chain (load blocks, etc) only once and give it to each wallet to concurrently check for transactions?",
      "created_at" : "2018-02-21T23:28:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11756#issuecomment-367513956",
      "id" : 367513956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11756",
      "updated_at" : "2018-02-21T23:28:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/367513956",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Indeed, it's been on my todo list (for after multiwallet is completely merged) for a while...",
      "created_at" : "2018-02-21T23:48:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11756#issuecomment-367517890",
      "id" : 367517890,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11756",
      "updated_at" : "2018-02-21T23:48:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/367517890",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ariard has an experimental implementation of this which not only rescans wallets in parallel, but indexes as well\r\n\r\nhttps://gist.github.com/ariard/89f9bcc3a7ab9576fc6d15d251032cfa\r\nhttps://github.com/bitcoin/bitcoin/compare/master...ariard:2019-07-rework-rescan\r\nhttps://github.com/bitcoin/bitcoin/compare/master...ariard:2019-08-rescan-index-refactor",
      "created_at" : "2020-06-01T18:46:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11756#issuecomment-637038714",
      "id" : 637038714,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11756",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNzAzODcxNA==",
      "updated_at" : "2020-06-01T18:46:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/637038714",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@pstratem Just catching on some of your wallet rescan comments in IRC. Want to make sure you're aware we'd like to remove ScanForWalletTransactions and replace it with parallel scanning code here:\r\n\r\nhttps://github.com/ariard/bitcoin/blob/2019-08-rescan-index-refactor/src/node/rescan.h\r\nhttps://github.com/ariard/bitcoin/blob/2019-08-rescan-index-refactor/src/node/rescan.cpp\r\n\r\nSome more links in https://github.com/bitcoin/bitcoin/issues/11756#issuecomment-637038714",
      "created_at" : "2020-06-09T15:33:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11756#issuecomment-641383931",
      "id" : 641383931,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11756",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MTM4MzkzMQ==",
      "updated_at" : "2020-06-09T15:33:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641383931",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky You may be interested by https://github.com/ariard/bitcoin/tree/2020-02-wallet-standalone, which was a starting clean-up of linked above branches. \r\n\r\nI was aiming to go further and split the server (a.k.a indexes) in its own process, like `bitcoin-server` but was waiting for Core dev meetup before going further as it could have been subject to discussion in the approach. Generally I think we can dissociate headers servicing from addresses syncing, like the wallet would register a list of address and that would be the job of the server to notify the wallet back.  Instead of sending whole blocks to wallet.\r\n\r\nThat would be a trade-off between more storage for maintaining addresses index compare to performance but maybe worthy of it.\r\n\r\nWith regards to threading model, you may have 1) one thread syncing in-parallel multiple wallets, based on lower registration or 2) a thread pool, each assigns to a wallet for sync. An issue with 1) is if Wallet A is at block 100 and Wallet B and C are sync to block 10000, they will have to starve until A has catched-up with them instead of making progress on their own.",
      "created_at" : "2020-06-15T23:31:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11756#issuecomment-644443393",
      "id" : 644443393,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11756",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NDQ0MzM5Mw==",
      "updated_at" : "2020-06-15T23:36:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/644443393",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "...\r\n> With regards to threading model, you may have 1) one thread syncing in-parallel multiple wallets, based on lower registration or 2) a thread pool, each assigns to a wallet for sync. An issue with 1) is if Wallet A is at block 100 and Wallet B and C are sync to block 10000, they will have to starve until A has catched-up with them instead of making progress on their own.\r\n\r\nAnd an issue if new addresses are created. Could be worked around, yet. I like your solution, because it can be made in short term. Threads would come later (and really help).\r\n\r\nThanks all for your efforts. The topic is getting critical to us. Currently, any wallet rescan freezes the use of bitcoind for all other wallets. It can take 30 minutes to re-sync a wallet that has not been loaded for 6 months.",
      "created_at" : "2020-07-24T01:27:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11756#issuecomment-663309118",
      "id" : 663309118,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11756",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MzMwOTExOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-24T01:27:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/663309118",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/47175970?v=4",
         "events_url" : "https://api.github.com/users/fscemama/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fscemama/followers",
         "following_url" : "https://api.github.com/users/fscemama/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fscemama/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fscemama",
         "id" : 47175970,
         "login" : "fscemama",
         "node_id" : "MDQ6VXNlcjQ3MTc1OTcw",
         "organizations_url" : "https://api.github.com/users/fscemama/orgs",
         "received_events_url" : "https://api.github.com/users/fscemama/received_events",
         "repos_url" : "https://api.github.com/users/fscemama/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fscemama/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fscemama/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fscemama"
      }
   }
]
