[
   {
      "author_association" : "MEMBER",
      "body" : "@jonatack @troygiorshev - you both concept ACKed this branch in #19364.",
      "created_at" : "2020-07-12T10:32:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-657203897",
      "id" : 657203897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzIwMzg5Nw==",
      "updated_at" : "2020-07-12T10:32:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657203897",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453326299"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453326299"
         }
      },
      "author_association" : "MEMBER",
      "body" : "2ec4eeadb nit, can mention \"Reference to\" here as well",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-12T14:53:51Z",
      "diff_hunk" : "@@ -1925,64 +1936,67 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman* connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman* connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Reference to the connection manager\n+ * @param[in]      mempool          Reference to mempool\n+ * @param[in/out]  orphan_work_set  The set of orphan transactions to reconsider. Only one",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453326299",
      "id" : 453326299,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyNjI5OQ==",
      "original_commit_id" : "9c954f4a86a3a1bc804fa264a5c2a78410881eda",
      "original_line" : 1967,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 446885460,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453326299",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453329191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453329191"
         }
      },
      "author_association" : "MEMBER",
      "body" : "9c954f4 it looks like `connman` can be reference to const?",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-12T15:16:28Z",
      "diff_hunk" : "@@ -1925,64 +1936,67 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman* connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman* connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Reference to the connection manager",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453329191",
      "id" : 453329191,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyOTE5MQ==",
      "original_commit_id" : "9c954f4a86a3a1bc804fa264a5c2a78410881eda",
      "original_line" : 1965,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 446885460,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453329191",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453329442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453329442"
         }
      },
      "author_association" : "MEMBER",
      "body" : "2ec4eead [in/out]? (`mempool` needs to be mutable)",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-12T15:18:36Z",
      "diff_hunk" : "@@ -1925,64 +1936,67 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman* connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman* connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Reference to the connection manager\n+ * @param[in]      mempool          Reference to mempool",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453329442",
      "id" : 453329442,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyOTQ0Mg==",
      "original_commit_id" : "9c954f4a86a3a1bc804fa264a5c2a78410881eda",
      "original_line" : 1966,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 446885460,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453329442",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20025 (validation/util: add GetTransactionFee by gzhao408)\n* #19911 (net: guard vRecvGetData with cs_vRecv and orphan_work_set with g_cs_orphans by narula)\n* #19339 (validation: re-delegate absurd fee checking from mempool to clients by gzhao408)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-07-12T17:14:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-657250971",
      "id" : 657250971,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzI1MDk3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-30T12:09:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657250971",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> are the behavior changes desirable in themselves or ignorable side effects\r\n\r\nThere are no observable functional changes. The behavior changes are simply in the timing of how items are popped off the orphan_work_set list. They make the control flow of the function much easier to follow. After these changes either:\r\n- orphan_work_set is empty and the function does nothing; or\r\n- the function pops one item off orphan_work_set and processes it.",
      "created_at" : "2020-07-12T17:15:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-657251121",
      "id" : 657251121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzI1MTEyMQ==",
      "updated_at" : "2020-07-12T17:15:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657251121",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453341350"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453341350"
         }
      },
      "author_association" : "MEMBER",
      "body" : "hmmm I'm not sure. mempool isn't used by the caller after the function returns, so I'm not sure I'd call it an 'out param'. Just because an argument is non-const, I don't think that automatically makes it an out-param.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-12T17:16:14Z",
      "diff_hunk" : "@@ -1925,64 +1936,67 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman* connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman* connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Reference to the connection manager\n+ * @param[in]      mempool          Reference to mempool",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453341350",
      "id" : 453341350,
      "in_reply_to_id" : 453329442,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzM0MTM1MA==",
      "original_commit_id" : "9c954f4a86a3a1bc804fa264a5c2a78410881eda",
      "original_line" : 1966,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 446895782,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453341350",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453341355"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453341355"
         }
      },
      "author_association" : "MEMBER",
      "body" : "sure. Done",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-12T17:16:17Z",
      "diff_hunk" : "@@ -1925,64 +1936,67 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman* connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman* connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Reference to the connection manager",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453341355",
      "id" : 453341355,
      "in_reply_to_id" : 453329191,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzM0MTM1NQ==",
      "original_commit_id" : "9c954f4a86a3a1bc804fa264a5c2a78410881eda",
      "original_line" : 1965,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 446895785,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453341355",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453341357"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453341357"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Meh. I think I'd prefer to remove \"Reference to\" from the others than add this.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-12T17:16:19Z",
      "diff_hunk" : "@@ -1925,64 +1936,67 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman* connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman* connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Reference to the connection manager\n+ * @param[in]      mempool          Reference to mempool\n+ * @param[in/out]  orphan_work_set  The set of orphan transactions to reconsider. Only one",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r453341357",
      "id" : 453341357,
      "in_reply_to_id" : 453326299,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzM0MTM1Nw==",
      "original_commit_id" : "9c954f4a86a3a1bc804fa264a5c2a78410881eda",
      "original_line" : 1967,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 446895789,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453341357",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-14T15:42:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-658254250",
      "id" : 658254250,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1ODI1NDI1MA==",
      "updated_at" : "2020-07-14T15:42:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658254250",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased",
      "created_at" : "2020-07-15T09:48:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-658668490",
      "id" : 658668490,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1ODY2ODQ5MA==",
      "updated_at" : "2020-07-15T09:48:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658668490",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-16T07:31:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-659216481",
      "id" : 659216481,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1OTIxNjQ4MQ==",
      "updated_at" : "2020-07-16T07:31:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/659216481",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased",
      "created_at" : "2020-07-16T09:36:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-659297029",
      "id" : 659297029,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1OTI5NzAyOQ==",
      "updated_at" : "2020-07-16T09:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/659297029",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-22T20:15:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-662673079",
      "id" : 662673079,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MjY3MzA3OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-22T20:15:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/662673079",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased",
      "created_at" : "2020-07-23T10:07:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-662924153",
      "id" : 662924153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MjkyNDE1Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-23T10:07:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/662924153",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459717381"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459717381"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is now unused and can be removed.\r\n\r\nThis is the only thing blocking my ACK.\r\n\r\n+1 to the removal of an out param! ð ",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-23T20:44:42Z",
      "diff_hunk" : "@@ -3763,10 +3777,7 @@ bool PeerLogicValidation::ProcessMessages(CNode* pfrom, std::atomic<bool>& inter\n     if (!pfrom->orphan_work_set.empty()) {\n         std::list<CTransactionRef> removed_txn;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459717381",
      "id" : 459717381,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTcxNzM4MQ==",
      "original_commit_id" : "eb30f87e0972faae78df7c6116bc18f6fad7b353",
      "original_line" : 3778,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 454481109,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459717381",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5553787?v=4",
         "events_url" : "https://api.github.com/users/troygiorshev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/troygiorshev/followers",
         "following_url" : "https://api.github.com/users/troygiorshev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/troygiorshev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/troygiorshev",
         "id" : 5553787,
         "login" : "troygiorshev",
         "node_id" : "MDQ6VXNlcjU1NTM3ODc=",
         "organizations_url" : "https://api.github.com/users/troygiorshev/orgs",
         "received_events_url" : "https://api.github.com/users/troygiorshev/received_events",
         "repos_url" : "https://api.github.com/users/troygiorshev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/troygiorshev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/troygiorshev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/troygiorshev"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459718641"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459718641"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "non-blocking personal-opinion nit:\r\nI would prefer the docs to be wrapped to 80 ð» ",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-23T20:47:13Z",
      "diff_hunk" : "@@ -1992,77 +2003,80 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman& connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman& connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Connection manager\n+ * @param[in]      mempool          Mempool\n+ * @param[in/out]  orphan_work_set  The set of orphan transactions to reconsider. Generally only one\n+ *                                  orphan will be reconsidered on each call of this function. This set\n+ *                                  may be added to if accepting an orphan causes its children to be\n+ *                                  reconsidered.\n+ */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459718641",
      "id" : 459718641,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTcxODY0MQ==",
      "original_commit_id" : "eb30f87e0972faae78df7c6116bc18f6fad7b353",
      "original_line" : 2017,
      "original_position" : 49,
      "original_start_line" : 2006,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 454481109,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459718641",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5553787?v=4",
         "events_url" : "https://api.github.com/users/troygiorshev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/troygiorshev/followers",
         "following_url" : "https://api.github.com/users/troygiorshev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/troygiorshev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/troygiorshev",
         "id" : 5553787,
         "login" : "troygiorshev",
         "node_id" : "MDQ6VXNlcjU1NTM3ODc=",
         "organizations_url" : "https://api.github.com/users/troygiorshev/orgs",
         "received_events_url" : "https://api.github.com/users/troygiorshev/received_events",
         "repos_url" : "https://api.github.com/users/troygiorshev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/troygiorshev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/troygiorshev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/troygiorshev"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459724743"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459724743"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Looks like the same can be done at for AcceptToMemoryPool, [here](https://github.com/jnewbery/bitcoin/blob/eb30f87e0972faae78df7c6116bc18f6fad7b353/src/net_processing.cpp#L2957) and [here](https://github.com/jnewbery/bitcoin/blob/2020-07-orphan-tidy/src/net_processing.cpp#L2972).\r\n\r\nI've checked all of AcceptToMemoryPool's call sites, I think we can do the same thing and remove two more out parameters!  (AcceptToMemoryPool just calls AcceptToMemoryPoolWithTime)  Maybe.\r\n\r\n(For a Follow-up)",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-23T20:59:26Z",
      "diff_hunk" : "@@ -3763,10 +3777,7 @@ bool PeerLogicValidation::ProcessMessages(CNode* pfrom, std::atomic<bool>& inter\n     if (!pfrom->orphan_work_set.empty()) {\n         std::list<CTransactionRef> removed_txn;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459724743",
      "id" : 459724743,
      "in_reply_to_id" : 459717381,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTcyNDc0Mw==",
      "original_commit_id" : "eb30f87e0972faae78df7c6116bc18f6fad7b353",
      "original_line" : 3778,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 454481109,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459724743",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5553787?v=4",
         "events_url" : "https://api.github.com/users/troygiorshev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/troygiorshev/followers",
         "following_url" : "https://api.github.com/users/troygiorshev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/troygiorshev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/troygiorshev",
         "id" : 5553787,
         "login" : "troygiorshev",
         "node_id" : "MDQ6VXNlcjU1NTM3ODc=",
         "organizations_url" : "https://api.github.com/users/troygiorshev/orgs",
         "received_events_url" : "https://api.github.com/users/troygiorshev/received_events",
         "repos_url" : "https://api.github.com/users/troygiorshev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/troygiorshev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/troygiorshev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/troygiorshev"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459897258"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459897258"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We don't have a project-wide style for this, although I try to keep my lines under 120 chars. 80 feels is a bit stingy to me.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-24T07:39:14Z",
      "diff_hunk" : "@@ -1992,77 +2003,80 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman& connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman& connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Connection manager\n+ * @param[in]      mempool          Mempool\n+ * @param[in/out]  orphan_work_set  The set of orphan transactions to reconsider. Generally only one\n+ *                                  orphan will be reconsidered on each call of this function. This set\n+ *                                  may be added to if accepting an orphan causes its children to be\n+ *                                  reconsidered.\n+ */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459897258",
      "id" : 459897258,
      "in_reply_to_id" : 459718641,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg5NzI1OA==",
      "original_commit_id" : "eb30f87e0972faae78df7c6116bc18f6fad7b353",
      "original_line" : 2017,
      "original_position" : 49,
      "original_start_line" : 2006,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 454688022,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459897258",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459902407"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459902407"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks. Removed `removed_txn`\r\n\r\nThose out params are still needed in AcceptToMemoryPool. They're used to add the removed transactions to the compact block extra transactions here: https://github.com/jnewbery/bitcoin/blob/66ae250195ab7c5c94f72fa9cf222992e1ac46c1/src/net_processing.cpp#L2946-L2947",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-24T07:51:24Z",
      "diff_hunk" : "@@ -3763,10 +3777,7 @@ bool PeerLogicValidation::ProcessMessages(CNode* pfrom, std::atomic<bool>& inter\n     if (!pfrom->orphan_work_set.empty()) {\n         std::list<CTransactionRef> removed_txn;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459902407",
      "id" : 459902407,
      "in_reply_to_id" : 459717381,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkwMjQwNw==",
      "original_commit_id" : "eb30f87e0972faae78df7c6116bc18f6fad7b353",
      "original_line" : 3778,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 454694277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459902407",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review @troygiorshev . I've addressed your comment in the lastest force-push:  https://github.com/bitcoin/bitcoin/compare/eb30f87e0972faae78df7c6116bc18f6fad7b353..833bccc522703f87d0d46b190a9a29bcb633c615",
      "created_at" : "2020-07-24T08:12:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-663402394",
      "id" : 663402394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MzQwMjM5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-24T08:12:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/663402394",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459995200"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459995200"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm suggesting that calls to AddtoCompactExtraTransactions be moved into AcceptToMemoryPoolWithTime, in a similar manner to how you moved it into ProcessOrphanTx.  I'm pretty sure this is possible, whether it's a good idea or not is something I'm less sure about.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-24T11:23:56Z",
      "diff_hunk" : "@@ -3763,10 +3777,7 @@ bool PeerLogicValidation::ProcessMessages(CNode* pfrom, std::atomic<bool>& inter\n     if (!pfrom->orphan_work_set.empty()) {\n         std::list<CTransactionRef> removed_txn;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r459995200",
      "id" : 459995200,
      "in_reply_to_id" : 459717381,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5NTIwMA==",
      "original_commit_id" : "eb30f87e0972faae78df7c6116bc18f6fad7b353",
      "original_line" : 3778,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 454811548,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/459995200",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5553787?v=4",
         "events_url" : "https://api.github.com/users/troygiorshev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/troygiorshev/followers",
         "following_url" : "https://api.github.com/users/troygiorshev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/troygiorshev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/troygiorshev",
         "id" : 5553787,
         "login" : "troygiorshev",
         "node_id" : "MDQ6VXNlcjU1NTM3ODc=",
         "organizations_url" : "https://api.github.com/users/troygiorshev/orgs",
         "received_events_url" : "https://api.github.com/users/troygiorshev/received_events",
         "repos_url" : "https://api.github.com/users/troygiorshev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/troygiorshev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/troygiorshev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/troygiorshev"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "tACK 833bccc via `git range-diff master eb30f87 833bccc`",
      "created_at" : "2020-07-24T11:26:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-663493644",
      "id" : 663493644,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MzQ5MzY0NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-24T11:26:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/663493644",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5553787?v=4",
         "events_url" : "https://api.github.com/users/troygiorshev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/troygiorshev/followers",
         "following_url" : "https://api.github.com/users/troygiorshev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/troygiorshev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/troygiorshev",
         "id" : 5553787,
         "login" : "troygiorshev",
         "node_id" : "MDQ6VXNlcjU1NTM3ODc=",
         "organizations_url" : "https://api.github.com/users/troygiorshev/orgs",
         "received_events_url" : "https://api.github.com/users/troygiorshev/received_events",
         "repos_url" : "https://api.github.com/users/troygiorshev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/troygiorshev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/troygiorshev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/troygiorshev"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460013880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460013880"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That would be a layer violation. `AddToCompactExtraTransactions()` is a net_processing function, adding data to a net_processing data structure. `AcceptToMemoryPool()` and the functions it calls are validation functions and shouldn't call into net_processing.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-24T12:10:38Z",
      "diff_hunk" : "@@ -3763,10 +3777,7 @@ bool PeerLogicValidation::ProcessMessages(CNode* pfrom, std::atomic<bool>& inter\n     if (!pfrom->orphan_work_set.empty()) {\n         std::list<CTransactionRef> removed_txn;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460013880",
      "id" : 460013880,
      "in_reply_to_id" : 459717381,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAxMzg4MA==",
      "original_commit_id" : "eb30f87e0972faae78df7c6116bc18f6fad7b353",
      "original_line" : 3778,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 454835893,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460013880",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460355142"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460355142"
         }
      },
      "author_association" : "MEMBER",
      "body" : "would be nice if this mentioned that it's the _parents_ COutPoint ",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-25T02:50:50Z",
      "diff_hunk" : "@@ -253,12 +257,19 @@ namespace {\n             return &(*a) < &(*b);\n         }\n     };\n-    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n \n-    std::vector<std::map<uint256, COrphanTx>::iterator> g_orphan_list GUARDED_BY(g_cs_orphans); //! For random eviction\n+    /** Index from COutPoint into the mapOrphanTransactions. Used to remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460355142",
      "id" : 460355142,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1NTE0Mg==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 261,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 455255334,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460355142",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460356050"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460356050"
         }
      },
      "author_association" : "MEMBER",
      "body" : "1/3 nit on this comment, 2/3 for my understanding- \r\nthese orphans aren't listed exactly random right? `AddOrphanTx` adds the entries to in the order they are seen, but `EraseOrphanTx` introduces some randomness bc it deletes an entry by swapping out the last element (which I'm still trying to understand the point of). \r\n\r\nseems the point of this data structure is to enable `LimitOrphanTxSize` to easily choose a random orphan to erase by providing a vector interface? \r\n\r\nif my understanding is correct, I think it'd be clearer to say \"List of orphan transactions to enable random eviction\" ",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-25T03:02:04Z",
      "diff_hunk" : "@@ -253,12 +257,19 @@ namespace {\n             return &(*a) < &(*b);\n         }\n     };\n-    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n \n-    std::vector<std::map<uint256, COrphanTx>::iterator> g_orphan_list GUARDED_BY(g_cs_orphans); //! For random eviction\n+    /** Index from COutPoint into the mapOrphanTransactions. Used to remove\n+     *  orphan transactions from the mapOrphanTransactions */\n+    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n+    /** Orphan transactions listed in random order for random eviction */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460356050",
      "id" : 460356050,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1NjA1MA==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 264,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 455255334,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460356050",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460356486"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460356486"
         }
      },
      "author_association" : "MEMBER",
      "body" : "while adding comments, consider one here too? meybe: Index from wtxid into the mapOrphanTransactions to lookup orphan transactions using their witness ids.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-25T03:07:34Z",
      "diff_hunk" : "@@ -151,7 +151,11 @@ struct COrphanTx {\n     int64_t nTimeExpire;\n     size_t list_pos;\n };\n+\n+/** Guards orphan transactions and extra txs for compact blocks */\n RecursiveMutex g_cs_orphans;\n+/** Map from txid to orphan transaction record. Limited by\n+ *  -maxorphantx/DEFAULT_MAX_ORPHAN_TRANSACTIONS */\n std::map<uint256, COrphanTx> mapOrphanTransactions GUARDED_BY(g_cs_orphans);\n std::map<uint256, std::map<uint256, COrphanTx>::iterator> g_orphans_by_wtxid GUARDED_BY(g_cs_orphans);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460356486",
      "id" : 460356486,
      "line" : 162,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1NjQ4Ng==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 162,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 12,
      "pull_request_review_id" : 455255334,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460356486",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460356964"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460356964"
         }
      },
      "author_association" : "MEMBER",
      "body" : "after this PR, isn't it a max of one orphan that will be reconsidered on each run of the function?",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-25T03:13:30Z",
      "diff_hunk" : "@@ -1992,77 +2003,80 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman& connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman& connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Connection manager\n+ * @param[in]      mempool          Mempool\n+ * @param[in/out]  orphan_work_set  The set of orphan transactions to reconsider. Generally only one",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460356964",
      "id" : 460356964,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1Njk2NA==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 2011,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 455255334,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460356964",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460715036"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460715036"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-27T08:05:03Z",
      "diff_hunk" : "@@ -253,12 +257,19 @@ namespace {\n             return &(*a) < &(*b);\n         }\n     };\n-    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n \n-    std::vector<std::map<uint256, COrphanTx>::iterator> g_orphan_list GUARDED_BY(g_cs_orphans); //! For random eviction\n+    /** Index from COutPoint into the mapOrphanTransactions. Used to remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460715036",
      "id" : 460715036,
      "in_reply_to_id" : 460355142,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxNTAzNg==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 261,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 455560494,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460715036",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460721088"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460721088"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> these orphans aren't listed exactly random right?\r\n\r\n> if my understanding is correct, I think it'd be clearer to say \"List of orphan transactions to enable random eviction\"\r\n\r\nYou're correct. I've now fixed the comment. Thank you!\r\n\r\n> it deletes an entry by swapping out the last element (which I'm still trying to understand the point of)\r\n\r\nThis is because `g_orphan_list` is a std::vector, which is a contiguous-memory container. It can't have gaps in the underlying array. The normal way to erase an element from the middle of the vector is to delete it and then shift all the following elements forward by one position. That's expensive, and would invalidate all of the `list_pos` values that point back to a position in the vector. It's more efficient to copy the last element to the position of the element you want to delete, fix up the `list_pos` of just that `COrphanTx`, and then pop of the (now duplicate) last element.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-27T08:16:51Z",
      "diff_hunk" : "@@ -253,12 +257,19 @@ namespace {\n             return &(*a) < &(*b);\n         }\n     };\n-    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n \n-    std::vector<std::map<uint256, COrphanTx>::iterator> g_orphan_list GUARDED_BY(g_cs_orphans); //! For random eviction\n+    /** Index from COutPoint into the mapOrphanTransactions. Used to remove\n+     *  orphan transactions from the mapOrphanTransactions */\n+    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n+    /** Orphan transactions listed in random order for random eviction */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460721088",
      "id" : 460721088,
      "in_reply_to_id" : 460356050,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcyMTA4OA==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 264,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 455568232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460721088",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460723077"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460723077"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks. I missed this in the rebase. Added.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-27T08:20:23Z",
      "diff_hunk" : "@@ -151,7 +151,11 @@ struct COrphanTx {\n     int64_t nTimeExpire;\n     size_t list_pos;\n };\n+\n+/** Guards orphan transactions and extra txs for compact blocks */\n RecursiveMutex g_cs_orphans;\n+/** Map from txid to orphan transaction record. Limited by\n+ *  -maxorphantx/DEFAULT_MAX_ORPHAN_TRANSACTIONS */\n std::map<uint256, COrphanTx> mapOrphanTransactions GUARDED_BY(g_cs_orphans);\n std::map<uint256, std::map<uint256, COrphanTx>::iterator> g_orphans_by_wtxid GUARDED_BY(g_cs_orphans);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460723077",
      "id" : 460723077,
      "in_reply_to_id" : 460356486,
      "line" : 162,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcyMzA3Nw==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 162,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 12,
      "pull_request_review_id" : 455570824,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460723077",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460726031"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460726031"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes. Fixed!",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-27T08:25:32Z",
      "diff_hunk" : "@@ -1992,77 +2003,80 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman& connman, ChainstateMan\n     return;\n }\n \n-void static ProcessOrphanTx(CConnman& connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\n+/**\n+ * Reconsider orphan transactions after a parent has been accepted to the mempool.\n+ *\n+ * @param[in]      connman          Connection manager\n+ * @param[in]      mempool          Mempool\n+ * @param[in/out]  orphan_work_set  The set of orphan transactions to reconsider. Generally only one",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r460726031",
      "id" : 460726031,
      "in_reply_to_id" : 460356964,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcyNjAzMQ==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 2011,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 455574624,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-27T08:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460726031",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review @amitiuttarwar . I've addressed your review comments.\r\n\r\n> is my understanding correct that there is a v. small change in behavior in ProcessOrphanTx- previously, if an orphan taken off the orphan_work_set was not accepted to mempool bc of missing additional parents & there are more orphans in the work set, the while loop would continue & process the next one. with these changes it will consider max of one orphan per run. seems like an edge case & acceptable shift, but would like to confirm my understanding.\r\n\r\nYes, that's exactly right. See the commit log from _ProcessOrphanTx: Only ever reprocess one orphan tx_:\r\n \r\n```\r\n    Minor changes in behavior:\r\n    \r\n    - exit immediately if the orphan_work_set entry is not found in\r\n      mapOrphanTransactions. This can happen if the orphan is erased\r\n      from mapOrpahnTransactions due to action by another peer.\r\n    - exit immediately if the orphan is still an orphan (do not\r\n      continue and process another).\r\n```\r\n\r\nTo expand a bit: this logic was extracted into its own function in #15644 to ensure that we only do one expensive transaction validation per `ProcessMessages()`/`SendMessages()` call. There were two conditions where we could process more than one item from the `orphan_work_set`: the transaction is no longer in the orphan pool, or the transaction still doesn't have all of its parents (in which case `AcceptToMemoryPool()` exits with `TX_MISSING_INPUTS` before doing any expensive checks).\r\n\r\nI think it's a much simpler mental model to say that we'll process exactly one transaction from the set on every call to `ProcessOrphanTx()` (and it makes the functionality match the function name!) I've seen multiple bugs in these auxiliary work queues where we've either failed to make forward progress or created a livelock with network peers. Keeping the mental model of these work queues as simple as possible definitely seems worth the minimal sacrifice of having to call this function more times.",
      "created_at" : "2020-07-27T08:55:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-664212733",
      "id" : 664212733,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NDIxMjczMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-27T08:55:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/664212733",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "reACK c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a via `git range-diff master 833bccc c5b4c02`, only comment changes",
      "created_at" : "2020-07-27T12:30:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-664367104",
      "id" : 664367104,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NDM2NzEwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-27T12:30:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/664367104",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5553787?v=4",
         "events_url" : "https://api.github.com/users/troygiorshev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/troygiorshev/followers",
         "following_url" : "https://api.github.com/users/troygiorshev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/troygiorshev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/troygiorshev",
         "id" : 5553787,
         "login" : "troygiorshev",
         "node_id" : "MDQ6VXNlcjU1NTM3ODc=",
         "organizations_url" : "https://api.github.com/users/troygiorshev/orgs",
         "received_events_url" : "https://api.github.com/users/troygiorshev/received_events",
         "repos_url" : "https://api.github.com/users/troygiorshev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/troygiorshev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/troygiorshev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/troygiorshev"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r461106310"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/461106310"
         }
      },
      "author_association" : "MEMBER",
      "body" : "does this sound right: \r\n\r\nit seems to me that `list_pos` is tracked _for this reason_. so the alternative would be if we removed `list_pos` & used in the built in vector erase function. the tradeoff would be less efficiency. \r\n\r\nthe current design choice is to store this additional field on every `COrphanTx` to reduce an O(n) operation on the `g_orphan_list` vector, where n <= 100 | `-maxorphantx`. but I don't have much idea of how often we erase orphans in practice. so small increase in memory for small decrease in processing time?",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-27T19:05:17Z",
      "diff_hunk" : "@@ -253,12 +257,19 @@ namespace {\n             return &(*a) < &(*b);\n         }\n     };\n-    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n \n-    std::vector<std::map<uint256, COrphanTx>::iterator> g_orphan_list GUARDED_BY(g_cs_orphans); //! For random eviction\n+    /** Index from COutPoint into the mapOrphanTransactions. Used to remove\n+     *  orphan transactions from the mapOrphanTransactions */\n+    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n+    /** Orphan transactions listed in random order for random eviction */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r461106310",
      "id" : 461106310,
      "in_reply_to_id" : 460356050,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTEwNjMxMA==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 264,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 456056622,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-28T06:57:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/461106310",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I've seen multiple bugs in these auxiliary work queues where ... created a livelock with network peers\r\n\r\nwoah interesting, any you could point me towards? \r\n\r\n> See the commit log from ProcessOrphanTx: Only ever reprocess one orphan tx\r\n\r\noops sorry, I don't know how I missed that. thanks for the explanation.\r\n\r\nalright, I've been considering possible ways this difference could be exploited and I can't think of anything substantial. I'm comfortable with these changes.\r\n\r\ncode review ACK c5b4c02ee2",
      "created_at" : "2020-07-27T19:18:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-664588368",
      "id" : 664588368,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NDU4ODM2OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-27T19:18:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/664588368",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm not worried about the only-reprocess-one-at-a-time as an attack vector - at worst, a peer could make his own transactions be processed slower. As long as there is no impact on what one peer can do w.r.t. processing of things arriving from other peers, there is no such concern.\r\n\r\nHowever, I'm slightly concerned that there could be innocent transaction patterns that result in orphan transactions being processed significantly slower. As every incoming transaction may \"wake up\" a number of unprocessed orphans for reprocessing, and each of these again waking up earlier ones again, it sounds like the worst case may be pretty bad.",
      "created_at" : "2020-07-27T19:27:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-664592293",
      "id" : 664592293,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NDU5MjI5Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-27T19:27:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/664592293",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r461362446"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/461362446"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, this is the only reason we store `list_pos`. Without it, we'd have to do a (relatively) expensive erase from the middle of the vector.",
      "commit_id" : "c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a",
      "created_at" : "2020-07-28T07:03:53Z",
      "diff_hunk" : "@@ -253,12 +257,19 @@ namespace {\n             return &(*a) < &(*b);\n         }\n     };\n-    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n \n-    std::vector<std::map<uint256, COrphanTx>::iterator> g_orphan_list GUARDED_BY(g_cs_orphans); //! For random eviction\n+    /** Index from COutPoint into the mapOrphanTransactions. Used to remove\n+     *  orphan transactions from the mapOrphanTransactions */\n+    std::map<COutPoint, std::set<std::map<uint256, COrphanTx>::iterator, IteratorComparator>> mapOrphanTransactionsByPrev GUARDED_BY(g_cs_orphans);\n+    /** Orphan transactions listed in random order for random eviction */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#discussion_r461362446",
      "id" : 461362446,
      "in_reply_to_id" : 460356050,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM2MjQ0Ng==",
      "original_commit_id" : "833bccc522703f87d0d46b190a9a29bcb633c615",
      "original_line" : 264,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 456354687,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19498",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-28T07:03:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/461362446",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm not worried about the only-reprocess-one-at-a-time as an attack vector - at worst, a peer could make his own transactions be processed slower. As long as there is no impact on what one peer can do w.r.t. processing of things arriving from other peers, there is no such concern.\r\n\r\nIf this is the case, then should we process the entire `orphan_work_set` in one pass? I'm happy to remove the _ProcessOrphanTx: Only ever reprocess one orphan tx_ commit, but I want to understand (and document!) what the expected behaviour is. It's currently not made obvious to the reader which circumstances will cause us to reconsider multiple transactions from the orphan set in one pass (answer: if the txid is no longer in the orphan set, we'll `continue`, and if the result from `AcceptToMemoryPool` is `TX_MISSING_INPUTS` we'll iterate again without setting the `done` variable).",
      "created_at" : "2020-07-28T07:21:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-664825767",
      "id" : 664825767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NDgyNTc2Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-28T07:21:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/664825767",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery It currently iterates until either one orphan is actually accepted or actually rejected, or the work set is empty.\r\n\r\nSo it continues until it does some \"real work\", as anything else (reconsidering things that still have missing inputs) is presumably fast.",
      "created_at" : "2020-07-28T18:14:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-665196224",
      "id" : 665196224,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NTE5NjIyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-28T18:14:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/665196224",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't see how this could cause orphans to be processed significantly slower. We always make progress through the peer's orphan_work_set on each ProcessMessages call, and we tell the message handler thread that there's more work to do if the work set isn't empty, so we'll never sleep between calls.\r\n\r\nIn the absolute pessimal case, all orphans start in orphan_work_set, the first 99 are still orphans after reconsideration and the 100th is also a parent to the first 99. We then reconsider the first 99 again and the 99th is a parent to the first 98, and so on. To clear this, we'd need to call `ProcessOrphanTx()` 100^2 / 2 = 50,000 times instead of 100 times currently. I don't think that's a problem since:\r\n\r\n- this can't happen through innocent transaction patterns. The peer would need to construct a very particular transaction tree (including grinding to get the txids in order)\r\n- this doesn't make us do any additional work. We have to call AcceptToMemoryPool() 50,000 times in each case. The only difference is that with this branch we spread those calls out over 50,000 calls to ProcessOrphanTx() instead of 100.\r\n- the peer that fed us the 100 transactions is therefore only hurting itself. Processing for other peers is unaffected.\r\n\r\nAre you thinking of a different scenario?",
      "created_at" : "2020-07-29T10:45:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-665591011",
      "id" : 665591011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NTU5MTAxMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-29T10:45:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/665591011",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Wow, big approach NACK on \"tidy up\" PRs that do behaviour changes.\r\n\r\nI think a better mental model for this sort of work queue is \"always make real progress every time you look at the queue\", and the main benefit of the tidy up here is moving the \"make real progress\" out of the while loop, since we're not doing many of them we're only doing one, so having it in the loop is misleading. But we can do both: just make the trivial progress first in a loop to find a real orphan tx to attempt, then do that outside of the loop. Something like:\r\n\r\n```diff\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -2010,23 +2010,26 @@ static void ProcessHeadersMessage(CNode& pfrom, CConnman& connman, ChainstateMan\r\n  *\r\n  * @param[in]      connman          Connection manager\r\n  * @param[in]      mempool          Mempool\r\n- * @param[in/out]  orphan_work_set  The set of orphan transactions to reconsider. Only one orphan\r\n- *                                  will be reconsidered on each call of this function. This set\r\n- *                                  may be added to if accepting an orphan causes its children to\r\n- *                                  be reconsidered.\r\n+ * @param[in/out]  orphan_work_set  The set of orphan transactions to reconsider. Exactly one orphan\r\n+ *                                  will be re-validated on each call of this function if there is an\r\n+ *                                  orphan to process, however if any of the items in orphan_work_set\r\n+ *                                  have already been removed from mapOrphanTransactions they may\r\n+ *                                  also be erased. This set may be added to if accepting an orphan\r\n+ *                                  causes its children to be reconsidered.\r\n  */\r\n void static ProcessOrphanTx(CConnman& connman, CTxMemPool& mempool, std::set<uint256>& orphan_work_set) EXCLUSIVE_LOCKS_REQUIRED(cs_main, g_cs_orphans)\r\n {\r\n     AssertLockHeld(cs_main);\r\n     AssertLockHeld(g_cs_orphans);\r\n \r\n-    if (orphan_work_set.empty()) return;\r\n-\r\n-    const uint256 orphanHash = *orphan_work_set.begin();\r\n-    orphan_work_set.erase(orphan_work_set.begin());\r\n-\r\n-    auto orphan_it = mapOrphanTransactions.find(orphanHash);\r\n+    std::map<uint256, COrphanTx>::iterator orphan_it = mapOrphanTransactions.end();\r\n+    while (!orphan_work_set.empty() && orphan_it == mapOrphanTransactions.end()) {\r\n+        const uint256 orphanHash = *orphan_work_set.begin();\r\n+        orphan_work_set.erase(orphan_work_set.begin());\r\n+        orphan_it = mapOrphanTransactions.find(orphanHash);\r\n+    }\r\n     if (orphan_it == mapOrphanTransactions.end()) return;\r\n+    const uint256 orphanHash = orphan_it->first;\r\n \r\n     const CTransactionRef porphanTx = orphan_it->second.tx;\r\n     TxValidationState state;\r\n```\r\n\r\nEDIT: (this is still a behaviour change in that it stops work after finding a tx that still has missing inputs. I'm fine with counting that much checking as \"real work\", just don't see doing a failing map lookup as enough progress)",
      "created_at" : "2020-07-31T01:09:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-666853816",
      "id" : 666853816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2Njg1MzgxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-31T01:20:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/666853816",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Wow, big approach NACK on \"tidy up\" PRs that do behaviour changes.\r\n\r\nI don't understand. You've NACKed a behaviour change and then suggested a different behaviour change. What's the difference?\r\n\r\nI agree that if a PR claimed to not change behaviour but did unintentionally, that'd be very bad, but all the behaviour changes in this PR have been fully documented and justified in the commit logs since the PR was opened. They're observationally equivalent to the peers, and no peer can influence how the node processes other peers.",
      "created_at" : "2020-07-31T09:31:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-667030111",
      "id" : 667030111,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NzAzMDExMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-31T09:31:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/667030111",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-08-06T23:45:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-670244613",
      "id" : 670244613,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MDI0NDYxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-06T23:45:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/670244613",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa @ajtowns - you've both expressed reservations about this PR. Before I go ahead and rebase, can you answer the questions above:\r\n\r\n@sipa \r\n\r\n>> I'm slightly concerned that there could be innocent transaction patterns that result in orphan transactions being processed significantly slower.\r\n\r\n> I don't see how this could cause orphans to be processed significantly slower. [...] Are you thinking of a different scenario?\r\n\r\n@ajtowns \r\n\r\n>> Wow, big approach NACK on \"tidy up\" PRs that do behaviour changes.\r\n\r\n> all the behaviour changes in this PR have been fully documented and justified in the commit logs since the PR was opened. They're observationally equivalent to the peers, and no peer can influence how the node processes other peers.",
      "created_at" : "2020-08-07T10:43:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-670454824",
      "id" : 670454824,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MDQ1NDgyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-07T10:43:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/670454824",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @sipa @ajtowns - you've both expressed reservations about this PR. Before I go ahead and rebase, can you answer the questions above:\r\n> > > Wow, big approach NACK on \"tidy up\" PRs that do behaviour changes.\r\n> > all the behaviour changes in this PR have been fully documented and justified in the commit logs since the PR was opened. They're observationally equivalent to the peers, and no peer can influence how the node processes other peers.\r\n\r\nThe NACK is just on describing something as a \"tidy up\" when it's a behaviour change; fixable either by describing the behaviour change, or moving it to a separate PR (and describing it there). \"Oh, I tidied up\" should mean \"I moved the stuff over there\" not \"this code didn't bring me joy, so I Marie Kondo'd it\"\r\n\r\nSorry for the delay, I wanted to check that the behaviour was actually (potentially) changing -- the difference between doing the next step in `ProcessOrphanTx` and hence `ProcessMessages` directly, rather than leaving it for the next iteration in `ThreadMessageHandler` (which is reduced to 0.1sec away due to `fMoreWork` being set) is that this gives time for other peers to do things as well. \r\n\r\nI think with suitably well connected peers you could arrange for a set of transactions A1..A100 with A as a parent, B1..B100 each of which have each of A1..A100 as a parent, C1..C100 each of which have each of B1..B100 as a parent, D1..D100 etc. Node X provides A1..A100, and then B provides tx A. At this point A1..A100 are in its orphan_work_set, and it tries A1 then lets other peers have a go. Node Y comes along and provides B1..B100, and some random subset of A1..A100,B1..B100 get evicted from the orphanage. X then processes A2, either doing nothing, or adding B1..B100 to its work set. Then Y provides C1..C100. X processes A3, etc. Not sure if there's a way to tweak that so the work set grows spectacularly unboundedly, but it definitely seems like a behaviour change to me, and it definitely doesn't match my expectation of \"making forward progress when working on a queue\".",
      "created_at" : "2020-08-11T14:56:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-671996780",
      "id" : 671996780,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTk5Njc4MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-11T14:56:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671996780",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks @ajtowns . A few questions/observations about your scenario:\r\n\r\n- _\"which is reduced to 0.1sec away due to fMoreWork being set\"_. I think it's the other way round. We wait for up to 0.1s if there's no more work to do. If there _is_ work to do, then we immediately reiterate through vNodes again.\r\n- _\"Node X provides A1..A100, and then B provides tx A\"_. I think the B is a typo here and Node X provides A1..A100 and also provides tx A? (I don't see node B mentioned anywhere else)\r\n- _\"...it tries A1 then lets other peers have a go. Node Y comes along and provides B1..B100\"_. When node X \"lets other peers have a go\" it returns from `ProcessMessages()` and we continue through the message handler loop. We can only process one message from each peer on each iteration of that loop, so node Y can't roll mapOrphanTransactions in one iteration as you suggest here. Theoretically nodes Y1 through Y100 could do so, but their messages would need to be exactly synchronized with the message handler loop, which seems unlikely.\r\n- _\"Not sure if there's a way to tweak that so the work set grows spectacularly unboundedly\"_. I don't think so. Every iteration through the the message handler loop, each peer can theoretically add one tx to the orphan map, and node X will remove one tx from its orphan_work_set. Processing that tx from the orphan_work_set may result in more txs being added to the set.\r\n- The scenario you describe where other peers construct transactions that node X adds to its orphan_work_set is possible today. The slower removal of evicted orphans from the orphan_work_set doesn't change this.\r\n- aside: this is a good argument to not process orphan transactions in the context of the node that provided the parent/ancestor, which I wanted to do in #19364.\r\n- finally, to what end is node Y carrying out this \"attack\" on node X. Yes, it can prevent the victim from processing messages from node X, but only as long as it can continue send transactions that get accepted to the mempool at the victim's transaction processing capacity. I'd expect that to be many transactions per second. This doesn't seem like a particularly useful attack, but if there are more dangerous variations, I still think the correct fix is to not process orphans in the context of the peer that provided the parent/ancestor.",
      "created_at" : "2020-08-11T20:42:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-672268872",
      "id" : 672268872,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MjI2ODg3Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-11T20:42:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/672268872",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "since its the only point of contention, maybe the _ProcessOrphanTx: Only ever reprocess one orphan tx_ commit can be broken out into a separate PR to separate review from the rest of the changes? \r\n\r\nin regards to this change, I'm not sure I currently have much insight to offer on this nuanced discussion, I'm mostly trying to learn and make sure I understand the concerns/tradeoffs. this comment is mostly a biased summary, so sorry if it doesn't feel useful, but I'm hoping it might be helpful for moving the conversation forward, maybe for other reviewers, and for my own understanding. so, I'm interested in any feedback on this take. \r\n\r\nan attempt to sum up some of the principles we are discussing:\r\n(A) each attempt to process an item should make forward progress in the work queue \r\n(B) an adversarial peer shouldn't be able to significantly impact the node eg. prevent it from processing messages from other peers\r\n(C) we should simplify the mental overhead required to reason about these work queues, because their interactions are inherently complex & error-prone\r\n(D) we don't want to negatively impact processing in normal cases \r\n\r\non current master- to achieve (B) we cap at 1 expensive validation per call. and while \"expensive\" is always going to be a judgement call, I don't think the existing logic has clear boundaries. if we invoke ATMP but the error is `TX_MISSING_INPUTS`, we attempt to process the next orphan. this helps (A), but in my opinion detracts from (C) because there are other failures that exit the loop that do even less work (like if the txn fails pre-checks). so essentially, instead of saying \"exit if we do expensive work\", we are saying \"exit if we do the right kind of work\". which @sipa defines here https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-665196224 as \"real work\" -> orphan is actually accepted, actually rejected, or the work set is empty. which can be argued achieves (C). \r\n\r\nin the current proposed changes- (correct me if I'm wrong, but based on my impression..) @jnewbery is striving to improve (C) by loosening the definition of \"forward progress\" in (A), and makes a case that this doesn't detract from (B) or (D). the changes define \"forward progress\" to be always remove exactly one orphan from the work queue (even if lookup fails or inputs still missing) \r\n\r\nin @ajtowns suggestion here https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-666853816, (again.. please correct me if I'm wrong) he agrees that it would be beneficial to improve (C) but doesn't think (A) is sufficiently addressed in the patch and proposes a definition of \"forward progress\" between current master & current PR- essentially, ATMP an orphan. \r\n\r\nðð½ seems like a reasonable compromise to me in improving (C) and a reasonable definition for (A). do others agree? or are there outstanding concerns with robustness / @jnewbery do you not think it achieves (C)? \r\n\r\nalso, I haven't yet dug into fully understanding the attack being discussed, but @ajtowns is the essential concern  around a way a sophisticated attacker can grow the queue faster than it would be processed in the current proposed patch? ",
      "created_at" : "2020-08-11T21:53:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-672298680",
      "id" : 672298680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MjI5ODY4MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-11T21:55:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/672298680",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased (https://github.com/bitcoin/bitcoin/compare/c5b4c02ee2e423dbcccc985b4f573f8ed9aafa0a..a264e1465d942d48e096ef5d0a61e5f94c3e8106)",
      "created_at" : "2020-08-12T08:47:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-672741731",
      "id" : 672741731,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3Mjc0MTczMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-12T08:47:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/672741731",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks @amitiuttarwar . Great summary.\r\n\r\nI've done as you've suggested and removed the _ProcessOrphanTx: Only ever reprocess one orphan tx_ commit. I think this PR by itself is a marginal improvement, but not including #19364 and the _ProcessOrphanTx: Only ever reprocess one orphan tx_ commit limits the benefits. The fact that @ajtowns and I can't agree on whether node Y can interfere with node X's processing by sending many transactions does confirm my belief that orphan handling is (unnecessarily?) complex and a simpler mental model would be beneficial here.\r\n\r\nIf people think this PR is still worthwhile without that commit, lets go ahead and try to get it merged, and perhaps revisit orphan processing at some point in the future.",
      "created_at" : "2020-08-12T09:04:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-672751156",
      "id" : 672751156,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3Mjc1MTE1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-12T09:04:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/672751156",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased",
      "created_at" : "2020-08-24T14:12:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-679151512",
      "id" : 679151512,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3OTE1MTUxMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-24T14:12:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/679151512",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 82396bb897\r\n\r\norphan processing is complex & I appreciate the efforts to simplify & document. thank you! \r\n\r\nas before, I still think simplifying the while loop to have a clearer definition of \"forward progress\" would be nice, but given the review strugs, I understand dropping from this PR. ",
      "created_at" : "2020-08-24T21:53:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-679385784",
      "id" : 679385784,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3OTM4NTc4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-24T21:53:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/679385784",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fixed a bad intermediate commit (no changes to final code)",
      "created_at" : "2020-08-25T09:02:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-679900925",
      "id" : 679900925,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3OTkwMDkyNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-25T09:02:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/679900925",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re utACK e59bbcd06f - checked that nothing changed about final state & that commits build ",
      "created_at" : "2020-08-25T16:35:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-680136413",
      "id" : 680136413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MDEzNjQxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-25T16:35:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/680136413",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-09-07T07:14:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-688091382",
      "id" : 688091382,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODA5MTM4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T07:14:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688091382",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-09-07T17:40:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-688451919",
      "id" : 688451919,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODQ1MTkxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T17:40:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688451919",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2020-09-07T19:13:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-688479795",
      "id" : 688479795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODQ3OTc5NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T19:13:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688479795",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 001343f4bc8b22fa9e313bd2867756eb9d614fa3\r\n\r\nThis is a rather straightforward PR now.",
      "created_at" : "2020-09-23T02:50:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-697099076",
      "id" : 697099076,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NzA5OTA3Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-23T02:50:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/697099076",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5553787?v=4",
         "events_url" : "https://api.github.com/users/troygiorshev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/troygiorshev/followers",
         "following_url" : "https://api.github.com/users/troygiorshev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/troygiorshev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/troygiorshev",
         "id" : 5553787,
         "login" : "troygiorshev",
         "node_id" : "MDQ6VXNlcjU1NTM3ODc=",
         "organizations_url" : "https://api.github.com/users/troygiorshev/orgs",
         "received_events_url" : "https://api.github.com/users/troygiorshev/received_events",
         "repos_url" : "https://api.github.com/users/troygiorshev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/troygiorshev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/troygiorshev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/troygiorshev"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 001343f4bc8b22fa9e313bd2867756eb9d614fa3",
      "created_at" : "2020-09-30T01:08:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-701100118",
      "id" : 701100118,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMTEwMDExOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-30T01:08:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/701100118",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 001343f4bc8b22fa9e313bd2867756eb9d614fa3 ð®\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nACK 001343f4bc8b22fa9e313bd2867756eb9d614fa3 ð®\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUhi8gv+MYMSOeIoSOoTXDVzdEvq7uZMWyFQwE9JWb+4Gf7ArKX7dLYmeI7/Qx7b\r\nhk1wi8p7ilKfr6/9qmVrlEbautGDbPXvGQ9QfUhOLl7O73UKigynh+49Sq6VfH20\r\nEt7J3EcyPncqRvU+sQihvOJuXVfsd/K1LXFrxn1Yby8c++pLCmlGwzzlIexWrO+T\r\neV19tSFabJaux0U5ft4l/ZAJ+DncYjM7IQ16W/PkfE3Z/dyfrsr92ZmfZKfHdPd/\r\nb8kywFsZ5vZOQAX+4rcAvyHIZyOTZaRTRiKAOTeZ251zn8VjGlhYsbPmA1mwvtZn\r\nq9l5C4aTEvDFhqzlSf2kvZ5PR121SGezO5Eq4DEPyRHoK0oyybHv/D6doNOO99Da\r\nhVDhdsvCSVXrMbhOSCwboufxbEbYJ5yoLYNZzV8z2WF8Rq2TmdY/l2m+fww8L+SD\r\nvatKkGZQATYSd/kMzxBzH0JWLAmz0wEuixWJfaTavv/nO/PsDRDByy0/JNUHUEw2\r\nUiwmxSO1\r\n=BIT5\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `bf74cbfe89c193a0e98cecd45019f0465bbd807c268f14767ecff37e07f76fe5  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e892940108bf74cbfe89c193a0e98cecd45019f0465bbd807c268f14767ecff37e07f76fe5f0102196304ed1dec78fc9e32015848b7fc108fff0105fe40a7b6d4e8967110a7d2faefbd3aa08f1045f748db6f0082eec555fc817a8620083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267f010b97f71aed0062420b11397b25f12022408f1045f748db6f0080be84369b82eedfe0083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6d)\r\n\r\n</details>\r\n",
      "created_at" : "2020-09-30T13:53:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19498#issuecomment-701405328",
      "id" : 701405328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19498",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMTQwNTMyOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-30T13:53:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/701405328",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
