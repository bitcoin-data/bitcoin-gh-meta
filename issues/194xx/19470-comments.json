[
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 0b8ba84659b56b12d74587ea31b6062fce887ba3",
      "created_at" : "2020-07-08T15:03:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19470#issuecomment-655575422",
      "id" : 655575422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19470",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NTU3NTQyMg==",
      "updated_at" : "2020-07-08T15:03:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/655575422",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 0b8ba84659b56b12d74587ea31b6062fce887ba3\r\n\r\nNow that the local `banmap` isn't being used after `SetBanned()`, we could change `SetBanned()` to take an rvalue reference and do a move, rather than the expensive copy. (not in this PR)",
      "created_at" : "2020-07-09T10:50:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19470#issuecomment-656056464",
      "id" : 656056464,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19470",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NjA1NjQ2NA==",
      "updated_at" : "2020-07-09T10:52:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656056464",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19470#discussion_r452164707"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19470"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452164707"
         }
      },
      "author_association" : "MEMBER",
      "body" : "FWIW I would find this logging handy as a regular debug log `LogPrintf`, like the other ones in this function.",
      "commit_id" : "0b8ba84659b56b12d74587ea31b6062fce887ba3",
      "created_at" : "2020-07-09T11:59:29Z",
      "diff_hunk" : "@@ -26,7 +26,7 @@ BanMan::BanMan(fs::path ban_file, CClientUIInterface* client_interface, int64_t\n         SweepBanned();            // sweep out unused entries\n \n         LogPrint(BCLog::NET, \"Loaded %d banned node ips/subnets from banlist.dat  %dms\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19470#discussion_r452164707",
      "id" : 452164707,
      "line" : 28,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDcwNw==",
      "original_commit_id" : "0b8ba84659b56b12d74587ea31b6062fce887ba3",
      "original_line" : 28,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/banman.cpp",
      "position" : 3,
      "pull_request_review_id" : 445547263,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19470",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T11:59:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452164707",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> In a couple of manual checks, both master and this branch logged the correct number with 0 and 1 banned peers using setban/clearbanned, so I didn't hit the timing to produce a wrong count.\r\n\r\nYou can observe the issue on master by just setting a short ban, and restarting bitcoind. i.e:\r\n\r\n```bash\r\nsrc/bitcoind -regtest\r\n\r\n# set a short-lived ban\r\nsrc/bitcoin-cli -regtest setban \"2001:4d48:ac57:400:cacf:e9ff:fe1d:1\" \"add\" \"10\"\r\n\r\n#  shutdown bitcoind, wait 11 seconds, restart bitcoind\r\n....\r\n2020-07-09T12:06:54.944698Z [init] SweepBanned: Removed banned node ip/subnet from banlist.dat: 2001:4d48:ac57:400:cacf:e9ff:fe1d:1/128\r\n2020-07-09T12:06:54.944731Z [init] Loaded 1 banned node ips/subnets from banlist.dat  0ms\r\n```\r\n\r\nThe loaded count is logged as `1`  when it should be `0`.",
      "created_at" : "2020-07-09T12:10:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19470#issuecomment-656089856",
      "id" : 656089856,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19470",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NjA4OTg1Ng==",
      "updated_at" : "2020-07-09T12:10:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656089856",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, reproduced on mainnet. I wasn't shutting down bitcoind fast enough before it expired.",
      "created_at" : "2020-07-09T12:25:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19470#issuecomment-656096842",
      "id" : 656096842,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19470",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NjA5Njg0Mg==",
      "updated_at" : "2020-07-09T12:25:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656096842",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
