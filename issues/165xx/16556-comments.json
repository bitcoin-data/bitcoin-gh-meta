[
   {
      "author_association" : "MEMBER",
      "body" : "Looks similar to  #15995",
      "created_at" : "2019-08-06T11:36:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16556#issuecomment-518632012",
      "id" : 518632012,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16556",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxODYzMjAxMg==",
      "updated_at" : "2019-08-06T11:36:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/518632012",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Added suggested improvements and fixes from #15995 ",
      "created_at" : "2019-08-06T12:36:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16556#issuecomment-518650446",
      "id" : 518650446,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16556",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxODY1MDQ0Ng==",
      "updated_at" : "2019-08-06T12:36:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/518650446",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/37372069?v=4",
         "events_url" : "https://api.github.com/users/setpill/events{/privacy}",
         "followers_url" : "https://api.github.com/users/setpill/followers",
         "following_url" : "https://api.github.com/users/setpill/following{/other_user}",
         "gists_url" : "https://api.github.com/users/setpill/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/setpill",
         "id" : 37372069,
         "login" : "setpill",
         "node_id" : "MDQ6VXNlcjM3MzcyMDY5",
         "organizations_url" : "https://api.github.com/users/setpill/orgs",
         "received_events_url" : "https://api.github.com/users/setpill/received_events",
         "repos_url" : "https://api.github.com/users/setpill/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/setpill/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/setpill/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/setpill"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "tACK ~6c8b98b5bf8c3e6c797544b2c7f0a0fc5f5afda6~ 74f741d49c3763d082fc15fda7f342515faf4210 (read the commits in the wrong date order)\r\n\r\nSince this has cropped up again IMHO either something like the fix in this PR should be merged or if not maybe we should at least add an extra step to the documentation informing users they MUST always explicitly set the ownership on the `/etc/bitcoin` directory.\r\n\r\nThe `doc/init.md` file states:\r\n\r\n> The configuration file, PID directory (if applicable) and data directory should all be owned by the bitcoin user and group. It is advised for security reasons to make the configuration file and data directory only readable by the bitcoin user and group. Access to bitcoin-cli and other bitcoind rpc clients can then be controlled by group membership.\r\n>\r\n> NOTE: When using the systemd .service file, the creation of the aforementioned directories and the setting of their permissions is automatically handled by systemd. Directories are given a permission of 710, giving the bitcoin group access to files under it if the files themselves give permission to the bitcoin group to do so (e.g. when -sysperms is specified). This does not allow for the listing of files under the directory.  \r\n\r\nThe problem is this sentence `When using the systemd .service file, the creation of the aforementioned directories and the setting of their permissions is automatically handled by systemd.` At least on Ubuntu 18.04 it's wrong. If the creation of the `/etc/bitcoin` directory is left up to systemd the result is:\r\n\r\n````\r\n$ sudo ls -l /etc\r\ndrwx--x--- 2 root root       4096 Aug 17 12:34 bitcoin\r\n$ sudo ls -l /etc/bitcoin\r\n-rw-r--r-- 1 bitcoin bitcoin 6455 Aug 17 12:34 bitcoin.conf\r\n````\r\n\r\nWhich results in:\r\n\r\n`sudo systemctl start bitcoind`\r\n````\r\n2019-08-17T12:58:29Z Bitcoin Core version v0.18.1 (release build)\r\n2019-08-17T12:58:29Z Assuming ancestors of block 0000000000000000000f1c54590ee18d15ec70e68c8cd4cfbadb1b4f11697eee have valid signatures.\r\n2019-08-17T12:58:29Z Setting nMinimumChainWork=0000000000000000000000000000000000000000051dc8b82f450202ecb3d471\r\n2019-08-17T12:58:29Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\r\n2019-08-17T12:58:29Z Using RdSeed as additional entropy source\r\n2019-08-17T12:58:29Z Using RdRand as an additional entropy source\r\n2019-08-17T12:58:29Z Default data directory /home/admin/.bitcoin\r\n2019-08-17T12:58:29Z Using data directory /var/lib/bitcoind\r\n2019-08-17T12:58:29Z\r\n\r\n************************\r\nEXCEPTION: N5boost10filesystem16filesystem_errorE\r\nboost::filesystem::status: Permission denied: \"/etc/bitcoin/bitcoin.conf\"\r\nbitcoin in AppInit()\r\n\r\n\r\n\r\n************************\r\nEXCEPTION: N5boost10filesystem16filesystem_errorE\r\nboost::filesystem::status: Permission denied: \"/etc/bitcoin/bitcoin.conf\"\r\nbitcoin in AppInit()\r\n\r\n2019-08-17T12:58:29Z Shutdown: In progress...\r\n2019-08-17T12:58:29Z Shutdown: done\r\n````\r\n\r\nThe fix is:\r\n\r\n````\r\n$ sudo chown bitcoin:bitcoin /etc/bitcoin\r\n$ ls -l /etc\r\ndrwx--x--- 2 bitcoin bitcoin    4096 Aug 17 12:34 bitcoin\r\n````\r\n\r\n`sudo systemctl start bitcoind`\r\n````\r\n2019-08-17T13:09:13Z Bitcoin Core version v0.18.1 (release build)\r\n2019-08-17T13:09:13Z Assuming ancestors of block 0000000000000000000f1c54590ee18d15ec70e68c8cd4cfbadb1b4f11697eee have valid signatures.\r\n2019-08-17T13:09:13Z Setting nMinimumChainWork=0000000000000000000000000000000000000000051dc8b82f450202ecb3d471\r\n2019-08-17T13:09:13Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\r\n2019-08-17T13:09:13Z Using RdSeed as additional entropy source\r\n2019-08-17T13:09:13Z Using RdRand as an additional entropy source\r\n2019-08-17T13:09:13Z Default data directory /home/bitcoin/.bitcoin\r\n2019-08-17T13:09:13Z Using data directory /var/lib/bitcoind\r\n2019-08-17T13:09:13Z Config file: /etc/bitcoin/bitcoin.conf\r\n2019-08-17T13:09:13Z Using at most 125 automatic connections (1024 file descriptors available)\r\n2019-08-17T13:09:13Z Using 16 MiB out of 32/2 requested for signature cache, able to store 524288 elements\r\n2019-08-17T13:09:13Z Using 16 MiB out of 32/2 requested for script execution cache, able to store 524288 elements\r\n2019-08-17T13:09:13Z Using 4 threads for script verification\r\n2019-08-17T13:09:13Z HTTP: creating work queue of depth 16\r\n2019-08-17T13:09:13Z No rpcpassword set - using random cookie authentication.\r\n2019-08-17T13:09:13Z Generated RPC authentication cookie /var/lib/bitcoind/.cookie\r\n2019-08-17T13:09:13Z HTTP: starting 4 worker threads\r\n2019-08-17T13:09:13Z scheduler thread start\r\n2019-08-17T13:09:13Z Using wallet directory /var/lib/bitcoind\r\n2019-08-17T13:09:13Z init message: Verifying wallet(s)...\r\n2019-08-17T13:09:13Z Using BerkeleyDB version Berkeley DB 4.8.30: (April  9, 2010)\r\n2019-08-17T13:09:13Z Using wallet /var/lib/bitcoind\r\n2019-08-17T13:09:13Z BerkeleyEnvironment::Open: LogDir=/var/lib/bitcoind/database ErrorFile=/var/lib/bitcoind/db.log\r\n2019-08-17T13:09:13Z init message: Loading banlist...\r\n2019-08-17T13:09:13Z ERROR: DeserializeFileDB: Failed to open file /var/lib/bitcoind/banlist.dat\r\n2019-08-17T13:09:13Z Invalid or missing banlist.dat; recreating\r\n2019-08-17T13:09:13Z Cache configuration:\r\n2019-08-17T13:09:13Z * Using 2.0 MiB for block index database\r\n2019-08-17T13:09:13Z * Using 8.0 MiB for chain state database\r\n2019-08-17T13:09:13Z * Using 440.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n2019-08-17T13:09:13Z init message: Loading block index...\r\n2019-08-17T13:09:13Z Opening LevelDB in /var/lib/bitcoind/blocks/index\r\n2019-08-17T13:09:13Z Opened LevelDB successfully\r\n````",
      "created_at" : "2019-08-17T13:16:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16556#issuecomment-522235671",
      "id" : 522235671,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16556",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMjIzNTY3MQ==",
      "updated_at" : "2019-08-19T18:55:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/522235671",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/197660?v=4",
         "events_url" : "https://api.github.com/users/sipsorcery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipsorcery/followers",
         "following_url" : "https://api.github.com/users/sipsorcery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipsorcery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipsorcery",
         "id" : 197660,
         "login" : "sipsorcery",
         "node_id" : "MDQ6VXNlcjE5NzY2MA==",
         "organizations_url" : "https://api.github.com/users/sipsorcery/orgs",
         "received_events_url" : "https://api.github.com/users/sipsorcery/received_events",
         "repos_url" : "https://api.github.com/users/sipsorcery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipsorcery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipsorcery"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@sipsorcery 6c8b98b is potentially dangerous; see https://github.com/bitcoin/bitcoin/pull/15995#issuecomment-508469900 (quoted below for ease of reading).\r\n\r\n> I'm not convinced that this is a good idea. `bitcoin.conf` can contain secrets such as RPC account user/passwords, so restricting its permissions to `root` and whatever the `uid`/`gid` is that the service runs under makes sense.\r\n> (at least by default! of course admins can decide to weaken these permissions in specific cases)\r\n\r\nI have since changed the PR to, rather than make the conf dir/file world-readable, make systemd set the group of the confdir to `bitcoin` as per https://github.com/bitcoin/bitcoin/pull/15995#pullrequestreview-236934507 (relevant part quoted below):\r\n\r\n> Other options would be [..] to keep the current 0710 but change the group:\r\n> \r\n> ```\r\n> drwx--x--- root bitcoin /etc/bitcoin\r\n> ```\r\n> \r\n> with something like:\r\n> \r\n> ```\r\n> PermissionsStartOnly=true\r\n> ExecStartPre=chgrp bitcoin /etc/bitcoin\r\n> ```\r\n\r\nAs well as included the hardening from your PR (ProtectHome).",
      "created_at" : "2019-08-19T08:30:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16556#issuecomment-522468341",
      "id" : 522468341,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16556",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMjQ2ODM0MQ==",
      "updated_at" : "2019-08-19T08:32:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/522468341",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/37372069?v=4",
         "events_url" : "https://api.github.com/users/setpill/events{/privacy}",
         "followers_url" : "https://api.github.com/users/setpill/followers",
         "following_url" : "https://api.github.com/users/setpill/following{/other_user}",
         "gists_url" : "https://api.github.com/users/setpill/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/setpill",
         "id" : 37372069,
         "login" : "setpill",
         "node_id" : "MDQ6VXNlcjM3MzcyMDY5",
         "organizations_url" : "https://api.github.com/users/setpill/orgs",
         "received_events_url" : "https://api.github.com/users/setpill/received_events",
         "repos_url" : "https://api.github.com/users/setpill/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/setpill/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/setpill/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/setpill"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2019-08-24T05:51:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16556#issuecomment-524523118",
      "id" : 524523118,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16556",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyNDUyMzExOA==",
      "updated_at" : "2019-08-25T14:46:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/524523118",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipsorcery @dongcarl Want to take another look here?",
      "created_at" : "2019-08-28T03:48:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16556#issuecomment-525572459",
      "id" : 525572459,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16556",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyNTU3MjQ1OQ==",
      "updated_at" : "2019-08-28T03:48:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/525572459",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "tACK f3b57f4a1c17aadbf02d408e980490c88838c6ba (nothing changed since previous tACK).",
      "created_at" : "2019-08-28T17:41:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16556#issuecomment-525848427",
      "id" : 525848427,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16556",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyNTg0ODQyNw==",
      "updated_at" : "2019-08-28T17:41:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/525848427",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/197660?v=4",
         "events_url" : "https://api.github.com/users/sipsorcery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipsorcery/followers",
         "following_url" : "https://api.github.com/users/sipsorcery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipsorcery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipsorcery",
         "id" : 197660,
         "login" : "sipsorcery",
         "node_id" : "MDQ6VXNlcjE5NzY2MA==",
         "organizations_url" : "https://api.github.com/users/sipsorcery/orgs",
         "received_events_url" : "https://api.github.com/users/sipsorcery/received_events",
         "repos_url" : "https://api.github.com/users/sipsorcery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipsorcery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipsorcery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "FWIW, `PermissionsStartOnly`, introduced in this PR, is [deprecated](https://github.com/systemd/systemd/pull/10802).",
      "created_at" : "2019-09-29T07:32:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16556#issuecomment-536262395",
      "id" : 536262395,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16556",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNjI2MjM5NQ==",
      "updated_at" : "2019-09-29T07:32:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/536262395",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   }
]
