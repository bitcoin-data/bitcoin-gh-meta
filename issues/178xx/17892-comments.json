[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17994](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17994.html) (validation: flush undo files after last block write by kallewoof)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-01-07T18:33:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-571713613",
      "id" : 571713613,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTcxMzYxMw==",
      "updated_at" : "2020-01-24T10:29:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571713613",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thread-safety annotations (`GUARDED_BY` etc.) seems to be missing? :)",
      "created_at" : "2020-01-07T21:29:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-571781435",
      "id" : 571781435,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTc4MTQzNQ==",
      "updated_at" : "2020-01-07T21:29:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571781435",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@practicalswift Thanks for the nudge. My apologies, though... I ended up scratching this solution for a much simpler one (see updated code).",
      "created_at" : "2020-01-08T03:41:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-571878001",
      "id" : 571878001,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTg3ODAwMQ==",
      "updated_at" : "2020-01-08T03:41:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571878001",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Some stats: after syncing my mac up to ~ block 186k, the blocks dir looks like this:\r\n```bash\r\n$ du -ch *.dat\r\n128M\tblk00000.dat\r\n128M\tblk00001.dat\r\n128M\tblk00002.dat\r\n128M\tblk00003.dat\r\n128M\tblk00004.dat\r\n128M\tblk00005.dat\r\n128M\tblk00006.dat\r\n128M\tblk00007.dat\r\n128M\tblk00008.dat\r\n128M\tblk00009.dat\r\n128M\tblk00010.dat\r\n128M\tblk00011.dat\r\n128M\tblk00012.dat\r\n128M\tblk00013.dat\r\n144M\tblk00014.dat\r\n 19M\trev00000.dat\r\n 16M\trev00001.dat\r\n 16M\trev00002.dat\r\n 16M\trev00003.dat\r\n 16M\trev00004.dat\r\n 17M\trev00005.dat\r\n 17M\trev00006.dat\r\n 17M\trev00007.dat\r\n 18M\trev00008.dat\r\n 17M\trev00009.dat\r\n 17M\trev00010.dat\r\n 17M\trev00011.dat\r\n 18M\trev00012.dat\r\n171M\trev00013.dat\r\n 21M\trev00014.dat\r\n2.3G\ttotal\r\n```\r\nThe fact the blk for 14 and rev files for 13-14 are bloated is due to a separate bug (see #17887).\r\n\r\nNote that rev 13 is still huge despite us moving on to rev 14. When blk 14 is *finalized*, it will truncate rev 13 down to its right size. It may be worthwhile to actually finalize current and previous twice, to avoid this, but since we are more or less guaranteed to again pre-allocate into X-1, this seems unnecessary, and #17887 will make this have significantly less impact.\r\n",
      "created_at" : "2020-01-08T03:54:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-571880370",
      "id" : 571880370,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTg4MDM3MA==",
      "updated_at" : "2020-01-08T03:54:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571880370",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I can confirm the bug. I've run into it multiple times. Kalle is convinced that we are at fault, although I'm not so sure, and I think this might even be an Apple bug. It only shows up on APFS, and the implementation of rsync which ships with macOS also suffers from the same issue.\r\n\r\nBut in any case, if we can fix it on our end we should, and this should be pretty high priority. It can end up wasting hundreds of gigabytes of space during an IBD, in some cases exhausting the file on 512GB drives in a way that is very non-intuitive to figure out and fix as a user.",
      "created_at" : "2020-01-08T08:14:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-571938255",
      "id" : 571938255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTkzODI1NQ==",
      "updated_at" : "2020-01-08T08:14:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571938255",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/69154?v=4",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "node_id" : "MDQ6VXNlcjY5MTU0",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "ACK 0508072e1a45c339a181d24c2edfc88e3cd5201f built locally. All tests pass. I see the blow-up happening and the files being truncated as the following blk file is opened and the previous is finalized.\r\n\r\nHere rev00004.dat is still not truncated since we are on blk00005.dat\r\n```\r\n128M\tblk00000.dat\r\n128M\tblk00001.dat\r\n128M\tblk00002.dat\r\n128M\tblk00003.dat\r\n128M\tblk00004.dat\r\n576M\tblk00005.dat\r\n 19M\trev00000.dat\r\n 16M\trev00001.dat\r\n 16M\trev00002.dat\r\n 16M\trev00003.dat\r\n153M\trev00004.dat\r\n136M\trev00005.dat\r\n```\r\n\r\nIn the next step blk00005.dat has been finalized and rev00004.dat is truncated.\r\n```\r\n128M\tblk00000.dat\r\n128M\tblk00001.dat\r\n128M\tblk00002.dat\r\n128M\tblk00003.dat\r\n128M\tblk00004.dat\r\n128M\tblk00005.dat\r\n 16M\tblk00006.dat\r\n 19M\trev00000.dat\r\n 16M\trev00001.dat\r\n 16M\trev00002.dat\r\n 16M\trev00003.dat\r\n 16M\trev00004.dat\r\n153M\trev00005.dat\r\n1.0M\trev00006.dat\r\n```",
      "created_at" : "2020-01-20T20:15:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-576416961",
      "id" : 576416961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NjQxNjk2MQ==",
      "updated_at" : "2020-01-20T20:15:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/576416961",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17892#discussion_r368713120"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17892"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/368713120"
         }
      },
      "author_association" : "NONE",
      "body" : "```suggestion\r\n    int previous_undo_file = fFinalize && nLastBlockFile > 0 ? nLastBlockFile - 1 : nLastBlockFile;\r\n```\r\nGiven the comment on line 1738, is _previous_ more appropriate than last?",
      "commit_id" : "b49b34139ac3c187eaac21b25f88cd493ce668b2",
      "created_at" : "2020-01-20T20:20:01Z",
      "diff_hunk" : "@@ -1735,8 +1735,14 @@ void static FlushBlockFile(bool fFinalize = false)\n {\n     LOCK(cs_LastBlockFile);\n \n+    // we want to finalize flush the previous undo file, as it will have been written to\n+    // for awhile even after we've moved onto the next blk file; if we don't do this, we\n+    // end up with a re-opened but unflushed rev file, resulting in pre-allocated but not\n+    // returned disk space allocation\n+    int last_undo_file = fFinalize && nLastBlockFile > 0 ? nLastBlockFile - 1 : nLastBlockFile;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#discussion_r368713120",
      "id" : 368713120,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODcxMzEyMA==",
      "original_commit_id" : "0508072e1a45c339a181d24c2edfc88e3cd5201f",
      "original_position" : 8,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 345517243,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17892",
      "updated_at" : "2020-01-22T16:11:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/368713120",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17892#discussion_r368765758"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17892"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/368765758"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Makes sense.",
      "commit_id" : "b49b34139ac3c187eaac21b25f88cd493ce668b2",
      "created_at" : "2020-01-21T00:23:46Z",
      "diff_hunk" : "@@ -1735,8 +1735,14 @@ void static FlushBlockFile(bool fFinalize = false)\n {\n     LOCK(cs_LastBlockFile);\n \n+    // we want to finalize flush the previous undo file, as it will have been written to\n+    // for awhile even after we've moved onto the next blk file; if we don't do this, we\n+    // end up with a re-opened but unflushed rev file, resulting in pre-allocated but not\n+    // returned disk space allocation\n+    int last_undo_file = fFinalize && nLastBlockFile > 0 ? nLastBlockFile - 1 : nLastBlockFile;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#discussion_r368765758",
      "id" : 368765758,
      "in_reply_to_id" : 368713120,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODc2NTc1OA==",
      "original_commit_id" : "0508072e1a45c339a181d24c2edfc88e3cd5201f",
      "original_position" : 8,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 345581038,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17892",
      "updated_at" : "2020-01-22T16:11:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/368765758",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Similar to here https://github.com/bitcoin/bitcoin/pull/17887#issuecomment-576780731 I am not able to reproduce this issue on current master (no matter if `--enable-debug` or not). Happy to take hints and retest as I am curious why my results are different from everyone else.",
      "created_at" : "2020-01-21T21:44:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-576896930",
      "id" : 576896930,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3Njg5NjkzMA==",
      "updated_at" : "2020-01-21T21:44:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/576896930",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@fjahr  https://github.com/bitcoin/bitcoin/pull/17887#issuecomment-576780731 seems to indicate you were finally able to reproduce the issue. Or is that comment older?",
      "created_at" : "2020-01-22T01:16:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-576962903",
      "id" : 576962903,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3Njk2MjkwMw==",
      "updated_at" : "2020-01-22T01:16:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/576962903",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @fjahr [#17887 (comment)](https://github.com/bitcoin/bitcoin/pull/17887#issuecomment-576780731) seems to indicate you were finally able to reproduce the issue. Or is that comment older?\r\n\r\nYes, sorry, this is not worded clearly: I could reproduce #17887 with rev files up 64M large if compiled without `--enable-debug` but I could not reproduce it with `--enable-debug`. This one I can not reproduce no matter if I set debugging or not.",
      "created_at" : "2020-01-22T15:03:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577227435",
      "id" : 577227435,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzIyNzQzNQ==",
      "updated_at" : "2020-01-22T15:03:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577227435",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@fjahr You can not detect the following pattern anywhere in your log file even after syncing for awhile?\r\n\r\n```\r\n(date) Leaving block file X: CBlockFileInfo(...)\r\n(date) Pre-allocating up to position 0x1000000 in blk(X+1).dat\r\n(date) Pre-allocating up to position 0x100000 in rev(X+1).dat\r\n[...]\r\n(date) Pre-allocating up to position (...) in rev(X).dat\r\n```\r\n",
      "created_at" : "2020-01-22T15:33:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577243156",
      "id" : 577243156,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzI0MzE1Ng==",
      "updated_at" : "2020-01-22T15:33:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577243156",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@kallewoof I do see it, but not regularly. From my last sync up to 190k it seems to appear 3 times: For X=7, X=10 and X=14. I was trying hard to catch a larger than normal file size with `du -ch *.dat`, so I missed the right block/rev file transition?",
      "created_at" : "2020-01-22T15:50:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577250921",
      "id" : 577250921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzI1MDkyMQ==",
      "updated_at" : "2020-01-22T15:52:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577250921",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There's some amount of randomness involved, as the order in which blocks are received and the order in which they are connected is different.\r\n\r\nWith #17887 merged, it will be very hard to physically spot these now, but it should occasionally show larger-than-necessary rev files (in the range of 1 b up to 1 MB). ",
      "created_at" : "2020-01-22T16:06:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577258840",
      "id" : 577258840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzI1ODg0MA==",
      "updated_at" : "2020-01-22T16:06:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577258840",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Given that #17887 is merged, is it still worth the risk of back-porting? (can always do that later, after 0.20 is released)",
      "created_at" : "2020-01-22T16:56:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577282175",
      "id" : 577282175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzI4MjE3NQ==",
      "updated_at" : "2020-01-22T16:57:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577282175",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17892#discussion_r369684039"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17892"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369684039"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: add brackets to clarify (correct) precedence: `(nLastBlockFile > 0)`",
      "commit_id" : "b49b34139ac3c187eaac21b25f88cd493ce668b2",
      "created_at" : "2020-01-22T16:59:58Z",
      "diff_hunk" : "@@ -1735,8 +1735,14 @@ void static FlushBlockFile(bool fFinalize = false)\n {\n     LOCK(cs_LastBlockFile);\n \n+    // we want to finalize flush the previous undo file, as it will have been written to\n+    // for awhile even after we've moved onto the next blk file; if we don't do this, we\n+    // end up with a re-opened but unflushed rev file, resulting in pre-allocated but not\n+    // returned disk space allocation\n+    int previous_undo_file = fFinalize && nLastBlockFile > 0 ? nLastBlockFile - 1 : nLastBlockFile;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#discussion_r369684039",
      "id" : 369684039,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTY4NDAzOQ==",
      "original_commit_id" : "b49b34139ac3c187eaac21b25f88cd493ce668b2",
      "original_position" : 8,
      "path" : "src/validation.cpp",
      "position" : 8,
      "pull_request_review_id" : 346749846,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17892",
      "updated_at" : "2020-01-22T16:59:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369684039",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors\r\n\r\n> Given that #17887 is merged, is it still worth the risk of back-porting? (can always do that later, after 0.20 is released)\r\n\r\nThere are nearly two thousand rev files right now. Someone doing an IBD sync using 0.19 today would end up wasting up to 2 GB of space due to this bug. I do believe we want to plug that hole, even though it has become much smaller of an issue as you mention.\r\n",
      "created_at" : "2020-01-23T01:07:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577459432",
      "id" : 577459432,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzQ1OTQzMg==",
      "updated_at" : "2020-01-23T01:07:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577459432",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17892#discussion_r369892962"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17892"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369892962"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I honestly don't think that's necessary, but I'm open to change my opinion.",
      "commit_id" : "b49b34139ac3c187eaac21b25f88cd493ce668b2",
      "created_at" : "2020-01-23T01:27:09Z",
      "diff_hunk" : "@@ -1735,8 +1735,14 @@ void static FlushBlockFile(bool fFinalize = false)\n {\n     LOCK(cs_LastBlockFile);\n \n+    // we want to finalize flush the previous undo file, as it will have been written to\n+    // for awhile even after we've moved onto the next blk file; if we don't do this, we\n+    // end up with a re-opened but unflushed rev file, resulting in pre-allocated but not\n+    // returned disk space allocation\n+    int previous_undo_file = fFinalize && nLastBlockFile > 0 ? nLastBlockFile - 1 : nLastBlockFile;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#discussion_r369892962",
      "id" : 369892962,
      "in_reply_to_id" : 369684039,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg5Mjk2Mg==",
      "original_commit_id" : "b49b34139ac3c187eaac21b25f88cd493ce668b2",
      "original_position" : 8,
      "path" : "src/validation.cpp",
      "position" : 8,
      "pull_request_review_id" : 347013003,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17892",
      "updated_at" : "2020-01-23T01:27:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369892962",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Last time I did an IBD (a few months ago) it was >100GB wasted. Thatâs actually how I discovered this problem initially, it was enough wasted space to impact me (full disk).",
      "created_at" : "2020-01-23T02:08:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577472426",
      "id" : 577472426,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzQ3MjQyNg==",
      "updated_at" : "2020-01-23T02:08:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577472426",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/69154?v=4",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "node_id" : "MDQ6VXNlcjY5MTU0",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@maaku \r\n\r\n> Last time I did an IBD (a few months ago) it was >100GB wasted. Thatâs actually how I discovered this problem initially, it was enough wasted space to impact me (full disk).\r\n\r\nYeah, that was partially fixed in #17887, so you shouldn't see quite that drastic of an effect anymore, but still..",
      "created_at" : "2020-01-23T03:06:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577484298",
      "id" : 577484298,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzQ4NDI5OA==",
      "updated_at" : "2020-01-23T03:06:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577484298",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "And this discussion is about backporting those changes, no?",
      "created_at" : "2020-01-23T03:20:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577486986",
      "id" : 577486986,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzQ4Njk4Ng==",
      "updated_at" : "2020-01-23T03:20:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577486986",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/69154?v=4",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "node_id" : "MDQ6VXNlcjY5MTU0",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No, #17887 is already in the backported list and is not under discussion. @Sjors is wondering whether this patch, which delays finalize-flushing the rev files until we're (pretty) sure they are no longer appended to, should be backported or not.\r\n\r\nWithout this patch, we will experience 0-1 MB of wasted space for each rev file.\r\n\r\nWithout #17887 we would experience what you saw.",
      "created_at" : "2020-01-23T03:34:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577489646",
      "id" : 577489646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzQ4OTY0Ng==",
      "updated_at" : "2020-01-23T03:34:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577489646",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have now done another run with this fix and could not detect the pattern described in https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577243156 in my debug.log\r\n\r\nACK b49b34139ac3c187eaac21b25f88cd493ce668b2",
      "created_at" : "2020-01-23T11:00:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577632476",
      "id" : 577632476,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzYzMjQ3Ng==",
      "updated_at" : "2020-01-23T11:00:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577632476",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Without this patch, we will experience 0-1 MB of wasted space for each rev file.\r\n\r\nIt seems like this does not warrant a backport to 0.19.1",
      "created_at" : "2020-01-23T13:08:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577674241",
      "id" : 577674241,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzY3NDI0MQ==",
      "updated_at" : "2020-01-23T13:08:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577674241",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke \r\n\r\nDepends if you think \"a few GBs wasted\" is negligible or not. (This is for non-pruned nodes only, so a few GBs in a 250 GB datadir.)",
      "created_at" : "2020-01-23T13:26:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577680437",
      "id" : 577680437,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzY4MDQzNw==",
      "updated_at" : "2020-01-23T13:47:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577680437",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yes, based on your comments this should be less than 1% off (not noticeable for a user)",
      "created_at" : "2020-01-23T14:15:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577699541",
      "id" : 577699541,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzY5OTU0MQ==",
      "updated_at" : "2020-01-23T14:15:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577699541",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> @MarcoFalke\r\n> \r\n> Depends if you think \"a few GBs wasted\" is negligible or not. (This is for non-pruned nodes only, so a few GBs in a 250 GB datadir.)\r\n\r\nI did a quick test with downloading from scratch up to year 2014 (approx. 270k blocks):\r\n\r\n**master (278292 blocks, 1931064 bytes, 10 files with size 19M)**\r\n\r\n```\r\n2020-01-23T11:01:43Z Leaving block file 104: CBlockFileInfo(blocks=871, size=134096120, heights=276943...278292, time=2013-12-25...2014-01-02)\r\n\r\nAntons-Mac-mini:HDD2 a48$ ls -la Bitcoin.nopatch/blocks/rev00* | wc -l\r\n     105\r\n\r\nAntons-Mac-mini:HDD2 a48$ du -ck Bitcoin.nopatch/blocks/rev00* | grep total\r\n1931064\ttotal\r\n\r\nAntons-Mac-mini:HDD2 a48$ du -ch Bitcoin.nopatch/blocks/rev00* | grep 19M\r\n 19M\tBitcoin.nopatch/blocks/rev00000.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00013.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00073.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00075.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00081.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00083.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00086.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00087.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00094.dat\r\n 19M\tBitcoin.nopatch/blocks/rev00101.dat\r\nAntons-Mac-mini:HDD2 a48$ du -ch Bitcoin.nopatch/blocks/rev00* | grep 19M | wc -l\r\n      10\r\nAntons-Mac-mini:HDD2 a48$ du -ch Bitcoin.nopatch/blocks/rev00* | grep 18M | wc -l\r\n      80\r\n```\r\n\r\n**this PR (278293 blocks, 1865004 bytes, no files with size 19M, all of them are 17M or 18M)**\r\n\r\n```\r\n2020-01-23T12:48:45Z Leaving block file 104: CBlockFileInfo(blocks=865, size=134045380, heights=277411...278293, time=2013-12-28...2014-01-02)\r\n\r\nAntons-Mac-mini:HDD2 a48$ ls -la Bitcoin.patch/blocks/rev00* | wc -l\r\n     105\r\n\r\nAntons-Mac-mini:HDD2 a48$ du -ck Bitcoin.patch/blocks/rev00* | grep total\r\n1865004\ttotal\r\n\r\nAntons-Mac-mini:HDD2 a48$ du -ch Bitcoin.patch/blocks/rev00* | grep 19M\r\nAntons-Mac-mini:HDD2 a48$ du -ch Bitcoin.patch/blocks/rev00* | grep 19M | wc -l\r\n       0\r\nAntons-Mac-mini:HDD2 a48$ du -ch Bitcoin.patch/blocks/rev00* | grep 18M | wc -l\r\n      38\r\n```\r\n\r\nso, it looks for me that there could be more than 1G of overhead on a fullnode with all blocks (will test it, but it takes time).",
      "created_at" : "2020-01-23T14:21:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577701885",
      "id" : 577701885,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzcwMTg4NQ==",
      "updated_at" : "2020-01-23T16:17:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577701885",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/15836314?v=4",
         "events_url" : "https://api.github.com/users/anton48/events{/privacy}",
         "followers_url" : "https://api.github.com/users/anton48/followers",
         "following_url" : "https://api.github.com/users/anton48/following{/other_user}",
         "gists_url" : "https://api.github.com/users/anton48/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/anton48",
         "id" : 15836314,
         "login" : "anton48",
         "node_id" : "MDQ6VXNlcjE1ODM2MzE0",
         "organizations_url" : "https://api.github.com/users/anton48/orgs",
         "received_events_url" : "https://api.github.com/users/anton48/received_events",
         "repos_url" : "https://api.github.com/users/anton48/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/anton48/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/anton48/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/anton48"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@anton48 Thanks for the initiative. I'll do the same thing on my side so we can get some clarity on the matter.\r\n\r\n@MarcoFalke I agree with you, but with the caveat that it's temporary. It's ludicrous to waste several GB of space on people's machines for no good reason. My proposal is that we (1) make a PR that does a one time sweep (esp important for people with lots of disk space who are stuck with pre-#17887 datadirs, if such people exist at all) + implements this code*, and to potentially backport those two.\r\n\r\n(* or possibly more sophisticated; ideal implementation is to, for each blk file, track which block is the highest height, and once that has been connected, to finalize the corresponding rev file)\r\n",
      "created_at" : "2020-01-23T14:25:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577703536",
      "id" : 577703536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzcwMzUzNg==",
      "updated_at" : "2020-01-23T14:25:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577703536",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I agree with you, but with the caveat that it's temporary. It's ludicrous to waste several GB of space on people's machines for no good reason. \r\n\r\nThe waste would be temporary; until the user installs 0.20 or 0.19.2. Worst case scenario is block data corruption. Because I'm personally not familiar with this area of the code, I prefer to let it stew on master for a while before shipping. But if others feel very comfortable that this code is correct then I'm fine with backporting. ",
      "created_at" : "2020-01-23T18:13:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577803248",
      "id" : 577803248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzgwMzI0OA==",
      "updated_at" : "2020-01-23T18:14:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577803248",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> @anton48 Thanks for the initiative. I'll do the same thing on my side so we can get some clarity on the matter.\r\n> \r\n> @MarcoFalke I agree with you, but with the caveat that it's temporary. It's ludicrous to waste several GB of space on people's machines for no good reason. My proposal is that we (1) make a PR that does a one time sweep (esp important for people with lots of disk space who are stuck with pre-#17887 datadirs, if such people exist at all) + implements this code*, and to potentially backport those two.\r\n> \r\n> (* or possibly more sophisticated; ideal implementation is to, for each blk file, track which block is the highest height, and once that has been connected, to finalize the corresponding rev file)\r\n\r\n@kallewoof Given it has not been getting attention since the release of APFS in September, 2017 it seems not that many installations exist. Is it worth adding this extra complexity for little or no users? Do we know how  many are potentially running a version that has the bug? The workarounds are not optimal either of course, but at least there is one ~are two relatively easy ones~:\r\n1. Do the IBD from scratch using the latest version\r\n~2. Run a truncate bash script (https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570125891)~",
      "created_at" : "2020-01-23T18:20:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577805976",
      "id" : 577805976,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzgwNTk3Ng==",
      "updated_at" : "2020-01-24T06:46:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577805976",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@kallewoof @anton48 I can also repeat the full IBD test running Bitcoin-Qt on the Mac Mini like I did for #17887, it will take about 3 days to complete.",
      "created_at" : "2020-01-23T18:25:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577808580",
      "id" : 577808580,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NzgwODU4MA==",
      "updated_at" : "2020-01-23T18:25:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577808580",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@eriknylund Unfortunately that bash script only addresses #17887, not #17892.\r\n\r\n@Sjors It's not technically temporary until someone writes code that does a one-time sweep of people's rev files and backport this & that, but since we only see ~1 rev file a day, people's drives shouldn't suffer more than a few hundred MBs before a patch is in place, hopefully.\r\n",
      "created_at" : "2020-01-24T01:36:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577956148",
      "id" : 577956148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3Nzk1NjE0OA==",
      "updated_at" : "2020-01-24T01:36:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577956148",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I am working on an improved version of this, based on https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-577703536",
      "created_at" : "2020-01-24T05:51:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-578001022",
      "id" : 578001022,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODAwMTAyMg==",
      "updated_at" : "2020-01-24T05:51:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578001022",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> @eriknylund Unfortunately that bash script only addresses #17887, not #17892.\r\n> \r\n> @Sjors It's not technically temporary until someone writes code that does a one-time sweep of people's rev files and backport this & that, but since we only see ~1 rev file a day, people's drives shouldn't suffer more than a few hundred MBs before a patch is in place, hopefully.\r\n\r\n@kallewoof Ah you're absolutely correct. Thanks for pointing that out. ",
      "created_at" : "2020-01-24T06:47:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-578012384",
      "id" : 578012384,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODAxMjM4NA==",
      "updated_at" : "2020-01-24T06:47:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578012384",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> > @eriknylund Unfortunately that bash script only addresses #17887, not #17892.\r\n> > @Sjors It's not technically temporary until someone writes code that does a one-time sweep of people's rev files and backport this & that, but since we only see ~1 rev file a day, people's drives shouldn't suffer more than a few hundred MBs before a patch is in place, hopefully.\r\n> \r\n> @kallewoof Ah you're absolutely correct. Thanks for pointing that out.\r\n\r\nhowever, in my case the script made some truncations at yesterday test directory (which is on AFPS volume):\r\n\r\n```\r\nAntons-Mac-mini:blocks a48$ /Users/a48/slim.sh\r\n./rev00000.dat 19M  ->  19M\r\n[..]\r\n./rev00013.dat 19M  ->  18M\r\n[..]\r\n./rev00047.dat 18M  ->  17M\r\n[..]\r\n./rev00053.dat 18M  ->  17M\r\n[..]\r\n./rev00063.dat 18M  ->  17M\r\n./rev00064.dat 18M  ->  17M\r\n[..]\r\n./rev00070.dat 18M  ->  17M\r\n[..]\r\n./rev00073.dat 19M  ->  18M\r\n[..]\r\n./rev00075.dat 19M  ->  18M\r\n[..]\r\n./rev00083.dat 19M  ->  18M\r\n[..]\r\n./rev00086.dat 19M  ->  18M\r\n./rev00087.dat 19M  ->  18M\r\n[..]\r\n./rev00101.dat 19M  ->  18M\r\n[..]\r\n./rev00104.dat 18M  ->  18M\r\n```\r\n",
      "created_at" : "2020-01-24T08:40:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-578040791",
      "id" : 578040791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODA0MDc5MQ==",
      "updated_at" : "2020-01-24T08:40:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578040791",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/15836314?v=4",
         "events_url" : "https://api.github.com/users/anton48/events{/privacy}",
         "followers_url" : "https://api.github.com/users/anton48/followers",
         "following_url" : "https://api.github.com/users/anton48/following{/other_user}",
         "gists_url" : "https://api.github.com/users/anton48/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/anton48",
         "id" : 15836314,
         "login" : "anton48",
         "node_id" : "MDQ6VXNlcjE1ODM2MzE0",
         "organizations_url" : "https://api.github.com/users/anton48/orgs",
         "received_events_url" : "https://api.github.com/users/anton48/received_events",
         "repos_url" : "https://api.github.com/users/anton48/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/anton48/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/anton48/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/anton48"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I did some number crunching and concluded that a backport is probably not necessary. I am also closing this PR in favor of #17994. Will re-open if people object/prefer this one.",
      "created_at" : "2020-01-26T11:41:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17892#issuecomment-578493752",
      "id" : 578493752,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17892",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODQ5Mzc1Mg==",
      "updated_at" : "2020-01-26T11:41:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578493752",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   }
]
