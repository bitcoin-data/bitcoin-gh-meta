[
   {
      "author_association" : "NONE",
      "body" : "I tried the workaround I suggested in the bug report, by removing the earlier of the rev*.dat files to free  up the required space to download all blocks, and then removing all rev*.dat files forcing a reindex but the result is the same. On the Mac Mini I get to 83% when the disk is full. So achieving a full node on the Mac Mini with 480 GB free space to begin with _seems_ impossible.\r\n\r\n```\r\nblocks % pwd\r\n\r\n/Users/erik/Library/Application Support/Bitcoin/blocks\r\n\r\nblocks % du -h .\r\n\r\n 90M\t./index\r\n391G\t.\r\n\r\n% df -h\r\n\r\nFilesystem          Size   Used  Avail Capacity iused      ifree %iused  Mounted on\r\n/dev/disk1s5       466Gi   10Gi   52Gi    17%  484073 4881333367    0%   /\r\ndevfs              233Ki  233Ki    0Bi   100%     808          0  100%   /dev\r\n/dev/disk1s1       466Gi  401Gi   52Gi    89%  142604 4881674836    0%   /System/Volumes/Data\r\n/dev/disk1s4       466Gi  2.0Gi   52Gi     4%       2 4881817438    0%   /private/var/vm\r\nmap auto_home        0Bi    0Bi    0Bi   100%       0          0  100%   /System/Volumes/Data/home\r\n\r\nblocks % du -ch rev*.dat | sort -n\r\n\r\n 17M\trev01912.dat\r\n 19M\trev00000.dat\r\n 32M\trev00002.dat\r\n ...\r\n 210M\trev01291.dat\r\n 250M\trev01036.dat\r\n152G\ttotal\r\n\r\nblocks % du -ch blk*.dat\r\n\r\n128M\tblk00000.dat\r\n128M\tblk00001.dat\r\n128M\tblk00002.dat\r\n...\r\n128M\tblk01912.dat\r\n125M\tblk01913.dat\r\n238G\ttotal\r\n\r\nblocks % rm rev*.dat\r\n\r\n% df -h\r\n\r\nFilesystem          Size   Used  Avail Capacity iused      ifree %iused  Mounted on\r\n/dev/disk1s5       466Gi   10Gi  204Gi     5%  484073 4881333367    0%   /\r\ndevfs              233Ki  233Ki    0Bi   100%     808          0  100%   /dev\r\n/dev/disk1s1       466Gi  248Gi  204Gi    55%  141579 4881675861    0%   /System/Volumes/Data\r\n/dev/disk1s4       466Gi  2.0Gi  204Gi     1%       2 4881817438    0%   /private/var/vm\r\nmap auto_home        0Bi    0Bi    0Bi   100%       0          0  100%   /System/Volumes/Data/home\r\n```\r\n\r\nStarted Bitcoin Core and clicked OK to rebuild the block database.\r\n\r\n![corrupted-block-database-detected](https://user-images.githubusercontent.com/20860124/71611833-e97aee00-2ba4-11ea-942b-df3d7bebeb3e.png)\r\n\r\n![reindexing-blocks-on-disk](https://user-images.githubusercontent.com/20860124/71611857-116a5180-2ba5-11ea-9e91-25c160c011b6.png)\r\n\r\n![processing-blocks-on-disk](https://user-images.githubusercontent.com/20860124/71611861-17603280-2ba5-11ea-8dd0-9101bb29712d.png)\r\n\r\n```\r\n% tail debug.log\r\n\r\n2019-12-31T04:32:26Z UpdateTip: new best=00000000000000000016319a033ba5a534d962bf17077825634a0bbcce5dbf48 height=573963 version=0x20000000 log2_work=90.59244 tx=408110896 date='2019-04-30T19:18:40Z' progress=0.832507 cache=726.0MiB(5526596txo)\r\n2019-12-31T04:32:26Z *** Disk space is too low!\r\n2019-12-31T04:32:26Z Error: Disk space is too low!\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:13Z socket sending timeout: 1201s\r\n2019-12-31T06:02:11Z Failed to connect best block (Disk space is too low! (code 0))\r\n2019-12-31T06:02:11Z tor: Thread interrupt\r\n2019-12-31T06:02:11Z Shutdown: In progress...\r\n2019-12-31T06:02:11Z torcontrol thread exit\r\n2019-12-31T06:02:11Z addcon thread exit\r\n2019-12-31T06:02:11Z opencon thread exit\r\n2019-12-31T06:02:11Z msghand thread exit\r\n2019-12-31T06:02:11Z net thread exit\r\n2019-12-31T06:02:11Z scheduler thread interrupt\r\n2019-12-31T06:02:11Z *** Disk space is too low!\r\n2019-12-31T06:02:11Z Error: Disk space is too low!\r\n2019-12-31T06:02:11Z ForceFlushStateToDisk: failed to flush state (Disk space is too low! (code 0))\r\n2019-12-31T06:02:11Z *** Disk space is too low!\r\n2019-12-31T06:02:11Z Error: Disk space is too low!\r\n2019-12-31T06:02:11Z ForceFlushStateToDisk: failed to flush state (Disk space is too low! (code 0))\r\n2019-12-31T06:02:12Z [default wallet] Releasing wallet\r\n2019-12-31T06:02:12Z Shutdown: done\r\n```\r\n\r\nOnce again the rev*.dat files uses 205G of disk space, the sizes range from 0B to 231M.\r\n```\r\nblocks % du -ch rev*.dat | sort -n\r\n\r\n  0B\trev01623.dat\r\n  0B\trev01624.dat\r\n  0B\trev01625.dat\r\n  0B\trev01626.dat\r\n  0B\trev01627.dat\r\n  0B\trev01628.dat\r\n...\r\n210M\trev00349.dat\r\n210M\trev00350.dat\r\n210M\trev00352.dat\r\n210M\trev00353.dat\r\n210M\trev00432.dat\r\n229M\trev00337.dat\r\n231M\trev00333.dat\r\n231M\trev00336.dat\r\n205G\ttotal\r\n\r\n% df -h\r\n                     \r\nFilesystem          Size   Used  Avail Capacity iused      ifree %iused  Mounted on\r\n/dev/disk1s5       466Gi   10Gi  247Mi    98%  484073 4881333367    0%   /\r\ndevfs              233Ki  233Ki    0Bi   100%     808          0  100%   /dev\r\n/dev/disk1s1       466Gi  452Gi  247Mi   100%  143019 4881674421    0%   /System/Volumes/Data\r\n/dev/disk1s4       466Gi  2.0Gi  247Mi    90%       2 4881817438    0%   /private/var/vm\r\nmap auto_home        0Bi    0Bi    0Bi   100%       0          0  100%   /System/Volumes/Data/home\r\n```",
      "created_at" : "2019-12-31T06:23:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569872745",
      "id" : 569872745,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg3Mjc0NQ==",
      "updated_at" : "2019-12-31T06:23:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569872745",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It says \"at least\". We can't accurately predict exactly how large the blockchain and associated data will be by the time synchronization finishes.",
      "created_at" : "2019-12-31T07:33:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569881430",
      "id" : 569881430,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4MTQzMA==",
      "updated_at" : "2019-12-31T07:33:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569881430",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "With the help of people on IRC #bitcoin we've managed to rule out some potential causes:\r\n1. Time Machine is not configured on the Mac mini:\r\n![no-time-machine-on-mac-mini](https://user-images.githubusercontent.com/20860124/71613981-fc47ef80-2bb1-11ea-913c-569a35c72ecc.png)\r\n",
      "created_at" : "2019-12-31T07:44:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569882624",
      "id" : 569882624,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4MjYyNA==",
      "updated_at" : "2019-12-31T07:44:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569882624",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> It says \"at least\". We can't accurately predict exactly how large the blockchain and associated data will be by the time synchronization finishes.\r\n\r\nYou're absolutely correct. However, I would argue that 480+ GB is **way** more than 284 GB. I actually don't know how much the whole download would require, as 480 GB only gets me to 83%.",
      "created_at" : "2019-12-31T07:47:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569882901",
      "id" : 569882901,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4MjkwMQ==",
      "updated_at" : "2019-12-31T07:47:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569882901",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My apologies, I missed that the difference was so large between two systems.\n\nYour rev files are way larger than they should be. However you can't just delete them, as that will interfere with reorgs and a few other operations.\n\nAs an immediate solution, you can enable pruning (which will delete blocks and rev files that are sufficiently old automatically and safely), but that is only addressing the symptom. ",
      "created_at" : "2019-12-31T07:55:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569883923",
      "id" : 569883923,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4MzkyMw==",
      "updated_at" : "2019-12-31T07:57:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569883923",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> My apologies, I missed that the difference was so large between two systems.\r\n> \r\n> Your rev files are way larger than they should be. However you can't just delete them, as that will interfere with reorgs and a few other operations.\r\n> \r\n> As an immediate solution, you can enable pruning (which will delete blocks and rev files that are sufficiently old automatically and safely), but that is only addressing the symptom.\r\n\r\nThanks for clarifying why deleting them is not a working solution (or even workaround as I concluded in my later tests). In my case, as I understand it, I cannot enable pruning since I will be running Lightning towards this full node.\r\n\r\nFurthermore, if this is the intended behaviour on macOS, then perhaps it would be a good idea to revise the minimum requirements on https://bitcoin.org/en/full-node#special-cases to make sure that Mac users avoid running into this problem.",
      "created_at" : "2019-12-31T08:08:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569885570",
      "id" : 569885570,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4NTU3MA==",
      "updated_at" : "2019-12-31T08:12:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569885570",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No, this is not intended behavior at all. The rev*.dat files shouldn't go above 15-20 MB usually.\n\nFWIW, some lightning implementations (e.g. c-lightning) work fine with a pruned bitcoind.",
      "created_at" : "2019-12-31T08:57:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569891730",
      "id" : 569891730,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg5MTczMA==",
      "updated_at" : "2019-12-31T08:57:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569891730",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> No, this is not intended behavior at all. The rev*.dat files shouldn't go above 15-20 MB usually.\r\n> \r\n> FWIW, some lightning implementations (e.g. c-lightning) work fine with a pruned bitcoind.\r\n\r\nThanks for the hint, I have only tried the lnd implementation so it could also be interesting to try that out!",
      "created_at" : "2019-12-31T09:10:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569893454",
      "id" : 569893454,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg5MzQ1NA==",
      "updated_at" : "2019-12-31T09:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569893454",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Digging a bit more into it with the help of #bitcoin we see that the files are mostly empty. Copying the file will result in a file size in the expected range.\r\n\r\n```\r\nblocks % du -h rev00336.dat \r\n231M\trev00336.dat\r\n\r\nblocks % hexdump -C rev00336.dat | tail -4\r\n0145c010  ea 7b e8 e9 86 7e c0 bc  fb 13 00 00 00 00 00 00  |.{...~..........|\r\n0145c020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n*\r\n01500000\r\n\r\n% grep \"rev00336.dat\" debug.log          \r\n2019-12-30T20:48:10Z Pre-allocating up to position 0x100000 in rev00336.dat\r\n2019-12-30T20:48:39Z Pre-allocating up to position 0x200000 in rev00336.dat\r\n2019-12-30T20:48:43Z Pre-allocating up to position 0x300000 in rev00336.dat\r\n2019-12-30T20:48:45Z Pre-allocating up to position 0x400000 in rev00336.dat\r\n2019-12-30T20:48:49Z Pre-allocating up to position 0x500000 in rev00336.dat\r\n2019-12-30T20:48:50Z Pre-allocating up to position 0x600000 in rev00336.dat\r\n2019-12-30T20:48:51Z Pre-allocating up to position 0x700000 in rev00336.dat\r\n2019-12-30T20:48:52Z Pre-allocating up to position 0x800000 in rev00336.dat\r\n2019-12-30T20:48:54Z Pre-allocating up to position 0x900000 in rev00336.dat\r\n2019-12-30T20:48:55Z Pre-allocating up to position 0xa00000 in rev00336.dat\r\n2019-12-30T20:48:57Z Pre-allocating up to position 0xb00000 in rev00336.dat\r\n2019-12-30T20:48:58Z Pre-allocating up to position 0xc00000 in rev00336.dat\r\n2019-12-30T20:49:00Z Pre-allocating up to position 0xd00000 in rev00336.dat\r\n2019-12-30T20:49:01Z Pre-allocating up to position 0xe00000 in rev00336.dat\r\n2019-12-30T20:49:02Z Pre-allocating up to position 0xf00000 in rev00336.dat\r\n2019-12-30T20:49:03Z Pre-allocating up to position 0x1000000 in rev00336.dat\r\n2019-12-30T20:49:05Z Pre-allocating up to position 0x1100000 in rev00336.dat\r\n2019-12-30T20:49:06Z Pre-allocating up to position 0x1200000 in rev00336.dat\r\n2019-12-30T20:49:08Z Pre-allocating up to position 0x1300000 in rev00336.dat\r\n2019-12-30T20:49:10Z Pre-allocating up to position 0x1400000 in rev00336.dat\r\n2019-12-30T20:49:12Z Pre-allocating up to position 0x1500000 in rev00336.dat\r\n\r\nblocks % ls -lh rev00336.dat \r\n-rw-------  1 erik  staff    21M Dec 30 22:49 rev00336.dat\r\n\r\nblocks % cp rev00336.dat rev00336.copy\r\n\r\nblocks % du -h rev00336.*\r\n 21M\trev00336.copy\r\n231M\trev00336.dat\r\n```\r\n\r\nSo a workaround might be to replace all the rev files with copies.",
      "created_at" : "2019-12-31T11:34:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569914702",
      "id" : 569914702,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTkxNDcwMg==",
      "updated_at" : "2019-12-31T11:47:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569914702",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> No, this is not intended behavior at all. The rev*.dat files shouldn't go above 15-20 MB usually.\r\n\r\nI currently have a fully synced node running on macOS (10.14) that uses nearly 500GB on disk:\r\n```bash\r\n475G\ttotal\r\n422G\tblocks\r\n 40G\tindexes\r\n8.4G\ttestnet3\r\n4.1G\tchainstate\r\n356M\tregtest\r\n9.8M\tdebug.log\r\n4.0M\twallet.dat\r\n4.0M\tpeers.dat\r\n4.0M\tmempool.dat\r\n896K\tsome_wallet\r\n256K\tfee_estimates.dat\r\n4.0K\tbitcoin.conf\r\n4.0K\tbanlist.dat\r\n  0B\tdb.log\r\n  0B\t.walletlock\r\n  0B\t.lock\r\n```\r\n\r\nLargest `rev*.dat` files:\r\n```bash\r\n206M\trev00352.dat\r\n193M\trev00331.dat\r\n190M\trev00461.dat\r\n190M\trev00447.dat\r\n190M\trev00390.dat\r\n190M\trev00389.dat\r\n190M\trev00386.dat\r\n190M\trev00374.dat\r\n```",
      "created_at" : "2019-12-31T18:21:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569969725",
      "id" : 569969725,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTk2OTcyNQ==",
      "updated_at" : "2019-12-31T18:21:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569969725",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> > No, this is not intended behavior at all. The rev*.dat files shouldn't go above 15-20 MB usually.\r\n> \r\n> I currently have a fully synced node running on macOS (10.14) that uses nearly 500GB on disk:\r\n> \r\n> ```shell\r\n> 475G\ttotal\r\n> 422G\tblocks\r\n>  40G\tindexes\r\n> 8.4G\ttestnet3\r\n> 4.1G\tchainstate\r\n> 356M\tregtest\r\n> 9.8M\tdebug.log\r\n> 4.0M\twallet.dat\r\n> 4.0M\tpeers.dat\r\n> 4.0M\tmempool.dat\r\n> 896K\tsome_wallet\r\n> 256K\tfee_estimates.dat\r\n> 4.0K\tbitcoin.conf\r\n> 4.0K\tbanlist.dat\r\n>   0B\tdb.log\r\n>   0B\t.walletlock\r\n>   0B\t.lock\r\n> ```\r\n> \r\n> Largest `rev*.dat` files:\r\n> \r\n> ```shell\r\n> 206M\trev00352.dat\r\n> 193M\trev00331.dat\r\n> 190M\trev00461.dat\r\n> 190M\trev00447.dat\r\n> 190M\trev00390.dat\r\n> 190M\trev00389.dat\r\n> 190M\trev00386.dat\r\n> 190M\trev00374.dat\r\n> ```\r\n\r\nAnd if you copy one of the larger files, will it reduce in size to the expected 15-20 MB range?",
      "created_at" : "2020-01-01T07:55:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570032136",
      "id" : 570032136,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDAzMjEzNg==",
      "updated_at" : "2020-01-01T07:55:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570032136",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "What is the file system used on the drive that keeps blocks folder? Also, can you post your bitcoin.conf file?",
      "created_at" : "2020-01-01T15:12:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570060574",
      "id" : 570060574,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDA2MDU3NA==",
      "updated_at" : "2020-01-01T15:12:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570060574",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/22457855?v=4",
         "events_url" : "https://api.github.com/users/streamofstars/events{/privacy}",
         "followers_url" : "https://api.github.com/users/streamofstars/followers",
         "following_url" : "https://api.github.com/users/streamofstars/following{/other_user}",
         "gists_url" : "https://api.github.com/users/streamofstars/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/streamofstars",
         "id" : 22457855,
         "login" : "streamofstars",
         "node_id" : "MDQ6VXNlcjIyNDU3ODU1",
         "organizations_url" : "https://api.github.com/users/streamofstars/orgs",
         "received_events_url" : "https://api.github.com/users/streamofstars/received_events",
         "repos_url" : "https://api.github.com/users/streamofstars/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/streamofstars/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/streamofstars/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/streamofstars"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The code that does the OS-specific file allocation hasn't been touched in 7 years (#2229), so I wonder what suddenly causes this.",
      "created_at" : "2020-01-01T16:48:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570066817",
      "id" : 570066817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDA2NjgxNw==",
      "updated_at" : "2020-01-01T16:48:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570066817",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> What is the file system used on the drive that keeps blocks folder? Also, can you post your bitcoin.conf file?\r\n\r\nBoth machines use APFS. \r\n\r\n![mac-mini-disk-utility](https://user-images.githubusercontent.com/20860124/71643888-02c88b00-2cc8-11ea-840b-1769f1d870db.png)\r\n\r\nI have no bitcoin.conf file in use, so only defaults should be used. This is a clean install using the dmg, no custom settings have been done.",
      "created_at" : "2020-01-01T17:07:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570068090",
      "id" : 570068090,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDA2ODA5MA==",
      "updated_at" : "2020-01-01T17:07:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570068090",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> The code that does the OS-specific file allocation hasn't been touched in 7 years (#2229), so I wonder what suddenly causes this.\r\n\r\nIt may not be so sudden, considering @fanquake 's 10.14 (macOS Mojave) machine that shows the same behavior.",
      "created_at" : "2020-01-01T17:10:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570068266",
      "id" : 570068266,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDA2ODI2Ng==",
      "updated_at" : "2020-01-01T17:10:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570068266",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I am struggling to reproduce this issue. I am now around 43% downloading blocks progress and upon investigating the blocks folder, I see all my rev* files are between 17-22MB and blk* files are around 134MB each, so I guess all looks good.\r\n\r\nTested on mac mini (2018) with macos 10.15.2 (19C57), 16GB RAM, i5. The drive selected for data is 500GB encrypted APFS partition on sata3 ssd connected via usb-c adapter. I haven't customized anything except unchecking pruning option and selecting the external drive as a data folder.\r\n\r\nWhat about your wallet file, is it just created from scratch or did you put an existing, old wallet into the bitcoin folder?",
      "created_at" : "2020-01-01T23:09:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570091287",
      "id" : 570091287,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDA5MTI4Nw==",
      "updated_at" : "2020-01-01T23:09:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570091287",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/22457855?v=4",
         "events_url" : "https://api.github.com/users/streamofstars/events{/privacy}",
         "followers_url" : "https://api.github.com/users/streamofstars/followers",
         "following_url" : "https://api.github.com/users/streamofstars/following{/other_user}",
         "gists_url" : "https://api.github.com/users/streamofstars/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/streamofstars",
         "id" : 22457855,
         "login" : "streamofstars",
         "node_id" : "MDQ6VXNlcjIyNDU3ODU1",
         "organizations_url" : "https://api.github.com/users/streamofstars/orgs",
         "received_events_url" : "https://api.github.com/users/streamofstars/received_events",
         "repos_url" : "https://api.github.com/users/streamofstars/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/streamofstars/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/streamofstars/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/streamofstars"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> I am struggling to reproduce this issue. I am now around 43% downloading blocks progress and upon investigating the blocks folder, I see all my rev* files are between 17-22MB and blk* files are around 134MB each, so I guess all looks good.\r\n> \r\n> Tested on mac mini (2018) with macos 10.15.2 (19C57), 16GB RAM, i5. The drive selected for data is 500GB encrypted APFS partition on sata3 ssd connected via usb-c adapter. I haven't customized anything except unchecking pruning option and selecting the external drive as a data folder.\r\n> \r\n> What about your wallet file, is it just created from scratch or did you put an existing, old wallet into the bitcoin folder?\r\n\r\nInteresting! **Everything** is completely from scratch, even the wallet. On the second machine my APFS is encrypted, and it's also showing the same issue, the largest rev files is 184M.\r\n\r\n```\r\n$ du -ch rev*.dat | sort -n\r\n 16M\trev00003.dat\r\n 17M\trev00056.dat\r\n 18M\trev00006.dat\r\n 20M\trev00000.dat\r\n...\r\n174M\trev00256.dat\r\n175M\trev00143.dat\r\n175M\trev00275.dat\r\n177M\trev00132.dat\r\n177M\trev00204.dat\r\n178M\trev00337.dat\r\n184M\trev00208.dat\r\n```\r\n\r\nI've located a spare 500 GB external SSD so I will try to reproduce with an external drive to see what happens.",
      "created_at" : "2020-01-02T05:47:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570123304",
      "id" : 570123304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDEyMzMwNA==",
      "updated_at" : "2020-01-02T05:50:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570123304",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "As a workaround based on a tip from the IRC discussions, I did a small bash script to slim down the rev files one by one, by copying them once, allowing me to continue from 83% and finish the download on the mac mini. These are the steps I took, below reproduced on my second machine that was on 23% when I stopped downloading, hence the total size is lower, but you can see there is already an extra 40G of space being consumed:\r\n```\r\n$ cd Library/Application\\ Support/Bitcoin/blocks\r\n$ du -h\r\n 91M\t./index\r\n105G\t.\r\n\r\n$ cat slim.sh \r\nfor file in ./rev*.dat\r\ndo\r\n    if [[ -f $file ]]; then\r\n\tsize_before=$(du -h $file | cut -f1)\r\n        cp $file $file.tmp\r\n        rm $file\r\n\tmv $file.tmp $file\r\n\tsize_after=$(du -h $file | cut -f1)\r\n\techo $file $size_before \" -> \" $size_after\r\n    fi\r\ndone\r\n\r\n$ bash slim.sh \r\n./rev00000.dat 20M  ->  19M\r\n./rev00001.dat 33M  ->  17M\r\n./rev00002.dat 27M  ->  16M\r\n./rev00003.dat 16M  ->  16M\r\n...\r\n./rev00443.dat 108M  ->  19M\r\n./rev00444.dat 114M  ->  19M\r\n./rev00445.dat 52M  ->  19M\r\n./rev00446.dat 77M  ->  19M\r\n./rev00447.dat 54M  ->  19M\r\n./rev00448.dat 62M  ->  19M\r\n./rev00449.dat 79M  ->  17M\r\n./rev00450.dat 21M  ->  6.0M\r\n\r\n$ du -h\r\n 91M\t./index\r\n 64G\t.\r\n```",
      "created_at" : "2020-01-02T06:12:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570125891",
      "id" : 570125891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDEyNTg5MQ==",
      "updated_at" : "2020-01-02T06:12:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570125891",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I kinda need to retract what I said before. Today I woke up to a bitcoin core message \"Error: Disk space is too low!\". This was at 91.20% of IBD. I checked the drive and About this Mac, Storage says only 80MB is left on the 500GB dedicated partition. Du and df commands and disk utility report the whole partition space used. Finder also reports whole disk space used when checking the whole drive but when checking the bitcoin folder only it says it takes only 273GB (there is really nothing else on this partition). Upon investigating further, I can see that Get Info option on a folder returns:\r\n`273Â 165Â 546Â 724 bytes (499,43 GB on disk) for 5Â 369 items`\r\nsimilarly, all rev files in the blocks folder are visible in Finder as around 19MB files but when using Get info option the true size is revealed, e.g.\r\n`19Â 922Â 944 bytes (199,3 MB on disk)`\r\nSame goes for ncdu, it reports true size of files on the disk and it seems that a lot of rev files actually take much more space than they should (e.g. 200MB).\r\n\r\nI checked the debug.log and noticed that the rev files that are the biggest have the most Pre-allocating up to position, messages, and the smallest ones have the least:\r\n\r\n- rev01037, 350.2 MiB, pre-allocating goes up to 0x1a00000\r\n- rev01767, 8.6MiB, pre-allocating goes up to 0x500000 only\r\n\r\nFYI, the Time Machine is disabled for this drive, later I disabled it completely, restarted the machine, this did not free up any space.\r\n\r\nI guess that some dev needs to investigate closer how this pre-allocating mechanism behaves on APFS drives. Perhaps it reserves more space than it needs and later on it does not release it properly?",
      "created_at" : "2020-01-02T12:19:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570192261",
      "id" : 570192261,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDE5MjI2MQ==",
      "updated_at" : "2020-01-02T12:19:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570192261",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/22457855?v=4",
         "events_url" : "https://api.github.com/users/streamofstars/events{/privacy}",
         "followers_url" : "https://api.github.com/users/streamofstars/followers",
         "following_url" : "https://api.github.com/users/streamofstars/following{/other_user}",
         "gists_url" : "https://api.github.com/users/streamofstars/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/streamofstars",
         "id" : 22457855,
         "login" : "streamofstars",
         "node_id" : "MDQ6VXNlcjIyNDU3ODU1",
         "organizations_url" : "https://api.github.com/users/streamofstars/orgs",
         "received_events_url" : "https://api.github.com/users/streamofstars/received_events",
         "repos_url" : "https://api.github.com/users/streamofstars/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/streamofstars/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/streamofstars/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/streamofstars"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> I kinda need to retract what I said before. Today I woke up to a bitcoin core message \"Error: Disk space is too low!\". This was at 91.20% of IBD. I checked the drive and About this Mac, Storage says only 80MB is left on the 500GB dedicated partition. Du and df commands and disk utility report the whole partition space used. Finder also reports whole disk space used when checking the whole drive but when checking the bitcoin folder only it says it takes only 273GB (there is really nothing else on this partition). Upon investigating further, I can see that Get Info option on a folder returns:\r\n> `273 165 546 724 bytes (499,43 GB on disk) for 5 369 items`\r\n> similarly, all rev files in the blocks folder are visible in Finder as around 19MB files but when using Get info option the true size is revealed, e.g.\r\n> `19 922 944 bytes (199,3 MB on disk)`\r\n> Same goes for ncdu, it reports true size of files on the disk and it seems that a lot of rev files actually take much more space than they should (e.g. 200MB).\r\n> \r\n> I checked the debug.log and noticed that the rev files that are the biggest have the most Pre-allocating up to position, messages, and the smallest ones have the least:\r\n> \r\n>     * rev01037, 350.2 MiB, pre-allocating goes up to 0x1a00000\r\n> \r\n>     * rev01767, 8.6MiB, pre-allocating goes up to 0x500000 only\r\n> \r\n> \r\n> FYI, the Time Machine is disabled for this drive, later I disabled it completely, restarted the machine, this did not free up any space.\r\n> \r\n> I guess that some dev needs to investigate closer how this pre-allocating mechanism behaves on APFS drives. Perhaps it reserves more space than it needs and later on it does not release it properly?\r\n\r\nThanks for letting me know. Then I won't spend time on testing with an external drive right now, but I'll be prepared to do it later if needed.",
      "created_at" : "2020-01-02T12:47:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570197791",
      "id" : 570197791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDE5Nzc5MQ==",
      "updated_at" : "2020-01-02T12:47:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570197791",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "To further pinpoint the problem I created two disk images using Disk Utility, one with Mac OS Extended (Journaled) and the other with APFS. I then symlinked the volumes to the default data directory:\r\n```\r\nln -s /Volumes/MacOSExtended /Users/erik/Library/Application Support/Bitcoin\r\n```\r\nAfter that I started bitcoind to download the first five blocks and stopped. Then I symlinked the other:\r\n```\r\nrm /Users/erik/Library/Application Support/Bitcoin\r\nln -s /Volumes/APFS /Users/erik/Library/Application Support/Bitcoin\r\n```\r\nand ran bitcoind again to sync the first five blocks.\r\n\r\nThe problem only seems to exist on APFS:\r\n```\r\n$ cd /Volumes/APFS/blocks/\r\nblocks erik$ du -ch *.dat\r\n128M\tblk00000.dat\r\n128M\tblk00001.dat\r\n128M\tblk00002.dat\r\n128M\tblk00003.dat\r\n128M\tblk00004.dat\r\n 19M\trev00000.dat\r\n 34M\trev00001.dat\r\n 31M\trev00002.dat\r\n 32M\trev00003.dat\r\n 49M\trev00004.dat\r\n805M\ttotal\r\nblocks erik$ ls -lh *.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:25 blk00000.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:26 blk00001.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:27 blk00002.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:28 blk00003.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:30 blk00004.dat\r\n-rw-------  1 erik  staff    19M  5 Tam 00:25 rev00000.dat\r\n-rw-------  1 erik  staff    17M  5 Tam 00:26 rev00001.dat\r\n-rw-------  1 erik  staff    16M  5 Tam 00:28 rev00002.dat\r\n-rw-------  1 erik  staff    16M  5 Tam 00:29 rev00003.dat\r\n-rw-------  1 erik  staff    17M  5 Tam 00:30 rev00004.dat\r\n```\r\n\r\nMac OS Extended (HFS+):\r\n```\r\n$ cd /Volumes/MacOSExtended/blocks/\r\nblocks erik$ du -ch *.dat\r\n128M\tblk00000.dat\r\n128M\tblk00001.dat\r\n128M\tblk00002.dat\r\n128M\tblk00003.dat\r\n128M\tblk00004.dat\r\n 19M\trev00000.dat\r\n 17M\trev00001.dat\r\n 16M\trev00002.dat\r\n 16M\trev00003.dat\r\n 17M\trev00004.dat\r\n724M\ttotal\r\nblocks erik$ ls -lh *.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:02 blk00000.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:03 blk00001.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:05 blk00002.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:06 blk00003.dat\r\n-rw-------  1 erik  staff   128M  5 Tam 00:07 blk00004.dat\r\n-rw-------  1 erik  staff    19M  5 Tam 00:02 rev00000.dat\r\n-rw-------  1 erik  staff    17M  5 Tam 00:04 rev00001.dat\r\n-rw-------  1 erik  staff    16M  5 Tam 00:05 rev00002.dat\r\n-rw-------  1 erik  staff    16M  5 Tam 00:06 rev00003.dat\r\n-rw-------  1 erik  staff    17M  5 Tam 00:07 rev00004.dat\r\n```\r\n\r\nThe diff:\r\n\r\n![image](https://user-images.githubusercontent.com/20860124/71772543-513e8980-2f55-11ea-8e27-8d3cd66a06d4.png)\r\n",
      "created_at" : "2020-01-04T22:51:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570826737",
      "id" : 570826737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDgyNjczNw==",
      "updated_at" : "2020-01-04T22:51:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570826737",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "What are the exact file sizes you're seeing for the rev*.dat files? Are they all multiples of some power of two? That could give a hint about where the problem is.",
      "created_at" : "2020-01-04T23:00:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570827233",
      "id" : 570827233,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDgyNzIzMw==",
      "updated_at" : "2020-01-04T23:00:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570827233",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "## Checking the file content\r\n\r\nThe file `rev00337.dat` has a reported size by `du` of 212MB before copying and 21MB after. However, the content of the files is exactly the same.\r\n\r\n```bash\r\ncd ~/Library/Application\\ Support/Bitcoin/blocks\r\n\r\ndu -ch ./rev00337.dat\r\n 212M\t./rev00337.dat\r\n 212M\ttotal\r\n\r\nhexdump -C rev00337.dat | tail -4\r\n0141a770  e0 92 b0 c3 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n0141a780  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n*\r\n01500000\r\n\r\ncp rev00337.dat ~/Desktop\r\n\r\ncd ~/Desktop\r\n\r\nhexdump -C rev00337.dat | tail -4\r\n0141a770  e0 92 b0 c3 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n0141a780  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n*\r\n01500000\r\n```\r\n\r\n## Checking that the files content is the same after copy\r\n\r\nI have modified the previously posted script to show the files hashes before and after copy.\r\n\r\n```bash\r\nfor file in ./rev*.dat\r\ndo\r\n    if [[ -f $file ]]; then\r\n\tsize_before=$(du -h $file | cut -f1)\r\n\thash_before=$(shasum -a 256 $file | cut -d\" \" -f1)\r\n        cp $file $file.tmp\r\n        rm $file\r\n\tmv $file.tmp $file\r\n\tsize_after=$(du -h $file | cut -f1)\r\n        hash_after=$(shasum -a 256 $file | cut -d\" \" -f1)\r\n\techo $file $size_before \" -> \" $size_after \" hash_before: \" $hash_before \"hash_after: \" $hash_after\r\n    fi\r\ndone\r\n```\r\n\r\nHere is a sample output:\r\n\r\n```\r\n./rev01590.dat 3.9M  ->  4.0M  hash_before:  9fa0f20cfc1d9593b873399130cfce323aa574473f3a6b7caa58a970e41dc45b hash_after:  9fa0f20cfc1d9593b873399130cfce323aa574473f3a6b7caa58a970e41dc45b\r\n./rev01591.dat 844K  ->  1.0M  hash_before:  ab8811a65806921492c63c85c3d05643a0a7cba9fb5b3a677cb16fabb1167918 hash_after:  ab8811a65806921492c63c85c3d05643a0a7cba9fb5b3a677cb16fabb1167918\r\n```\r\n\r\nAll the hashes are the same before and after copying the files.\r\n\r\n## Difference in file size reporting\r\n\r\nThe file size reported by `du` is different from the one reported by `ls` and `stat`.\r\n\r\n```bash\r\ncd ~/Library/Application\\ Support/Bitcoin/blocks\r\n\r\ndu -ch ./rev01668.dat\r\n 90M\t./rev01668.dat\r\n 90M\ttotal\r\n\r\nls -lah | grep rev01668.dat \r\n-rw-------     1 something  something    17M Jan  6 11:18 rev01668.dat\r\n\r\nstat -x rev01668.dat          \r\n  File: \"rev01668.dat\"\r\n  Size: 17825792     FileType: Regular File\r\n  Mode: (0600/-rw-------)         Uid: (  502/  something)  Gid: (   20/   something)\r\nDevice: 1,4   Inode: 65189970    Links: 1\r\nAccess: Mon Jan  6 11:53:20 2020\r\nModify: Mon Jan  6 11:18:58 2020\r\nChange: Mon Jan  6 11:18:58 2020\r\n```\r\n## Diagnosis\r\n\r\n`du` is reporting the size in used blocks,  `ls` the size of the files content.\r\n\r\n```bash\r\ndiskutil info / | grep \"Block Size\"\r\n   Device Block Size:         4096 Bytes\r\n   Allocation Block Size:     4096 Bytes\r\n\r\ncd ~/Library/Application\\ Support/Bitcoin/blocks\r\n\r\ndu -ch ./rev01668.dat\r\n 90M\t./rev01668.dat\r\n 90M\ttotal\r\n\r\nBLOCKSIZE=4096 du -c ./rev01668.dat\r\n22916\t./rev01668.dat\r\n22916\ttotal\r\n\r\nBLOCKSIZE=4096 ls -lahs | grep rev01668.dat\r\n 22916 -rw-------     1 something  something    17M Jan  6 11:18 rev01668.dat\r\n\r\ncp rev01668.dat ~/Desktop\r\n\r\ncd ~/Desktop\r\n\r\ndu -ch ./rev01668.dat\r\n 17M\t./rev01668.dat\r\n 17M\ttotal\r\n\r\nBLOCKSIZE=4096 du -c ./rev01668.dat\r\n4352\t./rev01668.dat\r\n4352\ttotal\r\n\r\nBLOCKSIZE=4096 ls -lahs | grep rev01668.dat\r\n  4352 -rw-------   1 something  something    17M Jan  6 12:08 rev01668.dat\r\n```\r\n\r\nIt can be seen that, after copying the file, the number of blocks used is reduced drastically and the file size is as expected.\r\n\r\n## Hypothesis and troubleshooting\r\n\r\n`ftruncate` function is not working as expected when used in an APFS formated volume.\r\n\r\nI have tried to reproduce the problem in an isolated environment wirhout any success. The files sizes were always correct.\r\n\r\n## Possible fix\r\n\r\nIf the function `AllocateFileRange` is modified to use the fallback method in macOS the file sizes are as expected and the problem dissapear.",
      "created_at" : "2020-01-06T12:34:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-571122494",
      "id" : 571122494,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTEyMjQ5NA==",
      "updated_at" : "2020-01-06T12:34:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571122494",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/54533?v=4",
         "events_url" : "https://api.github.com/users/IPGlider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/IPGlider/followers",
         "following_url" : "https://api.github.com/users/IPGlider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/IPGlider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/IPGlider",
         "id" : 54533,
         "login" : "IPGlider",
         "node_id" : "MDQ6VXNlcjU0NTMz",
         "organizations_url" : "https://api.github.com/users/IPGlider/orgs",
         "received_events_url" : "https://api.github.com/users/IPGlider/received_events",
         "repos_url" : "https://api.github.com/users/IPGlider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/IPGlider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/IPGlider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/IPGlider"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> ## Possible fix\r\n> \r\n> If the function `AllocateFileRange` is modified to use the fallback method in macOS the file sizes are as expected and the problem dissapear.\r\n\r\nI can confirm that I've tried this _fix_ and using the fallback works. I also lean towards something with the `ftruncate` being broken, but wouldn't you also see the same problem in the blk*.dat files then?",
      "created_at" : "2020-01-06T12:43:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-571124860",
      "id" : 571124860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTEyNDg2MA==",
      "updated_at" : "2020-01-06T12:43:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571124860",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> What are the exact file sizes you're seeing for the rev*.dat files? Are they all multiples of some power of two? That could give a hint about where the problem is.\r\n\r\nI cannot see any indication that they would be multiples of power of two, unless I'm missing something.",
      "created_at" : "2020-01-06T12:46:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-571125467",
      "id" : 571125467,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTEyNTQ2Nw==",
      "updated_at" : "2020-01-06T12:46:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571125467",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa \r\n> What are the exact file sizes you're seeing for the rev*.dat files? Are they all multiples of some power of two? That could give a hint about where the problem is.\r\n\r\nThis is not how it ends up, actually. Every pre-allocation will append \"expected size + 1 MB\" to the actual size for each allocation time. I.e.\r\n```\r\n(once)\r\na = 1024*1024\r\nb = a\r\n(for each increase)\r\na = a + 1024*1024; b = b+a; b/1024/1024\r\n```\r\nThis gives the sizes 6, 10, 15, 21, 28, 36, 45, 55, 66, 78, 91, 105, 120, 136, 153, 171, ... which exactly matches the sizes I see.",
      "created_at" : "2020-01-08T05:35:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-571898500",
      "id" : 571898500,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTg5ODUwMA==",
      "updated_at" : "2020-01-08T05:36:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571898500",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   }
]
