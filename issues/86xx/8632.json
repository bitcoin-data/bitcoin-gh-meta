{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "The prevector tests are really slow when run under wine. This needs to be fixed because it can cause failures during development if one adds new tests timeouts can be hit in travis. This PR adds 3 worker threads + one master to mitigate performance, and removes unnecessary full testing setup. This PR makes the test time go from 205 seconds to 3.7 seconds.\n\nI selected the magic number 4 because that is what I had read in the travis docs as a good number. I also switch from TestingSetup to BasicTestingSetup because TestingSetup spawns unused threads\n\nPrevector tests should be sped up by some other means too, but that doesn't preclude parallelization as done in this PR.\n# Benchmarks\n\nOn a 64-bit windows build off of master, I see:\nreal    3m24.907s\nuser    3m24.705s\nsys     0m0.038s\n\nAfter parallelization:\nreal    0m4.170s\nuser    0m4.492s\nsys     0m9.319s\n\nAfter parallelization+switch to BasicTestingSetup:\nreal    0m3.782s\nuser    0m3.972s\nsys     0m6.615s\n# Analysis\n\nI'm pretty surprised at the speedup; I did test before PR'ing that:\n1. The for loop iterates the correct number of times\n2. Replacing my macros with function-versions had same speedup\n3. Adding a pBOOST_CHECK(false); in the for loop causes a failure\n\nSo I feel pretty confident in the correctness that all checks are run and errors reported, but perhaps there is something I've missed. My theory is the speedup has to do with the wine runtime having high overhead with the main thread.\n\nTesting with a single worker thread doing all the checks gives:\n\nreal    0m4.682s\nuser    0m4.444s\nsys     0m0.037s\n\nWhich seems to confirm my theory (I've left the 4 threaded version because it's marginally faster).\n",
   "closed_at" : "2016-09-06T20:42:03Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
      "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
      "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/JeremyRubin",
      "id" : 886523,
      "login" : "JeremyRubin",
      "node_id" : "MDQ6VXNlcjg4NjUyMw==",
      "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
      "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
      "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/JeremyRubin"
   },
   "comments" : 9,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8632/comments",
   "created_at" : "2016-08-31T03:22:56Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8632/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/8632",
   "id" : 174175651,
   "labels" : [
      {
         "color" : "d4c5f9",
         "default" : false,
         "id" : 62963516,
         "name" : "Tests",
         "node_id" : "MDU6TGFiZWw2Mjk2MzUxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8632/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0ODMzODI3MTI=",
   "number" : 8632,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/8632.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8632",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/8632.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8632"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Speed up prevector tests by parallelization",
   "updated_at" : "2016-09-06T20:42:03Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8632",
   "user" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
      "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
      "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/JeremyRubin",
      "id" : 886523,
      "login" : "JeremyRubin",
      "node_id" : "MDQ6VXNlcjg4NjUyMw==",
      "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
      "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
      "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/JeremyRubin"
   }
}
