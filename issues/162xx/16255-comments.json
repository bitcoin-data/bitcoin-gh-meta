[
   {
      "author_association" : "MEMBER",
      "body" : "Will reopen after #16252",
      "created_at" : "2019-06-20T18:09:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-504127025",
      "id" : 504127025,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16255",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNDEyNzAyNQ==",
      "updated_at" : "2019-06-20T18:09:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/504127025",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-06-25T09:18:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-505361060",
      "id" : 505361060,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16255",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNTM2MTA2MA==",
      "updated_at" : "2019-06-25T09:18:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/505361060",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16255#discussion_r297114457"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16255"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/297114457"
         }
      },
      "author_association" : "MEMBER",
      "body" : "happy to see this code simplified, it has been a frequent source of errors in the past",
      "commit_id" : "fab04969fba2e846f8763a82e6bd8e66c8bb2328",
      "created_at" : "2019-06-25T10:20:43Z",
      "diff_hunk" : "@@ -702,23 +702,9 @@ fs::path GetDefaultDataDir()\n #endif\n }\n \n-static fs::path g_blocks_path_cache_net_specific;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#discussion_r297114457",
      "id" : 297114457,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5NzExNDQ1Nw==",
      "original_commit_id" : "fae43f618f9439454c7e0b888475d91dbd584fa6",
      "original_position" : 4,
      "path" : "src/util/system.cpp",
      "position" : 11,
      "pull_request_review_id" : 253908467,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16255",
      "updated_at" : "2019-06-27T16:27:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/297114457",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16273](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16273.html) (refactor: Remove unused includes by practicalswift)\n* [#15871](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15871.html) (Handle exception when creating default -datadir by promag)\n* [#15864](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15864.html) (Fix datadir handling by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-06-25T17:08:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-505536000",
      "id" : 505536000,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16255",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNTUzNjAwMA==",
      "updated_at" : "2019-06-27T17:19:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/505536000",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "A side-effect of caching was that this code was only run the first call to `GetDataDir`.  Right now, it will try to create the data directory every time:\r\n```c++\r\n    if (fs::create_directories(path)) {\r\n        // This is the first run, create wallets subdirectory too\r\n        fs::create_directories(path / \"wallets\");\r\n    }\r\n```\r\n(this not only results in system call spam, but also a change in behavior if, for some reason, the datadir disappears)\r\nA simple solution to avoid this would be to add a static bool flag for this.\r\n",
      "created_at" : "2019-06-27T11:09:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506302568",
      "id" : 506302568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16255",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNjMwMjU2OA==",
      "updated_at" : "2019-06-27T11:10:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/506302568",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> but also a change in behavior if, for some reason, the datadir disappears\r\n\r\nthat's good?\r\n\r\n@laanwj wouldn't it be better to just call `create_directories` as soon as possible, like it should belong to the startup? Currently is kind of hard to know when directories are actually created.",
      "created_at" : "2019-06-27T11:19:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506305329",
      "id" : 506305329,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16255",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNjMwNTMyOQ==",
      "updated_at" : "2019-06-27T11:19:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/506305329",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> that's good?\r\n\r\nThat definitely isn't good, if the datadir disappears while running you want the process to die as soon as possible and not mess with creating directories.\r\n\r\n> @laanwj wouldn't it be better to just call create_directories  as soon as possible, like it should belong to the startup? Currently is  kind of hard to know when directories are actually created.\r\n\r\nYes that would be better, however this is very hard to reason about, and review, with the complexity of our startup sequence. Maybe better to leave for a future PR, which is why I suggested the most straightforward solution.\r\n",
      "created_at" : "2019-06-27T11:51:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506314245",
      "id" : 506314245,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16255",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNjMxNDI0NQ==",
      "updated_at" : "2019-06-27T11:51:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/506314245",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It is indeed weird to write to disk in a method, whose name implies it is a simple getter.\r\n\r\nAdded a guard to the disk access for now, but this should be improved in the future. (See also \"Fix datadir handling\" #15864)",
      "created_at" : "2019-06-27T16:19:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506414868",
      "id" : 506414868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16255",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNjQxNDg2OA==",
      "updated_at" : "2019-06-27T16:19:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/506414868",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I  think this is not worth it, so giving up on this for now. Someone should move out the `fs::create_directories` first.",
      "created_at" : "2019-06-27T18:10:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506453257",
      "id" : 506453257,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16255",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNjQ1MzI1Nw==",
      "updated_at" : "2019-06-27T18:10:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/506453257",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
