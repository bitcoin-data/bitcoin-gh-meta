[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125691891"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125691891"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It'd probably call this `deallocWallets()`",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-07-05T16:22:10Z",
      "diff_hunk" : "@@ -252,10 +245,7 @@ void Shutdown()\n #endif\n     UnregisterAllValidationInterfaces();\n #ifdef ENABLE_WALLET\n-    for (CWalletRef pwallet : vpwallets) {\n-        delete pwallet;\n-    }\n-    vpwallets.clear();\n+    DeleteWallets();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125691891",
      "id" : 125691891,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 40,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 48106240,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125691891",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125692442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125692442"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What's the reasons for keeping this function (that now always returns `true`)?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-07-05T16:24:20Z",
      "diff_hunk" : "@@ -227,40 +227,12 @@ bool CDB::Recover(const std::string& filename, void *callbackDataIn, bool (*reco\n \n bool CDB::VerifyEnvironment(const std::string& walletFile, const fs::path& dataDir, std::string& errorStr)\n {\n-    LogPrintf(\"Using BerkeleyDB version %s\\n\", DbEnv::version(0, 0, 0));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125692442",
      "id" : 125692442,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 4,
      "path" : "src/wallet/db.cpp",
      "position" : null,
      "pull_request_review_id" : 48106856,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125692442",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125693083"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125693083"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I guess this belongs to `walletinit.h` now?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-07-05T16:26:54Z",
      "diff_hunk" : "@@ -35,6 +35,8 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/thread.hpp>\n \n+/** Protects the vpwallets vector */\n+CCriticalSection cs_wallets;\n std::vector<CWalletRef> vpwallets;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r125693083",
      "id" : 125693083,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 48107575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/125693083",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126115533"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126115533"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, `DeleteWallets()` is a bad name. `DeallocWallets()` is good, or perhaps `DetachWallets()`",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-07-07T10:18:57Z",
      "diff_hunk" : "@@ -252,10 +245,7 @@ void Shutdown()\n #endif\n     UnregisterAllValidationInterfaces();\n #ifdef ENABLE_WALLET\n-    for (CWalletRef pwallet : vpwallets) {\n-        delete pwallet;\n-    }\n-    vpwallets.clear();\n+    DeleteWallets();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126115533",
      "id" : 126115533,
      "in_reply_to_id" : 125691891,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 40,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 48569969,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126115533",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126116206"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126116206"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You're right. This (and `CWalletDB::VerifyEnvironment()`) are now entirely vestigial and are not called. Both can be removed.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-07-07T10:23:11Z",
      "diff_hunk" : "@@ -227,40 +227,12 @@ bool CDB::Recover(const std::string& filename, void *callbackDataIn, bool (*reco\n \n bool CDB::VerifyEnvironment(const std::string& walletFile, const fs::path& dataDir, std::string& errorStr)\n {\n-    LogPrintf(\"Using BerkeleyDB version %s\\n\", DbEnv::version(0, 0, 0));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126116206",
      "id" : 126116206,
      "in_reply_to_id" : 125692442,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 4,
      "path" : "src/wallet/db.cpp",
      "position" : null,
      "pull_request_review_id" : 48570764,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126116206",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126116939"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126116939"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why? `vpwallets` is accessed by functions in several of the wallet source files.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-07-07T10:28:10Z",
      "diff_hunk" : "@@ -35,6 +35,8 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/thread.hpp>\n \n+/** Protects the vpwallets vector */\n+CCriticalSection cs_wallets;\n std::vector<CWalletRef> vpwallets;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126116939",
      "id" : 126116939,
      "in_reply_to_id" : 125693083,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 48571644,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126116939",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "This overlaps significantly with #10762. Not sure how I should ask for review. Perhaps find out which one people think is the priority? Or I could split the `walletinit.cpp` commits into their own PR.",
      "created_at" : "2017-07-07T10:30:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313646695",
      "id" : 313646695,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T10:30:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313646695",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126117881"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126117881"
         }
      },
      "author_association" : "MEMBER",
      "body" : "On further thought, I think I prefer the names `attachwallet` and `detachwallet`. That gives a bit more distinction from the dump/import RPCs and makes a stronger implication that the new `.dat` file is being loaded and attached as a separate wallet.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-07-07T10:33:57Z",
      "diff_hunk" : "@@ -2432,6 +2434,133 @@ UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue listwallets(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 0)\n+        throw std::runtime_error(\n+            \"listwallets\\n\"\n+            \"Returns a list of currently loaded wallets.\\n\"\n+            \"For full information on the wallet, use \\\"getwalletinfo\\\"\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  \\\"walletname\\\": xxxxx,             (string) the wallet name\\n\"\n+            \"   ...\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"listwallets\", \"\")\n+            + HelpExampleRpc(\"listwallets\", \"\")\n+        );\n+\n+    LOCK2(cs_main, cs_wallets);\n+\n+    UniValue obj(UniValue::VARR);\n+\n+    for (CWalletRef pwallet : vpwallets) {\n+\n+        if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+            return NullUniValue;\n+        }\n+\n+        LOCK(pwallet->cs_wallet);\n+\n+        obj.push_back(pwallet->GetName());\n+    }\n+\n+    return obj;\n+}\n+\n+UniValue loadwallet(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126117881",
      "id" : 126117881,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 55,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 48572768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126117881",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "@jnewbery IMO this one should rebase on the other.",
      "created_at" : "2017-07-07T10:43:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313649091",
      "id" : 313649091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T10:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313649091",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "> IMO this one should rebase on the other.\r\n\r\nMakes logical sense. Downside is that the other is a more significant change, so may take longer to get merged.",
      "created_at" : "2017-07-07T10:46:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313649650",
      "id" : 313649650,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T10:46:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313649650",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "If this really depends on that work then there's no other way than waiting. The other downside is that the other commits will show up here too.",
      "created_at" : "2017-07-07T10:54:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313650941",
      "id" : 313650941,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T10:54:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313650941",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "I've changed the PR sequence, so this will now depend on #10767. If I get positive concept feedbac on #10767 I'll rebase this on top of it.\r\n\r\nFor now, I'm still just looking for concept feedback.",
      "created_at" : "2017-07-07T15:09:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-313709042",
      "id" : 313709042,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-07-07T15:09:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313709042",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1063656?v=3",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126312681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126312681"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I had the idea that `walletinit.h/.c` is kind of the multiwallet interface (wallet manager). The functions we have there (`DeleteWallets()`, `VerifyWallets()`, `ShutdownWallets();`, etc.) sounded for me after `vpwallets` belongs there... \r\n\r\nIMO, the multiwallet map should ideally not sit within the objects (`CWallet`) implementation.\r\n",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-07-09T18:58:20Z",
      "diff_hunk" : "@@ -35,6 +35,8 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/thread.hpp>\n \n+/** Protects the vpwallets vector */\n+CCriticalSection cs_wallets;\n std::vector<CWalletRef> vpwallets;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r126312681",
      "id" : 126312681,
      "in_reply_to_id" : 125693083,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 48784550,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126312681",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Rebased on #10767 . Reviewers, please review #10767 first.",
      "created_at" : "2017-08-28T21:21:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-325485732",
      "id" : 325485732,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-08-28T21:21:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325485732",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased now that #10767 is merged. Still a work in progress. PR text updated.",
      "created_at" : "2017-09-11T16:31:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-328584502",
      "id" : 328584502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-11T16:31:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/328584502",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Bad automatic merge of the testcase. Re-merged manually.",
      "created_at" : "2017-09-20T14:16:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-330865431",
      "id" : 330865431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-20T14:16:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/330865431",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Manual rebase fixed the test bug. Travis now passes.\r\n\r\nThis is ready for initial review.",
      "created_at" : "2017-09-20T16:51:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-330913386",
      "id" : 330913386,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-20T16:51:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/330913386",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140187095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140187095"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`{`.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-09-21T09:07:28Z",
      "diff_hunk" : "@@ -484,16 +484,19 @@ void BitcoinApplication::initializeResult(bool success)\n         window->setClientModel(clientModel);\n \n #ifdef ENABLE_WALLET\n-        // TODO: Expose secondary wallets\n-        if (!vpwallets.empty())\n         {\n-            walletModel = new WalletModel(platformStyle, vpwallets[0], optionsModel);\n-\n-            window->addWallet(BitcoinGUI::DEFAULT_WALLET, walletModel);\n-            window->setCurrentWallet(BitcoinGUI::DEFAULT_WALLET);\n-\n-            connect(walletModel, SIGNAL(coinsSent(CWallet*,SendCoinsRecipient,QByteArray)),\n-                             paymentServer, SLOT(fetchPaymentACK(CWallet*,const SendCoinsRecipient&,QByteArray)));\n+            // TODO: Expose secondary wallets\n+            LOCK(cs_wallets);\n+            if (!vpwallets.empty())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140187095",
      "id" : 140187095,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 16,
      "path" : "src/qt/bitcoin.cpp",
      "position" : null,
      "pull_request_review_id" : 64221162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140187095",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140187207"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140187207"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Missing spaces after `,`?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-09-21T09:08:01Z",
      "diff_hunk" : "@@ -484,16 +484,19 @@ void BitcoinApplication::initializeResult(bool success)\n         window->setClientModel(clientModel);\n \n #ifdef ENABLE_WALLET\n-        // TODO: Expose secondary wallets\n-        if (!vpwallets.empty())\n         {\n-            walletModel = new WalletModel(platformStyle, vpwallets[0], optionsModel);\n-\n-            window->addWallet(BitcoinGUI::DEFAULT_WALLET, walletModel);\n-            window->setCurrentWallet(BitcoinGUI::DEFAULT_WALLET);\n-\n-            connect(walletModel, SIGNAL(coinsSent(CWallet*,SendCoinsRecipient,QByteArray)),\n-                             paymentServer, SLOT(fetchPaymentACK(CWallet*,const SendCoinsRecipient&,QByteArray)));\n+            // TODO: Expose secondary wallets\n+            LOCK(cs_wallets);\n+            if (!vpwallets.empty())\n+            {\n+                walletModel = new WalletModel(platformStyle, vpwallets[0], optionsModel);\n+\n+                window->addWallet(BitcoinGUI::DEFAULT_WALLET, walletModel);\n+                window->setCurrentWallet(BitcoinGUI::DEFAULT_WALLET);\n+\n+                connect(walletModel, SIGNAL(coinsSent(CWallet*,SendCoinsRecipient,QByteArray)),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140187207",
      "id" : 140187207,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 23,
      "path" : "src/qt/bitcoin.cpp",
      "position" : null,
      "pull_request_review_id" : 64221162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140187207",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140194543"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140194543"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Throw an error if `-salvagewallet` and there are multiple wallets?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-09-21T09:39:58Z",
      "diff_hunk" : "@@ -185,51 +185,23 @@ bool VerifyWallets()\n \n     uiInterface.InitMessage(_(\"Verifying wallet(s)...\"));\n \n-    // Keep track of each wallet absolute path to detect duplicates.\n-    std::set<fs::path> wallet_paths;\n+    std::vector<std::string> wallet_files = gArgs.GetArgs(\"-wallet\");\n \n-    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n-        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet parameter must only specify a filename (not a path).\"), walletFile));\n-        }\n+    // -salvagewallet can only be used when loading a single wallet\n+    bool salvage_wallet = gArgs.GetBoolArg(\"-salvagewallet\", false) && wallet_files.size() <= 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140194543",
      "id" : 140194543,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 64221162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140194543",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140195791"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140195791"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why not just `LOCK(cs_wallets)` too?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-09-21T09:45:52Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n+    AssertLockHeld(cs_wallets);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140195791",
      "id" : 140195791,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 64221162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140195791",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review @promag!\r\n\r\nRegarding the locking: Yes, I've implemented this as a mutex for now, which as you point out would limit wallet RPCs to be single-threaded. I'd like to update this to be something a bit better before v0.16. Suggestions are either a shared mutex or (suggested by @theuni) a version of the decay pointers in #10738. The problem with using a shared mutex is that C++ doesn't have a standard library shared mutex until C++14 (std::shared_timed_mutex) so I'd either have to use boost::shared_mutex or roll my own.\r\n\r\n(apologies - I thought I'd already written a note in this PR explaining this, but I must have failed to hit send!)\r\n\r\nFor now, I think review of this PR with the mutex is helpful, and I'll change it around to use a shared_mutex later.",
      "created_at" : "2017-09-21T13:43:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-331160327",
      "id" : 331160327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-21T13:43:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/331160327",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140244534"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140244534"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Because I'd prefer to avoid recursive locking if possible.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-09-21T13:44:01Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n+    AssertLockHeld(cs_wallets);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140244534",
      "id" : 140244534,
      "in_reply_to_id" : 140195791,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 64288061,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140244534",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140244708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140244708"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sounds like a sensible change in behaviour. I think it's beyond the scope of this PR.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-09-21T13:44:33Z",
      "diff_hunk" : "@@ -185,51 +185,23 @@ bool VerifyWallets()\n \n     uiInterface.InitMessage(_(\"Verifying wallet(s)...\"));\n \n-    // Keep track of each wallet absolute path to detect duplicates.\n-    std::set<fs::path> wallet_paths;\n+    std::vector<std::string> wallet_files = gArgs.GetArgs(\"-wallet\");\n \n-    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n-        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet parameter must only specify a filename (not a path).\"), walletFile));\n-        }\n+    // -salvagewallet can only be used when loading a single wallet\n+    bool salvage_wallet = gArgs.GetBoolArg(\"-salvagewallet\", false) && wallet_files.size() <= 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140244708",
      "id" : 140244708,
      "in_reply_to_id" : 140194543,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 64288260,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140244708",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This seems to ignore the whole issue of long-term wallet references, and probably locks `cs_wallets` too long.",
      "created_at" : "2017-09-21T20:03:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-331265958",
      "id" : 331265958,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-21T20:03:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/331265958",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140364335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140364335"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just curious, why?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-09-21T21:30:33Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n+    AssertLockHeld(cs_wallets);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140364335",
      "id" : 140364335,
      "in_reply_to_id" : 140195791,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 64428676,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/140364335",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Adding 0.16.0 milestone, I think this should be merged after 0.15.1 to prevent extra rebasing in the wallet code when porting back to 0.15.1.",
      "created_at" : "2017-09-28T06:44:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-332742893",
      "id" : 332742893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-09-28T06:44:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/332742893",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142575733"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142575733"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Unneeded newline.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-10-04T03:45:27Z",
      "diff_hunk" : "@@ -2694,6 +2694,54 @@ UniValue openwallet(const JSONRPCRequest& request)\n \n }\n \n+UniValue closewallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"closewallet \\\"walletname\\\"\\n\"\n+            \"\\nCloses a wallet.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"walletname\\\"    (string, required) The wallet name\\n\"\n+            \"\\nExamples:\\n\"\n+            \"\\nResult:\\n\"\n+            \"true|false       (boolean) Whether the wallet was unloaded successfully.\\n\"\n+            + HelpExampleCli(\"closewallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"closewallet\", \"\\\"test.dat\\\"\")\n+        );\n+\n+    LOCK(cs_wallets);\n+\n+    std::string walletName = request.params[0].get_str();\n+\n+    bool unloaded = false;\n+\n+    for (std::vector<CWalletRef>::iterator wallet_iter = vpwallets.begin(); wallet_iter != vpwallets.end(); wallet_iter++) {\n+\n+        if (!EnsureWalletIsAvailable(*wallet_iter, request.fHelp)) {\n+            throw JSONRPCError(RPC_WALLET_ERROR, \"Error accessing wallets\");\n+        }\n+\n+        if ((*wallet_iter)->GetName() == walletName) {\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142575733",
      "id" : 142575733,
      "original_commit_id" : "e188d00eceb20ab20f091e2301386f84574bee6d",
      "original_position" : 32,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66954949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142575733",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142575805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142575805"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason for not just doing `for (auto wallet : vpwallets) {` here?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-10-04T03:46:25Z",
      "diff_hunk" : "@@ -2694,6 +2694,54 @@ UniValue openwallet(const JSONRPCRequest& request)\n \n }\n \n+UniValue closewallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"closewallet \\\"walletname\\\"\\n\"\n+            \"\\nCloses a wallet.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"walletname\\\"    (string, required) The wallet name\\n\"\n+            \"\\nExamples:\\n\"\n+            \"\\nResult:\\n\"\n+            \"true|false       (boolean) Whether the wallet was unloaded successfully.\\n\"\n+            + HelpExampleCli(\"closewallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"closewallet\", \"\\\"test.dat\\\"\")\n+        );\n+\n+    LOCK(cs_wallets);\n+\n+    std::string walletName = request.params[0].get_str();\n+\n+    bool unloaded = false;\n+\n+    for (std::vector<CWalletRef>::iterator wallet_iter = vpwallets.begin(); wallet_iter != vpwallets.end(); wallet_iter++) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142575805",
      "id" : 142575805,
      "original_commit_id" : "e188d00eceb20ab20f091e2301386f84574bee6d",
      "original_position" : 25,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66954949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142575805",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142576776"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142576776"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ugh, passwords on prompts leaves the password as plaintext in shell history etc. Can't really be fixed for HTTP-RPC I guess, but CLI could *probably* take a bool to mean \"prompt me for password\".",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-10-04T03:59:58Z",
      "diff_hunk" : "@@ -2658,35 +2658,53 @@ UniValue listwallets(const JSONRPCRequest& request)\n \n UniValue openwallet(const JSONRPCRequest& request)\n {\n-    if (request.fHelp || request.params.size() != 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"openwallet \\\"filename\\\"\\n\"\n+            \"openwallet \\\"filename\\\" (\\\"passphrase\\\")\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142576776",
      "id" : 142576776,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 8,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66954949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142576776",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142576837"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142576837"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Description is wrong.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-10-04T04:00:41Z",
      "diff_hunk" : "@@ -2658,35 +2658,53 @@ UniValue listwallets(const JSONRPCRequest& request)\n \n UniValue openwallet(const JSONRPCRequest& request)\n {\n-    if (request.fHelp || request.params.size() != 1)\n+    if (request.fHelp || request.params.size() > 2)\n         throw std::runtime_error(\n-            \"openwallet \\\"filename\\\"\\n\"\n+            \"openwallet \\\"filename\\\" (\\\"passphrase\\\")\\n\"\n             \"\\nOpens a wallet from a wallet.dat file.\\n\"\n+            \"\\nUse the passphrase argument to unlock an encrypted wallet while opening.\\n\"\n             \"\\nArguments:\\n\"\n             \"1. \\\"filename\\\"    (string, required) The wallet.dat file\\n\"\n+            \"2. \\\"passphrase\\\"    (string, optional) The wallet.dat file\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r142576837",
      "id" : 142576837,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 66954949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/142576837",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Needs rebase.\r\n\r\nThe `openwallet` should rescan?",
      "created_at" : "2017-10-11T14:31:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-335830369",
      "id" : 335830369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-10-11T14:31:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/335830369",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK.\r\n\r\nI was able to use `openwallet` and `closewallet`.\r\n\r\nI wonder how this interacts with #11383. E.g. I'm guessing the UI wouldn't pick up on this (not a big issue). I can try once both are rebased.\r\n\r\nIt would be nice if `bitcoin-cli -rpcwallet=X` would open `X` if it's not open yet, maybe close it when done (future PR). \r\n\r\n> Should there be a separate RPC for creating a new wallet or should that be done using openwallet? (my initial thoughts are that there should be a separate RPC)\r\n\r\nI would prefer it if `openwallet` fails for wallets that don't exist, rather than creating a new wallet. I understand it makes sense for `bitcoind -wallet` to create a new one, because that's what a new user would expect, but I don't think that's needed for `openwallet`.",
      "created_at" : "2017-11-20T15:56:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-345738713",
      "id" : 345738713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-11-20T15:56:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/345738713",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@Sjors this PR must be rebased with #11383 (probably when that gets merged).",
      "created_at" : "2017-11-20T16:29:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-345749571",
      "id" : 345749571,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-11-20T16:29:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/345749571",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154538661"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154538661"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, definitely. cs_wallets is locked *before* cs_main in global lock order, so putting it too many places is just asking for trouble, IMO.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-03T22:13:55Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ static const std::string WALLET_ENDPOINT_BASE = \"/wallet/\";\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n+    AssertLockHeld(cs_wallets);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154538661",
      "id" : 154538661,
      "in_reply_to_id" : 140195791,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 80715388,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154538661",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154538714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154538714"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Tend to agree with @jonasschnelli here, though I agree the barrier isn't exactly clear (yet). Ideally we'd move more towards clarifying the interface here - making CWallet less and less aware of all the things around it (including other wallets). @sipa thoughts here?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-03T22:15:50Z",
      "diff_hunk" : "@@ -35,6 +35,8 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/thread.hpp>\n \n+/** Protects the vpwallets vector */\n+CCriticalSection cs_wallets;\n std::vector<CWalletRef> vpwallets;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154538714",
      "id" : 154538714,
      "in_reply_to_id" : 125693083,
      "original_commit_id" : "72c37457cd71a78add957d7f0239ffa260359701",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 80715456,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154538714",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154992083"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154992083"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is redundant now, no?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-05T16:01:51Z",
      "diff_hunk" : "@@ -185,51 +185,22 @@ bool VerifyWallets()\n \n     uiInterface.InitMessage(_(\"Verifying wallet(s)...\"));\n \n-    // Keep track of each wallet absolute path to detect duplicates.\n-    std::set<fs::path> wallet_paths;\n+    std::vector<std::string> wallet_files = gArgs.GetArgs(\"-wallet\");\n \n-    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n-        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet parameter must only specify a filename (not a path).\"), walletFile));\n-        }\n+    // -salvagewallet can only be used when loading a single wallet\n+    bool salvage_wallet = gArgs.GetBoolArg(\"-salvagewallet\", false) && wallet_files.size() <= 1;\n \n-        if (SanitizeString(walletFile, SAFE_CHARS_FILENAME) != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. Invalid characters in -wallet filename.\"), walletFile));\n-        }\n+    // Keep track of each wallet absolute path to detect duplicates.\n+    std::set<fs::path> wallet_paths;\n \n+    for (const std::string& walletFile : wallet_files) {\n         fs::path wallet_path = fs::absolute(walletFile, GetDataDir());\n \n-        if (fs::exists(wallet_path) && (!fs::is_regular_file(wallet_path) || fs::is_symlink(wallet_path))) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet filename must be a regular file.\"), walletFile));\n-        }\n-\n         if (!wallet_paths.insert(wallet_path).second) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. Duplicate -wallet filename specified.\"), walletFile));\n-        }\n-\n-        std::string strError;\n-        if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError)) {\n-            return InitError(strError);\n-        }\n-\n-        if (gArgs.GetBoolArg(\"-salvagewallet\", false)) {\n-            // Recover readable keypairs:\n-            CWallet dummyWallet;\n-            std::string backup_filename;\n-            if (!CWalletDB::Recover(walletFile, (void *)&dummyWallet, CWalletDB::RecoverKeysOnlyFilter, backup_filename)) {\n-                return false;\n-            }\n+            return InitError(strprintf(_(\"Error loading wallet %s. Duplicate wallet filename specified.\"), walletFile));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154992083",
      "id" : 154992083,
      "original_commit_id" : "2e774d8912985055d4000a840a09bae080d16abe",
      "original_position" : 44,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 81236911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154992083",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154994462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154994462"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: I'd rather not make this a static CWallet member. wallet.cpp is already plenty big and the stuff that it does seems more external db-related stuff and less wallet-related stuff. Ideally it'd be nice to more clearly separate the DB stuff from the wallet logic itself by pulling things like the DB-related stuff out of CreateWalletFromFile.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-05T16:08:55Z",
      "diff_hunk" : "@@ -1080,6 +1080,9 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n     /** Mark a transaction as replaced by another transaction (e.g., BIP 125). */\n     bool MarkReplaced(const uint256& originalHash, const uint256& newHash);\n \n+    //! Verify wallet naming and perform salvage on the wallet if required\n+    static bool VerifyWallet(std::string walletFile, bool salvage_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r154994462",
      "id" : 154994462,
      "original_commit_id" : "2e774d8912985055d4000a840a09bae080d16abe",
      "original_position" : 5,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 81236911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/154994462",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158095147"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158095147"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r140194543\r\n\r\nIn commit \"Allow single wallet to be verified\"\r\n\r\nIt looks like WalletParameterInteraction is already throwing an error in this case. I think it would be better to drop the comment and wallet_files check here. If you'd prefer to keep the check, I think the comment should be something clearer like \"// parameter interaction code should have thrown an error if -salvagewallet was enabled with more than wallet file, so the wallet_files size check here should have no effect.\"",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-20T18:05:48Z",
      "diff_hunk" : "@@ -185,51 +185,23 @@ bool VerifyWallets()\n \n     uiInterface.InitMessage(_(\"Verifying wallet(s)...\"));\n \n-    // Keep track of each wallet absolute path to detect duplicates.\n-    std::set<fs::path> wallet_paths;\n+    std::vector<std::string> wallet_files = gArgs.GetArgs(\"-wallet\");\n \n-    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n-        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet parameter must only specify a filename (not a path).\"), walletFile));\n-        }\n+    // -salvagewallet can only be used when loading a single wallet\n+    bool salvage_wallet = gArgs.GetBoolArg(\"-salvagewallet\", false) && wallet_files.size() <= 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158095147",
      "id" : 158095147,
      "in_reply_to_id" : 140194543,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 84849103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158095147",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158097595"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158097595"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"call CDBEnv.shutdown() from FlushWallets\"\r\n\r\nMaybe could use dbw->GetName() instead of repeating wallet_test.dat here",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-20T18:17:22Z",
      "diff_hunk" : "@@ -184,7 +184,8 @@ void TestSendCoins()\n     BumpFee(transactionView, txid2, false /* expect disabled */, {} /* expected error */, false /* cancel */);\n     BumpFee(transactionView, txid2, true /* expect disabled */, \"already bumped\" /* expected error */, false /* cancel */);\n \n-    bitdb.Flush(true);\n+    bitdb.Flush(\"wallet_test.dat\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158097595",
      "id" : 158097595,
      "original_commit_id" : "1eddc3afc0037aea7b167ca857a6d1e522633bb6",
      "original_position" : 5,
      "path" : "src/qt/test/wallettests.cpp",
      "position" : null,
      "pull_request_review_id" : 84849103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158097595",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158098875"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158098875"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"call CDBEnv.shutdown() from FlushWallets\"\r\n\r\nCould change this line to: `mi = mapFileUseCount.find(strFile)`, and change the `while` to an `if` on the line below to skip unnecessary loop.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-20T18:22:33Z",
      "diff_hunk" : "@@ -571,21 +571,21 @@ void CDBEnv::Shutdown()\n     }\n }\n \n-void CDBEnv::Flush(bool fShutdown)\n+void CDBEnv::Flush(std::string strFile)\n {\n     int64_t nStart = GetTimeMillis();\n     // Flush log data to the actual data file on all files that are not in use\n-    LogPrint(BCLog::DB, \"CDBEnv::Flush: Flush(%s)%s\\n\", fShutdown ? \"true\" : \"false\", fDbEnvInit ? \"\" : \" database not started\");\n+    LogPrint(BCLog::DB, \"CDBEnv::Flush: Flush%s\\n\", fDbEnvInit ? \"\" : \" database not started\");\n     if (!fDbEnvInit)\n         return;\n     {\n         LOCK(cs_db);\n         std::map<std::string, int>::iterator mi = mapFileUseCount.begin();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158098875",
      "id" : 158098875,
      "original_commit_id" : "1eddc3afc0037aea7b167ca857a6d1e522633bb6",
      "original_position" : 15,
      "path" : "src/wallet/db.cpp",
      "position" : null,
      "pull_request_review_id" : 84849103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158098875",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158099203"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158099203"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"call CDBEnv.shutdown() from FlushWallets\"\r\n\r\nIs this line doing anything? Should add comment explaining",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-20T18:23:58Z",
      "diff_hunk" : "@@ -232,14 +232,14 @@ void StartWallets(CScheduler& scheduler) {\n \n void FlushWallets() {\n     for (CWalletRef pwallet : vpwallets) {\n-        pwallet->Flush(false);\n+        pwallet->Flush();\n     }\n }\n \n void StopWallets() {\n-    for (CWalletRef pwallet : vpwallets) {\n-        pwallet->Flush(true);\n-    }\n+    if (gArgs.GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET)) return;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158099203",
      "id" : 158099203,
      "original_commit_id" : "1eddc3afc0037aea7b167ca857a6d1e522633bb6",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 84849103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158099203",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158100339"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158100339"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"add CDBEnv::Shutdown() function\"\r\n\r\nI think this method should start with `if (!fDbEnvInit) return;` similar to the Flush method so shutdown code can be simple for callers (no need for -disablewallet check).",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-20T18:28:40Z",
      "diff_hunk" : "@@ -560,6 +560,16 @@ bool CDB::Rewrite(CWalletDBWrapper& dbw, const char* pszSkip)\n     }\n }\n \n+void CDBEnv::Shutdown()\n+{\n+    char** listp;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158100339",
      "id" : 158100339,
      "original_commit_id" : "3919301a5d59fa46f4492ab17bfc12d2b6dda5ff",
      "original_position" : 6,
      "path" : "src/wallet/db.cpp",
      "position" : null,
      "pull_request_review_id" : 84849103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158100339",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158100836"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158100836"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"add CDBEnv::Shutdown() function\"\r\n\r\nMaybe AssertLockHeld(cs_db)",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-20T18:31:02Z",
      "diff_hunk" : "@@ -560,6 +560,16 @@ bool CDB::Rewrite(CWalletDBWrapper& dbw, const char* pszSkip)\n     }\n }\n \n+void CDBEnv::Shutdown()\n+{\n+    char** listp;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158100836",
      "id" : 158100836,
      "original_commit_id" : "3919301a5d59fa46f4492ab17bfc12d2b6dda5ff",
      "original_position" : 6,
      "path" : "src/wallet/db.cpp",
      "position" : null,
      "pull_request_review_id" : 84849103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158100836",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158102853"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158102853"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It might be better to drop thee InitError calls here and let callers VerifyWallet callers invoke it. Otherwise calls to open wallets via RPC could trigger GUI message boxes and maybe hang.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2017-12-20T18:39:40Z",
      "diff_hunk" : "@@ -3756,32 +3756,35 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n-bool CWallet::VerifyWallet(std::string walletFile, bool salvage_wallet)\n+bool CWallet::VerifyWallet(std::string walletFile, bool salvage_wallet, std::string& strError)\n {\n     if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-        return InitError(strprintf(_(\"Error loading wallet %s. wallet parameter must only specify a filename (not a path).\"), walletFile));\n+        strError = strprintf(_(\"Error loading wallet %s. wallet parameter must only specify a filename (not a path).\"), walletFile);\n+        return InitError(strError);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r158102853",
      "id" : 158102853,
      "original_commit_id" : "b3f0973d92729abf5bf5105ef12b995cdb484bab",
      "original_position" : 10,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 84849103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158102853",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Needs rebase\r\n\r\n> Should there be a separate RPC for creating a new wallet or should that be done using openwallet? (my initial thoughts are that there should be a separate RPC)\r\n\r\nI suggest there should be a new RPC command to create new wallets. Aside from least surprise, there is more than one type of wallet that the user could want created.",
      "created_at" : "2017-12-30T09:03:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-354535414",
      "id" : 354535414,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2017-12-30T09:03:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/354535414",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/93665?v=4",
         "events_url" : "https://api.github.com/users/wtogami/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wtogami/followers",
         "following_url" : "https://api.github.com/users/wtogami/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wtogami/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wtogami",
         "id" : 93665,
         "login" : "wtogami",
         "organizations_url" : "https://api.github.com/users/wtogami/orgs",
         "received_events_url" : "https://api.github.com/users/wtogami/received_events",
         "repos_url" : "https://api.github.com/users/wtogami/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wtogami/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wtogami/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wtogami"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase and issues (@ryanofsky) addressed.",
      "created_at" : "2018-01-04T07:22:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-355215094",
      "id" : 355215094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-01-04T07:22:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355215094",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing the wallet that is in use by qt (the one at `vpwallets[0]` will result in a crash. So additional handling for Qt stuff is needed.",
      "created_at" : "2018-02-14T04:13:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-365491018",
      "id" : 365491018,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-02-14T04:14:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/365491018",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I plan to pick this up again in the next few days. it requires:\r\n\r\n- rebasing on top of all the recent wallet refactors\r\n- addressing the locking issues (potentially pulling in #11402)\r\n- considering how this interacts with multiwallet in the GUI #12610\r\n- potentially pulling out the Verify and Flush refactoring commits into their own PR (https://github.com/bitcoin/bitcoin/pull/10740#pullrequestreview-84849103)",
      "created_at" : "2018-04-10T20:15:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-380232134",
      "id" : 380232134,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-10T20:15:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/380232134",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> considering how this interacts with multiwallet in the GUI\r\n\r\nA good enough first step would be if the dropdowns update when wallets are loaded / unloaded through the console. Adding UI to load and unload wallets can be a followup PR.",
      "created_at" : "2018-04-11T10:40:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-380407710",
      "id" : 380407710,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-11T10:40:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/380407710",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This was discussed in the IRC meeting today: https://botbot.me/freenode/bitcoin-core-dev/2018-04-12/?msg=98919702&page=5\r\n\r\n```\r\n15:26 < wumpus> #topic dynamic wallet load/unload (promag)\r\n15:26 < Randolf> Ack.\r\n15:26 < promag> not sure what you guys think\r\n15:26 < instagibbs_> what's the controversy in this topic :)\r\n15:27 < jonasschnelli> #10740\r\n15:27 < sipa> it should happen, duh\r\n15:27 < gribble> https://github.com/bitcoin/bitcoin/issues/10740 | [WIP] [wallet] dynamic loading/unloading of wallets by jnewbery ÃÂ· Pull Request #10740 ÃÂ· bitcoin/bitcoin ÃÂ· GitHub\r\n15:27 < wumpus> seems like something we want to have at some point...\r\n15:27 < promag> but I think luke agrees that wallet management should be with shared pointers\r\n15:27 < sipa> how and when is another :)\r\n15:27 < luke-jr> indeed, using names just asks for chaos with runtime-changing wallets\r\n15:28 < promag> please read #11402 for some reasons to switch\r\n15:28 < gribble> https://github.com/bitcoin/bitcoin/issues/11402 | Use shared pointer for wallet instances by promag ÃÂ· Pull Request #11402 ÃÂ· bitcoin/bitcoin ÃÂ· GitHub\r\n15:28 < jonasschnelli> IMO 10740 can't create wallets, IMO first step would be to add a createwallet RPC call\r\n15:29 < jonasschnelli> the whole creation/configuration setup if flawed since multiwallet\r\n15:29 < jonasschnelli> stuff like -keypool should be per wallet\r\n15:29 < jnewbery> jonasschnelli: you think createwallet should go in *before* load/unload?\r\n15:29 < jonasschnelli> and persisted in the wallet file (as configuration section)\r\n15:29 < jonasschnelli> jnewbery: not sure,.. just thinking\r\n15:30 < jnewbery> seems reasonable to me\r\n15:30 < jonasschnelli> createwallet could also *not* load the wallet in the first step (not ideal, but maybe reduces complexity)\r\n15:30 < sipa> that seems strange... you could create a new wallet at run time but not use it?\r\n15:30 < jonasschnelli> sipa: createwallet could also directly load/use the wallet\r\n15:30 < jnewbery> I think createwallet would also load the new wallet, no?\r\n15:30 < promag> create implies loading\r\n15:30 < luke-jr> sipa: iow, 0 to 1 only.\r\n15:31 < sipa> jonasschnelli: well then you need to have loading functionality first!\r\n15:31 < sipa> and if you have it, why not expose it\r\n15:31 < jonasschnelli> sipa: yes. That's a point.\r\n15:31 < jnewbery> createwallet could also be done by bitcoin-wallet-tool\r\n15:32 < jnewbery> (#8745)\r\n15:32 < gribble> https://github.com/bitcoin/bitcoin/issues/8745 | [PoC] Add wallet inspection and modification tool \"bitcoin-wallet-tool\" by jonasschnelli ÃÂ· Pull Request #8745 ÃÂ· bitcoin/bitcoin ÃÂ· GitHub\r\n15:32 < jonasschnelli> Yes. Would be possible...\r\n15:32 < jonasschnelli> I just think the create-during-startup approach is not good\r\n15:33 < promag> also related #10973\r\n15:33 < jnewbery> jonasschnelli: I agree\r\n15:33 < gribble> https://github.com/bitcoin/bitcoin/issues/10973 | Refactor: separate wallet from node by ryanofsky ÃÂ· Pull Request #10973 ÃÂ· bitcoin/bitcoin ÃÂ· GitHub\r\n15:33 < sipa> jonasschnelli: agree\r\n15:33 < jonasschnelli> And as a first step I though createwallet would make sense.. but not loading it seems after a strange use-case\r\n15:33 < luke-jr> load -> create -> unload\r\n15:33 < jonasschnelli> but a nice first code/impl. step\r\n15:33 < luke-jr> unload is the complex part tbh\r\n15:33 < jnewbery> luke-jr: agree\r\n15:34 < jonasschnelli> Agree with luke-jr. Maybe split unload away from the existing PR jnewbery ?\r\n15:34 < jnewbery> yes\r\n15:34 < jnewbery> I intend to pick up 10740 again soon, rebase and rework it\r\n15:34 < promag> consider the use case: 1) rpc rescan wallet 2) in parallel unload wallet - should 2) wait for 1) ?\r\n15:34 < luke-jr> probably\r\n15:35 < jonasschnelli> Great. Dynamic loading/creating is a nice feature that we probably want for 0.17!\r\n15:35 < promag> luke-jr: and if the unload is from the UI?\r\n15:35 < jnewbery> promag: do you consider 11402 a prereq for load/unload? What about just load?\r\n15:36 < jonasschnelli> the wallet-tool is IMO orthogonal to wallet creation\r\n15:36 < jonasschnelli> *via RPC\r\n15:36 < luke-jr> promag: probably the same\r\n15:36 < promag> jnewbery: IMHO for both\r\n15:36 < jonasschnelli> RPC seems to be a must, wallet-tool can be a better place to create some sorts of wallets (or inspect it), .. like encrypted wallets\r\n15:36 < luke-jr> promag: at least initially\r\n15:37 < jnewbery> promag: want to rebase and put on high priority for review then, if you consider it a blocker?\r\n15:37 < promag> luke-jr: my point is that it should not block, you request the unload and go on, when the wallet is not used anymore it gets unloaded\r\n15:38 < jonasschnelli> #11402\r\n15:38 < gribble> https://github.com/bitcoin/bitcoin/issues/11402 | Use shared pointer for wallet instances by promag ÃÂ· Pull Request #11402 ÃÂ· bitcoin/bitcoin ÃÂ· GitHub\r\n15:38 < luke-jr> promag: you mean leave the wallet loaded, but invisible? that seems worst outcome IMO\r\n15:38 < luke-jr> user may unload and just shut off the PC\r\n15:38 < wumpus> the unload should probably be in two stages: after requesting it, RPC and the GUI lose access to it. Then it waits for current operations tofinish. Then the thing really gets delted.\r\n15:38 < luke-jr> yes\r\n15:38 < promag> luke-jr: then the application will wait for wallets to unload\r\n15:38 < jnewbery> I don't think we need to worry about unload at this stage. First step is add load functionality, then createwallet functionality\r\n15:38 < luke-jr> and make it visible to the user in the meantime\r\n15:39 < luke-jr> jnewbery: +1\r\n15:39 < promag> wumpus: right, hence shared pointers\r\n```\r\n\r\nI should reduce the scope of this PR to just a `loadwallet` RPC. A `createwallet` RPC should come next, followed by `unloadwallet`. (`unloadwallet` is where most of the difficulties are).",
      "created_at" : "2018-04-12T21:28:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-380950109",
      "id" : 380950109,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-12T21:28:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/380950109",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated PR text since this PR is now only for loading wallets (not creating or unloading).\r\n\r\nOriginal text also had the following motivation:\r\n\r\n> Main motivation for this was the fact that several wallet parameters are actions for individual wallet load/creation, rather than properties of the wallet component. Examples are `-salvagewallet`, `-rescan`, `-usehd` and `-upgradewallet`. Continuing with that config/loading model is difficult in a multi-wallet world - how can users run those actions on individual wallets when loading multiple wallets? This PR offers a solution: individual wallets can be loaded at run-time, and RPC parameters can be passed in to carry out the various wallet-loading actions. Note that none of those load actions are yet implemented in this PR, but can easily be added.",
      "created_at" : "2018-04-18T21:03:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-382528523",
      "id" : 382528523,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-18T21:03:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/382528523",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Overhauled this PR to just contain the `loadwallet` functionality.\r\n\r\nIt is built on @promag's PR #13017. Please review that first.\r\n\r\nThis also needs the `cs_wallets` locking functionality from #11402 to be thread-safe.\r\n\r\nI'll rebase once those PRs are merged. I've pushed the branch now in case anyone wants to do early review.",
      "created_at" : "2018-04-18T21:06:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-382529488",
      "id" : 382529488,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-18T21:06:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/382529488",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery Nice. BTW I was thinking creating a different PR to just make #13017 thread safe.",
      "created_at" : "2018-04-18T21:11:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-382530777",
      "id" : 382530777,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-18T21:11:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/382530777",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I was thinking creating a different PR to just make #13017 thread safe.\r\n\r\nGreat. I'll keep an eye out and rebase on top of that when it's ready.",
      "created_at" : "2018-04-18T21:13:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-382531192",
      "id" : 382531192,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-18T21:13:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/382531192",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182604444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182604444"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should call `CWallet::postInitProcess` instead? Otherwise `MaybeCompactWalletDB` is not called if the daemon is launched without wallets.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-19T00:12:49Z",
      "diff_hunk" : "@@ -2874,6 +2874,49 @@ UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"<walletname>     (string) The wallet name if loaded successfully.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->ReacceptWalletTransactions();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182604444",
      "id" : 182604444,
      "original_commit_id" : "d667f8b82ee3741f7e0e3e51611ed373a5d4af8c",
      "original_position" : 37,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 113433263,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182604444",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review @promag - I've done as you suggested and called `CWallet::postInitProcess()`. Because rpc doesn't have the CScheduler reference when loading the wallet, I had to change the `WalletInit::Start()` function to always schedule background wallet flushes, even when started with no wallets (ie `-nowallet`). Note that when started with `-disablewallet`, the entire wallet module is disabled and it's not possible to load wallets later.\r\n\r\nI've also rebased on [#13028 rebased on master].\r\n\r\nRemoved the **[WIP]** tag since I think this implementation is now complete and ready for review.",
      "created_at" : "2018-04-19T21:54:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-382892700",
      "id" : 382892700,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-19T21:54:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/382892700",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182922926"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182922926"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Remove.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-20T00:56:42Z",
      "diff_hunk" : "@@ -747,6 +745,7 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n     const CBlockIndex* m_last_block_processed = nullptr;\n \n public:\n+    static std::atomic<bool> fFlushScheduled;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182922926",
      "id" : 182922926,
      "original_commit_id" : "1faccae15d9a0f9992b7cd8c8c5ebc844ed007d2",
      "original_position" : 20,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 113822637,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182922926",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182923067"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182923067"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Move `CWallet::postInitProcess()` content here:\r\n```cpp\r\nfor (CWallet* pwallet : GetWallets()) {\r\n    // Add wallet transactions that aren't already in a block to mempool\r\n    // Do this here as mempool requires genesis block to be loaded\r\n    pwallet->ReacceptWalletTransactions();\r\n}\r\n..\r\n```",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-20T00:58:03Z",
      "diff_hunk" : "@@ -324,7 +325,12 @@ bool WalletInit::Open() const\n void WalletInit::Start(CScheduler& scheduler) const\n {\n     for (CWallet* pwallet : GetWallets()) {\n-        pwallet->postInitProcess(scheduler);\n+        pwallet->postInitProcess();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182923067",
      "id" : 182923067,
      "original_commit_id" : "1faccae15d9a0f9992b7cd8c8c5ebc844ed007d2",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : 85,
      "pull_request_review_id" : 113822637,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182923067",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182923700"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182923700"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`WalletInitInterface::Start()` is called only once, remove this check (and fFlushScheduled)?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-20T01:03:35Z",
      "diff_hunk" : "@@ -324,7 +325,12 @@ bool WalletInit::Open() const\n void WalletInit::Start(CScheduler& scheduler) const\n {\n     for (CWallet* pwallet : GetWallets()) {\n-        pwallet->postInitProcess(scheduler);\n+        pwallet->postInitProcess();\n+    }\n+\n+    // Run a thread to flush wallet periodically\n+    if (!CWallet::fFlushScheduled.exchange(true)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182923700",
      "id" : 182923700,
      "original_commit_id" : "1faccae15d9a0f9992b7cd8c8c5ebc844ed007d2",
      "original_position" : 17,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 113822637,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182923700",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182923904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182923904"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Post-init doesn't matter now that wallets are dynamically loaded. Remove?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-20T01:05:43Z",
      "diff_hunk" : "@@ -1103,7 +1102,7 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n      * Wallet post-init setup\n      * Gives the wallet a chance to register repetitive tasks and complete post-init tasks\n      */\n-    void postInitProcess(CScheduler& scheduler);\n+    void postInitProcess();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r182923904",
      "id" : 182923904,
      "original_commit_id" : "1faccae15d9a0f9992b7cd8c8c5ebc844ed007d2",
      "original_position" : 29,
      "path" : "src/wallet/wallet.h",
      "position" : 31,
      "pull_request_review_id" : 113822637,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182923904",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I had to change the WalletInit::Start() function to always schedule background wallet flushes\r\n\r\nMuch better out of CWallet IMO.\r\n\r\n",
      "created_at" : "2018-04-20T01:09:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-382931195",
      "id" : 382931195,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-20T01:09:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/382931195",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183085610"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183085610"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes - much better. Thanks!",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-20T15:22:42Z",
      "diff_hunk" : "@@ -324,7 +325,12 @@ bool WalletInit::Open() const\n void WalletInit::Start(CScheduler& scheduler) const\n {\n     for (CWallet* pwallet : GetWallets()) {\n-        pwallet->postInitProcess(scheduler);\n+        pwallet->postInitProcess();\n+    }\n+\n+    // Run a thread to flush wallet periodically\n+    if (!CWallet::fFlushScheduled.exchange(true)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183085610",
      "id" : 183085610,
      "in_reply_to_id" : 182923700,
      "original_commit_id" : "1faccae15d9a0f9992b7cd8c8c5ebc844ed007d2",
      "original_position" : 17,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 114021261,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183085610",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183085676"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183085676"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-20T15:22:57Z",
      "diff_hunk" : "@@ -747,6 +745,7 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n     const CBlockIndex* m_last_block_processed = nullptr;\n \n public:\n+    static std::atomic<bool> fFlushScheduled;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183085676",
      "id" : 183085676,
      "in_reply_to_id" : 182922926,
      "original_commit_id" : "1faccae15d9a0f9992b7cd8c8c5ebc844ed007d2",
      "original_position" : 20,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 114021357,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183085676",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183086176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183086176"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm going to leave this function here for now. It seems reasonable to have a `postInitProcess()` step for loading wallets, even if it is only doing one thing.\r\n\r\nThis makes the diff smaller, and we can always remove `postInitProcess()` later if it really is unnecessary.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-20T15:24:28Z",
      "diff_hunk" : "@@ -1103,7 +1102,7 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n      * Wallet post-init setup\n      * Gives the wallet a chance to register repetitive tasks and complete post-init tasks\n      */\n-    void postInitProcess(CScheduler& scheduler);\n+    void postInitProcess();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183086176",
      "id" : 183086176,
      "in_reply_to_id" : 182923904,
      "original_commit_id" : "1faccae15d9a0f9992b7cd8c8c5ebc844ed007d2",
      "original_position" : 29,
      "path" : "src/wallet/wallet.h",
      "position" : 31,
      "pull_request_review_id" : 114021964,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183086176",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase again.",
      "created_at" : "2018-04-23T11:51:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-383548182",
      "id" : 383548182,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-23T11:51:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383548182",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased on #13028",
      "created_at" : "2018-04-23T16:44:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-383643125",
      "id" : 383643125,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-23T16:44:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383643125",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183742636"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183742636"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Lock `cs_wallets`?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T14:04:31Z",
      "diff_hunk" : "@@ -3968,6 +3969,64 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183742636",
      "id" : 183742636,
      "original_commit_id" : "422e3f9e24e83aaf79669770e79c7a9cc4c4f184",
      "original_position" : 12,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114797875,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183742636",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183742697"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183742697"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, `const std::string& wallet_file`.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T14:04:42Z",
      "diff_hunk" : "@@ -3968,6 +3969,64 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183742697",
      "id" : 183742697,
      "in_reply_to_id" : 183742636,
      "original_commit_id" : "422e3f9e24e83aaf79669770e79c7a9cc4c4f184",
      "original_position" : 12,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114797875,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183742697",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183743262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183743262"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not `obj`ect :trollface: \r\n\r\nAnyway, could return object instead?\r\n```json\r\n{\r\n    \"name\": ...\r\n}\r\n```",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T14:06:15Z",
      "diff_hunk" : "@@ -2874,6 +2874,49 @@ UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"<walletname>     (string) The wallet name if loaded successfully.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VSTR);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183743262",
      "id" : 183743262,
      "original_commit_id" : "a5af75ca6887c078a7c783452918b9120e993b1f",
      "original_position" : 39,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114797875,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183743262",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183743613"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183743613"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, empty line.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T14:07:06Z",
      "diff_hunk" : "@@ -2874,6 +2874,49 @@ UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"<walletname>     (string) The wallet name if loaded successfully.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VSTR);\n+    obj = wallet_file;\n+\n+    return obj;\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183743613",
      "id" : 183743613,
      "original_commit_id" : "a5af75ca6887c078a7c783452918b9120e993b1f",
      "original_position" : 43,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114797875,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183743613",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183746763"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183746763"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Use `wallet_names[0]` instead of `'w1'`?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T14:15:30Z",
      "diff_hunk" : "@@ -150,5 +150,24 @@ def run_test(self):\n         assert_equal(batch[0][\"result\"][\"chain\"], \"regtest\")\n         assert_equal(batch[1][\"result\"][\"walletname\"], \"w1\")\n \n+        # dynamic wallet loading\n+        self.restart_node(0, ['-nowallet'])\n+        for wallet_name in wallet_names:\n+            self.nodes[0].loadwallet(wallet_name)\n+\n+        assert_equal(set(self.nodes[0].listwallets()), set(wallet_names))\n+\n+        # Fail to load if wallet doesn't exist\n+        assert_raises_rpc_error(-18, 'Wallet wallets not found.', self.nodes[0].loadwallet, 'wallets')\n+\n+        # Fail to load duplicate wallets\n+        assert_raises_rpc_error(-4, 'Wallet file verification failed: Error loading wallet w1. Duplicate -wallet filename specified.', self.nodes[0].loadwallet, 'w1')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183746763",
      "id" : 183746763,
      "original_commit_id" : "db5d3f9c9906771f36a4d5459f82861ba4fa6718",
      "original_position" : 15,
      "path" : "test/functional/wallet_multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 114797875,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183746763",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183830411"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183830411"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Updated comment as suggested by @ryanofsky .",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T18:11:30Z",
      "diff_hunk" : "@@ -185,51 +185,23 @@ bool VerifyWallets()\n \n     uiInterface.InitMessage(_(\"Verifying wallet(s)...\"));\n \n-    // Keep track of each wallet absolute path to detect duplicates.\n-    std::set<fs::path> wallet_paths;\n+    std::vector<std::string> wallet_files = gArgs.GetArgs(\"-wallet\");\n \n-    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n-        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet parameter must only specify a filename (not a path).\"), walletFile));\n-        }\n+    // -salvagewallet can only be used when loading a single wallet\n+    bool salvage_wallet = gArgs.GetBoolArg(\"-salvagewallet\", false) && wallet_files.size() <= 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183830411",
      "id" : 183830411,
      "in_reply_to_id" : 140194543,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 114904382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183830411",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183834805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183834805"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Lock cs_wallets?\r\n\r\nDone. How does this interact with your WalletManager work? Was the idea that cs_wallets was only held by WalletManager?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T18:25:35Z",
      "diff_hunk" : "@@ -3968,6 +3969,64 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183834805",
      "id" : 183834805,
      "in_reply_to_id" : 183742636,
      "original_commit_id" : "422e3f9e24e83aaf79669770e79c7a9cc4c4f184",
      "original_position" : 12,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114904382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183834805",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183834852"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183834852"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> nit, const std::string& wallet_file.\r\n\r\nThanks - fixed",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T18:25:45Z",
      "diff_hunk" : "@@ -3968,6 +3969,64 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183834852",
      "id" : 183834852,
      "in_reply_to_id" : 183742636,
      "original_commit_id" : "422e3f9e24e83aaf79669770e79c7a9cc4c4f184",
      "original_position" : 12,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114909876,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183834852",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183839856"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183839856"
         }
      },
      "author_association" : "MEMBER",
      "body" : "yep - changed to return an object",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T18:41:49Z",
      "diff_hunk" : "@@ -2874,6 +2874,49 @@ UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"<walletname>     (string) The wallet name if loaded successfully.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VSTR);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183839856",
      "id" : 183839856,
      "in_reply_to_id" : 183743262,
      "original_commit_id" : "a5af75ca6887c078a7c783452918b9120e993b1f",
      "original_position" : 39,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114915889,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183839856",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183839887"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183839887"
         }
      },
      "author_association" : "MEMBER",
      "body" : "removed",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T18:41:53Z",
      "diff_hunk" : "@@ -2874,6 +2874,49 @@ UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"<walletname>     (string) The wallet name if loaded successfully.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VSTR);\n+    obj = wallet_file;\n+\n+    return obj;\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183839887",
      "id" : 183839887,
      "in_reply_to_id" : 183743613,
      "original_commit_id" : "a5af75ca6887c078a7c783452918b9120e993b1f",
      "original_position" : 43,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114915919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183839887",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183839915"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183839915"
         }
      },
      "author_association" : "MEMBER",
      "body" : "yes, better. Changed",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T18:41:59Z",
      "diff_hunk" : "@@ -150,5 +150,24 @@ def run_test(self):\n         assert_equal(batch[0][\"result\"][\"chain\"], \"regtest\")\n         assert_equal(batch[1][\"result\"][\"walletname\"], \"w1\")\n \n+        # dynamic wallet loading\n+        self.restart_node(0, ['-nowallet'])\n+        for wallet_name in wallet_names:\n+            self.nodes[0].loadwallet(wallet_name)\n+\n+        assert_equal(set(self.nodes[0].listwallets()), set(wallet_names))\n+\n+        # Fail to load if wallet doesn't exist\n+        assert_raises_rpc_error(-18, 'Wallet wallets not found.', self.nodes[0].loadwallet, 'wallets')\n+\n+        # Fail to load duplicate wallets\n+        assert_raises_rpc_error(-4, 'Wallet file verification failed: Error loading wallet w1. Duplicate -wallet filename specified.', self.nodes[0].loadwallet, 'w1')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183839915",
      "id" : 183839915,
      "in_reply_to_id" : 183746763,
      "original_commit_id" : "db5d3f9c9906771f36a4d5459f82861ba4fa6718",
      "original_position" : 15,
      "path" : "test/functional/wallet_multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 114915947,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183839915",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased on master and addressed @promag's comments.",
      "created_at" : "2018-04-24T18:42:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-384038119",
      "id" : 384038119,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-24T18:42:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384038119",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183847002"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183847002"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I was thinking moving `CWallet::Verify` to `WalletManager` or calling part of it from `WalletManager`. Let's worry about that later.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-24T19:07:04Z",
      "diff_hunk" : "@@ -3968,6 +3969,64 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183847002",
      "id" : 183847002,
      "in_reply_to_id" : 183742636,
      "original_commit_id" : "422e3f9e24e83aaf79669770e79c7a9cc4c4f184",
      "original_position" : 12,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 114924692,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183847002",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r184025625"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184025625"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If I add a line here to inspect the wallet after the load:\r\n```\r\nself.nodes[0].getwalletinfo()\r\n``` \r\nOR\r\n```\r\nself.nodes[0].getbalance()\r\n```\r\nI get the [json exception throw here](https://github.com/bitcoin/bitcoin/blob/master/src/wallet/rpcwallet.cpp#L78-L79) after the second load operation. Is this expected behavior?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-25T11:31:59Z",
      "diff_hunk" : "@@ -170,5 +170,24 @@ def run_test(self):\n         assert_equal(w1.getwalletinfo()['paytxfee'], 0)\n         assert_equal(w2.getwalletinfo()['paytxfee'], 4.0)\n \n+        # dynamic wallet loading\n+        self.restart_node(0, ['-nowallet'])\n+        for wallet_name in wallet_names:\n+            self.nodes[0].loadwallet(wallet_name)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r184025625",
      "id" : 184025625,
      "original_commit_id" : "0569d2cd1324304ba2d78d1299454126c9d82b51",
      "original_position" : 7,
      "path" : "test/functional/wallet_multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 115135585,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184025625",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14220652?v=4",
         "events_url" : "https://api.github.com/users/conscott/events{/privacy}",
         "followers_url" : "https://api.github.com/users/conscott/followers",
         "following_url" : "https://api.github.com/users/conscott/following{/other_user}",
         "gists_url" : "https://api.github.com/users/conscott/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/conscott",
         "id" : 14220652,
         "login" : "conscott",
         "organizations_url" : "https://api.github.com/users/conscott/orgs",
         "received_events_url" : "https://api.github.com/users/conscott/received_events",
         "repos_url" : "https://api.github.com/users/conscott/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/conscott/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/conscott/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/conscott"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r184199696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184199696"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes - if there are multiple wallets loaded, you need to send the RPC request to the correct wallet endpoint. Look at `TestNode`'s `get_wallet_rpc()` method.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-25T20:43:56Z",
      "diff_hunk" : "@@ -170,5 +170,24 @@ def run_test(self):\n         assert_equal(w1.getwalletinfo()['paytxfee'], 0)\n         assert_equal(w2.getwalletinfo()['paytxfee'], 4.0)\n \n+        # dynamic wallet loading\n+        self.restart_node(0, ['-nowallet'])\n+        for wallet_name in wallet_names:\n+            self.nodes[0].loadwallet(wallet_name)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r184199696",
      "id" : 184199696,
      "in_reply_to_id" : 184025625,
      "original_commit_id" : "0569d2cd1324304ba2d78d1299454126c9d82b51",
      "original_position" : 7,
      "path" : "test/functional/wallet_multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 115347075,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184199696",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r184601227"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184601227"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Got it, thank you. \r\n\r\nAs a nit, It might be useful just to verify you can call `getbalance` on the loaded wallet, just to show loaded wallets have expected behavior. ",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-27T06:18:52Z",
      "diff_hunk" : "@@ -170,5 +170,24 @@ def run_test(self):\n         assert_equal(w1.getwalletinfo()['paytxfee'], 0)\n         assert_equal(w2.getwalletinfo()['paytxfee'], 4.0)\n \n+        # dynamic wallet loading\n+        self.restart_node(0, ['-nowallet'])\n+        for wallet_name in wallet_names:\n+            self.nodes[0].loadwallet(wallet_name)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r184601227",
      "id" : 184601227,
      "in_reply_to_id" : 184025625,
      "original_commit_id" : "0569d2cd1324304ba2d78d1299454126c9d82b51",
      "original_position" : 7,
      "path" : "test/functional/wallet_multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 115830455,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184601227",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14220652?v=4",
         "events_url" : "https://api.github.com/users/conscott/events{/privacy}",
         "followers_url" : "https://api.github.com/users/conscott/followers",
         "following_url" : "https://api.github.com/users/conscott/following{/other_user}",
         "gists_url" : "https://api.github.com/users/conscott/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/conscott",
         "id" : 14220652,
         "login" : "conscott",
         "organizations_url" : "https://api.github.com/users/conscott/orgs",
         "received_events_url" : "https://api.github.com/users/conscott/received_events",
         "repos_url" : "https://api.github.com/users/conscott/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/conscott/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/conscott/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/conscott"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Test ACK 0569d2cd1324304ba2d78d1299454126c9d82b51 - just left a small test nit",
      "created_at" : "2018-04-27T06:20:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-384875747",
      "id" : 384875747,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-27T06:20:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384875747",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14220652?v=4",
         "events_url" : "https://api.github.com/users/conscott/events{/privacy}",
         "followers_url" : "https://api.github.com/users/conscott/followers",
         "following_url" : "https://api.github.com/users/conscott/following{/other_user}",
         "gists_url" : "https://api.github.com/users/conscott/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/conscott",
         "id" : 14220652,
         "login" : "conscott",
         "organizations_url" : "https://api.github.com/users/conscott/orgs",
         "received_events_url" : "https://api.github.com/users/conscott/received_events",
         "repos_url" : "https://api.github.com/users/conscott/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/conscott/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/conscott/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/conscott"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@conscott thanks for the review, mind review #13028 too (this is rebased on that one)?",
      "created_at" : "2018-04-27T09:10:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-384913084",
      "id" : 384913084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-27T09:10:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384913084",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r184689221"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184689221"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, good idea. I'll update the test",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-27T13:38:38Z",
      "diff_hunk" : "@@ -170,5 +170,24 @@ def run_test(self):\n         assert_equal(w1.getwalletinfo()['paytxfee'], 0)\n         assert_equal(w2.getwalletinfo()['paytxfee'], 4.0)\n \n+        # dynamic wallet loading\n+        self.restart_node(0, ['-nowallet'])\n+        for wallet_name in wallet_names:\n+            self.nodes[0].loadwallet(wallet_name)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r184689221",
      "id" : 184689221,
      "in_reply_to_id" : 184025625,
      "original_commit_id" : "0569d2cd1324304ba2d78d1299454126c9d82b51",
      "original_position" : 7,
      "path" : "test/functional/wallet_multiwallet.py",
      "position" : null,
      "pull_request_review_id" : 115939774,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184689221",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated test following @conscott's suggestion and rebased on master to get #13028",
      "created_at" : "2018-04-30T15:59:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-385443897",
      "id" : 385443897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-04-30T15:59:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385443897",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185138063"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185138063"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> The wallet file/directory must be located in the `walletdir` directory in order to be loaded.\r\n\r\nIt works with external wallets (absolute path not related to `-walletdir`).",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-04-30T23:28:34Z",
      "diff_hunk" : "@@ -0,0 +1,6 @@\n+Dynamic loading of wallets\n+--------------------------\n+\n+Previously, wallets could only be loaded at startup, by specifying `-wallet` parameters on the command line or in the bitcoin.conf file. It is now possible to load wallets dynamically at runtime by calling the `loadwallet` RPC. The wallet file/directory must be located in the `walletdir` directory in order to be loaded.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185138063",
      "id" : 185138063,
      "original_commit_id" : "5423e5899aa3b9ccbe8acf8052d48a12fd47bc36",
      "original_position" : 4,
      "path" : "doc/release-notes-pr10740.md",
      "position" : null,
      "pull_request_review_id" : 116469916,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185138063",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Consider:\r\n```\r\nmkdir /tmp/ws\r\nbitcoind -regtest -walletdir=/tmp/ws -wallet=w1 -wallet=w2\r\nbitcoin-cli -regtest listwallets\r\n[\r\n  \"w1\",\r\n  \"w2\"\r\n]\r\n```\r\nThen:\r\n```\r\nbitcoind -regtest -walletdir=/tmp/ws -wallet=w1\r\nbitcoin-cli -regtest loadwallet /tmp/ws/w2\r\nbitcoin-cli -regtest listwallets\r\n[\r\n  \"w1\",\r\n  \"/tmp/ws/w2\"\r\n]\r\n```\r\nAlso\r\n```\r\nbitcoind -regtest -walletdir=/tmp/ws -wallet=w1 -wallet=/tmp/ws/w2\r\nbitcoin-cli -regtest listwallets\r\n[\r\n  \"w1\",\r\n  \"/tmp/ws/w2\"\r\n]\r\n```\r\nIs this fine or should the outputs be the same?\r\nShould it be possible to specify an absolute path if it's in the `walletdir`?",
      "created_at" : "2018-05-02T15:07:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-386010918",
      "id" : 386010918,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-02T15:07:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386010918",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Is this fine or should the outputs be the same?\r\n> Should it be possible to specify an absolute path if it's in the walletdir?\r\n\r\nI think that question is orthogonal to this PR. As you've noted, this is pre-existing behaviour and is exhibited when specifying wallet names on the command line or .conf file. This behaviour was specified in the PR that introduced external wallet files (here: https://github.com/bitcoin/bitcoin/pull/11687#discussion_r158150913).\r\n\r\nCan we save discussion on whether that's the best behaviour for outside this PR?",
      "created_at" : "2018-05-02T22:12:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-386137840",
      "id" : 386137840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-02T22:12:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386137840",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185655153"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185655153"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks promag. Release notes update. Please let me know what you think.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-02T22:16:28Z",
      "diff_hunk" : "@@ -0,0 +1,6 @@\n+Dynamic loading of wallets\n+--------------------------\n+\n+Previously, wallets could only be loaded at startup, by specifying `-wallet` parameters on the command line or in the bitcoin.conf file. It is now possible to load wallets dynamically at runtime by calling the `loadwallet` RPC. The wallet file/directory must be located in the `walletdir` directory in order to be loaded.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185655153",
      "id" : 185655153,
      "in_reply_to_id" : 185138063,
      "original_commit_id" : "5423e5899aa3b9ccbe8acf8052d48a12fd47bc36",
      "original_position" : 4,
      "path" : "doc/release-notes-pr10740.md",
      "position" : null,
      "pull_request_review_id" : 117088981,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185655153",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Release notes LGTM.\r\n\r\nTested ACK a395059 (previously tested 2d67656).\r\n\r\n> Can we save discussion on whether that's the best behaviour for outside this PR?\r\n\r\nAbsolutely!",
      "created_at" : "2018-05-02T22:21:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-386139557",
      "id" : 386139557,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-02T22:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386139557",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Tested Re-ACK a395059d4f576cc1b3b61ef78f2e01dec7758d3f",
      "created_at" : "2018-05-03T09:11:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-386234669",
      "id" : 386234669,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-03T09:11:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386234669",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14220652?v=4",
         "events_url" : "https://api.github.com/users/conscott/events{/privacy}",
         "followers_url" : "https://api.github.com/users/conscott/followers",
         "following_url" : "https://api.github.com/users/conscott/following{/other_user}",
         "gists_url" : "https://api.github.com/users/conscott/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/conscott",
         "id" : 14220652,
         "login" : "conscott",
         "organizations_url" : "https://api.github.com/users/conscott/orgs",
         "received_events_url" : "https://api.github.com/users/conscott/received_events",
         "repos_url" : "https://api.github.com/users/conscott/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/conscott/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/conscott/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/conscott"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag , @conscott - thanks for the review!\r\n\r\nThis could really do with some review from people with longer term wallet experience - nagging @TheBlueMatt @jonasschnelli @luke-jr @laanwj :slightly_smiling_face: ",
      "created_at" : "2018-05-03T15:09:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-386329222",
      "id" : 386329222,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-03T15:09:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386329222",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK a395059d4f576cc1b3b61ef78f2e01dec7758d3f",
      "created_at" : "2018-05-03T19:14:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-386405871",
      "id" : 386405871,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-03T19:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386405871",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185952402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185952402"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ops, this is not done.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-03T22:21:58Z",
      "diff_hunk" : "@@ -2874,6 +2874,49 @@ UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"<walletname>     (string) The wallet name if loaded successfully.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VSTR);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185952402",
      "id" : 185952402,
      "in_reply_to_id" : 183743262,
      "original_commit_id" : "a5af75ca6887c078a7c783452918b9120e993b1f",
      "original_position" : 39,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 117450009,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185952402",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185952429"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185952429"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not removed.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-03T22:22:05Z",
      "diff_hunk" : "@@ -2874,6 +2874,49 @@ UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"<walletname>     (string) The wallet name if loaded successfully.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VSTR);\n+    obj = wallet_file;\n+\n+    return obj;\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185952429",
      "id" : 185952429,
      "in_reply_to_id" : 183743613,
      "original_commit_id" : "a5af75ca6887c078a7c783452918b9120e993b1f",
      "original_position" : 43,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 117450009,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185952429",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185952460"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185952460"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Remove 2nd empty line.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-03T22:22:14Z",
      "diff_hunk" : "@@ -2997,6 +2997,49 @@ UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"<walletname>     (string) The wallet name if loaded successfully.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VSTR);\n+    obj = wallet_file;\n+\n+    return obj;\n+\n+}\n+\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r185952460",
      "id" : 185952460,
      "original_commit_id" : "a395059d4f576cc1b3b61ef78f2e01dec7758d3f",
      "original_position" : 46,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 117450009,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/185952460",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Oops. Thanks @promag . I accidentally dropped those changes in one of my force-pushes. They should be fixed now.\r\n\r\nThanks for keeping me honest!",
      "created_at" : "2018-05-04T14:35:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-386621225",
      "id" : 386621225,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-04T14:35:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386621225",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased",
      "created_at" : "2018-05-04T21:51:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-386744525",
      "id" : 386744525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-04T21:51:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386744525",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186414871"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186414871"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, `wallet->GetName()` instead.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T12:58:24Z",
      "diff_hunk" : "@@ -2994,6 +2994,49 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VOBJ);\n+    obj.pushKV(\"name\", wallet_file);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186414871",
      "id" : 186414871,
      "original_commit_id" : "122d0f0157d39b818dc0939e2f8d7e6c66b522fa",
      "original_position" : 42,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 117986540,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186414871",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186427650"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186427650"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, good idea. Updated.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T13:48:09Z",
      "diff_hunk" : "@@ -2994,6 +2994,49 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");\n+    }\n+    AddWallet(wallet);\n+\n+    wallet->postInitProcess();\n+\n+    UniValue obj(UniValue::VOBJ);\n+    obj.pushKV(\"name\", wallet_file);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186427650",
      "id" : 186427650,
      "in_reply_to_id" : 186414871,
      "original_commit_id" : "122d0f0157d39b818dc0939e2f8d7e6c66b522fa",
      "original_position" : 42,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118002220,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186427650",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186462595"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186462595"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This needs some kind of lock to avoid double-loading a wallet in two rpc threads at once.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T15:42:16Z",
      "diff_hunk" : "@@ -2994,6 +2994,49 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186462595",
      "id" : 186462595,
      "original_commit_id" : "56c8bd4e61bbf5b12122b528fe01b55439868db8",
      "original_position" : 29,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 81236911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186462595",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186463553"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186463553"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe some help messages noting that certain config options still apply here - eg if you started with something like zapwallettxes, upgradewallet, rescan, etc it will take the same action for newly-loaded wallets here.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T15:45:40Z",
      "diff_hunk" : "@@ -2994,6 +2994,49 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186463553",
      "id" : 186463553,
      "original_commit_id" : "56c8bd4e61bbf5b12122b528fe01b55439868db8",
      "original_position" : 9,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 81236911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186463553",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Should probably fix the various memory leaks in CreateWalletFromFile first - we didnt really use to care cause it would just persist through operation, now we do.\r\n\r\n@TheBlueMatt #13063 fixes that.",
      "created_at" : "2018-05-07T15:59:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-387113002",
      "id" : 387113002,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-07T15:59:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387113002",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186468686"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186468686"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@TheBlueMatt btw my suggestion is to move (some) static code to a `WalletManager` (#13034).",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T16:04:04Z",
      "diff_hunk" : "@@ -1080,6 +1080,9 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n     /** Mark a transaction as replaced by another transaction (e.g., BIP 125). */\n     bool MarkReplaced(const uint256& originalHash, const uint256& newHash);\n \n+    //! Verify wallet naming and perform salvage on the wallet if required\n+    static bool VerifyWallet(std::string walletFile, bool salvage_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186468686",
      "id" : 186468686,
      "in_reply_to_id" : 154994462,
      "original_commit_id" : "2e774d8912985055d4000a840a09bae080d16abe",
      "original_position" : 5,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 118052165,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186468686",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "#13063 seems overkill for this issue, we could just use a unique_ptr within CreateWalletFromFile.\n\nOn May 7, 2018 3:59:40 PM UTC, \"JoÃÂ£o Barbosa\" <notifications@github.com> wrote:\n>> Should probably fix the various memory leaks in CreateWalletFromFile\n>first - we didnt really use to care cause it would just persist through\n>operation, now we do.\n>\n>@TheBlueMatt #13063 fixes that.\n>\n>-- \n>You are receiving this because you were mentioned.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-387113002\n",
      "created_at" : "2018-05-07T16:04:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-387114534",
      "id" : 387114534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-07T16:04:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387114534",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186469973"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186469973"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hmm @jnewbery this is missing https://github.com/bitcoin/bitcoin/pull/10740#discussion_r183742636.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T16:08:48Z",
      "diff_hunk" : "@@ -2994,6 +2994,49 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186469973",
      "id" : 186469973,
      "in_reply_to_id" : 186462595,
      "original_commit_id" : "56c8bd4e61bbf5b12122b528fe01b55439868db8",
      "original_position" : 29,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118053764,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186469973",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@TheBlueMatt Then you mean #12647. Either way it's something that can be fixed in another PR.",
      "created_at" : "2018-05-07T16:16:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-387118590",
      "id" : 387118590,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-07T16:16:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387118590",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@promag it can be fixed in another PR, but that would have to be merged before this one. Its really no big deal on master, but with an RPC that allows you to create arbitrary memory leaks, that's not great...",
      "created_at" : "2018-05-07T16:43:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-387126459",
      "id" : 387126459,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-07T16:43:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387126459",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186553415"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186553415"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I agree with @promag that a WalletManager class is a good place for this in the long run.\r\n\r\nSince this is a nit only, can we save it for a future PR.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T21:14:02Z",
      "diff_hunk" : "@@ -1080,6 +1080,9 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n     /** Mark a transaction as replaced by another transaction (e.g., BIP 125). */\n     bool MarkReplaced(const uint256& originalHash, const uint256& newHash);\n \n+    //! Verify wallet naming and perform salvage on the wallet if required\n+    static bool VerifyWallet(std::string walletFile, bool salvage_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186553415",
      "id" : 186553415,
      "in_reply_to_id" : 154994462,
      "original_commit_id" : "2e774d8912985055d4000a840a09bae080d16abe",
      "original_position" : 5,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 118155159,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186553415",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186553473"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186553473"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Re-added. Thanks @promag ",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T21:14:15Z",
      "diff_hunk" : "@@ -2994,6 +2994,49 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186553473",
      "id" : 186553473,
      "in_reply_to_id" : 186462595,
      "original_commit_id" : "56c8bd4e61bbf5b12122b528fe01b55439868db8",
      "original_position" : 29,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118155233,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186553473",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Should probably fix the various memory leaks in CreateWalletFromFile first - we didnt really use to care cause it would just persist through operation, now we do.\r\n\r\nI've added the minimal fix from here: https://github.com/bitcoin/bitcoin/pull/12647#discussion_r174875670 to address the memory lead. @promag - that conflicts with your shared pointer PR, but it should be trivial for you to rebase that.",
      "created_at" : "2018-05-07T21:15:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-387209103",
      "id" : 387209103,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-07T21:15:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387209103",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186555304"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186555304"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-07T21:21:18Z",
      "diff_hunk" : "@@ -2994,6 +2994,49 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r186555304",
      "id" : 186555304,
      "in_reply_to_id" : 186463553,
      "original_commit_id" : "56c8bd4e61bbf5b12122b528fe01b55439868db8",
      "original_position" : 9,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118157523,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186555304",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187052740"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187052740"
         }
      },
      "author_association" : "MEMBER",
      "body" : "\"creation failed\" is a confusing error message to give to the user here, \"Wallet loading failed\" would be more straightforward",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T14:10:09Z",
      "diff_hunk" : "@@ -2994,6 +2994,51 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\"\n+            \"\\nNote that all wallet command-line options used when starting bitcoind will be\"\n+            \"\\napplied to the new wallet (eg -zapwallettxes, upgradewallet, rescan, etc).\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187052740",
      "id" : 187052740,
      "original_commit_id" : "fc45f748cab92100820e698f2b026b643a3de96e",
      "original_position" : 37,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118753755,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187052740",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187053695"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187053695"
         }
      },
      "author_association" : "MEMBER",
      "body" : "As these errors are reported over RPC, we should stop translating them; RPC errors should not depend on the locale.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T14:12:58Z",
      "diff_hunk" : "@@ -3951,6 +3951,56 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet, std::string& error_string, std::string& warning_string)\n+{\n+    // Do some checking on wallet path. It should be either a:\n+    //\n+    // 1. Path where a directory can be created.\n+    // 2. Path to an existing directory.\n+    // 3. Path to a symlink to a directory.\n+    // 4. For backwards compatibility, the name of a data file in -walletdir.\n+    LOCK(cs_wallets);\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    fs::file_type path_type = fs::symlink_status(wallet_path).type();\n+    if (!(path_type == fs::file_not_found || path_type == fs::directory_file ||\n+          (path_type == fs::symlink_file && fs::is_directory(wallet_path)) ||\n+          (path_type == fs::regular_file && fs::path(wallet_file).filename() == wallet_file))) {\n+        error_string = strprintf(",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187053695",
      "id" : 187053695,
      "original_commit_id" : "fc45f748cab92100820e698f2b026b643a3de96e",
      "original_position" : 31,
      "path" : "src/wallet/wallet.cpp",
      "position" : 31,
      "pull_request_review_id" : 118753755,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187053695",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187054298"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187054298"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The name `wallet_deleter` scares me.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T14:14:46Z",
      "diff_hunk" : "@@ -3973,7 +4023,8 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n \n     int64_t nStart = GetTimeMillis();\n     bool fFirstRun = true;\n-    CWallet *walletInstance = new CWallet(name, WalletDatabase::Create(path));\n+    auto wallet_deleter = MakeUnique<CWallet>(name, WalletDatabase::Create(path));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187054298",
      "id" : 187054298,
      "original_commit_id" : "fc45f748cab92100820e698f2b026b643a3de96e",
      "original_position" : 75,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118753755,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187054298",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187065047"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187065047"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree. Changed",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T14:45:23Z",
      "diff_hunk" : "@@ -2994,6 +2994,51 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\"\n+            \"\\nNote that all wallet command-line options used when starting bitcoind will be\"\n+            \"\\napplied to the new wallet (eg -zapwallettxes, upgradewallet, rescan, etc).\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;\n+    if (!CWallet::Verify(wallet_file, false, error, dummy_warning)) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet file verification failed: \" + error);\n+    }\n+\n+    CWallet * const wallet = CWallet::CreateWalletFromFile(wallet_file, fs::absolute(wallet_file, GetWalletDir()));\n+    if (!wallet) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet creation failed.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187065047",
      "id" : 187065047,
      "in_reply_to_id" : 187052740,
      "original_commit_id" : "fc45f748cab92100820e698f2b026b643a3de96e",
      "original_position" : 37,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118769032,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187065047",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187067398"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187067398"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes - removed translation.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T14:52:16Z",
      "diff_hunk" : "@@ -3951,6 +3951,56 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet, std::string& error_string, std::string& warning_string)\n+{\n+    // Do some checking on wallet path. It should be either a:\n+    //\n+    // 1. Path where a directory can be created.\n+    // 2. Path to an existing directory.\n+    // 3. Path to a symlink to a directory.\n+    // 4. For backwards compatibility, the name of a data file in -walletdir.\n+    LOCK(cs_wallets);\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    fs::file_type path_type = fs::symlink_status(wallet_path).type();\n+    if (!(path_type == fs::file_not_found || path_type == fs::directory_file ||\n+          (path_type == fs::symlink_file && fs::is_directory(wallet_path)) ||\n+          (path_type == fs::regular_file && fs::path(wallet_file).filename() == wallet_file))) {\n+        error_string = strprintf(",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187067398",
      "id" : 187067398,
      "in_reply_to_id" : 187053695,
      "original_commit_id" : "fc45f748cab92100820e698f2b026b643a3de96e",
      "original_position" : 31,
      "path" : "src/wallet/wallet.cpp",
      "position" : 31,
      "pull_request_review_id" : 118772042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187067398",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187068600"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187068600"
         }
      },
      "author_association" : "MEMBER",
      "body" : "is `temp_wallet` (with a comment above) less scary?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T14:55:52Z",
      "diff_hunk" : "@@ -3973,7 +4023,8 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n \n     int64_t nStart = GetTimeMillis();\n     bool fFirstRun = true;\n-    CWallet *walletInstance = new CWallet(name, WalletDatabase::Create(path));\n+    auto wallet_deleter = MakeUnique<CWallet>(name, WalletDatabase::Create(path));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187068600",
      "id" : 187068600,
      "in_reply_to_id" : 187054298,
      "original_commit_id" : "fc45f748cab92100820e698f2b026b643a3de96e",
      "original_position" : 75,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118773590,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187068600",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187116621"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187116621"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, certainly. What I'd prefer, ideally, is to just call this wallet_instance and use this smart pointer everywhere instead of `CWallet* walletInstance = temp_wallet.get()`.\r\nBut this is fine, it's no longer scary.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T17:31:07Z",
      "diff_hunk" : "@@ -3973,7 +4023,8 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n \n     int64_t nStart = GetTimeMillis();\n     bool fFirstRun = true;\n-    CWallet *walletInstance = new CWallet(name, WalletDatabase::Create(path));\n+    auto wallet_deleter = MakeUnique<CWallet>(name, WalletDatabase::Create(path));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187116621",
      "id" : 187116621,
      "in_reply_to_id" : 187054298,
      "original_commit_id" : "fc45f748cab92100820e698f2b026b643a3de96e",
      "original_position" : 75,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118832238,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187116621",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "utACK 5ef858bfed2438746db0ba096ff3c98755603cb8",
      "created_at" : "2018-05-09T17:32:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-387815580",
      "id" : 387815580,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-09T17:32:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/387815580",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187147046"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187147046"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ok, I'll change it if I need to update the branch for another reason.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T19:16:19Z",
      "diff_hunk" : "@@ -3973,7 +4023,8 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n \n     int64_t nStart = GetTimeMillis();\n     bool fFirstRun = true;\n-    CWallet *walletInstance = new CWallet(name, WalletDatabase::Create(path));\n+    auto wallet_deleter = MakeUnique<CWallet>(name, WalletDatabase::Create(path));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187147046",
      "id" : 187147046,
      "in_reply_to_id" : 187054298,
      "original_commit_id" : "fc45f748cab92100820e698f2b026b643a3de96e",
      "original_position" : 75,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118868904,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187147046",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187176626"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187176626"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "commit: [wallet] Add CWallet::Verify function\r\n\r\nUsing a set here is unnecessary, can just do a direct equality check.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T21:07:45Z",
      "diff_hunk" : "@@ -3950,6 +3951,65 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)\n+{\n+    // Do some checking on wallet path. It should be either a:\n+    //\n+    // 1. Path where a directory can be created.\n+    // 2. Path to an existing directory.\n+    // 3. Path to a symlink to a directory.\n+    // 4. For backwards compatibility, the name of a data file in -walletdir.\n+    LOCK(cs_wallets);\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    fs::file_type path_type = fs::symlink_status(wallet_path).type();\n+    if (!(path_type == fs::file_not_found || path_type == fs::directory_file ||\n+          (path_type == fs::symlink_file && fs::is_directory(wallet_path)) ||\n+          (path_type == fs::regular_file && fs::path(wallet_file).filename() == wallet_file))) {\n+        return InitError(strprintf(\n+            _(\"Invalid -wallet path '%s'. -wallet path should point to a directory where wallet.dat and \"\n+              \"database/log.?????????? files can be stored, a location where such a directory could be created, \"\n+              \"or (for backwards compatibility) the name of an existing data file in -walletdir (%s)\"),\n+            wallet_file, GetWalletDir()));\n+    }\n+\n+    // Make sure that the wallet path doesn't clash with an existing wallet path\n+    std::set<fs::path> wallet_paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187176626",
      "id" : 187176626,
      "original_commit_id" : "dffe989059771545d20e7a62e5e9fdf8e20d78cd",
      "original_position" : 34,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118905409,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187176626",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187179940"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187179940"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "commit: [wallet] [rpc] Add loadwallet RPC\r\n\r\nFeels like this warning should get logged or maybe even returned in a \"warning\" field in the JSON response.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T21:20:57Z",
      "diff_hunk" : "@@ -2994,6 +2994,51 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\"\n+            \"\\nNote that all wallet command-line options used when starting bitcoind will be\"\n+            \"\\napplied to the new wallet (eg -zapwallettxes, upgradewallet, rescan, etc).\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187179940",
      "id" : 187179940,
      "original_commit_id" : "b2f8378e2a38b5adbcbaae9e87e3398434f7c14c",
      "original_position" : 30,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118905409,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187179940",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187183314"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187183314"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "commit: [wallet] Fix potential memory leak in CreateWalletFromFile\r\n\r\nThis isn't a complete fix because there are still early returns with errors in the rescan logic below. I believe it is safe to move the `RegisterValidationInterface` call to the bottom of the function as I argued in #12647 because `cs_main` gets locked on line 4135.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T21:35:31Z",
      "diff_hunk" : "@@ -4141,7 +4144,7 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n     }\n \n     walletInstance->m_last_block_processed = chainActive.Tip();\n-    RegisterValidationInterface(walletInstance);\n+    RegisterValidationInterface(temp_wallet.release());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187183314",
      "id" : 187183314,
      "original_commit_id" : "f8c81def4f5f88074348890a613c1006824b1b5d",
      "original_position" : 17,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 118905409,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187183314",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187183810"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187183810"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Appears this comment update was lost somewhere?",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-09T21:37:37Z",
      "diff_hunk" : "@@ -185,51 +185,23 @@ bool VerifyWallets()\n \n     uiInterface.InitMessage(_(\"Verifying wallet(s)...\"));\n \n-    // Keep track of each wallet absolute path to detect duplicates.\n-    std::set<fs::path> wallet_paths;\n+    std::vector<std::string> wallet_files = gArgs.GetArgs(\"-wallet\");\n \n-    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n-        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n-            return InitError(strprintf(_(\"Error loading wallet %s. -wallet parameter must only specify a filename (not a path).\"), walletFile));\n-        }\n+    // -salvagewallet can only be used when loading a single wallet\n+    bool salvage_wallet = gArgs.GetBoolArg(\"-salvagewallet\", false) && wallet_files.size() <= 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r187183810",
      "id" : 187183810,
      "in_reply_to_id" : 140194543,
      "original_commit_id" : "6c5b84119d1ffa547bf094b28ca602bdaf07c21a",
      "original_position" : 13,
      "path" : "src/wallet/init.cpp",
      "position" : null,
      "pull_request_review_id" : 118905409,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/187183810",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "This seems very near ready for merge except for @jimpo's nits.",
      "created_at" : "2018-05-14T05:37:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-388702334",
      "id" : 388702334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-14T05:37:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/388702334",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188303508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188303508"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, much better idea.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-15T14:15:14Z",
      "diff_hunk" : "@@ -3950,6 +3951,65 @@ std::vector<std::string> CWallet::GetDestValues(const std::string& prefix) const\n     return values;\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)\n+{\n+    // Do some checking on wallet path. It should be either a:\n+    //\n+    // 1. Path where a directory can be created.\n+    // 2. Path to an existing directory.\n+    // 3. Path to a symlink to a directory.\n+    // 4. For backwards compatibility, the name of a data file in -walletdir.\n+    LOCK(cs_wallets);\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    fs::file_type path_type = fs::symlink_status(wallet_path).type();\n+    if (!(path_type == fs::file_not_found || path_type == fs::directory_file ||\n+          (path_type == fs::symlink_file && fs::is_directory(wallet_path)) ||\n+          (path_type == fs::regular_file && fs::path(wallet_file).filename() == wallet_file))) {\n+        return InitError(strprintf(\n+            _(\"Invalid -wallet path '%s'. -wallet path should point to a directory where wallet.dat and \"\n+              \"database/log.?????????? files can be stored, a location where such a directory could be created, \"\n+              \"or (for backwards compatibility) the name of an existing data file in -walletdir (%s)\"),\n+            wallet_file, GetWalletDir()));\n+    }\n+\n+    // Make sure that the wallet path doesn't clash with an existing wallet path\n+    std::set<fs::path> wallet_paths;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188303508",
      "id" : 188303508,
      "in_reply_to_id" : 187176626,
      "original_commit_id" : "dffe989059771545d20e7a62e5e9fdf8e20d78cd",
      "original_position" : 34,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 120253352,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188303508",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188361847"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188361847"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ok, added to the JSON response.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-15T16:56:59Z",
      "diff_hunk" : "@@ -2994,6 +2994,51 @@ static UniValue listwallets(const JSONRPCRequest& request)\n     return obj;\n }\n \n+UniValue loadwallet(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 1)\n+        throw std::runtime_error(\n+            \"loadwallet \\\"filename\\\"\\n\"\n+            \"\\nLoads a wallet from a wallet file or directory.\"\n+            \"\\nNote that all wallet command-line options used when starting bitcoind will be\"\n+            \"\\napplied to the new wallet (eg -zapwallettxes, upgradewallet, rescan, etc).\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"filename\\\"    (string, required) The wallet directory or .dat file.\\n\"\n+            \"\\nResult:\\n\"\n+            \"{\\n\"\n+            \"  \\\"name\\\" : <wallet_name>,        (string) The wallet name if loaded successfully.\\n\"\n+            \"}\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"loadwallet\", \"\\\"test.dat\\\"\")\n+            + HelpExampleRpc(\"loadwallet\", \"\\\"test.dat\\\"\")\n+        );\n+    std::string wallet_file = request.params[0].get_str();\n+    std::string error;\n+\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    if (fs::symlink_status(wallet_path).type() == fs::file_not_found) {\n+        throw JSONRPCError(RPC_WALLET_NOT_FOUND, \"Wallet \" + wallet_file + \" not found.\");\n+    }\n+\n+    std::string dummy_warning;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188361847",
      "id" : 188361847,
      "in_reply_to_id" : 187179940,
      "original_commit_id" : "b2f8378e2a38b5adbcbaae9e87e3398434f7c14c",
      "original_position" : 30,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 120324771,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188361847",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188375638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188375638"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> This isn't a complete fix because there are still early returns with errors in the rescan logic below. I believe it is safe to move the RegisterValidationInterface call to the bottom of the function as I argued in #12647 because cs_main gets locked on line 4135.\r\n\r\njimpo's right, f8c81def4f5f88074348890a613c1006824b1b5d `[wallet] Fix potential memory leak in CreateWalletFromFile` isn't currently a complete fix for all memory leaks. Also, his suggestion to move `RegisterValidationInterface` and fix more leaks should be ok because of the cs_main lock. If you want to make that change, I would just add a comment above the `RegisterValidationInterface` call that says, \"it is safe to register for notifications after rescanning (no notifications will be missed) because cs_main is held during the entire scan.\" Only downside to this change is that if in the future we do optimize the rescan to not hold `cs_main` the entire time, it could introduce a bug where notifications are missed after the rescan completes.\r\n\r\nOther options:\r\n\r\n- Just drop this commit and deal with memory leaks in a separate PR.\r\n- Just add a comment above the `temp_wallet.release()` call in this commit noting that `walletInstance` will be leaked if there is an error and the code below returns `nullptr`.\r\n- Get rid of `temp_wallet`, and make `walletInstance` a unique ptr. Return `walletInstance.release()` on the last line of this function. Add `UnregisterValidationInterface(walletInstance.get())` calls below where `nullptr` is returned.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-15T17:43:13Z",
      "diff_hunk" : "@@ -4141,7 +4144,7 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n     }\n \n     walletInstance->m_last_block_processed = chainActive.Tip();\n-    RegisterValidationInterface(walletInstance);\n+    RegisterValidationInterface(temp_wallet.release());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188375638",
      "id" : 188375638,
      "in_reply_to_id" : 187183314,
      "original_commit_id" : "f8c81def4f5f88074348890a613c1006824b1b5d",
      "original_position" : 17,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 120341868,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188375638",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188376270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188376270"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done (and added comment)",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-15T17:45:16Z",
      "diff_hunk" : "@@ -4141,7 +4144,7 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n     }\n \n     walletInstance->m_last_block_processed = chainActive.Tip();\n-    RegisterValidationInterface(walletInstance);\n+    RegisterValidationInterface(temp_wallet.release());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188376270",
      "id" : 188376270,
      "in_reply_to_id" : 187183314,
      "original_commit_id" : "f8c81def4f5f88074348890a613c1006824b1b5d",
      "original_position" : 17,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 120342609,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188376270",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and addressed @jimpo's comments",
      "created_at" : "2018-05-15T17:46:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-389253985",
      "id" : 389253985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-15T17:46:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/389253985",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188411902"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188411902"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "[wallet] Add CWallet::Verify function\r\n\r\nCan drop this and the declaration of `wallet_paths` above.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-15T19:40:15Z",
      "diff_hunk" : "@@ -3989,6 +3990,66 @@ void CWallet::MarkPreSplitKeys()\n     }\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)\n+{\n+    // Do some checking on wallet path. It should be either a:\n+    //\n+    // 1. Path where a directory can be created.\n+    // 2. Path to an existing directory.\n+    // 3. Path to a symlink to a directory.\n+    // 4. For backwards compatibility, the name of a data file in -walletdir.\n+    LOCK(cs_wallets);\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    fs::file_type path_type = fs::symlink_status(wallet_path).type();\n+    if (!(path_type == fs::file_not_found || path_type == fs::directory_file ||\n+          (path_type == fs::symlink_file && fs::is_directory(wallet_path)) ||\n+          (path_type == fs::regular_file && fs::path(wallet_file).filename() == wallet_file))) {\n+        return InitError(strprintf(\n+            _(\"Invalid -wallet path '%s'. -wallet path should point to a directory where wallet.dat and \"\n+              \"database/log.?????????? files can be stored, a location where such a directory could be created, \"\n+              \"or (for backwards compatibility) the name of an existing data file in -walletdir (%s)\"),\n+            wallet_file, GetWalletDir()));\n+    }\n+\n+    // Make sure that the wallet path doesn't clash with an existing wallet path\n+    std::set<fs::path> wallet_paths;\n+    for (auto wallet : GetWallets()) {\n+        if (fs::absolute(wallet->GetName(), GetWalletDir()) == wallet_path) {\n+            return InitError(strprintf(_(\"Error loading wallet %s. Duplicate -wallet filename specified.\"), wallet_file));\n+        }\n+    }\n+\n+    if (!wallet_paths.insert(wallet_path).second) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188411902",
      "id" : 188411902,
      "original_commit_id" : "155f47dad2e4478c7cf85e562ab80626c9cfb8ea",
      "original_position" : 41,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 120385142,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188411902",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188598991"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188598991"
         }
      },
      "author_association" : "MEMBER",
      "body" : "True, no longer necessary.",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-16T12:04:11Z",
      "diff_hunk" : "@@ -3989,6 +3990,66 @@ void CWallet::MarkPreSplitKeys()\n     }\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)\n+{\n+    // Do some checking on wallet path. It should be either a:\n+    //\n+    // 1. Path where a directory can be created.\n+    // 2. Path to an existing directory.\n+    // 3. Path to a symlink to a directory.\n+    // 4. For backwards compatibility, the name of a data file in -walletdir.\n+    LOCK(cs_wallets);\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    fs::file_type path_type = fs::symlink_status(wallet_path).type();\n+    if (!(path_type == fs::file_not_found || path_type == fs::directory_file ||\n+          (path_type == fs::symlink_file && fs::is_directory(wallet_path)) ||\n+          (path_type == fs::regular_file && fs::path(wallet_file).filename() == wallet_file))) {\n+        return InitError(strprintf(\n+            _(\"Invalid -wallet path '%s'. -wallet path should point to a directory where wallet.dat and \"\n+              \"database/log.?????????? files can be stored, a location where such a directory could be created, \"\n+              \"or (for backwards compatibility) the name of an existing data file in -walletdir (%s)\"),\n+            wallet_file, GetWalletDir()));\n+    }\n+\n+    // Make sure that the wallet path doesn't clash with an existing wallet path\n+    std::set<fs::path> wallet_paths;\n+    for (auto wallet : GetWallets()) {\n+        if (fs::absolute(wallet->GetName(), GetWalletDir()) == wallet_path) {\n+            return InitError(strprintf(_(\"Error loading wallet %s. Duplicate -wallet filename specified.\"), wallet_file));\n+        }\n+    }\n+\n+    if (!wallet_paths.insert(wallet_path).second) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188598991",
      "id" : 188598991,
      "in_reply_to_id" : 188411902,
      "original_commit_id" : "155f47dad2e4478c7cf85e562ab80626c9cfb8ea",
      "original_position" : 41,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 120608006,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188598991",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188683535"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188683535"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks @jimpo. Fixed",
      "commit_id" : "cd53981b3d0d4697ed46c7bedbf10f464aca4ccc",
      "created_at" : "2018-05-16T16:07:23Z",
      "diff_hunk" : "@@ -3989,6 +3990,66 @@ void CWallet::MarkPreSplitKeys()\n     }\n }\n \n+bool CWallet::Verify(std::string wallet_file, bool salvage_wallet)\n+{\n+    // Do some checking on wallet path. It should be either a:\n+    //\n+    // 1. Path where a directory can be created.\n+    // 2. Path to an existing directory.\n+    // 3. Path to a symlink to a directory.\n+    // 4. For backwards compatibility, the name of a data file in -walletdir.\n+    LOCK(cs_wallets);\n+    fs::path wallet_path = fs::absolute(wallet_file, GetWalletDir());\n+    fs::file_type path_type = fs::symlink_status(wallet_path).type();\n+    if (!(path_type == fs::file_not_found || path_type == fs::directory_file ||\n+          (path_type == fs::symlink_file && fs::is_directory(wallet_path)) ||\n+          (path_type == fs::regular_file && fs::path(wallet_file).filename() == wallet_file))) {\n+        return InitError(strprintf(\n+            _(\"Invalid -wallet path '%s'. -wallet path should point to a directory where wallet.dat and \"\n+              \"database/log.?????????? files can be stored, a location where such a directory could be created, \"\n+              \"or (for backwards compatibility) the name of an existing data file in -walletdir (%s)\"),\n+            wallet_file, GetWalletDir()));\n+    }\n+\n+    // Make sure that the wallet path doesn't clash with an existing wallet path\n+    std::set<fs::path> wallet_paths;\n+    for (auto wallet : GetWallets()) {\n+        if (fs::absolute(wallet->GetName(), GetWalletDir()) == wallet_path) {\n+            return InitError(strprintf(_(\"Error loading wallet %s. Duplicate -wallet filename specified.\"), wallet_file));\n+        }\n+    }\n+\n+    if (!wallet_paths.insert(wallet_path).second) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#discussion_r188683535",
      "id" : 188683535,
      "in_reply_to_id" : 188411902,
      "original_commit_id" : "155f47dad2e4478c7cf85e562ab80626c9cfb8ea",
      "original_position" : 41,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 120712036,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10740",
      "updated_at" : "2018-05-16T16:07:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188683535",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK cd53981",
      "created_at" : "2018-05-16T18:36:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10740#issuecomment-389622078",
      "id" : 389622078,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10740",
      "updated_at" : "2018-05-16T18:36:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/389622078",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   }
]
