{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "In specter https://github.com/cryptoadvance/specter-desktop/issues/1491#issuecomment-1126145011  a user can abandon an **receiving** tx that was evicted from the mempool (for example because it was double spent). The tx is marked via [abandontransaction](https://github.com/bitcoin-dot-org/developer.bitcoin.org/blob/master/reference/rpc/abandontransaction.rst) as abandoned in bitcoin core.\r\n\r\nHowever [gettransaction](https://github.com/bitcoin-dot-org/developer.bitcoin.org/blob/master/reference/rpc/gettransaction.rst) and [listtransactions](https://github.com/bitcoin-dot-org/developer.bitcoin.org/blob/master/reference/rpc/listtransactions.rst) do not return the field `abandoned`, even though this is visible in the GUI:\r\n\r\n![image](https://user-images.githubusercontent.com/60378539/168316171-45c1aa29-de52-4d9a-ae2b-3293aeadd663.png)\r\n\r\n**Consequence**: Specter cannot get the `abandoned` information from bitcoin rpc, and will fetch the abandoned tx back again via [listtransactions](https://github.com/bitcoin-dot-org/developer.bitcoin.org/blob/master/reference/rpc/listtransactions.rst) after it was deleted in specter.   \r\n\r\n**Describe the solution you'd like**\r\nAlways return the `abandoned` field in https://github.com/bitcoin/bitcoin/blob/225e5b57b2ee2bc1acd7f09c89ccccc15ef8c85f/src/wallet/rpc/transactions.cpp#L345  and not only in this special case https://github.com/bitcoin/bitcoin/blob/225e5b57b2ee2bc1acd7f09c89ccccc15ef8c85f/src/wallet/rpc/transactions.cpp#L375\r\nThat should then automatically solve  [gettransaction](https://github.com/bitcoin-dot-org/developer.bitcoin.org/blob/master/reference/rpc/gettransaction.rst)  via https://github.com/bitcoin/bitcoin/blob/225e5b57b2ee2bc1acd7f09c89ccccc15ef8c85f/src/wallet/rpc/transactions.cpp#L795\r\n\r\n**Describe alternatives you've considered**\r\nIf specter can't get the information about abandoned tx from bitcoin, it would have to keep an internal list. That is possible, but redundant and can lead to many edge cases.\r\n\r\n**Steps to reproduce**\r\n\r\n- Wallet A:  Send 1 BTC to Wallet B  (rbf)\r\n- Wallet A:  Replace tx with rbf to send all funds to wallet A\r\n- Wallet B: Abandon tx (because no longer in mempool)\r\n- Wallet B:  [gettransaction](https://github.com/bitcoin-dot-org/developer.bitcoin.org/blob/master/reference/rpc/gettransaction.rst) will not show the  `abandoned` field",
   "closed_at" : "2023-04-26T12:51:23Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
      "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
      "followers_url" : "https://api.github.com/users/achow101/followers",
      "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/achow101",
      "id" : 3782274,
      "login" : "achow101",
      "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
      "organizations_url" : "https://api.github.com/users/achow101/orgs",
      "received_events_url" : "https://api.github.com/users/achow101/received_events",
      "repos_url" : "https://api.github.com/users/achow101/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/achow101"
   },
   "comments" : 8,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25130/comments",
   "created_at" : "2022-05-13T15:40:59Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25130/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/25130",
   "id" : 1235406581,
   "labels" : [
      {
         "color" : "7cf575",
         "default" : false,
         "description" : null,
         "id" : 64583,
         "name" : "Feature",
         "node_id" : "MDU6TGFiZWw2NDU4Mw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature"
      },
      {
         "color" : "08a781",
         "default" : false,
         "description" : null,
         "id" : 149424,
         "name" : "Wallet",
         "node_id" : "MDU6TGFiZWwxNDk0MjQ=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25130/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII585Jos71",
   "number" : 25130,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 1,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 1,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25130/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "state_reason" : "completed",
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25130/timeline",
   "title" : "gettransaction does not contain the field \"abandoned\" for abandoned receiving tx",
   "updated_at" : "2023-04-26T12:51:23Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25130",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/60378539?v=4",
      "events_url" : "https://api.github.com/users/relativisticelectron/events{/privacy}",
      "followers_url" : "https://api.github.com/users/relativisticelectron/followers",
      "following_url" : "https://api.github.com/users/relativisticelectron/following{/other_user}",
      "gists_url" : "https://api.github.com/users/relativisticelectron/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/relativisticelectron",
      "id" : 60378539,
      "login" : "relativisticelectron",
      "node_id" : "MDQ6VXNlcjYwMzc4NTM5",
      "organizations_url" : "https://api.github.com/users/relativisticelectron/orgs",
      "received_events_url" : "https://api.github.com/users/relativisticelectron/received_events",
      "repos_url" : "https://api.github.com/users/relativisticelectron/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/relativisticelectron/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/relativisticelectron/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/relativisticelectron"
   }
}
