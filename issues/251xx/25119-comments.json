[
   {
      "author_association" : "MEMBER",
      "body" : "Note: `src/net.cpp` is missing quite a few headers, including `logging.h` --- e0f804a0090b54 adds them but I didn't include it in this pull unless people prefer it to be added.",
      "created_at" : "2022-05-12T16:01:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25119#issuecomment-1125170197",
      "id" : 1125170197,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25119",
      "node_id" : "IC_kwDOABII585DELwV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125170197/reactions"
      },
      "updated_at" : "2022-05-12T16:01:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125170197",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\n> Note: `src/net.cpp` is missing quite a few headers, including `logging.h` --- [e0f804a](https://github.com/bitcoin/bitcoin/commit/e0f804a0090b54e25b5742da422d8ca510960724) adds them but I didn't include it in this pull unless people prefer it to be added.\r\n\r\nIs this commit part of another PR? Github says \"This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.\" (but it must belong to this repository, otherwise the link wouldn't work right? :D)",
      "created_at" : "2022-05-12T16:09:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25119#issuecomment-1125178293",
      "id" : 1125178293,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25119",
      "node_id" : "IC_kwDOABII585DENu1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125178293/reactions"
      },
      "updated_at" : "2022-05-12T16:09:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125178293",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for having a look! That homeless-looking commit was previously part of #24757, as a leftover from #24734.",
      "created_at" : "2022-05-12T16:21:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25119#issuecomment-1125189091",
      "id" : 1125189091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25119",
      "node_id" : "IC_kwDOABII585DEQXj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125189091/reactions"
      },
      "updated_at" : "2022-05-12T16:22:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125189091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just so I understand (and may be helpful to others), this PR compiles as is, but `net.cpp` makes use of some std libraries (for example, `chrono`) whose headers it doesn't include, but which happen to be included by other headers (that `net.cpp` is including). As opposed to `net.cpp` including everything it needs (that is, adding https://github.com/bitcoin/bitcoin/commit/e0f804a0090b54e25b5742da422d8ca510960724 to this PR, or wouldn't have to be this PR I guess).\r\n\r\nAs is (without this other commit), `net.cpp` compiles, but it may not in the future if one of the headers it includes stops including (for example) `chrono`, which `net.cpp` uses. In contrast, if that commit _is_ merged, then `net.cpp` is more resilient to changes outside of itself (changes in other header files). The downside of adding those includes is that compiling is slower (even though they're just redundant includes so not that bad).\r\n\r\nI'm probably not explaining this well, making it more complicated than it is, but do I have this right?\r\n\r\nIf so, my opinion is that it _would_ be good to add that commit, but I don't feel strongly either way.",
      "created_at" : "2022-05-12T17:14:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25119#issuecomment-1125236895",
      "id" : 1125236895,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25119",
      "node_id" : "IC_kwDOABII585DEcCf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125236895/reactions"
      },
      "updated_at" : "2022-05-12T17:14:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125236895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@LarryRuane thanks! that seems right to me (IIUC, building isn't slower by including what you use, as otherwise it just wouldn't compile). I'll run [iwyu](https://include-what-you-use.org) on that commit to double-check and maybe add it. ",
      "created_at" : "2022-05-12T17:43:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25119#issuecomment-1125261809",
      "id" : 1125261809,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25119",
      "node_id" : "IC_kwDOABII585DEiHx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125261809/reactions"
      },
      "updated_at" : "2022-05-12T17:43:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1125261809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25119#discussion_r872019720"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25119"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872019720"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Unrelated, but:\r\n\r\n```\r\nnet.h should add these lines:\r\n#include <assert.h>            // for assert\r\n#include <stddef.h>            // for size_t\r\n#include <algorithm>           // for max, min\r\n#include <chrono>              // for seconds, microseconds, operator\"\"s\r\n#include <set>                 // for set\r\n#include <string>              // for string, basic_string, operator<\r\n#include <utility>             // for move\r\n#include \"threadsafety.h\"      // for GUARDED_BY, EXCLUSIVE_LOCKS_REQUIRED\r\n#include \"version.h\"           // for INIT_PROTO_VERSION\r\nclass CChainParams;\r\nclass NetGroupManager;\r\nclass Sock;\r\nnamespace i2p::sam { class Session; }\r\n\r\nnet.h should remove these lines:\r\n- #include <chainparams.h>  // lines 9-9\r\n- #include <common/bloom.h>  // lines 10-10\r\n- #include <consensus/amount.h>  // lines 12-12\r\n- #include <i2p.h>  // lines 15-15\r\n- #include <netgroup.h>  // lines 20-20\r\n- #include <policy/feerate.h>  // lines 21-21\r\n- #include <util/sock.h>  // lines 30-30\r\n- class CNodeStats;  // lines 102-102\r\n",
      "commit_id" : "51ec96b904f349056e805c6b2a6de5257e8fbdee",
      "created_at" : "2022-05-13T05:47:24Z",
      "diff_hunk" : "@@ -13,7 +13,6 @@\n #include <crypto/siphash.h>\n #include <hash.h>\n #include <i2p.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25119#discussion_r872019720",
      "id" : 872019720,
      "line" : 15,
      "node_id" : "PRRC_kwDOABII584z-fcI",
      "original_commit_id" : "51ec96b904f349056e805c6b2a6de5257e8fbdee",
      "original_line" : 15,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 3,
      "pull_request_review_id" : 971727012,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25119",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872019720/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-13T05:47:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872019720",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25119#discussion_r872466299"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25119"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872466299"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke thanks. I ran iwyu python tool on `src/net.{h,cpp}` with the following (LMK if that incantation can be improved or how you are running it): `python3 <path-to>/iwyu_tool src/net.cpp -p . -j5 -- -Xiwyu --cxx17ns -Xiwyu --mapping_file=<path-to>/contrib/devtools/iwyu/bitcoin.core.imp` \r\n\r\nand this was its output for me\r\n\r\n```\r\nnet.h should add these lines:\r\n#include <assert.h>            // for assert\r\n#include <stddef.h>            // for size_t\r\n#include <algorithm>           // for min\r\n#include <chrono>              // for seconds, microseconds, operator\"\"s\r\n#include <set>                 // for set\r\n#include <string>              // for string, operator<=>\r\n#include <utility>             // for move\r\n#include \"threadsafety.h\"      // for GUARDED_BY, EXCLUSIVE_LOCKS_REQUIRED\r\n#include \"tinyformat.h\"        // for format_error\r\n#include \"version.h\"           // for INIT_PROTO_VERSION\r\nclass CChainParams;\r\nclass NetGroupManager;\r\nclass Sock;\r\nnamespace i2p::sam { class Session; }\r\n\r\nnet.h should remove these lines:\r\n- #include <chainparams.h>  // lines 9-9\r\n- #include <common/bloom.h>  // lines 10-10\r\n- #include <consensus/amount.h>  // lines 12-12\r\n- #include <i2p.h>  // lines 15-15\r\n- #include <netgroup.h>  // lines 19-19\r\n- #include <policy/feerate.h>  // lines 20-20\r\n- #include <util/sock.h>  // lines 29-29\r\n- class CNodeStats;  // lines 101-101\r\n```\r\n```\r\nnet.cpp should add these lines:\r\n#include <net/if.h>                 // for IFF_UP\r\n#include <netinet/in.h>             // for htonl, IPV6_V6ONLY, in_addr, IN6A...\r\n#include <netinet/tcp.h>            // for TCP_NODELAY\r\n#include <string.h>                 // for memcpy, memcmp, strcmp\r\n#include <sys/sdt.h>                // for __sdt_type, _SDT_ASM_OPERANDS_6\r\n#include <sys/socket.h>             // for size_t, sockaddr_storage, bind\r\n#include <compare>                  // for operator>, operator<, strong_orde...\r\n#include <exception>                // for exception\r\n#include <iterator>                 // for back_insert_iterator, back_inserter\r\n#include <ratio>                    // for ratio\r\n#include <tuple>                    // for tie, tuple\r\n#include \"chainparams.h\"            // for Params, CChainParams\r\n#include \"crypto/common.h\"          // for ReadLE32\r\n#include \"crypto/siphash.h\"         // for CSipHasher\r\n#include \"hash.h\"                   // for Hash, CHash256\r\n#include \"logging.h\"                // for LogPrintf_, LogPrint, NET, LogPrintf\r\n#include \"netgroup.h\"               // for NetGroupManager\r\n#include \"prevector.h\"              // for prevector\r\n#include \"serialize.h\"              // for SER_NETWORK, ser_writedata32, ser...\r\n#include \"span.h\"                   // for Span, AsBytes, MakeByteSpan\r\n#include \"streams.h\"                // for CDataStream, CAutoFile, CVectorWr...\r\n#include \"sync.h\"                   // for LOCK, AssertLockNotHeldInternal\r\n#include \"threadinterrupt.h\"        // for CThreadInterrupt\r\n#include \"timedata.h\"               // for GetAdjustedTime\r\n#include \"util/time.h\"              // for GetTime, count_seconds, GetTimeMi...\r\n\r\nnet.cpp should remove these lines:\r\n- #include <crypto/sha256.h>  // lines 18-18\r\n- #include <fcntl.h>  // lines 40-40\r\n- #include <math.h>  // lines 58-58\r\n```\r\n",
      "commit_id" : "51ec96b904f349056e805c6b2a6de5257e8fbdee",
      "created_at" : "2022-05-13T14:31:28Z",
      "diff_hunk" : "@@ -13,7 +13,6 @@\n #include <crypto/siphash.h>\n #include <hash.h>\n #include <i2p.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25119#discussion_r872466299",
      "id" : 872466299,
      "in_reply_to_id" : 872019720,
      "line" : 15,
      "node_id" : "PRRC_kwDOABII5840AMd7",
      "original_commit_id" : "51ec96b904f349056e805c6b2a6de5257e8fbdee",
      "original_line" : 15,
      "original_position" : 3,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 3,
      "pull_request_review_id" : 972354422,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25119",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872466299/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-13T14:31:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872466299",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
