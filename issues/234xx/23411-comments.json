[
   {
      "author_association" : "MEMBER",
      "body" : "Reproducer:\r\n[clusterfuzz-testcase-minimized-utxo_snapshot-6702059005542400.bin.txt](https://github.com/bitcoin/bitcoin/files/7454129/clusterfuzz-testcase-minimized-utxo_snapshot-6702059005542400.bin.txt)\r\n ",
      "created_at" : "2021-11-01T14:58:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-956305227",
      "id" : 956305227,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845AA9L",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956305227/reactions"
      },
      "updated_at" : "2021-11-01T14:58:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956305227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "How does activating a snapshot trigger an integer overflow in this code in the first place? That seems far more concerning, and this PR just patches it up.",
      "created_at" : "2021-11-01T15:30:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-956334356",
      "id" : 956334356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845AIEU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956334356/reactions"
      },
      "updated_at" : "2021-11-01T15:30:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956334356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa Added three more sentences to OP to explain this refactor.",
      "created_at" : "2021-11-01T15:55:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-956354784",
      "id" : 956354784,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845ANDg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956354784/reactions"
      },
      "updated_at" : "2021-11-01T15:55:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956354784",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hm, I'm kind of confused - is the concern here that a user could be fed a bad snapshot that causes an overflow? Because if that's the case, the hash of the UTXO set won't match the one hardcoded in chainparams' `m_assumeutxo_data`. \r\n\r\nIf it's not a bad snapshot you're worried about, then as far as I can tell the same wraparound issue would exist with a normal `gettxoutsetinfo` call at the height of the snapshot.",
      "created_at" : "2021-11-01T15:58:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-956357002",
      "id" : 956357002,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845ANmK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956357002/reactions"
      },
      "updated_at" : "2021-11-01T15:58:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956357002",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Correct.\r\n\r\nIf we don't care about integer overflows when activating invalid snapshots, then this pull can be closed.",
      "created_at" : "2021-11-01T15:59:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-956358061",
      "id" : 956358061,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845AN2t",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956358061/reactions"
      },
      "updated_at" : "2021-11-01T15:59:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956358061",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Would it make sense to instead compute the total amount as an `std::optional`, which starts at `{0}`, and is incremented with the read values, but when an out-of-range value is read, or the sum goes out-of-range, is replaced with `std::nullopt` (and then stays at `std::nullopt`)? That would categorically remove this concern, and pushes the responsibility for checking sanity to the caller (where it apparently differs).",
      "created_at" : "2021-11-01T19:29:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-956525053",
      "id" : 956525053,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845A2n9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956525053/reactions"
      },
      "updated_at" : "2021-11-01T19:29:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956525053",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2021-11-01T21:06:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-956590836",
      "id" : 956590836,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845BGr0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956590836/reactions"
      },
      "updated_at" : "2021-11-27T09:21:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/956590836",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Switched to `std::optional` approach",
      "created_at" : "2021-11-02T12:29:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-957452878",
      "id" : 957452878,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845EZJO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957452878/reactions"
      },
      "updated_at" : "2021-11-02T12:29:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957452878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> This might not always be true.\r\n\r\nMINI is a compile time constant (just force pushed to rename it from mini). It allows for the test checking for underflow to be less verbose. Checking for underflow is only needed when adding signed integers. Adding two unsigned integers can only overflow.",
      "created_at" : "2021-11-02T13:57:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-957632848",
      "id" : 957632848,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845FFFQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957632848/reactions"
      },
      "updated_at" : "2021-11-02T13:57:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957632848",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Seems like the number is useful for human verification. We should probably log it or tell advanced users somewhere.\r\n\r\nMaybe instead, abort activation of snapshots that exceed `MAX_MONEY`?",
      "created_at" : "2021-11-02T17:18:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-957962508",
      "id" : 957962508,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845GVkM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957962508/reactions"
      },
      "updated_at" : "2021-11-02T17:18:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957962508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Maybe instead, abort activation of snapshots that exceed MAX_MONEY?\r\n\r\nThe amounts are already covered by the hash, which is obviously trusted and verified. Thus, it will abort activation.\r\n\r\nStarting to check random consensus rules on the snapshot is going to be an open ended issue (why not check that there are no unspendable scriptPubKeys in the snapshot, ...) that doesn't give any benefit.",
      "created_at" : "2021-11-02T18:03:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-957997523",
      "id" : 957997523,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5845GeHT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957997523/reactions"
      },
      "updated_at" : "2021-11-02T18:03:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/957997523",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r746546198"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/746546198"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It seems cleaner to factor this out. What about an `AddOverflowDetect` in `util/overflow.h` that implements the \"add numbers and collapse to nullopt on overflow\" logic?",
      "commit_id" : "fa13888199cdae682aa58b68c08d9856dbd20477",
      "created_at" : "2021-11-10T12:37:20Z",
      "diff_hunk" : "@@ -82,7 +83,11 @@ static void ApplyStats(CCoinsStats& stats, const uint256& hash, const std::map<u\n     stats.nTransactions++;\n     for (auto it = outputs.begin(); it != outputs.end(); ++it) {\n         stats.nTransactionOutputs++;\n-        stats.nTotalAmount += it->second.out.nValue;\n+        if (stats.total_amount.has_value() && !AdditionOverflow(*stats.total_amount, it->second.out.nValue)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r746546198",
      "id" : 746546198,
      "line" : 86,
      "node_id" : "PRRC_kwDOABII584sf2QW",
      "original_commit_id" : "fa13888199cdae682aa58b68c08d9856dbd20477",
      "original_line" : 86,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : 13,
      "pull_request_review_id" : 802522962,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/746546198/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-10T12:37:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/746546198",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r746839547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/746839547"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thx, done",
      "commit_id" : "fa4a86e466ed4983235307d31fbe1ef8b28829d6",
      "created_at" : "2021-11-10T17:52:50Z",
      "diff_hunk" : "@@ -82,7 +83,11 @@ static void ApplyStats(CCoinsStats& stats, const uint256& hash, const std::map<u\n     stats.nTransactions++;\n     for (auto it = outputs.begin(); it != outputs.end(); ++it) {\n         stats.nTransactionOutputs++;\n-        stats.nTotalAmount += it->second.out.nValue;\n+        if (stats.total_amount.has_value() && !AdditionOverflow(*stats.total_amount, it->second.out.nValue)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r746839547",
      "id" : 746839547,
      "in_reply_to_id" : 746546198,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sg937",
      "original_commit_id" : "fa13888199cdae682aa58b68c08d9856dbd20477",
      "original_line" : 86,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : null,
      "pull_request_review_id" : 802943730,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/746839547/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-10T17:52:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/746839547",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-11-25T20:44:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-979461829",
      "id" : 979461829,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5846YWbF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979461829/reactions"
      },
      "updated_at" : "2021-11-25T20:44:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979461829",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased after conflict in touching line in Makefile, should be trivial to re-ACK",
      "created_at" : "2021-11-26T09:45:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-979830333",
      "id" : 979830333,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5846ZwY9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979830333/reactions"
      },
      "updated_at" : "2021-11-26T09:45:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979830333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771197787"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771197787"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: this looks like we are checking that the amount is not 0. Maybe better to be more explicit:\r\n\r\n```suggestion\r\n        CHECK_NONFATAL(stats.total_amount.has_value());\r\n```",
      "commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "created_at" : "2021-12-17T08:34:45Z",
      "diff_hunk" : "@@ -1217,9 +1217,10 @@ static RPCHelpMan gettxoutsetinfo()\n             ret.pushKV(\"hash_serialized_2\", stats.hashSerialized.GetHex());\n         }\n         if (hash_type == CoinStatsHashType::MUHASH) {\n-              ret.pushKV(\"muhash\", stats.hashSerialized.GetHex());\n+            ret.pushKV(\"muhash\", stats.hashSerialized.GetHex());\n         }\n-        ret.pushKV(\"total_amount\", ValueFromAmount(stats.nTotalAmount));\n+        CHECK_NONFATAL(stats.total_amount);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771197787",
      "id" : 771197787,
      "line" : 1222,
      "node_id" : "PRRC_kwDOABII584t94tb",
      "original_commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "original_line" : 1222,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 8,
      "pull_request_review_id" : 834959774,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771197787/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-17T08:55:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771197787",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771200352"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771200352"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This would `throw` and not display any results. Is that the desirable outcome? What about just skipping the `ret.pushKV(\"total_amount\", ...)` if there is no value? Or push something like \"N/A\", \"NaN\" or \"overflow\"? I mean the rest of the stats are still useful, right?",
      "commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "created_at" : "2021-12-17T08:39:18Z",
      "diff_hunk" : "@@ -1217,9 +1217,10 @@ static RPCHelpMan gettxoutsetinfo()\n             ret.pushKV(\"hash_serialized_2\", stats.hashSerialized.GetHex());\n         }\n         if (hash_type == CoinStatsHashType::MUHASH) {\n-              ret.pushKV(\"muhash\", stats.hashSerialized.GetHex());\n+            ret.pushKV(\"muhash\", stats.hashSerialized.GetHex());\n         }\n-        ret.pushKV(\"total_amount\", ValueFromAmount(stats.nTotalAmount));\n+        CHECK_NONFATAL(stats.total_amount);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771200352",
      "id" : 771200352,
      "line" : 1222,
      "node_id" : "PRRC_kwDOABII584t95Vg",
      "original_commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "original_line" : 1222,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 8,
      "pull_request_review_id" : 834959774,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771200352/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-17T08:55:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771200352",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771204894"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771204894"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "These can be `BOOST_CHECK()` and `BOOST_CHECK_EQUAL()`, the `TestAddMatrixOverflow()` and `TestAddMatrix()` functions be `void` and can be called without `BOOST_CHECK()` from the test case.\r\n\r\nThis would have the usual benefit of using `BOOST_CHECK()` vs `assert()`.",
      "commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "created_at" : "2021-12-17T08:46:52Z",
      "diff_hunk" : "@@ -1465,6 +1466,40 @@ BOOST_AUTO_TEST_CASE(test_IsDigit)\n     BOOST_CHECK_EQUAL(IsDigit(9), false);\n }\n \n+/* Check for overflow */\n+template <typename T>\n+static bool TestAddMatrixOverflow()\n+{\n+    constexpr T MAXI{std::numeric_limits<T>::max()};\n+    assert(!CheckedAdd(T{1}, MAXI));\n+    assert(!CheckedAdd(MAXI, MAXI));\n+    assert(0 == CheckedAdd(T{0}, T{0}).value());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771204894",
      "id" : 771204894,
      "line" : 1476,
      "node_id" : "PRRC_kwDOABII584t96ce",
      "original_commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "original_line" : 1476,
      "original_position" : 19,
      "original_start_line" : 1475,
      "path" : "src/test/util_tests.cpp",
      "position" : 19,
      "pull_request_review_id" : 834959774,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771204894/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1475,
      "start_side" : "RIGHT",
      "updated_at" : "2021-12-17T08:55:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771204894",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771219304"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771219304"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we should `throw` on internal bugs, which are impossible to hit. Otherwise it will be harder to find and fix them. Also, they'll crash the client regardless either with KeyError or with a parse error, since a string isn't int.",
      "commit_id" : "fa996c58e8a31ebe610d186cef408b6dd3b385a8",
      "created_at" : "2021-12-17T09:09:10Z",
      "diff_hunk" : "@@ -1217,9 +1217,10 @@ static RPCHelpMan gettxoutsetinfo()\n             ret.pushKV(\"hash_serialized_2\", stats.hashSerialized.GetHex());\n         }\n         if (hash_type == CoinStatsHashType::MUHASH) {\n-              ret.pushKV(\"muhash\", stats.hashSerialized.GetHex());\n+            ret.pushKV(\"muhash\", stats.hashSerialized.GetHex());\n         }\n-        ret.pushKV(\"total_amount\", ValueFromAmount(stats.nTotalAmount));\n+        CHECK_NONFATAL(stats.total_amount);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771219304",
      "id" : 771219304,
      "in_reply_to_id" : 771200352,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584t999o",
      "original_commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "original_line" : 1222,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 834990289,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771219304/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-17T09:09:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771219304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771246147"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771246147"
         }
      },
      "author_association" : "MEMBER",
      "body" : "thx, fixed",
      "commit_id" : "fa996c58e8a31ebe610d186cef408b6dd3b385a8",
      "created_at" : "2021-12-17T09:48:51Z",
      "diff_hunk" : "@@ -1217,9 +1217,10 @@ static RPCHelpMan gettxoutsetinfo()\n             ret.pushKV(\"hash_serialized_2\", stats.hashSerialized.GetHex());\n         }\n         if (hash_type == CoinStatsHashType::MUHASH) {\n-              ret.pushKV(\"muhash\", stats.hashSerialized.GetHex());\n+            ret.pushKV(\"muhash\", stats.hashSerialized.GetHex());\n         }\n-        ret.pushKV(\"total_amount\", ValueFromAmount(stats.nTotalAmount));\n+        CHECK_NONFATAL(stats.total_amount);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771246147",
      "id" : 771246147,
      "in_reply_to_id" : 771197787,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584t-EhD",
      "original_commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "original_line" : 1222,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 835029039,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771246147/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-17T09:48:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771246147",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771246623"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771246623"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nice, fixed.",
      "commit_id" : "fa996c58e8a31ebe610d186cef408b6dd3b385a8",
      "created_at" : "2021-12-17T09:49:27Z",
      "diff_hunk" : "@@ -1465,6 +1466,40 @@ BOOST_AUTO_TEST_CASE(test_IsDigit)\n     BOOST_CHECK_EQUAL(IsDigit(9), false);\n }\n \n+/* Check for overflow */\n+template <typename T>\n+static bool TestAddMatrixOverflow()\n+{\n+    constexpr T MAXI{std::numeric_limits<T>::max()};\n+    assert(!CheckedAdd(T{1}, MAXI));\n+    assert(!CheckedAdd(MAXI, MAXI));\n+    assert(0 == CheckedAdd(T{0}, T{0}).value());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#discussion_r771246623",
      "id" : 771246623,
      "in_reply_to_id" : 771204894,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584t-Eof",
      "original_commit_id" : "fa72733b12eac2fa038afb75c9463570b48ea34b",
      "original_line" : 1476,
      "original_position" : 19,
      "original_start_line" : 1475,
      "path" : "src/test/util_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 835030568,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23411",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771246623/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-12-17T09:49:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771246623",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Addressed test nits in force push. Should be trivial to re-ACK with:\r\n\r\n```\r\ngit range-diff bitcoin-core/master --word-diff-regex=. fa72733b12 fa996c58e8",
      "created_at" : "2021-12-17T09:50:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23411#issuecomment-996580369",
      "id" : 996580369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23411",
      "node_id" : "IC_kwDOABII5847ZpwR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/996580369/reactions"
      },
      "updated_at" : "2021-12-17T09:50:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/996580369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
