[
   {
      "author_association" : "MEMBER",
      "body" : "The transaction are probably successfully added to the mempool, otherwise the assertion would fail\r\nhttps://github.com/bitcoin/bitcoin/blob/c564424d98b1561f16e633528172b3583719e5f3/test/functional/mempool_persist.py#L94\r\n\r\nI suspect, it is a race where `LoadMempool` is still running/about to finish.",
      "created_at" : "2018-04-02T22:08:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12863#issuecomment-378061949",
      "id" : 378061949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12863",
      "updated_at" : "2018-04-02T22:08:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378061949",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Short term fix: when it gets that exception, it should probably retry instead of giving up.\r\n\r\nLonger term this would be a reason to prefer using a mutex to avoid preliminary or concurrent access to the mempool dump instead of returning an error. The RPC could just wait.",
      "created_at" : "2018-04-03T08:11:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12863#issuecomment-378165864",
      "id" : 378165864,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12863",
      "updated_at" : "2018-04-03T08:11:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378165864",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Could we have the test framework wait for mempool to load?",
      "created_at" : "2018-04-03T22:35:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12863#issuecomment-378421044",
      "id" : 378421044,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12863",
      "updated_at" : "2018-04-03T22:35:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378421044",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Referencing @MarcoFalke comment in https://github.com/bitcoin/bitcoin/pull/12842#issuecomment-378303303:\r\n> I think we had reports that loading the mempool took 1.5 hours or so, just noting without further comment.",
      "created_at" : "2018-04-03T22:36:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12863#issuecomment-378421330",
      "id" : 378421330,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12863",
      "updated_at" : "2018-04-03T22:36:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378421330",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Could we have the test framework wait for mempool to load?\r\n\r\nThe test case already waits for the mempool to load; it checks it via `len(n.getrawmempool())==5`, but I guess the problem is that between loading the 5th tx and updating the global flag, it also releases cs_main, reprioritises transactions, and notes a couple of log entries, which is enough time for python to race on and try saving the mempool data.\r\n\r\nFWIW, adding `MilliSleep(200);` just before the final `LogPrintf` in `LoadMemPool` looks like it reproduces the problem pretty reliably to me.\r\n\r\nFixing that problem gives another though: there's a check for \"Unable to dump mempool to disk\" further on, which can also give the \"mempool was not loaded yet\" error. That can be worked around too, but maybe it would be better to just make the `g_is_mempool_loaded` flag visible via `getmempoolinfo` so the tests can wait accurately?",
      "created_at" : "2018-04-13T05:55:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12863#issuecomment-381031762",
      "id" : 381031762,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12863",
      "updated_at" : "2018-04-13T05:55:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/381031762",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
