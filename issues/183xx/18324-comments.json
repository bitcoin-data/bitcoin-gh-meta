[
   {
      "author_association" : "MEMBER",
      "body" : "Can you explain the steps to reproduce or show a log excerpt? As I understand BIP 37, merely setting `filterload` does not make the node to send only filtered blocks. Blocks still need to be queried with a getdata that sets `MSG_FILTERED_BLOCK == 3`.",
      "created_at" : "2020-03-12T17:29:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-598315721",
      "id" : 598315721,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5ODMxNTcyMQ==",
      "updated_at" : "2020-03-12T17:29:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/598315721",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Also, if 0.19.0.1 is broken, is 0.18.* the last version that was working?",
      "created_at" : "2020-03-12T18:13:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-598343851",
      "id" : 598343851,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5ODM0Mzg1MQ==",
      "updated_at" : "2020-03-12T18:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/598343851",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "At the current time I can't provide logs because I didn't see this on my own bitcoind. What I see is a massive number of txns per block (2000-3000) right from the beginning of the download from a checkpoint.\r\n\r\nIt's probably too early to talk about affected versions, but so far I only remember seeing 0.19.0.1.",
      "created_at" : "2020-03-13T15:01:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-598763029",
      "id" : 598763029,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5ODc2MzAyOQ==",
      "updated_at" : "2020-03-13T15:01:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/598763029",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/743306?v=4",
         "events_url" : "https://api.github.com/users/schildbach/events{/privacy}",
         "followers_url" : "https://api.github.com/users/schildbach/followers",
         "following_url" : "https://api.github.com/users/schildbach/following{/other_user}",
         "gists_url" : "https://api.github.com/users/schildbach/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/schildbach",
         "id" : 743306,
         "login" : "schildbach",
         "node_id" : "MDQ6VXNlcjc0MzMwNg==",
         "organizations_url" : "https://api.github.com/users/schildbach/orgs",
         "received_events_url" : "https://api.github.com/users/schildbach/received_events",
         "repos_url" : "https://api.github.com/users/schildbach/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/schildbach/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/schildbach/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/schildbach"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "With checkpoint do you mean wallet birthday?\r\n\r\nAnd to double check, you only send getdata of type 3?\r\n\r\nThis is the function that sends out blocks: https://github.com/bitcoin/bitcoin/blob/v0.19.0.1/src/net_processing.cpp#L1357-L1510 . You can highlight the lines that have a `PushMessage` in it and can see that each of them is conditioned on the `inv.type`.",
      "created_at" : "2020-03-16T15:22:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-599596497",
      "id" : 599596497,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5OTU5NjQ5Nw==",
      "updated_at" : "2020-03-16T15:22:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/599596497",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is the type of the block message `block` or `merkleblock`?",
      "created_at" : "2020-04-01T02:49:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-606996281",
      "id" : 606996281,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjk5NjI4MQ==",
      "updated_at" : "2020-04-01T02:49:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606996281",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@schildbach: Is there a possibility that the `filterload` command has not arrived at the node? Since TCP is used I think that's unlikely to not be discovered by the client, but maybe for whatever internal reasons the packet was not even transmitted by the client.\r\nDue to the bug described in https://github.com/bitcoin/bitcoin/issues/18483, you would receive ~~full blocks~~ merkle blocks if you request `merkleblock`s, but no `filterload` was received by the node before. (//EDIT: Updated after the hint that there is no possibility to reply with full blocks to `inv` message with `MSG_FILTERED_BLOCK` set).",
      "created_at" : "2020-04-01T12:35:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-607223251",
      "id" : 607223251,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNzIyMzI1MQ==",
      "updated_at" : "2020-04-01T16:28:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/607223251",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@theStack I can't say, because I don't have any bitcoind logs of the issue. Our code certainly sets a filter, but of course there could be subtle bugs. I must admit that I'm not super happy about the quality and maintainability of bitcoinj's network code. That said, I think bitcoind should just drop the connection if it detects an unexpected state. (Ideally send a `REJECT` first, but that's another topic.)",
      "created_at" : "2020-04-01T13:00:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-607234429",
      "id" : 607234429,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNzIzNDQyOQ==",
      "updated_at" : "2020-04-01T13:00:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/607234429",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/743306?v=4",
         "events_url" : "https://api.github.com/users/schildbach/events{/privacy}",
         "followers_url" : "https://api.github.com/users/schildbach/followers",
         "following_url" : "https://api.github.com/users/schildbach/following{/other_user}",
         "gists_url" : "https://api.github.com/users/schildbach/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/schildbach",
         "id" : 743306,
         "login" : "schildbach",
         "node_id" : "MDQ6VXNlcjc0MzMwNg==",
         "organizations_url" : "https://api.github.com/users/schildbach/orgs",
         "received_events_url" : "https://api.github.com/users/schildbach/received_events",
         "repos_url" : "https://api.github.com/users/schildbach/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/schildbach/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/schildbach/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/schildbach"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@theStack I don't think it is possible for Bitcoin Core to respond with a `block` to an inv that sets `MSG_FILTERED_BLOCK`. Even with the code mess from #18483.",
      "created_at" : "2020-04-01T15:46:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-607329248",
      "id" : 607329248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNzMyOTI0OA==",
      "updated_at" : "2020-04-01T15:46:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/607329248",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Sorry for the confusion and my wrong conclusion, I was not reading thoroughly -- @MarcoFalke is right, I also definitely not see a way that regular `block`s are sent as reply to received `inv`s with `MSG_FILTERED_BLOCK` inside.",
      "created_at" : "2020-04-01T16:26:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-607352561",
      "id" : 607352561,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNzM1MjU2MQ==",
      "updated_at" : "2020-04-01T16:26:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/607352561",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'd suggest to close this issue. Absent any information on how to reproduce, or even what message types were sent in what order, this is hard to debug.\r\n\r\nIf you have the code available of the exact version of your client software you were using, I can take a look, but other than that I don't think we can solve this issue.",
      "created_at" : "2020-04-20T11:14:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-616483330",
      "id" : 616483330,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNjQ4MzMzMA==",
      "updated_at" : "2020-04-20T11:14:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/616483330",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, fair enough. I'll keep an eye on it and try to produce better logs.",
      "created_at" : "2020-04-20T14:37:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18324#issuecomment-616595893",
      "id" : 616595893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18324",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNjU5NTg5Mw==",
      "updated_at" : "2020-04-20T14:37:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/616595893",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/743306?v=4",
         "events_url" : "https://api.github.com/users/schildbach/events{/privacy}",
         "followers_url" : "https://api.github.com/users/schildbach/followers",
         "following_url" : "https://api.github.com/users/schildbach/following{/other_user}",
         "gists_url" : "https://api.github.com/users/schildbach/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/schildbach",
         "id" : 743306,
         "login" : "schildbach",
         "node_id" : "MDQ6VXNlcjc0MzMwNg==",
         "organizations_url" : "https://api.github.com/users/schildbach/orgs",
         "received_events_url" : "https://api.github.com/users/schildbach/received_events",
         "repos_url" : "https://api.github.com/users/schildbach/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/schildbach/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/schildbach/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/schildbach"
      }
   }
]
