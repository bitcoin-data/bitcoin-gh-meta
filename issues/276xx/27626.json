{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "This is an attempt at mitigating https://github.com/bitcoin/bitcoin/issues/25258 , which is a revival of https://github.com/bitcoin/bitcoin/pull/10984, which is a revival of https://github.com/bitcoin/bitcoin/pull/9447.\r\n\r\nThis PR attempts to mitigate a single case, where high bandwidth peers can bail us out of a flakey\r\npeer not completing blocks for us. We allow up to 2 additional getblocktxns requests per unique block.\r\nThis would hopefully allow the chance for an honest high bandwidth peer to hand us the transactions\r\neven if the first in flight peer stalls out.\r\n\r\nIn contrast to previous effort, it will not help if subsequent peers send block headers only, so only high-bandwidth peers this time. Removes one block of code, and maybe easier to reason about?\r\n\r\nOpen questions:\r\n1) Is 3 parallel block sessions too much bandwidth? Do the partial block `Init`s compete for locks/CPU causing slowdown if too many happen? We have 3 high bandwidth peers, which is why I thought about this number.\r\n2) Should we strongly prefer outbound high bandwidth peers? Maybe we should only allow the third slot to inbound if an outbound has already been requested? I want to hedge against sybil nodes intentionally slowing down block prop. High bandwidth peers haven't been seen doing this and by definition they seem reliable, but something to be thinking about.\r\n3) Is `MAX_GETBLOCKTXN_TXN_AFTER_FIRST_IN_FLIGHT = 10` too small? There's tension in that I think this feature is the *most* useful during seasons of mempool chop(meaning potentially lots of misses), otherwise the chances of missing 0 transactions and avoiding a round-trip go up, and this isn't needed in that case. \r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27626/comments",
   "created_at" : "2023-05-11T14:05:20Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27626/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/27626",
   "id" : 1705885197,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "description" : null,
         "id" : 98298007,
         "name" : "P2P",
         "node_id" : "MDU6TGFiZWw5ODI5ODAwNw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27626/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII585QS9YY",
   "number" : 27626,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/27626.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27626",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/27626.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27626"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 2,
      "total_count" : 2,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27626/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27626/timeline",
   "title" : "Parallel compact block downloads, take 3",
   "updated_at" : "2023-05-11T18:55:28Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27626",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
      "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
      "followers_url" : "https://api.github.com/users/instagibbs/followers",
      "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/instagibbs",
      "id" : 5767891,
      "login" : "instagibbs",
      "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
      "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
      "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
      "repos_url" : "https://api.github.com/users/instagibbs/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/instagibbs"
   }
}
