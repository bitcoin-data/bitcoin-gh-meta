[
   {
      "author_association" : "NONE",
      "body" : "Maybe @Sjors can look into this?",
      "created_at" : "2023-05-13T19:03:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1546731833",
      "id" : 1546731833,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27652",
      "node_id" : "IC_kwDOABII585cMUE5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546731833/reactions"
      },
      "updated_at" : "2023-05-13T19:03:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546731833",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5763256?v=4",
         "events_url" : "https://api.github.com/users/kroese/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kroese/followers",
         "following_url" : "https://api.github.com/users/kroese/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kroese/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kroese",
         "id" : 5763256,
         "login" : "kroese",
         "node_id" : "MDQ6VXNlcjU3NjMyNTY=",
         "organizations_url" : "https://api.github.com/users/kroese/orgs",
         "received_events_url" : "https://api.github.com/users/kroese/received_events",
         "repos_url" : "https://api.github.com/users/kroese/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kroese/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kroese/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kroese"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> For example, if you run a pruned node, and your first peer happens to be also pruned, the call will fail. If the call tried all nodes, until it finds a peer that has the block, it wouldn't require you that implement any logic for that.\r\n\r\nBased on your words, guess that you are calling `getblockfrompeer` with a fixed index of `1`?\r\nYou could instead use `getpeerinfo` and filter the result by service. Only requesting the block to another full node.",
      "created_at" : "2023-05-13T19:17:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1546733957",
      "id" : 1546733957,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27652",
      "node_id" : "IC_kwDOABII585cMUmF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546733957/reactions"
      },
      "updated_at" : "2023-05-13T19:17:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546733957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Based on your words, guess that you are calling `getblockfrompeer` with a fixed index of `1`?\r\n> You could instead use `getpeerinfo` and filter the result by service. Only requesting the block to another full node.\r\n\r\nI'm aware you could workaround this issue by implementing a bunch of manual logic on the client-side. But even if you skip the pruned nodes and  this full node couldn't provide you the block (for whatever reason), it would be handy if the call would just try the next one.\r\n",
      "created_at" : "2023-05-13T19:35:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1546736533",
      "id" : 1546736533,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27652",
      "node_id" : "IC_kwDOABII585cMVOV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546736533/reactions"
      },
      "updated_at" : "2023-05-13T19:45:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546736533",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5763256?v=4",
         "events_url" : "https://api.github.com/users/kroese/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kroese/followers",
         "following_url" : "https://api.github.com/users/kroese/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kroese/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kroese",
         "id" : 5763256,
         "login" : "kroese",
         "node_id" : "MDQ6VXNlcjU3NjMyNTY=",
         "organizations_url" : "https://api.github.com/users/kroese/orgs",
         "received_events_url" : "https://api.github.com/users/kroese/received_events",
         "repos_url" : "https://api.github.com/users/kroese/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kroese/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kroese/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kroese"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm aware you could workaround this issue by implementing a bunch of manual logic on the client-side. But even if you skip the pruned nodes and this full node couldn't provide you the block, it would be handy if the call would just try the next one.\r\n\r\nSure. Was providing you a simple workaround to the described issue.\r\n\r\nI actually have done something similar for #21267 (in that case is a block filter tracker but here will be for blocks only).\r\nSo, I'm happy to work on it. Will tackle it soon.\r\n\r\nSmall note: the \"cannot provide block\" is actually a `getdata` request timeout. The RPC command isn't synchronously fetching the block from the other peer, so the command call will not be the one that tries it again.",
      "created_at" : "2023-05-13T20:08:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1546741712",
      "id" : 1546741712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27652",
      "node_id" : "IC_kwDOABII585cMWfQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546741712/reactions"
      },
      "updated_at" : "2023-05-13T20:10:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546741712",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
