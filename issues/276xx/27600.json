{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "Closes https://github.com/bitcoin/bitcoin/issues/8798\r\n\r\nUse case: I run a full node that accepts inbound connections and have a `whitebind` setting so my personal light client can always connect, even when `maxconnections` (and particularly all inbound slots) is already full.\r\n\r\nCurrently when connections are full, if we receive in inbound peer request, we look for a current connection to evict so the new peer can have a slot. To find an evict-able peer we go through all our peers and \"protect\" multiple categories of peers, then we evict the \"worst\" peer that is left unprotected. If there are no peers left to evict, the inbound connection is denied.\r\n\r\nWith this PR, if the inbound connection is on our whitelist we still loop through all our current connection, removing protected peers from the evict-able list. However, now we keep track of the last peer we protected (aka the last peer we removed from the evict-able list). If we end up with no peers left to evict, the last protected peer is evicted instead. This should preserve the peer eviction logic but just in the case of a whitebind inbound, we evict the \"worst best\" connection.\r\n\r\nAll outbound and `noban` connections remain protected from eviction.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27600/comments",
   "created_at" : "2023-05-08T19:59:30Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27600/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/27600",
   "id" : 1700844188,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "description" : null,
         "id" : 98298007,
         "name" : "P2P",
         "node_id" : "MDU6TGFiZWw5ODI5ODAwNw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27600/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII585QCBm_",
   "number" : 27600,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/27600.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27600",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/27600.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27600"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27600/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27600/timeline",
   "title" : "net: Allow inbound whitebind connections to more aggressively evict peers when slots are full",
   "updated_at" : "2023-05-16T09:40:07Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27600",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
      "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
      "followers_url" : "https://api.github.com/users/pinheadmz/followers",
      "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
      "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/pinheadmz",
      "id" : 2084648,
      "login" : "pinheadmz",
      "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
      "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
      "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
      "repos_url" : "https://api.github.com/users/pinheadmz/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/pinheadmz"
   }
}
