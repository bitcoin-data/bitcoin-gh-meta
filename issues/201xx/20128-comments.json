[
   {
      "author_association" : "MEMBER",
      "body" : "I think it has previously been suggested to only allow absolute paths",
      "created_at" : "2020-10-12T07:30:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-706933436",
      "id" : 706933436,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNjkzMzQzNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-12T07:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/706933436",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "```c++\r\n    std::__cxx11::regex invalid_chars(\"(/|\\\\.)(.*)\");\r\n\r\n    if (regex_match(request.params[0].get_str(), invalid_chars)) {\r\n        throw JSONRPCError(RPC_WALLET_ERROR, \"Invalid characters in wallet name\");\r\n    }\r\n```\r\nHow about this? And can someone help me understand what all files need to be changed for this `if` statement to work? \r\n\r\n`rpcwallet.cpp` and `wallet.cpp` ? ",
      "created_at" : "2020-11-13T23:46:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727087784",
      "id" : 727087784,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzA4Nzc4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-13T23:46:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727087784",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Not sure what needs to be validated, if it's a valid file path then it should be fine.\r\n\r\n",
      "created_at" : "2020-11-15T22:46:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727650556",
      "id" : 727650556,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzY1MDU1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-15T22:46:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727650556",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Not sure what needs to be validated, if it's a valid file path then it should be fine.\r\n\r\nI think we can just validate if the wallet name string has any characters in the beginning that can be used to do more than just creating a wallet in an expected directory. I am thinking to include few more characters in it like `%` mentioned here: https://owasp.org/www-community/attacks/Path_Traversal\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/99200270-4fc32c00-27ca-11eb-9a7d-de6309b8595a.png)\r\n\r\nTrying to stop the user to do anything in the blue area on left when he uses the web application.\r\n\r\nI have never tried to fix things in past, only break lol so not really sure if this thing may affect web apps using bitcoin core but its always good to restrict the user by validating inputs. Other thing which I understood after reading everything is that users should not have privileges to access other directories. This is something we can't control so just basic checks in place. If validating the wallet name string for 3-4 special chars in the beginning breaks anything we can ignore this issue and PR. I will do more research this week and add everything in the PR with tests.",
      "created_at" : "2020-11-15T23:45:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727659025",
      "id" : 727659025,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzY1OTAyNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-15T23:45:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727659025",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> when he uses the web application\r\n\r\nClearly you could validate user input on the web app. You could even assign a \"safe\" wallet name for the desired wallet name.",
      "created_at" : "2020-11-16T00:11:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727662809",
      "id" : 727662809,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzY2MjgwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T00:11:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727662809",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Sure. That's why I mentioned 4 things in the issue description earlier:\r\n\r\n1. > Describe alternatives you've considered\r\nWeb developers should create **secure** web apps that use Bitcoin Core.\r\n2. > can be exploited in **vulnerable** web applications that use Bitcoin Core\r\n3. > It was an issue with the website and we had to fix it although nobody could exploit it because the **third party APIs** that we were using to book the fight tickets were **validating all the things**. So a ticket couldn't be processed after tampering and changing the price by attacker. Similarly, if any web developer makes a mistake and using Bitcoin Core for the web app would still be unaffected if Bitcoin Core itself doesn't allow such things for wallet names.\r\n4. > not a vulnerability in Bitcoin Core and only affects **vulnerable web apps** that use Bitcoin Core",
      "created_at" : "2020-11-16T00:37:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727668671",
      "id" : 727668671,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzY2ODY3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T00:37:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727668671",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I can't figure out what the issue is here. The problem is with a web app allows users to specify bitcoin wallet names? Like the web app has some code like:\r\n\r\n```js\r\nif (wallet_name == \"big wallet\") {\r\n   throw error(\"Can't spend from big wallet!\")\r\n}\r\n```\r\n\r\nbut the user can get around this by spending from `\"./big wallet\"` instead of `\"big wallet\"`?\r\n",
      "created_at" : "2020-11-16T11:47:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727929077",
      "id" : 727929077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzkyOTA3Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T11:47:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727929077",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I can't figure out what the issue is here. \r\n\r\n@ryanofsky \r\n\r\n![image](https://user-images.githubusercontent.com/13405205/102725904-57816d80-4340-11eb-8d6d-d5e96ab7ef58.png)\r\n\r\nAlice is trying to test few websites and apps that use bitcoin core. Red boxes on right represent vulnerable apps and Blue boxes are secure. Grey box is bitcoin core. We are trying to prevent Alice to exploit any of those small boxes (bitcoin projects using bitcoin core) on right by making bitcoin core more secure and not depend on devs involved in different bitcoin projects.\r\n",
      "created_at" : "2020-12-20T22:29:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-748679856",
      "id" : 748679856,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODY3OTg1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T22:29:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748679856",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "But what is the vulnerability you're trying to protect against?",
      "created_at" : "2020-12-21T03:43:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-748740572",
      "id" : 748740572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODc0MDU3Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-21T03:43:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748740572",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Path/Directory Traversal with the help of `createwallet`'s `wallet_name` argument\r\n\r\nExample: https://medium.com/tenable-techblog/android-mx-player-path-traversal-to-code-execution-9134b623eb34",
      "created_at" : "2020-12-21T10:21:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-748895826",
      "id" : 748895826,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODg5NTgyNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-21T10:21:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748895826",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   }
]
