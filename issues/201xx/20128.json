{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "**Is your feature request related to a problem? Please describe.**\r\n\r\nWallets with weird names possible which can be exploited in vulnerable web applications that use Bitcoin Core and allow the users to create and import/export wallet\r\n\r\n`../testwallet` for Linux\r\n`..\\testwallet` for Windows\r\n\r\nTried on Bitcoin Core v 0.20.0\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/20080#issuecomment-706766527\r\n\r\n\r\n**Describe the solution you'd like**\r\n+ Keep two arguments: \r\n`wallet_name` and `wallet_path` for `createwallet` \r\n`filename` and `filepath` for `dumpwallet` `importwallet`\r\n\r\n+ Validate user input. Name should not contain special characters. Path should be optional and if not specified use a default value.\r\n\r\n**Describe alternatives you've considered**\r\nWeb developers should create secure web apps that use Bitcoin Core.\r\n\r\n**Additional context**\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/95716478-2a05ad00-0c89-11eb-9e35-2720c82bad61.png)\r\n\r\n\r\nI understand its not a vulnerability in Bitcoin Core and only affects vulnerable web apps that use Bitcoin Core. However we can at least consider it a bug that may affect something in future or other projects that use Bitcoin Core. Basic checks for user input can improve the security. In 2017 I had a website in which someone had reported a vulnerability that could be used to change price of flight tickets and book with almost zero bitcoin. It was an issue with the website and we had to fix it although nobody could exploit it because the third party APIs that we were using to book the fight tickets were validating all the things. So a ticket couldn't be processed after tampering and changing the price by attacker. Similarly, if any web developer makes a mistake and using Bitcoin Core for the web app would still be unaffected if Bitcoin Core itself doesn't allow such things for wallet names. \r\n\r\nThere have been lot of directory traversal related vulnerabilities, recently one was reported in Facebook android app:\r\n\r\nhttps://portswigger.net/daily-swig/vulnerability-in-facebook-android-app-nets-10k-bug-bounty\r\n\r\n",
   "closed_at" : "2021-01-09T08:00:39Z",
   "closed_by" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
      "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
      "followers_url" : "https://api.github.com/users/laanwj/followers",
      "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/laanwj",
      "id" : 126646,
      "login" : "laanwj",
      "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
      "organizations_url" : "https://api.github.com/users/laanwj/orgs",
      "received_events_url" : "https://api.github.com/users/laanwj/received_events",
      "repos_url" : "https://api.github.com/users/laanwj/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/laanwj"
   },
   "comments" : 10,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128/comments",
   "created_at" : "2020-10-12T07:19:58Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128",
   "id" : 719132188,
   "labels" : [
      {
         "color" : "7cf575",
         "default" : false,
         "description" : null,
         "id" : 64583,
         "name" : "Feature",
         "node_id" : "MDU6TGFiZWw2NDU4Mw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU3MTkxMzIxODg=",
   "number" : 20128,
   "performed_via_github_app" : null,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Validate user input and keep path in a separate argument for importwallet, createwallet and dumpwallet",
   "updated_at" : "2021-01-09T08:00:39Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
      "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
      "followers_url" : "https://api.github.com/users/prayank23/followers",
      "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
      "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/prayank23",
      "id" : 13405205,
      "login" : "prayank23",
      "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
      "organizations_url" : "https://api.github.com/users/prayank23/orgs",
      "received_events_url" : "https://api.github.com/users/prayank23/received_events",
      "repos_url" : "https://api.github.com/users/prayank23/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/prayank23"
   }
}
