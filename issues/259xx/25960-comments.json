[
   {
      "author_association" : "MEMBER",
      "body" : "@ajtowns @instagibbs These should address the remaining review items that came up in https://github.com/bitcoin/bitcoin/pull/25717#issuecomment-1228795579",
      "created_at" : "2022-08-30T16:49:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1231918353",
      "id" : 1231918353,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585JbZUR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1231918353/reactions"
      },
      "updated_at" : "2022-08-30T16:51:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1231918353",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25960#discussion_r958731326"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958731326"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```bash\r\n/tmp/cirrus-ci-build/test/functional/p2p_headers_sync_with_minchainwork.py:57: unused variable 'num_tips' (100% confidence)\r\ntest/functional/p2p_headers_sync_with_minchainwork.py:57:9: E306 expected 1 blank line before a nested definition, found 0\r\n```",
      "commit_id" : "2ad515a9a10fbbf8158606019af2514d9eed5d00",
      "created_at" : "2022-08-30T17:05:21Z",
      "diff_hunk" : "@@ -40,17 +40,32 @@ def setup_network(self):\n     def disconnect_all(self):\n         self.disconnect_nodes(0, 1)\n         self.disconnect_nodes(0, 2)\n+        self.disconnect_nodes(0, 3)\n \n     def reconnect_all(self):\n         self.connect_nodes(0, 1)\n         self.connect_nodes(0, 2)\n+        self.connect_nodes(0, 3)\n \n     def test_chains_sync_when_long_enough(self):\n         self.log.info(\"Generate blocks on the node with no required chainwork, and verify nodes 1 and 2 have no new headers in their headers tree\")\n         with self.nodes[1].assert_debug_log(expected_msgs=[\"[net] Ignoring low-work chain (height=14)\"]), self.nodes[2].assert_debug_log(expected_msgs=[\"[net] Ignoring low-work chain (height=14)\"]):\n             self.generate(self.nodes[0], NODE1_BLOCKS_REQUIRED-1, sync_fun=self.no_op)\n \n-        for node in self.nodes[1:]:\n+        # Node3 should always allow headers due to noban permissions\n+        self.log.info(\"Check that node3 will sync headers (due to noban permissions)\")\n+        def check_node3_chaintips(num_tips, tip_hash, height):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#discussion_r958731326",
      "id" : 958731326,
      "line" : 57,
      "node_id" : "PRRC_kwDOABII5845JRQ-",
      "original_commit_id" : "1206e2deb2f47419dd75300a78315d7964c0e8ee",
      "original_line" : 57,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/p2p_headers_sync_with_minchainwork.py",
      "position" : 31,
      "pull_request_review_id" : 1090684091,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958731326/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-30T17:05:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958731326",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "<details><summary>Some initial WIP follow-up suggestions on first look-over of #25717.</summary><p>\r\n\r\n```diff\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex c4a1b5fa15..1158b6c06a 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -634,23 +634,23 @@ private:\r\n      *              acceptance by the caller).\r\n      */\r\n     bool IsContinuationOfLowWorkHeadersSync(Peer& peer, CNode& pfrom,\r\n-            std::vector<CBlockHeader>& headers)\r\n+                                            std::vector<CBlockHeader>& headers)\r\n         EXCLUSIVE_LOCKS_REQUIRED(peer.m_headers_sync_mutex, !m_headers_presync_mutex);\r\n     /** Check work on a headers chain to be processed, and if insufficient,\r\n      * initiate our anti-DoS headers sync mechanism.\r\n      *\r\n-     * @param[in]   peer                The peer whose headers we're processing.\r\n-     * @param[in]   pfrom               CNode of the peer\r\n-     * @param[in]   chain_start_header  Where these headers connect in our index.\r\n-     * @param[in,out]   headers             The headers to be processed.\r\n+     * @param[in]     peer                The peer whose headers we're processing.\r\n+     * @param[in]     pfrom               CNode of the peer\r\n+     * @param[in]     chain_start_header  Where these headers connect in our index.\r\n+     * @param[in,out] headers             The headers to be processed.\r\n      *\r\n      * @return      True if chain was low work and a headers sync was\r\n      *              initiated (and headers will be empty after calling); false\r\n      *              otherwise.\r\n      */\r\n     bool TryLowWorkHeadersSync(Peer& peer, CNode& pfrom,\r\n-                                  const CBlockIndex* chain_start_header,\r\n-                                  std::vector<CBlockHeader>& headers)\r\n+                               const CBlockIndex* chain_start_header,\r\n+                               std::vector<CBlockHeader>& headers)\r\n         EXCLUSIVE_LOCKS_REQUIRED(!peer.m_headers_sync_mutex, !m_peer_mutex, !m_headers_presync_mutex);\r\n \r\n     /** Return true if the given header is an ancestor of\r\n@@ -1482,7 +1482,7 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\r\n \r\n void PeerManagerImpl::FinalizeNode(const CNode& node)\r\n {\r\n+    AssertLockNotHeld(m_headers_presync_mutex);\r\n     NodeId nodeid = node.GetId();\r\n     int misbehavior{0};\r\n     {\r\n@@ -2481,6 +2481,9 @@ bool PeerManagerImpl::CheckHeadersAreContinuous(const std::vector<CBlockHeader>&\r\n \r\n bool PeerManagerImpl::IsContinuationOfLowWorkHeadersSync(Peer& peer, CNode& pfrom, std::vector<CBlockHeader>& headers)\r\n {\r\n+    AssertLockHeld(peer.m_headers_sync_mutex);\r\n+    AssertLockNotHeld(m_headers_presync_mutex);\r\n     if (peer.m_headers_sync) {\r\n         auto result = peer.m_headers_sync->ProcessNextHeaders(headers, headers.size() == MAX_HEADERS_RESULTS);\r\n         if (result.request_more) {\r\n@@ -2494,13 +2497,12 @@ bool PeerManagerImpl::IsContinuationOfLowWorkHeadersSync(Peer& peer, CNode& pfro\r\n                 // it may be possible to bypass this via compactblock\r\n                 // processing, so check the result before logging just to be\r\n                 // safe.\r\n-                bool sent_getheaders = MaybeSendGetHeaders(pfrom, locator, peer);\r\n-                if (sent_getheaders) {\r\n+                if (MaybeSendGetHeaders(pfrom, locator, peer)) {\r\n                     LogPrint(BCLog::NET, \"more getheaders (from %s) to peer=%d\\n\",\r\n-                            locator.vHave.front().ToString(), pfrom.GetId());\r\n+                             locator.vHave.front().ToString(), pfrom.GetId());\r\n                 } else {\r\n                     LogPrint(BCLog::NET, \"error sending next getheaders (from %s) to continue sync with peer=%d\\n\",\r\n-                            locator.vHave.front().ToString(), pfrom.GetId());\r\n+                             locator.vHave.front().ToString(), pfrom.GetId());\r\n                 }\r\n             }\r\n         }\r\n@@ -2567,6 +2569,9 @@ bool PeerManagerImpl::IsContinuationOfLowWorkHeadersSync(Peer& peer, CNode& pfro\r\n \r\n bool PeerManagerImpl::TryLowWorkHeadersSync(Peer& peer, CNode& pfrom, const CBlockIndex* chain_start_header, std::vector<CBlockHeader>& headers)\r\n {\r\n+    AssertLockNotHeld(peer.m_headers_sync_mutex);\r\n+    AssertLockNotHeld(m_peer_mutex);\r\n+    AssertLockNotHeld(m_headers_presync_mutex);\r\n     // Calculate the total work on this chain.\r\n     arith_uint256 total_work = chain_start_header->nChainWork + CalculateHeadersWork(headers);\r\n \r\n@@ -2609,6 +2614,7 @@ bool PeerManagerImpl::TryLowWorkHeadersSync(Peer& peer, CNode& pfrom, const CBlo\r\n \r\n bool PeerManagerImpl::IsAncestorOfBestHeaderOrTip(const CBlockIndex* header)\r\n {\r\n+    AssertLockHeld(cs_main);\r\n     if (header == nullptr) {\r\n         return false;\r\n     } else if (m_chainman.m_best_header != nullptr && header == m_chainman.m_best_header->GetAncestor(header->nHeight)) {\r\n@@ -2767,7 +2773,7 @@ void PeerManagerImpl::ProcessHeadersMessage(CNode& pfrom, Peer& peer,\r\n                                             std::vector<CBlockHeader>&& headers,\r\n                                             bool via_compact_block)\r\n {\r\n+    AssertLockNotHeld(m_headers_presync_mutex);\r\n     size_t nCount = headers.size();\r\n \r\n     if (nCount == 0) {\r\n@@ -3166,9 +3172,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n                                      const std::chrono::microseconds time_received,\r\n                                      const std::atomic<bool>& interruptMsgProc)\r\n {\r\n+    AssertLockNotHeld(m_headers_presync_mutex);\r\n \r\n     LogPrint(BCLog::NET, \"received: %s (%u bytes) peer=%d\\n\", SanitizeString(msg_type), vRecv.size(), pfrom.GetId());\r\n```\r\n</p></details>\r\n\r\nFeel free to ignore. I also have a branch ready at https://github.com/bitcoin/bitcoin/compare/master...jonatack:bitcoin:net-add-missing-thread-safety-runtime-assertions for all the net and net_processing code and mention above only the runtime lock assertions directly related to changes in #25717.\r\n\r\nEdit: updated with additional missing lock assertions.",
      "created_at" : "2022-08-30T17:15:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1231945261",
      "id" : 1231945261,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585Jbf4t",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1231945261/reactions"
      },
      "updated_at" : "2022-08-30T19:50:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1231945261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25960#discussion_r958805651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958805651"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, fixed.",
      "commit_id" : "94af3e43e20aa00b18e7a3f6d0f5fe3ad9494d97",
      "created_at" : "2022-08-30T18:30:56Z",
      "diff_hunk" : "@@ -40,17 +40,32 @@ def setup_network(self):\n     def disconnect_all(self):\n         self.disconnect_nodes(0, 1)\n         self.disconnect_nodes(0, 2)\n+        self.disconnect_nodes(0, 3)\n \n     def reconnect_all(self):\n         self.connect_nodes(0, 1)\n         self.connect_nodes(0, 2)\n+        self.connect_nodes(0, 3)\n \n     def test_chains_sync_when_long_enough(self):\n         self.log.info(\"Generate blocks on the node with no required chainwork, and verify nodes 1 and 2 have no new headers in their headers tree\")\n         with self.nodes[1].assert_debug_log(expected_msgs=[\"[net] Ignoring low-work chain (height=14)\"]), self.nodes[2].assert_debug_log(expected_msgs=[\"[net] Ignoring low-work chain (height=14)\"]):\n             self.generate(self.nodes[0], NODE1_BLOCKS_REQUIRED-1, sync_fun=self.no_op)\n \n-        for node in self.nodes[1:]:\n+        # Node3 should always allow headers due to noban permissions\n+        self.log.info(\"Check that node3 will sync headers (due to noban permissions)\")\n+        def check_node3_chaintips(num_tips, tip_hash, height):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#discussion_r958805651",
      "id" : 958805651,
      "in_reply_to_id" : 958731326,
      "line" : 58,
      "node_id" : "PRRC_kwDOABII5845JjaT",
      "original_commit_id" : "1206e2deb2f47419dd75300a78315d7964c0e8ee",
      "original_line" : 58,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/p2p_headers_sync_with_minchainwork.py",
      "position" : 32,
      "pull_request_review_id" : 1090789846,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958805651/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-30T18:30:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/958805651",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25960#discussion_r959259994"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/959259994"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: after this change`trustworthy_work` or something could be more accurate, although I'm not sure it actually benefits the readers.",
      "commit_id" : "94af3e43e20aa00b18e7a3f6d0f5fe3ad9494d97",
      "created_at" : "2022-08-31T07:42:01Z",
      "diff_hunk" : "@@ -2820,6 +2820,13 @@ void PeerManagerImpl::ProcessHeadersMessage(CNode& pfrom, Peer& peer,\n         }\n     }\n \n+    // If our peer has NetPermissionFlags::NoBan privileges, then bypass our\n+    // anti-DoS logic (this saves bandwidth when we connect to a trusted peer\n+    // on startup).\n+    if (pfrom.HasPermission(NetPermissionFlags::NoBan)) {\n+        already_validated_work = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#discussion_r959259994",
      "id" : 959259994,
      "line" : 2827,
      "node_id" : "PRRC_kwDOABII5845LSVa",
      "original_commit_id" : "e5982ecdc4650e9b6de38f190f3a97d792499e2a",
      "original_line" : 2827,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 8,
      "pull_request_review_id" : 1091428447,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/959259994/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-31T07:42:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/959259994",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "tACK 94af3e43e20aa00b18e7a3f6d0f5fe3ad9494d97\r\n\r\nI checked that `NoBan` peers indeed sync in a single pass now.\r\n\r\nThe `download` permission might be more suitable for this (and it's implied by `noban`). In any case it's not a very useful optimisation, but I'm not opposed to it.",
      "created_at" : "2022-08-31T09:32:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1232701349",
      "id" : 1232701349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585JeYel",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1232701349/reactions"
      },
      "updated_at" : "2022-08-31T11:52:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1232701349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The `download` permission might be more suitable for this\r\n\r\nFor what it's worth, I interpret `download` as being more in the other direction -- \"this peer can download from me, even if I'm in IBD\" rather than \"I feel safe downloading from this peer\", so it seemed less suitable to me. But :shrug:",
      "created_at" : "2022-08-31T14:41:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1233029884",
      "id" : 1233029884,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585Jfor8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233029884/reactions"
      },
      "updated_at" : "2022-08-31T14:41:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233029884",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25960#discussion_r959689558"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25960"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/959689558"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You could make this a scripted diff:\r\n\r\n```\r\n-BEGIN VERIFY SCRIPT-\r\nsed -i '/headerssync/Id' src/logging.h src/logging.cpp\r\nsed -i 's/BCLog::HEADERSSYNC/BCLog::NET/g' $(git grep -l BCLog::HEADERSSYNC)\r\n-END VERIFY SCRIPT-\r\n```",
      "commit_id" : "94af3e43e20aa00b18e7a3f6d0f5fe3ad9494d97",
      "created_at" : "2022-08-31T14:53:53Z",
      "diff_hunk" : "@@ -65,7 +65,6 @@ namespace BCLog {\n #endif\n         UTIL        = (1 << 25),\n         BLOCKSTORE  = (1 << 26),\n-        HEADERSSYNC = (1 << 27),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#discussion_r959689558",
      "id" : 959689558,
      "line" : 68,
      "node_id" : "PRRC_kwDOABII5845M7NW",
      "original_commit_id" : "132ed7eaaa4a47ab94db72ebfab0ef0e03caa488",
      "original_line" : 68,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/logging.h",
      "position" : 4,
      "pull_request_review_id" : 1092033757,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25960",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/959689558/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-31T14:53:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/959689558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "We should probably document what we mean by these permissions :-)",
      "created_at" : "2022-08-31T15:46:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1233113908",
      "id" : 1233113908,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585Jf9M0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233113908/reactions"
      },
      "updated_at" : "2022-08-31T15:46:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233113908",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> We should probably document what we mean by these permissions :-)\r\n\r\nThey're documented in `bitcoin-cli help getpeerinfo`:\r\n\r\n```\r\n    \"permissions\" : [                     (json array) Any special permissions that have been granted to this peer\r\n      \"str\",                              (string) bloomfilter (allow requesting BIP37 filtered blocks and transactions),\r\n                                          noban (do not ban for misbehavior; implies download),\r\n                                          forcerelay (relay transactions that are already in the mempool; implies relay),\r\n                                          relay (relay even in -blocksonly mode, and unlimited transaction announcements),\r\n                                          mempool (allow requesting BIP35 mempool contents),\r\n                                          download (allow getheaders during IBD, no disconnect after maxuploadtarget limit),\r\n                                          addr (responses to GETADDR avoid hitting the cache and contain random records with the most up-to-date info).\r\n                                          \r\n      ...\r\n    ],\r\n```\r\n\r\nand in `bitcoind -help` under `-whitebind`.",
      "created_at" : "2022-08-31T15:55:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1233124338",
      "id" : 1233124338,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585Jf_vy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233124338/reactions"
      },
      "updated_at" : "2022-08-31T15:55:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233124338",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, in that case I tend to agree `noban` is better. I guess `download` should have been called `upload`, but that depends on the perspective :-)",
      "created_at" : "2022-08-31T16:00:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1233129603",
      "id" : 1233129603,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585JgBCD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233129603/reactions"
      },
      "updated_at" : "2022-08-31T16:01:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233129603",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 94af3e43e20aa00b18e7a3f6d0f5fe3ad9494d97",
      "created_at" : "2022-08-31T18:35:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1233282226",
      "id" : 1233282226,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585JgmSy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233282226/reactions"
      },
      "updated_at" : "2022-08-31T18:35:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233282226",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 94af3e43e20aa00b18e7a3f6d0f5fe3ad9494d97",
      "created_at" : "2022-08-31T19:00:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1233312146",
      "id" : 1233312146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585JgtmS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233312146/reactions"
      },
      "updated_at" : "2022-08-31T19:00:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233312146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23443](https://github.com/bitcoin/bitcoin/pull/23443) (p2p: Erlay support signaling by naumenkogs)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-08-31T19:24:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1233333892",
      "id" : 1233333892,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585Jgy6E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233333892/reactions"
      },
      "updated_at" : "2022-08-31T19:24:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233333892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 94af3e43e20aa00b18e7a3f6d0f5fe3ad9494d97",
      "created_at" : "2022-09-01T06:02:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25960#issuecomment-1233781073",
      "id" : 1233781073,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25960",
      "node_id" : "IC_kwDOABII585JigFR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233781073/reactions"
      },
      "updated_at" : "2022-09-01T06:02:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1233781073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   }
]
