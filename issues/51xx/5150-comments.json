[
   {
      "author_association" : "MEMBER",
      "body" : "I'm not entirely sure why that discrimination on port number exists in the first place. Is this an anti-Sybil measure?\n",
      "created_at" : "2014-10-27T20:42:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5150#issuecomment-60665683",
      "id" : 60665683,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5150",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjY1Njgz",
      "performed_via_github_app" : null,
      "updated_at" : "2014-10-27T20:42:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60665683",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I don't think it's anti sybil, just above it's also avoiding connecting to nodes in ranges which it is already connected, wouldn't that preclude connecting to the same peer twice on different ports? \n\nThe line was added by @sipa in #787, though there's no explanation of why that limit exists.\n",
      "created_at" : "2014-10-27T22:25:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5150#issuecomment-60680394",
      "id" : 60680394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5150",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjgwMzk0",
      "performed_via_github_app" : null,
      "updated_at" : "2014-10-27T22:25:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60680394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=4",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "node_id" : "MDQ6VXNlcjEwMTM3",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, it is an anti-Sybil measure, and has been in the code for as long as I've been around.\n",
      "created_at" : "2014-10-27T23:05:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5150#issuecomment-60685291",
      "id" : 60685291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5150",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjg1Mjkx",
      "performed_via_github_app" : null,
      "updated_at" : "2014-10-27T23:05:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60685291",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=4",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK, we should warn people about this behavior.\n",
      "created_at" : "2014-10-27T23:22:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5150#issuecomment-60686986",
      "id" : 60686986,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5150",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjg2OTg2",
      "performed_via_github_app" : null,
      "updated_at" : "2014-10-27T23:22:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60686986",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "node_id" : "MDQ6VXNlcjY0OTI0Ng==",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No, it's to prevent spamming addr messages with eg IP:80 to the network, and have the entire Bitcoin network DoS attack that service. The same risk exists for Bitcoin itself of course, but I guess we try to be more polite to others. It's been there since before addrman (though the mechanism was different then).\n",
      "created_at" : "2014-10-28T03:59:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5150#issuecomment-60706987",
      "id" : 60706987,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5150",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNzA2OTg3",
      "performed_via_github_app" : null,
      "updated_at" : "2014-10-28T03:59:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60706987",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "That makes sense, thank you Sipa. From a users perspective it's a little unintuitive, I wouldn't have expected that behavior at all when setting up a listening Bitcoin daemon.\n",
      "created_at" : "2014-10-28T05:28:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5150#issuecomment-60711583",
      "id" : 60711583,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5150",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNzExNTgz",
      "performed_via_github_app" : null,
      "updated_at" : "2014-10-28T05:28:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60711583",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=4",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "node_id" : "MDQ6VXNlcjEwMTM3",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "OK, looking at this discussion we should warn _and_ add @sipa's reply as comment why this is here in the first place.\n",
      "created_at" : "2014-10-28T06:33:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5150#issuecomment-60715119",
      "id" : 60715119,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5150",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNzE1MTE5",
      "performed_via_github_app" : null,
      "updated_at" : "2014-10-28T06:33:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60715119",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> No, it's to prevent spamming addr messages with eg IP:80 to the network, and have the entire Bitcoin network DoS attack that service.\r\n\r\nI don't see how such a DoS could be carried out.\r\n\r\n* Assume 50k nodes.\r\n* Each node has around 50k addresses in their addrman (everybody knows about mostly everybody else).\r\n* One of the 50k addresses is `victim:80`, gossiped by a malicious actor.\r\n* Lets assume all 50k nodes try to open a new connection to a random address from their addrman (size 50k), how many nodes will attempt to connect to `victim:80`? One (1/50k chance, multiplied by 50k attempts).\r\n* How often will this happen? Assuming all nodes keep trying to open new connections all the time, then this will happen once per 0.5s:\r\nhttps://github.com/bitcoin/bitcoin/blob/8837f1ebde0537b0fdfa1353d06ae8e61a259982/src/net.cpp#L1813\r\n* Is one connection per 0.5s DoS? Probably not.\r\n* Note that the above assumption of all nodes trying to open new connections all the time is not correct. Once a node has 8 (is configurable) outbound connections, it will stop opening new connections. So the above 0.5s is maybe a few seconds or even higher in practice.\r\n\r\nThis can be confirmed by observing a node that is listening on port 8333 and whose address is well propagated (has been online for a long time) and seeing how often it receives incoming connections. I have a long-running node but it is listening on non-default port, so I can't confirm that myself.\r\n\r\nDid I oversimplify or get something wrong?",
      "created_at" : "2021-06-03T13:55:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5150#issuecomment-853888909",
      "id" : 853888909,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5150",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1Mzg4ODkwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-03T13:55:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/853888909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   }
]
