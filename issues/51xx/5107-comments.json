[
   {
      "body" : "One small nit before actual review: you're committing a Makefile to the repository.",
      "created_at" : "2014-10-20T05:56:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#issuecomment-59686671",
      "id" : 59686671,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5107",
      "updated_at" : "2014-10-20T05:56:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59686671",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Doh - dunno how that got in there...should be fixed now.",
      "created_at" : "2014-10-20T06:31:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#issuecomment-59688671",
      "id" : 59688671,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5107",
      "updated_at" : "2014-10-20T06:31:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59688671",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/894059?v=3",
         "events_url" : "https://api.github.com/users/CodeShark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/CodeShark/followers",
         "following_url" : "https://api.github.com/users/CodeShark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/CodeShark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/CodeShark",
         "id" : 894059,
         "login" : "CodeShark",
         "organizations_url" : "https://api.github.com/users/CodeShark/orgs",
         "received_events_url" : "https://api.github.com/users/CodeShark/received_events",
         "repos_url" : "https://api.github.com/users/CodeShark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/CodeShark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/CodeShark"
      }
   },
   {
      "body" : "Before these commits, the getblocktemplate thread was being woken up before joining the thread. I had moved the signal to the end of StopRPCThreads, but I think we could end up with a deadlock if we wait to signal until after joining the thread.",
      "created_at" : "2014-10-20T08:24:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#issuecomment-59704348",
      "id" : 59704348,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5107",
      "updated_at" : "2014-10-20T08:29:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59704348",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/894059?v=3",
         "events_url" : "https://api.github.com/users/CodeShark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/CodeShark/followers",
         "following_url" : "https://api.github.com/users/CodeShark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/CodeShark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/CodeShark",
         "id" : 894059,
         "login" : "CodeShark",
         "organizations_url" : "https://api.github.com/users/CodeShark/orgs",
         "received_events_url" : "https://api.github.com/users/CodeShark/received_events",
         "repos_url" : "https://api.github.com/users/CodeShark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/CodeShark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/CodeShark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19078795"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19078795"
         }
      },
      "body" : "Please either remove these debugging statements or replace them with category-specific LogPrint()",
      "commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "created_at" : "2014-10-20T11:12:10Z",
      "diff_hunk" : "@@ -215,6 +215,28 @@ bool static Bind(const CService &addr, unsigned int flags) {\n     return true;\n }\n \n+void OnRPCStopped()\n+{\n+    cvBlockChange.notify_all();\n+    LogPrintf(\"RPC stopped.\\n\");\n+}\n+\n+void OnRPCPreCommand(const CRPCCommand& cmd)\n+{\n+    LogPrintf(\"pre-RPC command: %s\\n\", cmd.name.c_str()); ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19078795",
      "id" : 19078795,
      "original_commit_id" : "f9315d07930f8d32946dc40f4f3605f7e78ccbbe",
      "original_position" : 12,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107",
      "updated_at" : "2014-10-28T06:08:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19078795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19120913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19120913"
         }
      },
      "body" : "I'll remove all LogPrint() once we've tested.",
      "commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "created_at" : "2014-10-20T23:18:08Z",
      "diff_hunk" : "@@ -215,6 +215,28 @@ bool static Bind(const CService &addr, unsigned int flags) {\n     return true;\n }\n \n+void OnRPCStopped()\n+{\n+    cvBlockChange.notify_all();\n+    LogPrintf(\"RPC stopped.\\n\");\n+}\n+\n+void OnRPCPreCommand(const CRPCCommand& cmd)\n+{\n+    LogPrintf(\"pre-RPC command: %s\\n\", cmd.name.c_str()); ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19120913",
      "id" : 19120913,
      "original_commit_id" : "f9315d07930f8d32946dc40f4f3605f7e78ccbbe",
      "original_position" : 12,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107",
      "updated_at" : "2014-10-28T06:08:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19120913",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/894059?v=3",
         "events_url" : "https://api.github.com/users/CodeShark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/CodeShark/followers",
         "following_url" : "https://api.github.com/users/CodeShark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/CodeShark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/CodeShark",
         "id" : 894059,
         "login" : "CodeShark",
         "organizations_url" : "https://api.github.com/users/CodeShark/orgs",
         "received_events_url" : "https://api.github.com/users/CodeShark/received_events",
         "repos_url" : "https://api.github.com/users/CodeShark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/CodeShark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/CodeShark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19140474"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140474"
         }
      },
      "body" : "Nit: Can you make this a 2-liner? Same nit for the change below.",
      "commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "created_at" : "2014-10-21T10:44:05Z",
      "diff_hunk" : "@@ -70,6 +70,11 @@ Value getinfo(const Array& params, bool fHelp)\n             + HelpExampleRpc(\"getinfo\", \"\")\n         );\n \n+    ENTER_CRITICAL_SECTION(cs_main);\n+#ifdef ENABLE_WALLET\n+    if (pwalletMain) ENTER_CRITICAL_SECTION(pwalletMain->cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19140474",
      "id" : 19140474,
      "original_commit_id" : "e7118f17657549aa5671e0658aaddb6f05052e03",
      "original_position" : 6,
      "path" : "src/rpcmisc.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107",
      "updated_at" : "2014-10-28T06:08:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140474",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19140493"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140493"
         }
      },
      "body" : "Nit: random should be placed where main was (alphabetical ordering).",
      "commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "created_at" : "2014-10-21T10:44:40Z",
      "diff_hunk" : "@@ -7,9 +7,9 @@\n \n #include \"base58.h\"\n #include \"init.h\"\n-#include \"main.h\"\n #include \"ui_interface.h\"\n #include \"util.h\"\n+#include \"random.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19140493",
      "id" : 19140493,
      "original_commit_id" : "e7118f17657549aa5671e0658aaddb6f05052e03",
      "original_position" : 7,
      "path" : "src/rpcserver.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107",
      "updated_at" : "2014-10-28T06:08:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140493",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19140515"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140515"
         }
      },
      "body" : "Nit: Should be above thread (alphabetical ordering).",
      "commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "created_at" : "2014-10-21T10:45:21Z",
      "diff_hunk" : "@@ -24,12 +24,14 @@\n #include <boost/iostreams/stream.hpp>\n #include <boost/shared_ptr.hpp>\n #include <boost/thread.hpp>\n+#include <boost/signals2/signal.hpp>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19140515",
      "id" : 19140515,
      "original_commit_id" : "e7118f17657549aa5671e0658aaddb6f05052e03",
      "original_position" : 15,
      "path" : "src/rpcserver.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107",
      "updated_at" : "2014-10-28T06:08:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140515",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19140539"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140539"
         }
      },
      "body" : "Nit: Should be above std (alphabetical ordering).",
      "commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "created_at" : "2014-10-21T10:45:51Z",
      "diff_hunk" : "@@ -24,12 +24,14 @@\n #include <boost/iostreams/stream.hpp>\n #include <boost/shared_ptr.hpp>\n #include <boost/thread.hpp>\n+#include <boost/signals2/signal.hpp>\n #include \"json/json_spirit_writer_template.h\"\n \n using namespace boost;\n using namespace boost::asio;\n using namespace json_spirit;\n using namespace std;\n+using namespace RPCServer;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19140539",
      "id" : 19140539,
      "original_commit_id" : "e7118f17657549aa5671e0658aaddb6f05052e03",
      "original_position" : 22,
      "path" : "src/rpcserver.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107",
      "updated_at" : "2014-10-28T06:08:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19140539",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19194585"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19194585"
         }
      },
      "body" : "This should be seen as a minimally-invasive temporary fix, allowing us to use RAII on mutexes whose existence we can only know about at runtime (i.e. pwalletMain->cs_wallet).\r\n\r\nThe permanent fix will be to move all functionality depending on pwalletMain->cs_wallet into separate functions altogether - or perhaps to encapsulate locking within the wallet class itself.",
      "commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "created_at" : "2014-10-22T05:07:20Z",
      "diff_hunk" : "@@ -142,6 +142,17 @@ class CMutexLock\n             Enter(pszName, pszFile, nLine);\n     }\n \n+    CMutexLock(Mutex* pmutexIn, const char* pszName, const char* pszFile, int nLine, bool fTry = false)\n+    {\n+        if (!pmutexIn) return;\n+\n+        lock = boost::unique_lock<Mutex>(*pmutexIn, boost::defer_lock);\n+        if (fTry)\n+            TryEnter(pszName, pszFile, nLine);\n+        else\n+            Enter(pszName, pszFile, nLine);\n+    }\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19194585",
      "id" : 19194585,
      "original_commit_id" : "c1f7bb600acbf9373a2b68bc7beaf50de080dedd",
      "original_position" : 14,
      "path" : "src/sync.h",
      "position" : 14,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107",
      "updated_at" : "2014-10-28T06:08:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19194585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/894059?v=3",
         "events_url" : "https://api.github.com/users/CodeShark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/CodeShark/followers",
         "following_url" : "https://api.github.com/users/CodeShark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/CodeShark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/CodeShark",
         "id" : 894059,
         "login" : "CodeShark",
         "organizations_url" : "https://api.github.com/users/CodeShark/orgs",
         "received_events_url" : "https://api.github.com/users/CodeShark/received_events",
         "repos_url" : "https://api.github.com/users/CodeShark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/CodeShark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/CodeShark"
      }
   },
   {
      "body" : "Concept ACK, I now like the approach you take to pushing down the locks.\r\n\r\n(someone will have to verify that all the RPC methods get the right locks, but this is easier to review than functional changes inside the methods)\r\n",
      "created_at" : "2014-10-22T09:23:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#issuecomment-60057946",
      "id" : 60057946,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5107",
      "updated_at" : "2014-10-22T09:23:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60057946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I checked locking for all RPC calls after your change.\r\n\r\n## Non-threadsafe RPC functions \r\naccording to the table in https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcserver.cpp :\r\n\r\n- `getinfo`: locks cs_main, and cs_wallet if there is a wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmisc.cpp#L74\r\n- `signrawtransaction`: locks cs_main, and cs_wallet if there is a wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcrawtransaction.cpp#L546\r\n- `validateaddress`: locks cs_main, and cs_wallet if there is a wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmisc.cpp#L182\r\n- `getnetworkinfo`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcnet.cpp#L415\r\n- `getconnectioncount`: locks cs_main and cs_vNodes, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcnet.cpp#L36\r\n- `getpeerinfo`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcnet.cpp#L116\r\n- `ping`: locks cs_main and cs_vNodes, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcnet.cpp#L55\r\n- `getblockchaininfo`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L474\r\n- `getbestblockhash`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L115\r\n- `getblockcount`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L98\r\n- `getblock`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L277\r\n- `getblockhash`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L231\r\n- `getchaintips`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L527\r\n- `getdifficulty`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L132\r\n- `getrawmempool`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L169\r\n- `gettxout`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L383\r\n- `gettxoutsetinfo`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L328\r\n- `verifychain`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcblockchain.cpp#L441\r\n- `getblocktemplate`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmining.cpp#L356\r\n- `getmininginfo`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmining.cpp#L238\r\n- `getnetworkhashps`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmining.cpp#L88\r\n- `prioritisetransaction`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmining.cpp#L280\r\n- `getgenerate`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmining.cpp#L108\r\n- `gethashespersec`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmining.cpp#L203\r\n- `createrawtransaction`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcrawtransaction.cpp#L341\r\n- `decoderawtransaction`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcrawtransaction.cpp#L437\r\n- `decodescript`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcrawtransaction.cpp#L477\r\n- `getrawtransaction`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcrawtransaction.cpp#L174\r\n- `sendrawtransaction`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcrawtransaction.cpp#L739\r\n- `verifymessage`: locks cs_main, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcmisc.cpp#L340\r\n\r\n## Threadsafe RPC functions:\r\n\r\n- `help`: No lock as expected\r\n- `stop`: No lock as expected\r\n- `addnode`: No lock as expected\r\n- `getaddednodeinfo`: No lock as expected\r\n- `getnettotals`: No lock as expected\r\n- `getmempoolinfo`: No lock as expected\r\n- `submitblock`: No lock as expected\r\n- `setgenerate`: No lock as expected\r\n- `createmultisig`: No lock as expected\r\n- `estimatefee`: No lock as expected\r\n- `estimatepriority`: No lock as expected\r\n\r\n## Wallet:\r\n\r\n- `addmultisigaddress`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L946\r\n- `backupwallet`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1622\r\n- `dumpprivkey`: **Locks missing**, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcdump.cpp#L323\r\n- `dumpwallet`: **Locks missing**, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcdump.cpp#L352\r\n- `encryptwallet`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1835\r\n- `getaccountaddress`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L171\r\n- `getaccount`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L273\r\n- `getaddressesbyaccount`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L305\r\n- `getbalance`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L640\r\n- `getnewaddress`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L95\r\n- `getrawchangeaddress`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L197\r\n- `getreceivedbyaccount`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L548\r\n- `getreceivedbyaddress`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L493\r\n- `gettransaction`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1572\r\n- `getunconfirmedbalance`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L695\r\n- `getwalletinfo`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L2036\r\n- `importprivkey`: **locks missing**, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcdump.cpp#L94\r\n- `importwallet`: **locks missing**, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcdump.cpp#L225\r\n- `importaddress`: **locks missing**, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcdump.cpp#L160\r\n- `keypoolrefill`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1646\r\n- `listaccounts`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1394\r\n- `listaddressgroupings`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L394\r\n- `listlockunspent`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1972\r\n- `listreceivedbyaccount`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1156\r\n- `listreceivedbyaddress`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1123\r\n- `listsinceblock`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1484\r\n- `listtransactions`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1312\r\n- `listunspent`: **Locks missing**, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcrawtransaction.cpp#L237\r\n- `lockunspent`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1901\r\n- `move`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L723\r\n- `sendfrom`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L797\r\n- `sendmany`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L859\r\n- `sendtoaddress`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L344\r\n- `setaccount`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L229\r\n- `settxfee`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L2005\r\n- `signmessage`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L441\r\n- `walletlock`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1792\r\n- `walletpassphrasechange`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1744\r\n- `walletpassphrase`: locks cs_main and cs_wallet, https://github.com/CodeShark/bitcoin/blob/No_main_in_rpcserver/src/rpcwallet.cpp#L1695\r\n\r\nConclusion:\r\n- Locks missing in `dumpprivkey`, `dumpwallet`, `importprivkey`, `importwallet`, `importaddress` (rpcdump.cpp)\r\n- Locks missing in `listunspent` (rpcrawtransaction.cpp)\r\n- All other functions have the necessary locks",
      "created_at" : "2014-10-27T17:32:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#issuecomment-60634011",
      "id" : 60634011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5107",
      "updated_at" : "2014-10-27T17:39:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60634011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19617467"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19617467"
         }
      },
      "body" : "Not sure where to move them otherwise (probably a bitcoin-specific RPC server module, where the method registration belongs too) but it's not very nice to have these RPC-specific implementation functions in init.cpp",
      "commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "created_at" : "2014-10-30T16:39:44Z",
      "diff_hunk" : "@@ -215,6 +215,26 @@ bool static Bind(const CService &addr, unsigned int flags) {\n     return true;\n }\n \n+void OnRPCStopped()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#discussion_r19617467",
      "id" : 19617467,
      "original_commit_id" : "3394388ef09cdeab3294dfb73a0591205cf41cfe",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5107",
      "updated_at" : "2014-10-30T16:39:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19617467",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "utACK, going to test this",
      "created_at" : "2014-10-30T16:48:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#issuecomment-61126147",
      "id" : 61126147,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5107",
      "updated_at" : "2014-10-30T16:48:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61126147",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2014-11-04T13:39:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#issuecomment-61640105",
      "id" : 61640105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5107",
      "updated_at" : "2014-11-04T13:39:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61640105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Closing in favor of rebased #5711",
      "created_at" : "2015-01-26T12:56:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5107#issuecomment-71456662",
      "id" : 71456662,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5107",
      "updated_at" : "2015-01-26T12:56:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71456662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
