[
   {
      "author_association" : "MEMBER",
      "body" : "In which code version do you observe this?\n",
      "created_at" : "2014-10-21T07:17:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5113#issuecomment-59888310",
      "id" : 59888310,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5113",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5ODg4MzEw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59888310/reactions"
      },
      "updated_at" : "2014-10-21T07:17:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59888310",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Current Git header: `64ffc995d685cf8a53ef868572e835ce42269ec6`\n\nMy code contains also private commits, but they only touch the `qa/rpc-tests` folder.\n",
      "created_at" : "2014-10-21T07:22:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5113#issuecomment-59888664",
      "id" : 59888664,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5113",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5ODg4NjY0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59888664/reactions"
      },
      "updated_at" : "2014-10-21T07:22:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59888664",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=4",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "node_id" : "MDQ6VXNlcjQ5NDM2NDQ=",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I ran into this problem as well.  The below code demonstrates it by hanging at `sync_blocks`.   If you switch which node connects to which it tends to change whether it works or not.  I also noticed that if you use `sync_all` it sometimes fails syncing the mempools after syncing the blocks.  I'm not familar enough with the headers first code, but I think the issue is caused by which peer does a getheaders from the other.  This is run from the current master.\n\n``` Python\n#!/usr/bin/env python\n\nfrom test_framework import BitcoinTestFramework\nfrom bitcoinrpc.authproxy import AuthServiceProxy, JSONRPCException\nfrom util import *\nimport time\n\nclass SyncDir(BitcoinTestFramework):\n    def setup_network(self):\n        self.nodes = []\n        self.nodes.append(start_node(0, self.options.tmpdir, [\"-debug\"]))\n        self.nodes.append(start_node(1, self.options.tmpdir, [\"-debug\"]))\n        connect_nodes(self.nodes[1], 0)\n        print(\"Nodes connected\")\n        self.is_network_split = False\n        self.sync_all()\n        random_transaction(self.nodes, Decimal(\"0.001\"), Decimal(\"0.0001\"), 0, 0)\n        print (\"One tx sent\")\n        self.nodes[0].setgenerate(True,1)\n        print (\"Block mined\")\n        self.sync_all()\n        print (\"Chains synced\")\n        stop_node(self.nodes[0],0)\n        print (\"Node stopped\")\n        self.nodes[0] = start_node(3, self.options.tmpdir,[\"-debug\"])\n        print (\"New node created\")\n        connect_nodes(self.nodes[0], 1)  #connect the new node\n        #connect_nodes(self.nodes[1], 3)  #connect the new node\n        print (\"New node connected....\")\n        #self.sync_all()\n        sync_blocks(self.nodes)\n        print (\"New node synced\")\n\n    def run_test(self):\n        print (\"Running test\")\n\nif __name__ == '__main__':\n    SyncDir().main()\n```\n",
      "created_at" : "2014-10-27T01:43:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5113#issuecomment-60542096",
      "id" : 60542096,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5113",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNTQyMDk2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60542096/reactions"
      },
      "updated_at" : "2014-10-27T01:43:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60542096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "node_id" : "MDQ6VXNlcjQzNjAzNDk=",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I believe this is a dup/very related to #5138.\n",
      "created_at" : "2014-10-27T01:58:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5113#issuecomment-60542695",
      "id" : 60542695,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5113",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNTQyNjk1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60542695/reactions"
      },
      "updated_at" : "2014-10-27T01:58:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60542695",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "node_id" : "MDQ6VXNlcjY0OTI0Ng==",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Regarding the `sync_all` problem:  I ran into this myself recently as well.  In my case, the problem is that the blocks are synced but the mempools are not.  This happens (for me) when transactions are put back into the mempool after reorganising - it seems those are not broadcasted to the nodes that always were on the longer chain.\n\nSince I introduced `sync_all`, should I propose another patch?  `sync_all` could be modified to be configurable about what should be synced (blocks and/or mempool), either with an optional argument or with a new member variable.  `join_network` would then only sync blocks and not the mempools.  Sounds like a good idea?  Or should such a change be introduced only together with actual tests that need the fixed behaviour?\n",
      "created_at" : "2014-10-27T06:04:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5113#issuecomment-60553432",
      "id" : 60553432,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5113",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNTUzNDMy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60553432/reactions"
      },
      "updated_at" : "2014-10-27T06:04:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60553432",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=4",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "node_id" : "MDQ6VXNlcjQ5NDM2NDQ=",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Should be fixed by #5157\n",
      "created_at" : "2015-01-08T13:25:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5113#issuecomment-69178258",
      "id" : 69178258,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5113",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MTc4MjU4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/69178258/reactions"
      },
      "updated_at" : "2015-01-08T13:25:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/69178258",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
