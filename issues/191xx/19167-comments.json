[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Some network filesystems simply do not support file locking.\r\n\r\nPossibly this is one of them?",
      "created_at" : "2020-06-07T01:57:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19167#issuecomment-640144283",
      "id" : 640144283,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19167",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MDE0NDI4Mw==",
      "updated_at" : "2020-06-07T01:57:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/640144283",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/620611?v=4",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "node_id" : "MDQ6VXNlcjYyMDYxMQ==",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing this until more information is available. ",
      "created_at" : "2020-08-13T07:26:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19167#issuecomment-673310862",
      "id" : 673310862,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19167",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MzMxMDg2Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-13T07:26:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/673310862",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I wanted to sync a full, non-pruned node on to an Apple Time Capsule storage drive. Thought solving this issue might be useful for others as well. But I hit a wall. Here are my notes in case it's useful for the next person who gets interested in this issue:\r\n\r\n- bitcoind creates a .lock file on datadir\r\n- This is done using the `fcntl` sys call\r\n- Sidenote: Filesystem locks in unix are advisory only. They only really protected against other instances of well-behaved applications. Advisory file locks are made by the OS keeping track of a pid that currently holds the lock. This is more involved over NAS storage because the lock-holding process can be on other network computers as well.\r\n- Apple Time Capsule uses AFP(Apple Filing Protocol) over TCP and `fcntl` does not seem to work as expected.\r\n- Changing the code to use the `is_wsl` workaround in `src/fs.cpp FileLock::TryLock` for AFP allows bitcoind to capture the lock using the `flock` syscall instead of `fcntl`. However, then it seems that the lock is simply ignored by another well-behaved bitcoind process.\r\n- Further down the execution path, leveldb is unable to acquire locks as well. This is likely also because of a similar issue but changing leveldb is likely more involved in time.\r\n- I decided to give up on this approach to run a full node.",
      "created_at" : "2020-09-24T21:19:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19167#issuecomment-698594254",
      "id" : 698594254,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19167",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5ODU5NDI1NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-24T21:19:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/698594254",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/856960?v=4",
         "events_url" : "https://api.github.com/users/dhruv/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dhruv/followers",
         "following_url" : "https://api.github.com/users/dhruv/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dhruv/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dhruv",
         "id" : 856960,
         "login" : "dhruv",
         "node_id" : "MDQ6VXNlcjg1Njk2MA==",
         "organizations_url" : "https://api.github.com/users/dhruv/orgs",
         "received_events_url" : "https://api.github.com/users/dhruv/received_events",
         "repos_url" : "https://api.github.com/users/dhruv/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dhruv/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dhruv"
      }
   }
]
