[
   {
      "author_association" : "MEMBER",
      "body" : "Why drop `checkFinalTx` instead of passing in the right flags to use MTP? I think this change would allow coin selection to include UTXOs from non-final txs which is not really safe behavior IMO.",
      "created_at" : "2022-01-14T17:25:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1013314942",
      "id" : 1013314942,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848ZfV-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013314942/reactions"
      },
      "updated_at" : "2022-01-14T17:25:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013314942",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24080](https://github.com/bitcoin/bitcoin/pull/24080) (policy: Remove unused locktime flags by MarcoFalke)\n* [#20892](https://github.com/bitcoin/bitcoin/pull/20892) (tests: Run both descriptor and legacy tests within a single test invocation by achow101)\n* [#15606](https://github.com/bitcoin/bitcoin/pull/15606) (assumeutxo by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-01-14T18:07:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1013343829",
      "id" : 1013343829,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848ZmZV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013343829/reactions"
      },
      "updated_at" : "2022-01-16T15:03:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013343829",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think this change would allow coin selection to include UTXOs from non-final txs which is not really safe behavior IMO.\r\n\r\nIf coin selection were to include coins that are neither confirmed in the chain nor are in the mempool, then that is a separate bug to fix.",
      "created_at" : "2022-01-15T07:12:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1013630416",
      "id" : 1013630416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848asXQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013630416/reactions"
      },
      "updated_at" : "2022-01-15T07:12:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013630416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think the two issues should be split up. Even if we later add a general \"mempool rejection reason\" to the GUI, the current intended behaviour tells more information (how many blocks left / when it becomes eligible for confirmation). I would prefer fixing that rather than removing it.\r\n\r\nThe second issue seems like a strict bugfix, so should get merged faster/cleaner.",
      "created_at" : "2022-01-15T22:22:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1013763414",
      "id" : 1013763414,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848bM1W",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013763414/reactions"
      },
      "updated_at" : "2022-01-15T22:22:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013763414",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Why drop checkFinalTx instead of passing in the right flags to use MTP?\r\n\r\nUsing the right time for tx.lock_time comparisons would be an improvement, but create even more confusion than it fixes. You'd also have to check nSequence to find non-final txs.\r\n\r\n> GUI, the current intended behaviour tells more information\r\n\r\nFixing this for the GUI will open up trivial DoS vectors for no benefit. To check for nSequence timelocks, the whole utxo set + mempool needs to be scanned for each input for each unconfirmed wallet transaction.\r\nIt is already impossible to use a wallet for large tx counts (#16815, #15148, #7475), so I don't see why we should make that even worse for a feature that has no practical benefit.\r\nIt is currently not possible to add non-final txs to a wallet, since all wallet txs are added either via the chain, via the mempool, or via the internal wallet itself. In all three cases we know the txs to be final. So for a wallet tx to change to the non-final state, one needs to do a reindex/reorg, in which case the tx will be final once the reindex/reorg has finished. (Unless someone is doing a malicious, potentially large reorg, in which case a mouse-over string in a details window of the GUI should be the least of your problems. In fact you wouldn't be able to trust it anyway due to the malicious hashrate.)\r\nAnd for the reindex you can already see when the tx was added to the wallet. As you know it was final at the time it was added, adding a string (Open for %n blocks) is just redundant. For example, if your reindex is currently at year 2015 and there is a tx locked to a block height in 2019, adding a string (open for 123123 blocks) doesn't help the user at all. The user can already tell that 2019 is ahead in the reindex process, which is at 2015.\r\n\r\n> The second issue seems like a strict bugfix, so should get merged faster/cleaner.\r\n\r\nOverall I don't understand why a questionable feature in the GUI is used as an argument against a patch that is:\r\n* a bugfix\r\n* only removes code\r\n* speeds up the wallet/gui",
      "created_at" : "2022-01-16T08:21:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1013831771",
      "id" : 1013831771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848bdhb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013831771/reactions"
      },
      "updated_at" : "2022-01-16T08:21:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013831771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It is currently not possible to add non-final txs to a wallet\r\n\r\nGood point. Concept ACK.\r\n\r\n(This seems like a bug, but probably non-trivial to fix, and it's not like the new behaviour is *wrong*, just less detailed)",
      "created_at" : "2022-01-16T18:37:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1013929090",
      "id" : 1013929090,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848b1SC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013929090/reactions"
      },
      "updated_at" : "2022-01-16T18:37:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013929090",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Interesting pull request. I was able to reproduce the issue using the below steps manually based on test added in `test/functional/wallet_timelock.py`:\r\n\r\n1. Run `bitcoin-qt` (signet) in host machine and virtual machine\r\n2. Get median time for tip:\r\n    ```diff\r\n   getbestblockhash\r\n   \r\n   0000004924aa7d2b938b851b740e5efeb54b4aa1e59a207d1e2a7ad8fddf802d\r\n   \r\n   getblockheader 0000004924aa7d2b938b851b740e5efeb54b4aa1e59a207d1e2a7ad8fddf802d\r\n   \r\n   {\r\n      \"hash\": \"0000004924aa7d2b938b851b740e5efeb54b4aa1e59a207d1e2a7ad8fddf802d\",\r\n      \"confirmations\": 1,\r\n      \"height\": 73295,\r\n      \"version\": 536870912,\r\n      \"versionHex\": \"20000000\",\r\n      \"merkleroot\": \"68d904e541209d287566c3bca783ecdbc4edef56c81be602a7c8b38647a26f76\",\r\n      \"time\": 1642360754,\r\n    ! \"mediantime\": 1642357731,\r\n      \"nonce\": 2927517,\r\n      \"bits\": \"1e016b58\",\r\n      \"difficulty\": 0.002752172677281328,\r\n      \"chainwork\": \"000000000000000000000000000000000000000000000000000000ce943d83c0\",\r\n      \"nTx\": 50,\r\n      \"previousblockhash\": \"0000012e842e76b7d51e8324109f624c952107a33c592b61b8aa408870256a0b\"\r\n    }\r\n\r\n   ```\r\n3. Create a raw transaction to send bitcoin from host to VM and use `locktime = mediantime -1`:\r\n   \r\n   ```\r\n    createrawtransaction \"[{\\\"txid\\\":\\\"cf54ddd4d647073751389dc4e3b41bda6b9c043f59e27e5cc849c22d5eaf7450\\\",\\\"vout\\\":0}]\" \"[{\\\"tb1qqs3sdxqhyzkc6n922slxe49r87d6nyvcc705s8\\\":0.0005}]\" \"1642357730\"    \r\n    ```\r\n4. Once the transaction is confirmed observe the inputs available for a transaction in `bitcoin-qt` based on system time:\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/149676989-b06e17c1-5959-4348-9d91-adee88dd4807.png)\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/149677049-110ae83a-39c3-4fb8-a482-ab1943c684c3.png)\r\n\r\n    \r\n    ",
      "created_at" : "2022-01-16T21:39:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1013957606",
      "id" : 1013957606,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848b8Pm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013957606/reactions"
      },
      "updated_at" : "2022-01-16T21:43:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013957606",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "partial ACK fa73381a88d7b650c01f4e098ec68c96f1a4485b\r\n\r\nPartial because I ignored the GUI commit. Otherwise reviewed the code and confirmed that the tests fail on master.",
      "created_at" : "2022-01-22T17:13:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1019311816",
      "id" : 1019311816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848wXbI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019311816/reactions"
      },
      "updated_at" : "2022-01-22T17:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019311816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790700595"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790700595"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in dddd05e7a3389fcbd90bb4acdfe1f59945d9f381:\r\n\r\nIIUC this reduces the possible statuses by eliminating the \"Open Until X Block\" and \"Open Until Y Timestamps\" possibilities. So you can also get rid of the `qint64 open_for` member (on L56)?",
      "commit_id" : "fa73381a88d7b650c01f4e098ec68c96f1a4485b",
      "created_at" : "2022-01-24T12:36:27Z",
      "diff_hunk" : "@@ -30,8 +30,6 @@ class TransactionStatus\n     enum Status {\n         Confirmed,          /**< Have 6 or more confirmations (normal tx) or fully mature (mined tx) **/\n         /// Normal (sent/received) transactions\n-        OpenUntilDate,      /**< Transaction not yet final, waiting for date */\n-        OpenUntilBlock,     /**< Transaction not yet final, waiting for block */\n         Unconfirmed,        /**< Not yet mined into a block **/\n         Confirming,         /**< Confirmed, but waiting for the recommended number of confirmations **/\n         Conflicted,         /**< Conflicts with other transaction or mempool **/",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790700595",
      "id" : 790700595,
      "line" : 35,
      "node_id" : "PRRC_kwDOABII584vISIz",
      "original_commit_id" : "dddd05e7a3389fcbd90bb4acdfe1f59945d9f381",
      "original_line" : 35,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/qt/transactionrecord.h",
      "position" : 8,
      "pull_request_review_id" : 860892080,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790700595/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-24T13:33:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790700595",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790702615"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790702615"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in dddd05e7a3389fcbd90bb4acdfe1f59945d9f381:\r\n\r\nWow Concept ACK, it seems extremely out of place that the gui is trying to clumsily apply consensus rules over here... is there a way for it to ask the node \"when will this transaction be final\" or?",
      "commit_id" : "fa73381a88d7b650c01f4e098ec68c96f1a4485b",
      "created_at" : "2022-01-24T12:39:16Z",
      "diff_hunk" : "@@ -179,21 +179,8 @@ void TransactionRecord::updateStatus(const interfaces::WalletTxStatus& wtx, cons\n     status.depth = wtx.depth_in_main_chain;\n     status.m_cur_block_hash = block_hash;\n \n-    const bool up_to_date = ((int64_t)QDateTime::currentMSecsSinceEpoch() / 1000 - block_time < MAX_BLOCK_TIME_GAP);\n-    if (up_to_date && !wtx.is_final) {\n-        if (wtx.lock_time < LOCKTIME_THRESHOLD) {\n-            status.status = TransactionStatus::OpenUntilBlock;\n-            status.open_for = wtx.lock_time - numBlocks;\n-        }\n-        else\n-        {\n-            status.status = TransactionStatus::OpenUntilDate;\n-            status.open_for = wtx.lock_time;\n-        }\n-    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790702615",
      "id" : 790702615,
      "line" : 193,
      "node_id" : "PRRC_kwDOABII584vISoX",
      "original_commit_id" : "dddd05e7a3389fcbd90bb4acdfe1f59945d9f381",
      "original_line" : 193,
      "original_position" : 15,
      "original_start_line" : 183,
      "path" : "src/qt/transactionrecord.cpp",
      "position" : 15,
      "pull_request_review_id" : 860892080,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790702615/reactions"
      },
      "side" : "LEFT",
      "start_line" : 183,
      "start_side" : "LEFT",
      "updated_at" : "2022-01-24T13:33:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790702615",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790760103"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790760103"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Currently there is no such function, but someone could write one based on the here removed `checkFinalTx`. Obviously needs to take into account nSequence as well, instead of just nLockTime.",
      "commit_id" : "fa73381a88d7b650c01f4e098ec68c96f1a4485b",
      "created_at" : "2022-01-24T13:48:56Z",
      "diff_hunk" : "@@ -179,21 +179,8 @@ void TransactionRecord::updateStatus(const interfaces::WalletTxStatus& wtx, cons\n     status.depth = wtx.depth_in_main_chain;\n     status.m_cur_block_hash = block_hash;\n \n-    const bool up_to_date = ((int64_t)QDateTime::currentMSecsSinceEpoch() / 1000 - block_time < MAX_BLOCK_TIME_GAP);\n-    if (up_to_date && !wtx.is_final) {\n-        if (wtx.lock_time < LOCKTIME_THRESHOLD) {\n-            status.status = TransactionStatus::OpenUntilBlock;\n-            status.open_for = wtx.lock_time - numBlocks;\n-        }\n-        else\n-        {\n-            status.status = TransactionStatus::OpenUntilDate;\n-            status.open_for = wtx.lock_time;\n-        }\n-    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790760103",
      "id" : 790760103,
      "in_reply_to_id" : 790702615,
      "line" : 193,
      "node_id" : "PRRC_kwDOABII584vIgqn",
      "original_commit_id" : "dddd05e7a3389fcbd90bb4acdfe1f59945d9f381",
      "original_line" : 193,
      "original_position" : 15,
      "original_start_line" : 183,
      "path" : "src/qt/transactionrecord.cpp",
      "position" : 15,
      "pull_request_review_id" : 860982689,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790760103/reactions"
      },
      "side" : "LEFT",
      "start_line" : 183,
      "start_side" : "LEFT",
      "updated_at" : "2022-01-24T13:48:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790760103",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> The test fails on master but it's hard to find where it's checking with mocktime instead of MTP?\r\n\r\nGood q. The time is set in `CheckFinalTx`, see also #24080.",
      "created_at" : "2022-01-24T13:50:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1020121584",
      "id" : 1020121584,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII5848zdHw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020121584/reactions"
      },
      "updated_at" : "2022-01-24T13:50:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020121584",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790764185"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790764185"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Correct. I might do it here if I need to re-push for another reason. Though, there are some other style fixes in the GUI code, which I plan to fixup in a follow-up in order to not hold back a wallet bugfix based on style feedback in gui code.",
      "commit_id" : "fa73381a88d7b650c01f4e098ec68c96f1a4485b",
      "created_at" : "2022-01-24T13:53:47Z",
      "diff_hunk" : "@@ -30,8 +30,6 @@ class TransactionStatus\n     enum Status {\n         Confirmed,          /**< Have 6 or more confirmations (normal tx) or fully mature (mined tx) **/\n         /// Normal (sent/received) transactions\n-        OpenUntilDate,      /**< Transaction not yet final, waiting for date */\n-        OpenUntilBlock,     /**< Transaction not yet final, waiting for block */\n         Unconfirmed,        /**< Not yet mined into a block **/\n         Confirming,         /**< Confirmed, but waiting for the recommended number of confirmations **/\n         Conflicted,         /**< Conflicts with other transaction or mempool **/",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790764185",
      "id" : 790764185,
      "in_reply_to_id" : 790700595,
      "line" : 35,
      "node_id" : "PRRC_kwDOABII584vIhqZ",
      "original_commit_id" : "dddd05e7a3389fcbd90bb4acdfe1f59945d9f381",
      "original_line" : 35,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/qt/transactionrecord.h",
      "position" : 8,
      "pull_request_review_id" : 860988570,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790764185/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-24T13:53:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790764185",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790964097"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790964097"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In fa3e73af050e21b3fbcd7a269f4255abbf6183e3 \"wallet: Avoid dropping confirmed coins\"\r\n\r\nThis is way more complicated than it needs to be. We have RPCs that allow the locktime to be set. You can use `send` with `locktime` in the options.",
      "commit_id" : "fa73381a88d7b650c01f4e098ec68c96f1a4485b",
      "created_at" : "2022-01-24T16:56:15Z",
      "diff_hunk" : "@@ -0,0 +1,55 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.address import ADDRESS_BCRT1_UNSPENDABLE\n+from test_framework.messages import CTxOut\n+from test_framework.messages import tx_from_hex\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+\n+class WalletLocktimeTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+\n+        mtp_tip = node.getblockheader(node.getbestblockhash())[\"mediantime\"]\n+\n+        self.log.info(\"Get new address with label\")\n+        label = \"timelockâð\"\n+        address = node.getnewaddress(label=label)\n+        script_pub_key = node.validateaddress(address)[\"scriptPubKey\"]\n+\n+        self.log.info(\"Send to new address with locktime\")\n+        tx = node.sendtoaddress(ADDRESS_BCRT1_UNSPENDABLE, 5)\n+        tx = tx_from_hex(node.getrawtransaction(tx))\n+        tx.vout = [CTxOut(5000, bytes.fromhex(script_pub_key))]\n+        tx.nLockTime = mtp_tip - 1\n+        tx_hex = node.signrawtransactionwithwallet(tx.serialize().hex())[\"hex\"]\n+        self.generateblock(node, ADDRESS_BCRT1_UNSPENDABLE, [tx_hex])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790964097",
      "id" : 790964097,
      "line" : 36,
      "node_id" : "PRRC_kwDOABII584vJSeB",
      "original_commit_id" : "fa3e73af050e21b3fbcd7a269f4255abbf6183e3",
      "original_line" : 36,
      "original_position" : 36,
      "original_start_line" : 31,
      "path" : "test/functional/wallet_timelock.py",
      "position" : 36,
      "pull_request_review_id" : 861258028,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790964097/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 31,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-24T16:57:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790964097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK fa73381a88d7b650c01f4e098ec68c96f1a4485b",
      "created_at" : "2022-01-24T16:58:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1020323347",
      "id" : 1020323347,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII58480OYT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020323347/reactions"
      },
      "updated_at" : "2022-01-24T16:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020323347",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790973696"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790973696"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point, might adjust in the next force push or in a follow-up",
      "commit_id" : "fa73381a88d7b650c01f4e098ec68c96f1a4485b",
      "created_at" : "2022-01-24T17:07:02Z",
      "diff_hunk" : "@@ -0,0 +1,55 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.address import ADDRESS_BCRT1_UNSPENDABLE\n+from test_framework.messages import CTxOut\n+from test_framework.messages import tx_from_hex\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+\n+class WalletLocktimeTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+\n+        mtp_tip = node.getblockheader(node.getbestblockhash())[\"mediantime\"]\n+\n+        self.log.info(\"Get new address with label\")\n+        label = \"timelockâð\"\n+        address = node.getnewaddress(label=label)\n+        script_pub_key = node.validateaddress(address)[\"scriptPubKey\"]\n+\n+        self.log.info(\"Send to new address with locktime\")\n+        tx = node.sendtoaddress(ADDRESS_BCRT1_UNSPENDABLE, 5)\n+        tx = tx_from_hex(node.getrawtransaction(tx))\n+        tx.vout = [CTxOut(5000, bytes.fromhex(script_pub_key))]\n+        tx.nLockTime = mtp_tip - 1\n+        tx_hex = node.signrawtransactionwithwallet(tx.serialize().hex())[\"hex\"]\n+        self.generateblock(node, ADDRESS_BCRT1_UNSPENDABLE, [tx_hex])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790973696",
      "id" : 790973696,
      "in_reply_to_id" : 790964097,
      "line" : 36,
      "node_id" : "PRRC_kwDOABII584vJU0A",
      "original_commit_id" : "fa3e73af050e21b3fbcd7a269f4255abbf6183e3",
      "original_line" : 36,
      "original_position" : 36,
      "original_start_line" : 31,
      "path" : "test/functional/wallet_timelock.py",
      "position" : 36,
      "pull_request_review_id" : 861271585,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790973696/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 31,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-24T17:07:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790973696",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The python test I wrote was too cringe (https://github.com/bitcoin/bitcoin/pull/24067#discussion_r790964097), so I force pushed a simpler version. I left all C++ and Qt code the same.\r\n\r\nShould be relatively easy to re-ACK.",
      "created_at" : "2022-01-25T09:20:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1020972269",
      "id" : 1020972269,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII58482szt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020972269/reactions"
      },
      "updated_at" : "2022-01-25T09:20:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020972269",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r791510567"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791510567"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, fixed.",
      "commit_id" : "fac816544317cee6553d60cb0f5f24f6f9ec98de",
      "created_at" : "2022-01-25T09:20:56Z",
      "diff_hunk" : "@@ -0,0 +1,55 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.address import ADDRESS_BCRT1_UNSPENDABLE\n+from test_framework.messages import CTxOut\n+from test_framework.messages import tx_from_hex\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+\n+class WalletLocktimeTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+\n+        mtp_tip = node.getblockheader(node.getbestblockhash())[\"mediantime\"]\n+\n+        self.log.info(\"Get new address with label\")\n+        label = \"timelockâð\"\n+        address = node.getnewaddress(label=label)\n+        script_pub_key = node.validateaddress(address)[\"scriptPubKey\"]\n+\n+        self.log.info(\"Send to new address with locktime\")\n+        tx = node.sendtoaddress(ADDRESS_BCRT1_UNSPENDABLE, 5)\n+        tx = tx_from_hex(node.getrawtransaction(tx))\n+        tx.vout = [CTxOut(5000, bytes.fromhex(script_pub_key))]\n+        tx.nLockTime = mtp_tip - 1\n+        tx_hex = node.signrawtransactionwithwallet(tx.serialize().hex())[\"hex\"]\n+        self.generateblock(node, ADDRESS_BCRT1_UNSPENDABLE, [tx_hex])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r791510567",
      "id" : 791510567,
      "in_reply_to_id" : 790964097,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vLX4n",
      "original_commit_id" : "fa3e73af050e21b3fbcd7a269f4255abbf6183e3",
      "original_line" : 36,
      "original_position" : 36,
      "original_start_line" : 31,
      "path" : "test/functional/wallet_timelock.py",
      "position" : null,
      "pull_request_review_id" : 861996749,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791510567/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-25T09:20:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791510567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r791556755"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791556755"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sounds good. Will look out for the followup.",
      "commit_id" : "fac816544317cee6553d60cb0f5f24f6f9ec98de",
      "created_at" : "2022-01-25T10:13:22Z",
      "diff_hunk" : "@@ -30,8 +30,6 @@ class TransactionStatus\n     enum Status {\n         Confirmed,          /**< Have 6 or more confirmations (normal tx) or fully mature (mined tx) **/\n         /// Normal (sent/received) transactions\n-        OpenUntilDate,      /**< Transaction not yet final, waiting for date */\n-        OpenUntilBlock,     /**< Transaction not yet final, waiting for block */\n         Unconfirmed,        /**< Not yet mined into a block **/\n         Confirming,         /**< Confirmed, but waiting for the recommended number of confirmations **/\n         Conflicted,         /**< Conflicts with other transaction or mempool **/",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r791556755",
      "id" : 791556755,
      "in_reply_to_id" : 790700595,
      "line" : 35,
      "node_id" : "PRRC_kwDOABII584vLjKT",
      "original_commit_id" : "dddd05e7a3389fcbd90bb4acdfe1f59945d9f381",
      "original_line" : 35,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/qt/transactionrecord.h",
      "position" : 8,
      "pull_request_review_id" : 862062164,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791556755/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-25T10:48:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791556755",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r791577941"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791577941"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> The time is set in CheckFinalTx\r\n\r\nThanks. Hell, default arguments really are the worst. https://github.com/bitcoin/bitcoin/blob/bd482b3ffebc68130f8a18dabf08ed1aff7ea159/src/validation.cpp#L207-L209",
      "commit_id" : "fac816544317cee6553d60cb0f5f24f6f9ec98de",
      "created_at" : "2022-01-25T10:37:28Z",
      "diff_hunk" : "@@ -486,11 +486,6 @@ class ChainImpl : public Chain\n         const CChain& active = Assert(m_node.chainman)->ActiveChain();\n         return active.GetLocator();\n     }\n-    bool checkFinalTx(const CTransaction& tx) override\n-    {\n-        LOCK(cs_main);\n-        return CheckFinalTx(chainman().ActiveChain().Tip(), tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r791577941",
      "id" : 791577941,
      "line" : 492,
      "node_id" : "PRRC_kwDOABII584vLoVV",
      "original_commit_id" : "fac816544317cee6553d60cb0f5f24f6f9ec98de",
      "original_line" : 492,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/node/interfaces.cpp",
      "position" : 7,
      "pull_request_review_id" : 862062164,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791577941/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-25T10:48:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791577941",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r791579237"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791579237"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Makes sense. Yeah removing for now seems better.",
      "commit_id" : "fac816544317cee6553d60cb0f5f24f6f9ec98de",
      "created_at" : "2022-01-25T10:38:53Z",
      "diff_hunk" : "@@ -179,21 +179,8 @@ void TransactionRecord::updateStatus(const interfaces::WalletTxStatus& wtx, cons\n     status.depth = wtx.depth_in_main_chain;\n     status.m_cur_block_hash = block_hash;\n \n-    const bool up_to_date = ((int64_t)QDateTime::currentMSecsSinceEpoch() / 1000 - block_time < MAX_BLOCK_TIME_GAP);\n-    if (up_to_date && !wtx.is_final) {\n-        if (wtx.lock_time < LOCKTIME_THRESHOLD) {\n-            status.status = TransactionStatus::OpenUntilBlock;\n-            status.open_for = wtx.lock_time - numBlocks;\n-        }\n-        else\n-        {\n-            status.status = TransactionStatus::OpenUntilDate;\n-            status.open_for = wtx.lock_time;\n-        }\n-    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#discussion_r791579237",
      "id" : 791579237,
      "in_reply_to_id" : 790702615,
      "line" : 193,
      "node_id" : "PRRC_kwDOABII584vLopl",
      "original_commit_id" : "dddd05e7a3389fcbd90bb4acdfe1f59945d9f381",
      "original_line" : 193,
      "original_position" : 15,
      "original_start_line" : 183,
      "path" : "src/qt/transactionrecord.cpp",
      "position" : 15,
      "pull_request_review_id" : 862062164,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24067",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791579237/reactions"
      },
      "side" : "LEFT",
      "start_line" : 183,
      "start_side" : "LEFT",
      "updated_at" : "2022-01-25T10:48:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/791579237",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK fac816544317cee6553d60cb0f5f24f6f9ec98de",
      "created_at" : "2022-01-25T21:12:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24067#issuecomment-1021613256",
      "id" : 1021613256,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24067",
      "node_id" : "IC_kwDOABII58485JTI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021613256/reactions"
      },
      "updated_at" : "2022-01-25T21:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021613256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
