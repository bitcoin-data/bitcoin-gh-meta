[
   {
      "author_association" : "MEMBER",
      "body" : "`get_connected_peers_info` would only work with Bitcoin Core peers, not mininode peers, so I'd prefer not to make it public",
      "created_at" : "2022-09-21T08:08:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#issuecomment-1253353436",
      "id" : 1253353436,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26138",
      "node_id" : "IC_kwDOABII585KtKfc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1253353436/reactions"
      },
      "updated_at" : "2022-09-21T08:08:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1253353436",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I would expect it to break again in the future.\r\n\r\nThe only way I can see it would \"break\" is when you attempt to connect to the same peer twice. In which case the failure is probably wanted. I am not sure if your approach silently dismisses that failure.",
      "created_at" : "2022-09-21T08:10:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#issuecomment-1253356285",
      "id" : 1253356285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26138",
      "node_id" : "IC_kwDOABII585KtLL9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1253356285/reactions"
      },
      "updated_at" : "2022-09-21T08:10:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1253356285",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> get_connected_peers_info would only work with Bitcoin Core peers, not mininode peers, so I'd prefer not to make it public\r\n\r\nGood point, I did not consider that. I've updated the diff (below) to keep it private. Also reduces the diff quite a bit. _(Note: `get_peer_ids()` would benefit from the same list comprehension imo, but not a required change for this to work)_\r\n\r\n> The only way I can see it would \"break\" is when you attempt to connect to the same peer twice. In which case the failure is probably wanted. I am not sure if your approach silently dismisses that failure.\r\n\r\nUpdated to only return `True` if we have exactly 1 connection to `b`, which I think addresses your concern. I don't have any specific ideas of how it would break otherwise, but since `connect_nodes()` doesn't own the nodes, I think it's not unreasonable to assume that the node _may_ update its peers in the background? If without additional complexity we can check that `a` is now connected to `b` and not just to any new node, that seems like a strict improvement to me?\r\n\r\n<details>\r\n<summary>git diff</summary>\r\n\r\n```diff\r\ndiff --git a/test/functional/test_framework/test_framework.py b/test/functional/test_framework/test_framework.py\r\nindex b1164b98f..fa3ddebe3 100755\r\n--- a/test/functional/test_framework/test_framework.py\r\n+++ b/test/functional/test_framework/test_framework.py\r\n@@ -581,8 +581,6 @@ class BitcoinTestFramework(metaclass=BitcoinTestMetaClass):\r\n     def connect_nodes(self, a, b):\r\n         from_connection = self.nodes[a]\r\n         to_connection = self.nodes[b]\r\n-        from_num_peers = 1 + len(from_connection.getpeerinfo())\r\n-        to_num_peers = 1 + len(to_connection.getpeerinfo())\r\n         ip_port = \"127.0.0.1:\" + str(p2p_port(b))\r\n         from_connection.addnode(ip_port, \"onetry\")\r\n         # poll until version handshake complete to avoid race conditions\r\n@@ -590,10 +588,14 @@ class BitcoinTestFramework(metaclass=BitcoinTestMetaClass):\r\n         # See comments in net_processing:\r\n         # * Must have a version message before anything else\r\n         # * Must have a verack message before anything else\r\n-        self.wait_until(lambda: sum(peer['version'] != 0 for peer in from_connection.getpeerinfo()) == from_num_peers)\r\n-        self.wait_until(lambda: sum(peer['version'] != 0 for peer in to_connection.getpeerinfo()) == to_num_peers)\r\n-        self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in from_connection.getpeerinfo()) == from_num_peers)\r\n-        self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in to_connection.getpeerinfo()) == to_num_peers)\r\n+        def is_connection_established(from_node: TestNode, to_node: TestNode) -> bool:\r\n+            connected = [peer for peer in from_connection.getpeerinfo() if f\"testnode{b}\" in peer[\"subver\"]]\r\n+            veracked = [peer for peer in connected if peer[\"bytesrecv_per_msg\"].pop('verack', 0) == 24]\r\n+            return len(veracked) == 1\r\n+\r\n+        self.wait_until(lambda: is_connection_established(from_connection, to_connection))\r\n+        self.wait_until(lambda: is_connection_established(to_connection, from_connection))\r\n+\r\n \r\n     def disconnect_nodes(self, a, b):\r\n         def disconnect_nodes_helper(node_a, node_b):\r\n\r\n```\r\n\r\n</details\r\n\r\n",
      "created_at" : "2022-09-22T10:41:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#issuecomment-1254847266",
      "id" : 1254847266,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26138",
      "node_id" : "IC_kwDOABII585Ky3Mi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1254847266/reactions"
      },
      "updated_at" : "2022-09-22T10:41:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1254847266",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r977504391"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/977504391"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: If you're touching, would use f-string instead:\r\n```python\r\n                self.log.warning(f\"disconnect_nodes: {node_a.index} and {node_b.index} were not connected\")\r\n```",
      "commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "created_at" : "2022-09-22T10:51:06Z",
      "diff_hunk" : "@@ -596,24 +596,24 @@ def connect_nodes(self, a, b):\n         self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in to_connection.getpeerinfo()) == to_num_peers)\n \n     def disconnect_nodes(self, a, b):\n-        def disconnect_nodes_helper(from_connection, node_num):\n-            def get_peer_ids():\n+        def disconnect_nodes_helper(node_a, node_b):\n+            def get_peer_ids(from_connection, node_num):\n                 result = []\n                 for peer in from_connection.getpeerinfo():\n                     if \"testnode{}\".format(node_num) in peer['subver']:\n                         result.append(peer['id'])\n                 return result\n \n-            peer_ids = get_peer_ids()\n+            peer_ids = get_peer_ids(node_a, node_b.index)\n             if not peer_ids:\n                 self.log.warning(\"disconnect_nodes: {} and {} were not connected\".format(\n-                    from_connection.index,\n-                    node_num,\n+                    node_a.index,\n+                    node_b.index,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r977504391",
      "id" : 977504391,
      "line" : 611,
      "node_id" : "PRRC_kwDOABII5846Q4iH",
      "original_commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "original_line" : 611,
      "original_position" : 21,
      "original_start_line" : 610,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 21,
      "pull_request_review_id" : 1116819813,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/977504391/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 610,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-22T10:58:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/977504391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r977505958"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/977505958"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Since you're touching, I think adding type hints here would be helpful. Also, for consistency would prefer calling it `node` instead of `connection` and `index` instead of `num`?\r\n```suggestion\r\n    def disconnect_nodes(self, a: int, b: int) -> None:\r\n        def disconnect_nodes_helper(node_a: TestNode, node_b: TestNode) -> None:\r\n            def get_peer_ids(from_node: TestNode, to_node_index: int) -> List[int]:\r\n```",
      "commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "created_at" : "2022-09-22T10:52:56Z",
      "diff_hunk" : "@@ -596,24 +596,24 @@ def connect_nodes(self, a, b):\n         self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in to_connection.getpeerinfo()) == to_num_peers)\n \n     def disconnect_nodes(self, a, b):\n-        def disconnect_nodes_helper(from_connection, node_num):\n-            def get_peer_ids():\n+        def disconnect_nodes_helper(node_a, node_b):\n+            def get_peer_ids(from_connection, node_num):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r977505958",
      "id" : 977505958,
      "line" : 600,
      "node_id" : "PRRC_kwDOABII5846Q46m",
      "original_commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "original_line" : 600,
      "original_position" : 7,
      "original_start_line" : 599,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 7,
      "pull_request_review_id" : 1116819813,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/977505958/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 599,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-22T10:58:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/977505958",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69010457?v=4",
         "events_url" : "https://api.github.com/users/stickies-v/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stickies-v/followers",
         "following_url" : "https://api.github.com/users/stickies-v/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stickies-v/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stickies-v",
         "id" : 69010457,
         "login" : "stickies-v",
         "node_id" : "MDQ6VXNlcjY5MDEwNDU3",
         "organizations_url" : "https://api.github.com/users/stickies-v/orgs",
         "received_events_url" : "https://api.github.com/users/stickies-v/received_events",
         "repos_url" : "https://api.github.com/users/stickies-v/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stickies-v/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stickies-v/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stickies-v"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2022-09-23T03:19:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#issuecomment-1255760944",
      "id" : 1255760944,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26138",
      "node_id" : "IC_kwDOABII585K2WQw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1255760944/reactions"
      },
      "updated_at" : "2022-09-24T22:35:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1255760944",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r982545001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/982545001"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok I interpret this race to have been\r\n\r\n1. call `disconnect(1, 2)`, wait until 2 no longer shows up in `node1.getpeerinfo()`\r\n2. call `connect(0, 2)`. get `to_num_peers = 2` when querying `node2.getpeerinfo()`\r\n3. node1 actually disconnected from node2. now there's only 1 peer in `node2.getpeerinfo()`.\r\n4. `lambda: sum(peer['version'] != 0 for peer in to_connection.getpeerinfo()) == to_num_peers` == 2\r\n5. hang\r\n\r\nWhich is why we need to wait for both.\r\n\r\nAnd now the order is\r\n\r\n1. call `disconnect(1, 2)`, wait until 2 no longer shows up in `node1.getpeerinfo()` AND wait until 1 no longer shows up in `node2.getpeerinfo()`\r\n2. call `connect(0, 2)`. get `to_num_peers = 1` when querying `node2.getpeerinfo()`\r\n3. `lambda: sum(peer['version'] != 0 for peer in to_connection.getpeerinfo()) == to_num_peers` == 1\r\n",
      "commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "created_at" : "2022-09-28T15:19:56Z",
      "diff_hunk" : "@@ -622,9 +622,10 @@ def get_peer_ids():\n                         raise\n \n             # wait to disconnect\n-            self.wait_until(lambda: not get_peer_ids(), timeout=5)\n+            self.wait_until(lambda: not get_peer_ids(node_a, node_b.index), timeout=5)\n+            self.wait_until(lambda: not get_peer_ids(node_b, node_a.index), timeout=5)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r982545001",
      "id" : 982545001,
      "line" : 626,
      "node_id" : "PRRC_kwDOABII5846kHJp",
      "original_commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "original_line" : 626,
      "original_position" : 37,
      "original_start_line" : 625,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 37,
      "pull_request_review_id" : 1123898758,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/982545001/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 625,
      "start_side" : "LEFT",
      "updated_at" : "2022-09-28T15:20:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/982545001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think it's not unreasonable to assume that the node may update its peers in the background?\r\n\r\nThe functional test main thread is a single thread, so there should be nothing happening in the background. If something were to happen in the background, it is either irrelevant to the test, or it could result in a rare intermittent false-failure.",
      "created_at" : "2022-09-28T18:57:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#issuecomment-1261338660",
      "id" : 1261338660,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26138",
      "node_id" : "IC_kwDOABII585LLoAk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261338660/reactions"
      },
      "updated_at" : "2022-09-28T18:57:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261338660",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r982766989"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/982766989"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I kept the name as-is to make the diff minimal. If there are additional changes, they can be made in a follow-up.\r\n\r\nIf there is a follow-up, it would probably be fine to also make `to_node_index` of type `TestNode`.",
      "commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "created_at" : "2022-09-28T19:03:22Z",
      "diff_hunk" : "@@ -596,24 +596,24 @@ def connect_nodes(self, a, b):\n         self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in to_connection.getpeerinfo()) == to_num_peers)\n \n     def disconnect_nodes(self, a, b):\n-        def disconnect_nodes_helper(from_connection, node_num):\n-            def get_peer_ids():\n+        def disconnect_nodes_helper(node_a, node_b):\n+            def get_peer_ids(from_connection, node_num):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r982766989",
      "id" : 982766989,
      "in_reply_to_id" : 977505958,
      "line" : 600,
      "node_id" : "PRRC_kwDOABII5846k9WN",
      "original_commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "original_line" : 600,
      "original_position" : 7,
      "original_start_line" : 599,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 7,
      "pull_request_review_id" : 1124221686,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/982766989/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 599,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-28T19:03:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/982766989",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r983297055"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/983297055"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@stickies-v maybe you can follow up here?",
      "commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "created_at" : "2022-09-29T09:24:48Z",
      "diff_hunk" : "@@ -596,24 +596,24 @@ def connect_nodes(self, a, b):\n         self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in to_connection.getpeerinfo()) == to_num_peers)\n \n     def disconnect_nodes(self, a, b):\n-        def disconnect_nodes_helper(from_connection, node_num):\n-            def get_peer_ids():\n+        def disconnect_nodes_helper(node_a, node_b):\n+            def get_peer_ids(from_connection, node_num):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26138#discussion_r983297055",
      "id" : 983297055,
      "in_reply_to_id" : 977505958,
      "line" : 600,
      "node_id" : "PRRC_kwDOABII5846m-wf",
      "original_commit_id" : "faeea28753a94c45618c1b0ba83bb8700c53009a",
      "original_line" : 600,
      "original_position" : 7,
      "original_start_line" : 599,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 7,
      "pull_request_review_id" : 1124948926,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26138",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/983297055/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 599,
      "start_side" : "RIGHT",
      "updated_at" : "2022-09-29T09:24:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/983297055",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
