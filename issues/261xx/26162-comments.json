[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26177](https://github.com/bitcoin/bitcoin/pull/26177) (refactor / kernel: Move non-gArgs chainparams functionality to kernel by TheCharlatan)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-09-24T16:27:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1257007168",
      "id" : 1257007168,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585K7GhA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1257007168/reactions"
      },
      "updated_at" : "2022-09-24T16:27:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1257007168",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Looks like this has nothing to do with removing the chain param, but it is some kind of consensus change?",
      "created_at" : "2022-09-25T22:07:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1257289146",
      "id" : 1257289146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585K8LW6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1257289146/reactions"
      },
      "updated_at" : "2022-09-25T22:07:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1257289146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't think there's any point reporting the historical activation height for p2sh/taproot if they're not things we use in our code. As far as our actual code is concerned, p2sh/taproot were activated at genesis, with some exceptions -- so if that's what we're doing, that's what we should report. If we did want to document the historical height, even though we don't enforce it, I think that should just go in `deploymentinfo.h` (and `rpc/blockchain.cpp`), and not touch `consensus/params.h`.\r\n\r\nI had a bit more of a poke around at this in https://github.com/ajtowns/bitcoin/commits/202209-forkexceptionreporting . My thinking ended up at:\r\n\r\n * we could report the current `GetBlockScriptFlags()` in `getdeploymentinfo`. that more directly exposes things like NULLDUMMY getting enforced as of block 481824, which seems like it has some value.\r\n * once we were doing that, changing `Consensus::Params::script_flag_exceptions` to be indexed by height, rather than hash would be easy to verify -- run `getdeploymentinfo` against each block, and check that that none of the values have changed. not the most speedy thing ever, but easier than every reviewer running a full reindex for both mainnet and testnet...\r\n * once you've got the exceptions indexed by height, you can easily report on whether the exception actually appeared in the current tip's history or not, which seems important if you're reporting exceptions to consensus rules\r\n\r\nEDIT: oh, what the looks like:\r\n\r\n```json\r\n{\r\n  \"hash\": \"000000000000000000051d293d02f6791592fdc53012caa5dbf61cb3a0f4026d\",\r\n  \"height\": 755873,\r\n  \"script_flags\": \"CHECKLOCKTIMEVERIFY,CHECKSEQUENCEVERIFY,DERSIG,NULLDUMMY,P2SH,TAPROOT,WITNESS\",\r\n  \"deployments\": {\r\n    ...\r\n    \"bip16\": {\r\n      \"type\": \"buried\",\r\n      \"buried\": {\r\n        \"exceptions\": [\r\n          {\r\n            \"height\": 170060,\r\n            \"hash\": \"00000000000002dc756eebf4f49723ed8d30cc28a5f108eb94b1ba88ac4f9c22\",\r\n            \"applied\": true,\r\n            \"script_flags\": \"\"\r\n          }\r\n        ]\r\n      },\r\n      \"active\": true,\r\n      \"height\": 0\r\n    },\r\n    \"taproot\": {\r\n      \"type\": \"buried\",\r\n      \"buried\": {\r\n        \"exceptions\": [\r\n          {\r\n            \"height\": 692261,\r\n            \"hash\": \"0000000000000000000f14c35b2d841e986ab5441de8c585d5ffe55ea1e395ad\",\r\n            \"applied\": true,\r\n            \"script_flags\": \"CHECKLOCKTIMEVERIFY,CHECKSEQUENCEVERIFY,DERSIG,NULLDUMMY,P2SH,WITNESS\"\r\n          },\r\n          {\r\n            \"height\": 170060,\r\n            \"hash\": \"00000000000002dc756eebf4f49723ed8d30cc28a5f108eb94b1ba88ac4f9c22\",\r\n            \"applied\": true,\r\n            \"script_flags\": \"\"\r\n          }\r\n        ]\r\n      },\r\n      \"active\": true,\r\n      \"height\": 0\r\n    }\r\n  }\r\n}\r\n```",
      "created_at" : "2022-09-27T03:35:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1258924536",
      "id" : 1258924536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LCan4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1258924536/reactions"
      },
      "updated_at" : "2022-09-27T03:44:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1258924536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Not sure if I want to overhaul `script_flag_exceptions` unless there's a really good reason for it. The way these exception blocks work is quite separate from the actual soft fork activation. This is especially obvious with the P2SH exception, which _also_ acts as a `CHECKLOCKTIMEVERIFY` exception, even though afaik that opcode can be used in bare script (i.e. without p2sh).\r\n\r\nTherefore it seems better to list exception blocks outside the `deployments` dictionary.\r\n\r\nI'm tempted to completely drop `buried` entries from the `deployments` dictionary once it is removed from `consensus/params.h`. So the sequence of burying a soft fork would be something like:\r\n\r\n1. Wait a long time after activation (or failure)\r\n2. Set activation height to 0 and list as burried in `getdeploymentinfo` (warn that entries are deprecated)\r\n3. Delete entirely from `consensus/params.h` in some later release\r\n\r\nThis is more in the direction @MarcoFalke was going, but systematically rather than only for Taproot. However, going through the list of `BIP...Height` Taproot does seem the only one we can easily drop this way:\r\n* afaik `BIP34Height` (height in coinbase), `BIP65Height` (CLTV), `BIP66Height` (DER) and `CSVHeight` can't be dropped, unless we add lots of exception blocks\r\n* dropping `SegwitHeight` would need a refactor of `NeedsRedownload()` (e.g. check for the presence of a commitment?). Possibly not with the extra complexity.\r\n\r\nEven if we can't remove an entry from `consensus/params.h` we could still drop the entry from `getdeploymentinfo`. Right now it's an incomplete list (which is why I added P2SH to it in this draft PR).\r\n\r\nI do think we should document the historical activation blocks and their height, as right now this involves Google and/or looking through old commits. But this may be easier to do in a markdown file.",
      "created_at" : "2022-09-28T08:00:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1260532239",
      "id" : 1260532239,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LIjIP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1260532239/reactions"
      },
      "updated_at" : "2022-09-28T08:03:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1260532239",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Not sure if I want to overhaul `script_flag_exceptions` unless there's a really good reason for it. The way these exception blocks work is quite separate from the actual soft fork activation. This is especially obvious with the P2SH exception, which _also_ acts as a `CHECKLOCKTIMEVERIFY` exception, even though afaik that opcode can be used in bare script (i.e. without p2sh).\r\n\r\nCLTV isn't/wasn't enforced around the heights of the P2SH exception (and likewise isn't excepted for the taproot block):\r\n\r\n```\r\n$ for a in `seq 170059 170061` `seq 692260 692262`; do bitcoin-cli getdeploymentinfo @$a | jq -j '.height,\" \",.script_flags,\"\\n\"'; done\r\n170059 P2SH,TAPROOT,WITNESS\r\n170060 \r\n170061 P2SH,TAPROOT,WITNESS\r\n692260 CHECKLOCKTIMEVERIFY,CHECKSEQUENCEVERIFY,DERSIG,NULLDUMMY,P2SH,TAPROOT,WITNESS\r\n692261 CHECKLOCKTIMEVERIFY,CHECKSEQUENCEVERIFY,DERSIG,NULLDUMMY,P2SH,WITNESS\r\n692262 CHECKLOCKTIMEVERIFY,CHECKSEQUENCEVERIFY,DERSIG,NULLDUMMY,P2SH,TAPROOT,WITNESS\r\n```\r\n\r\n> Therefore it seems better to list exception blocks outside the `deployments` dictionary.\r\n> \r\n> I'm tempted to completely drop `buried` entries from the `deployments` dictionary once it is removed from `consensus/params.h`.\r\n\r\nHuh? You can't remove buried deployment from consensus/params; they're consensus critical...\r\n\r\n>     * dropping `SegwitHeight` would need a refactor of `NeedsRedownload()` (e.g. check for the presence of a commitment?). Possibly not with the extra complexity.\r\n\r\n`SegwitHeight` is used for enabling `SCRIPT_VERIFY_NULLDUMMY` as well.\r\n\r\n> I do think we should document the historical activation blocks and their height, as right now this involves Google and/or looking through old commits. But this may be easier to do in a markdown file.\r\n\r\nThe obvious place to document historical activation heights and exceptions would be to via an update to BIP 90 (presumably with a new bip number)...\r\n\r\nCheers,\r\naj\r\n",
      "created_at" : "2022-09-28T17:20:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1261223403",
      "id" : 1261223403,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LLL3r",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261223403/reactions"
      },
      "updated_at" : "2022-09-28T17:20:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261223403",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> CLTV isn't/wasn't enforced around the heights of the P2SH exception (and likewise isn't excepted for the taproot block)\r\n\r\nIndeed, I got confused in 53b62e301b1a8552fc5906bd3b7697b4182d5ae9. BIP34 (height in coinbase), BIP65 (CLTV), BIP66 (DER) and CSV all activated _after_ BIP16 (p2sh).\r\n\r\n> `SegwitHeight` is used for enabling `SCRIPT_VERIFY_NULLDUMMY` as well.\r\n\r\nAh, [BIP 147](https://github.com/bitcoin/bips/blob/master/bip-0147.mediawiki), which is _not_ buried (and not listed by `getdeploymentinfo`)\r\n\r\n> You can't remove buried deployment from consensus/params; they're consensus critical...\r\n\r\nThen they're not really buried. It seems https://github.com/bitcoin/bitcoin/pull/24737/commits/2222ea8612ba21a27239c41dd77cd2e92d25037b wasn't doing that either despite the title. It removed `consensus.vDeployments`, but not `consensus.TaprootHeight`, even though the latter is not used in consensus code afaik, i.e. Taproot _can_ be buried (I think).\r\n",
      "created_at" : "2022-09-28T17:51:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1261261853",
      "id" : 1261261853,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LLVQd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261261853/reactions"
      },
      "updated_at" : "2022-09-28T17:52:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261261853",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It seems https://github.com/bitcoin/bitcoin/commit/2222ea8612ba21a27239c41dd77cd2e92d25037b wasn't doing that either despite the title. It removed consensus.vDeployments, but not consensus.TaprootHeight\r\n\r\nThere is no TaprootHeight in 2222ea8612ba21a27239c41dd77cd2e92d25037b",
      "created_at" : "2022-09-28T18:17:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1261298278",
      "id" : 1261298278,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LLeJm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261298278/reactions"
      },
      "updated_at" : "2022-09-28T18:17:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261298278",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > `SegwitHeight` is used for enabling `SCRIPT_VERIFY_NULLDUMMY` as well.\r\n> \r\n> Ah, [BIP 147](https://github.com/bitcoin/bips/blob/master/bip-0147.mediawiki), which is _not_ buried (and not listed by `getdeploymentinfo`)\r\n\r\nIt's listed as \"segwit\", as per BIP 147's \"Deployment\" section:  `The BIP will be deployed .. using the same parameters for BIP141 .. with the name \"segwit\"`\r\n\r\n> > You can't remove buried deployment from consensus/params; they're consensus critical...\r\n> \r\n> Then they're not really buried.\r\n\r\nThe way \"buried\" is used in consensus/params.h (`enum BuriedDeployment`) and in BIP 90 (\"Title: Buried Deployments\") is to refer to a soft fork that has been activated sufficiently long ago (ie, been \"buried\" under a lot of proof of work) that a reorg of sufficient depth to trigger activation at some other height (or to prevent activation entirely) is vanishingly unlikely.\r\n\r\n> It seems [2222ea8](https://github.com/bitcoin/bitcoin/commit/2222ea8612ba21a27239c41dd77cd2e92d25037b) wasn't doing that either despite the title. It removed `consensus.vDeployments`, but not `consensus.TaprootHeight`, even though the latter is not used in consensus code afaik, i.e. Taproot _can_ be buried (I think).\r\n\r\n`TaprootHeight` was proposed to be introduced in #23505, but that PR was obsoleted by #23536.",
      "created_at" : "2022-09-29T01:39:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1261638937",
      "id" : 1261638937,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LMxUZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261638937/reactions"
      },
      "updated_at" : "2022-09-29T01:39:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261638937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> There is no TaprootHeight in [2222ea8](https://github.com/bitcoin/bitcoin/commit/2222ea8612ba21a27239c41dd77cd2e92d25037b)\r\n\r\nAh you're right, and it's not in @ajtowns reworked version https://github.com/ajtowns/bitcoin/commit/809a545d6e9abb106d5345f3a98ebc7b4031631b either. I must have introduced this myself in a0edf54e71290b571d77de885f1a6c7c8cfd4285 in order to make the RPC result sane.\r\n\r\n> TaprootHeight was proposed to be introduced in https://github.com/bitcoin/bitcoin/pull/23505, but that PR was obsoleted by https://github.com/bitcoin/bitcoin/pull/23536\r\n\r\nI don't think I used anything from that commit.\r\n\r\n> The way \"buried\" is used in consensus/params.h (enum BuriedDeployment) and in BIP 90 (\"Title: Buried Deployments\") is to refer to a soft fork that has been activated sufficiently long ago (ie, been \"buried\" under a lot of proof of work) that a reorg of sufficient depth to trigger activation at some other height (or to prevent activation entirely) is vanishingly unlikely.\r\n\r\nThere's three possible interpretations of \"buried\":\r\n\r\n1. The \"natural\" process of the activation block ending up buried\r\n2. The act of hardcoding it, as the comment in `consensus/params.h` continues \"the height of the activation has been hardcoded into the client implementation\".\r\n3. Applying the rules all the way back to genesis\r\n\r\n(3) is what I had in mind with the term, but the intention of BIP 90 seems to be either (1) or (2)\r\n\r\nIt would be good to have separate terms for these three things. We have previously called (3) \"enforce from genesis\" (#24567) or \"enforced when [some condition other than height]\" (#23536). The word \"bury\" (https://github.com/bitcoin/bitcoin/commit/1c93b9b31c2ab7358f9d55f52dd46340397c906d, #23505) \"buried\" have been used to indicate (2). But \"buried\" has also been used in the sense of (1), e.g. in #23536.\r\n\r\nThis makes me think we need a need term for (2) so we can keep using the more ambiguous \"buried\" for (1). Perhaps \"hardcode height of\", \"pin\" or \"demarcate\" to stay closer the archeology analogy (demarcation line, demarcation height).\r\n\r\nClosing this PR because it's too much of a mess. I might reopen when I have more clarity on what would be useful to achieve here.",
      "created_at" : "2022-09-29T08:02:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1261911902",
      "id" : 1261911902,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LNz9e",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261911902/reactions"
      },
      "updated_at" : "2022-09-29T08:02:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261911902",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Looks like anything that would come is based on https://github.com/bitcoin/bitcoin/commit/2222ea8612ba21a27239c41dd77cd2e92d25037b, so my preference would be to just go ahead with that and leave other stuff to follow-ups.",
      "created_at" : "2022-09-29T09:40:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1262030410",
      "id" : 1262030410,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LOQ5K",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262030410/reactions"
      },
      "updated_at" : "2022-09-29T09:40:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262030410",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke trying that in #26201, but with a bit more source and code comment and RPC help to (differently) explain the rationale for dropping taproot from the RPC result.",
      "created_at" : "2022-09-29T11:17:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26162#issuecomment-1262135059",
      "id" : 1262135059,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26162",
      "node_id" : "IC_kwDOABII585LOqcT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262135059/reactions"
      },
      "updated_at" : "2022-09-29T11:18:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1262135059",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
