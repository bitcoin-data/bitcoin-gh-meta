[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't see a performance improvement when modifying the complex mempool bench to use `Expire` (which was replaced here with a single call to `CalculateDescendants`) and lots of descendants, so I'm not sure if this patch is useful",
      "created_at" : "2022-04-24T17:40:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24942#issuecomment-1107885879",
      "id" : 1107885879,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24942",
      "node_id" : "IC_kwDOABII585CCP83",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1107885879/reactions"
      },
      "updated_at" : "2022-04-24T17:40:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1107885879",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "NONE",
      "body" : ">I don't see a performance improvement when modifying the complex mempool bench to use Expire (which was replaced here with a single call to CalculateDescendants) and lots of descendants, so I'm not sure if this patch is useful\r\n\r\nYeah! because the bottleneck is the set implementation, that uses internally a read black Tree, so in complex mempool the big cost is not the iteration, but the walk of the Tree in the set!\r\n\r\nI don't think here is possible to use the `unordered_set`, but maybe I'm wrong because I read the code on the flight",
      "created_at" : "2022-04-25T09:34:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24942#issuecomment-1108326244",
      "id" : 1108326244,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24942",
      "node_id" : "IC_kwDOABII585CD7dk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108326244/reactions"
      },
      "updated_at" : "2022-04-25T09:34:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108326244",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/17150045?v=4",
         "events_url" : "https://api.github.com/users/vincenzopalazzo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vincenzopalazzo/followers",
         "following_url" : "https://api.github.com/users/vincenzopalazzo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vincenzopalazzo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vincenzopalazzo",
         "id" : 17150045,
         "login" : "vincenzopalazzo",
         "node_id" : "MDQ6VXNlcjE3MTUwMDQ1",
         "organizations_url" : "https://api.github.com/users/vincenzopalazzo/orgs",
         "received_events_url" : "https://api.github.com/users/vincenzopalazzo/received_events",
         "repos_url" : "https://api.github.com/users/vincenzopalazzo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vincenzopalazzo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vincenzopalazzo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vincenzopalazzo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > I don't see a performance improvement when modifying the complex mempool bench to use Expire (which was replaced here with a single call to CalculateDescendants) and lots of descendants, so I'm not sure if this patch is useful\r\n> \r\n> Yeah! because the bottleneck is the set implementation, that uses internally a read black Tree, so in complex mempool the big cost is not the iteration, but the walk of the Tree in the set!\r\n> \r\n> I don't think here is possible to use the `unordered_set`, but maybe I'm wrong because I read the code on the flight\r\n\r\nThis patch walks the rb tree less depending on the \"family tree\" and the mempool bench can create a very large tree with many descendants. I wonder if the remaining set operations \"take over\" here even with less lookups",
      "created_at" : "2022-04-25T12:55:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24942#issuecomment-1108533670",
      "id" : 1108533670,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24942",
      "node_id" : "IC_kwDOABII585CEuGm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108533670/reactions"
      },
      "updated_at" : "2022-04-25T12:55:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108533670",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "NONE",
      "body" : ">I wonder if the remaining set operations \"take over\" here even with less lookups\r\n\r\nSounds something to benchmarking the c++ set implementation?",
      "created_at" : "2022-04-25T13:11:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24942#issuecomment-1108552413",
      "id" : 1108552413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24942",
      "node_id" : "IC_kwDOABII585CEyrd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108552413/reactions"
      },
      "updated_at" : "2022-04-25T13:11:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108552413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/17150045?v=4",
         "events_url" : "https://api.github.com/users/vincenzopalazzo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vincenzopalazzo/followers",
         "following_url" : "https://api.github.com/users/vincenzopalazzo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vincenzopalazzo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vincenzopalazzo",
         "id" : 17150045,
         "login" : "vincenzopalazzo",
         "node_id" : "MDQ6VXNlcjE3MTUwMDQ1",
         "organizations_url" : "https://api.github.com/users/vincenzopalazzo/orgs",
         "received_events_url" : "https://api.github.com/users/vincenzopalazzo/received_events",
         "repos_url" : "https://api.github.com/users/vincenzopalazzo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vincenzopalazzo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vincenzopalazzo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vincenzopalazzo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Closing since this doesn't actually give a noticeable improvement, maybe if this used a vector there would be some speedup",
      "created_at" : "2022-04-25T14:00:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24942#issuecomment-1108616284",
      "id" : 1108616284,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24942",
      "node_id" : "IC_kwDOABII585CFCRc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108616284/reactions"
      },
      "updated_at" : "2022-04-25T14:00:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108616284",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   }
]
