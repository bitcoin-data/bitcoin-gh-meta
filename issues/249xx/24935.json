{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "### **Added usdt tracepoints to mempool additions and eviction functions**\r\nUsing the bitcoin usdt tracepoints api, two mempool event tracepoints were added to `txmempool.cpp`. These tracepoints are active upon tx additions and evictions to the mempool. This is useful for logging the mempool contents for analysis. Better fee estimation models and custom TXID lookup scripts are some of the first uses that come to mind, \r\n\r\nThe included bpftrace script logs all mempool additions and removals in a .csv format that can be viewed in realtime or piped to a file for analysis. \r\n\r\n**NOTES** [Ref.](https://github.com/bitcoin/bitcoin/blob/master/doc/tracing.md)\r\n - code included follows the USDT guidelines (no parsing or serialization) so near 0 effect on core performance. \r\n - bpftace script `log_mempool_activity.bt` is included and generates a .csv log output of all additions and evictions within the mempool along with the reason, size, time, txid, fee, and value of the TX\r\n - Documentation has been updated to reflect the new `mempool` context\r\n - Tracepoint API is very reliable in testing, _Logged mempool TXs for over 24 hours and the csv output was parsed with 0 errors._\r\n - No env vars change needed to run bpftrace script\r\n \r\n**IMPOVEMENTS** [Ref,](https://github.com/bitcoin/bitcoin/tree/master/contrib/tracing#log_utxosbt)\r\n- The included bpftrace script improves on all existing examples by using a single `printf` call. This enables the script to log 100s of mempool evictions without dropping events and destroying the output. This means that unlike the current `log_utxos.bt` whos output is corrupted while using bpftrace default parameters. The include bpftrace script uses a variety of methods to improve performance and can be ran successfully with default bpftrace environment variables. \r\n",
   "closed_at" : "2022-08-12T21:25:40Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/3104223?v=4",
      "events_url" : "https://api.github.com/users/russeree/events{/privacy}",
      "followers_url" : "https://api.github.com/users/russeree/followers",
      "following_url" : "https://api.github.com/users/russeree/following{/other_user}",
      "gists_url" : "https://api.github.com/users/russeree/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/russeree",
      "id" : 3104223,
      "login" : "russeree",
      "node_id" : "MDQ6VXNlcjMxMDQyMjM=",
      "organizations_url" : "https://api.github.com/users/russeree/orgs",
      "received_events_url" : "https://api.github.com/users/russeree/received_events",
      "repos_url" : "https://api.github.com/users/russeree/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/russeree/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/russeree/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/russeree"
   },
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24935/comments",
   "created_at" : "2022-04-21T10:22:03Z",
   "draft" : true,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24935/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/24935",
   "id" : 1210825131,
   "labels" : [
      {
         "color" : "fef2c0",
         "default" : false,
         "description" : null,
         "id" : 164208572,
         "name" : "Mempool",
         "node_id" : "MDU6TGFiZWwxNjQyMDg1NzI=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Mempool"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24935/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII5842jGnr",
   "number" : 24935,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/24935.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24935",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/24935.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24935"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24935/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24935/timeline",
   "title" : "mempool: Add usdt event tracepoints and eBPF logging tool.",
   "updated_at" : "2022-08-12T21:25:40Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24935",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/3104223?v=4",
      "events_url" : "https://api.github.com/users/russeree/events{/privacy}",
      "followers_url" : "https://api.github.com/users/russeree/followers",
      "following_url" : "https://api.github.com/users/russeree/following{/other_user}",
      "gists_url" : "https://api.github.com/users/russeree/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/russeree",
      "id" : 3104223,
      "login" : "russeree",
      "node_id" : "MDQ6VXNlcjMxMDQyMjM=",
      "organizations_url" : "https://api.github.com/users/russeree/orgs",
      "received_events_url" : "https://api.github.com/users/russeree/received_events",
      "repos_url" : "https://api.github.com/users/russeree/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/russeree/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/russeree/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/russeree"
   }
}
