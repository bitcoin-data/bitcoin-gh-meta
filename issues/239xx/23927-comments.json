[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23813](https://github.com/bitcoin/bitcoin/pull/23813) (Add test and docs for getblockfrompeer with pruning by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-01-01T03:06:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1003492901",
      "id" : 1003492901,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII58470BYl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003492901/reactions"
      },
      "updated_at" : "2022-10-06T18:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003492901",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK.\r\n\r\nI started testing it by creating a functional test. Not sure if the approach is right, I started two nodes, the second one with `-prune=550` and then, node0 mines 20 blocks, I get the bestblockhash from node0 and use it on getblockfrompeer (node1 --> node0), it should return an error (apparently it worked):\r\n```python\r\ndef run_test(self):\r\n        self.log.info(\"Mine 20 blocks on Node 0\")\r\n        self.generate(self.nodes[0], 200, sync_fun=self.no_op)\r\n        assert_equal(self.nodes[0].getblockcount(), 400)\r\n\r\n        self.log.info(\"Connect nodes\")\r\n        self.connect_nodes(0, 1)\r\n\r\n        peers = self.nodes[1].getpeerinfo()\r\n        assert_equal(len(peers), 1)\r\n        peer_1_peer_0_id = peers[0][\"id\"]\r\n        best_block_hash_0 = self.nodes[0].getbestblockhash()\r\n        assert_raises_rpc_error(-1, 'In prune mode, only blocks that the node has already synced previously can be fetched from a peer', self.nodes[1].getblockfrompeer, best_block_hash_0, peer_1_peer_0_id)\r\n```\r\n\r\nIn master branch, this test would fail, because an exeception won't be raised.",
      "created_at" : "2022-01-01T15:09:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1003571743",
      "id" : 1003571743,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII58470Uof",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003571743/reactions"
      },
      "updated_at" : "2022-01-01T15:09:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003571743",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I started testing it by creating a functional test. Not sure if the approach is right, I started two nodes, the second one with `-prune=550` and then, node0 mines 20 blocks, I get the bestblockhash from node0 and use it on getblockfrompeer (node1 --> node0), it should return an error (apparently it worked):\r\n\r\nHey @brunoerg , thanks for giving it a try but unfortunately I don't think this approach works reliably. The problem is that the outcome of this test is a race because node 1 is downloading the blocks from node 0 in the background. It may have the current tip in flight by the time the assert is called, or not. We try to avoid tests where the outcome is not 100% reliable because we are seeing intermittent test failures quite often already.\r\n\r\nWhat would be needed is a reliable way to let node 1 sync the headers but then prevent it from syncing the blocks. It seems we don't have something like this and I am now thinking about how this could be done and where else it could be useful.",
      "created_at" : "2022-01-01T18:24:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1003597178",
      "id" : 1003597178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII58470a16",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003597178/reactions"
      },
      "updated_at" : "2022-01-01T18:24:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003597178",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The problem is that the outcome of this test is a race because node 1 is downloading the blocks from node 0 in the background.\r\n\r\nInteresting, this is new for me.\r\n```python\r\ndef setup_network(self):\r\n  self.setup_nodes()\r\n```\r\n\r\neven with this config (setup_network) node1 will download the blocks from node0 in the background after node0 mines more 200 blocks?\r\n\r\n```python\r\ndef run_test(self):\r\n        self.log.info(\"Mine 200 blocks on Node 0\")\r\n        self.generate(self.nodes[0], 200, sync_fun=self.no_op)\r\n        assert_equal(self.nodes[0].getblockcount(), 400)\r\n\r\n        self.log.info(\"Connect nodes\")\r\n        self.connect_nodes(0, 1)\r\n\r\n        peers = self.nodes[1].getpeerinfo()\r\n        assert_equal(len(peers), 1)\r\n        peer_1_peer_0_id = peers[0][\"id\"]\r\n        best_block_hash_0 = self.nodes[0].getbestblockhash()\r\n        assert_raises_rpc_error(-1, 'In prune mode, only blocks that the node has already synced previously can be fetched from a peer', self.nodes[1].getblockfrompeer, best_block_hash_0, peer_1_peer_0_id)\r\n\r\n        self.sync_blocks()\r\n        self.nodes[1].getblockfrompeer(best_block_hash_0, peer_1_peer_0_id)\r\n```\r\nI thought the first `getblockfrompeer` into the assert would fail because I didn't setup it to sync blocks and the second one would work because of `self.sync_blocks()`. \r\n\r\n",
      "created_at" : "2022-01-02T13:40:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1003718005",
      "id" : 1003718005,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII584704V1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003718005/reactions"
      },
      "updated_at" : "2022-01-02T18:56:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003718005",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> even with this config (setup_network) node1 will download the blocks from node0 in the background after node0 mines more 20 blocks?\r\n\r\nNo, the nodes indeed can not sync if they are not connected. But you are connecting the nodes in your test here: `self.connect_nodes(0, 1)`. In the moment the nodes are connected they also start syncing. You can see this for example by inserting `print(self.nodes[1].getblockcount())` in the line before your first assert and then running the test a couple of times. You will see that the node is not at 200 blocks anymore and each time you run the test it will be a different number because of this race between the different processes.\r\n\r\n> I thought the first `getblockfrompeer` into the assert would fail because I didn't setup it to sync blocks and the second one would work because of `self.sync_blocks()`.\r\n\r\nWhat `sync_blocks()` does is it waits for all the nodes to be caught up with each other. This ensures the reverse of our problem doesn't happen: a test where all the nodes need to be caught up to continue does not fail intermittently and so with that the second assert is safe. But for the first assert we would basically need the inverse of the functionality, i.e. something that ensures that the nodes are definitely not caught up with each other until we have finished what we want to test.\r\n\r\n",
      "created_at" : "2022-01-02T14:25:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1003723912",
      "id" : 1003723912,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII584705yI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003723912/reactions"
      },
      "updated_at" : "2022-01-02T14:25:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003723912",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think we have a working test now. I remembered that we can submit the header via a `P2PInterface` to the pruning node and that seems to work. :)",
      "created_at" : "2022-01-02T16:09:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1003738704",
      "id" : 1003738704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII584709ZQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003738704/reactions"
      },
      "updated_at" : "2022-01-02T16:09:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003738704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`You will see that the node is not at 200 blocks anymore and each time you run the test it will be a different number because of this race between the different processes.`\r\n\r\nYes, my bad. That approach would work because node0 is mining 200 blocks more, so probably node1 didn't get the last one before the assertion but they're syncing and it could cause intermittent failures. \r\n\r\n",
      "created_at" : "2022-01-02T19:01:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1003760112",
      "id" : 1003760112,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII58471Cnw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003760112/reactions"
      },
      "updated_at" : "2022-01-02T19:01:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1003760112",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, but light selfish preference for getting #23706 in first, since there's a (small) conflict.",
      "created_at" : "2022-01-06T16:12:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1006713554",
      "id" : 1006713554,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII5848ATrS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1006713554/reactions"
      },
      "updated_at" : "2022-01-06T16:12:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1006713554",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Weak concept NACK. I think it's better to allow it. Pruning is only best-effort anyway, not a guarantee.",
      "created_at" : "2022-01-12T07:07:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1010707650",
      "id" : 1010707650,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII5848PizC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1010707650/reactions"
      },
      "updated_at" : "2022-01-12T07:07:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1010707650",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-01-25T19:35:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1021538766",
      "id" : 1021538766,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII584843HO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021538766/reactions"
      },
      "updated_at" : "2022-01-25T19:35:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021538766",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased\r\n\r\n> Weak concept NACK. I think it's better to allow it. Pruning is only best-effort anyway, not a guarantee.\r\n\r\nWhy do you think it's better to allow it? Do you have any specific use cases in mind? Of course there is no guarantee to stay below the exact number but for `prune=550` this has the potential to double or tripple the number quickly. And the worst case scenario of crashing due to a full disc seems bad enough that it's worth to disable something where it's unclear if there is a use case for it at all (using the RPC in this way). If there is a use case I am genuinely interested in hearing about it and would then look for a better solution rather than just disallowing it.",
      "created_at" : "2022-01-25T20:26:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1021578454",
      "id" : 1021578454,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII58485AzW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021578454/reactions"
      },
      "updated_at" : "2022-01-25T20:26:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021578454",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In the context of ForkMonitor I use this feature to fetch blocks that are, by definition, at or below the tip height. I.e. stale blocks. This PR doesn't impact that use case, because these nodes are always up to date.\r\n\r\nIn fact, this PR adds some safety for when a fresh node is added to the site, or an existing node is reinstalled, and it's still catching up (though in practice we don't call `getblockfrompeer` on a node that is in IBD).\r\n\r\nAnother use case that seems obvious to me is to fetch an historical block, perhaps because you're rescanning a wallet. In that case I don't see any harm in waiting until the node is synced.",
      "created_at" : "2022-01-26T13:08:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1022180967",
      "id" : 1022180967,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII58487T5n",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1022180967/reactions"
      },
      "updated_at" : "2022-01-26T13:11:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1022180967",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-01-27T11:44:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1023123627",
      "id" : 1023123627,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII5848-6Cr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1023123627/reactions"
      },
      "updated_at" : "2022-01-27T11:44:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1023123627",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased",
      "created_at" : "2022-01-29T16:56:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1024947172",
      "id" : 1024947172,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII5849F3Pk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1024947172/reactions"
      },
      "updated_at" : "2022-01-29T16:56:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1024947172",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-06-01T07:12:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1143201857",
      "id" : 1143201857,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII585EI-BB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1143201857/reactions"
      },
      "updated_at" : "2022-06-01T07:12:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1143201857",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased",
      "created_at" : "2022-06-05T23:44:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1146908399",
      "id" : 1146908399,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII585EXG7v",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1146908399/reactions"
      },
      "updated_at" : "2022-06-05T23:44:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1146908399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 5826bf546e83478947edbdf49978414f0b69eb1a\r\n\r\nVery nice test.",
      "created_at" : "2022-07-18T09:49:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1186993432",
      "id" : 1186993432,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII585GwBUY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1186993432/reactions"
      },
      "updated_at" : "2022-07-18T09:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1186993432",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 5826bf546e83478947edbdf49978414f0b69eb1a",
      "created_at" : "2022-10-25T21:09:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#issuecomment-1291146675",
      "id" : 1291146675,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23927",
      "node_id" : "IC_kwDOABII585M9VWz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291146675/reactions"
      },
      "updated_at" : "2022-10-25T21:09:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1291146675",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23927#discussion_r1004994618"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004994618"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 7fa851fb: (non-blocking nit)\r\n\r\nWhy not use `IsBlockPruned` instead?\r\n\r\nWhich should be the same as saying that, on pruning mode, can only fetch blocks that were downloaded and discarded.",
      "commit_id" : "5826bf546e83478947edbdf49978414f0b69eb1a",
      "created_at" : "2022-10-25T21:50:35Z",
      "diff_hunk" : "@@ -453,6 +453,12 @@ static RPCHelpMan getblockfrompeer()\n         throw JSONRPCError(RPC_MISC_ERROR, \"Block header missing\");\n     }\n \n+    // Fetching blocks before the node has syncing past their height can prevent block files from\n+    // being pruned, so we avoid it if the node is in prune mode.\n+    if (index->nHeight > chainman.ActiveChain().Tip()->nHeight && node::fPruneMode) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#discussion_r1004994618",
      "id" : 1004994618,
      "line" : 458,
      "node_id" : "PRRC_kwDOABII58475wA6",
      "original_commit_id" : "7fa851fba8570ef256317f7d5759aa3de9088bf1",
      "original_line" : 458,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 6,
      "pull_request_review_id" : 1155552579,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004994618/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-25T21:50:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004994618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23927#discussion_r1005090009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1005090009"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If `IsBlockPruned` was used instead, fetching an older block that isn't pruned (blocks close to the genesis for instance) on a pruned node would result in the error `In prune mode, only blocks that the node has already synced previously can be fetched from a peer` instead of `Block already downloaded`.",
      "commit_id" : "5826bf546e83478947edbdf49978414f0b69eb1a",
      "created_at" : "2022-10-26T00:21:47Z",
      "diff_hunk" : "@@ -453,6 +453,12 @@ static RPCHelpMan getblockfrompeer()\n         throw JSONRPCError(RPC_MISC_ERROR, \"Block header missing\");\n     }\n \n+    // Fetching blocks before the node has syncing past their height can prevent block files from\n+    // being pruned, so we avoid it if the node is in prune mode.\n+    if (index->nHeight > chainman.ActiveChain().Tip()->nHeight && node::fPruneMode) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23927#discussion_r1005090009",
      "id" : 1005090009,
      "in_reply_to_id" : 1004994618,
      "line" : 458,
      "node_id" : "PRRC_kwDOABII58476HTZ",
      "original_commit_id" : "7fa851fba8570ef256317f7d5759aa3de9088bf1",
      "original_line" : 458,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 6,
      "pull_request_review_id" : 1155700324,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1005090009/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-26T00:21:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1005090009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   }
]
