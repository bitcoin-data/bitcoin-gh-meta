[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22838](https://github.com/bitcoin/bitcoin/pull/22838) (descriptors: Be able to specify change and receiving in a single descriptor string by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-10-04T14:33:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-933547369",
      "id" : 933547369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII5843pM1p",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933547369/reactions"
      },
      "updated_at" : "2022-01-11T09:44:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933547369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23171#discussion_r732089930"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23171"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732089930"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`/*mixed_pubkeys = */mixed_pubkeys` looks a bit superfluous",
      "commit_id" : "6ae2d37c7112656f3fb09e5fabc016345f73aa06",
      "created_at" : "2021-10-19T17:24:13Z",
      "diff_hunk" : "@@ -268,29 +268,33 @@ void DoCheck(const std::string& prv, const std::string& pub, const std::string&\n     BOOST_CHECK_MESSAGE(left_paths.empty(), \"Not all expected key paths found: \" + prv);\n }\n \n-void Check(const std::string& prv, const std::string& pub, const std::string& norm_prv, const std::string& norm_pub, int flags, const std::vector<std::vector<std::string>>& scripts, const std::optional<OutputType>& type, const std::set<std::vector<uint32_t>>& paths = ONLY_EMPTY)\n+void Check(const std::string& prv, const std::string& pub, const std::string& norm_prv, const std::string& norm_pub, int flags, const std::vector<std::vector<std::string>>& scripts, const std::optional<OutputType>& type, const std::set<std::vector<uint32_t>>& paths = ONLY_EMPTY, bool mixed_pubkeys=false)\n {\n     bool found_apostrophes_in_prv = false;\n     bool found_apostrophes_in_pub = false;\n \n     // Do not replace apostrophes with 'h' in prv and pub\n-    DoCheck(prv, pub, norm_prv, norm_pub, flags, scripts, type, paths);\n+    DoCheck(prv, pub, norm_prv, norm_pub, flags, scripts, type, paths, /* replace_apostrophe_with_h_in_prv = */false,\n+            /*replace_apostrophe_with_h_in_pub = */false, /*mixed_pubkeys = */mixed_pubkeys);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#discussion_r732089930",
      "id" : 732089930,
      "line" : 278,
      "node_id" : "PRRC_kwDOABII584ros5K",
      "original_commit_id" : "6ae2d37c7112656f3fb09e5fabc016345f73aa06",
      "original_line" : 278,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : 51,
      "pull_request_review_id" : 783579108,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23171",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732089930/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-19T17:24:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732089930",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/35263201?v=4",
         "events_url" : "https://api.github.com/users/amadeuszpawlik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amadeuszpawlik/followers",
         "following_url" : "https://api.github.com/users/amadeuszpawlik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amadeuszpawlik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amadeuszpawlik",
         "id" : 35263201,
         "login" : "amadeuszpawlik",
         "node_id" : "MDQ6VXNlcjM1MjYzMjAx",
         "organizations_url" : "https://api.github.com/users/amadeuszpawlik/orgs",
         "received_events_url" : "https://api.github.com/users/amadeuszpawlik/received_events",
         "repos_url" : "https://api.github.com/users/amadeuszpawlik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amadeuszpawlik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amadeuszpawlik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amadeuszpawlik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23171#discussion_r732516582"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23171"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732516582"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Definitely agree. However it's part of the guidelines and if i don't add it someone else could well do the opposite comment (\"the newly introduced parameter does not respect the guideline\"), so i'll just leave it as is :)",
      "commit_id" : "6ae2d37c7112656f3fb09e5fabc016345f73aa06",
      "created_at" : "2021-10-20T08:08:01Z",
      "diff_hunk" : "@@ -268,29 +268,33 @@ void DoCheck(const std::string& prv, const std::string& pub, const std::string&\n     BOOST_CHECK_MESSAGE(left_paths.empty(), \"Not all expected key paths found: \" + prv);\n }\n \n-void Check(const std::string& prv, const std::string& pub, const std::string& norm_prv, const std::string& norm_pub, int flags, const std::vector<std::vector<std::string>>& scripts, const std::optional<OutputType>& type, const std::set<std::vector<uint32_t>>& paths = ONLY_EMPTY)\n+void Check(const std::string& prv, const std::string& pub, const std::string& norm_prv, const std::string& norm_pub, int flags, const std::vector<std::vector<std::string>>& scripts, const std::optional<OutputType>& type, const std::set<std::vector<uint32_t>>& paths = ONLY_EMPTY, bool mixed_pubkeys=false)\n {\n     bool found_apostrophes_in_prv = false;\n     bool found_apostrophes_in_pub = false;\n \n     // Do not replace apostrophes with 'h' in prv and pub\n-    DoCheck(prv, pub, norm_prv, norm_pub, flags, scripts, type, paths);\n+    DoCheck(prv, pub, norm_prv, norm_pub, flags, scripts, type, paths, /* replace_apostrophe_with_h_in_prv = */false,\n+            /*replace_apostrophe_with_h_in_pub = */false, /*mixed_pubkeys = */mixed_pubkeys);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#discussion_r732516582",
      "id" : 732516582,
      "in_reply_to_id" : 732089930,
      "line" : 278,
      "node_id" : "PRRC_kwDOABII584rqVDm",
      "original_commit_id" : "6ae2d37c7112656f3fb09e5fabc016345f73aa06",
      "original_line" : 278,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : 51,
      "pull_request_review_id" : 784134157,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23171",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732516582/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T08:08:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732516582",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "tACK 6ae2d37c7112656f3fb09e5fabc016345f73aa06, looks good to me",
      "created_at" : "2021-10-20T09:31:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-947492088",
      "id" : 947492088,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII5844eZT4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947492088/reactions"
      },
      "updated_at" : "2021-10-20T09:31:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/947492088",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/35263201?v=4",
         "events_url" : "https://api.github.com/users/amadeuszpawlik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amadeuszpawlik/followers",
         "following_url" : "https://api.github.com/users/amadeuszpawlik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amadeuszpawlik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amadeuszpawlik",
         "id" : 35263201,
         "login" : "amadeuszpawlik",
         "node_id" : "MDQ6VXNlcjM1MjYzMjAx",
         "organizations_url" : "https://api.github.com/users/amadeuszpawlik/orgs",
         "received_events_url" : "https://api.github.com/users/amadeuszpawlik/received_events",
         "repos_url" : "https://api.github.com/users/amadeuszpawlik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amadeuszpawlik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amadeuszpawlik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amadeuszpawlik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23171#discussion_r732586698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23171"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732586698"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good point, thanks for clarifying ð",
      "commit_id" : "6ae2d37c7112656f3fb09e5fabc016345f73aa06",
      "created_at" : "2021-10-20T09:32:25Z",
      "diff_hunk" : "@@ -268,29 +268,33 @@ void DoCheck(const std::string& prv, const std::string& pub, const std::string&\n     BOOST_CHECK_MESSAGE(left_paths.empty(), \"Not all expected key paths found: \" + prv);\n }\n \n-void Check(const std::string& prv, const std::string& pub, const std::string& norm_prv, const std::string& norm_pub, int flags, const std::vector<std::vector<std::string>>& scripts, const std::optional<OutputType>& type, const std::set<std::vector<uint32_t>>& paths = ONLY_EMPTY)\n+void Check(const std::string& prv, const std::string& pub, const std::string& norm_prv, const std::string& norm_pub, int flags, const std::vector<std::vector<std::string>>& scripts, const std::optional<OutputType>& type, const std::set<std::vector<uint32_t>>& paths = ONLY_EMPTY, bool mixed_pubkeys=false)\n {\n     bool found_apostrophes_in_prv = false;\n     bool found_apostrophes_in_pub = false;\n \n     // Do not replace apostrophes with 'h' in prv and pub\n-    DoCheck(prv, pub, norm_prv, norm_pub, flags, scripts, type, paths);\n+    DoCheck(prv, pub, norm_prv, norm_pub, flags, scripts, type, paths, /* replace_apostrophe_with_h_in_prv = */false,\n+            /*replace_apostrophe_with_h_in_pub = */false, /*mixed_pubkeys = */mixed_pubkeys);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#discussion_r732586698",
      "id" : 732586698,
      "in_reply_to_id" : 732089930,
      "line" : 278,
      "node_id" : "PRRC_kwDOABII584rqmLK",
      "original_commit_id" : "6ae2d37c7112656f3fb09e5fabc016345f73aa06",
      "original_line" : 278,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/test/descriptor_tests.cpp",
      "position" : 51,
      "pull_request_review_id" : 784232018,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23171",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732586698/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T09:32:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732586698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/35263201?v=4",
         "events_url" : "https://api.github.com/users/amadeuszpawlik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amadeuszpawlik/followers",
         "following_url" : "https://api.github.com/users/amadeuszpawlik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amadeuszpawlik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amadeuszpawlik",
         "id" : 35263201,
         "login" : "amadeuszpawlik",
         "node_id" : "MDQ6VXNlcjM1MjYzMjAx",
         "organizations_url" : "https://api.github.com/users/amadeuszpawlik/orgs",
         "received_events_url" : "https://api.github.com/users/amadeuszpawlik/received_events",
         "repos_url" : "https://api.github.com/users/amadeuszpawlik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amadeuszpawlik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amadeuszpawlik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amadeuszpawlik"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @achow101 @sipa ",
      "created_at" : "2021-12-08T07:36:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-988569814",
      "id" : 988569814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII58467GDW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/988569814/reactions"
      },
      "updated_at" : "2021-12-08T07:36:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/988569814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "While I like the idea of testing mixed ranged and const pubkeys, I don't think this is the right approach.\r\n\r\nFor starters, we have a `flags` field to indicate what to check for, so I think it would be better to add `mixed_pubkeys` as an additional flag rather than as a bool. Secondly, this doesn't really test that the right keys are there. Rather it just disables the cache checks when there are mixed ranged and const keys. IMO the correct thing to do would be to retain those checks, with modifications to allow for the mixed case when the appropriate flag is set.",
      "created_at" : "2021-12-08T14:29:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-988863633",
      "id" : 988863633,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII58468NyR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/988863633/reactions"
      },
      "updated_at" : "2021-12-08T14:29:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/988863633",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Definitely agree the approach is clumsy. However this does test that we can parse descriptors with mixed const and extended pubkeys. Keeping the check on the number of xpubs cached in this case would require either adding a new getter to `Descriptor` or parsing the number of xpubs directly from the string, and both approaches sound overkill.\r\n\r\nPushed the change to use the flag instead of the boolean.",
      "created_at" : "2021-12-08T20:00:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-989151662",
      "id" : 989151662,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII58469UGu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989151662/reactions"
      },
      "updated_at" : "2021-12-08T20:00:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989151662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "```diff\r\ndiff --git a/src/test/descriptor_tests.cpp b/src/test/descriptor_tests.cpp\r\nindex 68584307b2..4d5ef381d0 100644\r\n--- a/src/test/descriptor_tests.cpp\r\n+++ b/src/test/descriptor_tests.cpp\r\n@@ -74,6 +74,18 @@ std::string UseHInsteadOfApostrophe(const std::string& desc)\r\n     return ret;\r\n }\r\n \r\n+// Count the number of times the string \"xpub\" appears in a descriptor string\r\n+static size_t CountXpubs(const std::string& desc)\r\n+{\r\n+    size_t count = 0;\r\n+    size_t p = desc.find(\"xpub\", 0);\r\n+    while (p != std::string::npos) {\r\n+        count++;\r\n+        p = desc.find(\"xpub\", p + 1);\r\n+    }\r\n+    return count;\r\n+}\r\n+\r\n const std::set<std::vector<uint32_t>> ONLY_EMPTY{{}};\r\n \r\n void DoCheck(const std::string& prv, const std::string& pub, const std::string& norm_prv, const std::string& norm_pub, int flags, const std::vector<std::vector<std::string>>& scripts, const std::optional<OutputType>& type, const std::set<std::vector<uint32_t>>& paths = ONLY_EMPTY,\r\n@@ -172,7 +184,8 @@ void DoCheck(const std::string& prv, const std::string& pub, const std::string&\r\n             // Check whether keys are in the cache\r\n             const auto& der_xpub_cache = desc_cache.GetCachedDerivedExtPubKeys();\r\n             const auto& parent_xpub_cache = desc_cache.GetCachedParentExtPubKeys();\r\n-            if ((flags & RANGE) && !(flags & (DERIVE_HARDENED | MIXED_PUBKEYS))) {\r\n+            const size_t num_xpubs = CountXpubs(pub1);\r\n+            if ((flags & RANGE) && !(flags & (DERIVE_HARDENED))) {\r\n                 // For ranged, unhardened derivation, None of the keys in origins should appear in the cache but the cache should have parent keys\r\n                 // But we can derive one level from each of those parent keys and find them all\r\n                 BOOST_CHECK(der_xpub_cache.empty());\r\n@@ -184,13 +197,22 @@ void DoCheck(const std::string& prv, const std::string& pub, const std::string&\r\n                     xpub.Derive(der, i);\r\n                     pubkeys.insert(der.pubkey);\r\n                 }\r\n+                int count_pks = 0;\r\n                 for (const auto& origin_pair : script_provider_cached.origins) {\r\n                     const CPubKey& pk = origin_pair.second.first;\r\n-                    BOOST_CHECK(pubkeys.count(pk) > 0);\r\n+                    count_pks += pubkeys.count(pk);\r\n                 }\r\n-            } else if (!(flags & MIXED_PUBKEYS) && pub1.find(\"xpub\") != std::string::npos) {\r\n+                if (flags & MIXED_PUBKEYS) {\r\n+                    BOOST_CHECK_EQUAL(num_xpubs, count_pks);\r\n+                } else {\r\n+                    BOOST_CHECK_EQUAL(script_provider_cached.origins.size(), count_pks);\r\n+                }\r\n+            } else if (num_xpubs > 0) {\r\n                 // For ranged, hardened derivation, or not ranged, but has an xpub, all of the keys should appear in the cache\r\n-                BOOST_CHECK(der_xpub_cache.size() + parent_xpub_cache.size() == script_provider_cached.origins.size());\r\n+                BOOST_CHECK(der_xpub_cache.size() + parent_xpub_cache.size() == num_xpubs);\r\n+                if (!(flags & MIXED_PUBKEYS)) {\r\n+                    BOOST_CHECK(num_xpubs == script_provider_cached.origins.size());\r\n+                }\r\n                 // Get all of the derived pubkeys\r\n                 std::set<CPubKey> pubkeys;\r\n                 for (const auto& xpub_map_pair : der_xpub_cache) {\r\n@@ -207,9 +229,15 @@ void DoCheck(const std::string& prv, const std::string& pub, const std::string&\r\n                     xpub.Derive(der, i);\r\n                     pubkeys.insert(der.pubkey);\r\n                 }\r\n+                int count_pks = 0;\r\n                 for (const auto& origin_pair : script_provider_cached.origins) {\r\n                     const CPubKey& pk = origin_pair.second.first;\r\n-                    BOOST_CHECK(pubkeys.count(pk) > 0);\r\n+                    count_pks += pubkeys.count(pk);\r\n+                }\r\n+                if (flags & MIXED_PUBKEYS) {\r\n+                    BOOST_CHECK_EQUAL(num_xpubs, count_pks);\r\n+                } else {\r\n+                    BOOST_CHECK_EQUAL(script_provider_cached.origins.size(), count_pks);\r\n                 }\r\n             } else if (!(flags & MIXED_PUBKEYS)) {\r\n                 // Only const pubkeys, nothing should be cached\r\n```",
      "created_at" : "2021-12-08T22:35:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-989282667",
      "id" : 989282667,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII584690Fr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989282667/reactions"
      },
      "updated_at" : "2021-12-08T22:35:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989282667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Well, whatever. Amended the commit with your patch.",
      "created_at" : "2021-12-09T11:10:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-989753013",
      "id" : 989753013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII5846_m61",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989753013/reactions"
      },
      "updated_at" : "2021-12-09T11:10:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989753013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Anything else that needs to be done there?",
      "created_at" : "2022-01-20T10:45:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-1017350408",
      "id" : 1017350408,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII5848o4kI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017350408/reactions"
      },
      "updated_at" : "2022-01-20T10:45:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017350408",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 36012ef143917f97179d3ba6599ef36a26a9a014",
      "created_at" : "2022-01-20T17:22:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23171#issuecomment-1017739559",
      "id" : 1017739559,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23171",
      "node_id" : "IC_kwDOABII5848qXkn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017739559/reactions"
      },
      "updated_at" : "2022-01-20T17:22:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017739559",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
