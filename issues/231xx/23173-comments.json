[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r721366984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721366984"
         }
      },
      "author_association" : "MEMBER",
      "body" : "wrong\r\n\r\n```suggestion\r\n        const MempoolAcceptResult result = m_node.chainman->ProcessTransaction(MakeTransactionRef(mempool_txn), /* test_accept */ false);\r\n```",
      "commit_id" : "87a286d0cb05be21f3e000ed4ec78773b4919b1b",
      "created_at" : "2021-10-04T13:31:06Z",
      "diff_hunk" : "@@ -315,7 +315,7 @@ CMutableTransaction TestChain100Setup::CreateValidMempoolTransaction(CTransactio\n     // If submit=true, add transaction to the mempool.\n     if (submit) {\n         LOCK(cs_main);\n-        const MempoolAcceptResult result = AcceptToMemoryPool(m_node.chainman->ActiveChainstate(), *m_node.mempool.get(), MakeTransactionRef(mempool_txn), /* bypass_limits */ false);\n+        const MempoolAcceptResult result = m_node.chainman->ProcessTransaction(MakeTransactionRef(mempool_txn), /* bypass_limits */ false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r721366984",
      "id" : 721366984,
      "line" : 318,
      "node_id" : "PRRC_kwDOABII584q_y_I",
      "original_commit_id" : "87a286d0cb05be21f3e000ed4ec78773b4919b1b",
      "original_line" : 318,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/util/setup_common.cpp",
      "position" : 5,
      "pull_request_review_id" : 770299269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721366984/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-04T13:31:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721366984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#21527](https://github.com/bitcoin/bitcoin/pull/21527) (net_processing: lock clean up by ajtowns)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-10-04T14:22:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-933537749",
      "id" : 933537749,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII5843pKfV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933537749/reactions"
      },
      "updated_at" : "2021-10-30T05:50:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933537749",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, looks like a good change. Will review soon.",
      "created_at" : "2021-10-04T14:47:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-933559585",
      "id" : 933559585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII5843pP0h",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933559585/reactions"
      },
      "updated_at" : "2021-10-04T14:47:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933559585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r721511017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721511017"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed!",
      "commit_id" : "58538ff6fff81f185df295a1a73f70c40e9a46c4",
      "created_at" : "2021-10-04T16:08:41Z",
      "diff_hunk" : "@@ -315,7 +315,7 @@ CMutableTransaction TestChain100Setup::CreateValidMempoolTransaction(CTransactio\n     // If submit=true, add transaction to the mempool.\n     if (submit) {\n         LOCK(cs_main);\n-        const MempoolAcceptResult result = AcceptToMemoryPool(m_node.chainman->ActiveChainstate(), *m_node.mempool.get(), MakeTransactionRef(mempool_txn), /* bypass_limits */ false);\n+        const MempoolAcceptResult result = m_node.chainman->ProcessTransaction(MakeTransactionRef(mempool_txn), /* bypass_limits */ false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r721511017",
      "id" : 721511017,
      "in_reply_to_id" : 721366984,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rAWJp",
      "original_commit_id" : "87a286d0cb05be21f3e000ed4ec78773b4919b1b",
      "original_line" : 318,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/util/setup_common.cpp",
      "position" : null,
      "pull_request_review_id" : 770498400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721511017/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-04T16:08:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721511017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Resolved @MarcoFalke's review comment and added a missing lock annotation.",
      "created_at" : "2021-10-04T16:09:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-933634281",
      "id" : 933634281,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII5843piDp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933634281/reactions"
      },
      "updated_at" : "2021-10-04T16:09:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/933634281",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-10-05T10:21:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-934274316",
      "id" : 934274316,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII5843r-UM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/934274316/reactions"
      },
      "updated_at" : "2021-10-05T10:21:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/934274316",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fixed up an error string and rebased on master to (hopefully) pick up fixes for unrelated CI failures. The fuzz test will still fail, so I'll try to fix that next.",
      "created_at" : "2021-10-07T09:51:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-937634357",
      "id" : 937634357,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII58434yo1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937634357/reactions"
      },
      "updated_at" : "2021-10-07T09:51:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937634357",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've reverted the change that made `AcceptToMemoryPool()` static and left it as dynamically linkable for use by the mempool fuzz test (which was operating on a separate CChainState and CTxMemPool).",
      "created_at" : "2021-10-07T14:00:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-937822056",
      "id" : 937822056,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII58435gdo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937822056/reactions"
      },
      "updated_at" : "2021-10-07T14:00:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/937822056",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r726216627"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726216627"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "could you explain why this move is needed? is it to reduce the diff? 179e0fb1456cf7f75517d537ba68774d59312311 _Move CChainState::MaybeUpdateMempoolForReorg() lower in validation.cpp_",
      "commit_id" : "1d20d4330e21ab600747ced872eba372a08086c5",
      "created_at" : "2021-10-11T15:24:47Z",
      "diff_hunk" : "@@ -330,54 +330,6 @@ static bool IsCurrentForFeeEstimation(CChainState& active_chainstate) EXCLUSIVE_\n     return true;\n }\n \n-void CChainState::MaybeUpdateMempoolForReorg(",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r726216627",
      "id" : 726216627,
      "line" : 333,
      "node_id" : "PRRC_kwDOABII584rSS-z",
      "original_commit_id" : "179e0fb1456cf7f75517d537ba68774d59312311",
      "original_line" : 333,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 18,
      "pull_request_review_id" : 776403166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726216627/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-12T08:30:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726216627",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r726220398"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726220398"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why can't ATMP be static and `ProcessTransaction` be called from the fuzz test instead?",
      "commit_id" : "1d20d4330e21ab600747ced872eba372a08086c5",
      "created_at" : "2021-10-11T15:29:33Z",
      "diff_hunk" : "@@ -205,11 +205,7 @@ struct PackageMempoolAcceptResult\n         : m_tx_results{ {wtxid, result} } {}\n };\n \n-/**\n- * (Try to) add a transaction to the memory pool.\n- * @param[in]  bypass_limits   When true, don't enforce mempool fee limits.\n- * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n- */\n+/** Internal function. Exposed only for fuzz testing. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r726220398",
      "id" : 726220398,
      "line" : 208,
      "node_id" : "PRRC_kwDOABII584rST5u",
      "original_commit_id" : "1d20d4330e21ab600747ced872eba372a08086c5",
      "original_line" : 208,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 9,
      "pull_request_review_id" : 776403166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726220398/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-12T08:30:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726220398",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r726221352"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726221352"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "93bdbf468addd11581a5f1a4465147da24920235 adds a doxygen comment that is deleted 3 commits later. Might not be necessary...",
      "commit_id" : "1d20d4330e21ab600747ced872eba372a08086c5",
      "created_at" : "2021-10-11T15:30:48Z",
      "diff_hunk" : "@@ -997,6 +997,15 @@ class ChainstateManager\n      */\n     bool ProcessNewBlockHeaders(const std::vector<CBlockHeader>& block, BlockValidationState& state, const CChainParams& chainparams, const CBlockIndex** ppindex = nullptr) LOCKS_EXCLUDED(cs_main);\n \n+    /**\n+     * (Try to) add a transaction to the memory pool.\n+     *\n+     * @param[in]  bypass_limits   When true, don't enforce mempool fee limits.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r726221352",
      "id" : 726221352,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rSUIo",
      "original_commit_id" : "93bdbf468addd11581a5f1a4465147da24920235",
      "original_line" : 1003,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 776403166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726221352/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-12T08:30:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726221352",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r726885395"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726885395"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I also wonder if, now that `AcceptToMemoryPool` is nothing but a wrapper for `AcceptToMemoryPoolWithTime`, we could just delete ATMP and call ATMPWT. It would also make it easier to make sure we'reremoving mentions of ATMP throughout the codebase.",
      "commit_id" : "1d20d4330e21ab600747ced872eba372a08086c5",
      "created_at" : "2021-10-12T08:30:49Z",
      "diff_hunk" : "@@ -205,11 +205,7 @@ struct PackageMempoolAcceptResult\n         : m_tx_results{ {wtxid, result} } {}\n };\n \n-/**\n- * (Try to) add a transaction to the memory pool.\n- * @param[in]  bypass_limits   When true, don't enforce mempool fee limits.\n- * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n- */\n+/** Internal function. Exposed only for fuzz testing. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r726885395",
      "id" : 726885395,
      "in_reply_to_id" : 726220398,
      "line" : 208,
      "node_id" : "PRRC_kwDOABII584rU2QT",
      "original_commit_id" : "1d20d4330e21ab600747ced872eba372a08086c5",
      "original_line" : 208,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : 9,
      "pull_request_review_id" : 776403166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726885395/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-12T08:30:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/726885395",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r731891235"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731891235"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oops. This is leftover from a previous version of the branch where I made ATMP static in validation.cpp and removed the declaration from validation.h. That meant moving all of the callers of ATMP to be lower in the file (or adding a forward declaration).\r\n\r\nI've now left ATMP in the header as a test-only function, so this commit is no longer required.",
      "commit_id" : "1d20d4330e21ab600747ced872eba372a08086c5",
      "created_at" : "2021-10-19T13:53:00Z",
      "diff_hunk" : "@@ -330,54 +330,6 @@ static bool IsCurrentForFeeEstimation(CChainState& active_chainstate) EXCLUSIVE_\n     return true;\n }\n \n-void CChainState::MaybeUpdateMempoolForReorg(",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r731891235",
      "id" : 731891235,
      "in_reply_to_id" : 726216627,
      "line" : 333,
      "node_id" : "PRRC_kwDOABII584rn8Yj",
      "original_commit_id" : "179e0fb1456cf7f75517d537ba68774d59312311",
      "original_line" : 333,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 18,
      "pull_request_review_id" : 783313098,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731891235/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-19T13:53:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731891235",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r731895386"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731895386"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The fuzz test is using a derived class of the mempool called `MockedTxPool`, which isn't referenced from the `CChainState` object, and so it can't use the `ChainstateManager` interface to submit transactions to the mempool.\r\n\r\nIt may be possible to clean this up in future so the fuzz test is only using public interfaces, but I think that can be left for another PR.\r\n\r\n> I also wonder if, now that AcceptToMemoryPool is nothing but a wrapper for AcceptToMemoryPoolWithTime, we could just delete ATMP and call ATMPWT.\r\n\r\nI agree that we can flatten those function calls. I'd prefer to remove ATMP and then rename ATMPWT to ATMP and update the call sites, but I think we can leave that for a follow-up PR.",
      "commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "created_at" : "2021-10-19T13:56:45Z",
      "diff_hunk" : "@@ -205,11 +205,7 @@ struct PackageMempoolAcceptResult\n         : m_tx_results{ {wtxid, result} } {}\n };\n \n-/**\n- * (Try to) add a transaction to the memory pool.\n- * @param[in]  bypass_limits   When true, don't enforce mempool fee limits.\n- * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n- */\n+/** Internal function. Exposed only for fuzz testing. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r731895386",
      "id" : 731895386,
      "in_reply_to_id" : 726220398,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rn9Za",
      "original_commit_id" : "1d20d4330e21ab600747ced872eba372a08086c5",
      "original_line" : 208,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 783318808,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731895386/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-19T16:40:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731895386",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732078334"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732078334"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not necessary, but might be confusing for reviewers if I add a doxygen comment in 93bdbf4 that doesn't document all the parameters.",
      "commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "created_at" : "2021-10-19T17:09:16Z",
      "diff_hunk" : "@@ -997,6 +997,15 @@ class ChainstateManager\n      */\n     bool ProcessNewBlockHeaders(const std::vector<CBlockHeader>& block, BlockValidationState& state, const CChainParams& chainparams, const CBlockIndex** ppindex = nullptr) LOCKS_EXCLUDED(cs_main);\n \n+    /**\n+     * (Try to) add a transaction to the memory pool.\n+     *\n+     * @param[in]  bypass_limits   When true, don't enforce mempool fee limits.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732078334",
      "id" : 732078334,
      "in_reply_to_id" : 726221352,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584roqD-",
      "original_commit_id" : "93bdbf468addd11581a5f1a4465147da24920235",
      "original_line" : 1003,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 783564444,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732078334/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-19T17:09:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732078334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the reviews @glozow and @promag. I've addressed all review comments.",
      "created_at" : "2021-10-19T17:14:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-946932130",
      "id" : 946932130,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII5844cQmi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/946932130/reactions"
      },
      "updated_at" : "2021-10-19T17:14:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/946932130",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732942466"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732942466"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "bypass_limits also allows the mempool to grow past the maximum size: https://github.com/bitcoin/bitcoin/blob/3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7/src/validation.cpp#L914",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-20T16:17:14Z",
      "diff_hunk" : "@@ -206,12 +206,20 @@ struct PackageMempoolAcceptResult\n };\n \n /**\n- * (Try to) add a transaction to the memory pool.\n- * @param[in]  bypass_limits   When true, don't enforce mempool fee limits.\n- * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n+ * Try to add a transaction to the mempool. This is an internal function and is\n+ * exposed only for testing. Client code should use ChainstateManager::ProcessTransaction()\n+ *\n+ * @param[in]  active_chainstate  Reference to the active chainstate.\n+ * @param[in]  pool               Reference to the node's mempool.\n+ * @param[in]  tx                 The transaction to submit for mempool acceptance.\n+ * @param[in]  bypass_limits      When true, don't enforce mempool fee limits.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732942466",
      "id" : 732942466,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rr9CC",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 215,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 784717677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732942466/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T16:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732942466",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732942757"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732942757"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit in f21c86c6fa\r\n```suggestion\r\n    const auto result = AcceptToMemoryPool(active_chainstate, *active_chainstate.m_mempool, tx, /* bypass_limits= */ false, test_accept);\r\n```",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-20T16:17:34Z",
      "diff_hunk" : "@@ -3433,6 +3431,20 @@ bool ChainstateManager::ProcessNewBlock(const CChainParams& chainparams, const s\n     return true;\n }\n \n+MempoolAcceptResult ChainstateManager::ProcessTransaction(const CTransactionRef& tx,\n+                                                          bool test_accept)\n+{\n+    CChainState& active_chainstate = ActiveChainstate();\n+    if (!active_chainstate.m_mempool) {\n+        TxValidationState state;\n+        state.Invalid(TxValidationResult::TX_NO_MEMPOOL);\n+        return MempoolAcceptResult::Failure(state);\n+    }\n+    auto result = AcceptToMemoryPool(active_chainstate, *active_chainstate.m_mempool, tx, /* bypass_limits= */ false, test_accept);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732942757",
      "id" : 732942757,
      "line" : 3433,
      "node_id" : "PRRC_kwDOABII584rr9Gl",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 3433,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 36,
      "pull_request_review_id" : 784717677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732942757/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T16:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732942757",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732944744"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732944744"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "in aad911d28b: I don't disagree with this change (in fact it would be nice to remove the default argument in the future since it's common to mix up the two bools), but it's not related to this commit.",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-20T16:19:58Z",
      "diff_hunk" : "@@ -350,7 +350,7 @@ void CChainState::MaybeUpdateMempoolForReorg(\n         // ignore validation errors in resurrected transactions\n         if (!fAddToMempool || (*it)->IsCoinBase() ||\n             AcceptToMemoryPool(\n-                *this, *m_mempool, *it, true /* bypass_limits */).m_result_type !=\n+                *this, *m_mempool, *it, true /* bypass_limits */, /* test_accept= */ false).m_result_type !=",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732944744",
      "id" : 732944744,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rr9lo",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 353,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 784717677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732944744/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T16:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732944744",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732948334"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732948334"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The addition of the /* bypass_limits= */ comment should be moved from 90f1a1f8cf to f21c86c6fa",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-20T16:24:12Z",
      "diff_hunk" : "@@ -3433,6 +3431,20 @@ bool ChainstateManager::ProcessNewBlock(const CChainParams& chainparams, const s\n     return true;\n }\n \n+MempoolAcceptResult ChainstateManager::ProcessTransaction(const CTransactionRef& tx,\n+                                                          bool test_accept)\n+{\n+    CChainState& active_chainstate = ActiveChainstate();\n+    if (!active_chainstate.m_mempool) {\n+        TxValidationState state;\n+        state.Invalid(TxValidationResult::TX_NO_MEMPOOL);\n+        return MempoolAcceptResult::Failure(state);\n+    }\n+    auto result = AcceptToMemoryPool(active_chainstate, *active_chainstate.m_mempool, tx, /* bypass_limits= */ false, test_accept);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732948334",
      "id" : 732948334,
      "in_reply_to_id" : 732942757,
      "line" : 3433,
      "node_id" : "PRRC_kwDOABII584rr-du",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 3433,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 36,
      "pull_request_review_id" : 784717677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732948334/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T16:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732948334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732956508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732956508"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "in 48e69da541: it would be nice for the compiler to let us know we aren't doing all this validation work for nothing, how about a lil dash of C++17 spice?\r\n```suggestion\r\n    [[nodiscard]] MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool test_accept=false)\r\n```",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-20T16:34:06Z",
      "diff_hunk" : "@@ -997,6 +1005,15 @@ class ChainstateManager\n      */\n     bool ProcessNewBlockHeaders(const std::vector<CBlockHeader>& block, BlockValidationState& state, const CChainParams& chainparams, const CBlockIndex** ppindex = nullptr) LOCKS_EXCLUDED(cs_main);\n \n+    /**\n+     * Try to add a transaction to the memory pool.\n+     *\n+     * @param[in]  tx              The transaction to submit for mempool acceptance.\n+     * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n+     */\n+    MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool test_accept=false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r732956508",
      "id" : 732956508,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rsAdc",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 1014,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 784717677,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732956508/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-20T16:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/732956508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-10-25T14:19:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-950978343",
      "id" : 950978343,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII5844rscn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/950978343/reactions"
      },
      "updated_at" : "2021-10-25T14:19:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/950978343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r739133450"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133450"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done! :hot_pepper: ",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-29T10:52:24Z",
      "diff_hunk" : "@@ -997,6 +1005,15 @@ class ChainstateManager\n      */\n     bool ProcessNewBlockHeaders(const std::vector<CBlockHeader>& block, BlockValidationState& state, const CChainParams& chainparams, const CBlockIndex** ppindex = nullptr) LOCKS_EXCLUDED(cs_main);\n \n+    /**\n+     * Try to add a transaction to the memory pool.\n+     *\n+     * @param[in]  tx              The transaction to submit for mempool acceptance.\n+     * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n+     */\n+    MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool test_accept=false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r739133450",
      "id" : 739133450,
      "in_reply_to_id" : 732956508,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sDkgK",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 1014,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 792897358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133450/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-29T10:52:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133450",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r739133471"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133471"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You're right. I've removed it and will leave for a future cleanup.",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-29T10:52:27Z",
      "diff_hunk" : "@@ -350,7 +350,7 @@ void CChainState::MaybeUpdateMempoolForReorg(\n         // ignore validation errors in resurrected transactions\n         if (!fAddToMempool || (*it)->IsCoinBase() ||\n             AcceptToMemoryPool(\n-                *this, *m_mempool, *it, true /* bypass_limits */).m_result_type !=\n+                *this, *m_mempool, *it, true /* bypass_limits */, /* test_accept= */ false).m_result_type !=",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r739133471",
      "id" : 739133471,
      "in_reply_to_id" : 732944744,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sDkgf",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 353,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 792897396,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133471/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-29T10:52:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133471",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r739133488"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133488"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't agree. Prior to 90f1a1f8cf8ba4a11b2f93b55d1c0e25bcdcdd6f, the argument passed here is a named variable `bypass_limits`. In that commit we change it to be the literal `false`, so adding the `/* bypass_limits= */` comment makes it obvious which argument we're passing.",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-29T10:52:28Z",
      "diff_hunk" : "@@ -3433,6 +3431,20 @@ bool ChainstateManager::ProcessNewBlock(const CChainParams& chainparams, const s\n     return true;\n }\n \n+MempoolAcceptResult ChainstateManager::ProcessTransaction(const CTransactionRef& tx,\n+                                                          bool test_accept)\n+{\n+    CChainState& active_chainstate = ActiveChainstate();\n+    if (!active_chainstate.m_mempool) {\n+        TxValidationState state;\n+        state.Invalid(TxValidationResult::TX_NO_MEMPOOL);\n+        return MempoolAcceptResult::Failure(state);\n+    }\n+    auto result = AcceptToMemoryPool(active_chainstate, *active_chainstate.m_mempool, tx, /* bypass_limits= */ false, test_accept);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r739133488",
      "id" : 739133488,
      "in_reply_to_id" : 732942757,
      "line" : 3433,
      "node_id" : "PRRC_kwDOABII584sDkgw",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 3433,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 36,
      "pull_request_review_id" : 792897430,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133488/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-29T10:52:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133488",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r739133506"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133506"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks. Fixed!",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-10-29T10:52:30Z",
      "diff_hunk" : "@@ -206,12 +206,20 @@ struct PackageMempoolAcceptResult\n };\n \n /**\n- * (Try to) add a transaction to the memory pool.\n- * @param[in]  bypass_limits   When true, don't enforce mempool fee limits.\n- * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n+ * Try to add a transaction to the mempool. This is an internal function and is\n+ * exposed only for testing. Client code should use ChainstateManager::ProcessTransaction()\n+ *\n+ * @param[in]  active_chainstate  Reference to the active chainstate.\n+ * @param[in]  pool               Reference to the node's mempool.\n+ * @param[in]  tx                 The transaction to submit for mempool acceptance.\n+ * @param[in]  bypass_limits      When true, don't enforce mempool fee limits.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r739133506",
      "id" : 739133506,
      "in_reply_to_id" : 732942466,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sDkhC",
      "original_commit_id" : "3bb34f0c7104dd5bfc141b6c24ab206c08f1b8c7",
      "original_line" : 215,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 792897458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133506/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-29T10:52:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739133506",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review, @glozow! I've rebased past #23157 and addressed all your comments.",
      "created_at" : "2021-10-29T10:53:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-954647284",
      "id" : 954647284,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII58445sL0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954647284/reactions"
      },
      "updated_at" : "2021-10-29T10:53:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954647284",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740541469"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740541469"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[test] Don't set bypass_limits to true in txvalidation_tests.cpp\" (23e5cba7749ae0a668c0e3b084e65f723617ba9f)\r\n\r\nNote, just for understanding: I think this change is safe and doesn't risk making the test meaningless because checks below verify it fails `TX_CONSENSUS`, not `TX_MEMPOOL_POLICY`. Might be worth saying this in the commit description, though, if you happen to update it.",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-11-01T21:26:36Z",
      "diff_hunk" : "@@ -38,7 +38,7 @@ BOOST_FIXTURE_TEST_CASE(tx_mempool_reject_coinbase, TestChain100Setup)\n \n     unsigned int initialPoolSize = m_node.mempool->size();\n     const MempoolAcceptResult result = AcceptToMemoryPool(m_node.chainman->ActiveChainstate(), *m_node.mempool, MakeTransactionRef(coinbaseTx),\n-                true /* bypass_limits */);\n+                false /* bypass_limits */);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740541469",
      "id" : 740541469,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sI8Qd",
      "original_commit_id" : "23e5cba7749ae0a668c0e3b084e65f723617ba9f",
      "original_line" : 41,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/txvalidation_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 794663227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740541469/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-01T22:34:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740541469",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740551011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740551011"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[refactor] Don't call AcceptToMemoryPool() from outside validation.cpp\" (edd4b472adbe6f45aee40d739f6c1f44e2dc35e2)\r\n\r\nAre these changes part of the wrong commit? I wouldn't expect to see changing error messages in a refactoring commit.",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-11-01T21:45:28Z",
      "diff_hunk" : "@@ -20,9 +20,9 @@ bilingual_str TransactionErrorString(const TransactionError err)\n         case TransactionError::P2P_DISABLED:\n             return Untranslated(\"Peer-to-peer functionality missing or disabled\");\n         case TransactionError::MEMPOOL_REJECTED:\n-            return Untranslated(\"Transaction rejected by AcceptToMemoryPool\");\n+            return Untranslated(\"Transaction rejected by mempool\");\n         case TransactionError::MEMPOOL_ERROR:\n-            return Untranslated(\"AcceptToMemoryPool failed\");\n+            return Untranslated(\"Mempool logic error\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740551011",
      "id" : 740551011,
      "line" : 25,
      "node_id" : "PRRC_kwDOABII584sI-lj",
      "original_commit_id" : "edd4b472adbe6f45aee40d739f6c1f44e2dc35e2",
      "original_line" : 25,
      "original_position" : 8,
      "original_start_line" : 22,
      "path" : "src/util/error.cpp",
      "position" : 8,
      "pull_request_review_id" : 794663227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740551011/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 22,
      "start_side" : "RIGHT",
      "updated_at" : "2021-11-01T22:34:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740551011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740552929"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740552929"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[validation] Add CChainState::ProcessTransaction()\" (bbc785f31b5d70c702ae37d259c46652e243ddba)\r\n\r\nIs it intentional to not pass reject reason & debug message strings to `Invalid()`? Depending on when this is expected to happen, strings might be more friendly than a numeric error code.",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-11-01T21:49:46Z",
      "diff_hunk" : "@@ -3423,6 +3423,19 @@ bool ChainstateManager::ProcessNewBlock(const CChainParams& chainparams, const s\n     return true;\n }\n \n+MempoolAcceptResult ChainstateManager::ProcessTransaction(const CTransactionRef& tx,\n+                                                          bool bypass_limits,\n+                                                          bool test_accept)\n+{\n+    CChainState& active_chainstate = ActiveChainstate();\n+    if (!active_chainstate.m_mempool) {\n+        TxValidationState state;\n+        state.Invalid(TxValidationResult::TX_NO_MEMPOOL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740552929",
      "id" : 740552929,
      "line" : 3430,
      "node_id" : "PRRC_kwDOABII584sI_Dh",
      "original_commit_id" : "bbc785f31b5d70c702ae37d259c46652e243ddba",
      "original_line" : 3433,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 33,
      "pull_request_review_id" : 794663227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740552929/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-01T22:34:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740552929",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740555364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740555364"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[validation] Remove comment about AcceptToMemoryPool()\" (bc9218139fd17d26eaac5093ac36b7da016734b6)\r\n\r\nNice find!",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-11-01T21:54:55Z",
      "diff_hunk" : "@@ -1658,8 +1658,6 @@ bool CChainState::ConnectBlock(const CBlock& block, BlockValidationState& state,\n     // can be duplicated to remove the ability to spend the first instance -- even after\n     // being sent to another address.\n     // See BIP30, CVE-2012-1909, and http://r6.ca/blog/20120206T005236Z.html for more information.\n-    // This logic is not necessary for memory pool transactions, as AcceptToMemoryPool\n-    // already refuses previously-known transaction ids entirely.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740555364",
      "id" : 740555364,
      "line" : 1662,
      "node_id" : "PRRC_kwDOABII584sI_pk",
      "original_commit_id" : "bc9218139fd17d26eaac5093ac36b7da016734b6",
      "original_line" : 1662,
      "original_position" : 5,
      "original_start_line" : 1661,
      "path" : "src/validation.cpp",
      "position" : 19,
      "pull_request_review_id" : 794663227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740555364/reactions"
      },
      "side" : "LEFT",
      "start_line" : 1661,
      "start_side" : "LEFT",
      "updated_at" : "2021-11-01T22:34:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740555364",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740560773"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740560773"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[validation] Always call mempool.check() after processing a new transaction\" (f87e07c6fe321f0fb97703c82c0e4122f800589f)\r\n\r\nThis change does not appear to be a pure refactoring, so it would be helpful if commit description mentioned something about cases when these new checks will be done and whether there are effects on validation or performance.",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-11-01T22:06:46Z",
      "diff_hunk" : "@@ -3430,7 +3430,9 @@ MempoolAcceptResult ChainstateManager::ProcessTransaction(const CTransactionRef&\n         state.Invalid(TxValidationResult::TX_NO_MEMPOOL);\n         return MempoolAcceptResult::Failure(state);\n     }\n-    return AcceptToMemoryPool(active_chainstate, *active_chainstate.m_mempool, tx, /* bypass_limits= */ false, test_accept);\n+    auto result = AcceptToMemoryPool(active_chainstate, *active_chainstate.m_mempool, tx, /* bypass_limits= */ false, test_accept);\n+    active_chainstate.m_mempool->check(active_chainstate.CoinsTip(), active_chainstate.m_chain.Height() + 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740560773",
      "id" : 740560773,
      "line" : 3434,
      "node_id" : "PRRC_kwDOABII584sJA-F",
      "original_commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "original_line" : 3434,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 37,
      "pull_request_review_id" : 794663227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740560773/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-01T22:34:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740560773",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740567565"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740567565"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[validation] Add CChainState::ProcessTransaction()\" (bbc785f31b5d70c702ae37d259c46652e243ddba)\r\n\r\nIMO it would be really good to add this function in its final form without the `bypass_limits` parameter, so the later commit removing it can be dropped. This would simplify reviewing the PR, and more importantly avoid unsafe change:\r\n\r\n```diff\r\n-    [[nodiscard]] MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool bypass_limits, bool test_accept=false)\r\n+    [[nodiscard]] MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool test_accept=false)\r\n```\r\n\r\nChange is unsafe because a `ProcessTransaction(tx, true)` call would still compile and silently change meaning from \"bypass limits and don't test\" to \"don't bypass limits and do test\"\r\n\r\nBetter to avoid this churn and risk, and just add the new method in final form without temporary (bool, bool) params.\r\n\r\n\r\n",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-11-01T22:22:17Z",
      "diff_hunk" : "@@ -994,6 +994,16 @@ class ChainstateManager\n      */\n     bool ProcessNewBlockHeaders(const std::vector<CBlockHeader>& block, BlockValidationState& state, const CChainParams& chainparams, const CBlockIndex** ppindex = nullptr) LOCKS_EXCLUDED(cs_main);\n \n+    /**\n+     * Try to add a transaction to the memory pool.\n+     *\n+     * @param[in]  tx              The transaction to submit for mempool acceptance.\n+     * @param[in]  bypass_limits   When true, don't enforce mempool fee and capacity limits.\n+     * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n+     */\n+    [[nodiscard]] MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool bypass_limits, bool test_accept=false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r740567565",
      "id" : 740567565,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sJCoN",
      "original_commit_id" : "bbc785f31b5d70c702ae37d259c46652e243ddba",
      "original_line" : 1004,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 794663227,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740567565/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-01T22:34:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/740567565",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r741230001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741230001"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[validation] Add CChainState::ProcessTransaction()\" (bbc785f31b5d70c702ae37d259c46652e243ddba)\r\n\r\nMaybe for consistency with `ProcessNewBlock` and `ProcessNewBlockHeaders`, call this method `ProcessNewTransaction` instead of `ProcessTransaction`. Might also help suggest that purpose of processing is to add new data, not validate existing data.",
      "commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "created_at" : "2021-11-02T15:54:03Z",
      "diff_hunk" : "@@ -994,6 +994,16 @@ class ChainstateManager\n      */\n     bool ProcessNewBlockHeaders(const std::vector<CBlockHeader>& block, BlockValidationState& state, const CChainParams& chainparams, const CBlockIndex** ppindex = nullptr) LOCKS_EXCLUDED(cs_main);\n \n+    /**\n+     * Try to add a transaction to the memory pool.\n+     *\n+     * @param[in]  tx              The transaction to submit for mempool acceptance.\n+     * @param[in]  bypass_limits   When true, don't enforce mempool fee and capacity limits.\n+     * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n+     */\n+    [[nodiscard]] MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool bypass_limits, bool test_accept=false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r741230001",
      "id" : 741230001,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sLkWx",
      "original_commit_id" : "bbc785f31b5d70c702ae37d259c46652e243ddba",
      "original_line" : 1004,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 795606569,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741230001/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-02T15:54:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741230001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027716"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027716"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Haha you noticed. I actually hope that we'd go the other way and change `ProcessNewBlock` to `ProcessBlock` and `ProcessNewBlockHeaders` to `ProcessBlockHeaders`. There's nothing to prevent passing in the same block/headers/transaction that have previously been processed, and the functions have ways of returning that information to the caller (`ProcessNewBlock` will set the `new_block` out-param to false and `ProcessTransaction` will set the `TxValidationState` result to `TX_CONFLICT` to indicate \"Tx already in mempool or conflicts with a tx in the chain\"). I think the `New` in `ProcessNew` is therefore redundant and perhaps even a bit misleading.",
      "commit_id" : "0fdb619aaf1d62598263361a6082d182be1af792",
      "created_at" : "2021-11-03T14:56:57Z",
      "diff_hunk" : "@@ -994,6 +994,16 @@ class ChainstateManager\n      */\n     bool ProcessNewBlockHeaders(const std::vector<CBlockHeader>& block, BlockValidationState& state, const CChainParams& chainparams, const CBlockIndex** ppindex = nullptr) LOCKS_EXCLUDED(cs_main);\n \n+    /**\n+     * Try to add a transaction to the memory pool.\n+     *\n+     * @param[in]  tx              The transaction to submit for mempool acceptance.\n+     * @param[in]  bypass_limits   When true, don't enforce mempool fee and capacity limits.\n+     * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n+     */\n+    [[nodiscard]] MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool bypass_limits, bool test_accept=false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027716",
      "id" : 742027716,
      "in_reply_to_id" : 741230001,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sOnHE",
      "original_commit_id" : "bbc785f31b5d70c702ae37d259c46652e243ddba",
      "original_line" : 1004,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 796674760,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027716/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-03T14:56:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027769"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027769"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good idea. This was a misguided attempt to make the commits as granular as possible, but you're right that it just adds churn and confusion.",
      "commit_id" : "0fdb619aaf1d62598263361a6082d182be1af792",
      "created_at" : "2021-11-03T14:56:59Z",
      "diff_hunk" : "@@ -994,6 +994,16 @@ class ChainstateManager\n      */\n     bool ProcessNewBlockHeaders(const std::vector<CBlockHeader>& block, BlockValidationState& state, const CChainParams& chainparams, const CBlockIndex** ppindex = nullptr) LOCKS_EXCLUDED(cs_main);\n \n+    /**\n+     * Try to add a transaction to the memory pool.\n+     *\n+     * @param[in]  tx              The transaction to submit for mempool acceptance.\n+     * @param[in]  bypass_limits   When true, don't enforce mempool fee and capacity limits.\n+     * @param[in]  test_accept     When true, run validation checks but don't submit to mempool.\n+     */\n+    [[nodiscard]] MempoolAcceptResult ProcessTransaction(const CTransactionRef& tx, bool bypass_limits, bool test_accept=false)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027769",
      "id" : 742027769,
      "in_reply_to_id" : 740567565,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sOnH5",
      "original_commit_id" : "bbc785f31b5d70c702ae37d259c46652e243ddba",
      "original_line" : 1004,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 796674822,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027769/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-03T14:57:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027769",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027824"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For mainnet nodes with default config, there's no behaviour change. I've added the following text to the commit log:\r\n\r\n>    CTxMemPool::check() will carry out internal consistency checks 1/n times,\r\n>    where n is set by the `-checkmempool` configuration option. By default,\r\n>    mempool consistency checks are disabled entirely on mainnet.\r\n>    \r\n>    Therefore, this change has no effect on mainnet nodes running with\r\n>    default configuration. It simply removes the responsibility to trigger\r\n>    mempool consistency checks from net_processing.",
      "commit_id" : "0fdb619aaf1d62598263361a6082d182be1af792",
      "created_at" : "2021-11-03T14:57:03Z",
      "diff_hunk" : "@@ -3430,7 +3430,9 @@ MempoolAcceptResult ChainstateManager::ProcessTransaction(const CTransactionRef&\n         state.Invalid(TxValidationResult::TX_NO_MEMPOOL);\n         return MempoolAcceptResult::Failure(state);\n     }\n-    return AcceptToMemoryPool(active_chainstate, *active_chainstate.m_mempool, tx, /* bypass_limits= */ false, test_accept);\n+    auto result = AcceptToMemoryPool(active_chainstate, *active_chainstate.m_mempool, tx, /* bypass_limits= */ false, test_accept);\n+    active_chainstate.m_mempool->check(active_chainstate.CoinsTip(), active_chainstate.m_chain.Height() + 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027824",
      "id" : 742027824,
      "in_reply_to_id" : 740560773,
      "line" : 3433,
      "node_id" : "PRRC_kwDOABII584sOnIw",
      "original_commit_id" : "f87e07c6fe321f0fb97703c82c0e4122f800589f",
      "original_line" : 3433,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 22,
      "pull_request_review_id" : 796674901,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027824/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-03T14:57:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027864"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027864"
         }
      },
      "author_association" : "MEMBER",
      "body" : ":bow: ",
      "commit_id" : "0fdb619aaf1d62598263361a6082d182be1af792",
      "created_at" : "2021-11-03T14:57:05Z",
      "diff_hunk" : "@@ -1658,8 +1658,6 @@ bool CChainState::ConnectBlock(const CBlock& block, BlockValidationState& state,\n     // can be duplicated to remove the ability to spend the first instance -- even after\n     // being sent to another address.\n     // See BIP30, CVE-2012-1909, and http://r6.ca/blog/20120206T005236Z.html for more information.\n-    // This logic is not necessary for memory pool transactions, as AcceptToMemoryPool\n-    // already refuses previously-known transaction ids entirely.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027864",
      "id" : 742027864,
      "in_reply_to_id" : 740555364,
      "line" : 1662,
      "node_id" : "PRRC_kwDOABII584sOnJY",
      "original_commit_id" : "bc9218139fd17d26eaac5093ac36b7da016734b6",
      "original_line" : 1662,
      "original_position" : 5,
      "original_start_line" : 1661,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 796674955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027864/reactions"
      },
      "side" : "LEFT",
      "start_line" : 1661,
      "start_side" : "LEFT",
      "updated_at" : "2021-11-03T14:57:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027864",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027895"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027895"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point. Fixed!",
      "commit_id" : "0fdb619aaf1d62598263361a6082d182be1af792",
      "created_at" : "2021-11-03T14:57:06Z",
      "diff_hunk" : "@@ -3423,6 +3423,19 @@ bool ChainstateManager::ProcessNewBlock(const CChainParams& chainparams, const s\n     return true;\n }\n \n+MempoolAcceptResult ChainstateManager::ProcessTransaction(const CTransactionRef& tx,\n+                                                          bool bypass_limits,\n+                                                          bool test_accept)\n+{\n+    CChainState& active_chainstate = ActiveChainstate();\n+    if (!active_chainstate.m_mempool) {\n+        TxValidationState state;\n+        state.Invalid(TxValidationResult::TX_NO_MEMPOOL);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027895",
      "id" : 742027895,
      "in_reply_to_id" : 740552929,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sOnJ3",
      "original_commit_id" : "bbc785f31b5d70c702ae37d259c46652e243ddba",
      "original_line" : 3433,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 796674994,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027895/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-03T14:57:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027928"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's a fair point. I've split this change into its own commit with the reasoning in the commit log.",
      "commit_id" : "0fdb619aaf1d62598263361a6082d182be1af792",
      "created_at" : "2021-11-03T14:57:09Z",
      "diff_hunk" : "@@ -20,9 +20,9 @@ bilingual_str TransactionErrorString(const TransactionError err)\n         case TransactionError::P2P_DISABLED:\n             return Untranslated(\"Peer-to-peer functionality missing or disabled\");\n         case TransactionError::MEMPOOL_REJECTED:\n-            return Untranslated(\"Transaction rejected by AcceptToMemoryPool\");\n+            return Untranslated(\"Transaction rejected by mempool\");\n         case TransactionError::MEMPOOL_ERROR:\n-            return Untranslated(\"AcceptToMemoryPool failed\");\n+            return Untranslated(\"Mempool logic error\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027928",
      "id" : 742027928,
      "in_reply_to_id" : 740551011,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sOnKY",
      "original_commit_id" : "edd4b472adbe6f45aee40d739f6c1f44e2dc35e2",
      "original_line" : 25,
      "original_position" : 8,
      "original_start_line" : 22,
      "path" : "src/util/error.cpp",
      "position" : null,
      "pull_request_review_id" : 796675047,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027928/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-11-03T14:57:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027928",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027956"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027956"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's correct. I've updated the commit log as suggested.",
      "commit_id" : "0fdb619aaf1d62598263361a6082d182be1af792",
      "created_at" : "2021-11-03T14:57:11Z",
      "diff_hunk" : "@@ -38,7 +38,7 @@ BOOST_FIXTURE_TEST_CASE(tx_mempool_reject_coinbase, TestChain100Setup)\n \n     unsigned int initialPoolSize = m_node.mempool->size();\n     const MempoolAcceptResult result = AcceptToMemoryPool(m_node.chainman->ActiveChainstate(), *m_node.mempool, MakeTransactionRef(coinbaseTx),\n-                true /* bypass_limits */);\n+                false /* bypass_limits */);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#discussion_r742027956",
      "id" : 742027956,
      "in_reply_to_id" : 740541469,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584sOnK0",
      "original_commit_id" : "23e5cba7749ae0a668c0e3b084e65f723617ba9f",
      "original_line" : 41,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/txvalidation_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 796675103,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23173",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027956/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-03T14:57:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742027956",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the thorough review @ryanofsky! I believe I've addressed all of your review comments.",
      "created_at" : "2021-11-03T14:57:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-959342617",
      "id" : 959342617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII5845LmgZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/959342617/reactions"
      },
      "updated_at" : "2021-11-03T14:57:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/959342617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> 2c64270 seems to indicate that all AcceptToMemoryPool() calls from outside validation.cpp/h are removed, but it appears there are still two references left. Is this intentional?\r\n\r\nYes, see the `AcceptToMemoryPool` doxygen comment:\r\n\r\n```\r\n * Try to add a transaction to the mempool. This is an internal function and is\r\n * exposed only for testing. Client code should use ChainstateManager::ProcessTransaction()\r\n```\r\n\r\nThose two remaining calls to ATMP are the tests that are referenced in that comment. They can't use the `ChainstateManager::ProcessTransaction()` interface function since they're testing a mempool that isn't owned by a `CChainState`.",
      "created_at" : "2021-11-03T16:51:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23173#issuecomment-959725255",
      "id" : 959725255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23173",
      "node_id" : "IC_kwDOABII5845ND7H",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/959725255/reactions"
      },
      "updated_at" : "2021-11-03T16:51:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/959725255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
