[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Adding a `std::any` or `void*` or similar `context` member to [`struct JSONRPCRequest`](https://github.com/bitcoin/bitcoin/blob/ae6943620ab369e8e0865c3ec2d2848ba9389325/src/rpc/request.h#L27-L40) is probably the simplest way to pass context to RPC methods and get rid of RPC globals without having to change the way RPC methods are written. But other ways would be possible like making RPC methods into objects: https://github.com/bitcoin/bitcoin/pull/16839#discussion_r324426030\r\n\r\nBut I wouldn't put much too much priority on getting rid of `g_rpc_node` and `g_rpc_chain` globals. It'd be nice to add `EnsureConnman` `EnsureBanman` functions similar to [`EnsureMempool`](https://github.com/bitcoin/bitcoin/blob/ae6943620ab369e8e0865c3ec2d2848ba9389325/src/rpc/blockchain.cpp#L57-L64) so the globals could be referenced in fewer places, but I don't think much would be gained practically by completely getting rid of them.",
      "created_at" : "2019-11-21T16:51:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17548#issuecomment-557174135",
      "id" : 557174135,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17548",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzE3NDEzNQ==",
      "updated_at" : "2019-11-21T16:51:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557174135",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yeah, I am mostly leaving this open to not forget about it. \r\n\r\n> But other ways would be possible like making RPC methods into objects\r\n\r\nI think I wanted to make them objects anyway for some `RPCHelpMan` work.",
      "created_at" : "2019-11-21T18:17:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17548#issuecomment-557209145",
      "id" : 557209145,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17548",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzIwOTE0NQ==",
      "updated_at" : "2019-11-21T18:17:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557209145",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\nPutting the context in a thread-local variable would also work, but I prefer a context pointer on `JSONRPCRequest` to that kind of action at a distance.\r\n\r\nNot convinced that JSONRPC methods should be objects. They're conceptually functions, defined as functions. Making them classes seems over-OOP to me.",
      "created_at" : "2019-11-22T20:53:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17548#issuecomment-557690186",
      "id" : 557690186,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17548",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzY5MDE4Ng==",
      "updated_at" : "2019-11-22T20:54:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557690186",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have a question regarding **g_txindex**.\r\n\r\nAfter I have removed **g_rpc_node** and **g_rpc_chain** in my PR https://github.com/bitcoin/bitcoin/pull/18647 I went searching for similar globals, that maybe could be removed the same way. And I found one: **g_txindex** which too is being used in two of the RPCs: **getrawtransaction** and **rest_tx**. That is, they rely on *GetTransaction* which actually uses *g_txindex*.\r\n\r\nAnd as I have adapted RPCs to be called with NodeContext as their second argument, I would like to hear your opinions on expanding NodeContext by adding a **unique_ptr** **TxIndex** member to it.\r\n\r\nSo that *getrawtransaction* would receive **g_txindex** from NodeContext and then forward it to *GetTransaction*.\r\n\r\nWith this change we could also get rid of this third global variable (this of course depends on the fate of my PR).\r\n\r\nRegards, ",
      "created_at" : "2020-04-16T19:54:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17548#issuecomment-614862717",
      "id" : 614862717,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17548",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNDg2MjcxNw==",
      "updated_at" : "2020-04-16T19:55:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614862717",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There is a pull for this, and this issue is low prio, so closing.",
      "created_at" : "2020-05-08T23:29:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17548#issuecomment-626062285",
      "id" : 626062285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17548",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNjA2MjI4NQ==",
      "updated_at" : "2020-05-08T23:29:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626062285",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
