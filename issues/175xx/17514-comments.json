[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347871169"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347871169"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Instead of aborting what about returning `Unable to format: \"â¦\"` in case of a format string mistake?\r\n\r\nPerhaps with an `ASSUME(false);` to make it abort if `--enable-debug` (674f9d59ba4c1a1d4662e79467cc417a2988cf15 in #16136 gives us `ASSUME(â¦)`).",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-11-19T11:28:42Z",
      "diff_hunk" : "@@ -1061,6 +1061,23 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ * Use this function in no-except context, but only when you are 100% sure that the\n+ * format string contains no mistakes.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept\n+{\n+    std::ostringstream oss;\n+    try {\n+        format(oss, fmt.c_str(), args...);\n+    } catch(...) {\n+        abort();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347871169",
      "id" : 347871169,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Nzg3MTE2OQ==",
      "original_commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "original_position" : 16,
      "path" : "src/tinyformat.h",
      "position" : null,
      "pull_request_review_id" : 318965362,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347871169",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347872898"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347872898"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is intended for use in utility functions (say, date-time formatting, string encodings, and whatnot), in neither of these cases it's acceptable to end up with \"Unable to format: \" in the string! That's much worse than to just terminate the process. It is assumed these functions have proper unit tests.\r\n\r\nNo opinion on how to terminate the process, though. I did not use `assert(0)` because I don't want to rely on assert() not being defined out, if in the future `NDEBUG` will be allowed.",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-11-19T11:33:06Z",
      "diff_hunk" : "@@ -1061,6 +1061,23 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ * Use this function in no-except context, but only when you are 100% sure that the\n+ * format string contains no mistakes.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept\n+{\n+    std::ostringstream oss;\n+    try {\n+        format(oss, fmt.c_str(), args...);\n+    } catch(...) {\n+        abort();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347872898",
      "id" : 347872898,
      "in_reply_to_id" : 347871169,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Nzg3Mjg5OA==",
      "original_commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "original_position" : 16,
      "path" : "src/tinyformat.h",
      "position" : null,
      "pull_request_review_id" : 318967788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347872898",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16673](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16673.html) (Relog configuration args on debug.log rotation by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-19T11:45:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-555471685",
      "id" : 555471685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NTQ3MTY4NQ==",
      "updated_at" : "2019-11-19T11:45:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/555471685",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347878051"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347878051"
         }
      },
      "author_association" : "MEMBER",
      "body" : "OK, I see your point :)",
      "commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "created_at" : "2019-11-19T11:46:30Z",
      "diff_hunk" : "@@ -1061,6 +1061,23 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ * Use this function in no-except context, but only when you are 100% sure that the\n+ * format string contains no mistakes.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept\n+{\n+    std::ostringstream oss;\n+    try {\n+        format(oss, fmt.c_str(), args...);\n+    } catch(...) {\n+        abort();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347878051",
      "id" : 347878051,
      "in_reply_to_id" : 347871169,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Nzg3ODA1MQ==",
      "original_commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "original_position" : 16,
      "path" : "src/tinyformat.h",
      "position" : 16,
      "pull_request_review_id" : 318974756,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-11-19T11:46:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347878051",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "FYI, these are the potential tinyformat exceptions:\r\n```\r\nTINYFORMAT_ERROR(\"tinyformat: Cannot convert from argument type to integer for use as variable width or precision\");\r\nTINYFORMAT_ERROR(\"tinyformat: Not enough conversion specifiers in format string\");\r\nTINYFORMAT_ERROR(\"tinyformat: Not enough arguments to read variable width\");\r\nTINYFORMAT_ERROR(\"tinyformat: Not enough arguments to read variable precision\");\r\nTINYFORMAT_ERROR(\"tinyformat: the %a and %A conversion specs are not supported\");\r\nTINYFORMAT_ERROR(\"tinyformat: %n conversion spec not supported\");\r\nTINYFORMAT_ERROR(\"tinyformat: Conversion spec incorrectly terminated by end of string\");\r\nTINYFORMAT_ERROR(\"tinyformat: Not enough format arguments\");\r\nTINYFORMAT_ERROR(\"tinyformat: Too many conversion specifiers in format string\");\r\n```\r\nThese all boil down to:\r\n- Wrong number of arguments in format string\r\n- Wrong type of arguments provided (compared to argument spec)\r\n- Malformed or unsupported format specifiers\r\n\r\nAs I understand it, assuming a static format stringâanything else is very unwise, and not the case hereâthese can only be caused by bugs in development, not by invalid values at run-time.\r\n\r\nSo if a function with `tfm::format_noexcept` is at least tested once in the unit tests, it can be relied on to never abort.\r\n\r\nI have intentionally not used `tfm::format_noexcept` for the log message itself, because that usage of tinyformat is much more error-prone.\r\n",
      "created_at" : "2019-11-19T11:55:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-555475214",
      "id" : 555475214,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NTQ3NTIxNA==",
      "updated_at" : "2019-11-19T11:56:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/555475214",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK on making logging `noexcept`\r\n\r\nSome comments:\r\n\r\n> The only functions I'm slightly uncertain about are the boost posix_time functions in\r\n> GetTimeMicros/GetTimeMillis, but I could not find any documented exceptions in\r\n> https://www.boost.org/doc/libs/1_71_0/doc/html/date_time/posix_time.html\r\n\r\n`GetTimeMillis()` does `boost::posix_time::ptime(boost::gregorian::date(1970,1,1)))` which can throw (from the compiler's perspective that is - we know it can't throw with these inputs :)):\r\n* `boost::gregorian::bad_year (\"Year is out of valid range: 1400..10000\")`\r\n* `boost::gregorian::bad_month (\"Month number is out of range 1..12\")`\r\n* `boost::gregorian::bad_day_of_month (\"Day of month value is out of range 1..31\")`\r\n* `boost::gregorian::bad_day_of_month (\"Day of month is not valid for year\")`\r\n\r\nI suggest cherry-picking in https://github.com/bitcoin/bitcoin/pull/13382/commits/afc97c731e407f87fae0385aa5c3a729981ca1aa from the PR #13382 (\"util: Don't throw in GetTime{Millis,Micros}(). Mark as noexcept.\"):\r\n\r\n```diff\r\ndiff --git a/src/util/time.cpp b/src/util/time.cpp\r\nindex 83a7937d8f61..217bc1e9cdba 100644\r\n--- a/src/util/time.cpp\r\n+++ b/src/util/time.cpp\r\n@@ -37,18 +37,20 @@ int64_t GetMockTime()\r\n     return nMockTime.load(std::memory_order_relaxed);\r\n }\r\n \r\n-int64_t GetTimeMillis()\r\n+int64_t GetTimeMillis() noexcept\r\n {\r\n+    static const boost::posix_time::ptime epoch = boost::posix_time::from_time_t(0);\r\n     int64_t now = (boost::posix_time::microsec_clock::universal_time() -\r\n-                   boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_milliseconds();\r\n+                   epoch).total_milliseconds();\r\n     assert(now > 0);\r\n     return now;\r\n }\r\n \r\n-int64_t GetTimeMicros()\r\n+int64_t GetTimeMicros() noexcept\r\n {\r\n+    static const boost::posix_time::ptime epoch = boost::posix_time::from_time_t(0);\r\n     int64_t now = (boost::posix_time::microsec_clock::universal_time() -\r\n-                   boost::posix_time::ptime(boost::gregorian::date(1970,1,1))).total_microseconds();\r\n+                   epoch).total_microseconds();\r\n     assert(now > 0);\r\n     return now;\r\n }\r\ndiff --git a/src/util/time.h b/src/util/time.h\r\nindex f2e27474342b..ae618165063a 100644\r\n--- a/src/util/time.h\r\n+++ b/src/util/time.h\r\n@@ -20,8 +20,8 @@\r\n  */\r\n \r\n int64_t GetTime();\r\n-int64_t GetTimeMillis();\r\n-int64_t GetTimeMicros();\r\n+int64_t GetTimeMillis() noexcept;\r\n+int64_t GetTimeMicros() noexcept;\r\n int64_t GetSystemTimeInSeconds(); // Like GetTime(), but not mockable\r\n void SetMockTime(int64_t nMockTimeIn);\r\n int64_t GetMockTime();\r\n```\r\n\r\n> (Also, thinking of it, any kind of allocation in C++ can except with bad_alloc&, including inside string manipulation, which is almost 100% of the code here. If that's an issue, I'm no longer convinced this is possible at all)\r\n\r\nI don't think we have to worry about `bad_alloc`. From the C++ Core Guidelines (with editors Bjarne Stroustrup & Herb Sutter):\r\n\r\n> _\"Code that is intended to be perfectly general (like the standard library and other utility code of that sort) needs to support environments where a bad_alloc exception may be handled meaningfully. However, most programs and execution environments cannot meaningfully handle a failure to allocate, and aborting the program is the cleanest and simplest response to an allocation failure in those cases. If you know that your application code cannot respond to an allocation failure, it may be appropriate to add noexcept even on functions that allocate.\"_",
      "created_at" : "2019-11-19T12:03:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-555477666",
      "id" : 555477666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NTQ3NzY2Ng==",
      "updated_at" : "2019-11-19T12:27:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/555477666",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> GetTimeMillis() does boost::posix_time::ptime(boost::gregorian::date(1970,1,1))) which can throw:\r\n\r\nOh crap. Thanks for noticing. Though, I guess that will never happen with this static input. But I think your commit improves the code anyway.\r\n\r\nThanks, will cherry-pick that!\r\n\r\nEdit: replaced my commit\r\n",
      "created_at" : "2019-11-19T12:22:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-555484009",
      "id" : 555484009,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NTQ4NDAwOQ==",
      "updated_at" : "2019-11-19T12:31:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/555484009",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347895390"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347895390"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh, sorry: I now re-read the diff and understand that the use of `format_noexcept` is extremely limited. Makes perfect sense. Sorry for the misunderstanding.",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-11-19T12:30:20Z",
      "diff_hunk" : "@@ -1061,6 +1061,23 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ * Use this function in no-except context, but only when you are 100% sure that the\n+ * format string contains no mistakes.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept\n+{\n+    std::ostringstream oss;\n+    try {\n+        format(oss, fmt.c_str(), args...);\n+    } catch(...) {\n+        abort();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347895390",
      "id" : 347895390,
      "in_reply_to_id" : 347871169,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Nzg5NTM5MA==",
      "original_commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "original_position" : 16,
      "path" : "src/tinyformat.h",
      "position" : null,
      "pull_request_review_id" : 318998353,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347895390",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347899485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347899485"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you don't have to call `std::abort` in a throwing function that is marked `noexcept(true)`. An exception will `std::terminate` the program anyway, no?",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-11-19T12:40:30Z",
      "diff_hunk" : "@@ -1061,6 +1061,23 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ * Use this function in no-except context, but only when you are 100% sure that the\n+ * format string contains no mistakes.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept\n+{\n+    std::ostringstream oss;\n+    try {\n+        format(oss, fmt.c_str(), args...);\n+    } catch(...) {\n+        abort();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r347899485",
      "id" : 347899485,
      "in_reply_to_id" : 347871169,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Nzg5OTQ4NQ==",
      "original_commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "original_position" : 16,
      "path" : "src/tinyformat.h",
      "position" : null,
      "pull_request_review_id" : 319003818,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347899485",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-11-19T13:25:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-555506306",
      "id" : 555506306,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NTUwNjMwNg==",
      "updated_at" : "2019-11-19T13:25:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/555506306",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r348371112"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348371112"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke correct. I was not sure to make this explicit or not. If you think it's ok to rely on C++'s behavior here, I'll remove the catch entirely (maybe replace it with a comment?).",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-11-20T09:25:26Z",
      "diff_hunk" : "@@ -1061,6 +1061,23 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ * Use this function in no-except context, but only when you are 100% sure that the\n+ * format string contains no mistakes.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept\n+{\n+    std::ostringstream oss;\n+    try {\n+        format(oss, fmt.c_str(), args...);\n+    } catch(...) {\n+        abort();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r348371112",
      "id" : 348371112,
      "in_reply_to_id" : 347871169,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0ODM3MTExMg==",
      "original_commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "original_position" : 16,
      "path" : "src/tinyformat.h",
      "position" : null,
      "pull_request_review_id" : 319695433,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348371112",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r348504676"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348504676"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, I believe that the program will always abort, even if someone sets a terminate handler that does not abort: https://en.cppreference.com/w/cpp/error/terminate_handler\r\n\r\nSo it should be fine to remove this and add a comment instead.",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-11-20T14:16:13Z",
      "diff_hunk" : "@@ -1061,6 +1061,23 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ * Use this function in no-except context, but only when you are 100% sure that the\n+ * format string contains no mistakes.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept\n+{\n+    std::ostringstream oss;\n+    try {\n+        format(oss, fmt.c_str(), args...);\n+    } catch(...) {\n+        abort();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r348504676",
      "id" : 348504676,
      "in_reply_to_id" : 347871169,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0ODUwNDY3Ng==",
      "original_commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "original_position" : 16,
      "path" : "src/tinyformat.h",
      "position" : null,
      "pull_request_review_id" : 319870173,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348504676",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r348515334"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348515334"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-11-20T14:34:28Z",
      "diff_hunk" : "@@ -1061,6 +1061,23 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ * Use this function in no-except context, but only when you are 100% sure that the\n+ * format string contains no mistakes.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept\n+{\n+    std::ostringstream oss;\n+    try {\n+        format(oss, fmt.c_str(), args...);\n+    } catch(...) {\n+        abort();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r348515334",
      "id" : 348515334,
      "in_reply_to_id" : 347871169,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0ODUxNTMzNA==",
      "original_commit_id" : "5f77484d05068ace21d1e1df62132b5338995959",
      "original_position" : 16,
      "path" : "src/tinyformat.h",
      "position" : null,
      "pull_request_review_id" : 319884436,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348515334",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It will abort on any tinyformat error.\r\n\r\nIs this still the case? I'm testing 71493f0a55f6fa0a23e00d9d239aa6d8210d89ab with this diff:\r\n\r\n```diff\r\n     RandAddStaticEnv(hasher);\r\n-    LogPrintf(\"Feeding %i bytes of environment data into RNG\\n\", hasher.Size() - old_size);\r\n+    LogPrintf(\"Feeding %a bytes of environment data into RNG\\n\", hasher.Size() - old_size);\r\n```\r\n\r\nwhich triggers this `TINYFORMAT_ERROR`:\r\nhttps://github.com/bitcoin/bitcoin/blob/d8a66626d63135fd245d5afc524b88b9a94d208b/src/tinyformat.h#L750-L751\r\n \r\n`bitcoind` just prints the error and continues:\r\n\r\n```bash\r\n2019-11-27T14:49:55Z Error \"tinyformat: the %a and %A conversion specs are not supported\" while formatting log message: Feeding %i %a bytes ....\r\n```\r\n\r\nThe same thing also happens with 3c8505ca49a429dcc6c79fc3fd5d1e752b2f22e8.",
      "created_at" : "2019-11-27T15:01:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-559123543",
      "id" : 559123543,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTEyMzU0Mw==",
      "updated_at" : "2019-11-27T15:01:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559123543",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Is this still the case? I'm testing 71493f0 with this diff:\r\n\r\nNo, not *in general*.  `strprintf`still raises `tinyformat_error`. `LogPrintf`'s behavior for invalid format strings is unchanged (the exception is caught and reported, but does not leak out)\r\n\r\nNote that the paragraph related to the use of `tfm::format_noexcept` specifically. I even mention in the second post\r\n\r\n> I have intentionally not used tfm::format_noexcept for the log message itself, because that usage of tinyformat is much more error-prone.\r\n\r\nWhat this does is make `LogPrintf` and various utility functions noexcept (no exceptions are guaranteed to leak out). Nothing more. No observable behavior is supposed to change.",
      "created_at" : "2019-11-28T08:50:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-559398813",
      "id" : 559398813,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTM5ODgxMw==",
      "updated_at" : "2019-11-28T09:01:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559398813",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r353968761"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/353968761"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could make this shorter by removing the copy-pasted body?\r\n\r\n```suggestion\r\nstd::string format_noexcept(const std::string &fmt, const Args&... args) noexcept {return format(fmt, args...);}\r\n```",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-12-04T20:35:33Z",
      "diff_hunk" : "@@ -1061,6 +1061,24 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ *\n+ * Use this function in no-except context, when you are 100% sure that the\n+ * format string contains no errors. Only errors in the format string and inconsistencies\n+ * between the format string and the type or number of arguments passed in cause tinyformat\n+ * exceptions. It does not depend on the value of the arguments.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r353968761",
      "id" : 353968761,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1Mzk2ODc2MQ==",
      "original_commit_id" : "71493f0a55f6fa0a23e00d9d239aa6d8210d89ab",
      "original_position" : 13,
      "path" : "src/tinyformat.h",
      "position" : 13,
      "pull_request_review_id" : 327135491,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/353968761",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r354179674"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354179674"
         }
      },
      "author_association" : "MEMBER",
      "body" : "it looks really weird like this, having ` _noexcept` that simply calls the normal function\r\n",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-12-05T09:03:24Z",
      "diff_hunk" : "@@ -1061,6 +1061,24 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ *\n+ * Use this function in no-except context, when you are 100% sure that the\n+ * format string contains no errors. Only errors in the format string and inconsistencies\n+ * between the format string and the type or number of arguments passed in cause tinyformat\n+ * exceptions. It does not depend on the value of the arguments.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r354179674",
      "id" : 354179674,
      "in_reply_to_id" : 353968761,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NDE3OTY3NA==",
      "original_commit_id" : "71493f0a55f6fa0a23e00d9d239aa6d8210d89ab",
      "original_position" : 13,
      "path" : "src/tinyformat.h",
      "position" : 13,
      "pull_request_review_id" : 327393239,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354179674",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm not entirely sure this is worth doing anymore. noexcept works slightly different from what I thought when I wrote this PR.\r\nit seems it's perfectly fine to use non-noexcept functions from except context if you expect they don't ever except anyway. I'm not sure what this adds at all.\r\nso this is not a requirement for #17507 at all",
      "created_at" : "2019-12-05T09:05:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-562036908",
      "id" : 562036908,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MjAzNjkwOA==",
      "updated_at" : "2019-12-05T09:05:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/562036908",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj \r\n\r\nI think it is worth doing.\r\n\r\nWhat this adds is a guarantee that logging won't throw any exceptions. That enables the compiler to apply optimisations that otherwise would not be possible (by reducing the number of alternative execution paths), and it also simplifies control flow analysis from the perspective of static analysers and human reviewers.\r\n\r\nThis is why Scott Mayer of \"Effective C++\" fame recommends using `noexcept` in cases like the one we are discussing:\r\n\r\n> The difference between unwinding the call stack and possibly unwinding it has a surprisingly large impact on code generation. In a `noexcept` function, optimizers need not keep the runtime stack in an unwindable state if an exception would propagate out of the function, nor must they ensure that objects in a noexcept function are destroyed in the inverse order of construction should an exception leave the function.\r\n>\r\n> The result is more opportunities for optimization, not only within the body of a `noexcept` function, but also at sites where the function is called. Such flexibility is present only for `noexcept` functions. Functions with `throw()` exception specifications lack it, as do functions with no exception specification at all. The situation can be summarized this way:\r\n>\r\n> ```\r\n> RetType function(params) noexcept; // most optimizable\r\n> RetType function(params) throw(); // less optimizable\r\n> RetType function(params); // less optimizable\r\n> ```\r\n> This alone should provide sufficient motivation to declare functions `noexcept` whenever you can.\r\n>\r\n> [â¦]\r\n>\r\n> Things to Remember\r\n> * `noexcept` is part of a functionâs interface, so callers may depend on it.\r\n> * `noexcept` functions are more optimizable than non-noexcept functions.\r\n> * `noexcept` is particularly valuable for the move operations and for swap.\r\n> * Most functions are exception-neutral rather than `noexcept`\r\n\r\nSince logging is used pretty much everywhere in our code base I think it would be good to add a `noexcept` guarantee to remove the \"potentially throwing\" effect that using  logging currently has on all call sites (and by extension all call sites directly or indirectly calling said call sites: it bubbles up :)).\r\n\r\nI've noticed that @sipa is a actively introducing `noexcept` where appropriate: perhaps he might want to chime in :)",
      "created_at" : "2019-12-05T09:37:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-562049097",
      "id" : 562049097,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MjA0OTA5Nw==",
      "updated_at" : "2019-12-05T09:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/562049097",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r354473109"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354473109"
         }
      },
      "author_association" : "MEMBER",
      "body" : "But it is exactly what happens here. Inlining `format` doesn't make it throw less exceptions. The only difference between them is the `noexcept` keyword, which makes the program terminate immediately should any exception be thrown.",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-12-05T18:21:57Z",
      "diff_hunk" : "@@ -1061,6 +1061,24 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ *\n+ * Use this function in no-except context, when you are 100% sure that the\n+ * format string contains no errors. Only errors in the format string and inconsistencies\n+ * between the format string and the type or number of arguments passed in cause tinyformat\n+ * exceptions. It does not depend on the value of the arguments.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r354473109",
      "id" : 354473109,
      "in_reply_to_id" : 353968761,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NDQ3MzEwOQ==",
      "original_commit_id" : "71493f0a55f6fa0a23e00d9d239aa6d8210d89ab",
      "original_position" : 13,
      "path" : "src/tinyformat.h",
      "position" : 13,
      "pull_request_review_id" : 327756201,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354473109",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r354698147"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354698147"
         }
      },
      "author_association" : "MEMBER",
      "body" : "yes, that's true",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-12-06T07:40:06Z",
      "diff_hunk" : "@@ -1061,6 +1061,24 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ *\n+ * Use this function in no-except context, when you are 100% sure that the\n+ * format string contains no errors. Only errors in the format string and inconsistencies\n+ * between the format string and the type or number of arguments passed in cause tinyformat\n+ * exceptions. It does not depend on the value of the arguments.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r354698147",
      "id" : 354698147,
      "in_reply_to_id" : 353968761,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NDY5ODE0Nw==",
      "original_commit_id" : "71493f0a55f6fa0a23e00d9d239aa6d8210d89ab",
      "original_position" : 13,
      "path" : "src/tinyformat.h",
      "position" : 13,
      "pull_request_review_id" : 328036943,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354698147",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r354698877"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354698877"
         }
      },
      "author_association" : "MEMBER",
      "body" : "OTOH this is only three lines, I'd like to keep the comment too, and this adds yet another layer of indirection with `std::string` return value, it's kind of marginal\r\nto be honest I think it's more readable like this",
      "commit_id" : "1d5b8b66b0b787ad5810dd73a515582da3f1db02",
      "created_at" : "2019-12-06T07:42:51Z",
      "diff_hunk" : "@@ -1061,6 +1061,24 @@ std::string format(const std::string &fmt, const Args&... args)\n     return oss.str();\n }\n \n+/** Variant of tfm::format that aborts when an formatting exception happens instead\n+ * of raising an exception.\n+ *\n+ * Use this function in no-except context, when you are 100% sure that the\n+ * format string contains no errors. Only errors in the format string and inconsistencies\n+ * between the format string and the type or number of arguments passed in cause tinyformat\n+ * exceptions. It does not depend on the value of the arguments.\n+ */\n+template<typename... Args>\n+std::string format_noexcept(const std::string &fmt, const Args&... args) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#discussion_r354698877",
      "id" : 354698877,
      "in_reply_to_id" : 353968761,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NDY5ODg3Nw==",
      "original_commit_id" : "71493f0a55f6fa0a23e00d9d239aa6d8210d89ab",
      "original_position" : 13,
      "path" : "src/tinyformat.h",
      "position" : 13,
      "pull_request_review_id" : 328037863,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17514",
      "updated_at" : "2019-12-06T07:59:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354698877",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Squashed the fixup commit and rebased.",
      "created_at" : "2019-12-06T08:00:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17514#issuecomment-562472975",
      "id" : 562472975,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17514",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MjQ3Mjk3NQ==",
      "updated_at" : "2019-12-06T08:00:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/562472975",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
