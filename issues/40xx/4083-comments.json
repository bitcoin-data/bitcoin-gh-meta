[
   {
      "author_association" : "MEMBER",
      "body" : "Since #4058 ?\n",
      "created_at" : "2014-04-22T18:44:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4083#issuecomment-41078293",
      "id" : 41078293,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4083",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMDc4Mjkz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41078293/reactions"
      },
      "updated_at" : "2014-04-22T18:44:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41078293",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Probably, I'm about to test reverting those commits.\n",
      "created_at" : "2014-04-22T18:50:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4083#issuecomment-41078905",
      "id" : 41078905,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4083",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMDc4OTA1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41078905/reactions"
      },
      "updated_at" : "2014-04-22T18:50:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41078905",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=4",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "node_id" : "MDQ6VXNlcjExOTI0ODM=",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This is what's happening, grepping out the net locks:\n\n2014-04-22 21:42:19 Locking: cs_main  main.cpp:3806\n2014-04-22 21:42:19 Locking: cs_nTimeOffset  util.cpp:1250\n2014-04-22 21:42:19 Locking: cs_main  transactiontablemodel.cpp:193\n2014-04-22 21:42:19 Unlocked: cs_nTimeOffset  util.cpp:1250\n2014-04-22 21:42:19 Locking: cs_LastBlockFile  main.cpp:2199\n2014-04-22 21:42:19 Locking: csPathCached  util.cpp:995\n2014-04-22 21:42:19 Unlocked: csPathCached  util.cpp:995\n2014-04-22 21:42:19 **\\* Error: Disk space is low!\n\nAlso, it only happens with bitcoin-qt, not with the daemon, and it doesn't happen with 55a1db4fa2cf62b9766ef382c1e14b3ecbdf67fe reverted (but it do have other issues).\n",
      "created_at" : "2014-04-22T22:06:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4083#issuecomment-41101934",
      "id" : 41101934,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4083",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTAxOTM0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41101934/reactions"
      },
      "updated_at" : "2014-04-22T22:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41101934",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1192483?v=4",
         "events_url" : "https://api.github.com/users/rdponticelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rdponticelli/followers",
         "following_url" : "https://api.github.com/users/rdponticelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rdponticelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rdponticelli",
         "id" : 1192483,
         "login" : "rdponticelli",
         "node_id" : "MDQ6VXNlcjExOTI0ODM=",
         "organizations_url" : "https://api.github.com/users/rdponticelli/orgs",
         "received_events_url" : "https://api.github.com/users/rdponticelli/received_events",
         "repos_url" : "https://api.github.com/users/rdponticelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rdponticelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rdponticelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rdponticelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Does it report anything about a deadlock if you compile with DEBUG_LOCKORDER?\n(which locks, acquired where, are causing this deadlock?)\n",
      "created_at" : "2014-04-23T06:06:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4083#issuecomment-41127722",
      "id" : 41127722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4083",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTI3NzIy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41127722/reactions"
      },
      "updated_at" : "2014-04-23T06:07:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41127722",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I managed to reproduce this. This is a very sneaky deadlock, not a conventional one.\n\nThe problem is that the P2P thread does a _synchronous_ call to the GUI thread to show a notification, with locks held. It is synchronous because the shutdown needs to wait for the user to click 'Ok' on the dialog box (so they can read the error message...).\n\nOne solution would be for the GUI thread to use TRY_LOCKs for periodically updating various stats from the core. This would avoid it getting stuck when the lock is already held.\n\nEdit: Hmm I tried this but it doesn't always work either. An update can come from Qt itself, and the various model update functions also need locks. These are harder to skip than periodical polls and would need to show cached data.\n",
      "created_at" : "2014-04-23T06:23:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4083#issuecomment-41128544",
      "id" : 41128544,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4083",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTI4NTQ0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41128544/reactions"
      },
      "updated_at" : "2014-04-23T07:01:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41128544",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "See #4085\n",
      "created_at" : "2014-04-23T07:11:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/4083#issuecomment-41131144",
      "id" : 41131144,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4083",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMTMxMTQ0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41131144/reactions"
      },
      "updated_at" : "2014-04-23T07:11:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/41131144",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
