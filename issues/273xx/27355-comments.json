[
   {
      "author_association" : "MEMBER",
      "body" : "Reproducible? If yes, what are the steps to reproduce?",
      "created_at" : "2023-03-28T14:56:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1487049094",
      "id" : 1487049094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585YopGG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487049094/reactions"
      },
      "updated_at" : "2023-03-28T14:56:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487049094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Reproducible\r\n\r\n100%. Running `time FILE_ENV=\"./ci/test/00_setup_env_native_tsan.sh\" ./ci/test_run_all.sh` on a aarch64 machine running Fedora 37.",
      "created_at" : "2023-03-28T14:58:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1487053086",
      "id" : 1487053086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585YoqEe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487053086/reactions"
      },
      "updated_at" : "2023-03-28T14:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487053086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Retesting this on master (04595484d97100a50c146e5fc080319d9e0f5ca4). 1 line missing from the above output, which is dumped out in the test failure output before the test is re-run is `libc++abi: Pure virtual function called!`:\r\n```bash\r\n2023-04-05T15:47:47.686929Z (mocktime: 2020-08-31T15:34:12Z) [basic block filter index] [util/thread.cpp:20] [TraceThread] basic block filter index thread start\r\ntest/blockfilter_index_tests.cpp(147): fatal error: in \"blockfilter_index_tests/blockfilter_index_initial_sync\": critical check time_start + timeout_ms > GetTimeMillis() has failed\r\nlibc++abi: Pure virtual function called!\r\nmake[3]: *** [Makefile:21866: test/blockfilter_index_tests.cpp.test] Error 1\r\n```",
      "created_at" : "2023-04-05T16:05:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1497754148",
      "id" : 1497754148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585ZReok",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1497754148/reactions"
      },
      "updated_at" : "2023-04-05T16:05:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1497754148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think that the data race is not the root cause, but happens as a result of the absolute timeout  https://github.com/bitcoin/bitcoin/blob/04595484d97100a50c146e5fc080319d9e0f5ca4/src/test/txindex_tests.cpp#L35\r\nnot being sufficient, because the test environment is too slow for whatever reason.\r\nIn this case, the `BOOST_REQUIRE` in https://github.com/bitcoin/bitcoin/blob/04595484d97100a50c146e5fc080319d9e0f5ca4/src/test/txindex_tests.cpp#L38 fails, and the index isn't terminated correctly (by waiting for `ThreadSync` to stop, as it would be done in `txindex.Stop()` below if the boost assert wasn't hit)\r\n\r\nI could reproduce the error and the data race on my machine (x86_64 Ubuntu) by setting `timeout_ms = 0` in the line above.\r\n\r\nAs a fix, I think that we should wait longer for the sync to finish, by either getting rid of the constant timeout (though that would mean it could run forever if something was wrong) or at least increasing it significantly. I'll look into that.\r\n\r\n",
      "created_at" : "2023-04-05T19:35:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1498015461",
      "id" : 1498015461,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585ZSebl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498015461/reactions"
      },
      "updated_at" : "2023-04-05T19:46:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498015461",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Hmm, the existing timeout of 10 seconds seems plenty for the sync process, which takes just a few milliseconds on my computer.\r\n@fanquake would a higher timeout fix this in your environment? Are you doing some extreme parallelization or someting, such that the test is simply that slow? \r\nOr is there possibly some other reason that prevents the Index sync from finishing on aarch64, so that bumping the timeout wouldn't help?",
      "created_at" : "2023-04-05T20:28:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1498111803",
      "id" : 1498111803,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585ZS187",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498111803/reactions"
      },
      "updated_at" : "2023-04-05T20:28:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498111803",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> would a higher timeout fix this in your environment? \r\n\r\nI bumped the timeout, and it didn't seem to make any difference.\r\n\r\n> Are you doing some extreme parallelization or someting, such that the test is simply that slow?\r\n\r\nNothing like that, and the machine isn't particularly slow. i.e it has no issue running various valgrind and other CI jobs. I'll take another look.",
      "created_at" : "2023-04-12T10:46:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1505059300",
      "id" : 1505059300,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585ZtWHk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505059300/reactions"
      },
      "updated_at" : "2023-04-12T10:46:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505059300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Hmm, then my guess that it could be the timeout was probably wrong. Could you run the test in isolation with `-- -printtoconsole` and post the log?",
      "created_at" : "2023-04-12T14:25:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1505373331",
      "id" : 1505373331,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585ZuiyT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505373331/reactions"
      },
      "updated_at" : "2023-04-12T14:25:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1505373331",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > Reproducible\r\n> \r\n> 100%. Running `time FILE_ENV=\"./ci/test/00_setup_env_native_tsan.sh\" ./ci/test_run_all.sh` on a aarch64 machine running Fedora 37.\r\n\r\nIdk. Locally this fails for me when building bdb:\r\n\r\n```\r\nExtracting bdb...\r\n/root/bitcoin-core/depends/sources/db-4.8.30.NC.tar.gz: OK\r\nPreprocessing bdb...\r\nConfiguring bdb...\r\npatching file dbinc/atomic.h\r\npatching file mp/mp_fget.c\r\npatching file mp/mp_mvcc.c\r\npatching file mp/mp_region.c\r\npatching file mutex/mut_method.c\r\npatching file mutex/mut_tas.c\r\nchecking build system type... aarch64-unknown-linux-gnu\r\nchecking host system type... aarch64-unknown-linux-gnu\r\nchecking if building in the top-level or dist directories... no\r\nchecking if --disable-cryptography option specified... no\r\nchecking if --disable-hash option specified... no\r\nchecking if --disable-partition option specified... no\r\nchecking if --disable-compression option specified... no\r\nchecking if --disable-mutexsupport option specified... no\r\nchecking if --disable-atomicsupport option specified... no\r\nchecking if --disable-queue option specified... no\r\nchecking if --disable-replication option specified... yes\r\nchecking if --disable-statistics option specified... no\r\nchecking if --disable-verify option specified... no\r\nchecking if --enable-compat185 option specified... no\r\nchecking if --enable-cxx option specified... yes\r\nchecking if --enable-debug option specified... no\r\nchecking if --enable-debug_rop option specified... no\r\nchecking if --enable-debug_wop option specified... no\r\nchecking if --enable-diagnostic option specified... no\r\nchecking if --enable-dump185 option specified... no\r\nchecking if --enable-java option specified... no\r\nchecking if --enable-mingw option specified... no\r\nchecking if --enable-o_direct option specified... no\r\nchecking if --enable-posixmutexes option specified... no\r\nchecking if --enable-rpc option specified... no\r\nchecking if --enable-smallbuild option specified... no\r\nchecking if --enable-stl option specified... no\r\nchecking if --enable-tcl option specified... no\r\nchecking if --enable-test option specified... no\r\nchecking if --enable-uimutexes option specified... no\r\nchecking if --enable-umrw option specified... no\r\nchecking if --with-mutex=MUTEX option specified... no\r\nchecking if --with-tcl=DIR option specified... no\r\nchecking if --with-uniquename=NAME option specified... no\r\nchecking for aarch64-unknown-linux-gnu-chmod... no\r\nchecking for chmod... chmod\r\nchecking for aarch64-unknown-linux-gnu-cp... no\r\nchecking for cp... cp\r\nchecking for aarch64-unknown-linux-gnu-ln... no\r\nchecking for ln... ln\r\nchecking for aarch64-unknown-linux-gnu-mkdir... no\r\nchecking for mkdir... mkdir\r\nchecking for aarch64-unknown-linux-gnu-rm... no\r\nchecking for rm... rm\r\nchecking for aarch64-unknown-linux-gnu-sh... no\r\nchecking for sh... /usr/bin/sh\r\nchecking for a BSD-compatible install... /usr/bin/install -c\r\nchecking for aarch64-unknown-linux-gnu-cc... clang-16\r\nchecking whether the C compiler works... yes\r\nchecking for C compiler default output file name... a.out\r\nchecking for suffix of executables... \r\nchecking whether we are cross compiling... no\r\nchecking for suffix of object files... o\r\nchecking whether we are using the GNU C compiler... yes\r\nchecking whether clang-16 accepts -g... yes\r\nchecking for clang-16 option to accept ISO C89... none needed\r\nchecking for an ANSI C-conforming const... yes\r\nchecking for inline... inline\r\nchecking whether we are using the GNU C++ compiler... yes\r\nchecking whether clang++-16 -stdlib=libc++ accepts -g... yes\r\nchecking how to run the C++ preprocessor... clang++-16 -stdlib=libc++ -E\r\nchecking whether C++ supports the ISO C++ standard includes... yes\r\nchecking whether we are using gcc version 2.96... no\r\nchecking for a sed that does not truncate output... /usr/bin/sed\r\nchecking for grep that handles long lines and -e... /usr/bin/grep\r\nchecking for egrep... /usr/bin/grep -E\r\nchecking for fgrep... /usr/bin/grep -F\r\nchecking for ld used by clang-16... /usr/bin/ld\r\nchecking if the linker (/usr/bin/ld) is GNU ld... yes\r\nchecking for BSD- or MS-compatible name lister (nm)... nm\r\nchecking the name lister (nm) interface... BSD nm\r\nchecking whether ln -s works... yes\r\nchecking the maximum length of command line arguments... 1572864\r\nchecking whether the shell understands some XSI constructs... yes\r\nchecking whether the shell understands \"+=\"... yes\r\nchecking for /usr/bin/ld option to reload object files... -r\r\nchecking for aarch64-unknown-linux-gnu-objdump... no\r\nchecking for objdump... objdump\r\nchecking how to recognize dependent libraries... pass_all\r\nchecking for aarch64-unknown-linux-gnu-ar... ar\r\nchecking for aarch64-unknown-linux-gnu-strip... no\r\nchecking for strip... strip\r\nchecking for aarch64-unknown-linux-gnu-ranlib... ranlib\r\nchecking command to parse nm output from clang-16 object... ok\r\nchecking how to run the C preprocessor... clang-16 -E\r\nchecking for ANSI C header files... yes\r\nchecking for sys/types.h... yes\r\nchecking for sys/stat.h... yes\r\nchecking for stdlib.h... yes\r\nchecking for string.h... yes\r\nchecking for memory.h... yes\r\nchecking for strings.h... yes\r\nchecking for inttypes.h... yes\r\nchecking for stdint.h... yes\r\nchecking for unistd.h... yes\r\nchecking for dlfcn.h... yes\r\nchecking whether we are using the GNU C++ compiler... (cached) yes\r\nchecking whether clang++-16 -stdlib=libc++ accepts -g... (cached) yes\r\nchecking how to run the C++ preprocessor... clang++-16 -stdlib=libc++ -E\r\nchecking for objdir... .libs\r\nchecking if clang-16 supports -fno-rtti -fno-exceptions... yes\r\nchecking for clang-16 option to produce PIC... -fPIC -DPIC\r\nchecking if clang-16 PIC flag -fPIC -DPIC works... yes\r\nchecking if clang-16 static flag -static works... yes\r\nchecking if clang-16 supports -c -o file.o... yes\r\nchecking if clang-16 supports -c -o file.o... (cached) yes\r\nchecking whether the clang-16 linker (/usr/bin/ld) supports shared libraries... yes\r\nchecking dynamic linker characteristics... GNU/Linux ld.so\r\nchecking how to hardcode library paths into programs... immediate\r\nchecking whether stripping libraries is possible... yes\r\nchecking if libtool supports shared libraries... yes\r\nchecking whether to build shared libraries... no\r\nchecking whether to build static libraries... yes\r\nchecking for ld used by clang++-16 -stdlib=libc++... /usr/bin/ld\r\nchecking if the linker (/usr/bin/ld) is GNU ld... yes\r\nchecking whether the clang++-16 -stdlib=libc++ linker (/usr/bin/ld) supports shared libraries... yes\r\nchecking for clang++-16 -stdlib=libc++ option to produce PIC... -fPIC -DPIC\r\nchecking if clang++-16 -stdlib=libc++ PIC flag -fPIC -DPIC works... yes\r\nchecking if clang++-16 -stdlib=libc++ static flag -static works... yes\r\nchecking if clang++-16 -stdlib=libc++ supports -c -o file.o... yes\r\nchecking if clang++-16 -stdlib=libc++ supports -c -o file.o... (cached) yes\r\nchecking whether the clang++-16 -stdlib=libc++ linker (/usr/bin/ld) supports shared libraries... yes\r\nchecking dynamic linker characteristics... GNU/Linux ld.so\r\nchecking how to hardcode library paths into programs... immediate\r\nchecking SOSUFFIX from libtool... .so\r\nchecking MODSUFFIX from libtool... .so\r\nchecking JMODSUFFIX from libtool... .so\r\nchecking whether stat file-mode macros are broken... no\r\nchecking whether time.h and sys/time.h may both be included... yes\r\nchecking for dirent.h that defines DIR... yes\r\nchecking for library containing opendir... none required\r\nchecking execinfo.h usability... yes\r\nchecking execinfo.h presence... yes\r\nchecking for execinfo.h... yes\r\nchecking sys/select.h usability... yes\r\nchecking sys/select.h presence... yes\r\nchecking for sys/select.h... yes\r\nchecking sys/socket.h usability... yes\r\nchecking sys/socket.h presence... yes\r\nchecking for sys/socket.h... yes\r\nchecking sys/time.h usability... yes\r\nchecking sys/time.h presence... yes\r\nchecking for sys/time.h... yes\r\nchecking for struct stat.st_blksize... yes\r\nchecking for inttypes.h... (cached) yes\r\nchecking for stdint.h... yes\r\nchecking if stdint.h can be used by C++... yes\r\nchecking stddef.h usability... yes\r\nchecking stddef.h presence... yes\r\nchecking for stddef.h... yes\r\nchecking for unistd.h... (cached) yes\r\nchecking size of char... 1\r\nchecking size of unsigned char... 1\r\nchecking size of short... 2\r\nchecking size of unsigned short... 2\r\nchecking size of int... 4\r\nchecking size of unsigned int... 4\r\nchecking size of long... 8\r\nchecking size of unsigned long... 8\r\nchecking size of long long... 8\r\nchecking size of unsigned long long... 8\r\nchecking size of char *... 8\r\nchecking for u_char... yes\r\nchecking for u_short... yes\r\nchecking for u_int... yes\r\nchecking for u_long... yes\r\nchecking for u_int8_t... yes\r\nchecking for u_int16_t... yes\r\nchecking for int16_t... yes\r\nchecking for u_int32_t... yes\r\nchecking for int32_t... yes\r\nchecking for u_int64_t... yes\r\nchecking for int64_t... yes\r\nchecking for FILE *... yes\r\nchecking for off_t... yes\r\nchecking for pid_t... yes\r\nchecking for size_t... yes\r\nchecking for time_t... yes\r\nchecking size of size_t... 8\r\nchecking for ssize_t... yes\r\nchecking for uintmax_t... yes\r\nchecking for uintptr_t... yes\r\nchecking for socklen_t... yes\r\nchecking for ANSI C exit success/failure values... yes\r\nchecking for getopt optreset variable... no\r\nchecking for mutexes... UNIX/fcntl\r\nconfigure: WARNING: NO SHARED LATCH IMPLEMENTATION FOUND FOR THIS PLATFORM.\r\nconfigure: error: Unable to find a mutex implementation\r\nmake: *** [funcs.mk:292: /root/bitcoin-core/depends/aarch64-unknown-linux-gnu/.bdb_stamp_configured] Error 1\r\nmake: Leaving directory '/root/bitcoin-core/depends'\r\n",
      "created_at" : "2023-04-13T14:44:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1507099435",
      "id" : 1507099435,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z1IMr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507099435/reactions"
      },
      "updated_at" : "2023-04-13T14:44:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507099435",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Idk. Locally this fails for me when building bdb:\r\n\r\nYea. You'll have to use `NO_BDB=1`, or fix BDB.",
      "created_at" : "2023-04-13T14:45:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1507100965",
      "id" : 1507100965,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z1Ikl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507100965/reactions"
      },
      "updated_at" : "2023-04-13T14:45:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507100965",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, it is passing for me with NO_BDB. Could be a hardware issue on your side.\r\n\r\n```\r\n# lscpu\r\nArchitecture:            aarch64\r\n  CPU op-mode(s):        32-bit, 64-bit\r\n  Byte Order:            Little Endian\r\nCPU(s):                  4\r\n  On-line CPU(s) list:   0-3\r\nVendor ID:               ARM\r\n  BIOS Vendor ID:        QEMU\r\n  Model name:            Neoverse-N1\r\n    BIOS Model name:     NotSpecified  CPU @ 2.0GHz\r\n    BIOS CPU family:     1\r\n    Model:               1\r\n    Thread(s) per core:  1\r\n    Core(s) per cluster: 4\r\n    Socket(s):           1\r\n    Cluster(s):          1\r\n    Stepping:            r3p1\r\n    BogoMIPS:            50.00\r\n    Flags:               fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm lrcpc dcpop asimddp ssbs\r\nNUMA:                    \r\n  NUMA node(s):          1\r\n  NUMA node0 CPU(s):     0-3\r\nVulnerabilities:         \r\n  Itlb multihit:         Not affected\r\n  L1tf:                  Not affected\r\n  Mds:                   Not affected\r\n  Meltdown:              Not affected\r\n  Mmio stale data:       Not affected\r\n  Retbleed:              Not affected\r\n  Spec store bypass:     Mitigation; Speculative Store Bypass disabled via prctl\r\n  Spectre v1:            Mitigation; __user pointer sanitization\r\n  Spectre v2:            Mitigation; CSV2, BHB\r\n  Srbds:                 Not affected\r\n  Tsx async abort:       Not affected\r\n",
      "created_at" : "2023-04-13T16:09:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1507231532",
      "id" : 1507231532,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z1ocs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507231532/reactions"
      },
      "updated_at" : "2023-04-13T16:09:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507231532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I am using podman, but that shouldn't matter",
      "created_at" : "2023-04-13T16:12:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1507234555",
      "id" : 1507234555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z1pL7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507234555/reactions"
      },
      "updated_at" : "2023-04-13T16:12:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1507234555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Maybe you can share your CPU model/hardware, so that someone can try on that, but other than that I am not sure what to do here",
      "created_at" : "2023-04-14T08:45:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1508155742",
      "id" : 1508155742,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z5KFe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508155742/reactions"
      },
      "updated_at" : "2023-04-14T08:45:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508155742",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Maybe you can share your CPU model/hardware,\r\n\r\nIt's the same as yours above:\r\n```bash\r\nArchitecture:           aarch64\r\n  CPU op-mode(s):       32-bit, 64-bit\r\n  Byte Order:           Little Endian\r\nCPU(s):                 4\r\n  On-line CPU(s) list:  0-3\r\nVendor ID:              ARM\r\n  Model name:           Neoverse-N1\r\n    Model:              1\r\n    Thread(s) per core: 1\r\n    Core(s) per socket: 4\r\n    Socket(s):          1\r\n    Stepping:           r3p1\r\n    BogoMIPS:           243.75\r\n    Flags:              fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm lrcpc dcpop asimddp ssbs\r\nCaches (sum of all):    \r\n  L1d:                  256 KiB (4 instances)\r\n  L1i:                  256 KiB (4 instances)\r\n  L2:                   4 MiB (4 instances)\r\n  L3:                   32 MiB (1 instance)\r\nNUMA:                   \r\n  NUMA node(s):         1\r\n  NUMA node0 CPU(s):    0-3\r\nVulnerabilities:        \r\n  Itlb multihit:        Not affected\r\n  L1tf:                 Not affected\r\n  Mds:                  Not affected\r\n  Meltdown:             Not affected\r\n  Mmio stale data:      Not affected\r\n  Retbleed:             Not affected\r\n  Spec store bypass:    Mitigation; Speculative Store Bypass disabled via prctl\r\n  Spectre v1:           Mitigation; __user pointer sanitization\r\n  Spectre v2:           Mitigation; CSV2, BHB\r\n  Srbds:                Not affected\r\n  Tsx async abort:      Not affected\r\n```",
      "created_at" : "2023-04-14T08:51:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1508165087",
      "id" : 1508165087,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z5MXf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508165087/reactions"
      },
      "updated_at" : "2023-04-14T08:51:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508165087",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Hmm, then my guess that it could be the timeout was probably wrong. Could you run the test in isolation with -- -printtoconsole and post the log?\r\n\r\nWith the branch in #27462 (which just fixes BDB compilation), if i run the TSAN CI, it fails as it has been. However if I exec into the container after it fails, and run `src/test/test_bitcoin --catch_system_errors=no -l test_suite -t blockfilter_index_tests`, this issue does not reproduce.\r\n\r\n\r\n",
      "created_at" : "2023-04-14T12:39:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1508445672",
      "id" : 1508445672,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z6Q3o",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508445672/reactions"
      },
      "updated_at" : "2023-04-14T12:39:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508445672",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I also can *not* reproduce with:\r\n\r\n```\r\ntime bash -c 'RUN_UNIT_TESTS_SEQUENTIAL=\"true\" RUN_UNIT_TESTS=\"false\" RUN_FUNCTIONAL_TESTS=false CCACHE_SIZE=500M MAKEJOBS=\"-j9\" FILE_ENV=\"./ci/test/00_setup_env_native_tsan.sh\" ./ci/test_run_all.sh'\r\n```\r\nand diff:\r\n\r\n```diff\r\ndiff --git a/ci/test/06_script_b.sh b/ci/test/06_script_b.sh\r\nindex f7dcbcee5..899c99119 100755\r\n--- a/ci/test/06_script_b.sh\r\n+++ b/ci/test/06_script_b.sh\r\n@@ -29,7 +29,7 @@ if [ \"$RUN_UNIT_TESTS\" = \"true\" ]; then\r\n fi\r\n \r\n if [ \"$RUN_UNIT_TESTS_SEQUENTIAL\" = \"true\" ]; then\r\n-  CI_EXEC \"${TEST_RUNNER_ENV}\" DIR_UNIT_TEST_DATA=\"${DIR_UNIT_TEST_DATA}\" LD_LIBRARY_PATH=\"${DEPENDS_DIR}/${HOST}/lib\" \"${BASE_OUTDIR}/bin/test_bitcoin\" --catch_system_errors=no -l test_suite\r\n+  CI_EXEC \"${TEST_RUNNER_ENV}\" DIR_UNIT_TEST_DATA=\"${DIR_UNIT_TEST_DATA}\" LD_LIBRARY_PATH=\"${DEPENDS_DIR}/${HOST}/lib\" \"${BASE_OUTDIR}/bin/test_bitcoin\" --catch_system_errors=no -l test_suite -t blockfilter_index_tests\r\n fi\r\n \r\n if [ \"$RUN_FUNCTIONAL_TESTS\" = \"true\" ]; then\r\ndiff --git a/depends/packages/bdb.mk b/depends/packages/bdb.mk\r\nindex d60733605..9f5a92501 100644\r\n--- a/depends/packages/bdb.mk\r\n+++ b/depends/packages/bdb.mk\r\n@@ -14,7 +14,7 @@ $(package)_config_opts_freebsd=--with-pic\r\n $(package)_config_opts_netbsd=--with-pic\r\n $(package)_config_opts_openbsd=--with-pic\r\n $(package)_config_opts_android=--with-pic\r\n-$(package)_cflags+=-Wno-error=implicit-function-declaration -Wno-error=format-security\r\n+$(package)_cflags+=-Wno-error=implicit-function-declaration -Wno-error=format-security -Wno-error=implicit-int\r\n $(package)_cppflags_freebsd=-D_XOPEN_SOURCE=600 -D__BSD_VISIBLE=1\r\n $(package)_cppflags_netbsd=-D_XOPEN_SOURCE=600\r\n $(package)_cppflags_openbsd=-D_XOPEN_SOURCE=600\r\n",
      "created_at" : "2023-04-14T13:28:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1508505587",
      "id" : 1508505587,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z6ffz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508505587/reactions"
      },
      "updated_at" : "2023-04-14T13:28:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508505587",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "All I run into here is a bdb issue, which can be worked around with:\r\n\r\n```diff\r\ndiff --git a/test/sanitizer_suppressions/tsan b/test/sanitizer_suppressions/tsan\r\nindex d33199127..35c6a5f95 100644\r\n--- a/test/sanitizer_suppressions/tsan\r\n+++ b/test/sanitizer_suppressions/tsan\r\n@@ -23,7 +23,7 @@ race:src/qt/test/*\r\n deadlock:src/qt/test/*\r\n \r\n # External libraries\r\n-deadlock:libdb\r\n+deadlock:__db_pthread_mutex_lock\r\n race:libzmq\r\n \r\n # Intermittent issues\r\n",
      "created_at" : "2023-04-14T14:20:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1508629562",
      "id" : 1508629562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z69w6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508629562/reactions"
      },
      "updated_at" : "2023-04-14T14:20:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508629562",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Not really a fix if there is something else going on but.. could use https://github.com/furszy/bitcoin-core/commit/8495c852ebe199a96a4e205937861b76f54227eb (quick and dirty) to remove the active-wait timeout error.",
      "created_at" : "2023-04-14T15:06:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1508740170",
      "id" : 1508740170,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585Z7YxK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508740170/reactions"
      },
      "updated_at" : "2023-04-14T15:06:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508740170",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I ran into this as well:\r\n\r\n\r\n```\r\n2023-05-12T12:24:59.051246Z (mocktime: 2020-08-31T15:34:11Z) [test] [node/miner.cpp:162] [CreateNewBlock] CreateNewBlock(): block weight: 940 txs: 0 fees: 0 sigops 400\r\n2023-05-12T12:24:59.051432Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2159] [ConnectBlock] [bench]     - Sanity checks: 0.01ms [0.00s (0.00ms/blk)]\r\n2023-05-12T12:24:59.051514Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2261] [ConnectBlock] [bench]     - Fork checks: 0.09ms [0.02s (0.09ms/blk)]\r\n2023-05-12T12:24:59.051591Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2351] [ConnectBlock] [bench]       - Connect 1 transactions: 0.07ms (0.071ms/tx, 0.000ms/txin) [0.02s (0.08ms/blk)]\r\n2023-05-12T12:24:59.051658Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2369] [ConnectBlock] [bench]     - Verify 0 txins: 0.14ms (0.000ms/txin) [0.03s (0.15ms/blk)]\r\n2023-05-12T12:24:59.051782Z (mocktime: 2020-08-31T15:34:11Z) [test] [node/miner.cpp:181] [CreateNewBlock] [bench] CreateNewBlock() packages: 0.03ms (0 packages, 0 updated descendants), validity: 0.60ms (total 0.63ms)\r\n2023-05-12T12:24:59.052016Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:3870] [AcceptBlockHeader] Saw new header hash=571d80a9967ae599cec0448b0b0ba1cfb606f584d8069bd7166b86854ba7a191 height=100\r\n2023-05-12T12:24:59.052580Z (mocktime: 2020-08-31T15:34:11Z) [test] [validationinterface.cpp:260] [NewPoWValidBlock] [validation] NewPoWValidBlock: block hash=571d80a9967ae599cec0448b0b0ba1cfb606f584d8069bd7166b86854ba7a191\r\n2023-05-12T12:24:59.053339Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2831] [ConnectTip] [bench]   - Using cached block\r\n2023-05-12T12:24:59.053400Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2842] [ConnectTip] [bench]   - Load block from disk: 0.05ms [0.01s (0.03ms/blk)]\r\n2023-05-12T12:24:59.053525Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2159] [ConnectBlock] [bench]     - Sanity checks: 0.00ms [0.00s (0.00ms/blk)]\r\n2023-05-12T12:24:59.053604Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2261] [ConnectBlock] [bench]     - Fork checks: 0.08ms [0.02s (0.09ms/blk)]\r\n2023-05-12T12:24:59.053686Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2351] [ConnectBlock] [bench]       - Connect 1 transactions: 0.08ms (0.076ms/tx, 0.000ms/txin) [0.02s (0.08ms/blk)]\r\n2023-05-12T12:24:59.053785Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2369] [ConnectBlock] [bench]     - Verify 0 txins: 0.18ms (0.000ms/txin) [0.03s (0.15ms/blk)]\r\n2023-05-12T12:24:59.053947Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2383] [ConnectBlock] [bench]     - Write undo data: 0.16ms [0.02s (0.11ms/blk)]\r\n2023-05-12T12:24:59.054000Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2398] [ConnectBlock] [bench]     - Index writing: 0.06ms [0.01s (0.03ms/blk)]\r\n2023-05-12T12:24:59.054061Z (mocktime: 2020-08-31T15:34:11Z) [test] [validationinterface.cpp:255] [BlockChecked] [validation] BlockChecked: block hash=571d80a9967ae599cec0448b0b0ba1cfb606f584d8069bd7166b86854ba7a191 state=Valid\r\n2023-05-12T12:24:59.054118Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2858] [ConnectTip] [bench]   - Connect total: 0.73ms [0.08s (0.38ms/blk)]\r\n2023-05-12T12:24:59.054336Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2867] [ConnectTip] [bench]   - Flush: 0.21ms [0.02s (0.11ms/blk)]\r\n2023-05-12T12:24:59.054409Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2877] [ConnectTip] [bench]   - Writing chainstate: 0.08ms [0.01s (0.04ms/blk)]\r\n2023-05-12T12:24:59.055286Z (mocktime: 2020-08-31T15:34:11Z) [test] [policy/fees.cpp:667] [processBlock] [estimatefee] Blockpolicy estimates updated by 0 of 0 block txs, since last block 0 of 0 tracked, mempool map size 0, max target 0 from current\r\n2023-05-12T12:24:59.055419Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2637] [UpdateTipLog] UpdateTip: new best=571d80a9967ae599cec0448b0b0ba1cfb606f584d8069bd7166b86854ba7a191 height=100 version=0x20000000 log2_work=7.658211 tx=101 date='2020-08-31T15:34:11Z' progress=1.000000 cache=0.3MiB(100txo)\r\n2023-05-12T12:24:59.055471Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2893] [ConnectTip] [bench]   - Connect postprocess: 1.06ms [0.11s (0.54ms/blk)]\r\n2023-05-12T12:24:59.055516Z (mocktime: 2020-08-31T15:34:11Z) [test] [validation.cpp:2897] [ConnectTip] [bench] - Connect block: 2.13ms [0.22s (1.09ms/blk)]\r\n2023-05-12T12:24:59.055585Z (mocktime: 2020-08-31T15:34:11Z) [test] [txmempool.cpp:659] [check] [mempool] Checking mempool with 0 transactions and 0 inputs\r\n2023-05-12T12:24:59.055797Z (mocktime: 2020-08-31T15:34:11Z) [test] [validationinterface.cpp:232] [BlockConnected] [validation] Enqueuing BlockConnected: block hash=571d80a9967ae599cec0448b0b0ba1cfb606f584d8069bd7166b86854ba7a191 block height=100\r\n2023-05-12T12:24:59.055935Z (mocktime: 2020-08-31T15:34:11Z) [scheduler] [validationinterface.cpp:232] [operator()] [validation] BlockConnected: block hash=571d80a9967ae599cec0448b0b0ba1cfb606f584d8069bd7166b86854ba7a191 block height=100\r\n2023-05-12T12:24:59.056065Z (mocktime: 2020-08-31T15:34:11Z) [test] [validationinterface.cpp:204] [UpdatedBlockTip] [validation] Enqueuing UpdatedBlockTip: new block hash=571d80a9967ae599cec0448b0b0ba1cfb606f584d8069bd7166b86854ba7a191 fork block hash=68aef0c7c1c2cc15ca20a558ea1d6e66aecc1d6398bddea75e4c031cb79cc07e (in IBD=false)\r\n2023-05-12T12:24:59.056203Z (mocktime: 2020-08-31T15:34:11Z) [scheduler] [validationinterface.cpp:204] [operator()] [validation] UpdatedBlockTip: new block hash=571d80a9967ae599cec0448b0b0ba1cfb606f584d8069bd7166b86854ba7a191 fork block hash=68aef0c7c1c2cc15ca20a558ea1d6e66aecc1d6398bddea75e4c031cb79cc07e (in IBD=false)\r\n2023-05-12T12:24:59.068884Z (mocktime: 2020-08-31T15:34:12Z) [test] [dbwrapper.cpp:158] [CDBWrapper] Opened LevelDB successfully\r\n2023-05-12T12:24:59.068996Z (mocktime: 2020-08-31T15:34:12Z) [test] [dbwrapper.cpp:183] [CDBWrapper] Using obfuscation key for /tmp/test_common_Bitcoin Core/2ce9328e486919722790b84cffa4be425cf708aac6a4db24624ed0ff4e487f1d/regtest/indexes/blockfilter/basic/db: 0000000000000000\r\ntest/blockfilter_index_tests.cpp(148): fatal error: in \"blockfilter_index_tests/blockfilter_index_initial_sync\": critical check time_start + timeout > SteadyClock::now() has failed\r\nlibc++abi: Pure virtual function called!\r\n2023-05-12T12:24:59.113190Z (mocktime: 2020-08-31T15:34:12Z) [basic block filter index] [util/thread.cpp:20] [TraceThread] basic block filter index thread start\r\nmake[3]: Leaving directory '/root/b-c-ci/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src'\r\nmake[2]: *** [Makefile:20096: check-am] Error 2\r\nmake[2]: Leaving directory '/root/b-c-ci/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src'\r\nmake[1]: *** [Makefile:19761: check-recursive] Error 1\r\nmake[1]: Leaving directory '/root/b-c-ci/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src'\r\nmake: *** [Makefile:816: check-recursive] Error 1\r\nEmulate Docker CLI using podman. Create /etc/containers/nodocker to quiet msg.\r\n",
      "created_at" : "2023-05-12T14:31:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1545838936",
      "id" : 1545838936,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585cI6FY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545838936/reactions"
      },
      "updated_at" : "2023-05-12T14:31:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545838936",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is it me or DrahtBot is typing as a human?",
      "created_at" : "2023-05-12T14:42:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/27355#issuecomment-1545855845",
      "id" : 1545855845,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27355",
      "node_id" : "IC_kwDOABII585cI-Nl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545855845/reactions"
      },
      "updated_at" : "2023-05-12T14:42:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1545855845",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
