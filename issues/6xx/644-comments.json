[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I found a version 4.8 of db, so will try building against that.\n\nIt's here:\n\nhttp://aur.archlinux.org/packages.php?ID=43907\n",
      "created_at" : "2011-11-19T01:10:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2796661",
      "id" : 2796661,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3OTY2NjE=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2796661/reactions"
      },
      "updated_at" : "2011-11-19T01:10:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2796661",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Cannot reproduce using Ubuntu 10.10 server.\n",
      "created_at" : "2011-11-19T16:26:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2799549",
      "id" : 2799549,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI3OTk1NDk=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2799549/reactions"
      },
      "updated_at" : "2011-11-19T16:26:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2799549",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=4",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I've been able to reproduce it several times, but not reliably.\n\nIt does seem to trash my wallet when I do, however.  Luckily I made a backup before running rc6 for the first time so didn't lose any funds.  I wonder if it would be good to always have bitcoin keep a copy of the previous version of the wallet in case this or other bugs cause wallet corruption.  If we only update the backup each time we successfully load a wallet we should never have the user be without any working copy of their wallet.\n\nI'll try again to find a reliable way to reproduce this problem.\n",
      "created_at" : "2011-11-19T18:04:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2800025",
      "id" : 2800025,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDAwMjU=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800025/reactions"
      },
      "updated_at" : "2011-11-19T18:04:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800025",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "OK, this seems to do it:\n\n/bin/rm -fr ~/.bitcoin; rc1-db4/bitcoin-qt -keypool=3; rc6-db4/bitcoin-qt -keypool=3; rc6-db4/bitcoin-qt -keypool=3\n\nRemove .bitcoind, create it using rc1 and immediately encrypt the wallet, then quit.  Then run rc6, it will rewrite the wallet and exit.  Run it again, and it fails to start.  Here's the output.  I put some debugging printf()s in db4.8.\n\nchris@chris:~/Programs/bitcoin$ /bin/rm -fr ~/.bitcoin; rc1-db4/bitcoin-qt -keypool=3; rc6-db4/bitcoin-qt -keypool=3; rc6-db4/bitcoin-qt -keypool=3\nQGtkStyle was unable to detect the current GTK+ theme.\n__db_open_pp('addr.dat')\n__db_open_pp('addr.dat') returning 0\n__db_open_pp('blkindex.dat')\n__db_open_pp('blkindex.dat') returning 0\n__db_open_pp('wallet.dat')\n__db_open_pp('wallet.dat') returning 0\nQGtkStyle was unable to detect the current GTK+ theme.\nsubdb exists\n__db_open_pp('addr.dat')\nsubdb exists\n__db_open_pp('addr.dat') returning 0\n__db_open_pp('blkindex.dat')\nsubdb exists\n__db_open_pp('blkindex.dat') returning 0\n__db_open_pp('wallet.dat')\nsubdb exists\n__db_open_pp('wallet.dat') returning 0\n__db_open_pp('wallet.dat')\nsubdb exists\n__db_open_pp('wallet.dat') returning 0\n__db_open_pp('wallet.dat.rewrite')\n__db_open_pp('wallet.dat.rewrite') returning 0\nQGtkStyle was unable to detect the current GTK+ theme.\n__db_open_pp('addr.dat')\nsubdb exists\n__db_open_pp('addr.dat') returning 0\n__db_open_pp('blkindex.dat')\nsubdb exists\n__db_open_pp('blkindex.dat') returning 0\n__db_open_pp('wallet.dat')\n__db_open_pp('wallet.dat') returning 22\n\n---\n\nEXCEPTION: 11DbException  \nDb::open: Invalid argument  \nbitcoin in Runaway exception       \n\nterminate called after throwing an instance of 'DbException'\n  what():  Db::open: Invalid argument\nAborted\nchris@chris:~/Programs/bitcoin$ \n\nI've uploaded the resulting .bitcoin folder here: http://replay.marpirc.net/chris/bitcoin.tgz\n\nIt fails to load up in rc6 for me.  How about you?\n",
      "created_at" : "2011-11-19T18:55:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2800272",
      "id" : 2800272,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDAyNzI=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800272/reactions"
      },
      "updated_at" : "2011-11-19T18:55:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800272",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I did some more testing of this.\n\nIf I create and encrypt the wallet using rc3 and rewrite it using rc4, the wallet got corrupted only 1 in 5 trials.\n\nRather than writing this out in full for each case, here's a summary:\n\n(encrypt using -> rewrite using = corrupted)\n3 -> 4 = 1 of 5\n1 -> 4 = 1 of 5\n3 -> 5 = 0 of 3\n1 -> 5 = 0 of 3\n1 -> 6 = 6 of 6\n3 -> 6 = 6 of 6\n\nso it seems that creating the wallet with rc1 or rc3 then loading it into rc6 is the least safe\nrc4 and rc5 mostly are able to rewrite old wallets correctly, but rc6 always corrupts them.\n",
      "created_at" : "2011-11-19T20:01:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2800588",
      "id" : 2800588,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDA1ODg=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800588/reactions"
      },
      "updated_at" : "2011-11-19T20:01:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800588",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If I comment out line 34 of db.cpp (rc6):\n  // fRemoveLogFiles = fIn;\nthen creating and encrypting a wallet in rc3 and rewriting it in rc6 doesn't corrupt the wallet (0 of 2 trials caused corruption).\n",
      "created_at" : "2011-11-19T20:27:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2800723",
      "id" : 2800723,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDA3MjM=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800723/reactions"
      },
      "updated_at" : "2011-11-19T20:27:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800723",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This has allowed me to load my original wallet backup.  Just commenting line 1157 of wallet.cpp (rc6) fixes the problem for me: \n            // RemoveLogFilesOnShutdown(true);\n\nAlso, would it be possible to load the wallet first?  Having to wait several minutes for the addresses and blockchain to load only to have the wallet be rewritten causing bitcoin to need restarting is annoying:\n\nLoading addresses...\ndbenv.open strLogDir=/home/chris/.bitcoin/database strErrorFile=/home/chris/.bitcoin/db.log\nLoaded 150885 addresses\n addresses             44139ms\nLoading block index...\nLoadBlockIndex(): hashBestChain=0000000000000ac25d05  height=153983\n block index           87077ms\nLoading wallet...\n",
      "created_at" : "2011-11-19T20:41:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2800820",
      "id" : 2800820,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDA4MjA=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800820/reactions"
      },
      "updated_at" : "2011-11-19T20:41:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800820",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "http://pybsddb.sourceforge.net/ref/transapp/logfile.html tells me:\n\n\"you cannot remove the current log files simply because you have created a database snapshot\"\n\n\"Log files may be removed at any time, as long as:\n\nthe log file is not involved in an active transaction.\nat least two checkpoints have been written subsequent to the log file's creation.\nthe log file is not the only log file in the environment.\"\n\nIn my test cases, bitcoin is removing the only log file in the environment.  Is this the problem?\n",
      "created_at" : "2011-11-19T21:05:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2800938",
      "id" : 2800938,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDA5Mzg=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800938/reactions"
      },
      "updated_at" : "2011-11-19T21:05:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2800938",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Could be, although the log file is only removed after the new wallet is successfully written and the environment has been closed.\n\nThe problem is the log file can contain old, unencrypted private keys; suggestions on how to get bdb to completely clean up after itself very welcome...\n",
      "created_at" : "2011-11-20T02:16:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2802156",
      "id" : 2802156,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDIxNTY=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2802156/reactions"
      },
      "updated_at" : "2011-11-20T02:16:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2802156",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=4",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If I comment out the actual 'delete log file' line only, I can create a wallet in rc3 and have rc6 rewrite it, then load it successfully.  If I have it rewrite the wallet, then wait a minute and delete the logfile from .bitcoin/databases _while no bitcoin process is running_, it won't later load up the wallet again.\n\nSo it seems that the log files can contain something necessary even when the process is stopped.\n\nThis file:\n  http://replay.marpirc.net/chris/bitcoin2.tgz\ncontains just 2 files:  wallet.dat and database/log.0000000001\n\nIf you extract it, the wallet loads.\nIf you blow it away, extract it again, and \"rm .bitcoin/database/log.0000000001\", it doesn't load.\nIf you blow it away, extract again, run bitcoin and quit, the log.001 has gone, but log.002 has appeared, which also breaks things if you delete it after closing bitcoin.\n\nIt's as if there's something in the logfiles that makes the wallet work.  Deleting them willy-nilly seems kind of dangerous.\n",
      "created_at" : "2011-11-20T07:05:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2802789",
      "id" : 2802789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDI3ODk=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2802789/reactions"
      },
      "updated_at" : "2011-11-20T07:05:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2802789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "OK... Plan E : Leave the log file alone.\n\nThat means encrypting your wallet gets you a good wallet.dat file, but old private keys will hang around in the database/log.\\* file for a while, but will eventually be removed when you cleanly shutdown bitcoin.\n",
      "created_at" : "2011-11-20T16:08:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2804524",
      "id" : 2804524,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDQ1MjQ=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2804524/reactions"
      },
      "updated_at" : "2011-11-20T16:08:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2804524",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=4",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "What will be removed when you shutdown bitcoin?\n\nThe logfiles aren't removed when I shut down.  And I don't know if it's safe to assume the keys will be removed from the logfile either.\n",
      "created_at" : "2011-11-20T17:00:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2805020",
      "id" : 2805020,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDUwMjA=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2805020/reactions"
      },
      "updated_at" : "2011-11-20T17:00:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2805020",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "BDB closes the old logfile and opens a new one when it get close to 10megabytes big.\n\nWhen bitcoin shuts down cleanly, it asks BDB to remove any unused log files, and BDB will remove all but one file from database/log.*\n\nSo:  if you encrypt your wallet, unencrypted private keys will be in the old part of the log file.  But after running for a day or two, BDB will close that old log file and open a new one.  Then, the next time you restart bitcoin, the old log file containing the unencrypted keys is removed.\n\nThis seems like a reasonable compromise between security and safety for now; a better wallet encryption solution for the next version of bitcoin (one that doesn't require shutting down and restarting after encrypting the wallet) is a good idea, but out of scope for this release.\n",
      "created_at" : "2011-11-20T17:31:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2805818",
      "id" : 2805818,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDU4MTg=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2805818/reactions"
      },
      "updated_at" : "2011-11-20T17:31:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2805818",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=4",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "OK.  Thanks for explaining that.\n",
      "created_at" : "2011-11-20T17:37:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2805900",
      "id" : 2805900,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDU5MDA=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2805900/reactions"
      },
      "updated_at" : "2011-11-20T17:37:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2805900",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks very much for helping test!   rc7 binaries are available now.\n",
      "created_at" : "2011-11-20T20:47:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2808256",
      "id" : 2808256,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDgyNTY=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2808256/reactions"
      },
      "updated_at" : "2011-11-20T20:47:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2808256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=4",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "node_id" : "MDQ6VXNlcjMzMTk5Nw==",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "For the fun of it I just tested sipa's 'resilver' change.  It fixes this whole issue.  So I think you can go back to deleting the logfiles.\n\nTo be clear, git revision f47dfa5a works for me.\n",
      "created_at" : "2011-11-21T01:43:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-2809960",
      "id" : 2809960,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDI4MDk5NjA=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2809960/reactions"
      },
      "updated_at" : "2011-11-21T01:43:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2809960",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "So this issue can be closed?\n",
      "created_at" : "2012-02-19T17:40:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/644#issuecomment-4043592",
      "id" : 4043592,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/644",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNDM1OTI=",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4043592/reactions"
      },
      "updated_at" : "2012-02-19T17:40:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4043592",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
