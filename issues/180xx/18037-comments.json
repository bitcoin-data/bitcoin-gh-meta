[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Some relevant info about the analysis of the cost (maintenance burden) vs benefit (supporting a better tested & simpler codebase) of these changes \r\n\r\n**pros:**\r\n- these changes add a function to the scheduler with unit test coverage\r\n- the function would only be used when running regtest\r\n- intent is for this to support easier functional testing for other features \r\n- currently, two explicit use cases \r\n\r\n**cons:**\r\n- all code adds maintenance burden \r\n- c++ code specifically to support testing should only be added when necessary \r\n- the scheduler mock is not required for functionally testing the current use cases. workarounds are possible \r\n\r\nexplanation of the two use cases & workarounds.\r\n1. #18038 uses the mock to trigger the next attempt at initial broadcast, which is scheduled for every 10 minutes. Alternatively, the `REATTEMPT_BROADCAST_INTERVAL` constant that indicates scheduler frequency could be defined as a chain param and made more frequent for regtest (thanks @MarcoFalke for the suggestion).\r\n2. In PR #16698, specifically commit baf7de22108eb9081ddc700067b72409efbc382e, the mock would allow deleting some of the c++ code (but still be testable.) In the patch right now, the scheduler periodically calls `MaybeResendWalletTxs` which calls `ResubmitWalletTransactionsToMempool` which uses `nNextResend` to track time. `nNextResend` implements a mockable time so can be tested from the functional tests. If the scheduler mock is supported, the scheduler could directly invoke the resubmit function & drop the member var to maintain time tracking. ",
      "created_at" : "2020-01-31T05:52:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-580593078",
      "id" : 580593078,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDU5MzA3OA==",
      "updated_at" : "2020-01-31T05:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580593078",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK 58c4c19.\r\n\r\nThis seems like a generally useful test harness, and the code looks basically correct to me. I think the pointer to the scheduler is a little crass, but it isn't a bad option considering the scheduler is created as a static in init.cpp (someone can clean it up later if they make the schedule a non static).\r\n\r\nThe time delta technically could underflow, but I don't think that's the base time being subtracted from is a time point (and we're far from the unix epoch time). If this weren't just testing harness, it might be worth it to check for underflow, but since we'd basically be having to actively try to shoot ourselves in the foot during a test to get an underflow this usage is fine. \r\n\r\nGreat work!",
      "created_at" : "2020-01-31T06:09:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-580596981",
      "id" : 580596981,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDU5Njk4MQ==",
      "updated_at" : "2020-01-31T06:09:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580596981",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. \r\n\r\nLooks like there's an issue with the new `mockforward` unit test, as most of the [Travis instances](https://travis-ci.org/bitcoin/bitcoin/builds/644207906) are failing:\r\n```bash\r\ntest/scheduler_tests.cpp(158): Entering test case \"mockforward\"\r\ntest/scheduler_tests.cpp(188): error: in \"scheduler_tests/mockforward\": check num_tasks == 1 has failed [3 != 1]\r\ntest/scheduler_tests.cpp(191): error: in \"scheduler_tests/mockforward\": check counter == 2 has failed [0 != 2]\r\ntest/scheduler_tests.cpp(197): error: in \"scheduler_tests/mockforward\": check delta > 2*60 && delta < 3*60 has failed\r\ntest/scheduler_tests.cpp(158): Leaving test case \"mockforward\"; testing time: 6321us\r\ntest/scheduler_tests.cpp(13): Leaving test suite \"scheduler_tests\"; testing time: 146946us\r\n```",
      "created_at" : "2020-01-31T06:24:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-580600650",
      "id" : 580600650,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDYwMDY1MA==",
      "updated_at" : "2020-01-31T06:24:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580600650",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18038 (P2P: Mempool tracks locally submitted transactions to improve privacy by amitiuttarwar)\n* #17997 (refactor: Remove mempool global from net by MarcoFalke)\n* #17037 (Testschains: Many regtests with different genesis and default datadir by jtimon)\n* #17032 (Tests: Chainparams: Make regtest almost fully customizable by jtimon)\n* #16770 (Chainparams: Rename IsTestChain() to AllowAcceptNonstd() by jtimon)\n* #16365 (Log RPC parameters (arguments) if -debug=rpcparams by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-01-31T08:40:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-580639273",
      "id" : 580639273,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDYzOTI3Mw==",
      "updated_at" : "2020-02-12T23:22:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580639273",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No objection, but some observations:\r\n\r\n* In light of the test failures on some platforms, we obviously need to make sure this is doing the right thing. Timestamp handling isn't obviously trivial especially in combination with condition variables. See also the numerous scheduler crashed that no one can explain: #16307, #16027, #14200, ...\r\n\r\n* \"Mocking\" code so that tests run the mocked code and production runs a different code might defeat the whole point of having the tests in the first place. Tests (especially functional tests) are supposed to test the production code (paths) as closely as possible.\r\n\r\nSo my personal preference would be to go with some minimally invasive and simple approach like the chainparam. But if everyone else likes this mock approach because it could be used for other testing needs as well, then I won't object having this merged.",
      "created_at" : "2020-01-31T09:12:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-580650220",
      "id" : 580650220,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDY1MDIyMA==",
      "updated_at" : "2020-01-31T09:13:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580650220",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373789747"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373789747"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: \"mockscheduler **is** for regression testing (-regtest mode) only\"?",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-01T16:56:00Z",
      "diff_hunk" : "@@ -366,6 +369,27 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",\n+            \"\\nBump the scheduler into the future (-regtest only)\\n\",\n+            {\n+                {\"delta_time\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of seconds to forward the scheduler into the future.\" },\n+            },\n+            RPCResults{},\n+            RPCExamples{\"\"},\n+        }.Check(request);\n+\n+    if (!Params().MineBlocksOnDemand())\n+        throw std::runtime_error(\"mockscheduler for regression testing (-regtest mode) only\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373789747",
      "id" : 373789747,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc4OTc0Nw==",
      "original_commit_id" : "58c4c1943e082060f38054ed4738478635ab9c31",
      "original_position" : 35,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 351893286,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373789747",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373886512"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373886512"
         }
      },
      "author_association" : "MEMBER",
      "body" : "5c9d5bed7205161d6870d199d223af37efe66179\r\n\r\nnit, space before `{`.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-02T23:56:43Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue){",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373886512",
      "id" : 373886512,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4NjUxMg==",
      "original_commit_id" : "5c9d5bed7205161d6870d199d223af37efe66179",
      "original_position" : 12,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 351978107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373886512",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373886976"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373886976"
         }
      },
      "author_association" : "MEMBER",
      "body" : "58c4c1943e082060f38054ed4738478635ab9c31\r\n\r\nnit, keep sorted.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-03T00:04:13Z",
      "diff_hunk" : "@@ -11,6 +11,7 @@\n class BanMan;\n class CConnman;\n class CTxMemPool;\n+class CScheduler;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373886976",
      "id" : 373886976,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4Njk3Ng==",
      "original_commit_id" : "58c4c1943e082060f38054ed4738478635ab9c31",
      "original_position" : 4,
      "path" : "src/node/context.h",
      "position" : 4,
      "pull_request_review_id" : 351978107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373886976",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373887012"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373887012"
         }
      },
      "author_association" : "MEMBER",
      "body" : "58c4c1943e082060f38054ed4738478635ab9c31\r\n\r\nnit, keep sorted.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-03T00:05:01Z",
      "diff_hunk" : "@@ -5,15 +5,18 @@\n \n #include <httpserver.h>\n #include <key_io.h>\n+#include <node/context.h>\n #include <outputtype.h>\n #include <rpc/blockchain.h>\n #include <rpc/server.h>\n #include <rpc/util.h>\n #include <script/descriptor.h>\n+#include <scheduler.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373887012",
      "id" : 373887012,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4NzAxMg==",
      "original_commit_id" : "58c4c1943e082060f38054ed4738478635ab9c31",
      "original_position" : 10,
      "path" : "src/rpc/misc.cpp",
      "position" : 9,
      "pull_request_review_id" : 351978107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373887012",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373887202"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373887202"
         }
      },
      "author_association" : "MEMBER",
      "body" : "58c4c1943e082060f38054ed4738478635ab9c31\r\n\r\nWhy is this included?",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-03T00:08:00Z",
      "diff_hunk" : "@@ -5,15 +5,18 @@\n \n #include <httpserver.h>\n #include <key_io.h>\n+#include <node/context.h>\n #include <outputtype.h>\n #include <rpc/blockchain.h>\n #include <rpc/server.h>\n #include <rpc/util.h>\n #include <script/descriptor.h>\n+#include <scheduler.h>\n #include <util/check.h>\n #include <util/strencodings.h>\n #include <util/system.h>\n #include <util/validation.h>\n+#include <init.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373887202",
      "id" : 373887202,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4NzIwMg==",
      "original_commit_id" : "58c4c1943e082060f38054ed4738478635ab9c31",
      "original_position" : 15,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 351978107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373887202",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373887397"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373887397"
         }
      },
      "author_association" : "MEMBER",
      "body" : "58c4c1943e082060f38054ed4738478635ab9c31\r\n\r\nMaybe check `delta_time > 0`?",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-03T00:11:00Z",
      "diff_hunk" : "@@ -366,6 +369,27 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",\n+            \"\\nBump the scheduler into the future (-regtest only)\\n\",\n+            {\n+                {\"delta_time\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of seconds to forward the scheduler into the future.\" },\n+            },\n+            RPCResults{},\n+            RPCExamples{\"\"},\n+        }.Check(request);\n+\n+    if (!Params().MineBlocksOnDemand())\n+        throw std::runtime_error(\"mockscheduler for regression testing (-regtest mode) only\");\n+\n+    RPCTypeCheck(request.params, {UniValue::VNUM});\n+\n+    g_rpc_node->scheduler->MockForward(boost::chrono::seconds(request.params[0].get_int64()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373887397",
      "id" : 373887397,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4NzM5Nw==",
      "original_commit_id" : "58c4c1943e082060f38054ed4738478635ab9c31",
      "original_position" : 39,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 351978107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373887397",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373887966"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373887966"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ca57312e5b0dc9d28766369b963395f1690e0b4f\r\n\r\nMaybe change this to:\r\n```cpp\r\nscheduler.scheduleFromNow([&]{ scheduler.stop(false); }, 1);\r\n```\r\nand remove the sleep above.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-03T00:19:02Z",
      "diff_hunk" : "@@ -155,4 +155,46 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // finish up\n+    MicroSleep(600);\n+    scheduler.stop(false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r373887966",
      "id" : 373887966,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4Nzk2Ng==",
      "original_commit_id" : "ca57312e5b0dc9d28766369b963395f1690e0b4f",
      "original_position" : 29,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 351979716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373887966",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375038347"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375038347"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "good catch. was left over from a previous iteration ",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-05T03:05:08Z",
      "diff_hunk" : "@@ -5,15 +5,18 @@\n \n #include <httpserver.h>\n #include <key_io.h>\n+#include <node/context.h>\n #include <outputtype.h>\n #include <rpc/blockchain.h>\n #include <rpc/server.h>\n #include <rpc/util.h>\n #include <script/descriptor.h>\n+#include <scheduler.h>\n #include <util/check.h>\n #include <util/strencodings.h>\n #include <util/system.h>\n #include <util/validation.h>\n+#include <init.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375038347",
      "id" : 375038347,
      "in_reply_to_id" : 373887202,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTAzODM0Nw==",
      "original_commit_id" : "58c4c1943e082060f38054ed4738478635ab9c31",
      "original_position" : 15,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 353441995,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375038347",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375039093"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375039093"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "clever. thank you! \r\n\r\nlets see if travis likes it ð¤ð½",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-05T03:09:03Z",
      "diff_hunk" : "@@ -155,4 +155,46 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // finish up\n+    MicroSleep(600);\n+    scheduler.stop(false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375039093",
      "id" : 375039093,
      "in_reply_to_id" : 373887966,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTAzOTA5Mw==",
      "original_commit_id" : "ca57312e5b0dc9d28766369b963395f1690e0b4f",
      "original_position" : 29,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 353442886,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375039093",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375068638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375068638"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yay! looking good. only travis failure seemed unrelated.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-05T05:43:39Z",
      "diff_hunk" : "@@ -155,4 +155,46 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // finish up\n+    MicroSleep(600);\n+    scheduler.stop(false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375068638",
      "id" : 375068638,
      "in_reply_to_id" : 373887966,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA2ODYzOA==",
      "original_commit_id" : "ca57312e5b0dc9d28766369b963395f1690e0b4f",
      "original_position" : 29,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 353477476,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375068638",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I addressed review comments & tests are now passing CI. Added checks in RPC function & scheduler function to ensure reasonable values / no underflow.\r\n\r\nThis PR has received 3 ACKs - utACK from @JeremyRubin & concept ACKs from @promag @fanquake. Would appreciate re-review ðð½",
      "created_at" : "2020-02-05T17:00:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-582507502",
      "id" : 582507502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MjUwNzUwMg==",
      "updated_at" : "2020-02-05T17:00:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582507502",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re-utACK ecb0ad5",
      "created_at" : "2020-02-05T18:39:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-582551040",
      "id" : 582551040,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MjU1MTA0MA==",
      "updated_at" : "2020-02-05T18:39:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582551040",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375441938"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375441938"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Follow up, would be cool to skip this when !regtest and in `mockscheduler` would be `assert(Params().MineBlocksOnDemand())`.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-05T18:51:16Z",
      "diff_hunk" : "@@ -570,6 +600,7 @@ static const CRPCCommand commands[] =\n \n     /* Not shown in help */\n     { \"hidden\",             \"setmocktime\",            &setmocktime,            {\"timestamp\"}},\n+    { \"hidden\",             \"mockscheduler\",          &mockscheduler,          {\"delta_time\"}},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375441938",
      "id" : 375441938,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ0MTkzOA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 52,
      "path" : "src/rpc/misc.cpp",
      "position" : 54,
      "pull_request_review_id" : 353957117,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375441938",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375582987"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375582987"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What's the problem of doing\r\n```cpp\r\ntemp_queue.emplace_hint(temp_queue.cend(), element.first - delta_seconds, element.second);\r\n```\r\nLooks fine to me since `wait_until` returns when system time is later than that absolute time.\r\n\r\nDidn't check the case for boost < 1.50.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T00:26:10Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375582987",
      "id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4Mjk4Nw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354133285,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375582987",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375584231"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375584231"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, you can drop `()`.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T00:30:53Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375584231",
      "id" : 375584231,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NDIzMQ==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 9,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 354133285,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375584231",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375584339"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375584339"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, just capture `&scheduler`.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T00:31:17Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // ensure scheduler has chance to process all tasks queued for before 1 ms from now.\n+    scheduler.scheduleFromNow([&]{ scheduler.stop(false); }, 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375584339",
      "id" : 375584339,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NDMzOQ==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 354133285,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375584339",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375588886"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375588886"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm curious- is this for style or is there a difference in behavior? \r\nfrom what I can tell the behavior should be the same?\r\ndocs: \"& (implicitly capture the used automatic variables by reference)\" \r\ncompiler explorer: https://godbolt.org/z/QfeAVF",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T00:48:41Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // ensure scheduler has chance to process all tasks queued for before 1 ms from now.\n+    scheduler.scheduleFromNow([&]{ scheduler.stop(false); }, 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375588886",
      "id" : 375588886,
      "in_reply_to_id" : 375584339,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4ODg4Ng==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 354140279,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375588886",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375609579"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375609579"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it's reasonable for @amitiuttarwar to just copy exactly what setmocktime is doing in this regard.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T02:14:37Z",
      "diff_hunk" : "@@ -570,6 +600,7 @@ static const CRPCCommand commands[] =\n \n     /* Not shown in help */\n     { \"hidden\",             \"setmocktime\",            &setmocktime,            {\"timestamp\"}},\n+    { \"hidden\",             \"mockscheduler\",          &mockscheduler,          {\"delta_time\"}},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375609579",
      "id" : 375609579,
      "in_reply_to_id" : 375441938,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTYwOTU3OQ==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 52,
      "path" : "src/rpc/misc.cpp",
      "position" : 54,
      "pull_request_review_id" : 354164429,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375609579",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375609928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375609928"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this is a style preference (plus it's in tests) so it's whatever.\r\n\r\nFor whatever reason, I prefer this form when it's a function that should be called multiple times (as dummy is) and the no () form when it's more akin to a std::bind for a call-once thing.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T02:16:25Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375609928",
      "id" : 375609928,
      "in_reply_to_id" : 375584231,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTYwOTkyOA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 9,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 354164429,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375609928",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375611313"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375611313"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think & is perfectly clear, it's just for style.\r\n\r\nI agree in principle if a lambda is multiple lines and has arguments it's usually better to explicitly capture, but I think implicit capture is totally reasonable here.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T02:23:26Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // ensure scheduler has chance to process all tasks queued for before 1 ms from now.\n+    scheduler.scheduleFromNow([&]{ scheduler.stop(false); }, 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375611313",
      "id" : 375611313,
      "in_reply_to_id" : 375584339,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTYxMTMxMw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 354164429,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375611313",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375611897"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375611897"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "element.first - delta_seconds may underflow, so std::max prevents underflow.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T02:26:09Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375611897",
      "id" : 375611897,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTYxMTg5Nw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354167207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375611897",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@promag I think it's reasonable that the mockscheduler RPC doesn't have coverage presently -- @amitiuttarwar has a larger project that this testing harness was extracted from as a reviewable chunk, a later PR will be using it extensively to test rebroadcasting logic (see https://github.com/bitcoin/bitcoin/pull/18038). I think it's reasonable that the coverage in RPC tests lives there & there isn't a separate one just testing the testing rpc, but feel free to disagree.",
      "created_at" : "2020-02-06T02:32:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-582707742",
      "id" : 582707742,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MjcwNzc0Mg==",
      "updated_at" : "2020-02-06T02:32:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582707742",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375710783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375710783"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, should be same, however in L163 you already explicitly capture `&counter` so I though you would like to do the same here.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T09:03:10Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // ensure scheduler has chance to process all tasks queued for before 1 ms from now.\n+    scheduler.scheduleFromNow([&]{ scheduler.stop(false); }, 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r375710783",
      "id" : 375710783,
      "in_reply_to_id" : 375584339,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTcxMDc4Mw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 354288066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/375710783",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376039723"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376039723"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Huh? `static const commands[]=` will get done prior to working out what chain is in use, so you'd have to do a much more serious rework to remove it from the list of rpcs entirely.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T19:35:38Z",
      "diff_hunk" : "@@ -570,6 +600,7 @@ static const CRPCCommand commands[] =\n \n     /* Not shown in help */\n     { \"hidden\",             \"setmocktime\",            &setmocktime,            {\"timestamp\"}},\n+    { \"hidden\",             \"mockscheduler\",          &mockscheduler,          {\"delta_time\"}},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376039723",
      "id" : 376039723,
      "in_reply_to_id" : 375441938,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjAzOTcyMw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 52,
      "path" : "src/rpc/misc.cpp",
      "position" : 54,
      "pull_request_review_id" : 354717228,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376039723",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "thanks for review @promag!\r\n\r\nRE testing mockscheduler RPC- as @JeremyRubin mentioned, my next PR uses it [here](https://github.com/bitcoin/bitcoin/pull/18038/files?file-filters%5B%5D=.py#diff-5e6f5e6aab04f82ec4b58148c4bdec72R68) , so the happy path will be tested. But if you prefer separate explicit test coverage, I can add. \r\n\r\nI'll incorporate style nits if I push & invalidate current ACKs ",
      "created_at" : "2020-02-06T20:15:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-583089349",
      "id" : 583089349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzA4OTM0OQ==",
      "updated_at" : "2020-02-06T20:15:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583089349",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376063957"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376063957"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Underflow how? You mean be less than current time?",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T20:27:25Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376063957",
      "id" : 376063957,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA2Mzk1Nw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354748619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376063957",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376065647"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376065647"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "if `element.first - delta_seconds < now` everything will process fine (as in the previous version you reviewed)\r\n\r\nbut if `delta_seconds > element.first` then there could be an underflow. seems highly unlikely because `element.first` is a time point, but doesn't hurt to have this guarantee",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T20:31:12Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376065647",
      "id" : 376065647,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA2NTY0Nw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354750872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376065647",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376116886"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376116886"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This looks equivalent to\r\n\r\n```\r\nstd::max(boost::chrono::system_clock::now(), element.first - delta_seconds);\r\n```\r\n\r\nAlso perhaps you only want to invoke `now()` once and cache it rather than querying it for every queue element.\r\n",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T22:26:00Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376116886",
      "id" : 376116886,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjExNjg4Ng==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354816585,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376116886",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376118523"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376118523"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I realize this is copied from `setmocktime`, but it feels very strange to use MineBlocksOnDemand to gate time mocking. Perhaps it's worth adding a separate chainparams property for time mocking, and then using it for both `setmocktime` and `mockscheduler`.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T22:30:15Z",
      "diff_hunk" : "@@ -366,6 +368,34 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",\n+            \"\\nBump the scheduler into the future (-regtest only)\\n\",\n+            {\n+                {\"delta_time\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of seconds to forward the scheduler into the future.\" },\n+            },\n+            RPCResults{},\n+            RPCExamples{\"\"},\n+        }.Check(request);\n+\n+    if (!Params().MineBlocksOnDemand()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376118523",
      "id" : 376118523,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjExODUyMw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 354816585,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376118523",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376119076"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376119076"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's a hidden RPC so I don't think this matters much.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T22:31:35Z",
      "diff_hunk" : "@@ -570,6 +600,7 @@ static const CRPCCommand commands[] =\n \n     /* Not shown in help */\n     { \"hidden\",             \"setmocktime\",            &setmocktime,            {\"timestamp\"}},\n+    { \"hidden\",             \"mockscheduler\",          &mockscheduler,          {\"delta_time\"}},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376119076",
      "id" : 376119076,
      "in_reply_to_id" : 375441938,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjExOTA3Ng==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 52,
      "path" : "src/rpc/misc.cpp",
      "position" : 54,
      "pull_request_review_id" : 354816585,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376119076",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376125408"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376125408"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@ajtowns I was thinking that `CRPCTable::execute` could take into account some `CRPCCommand` flag and then it would result in `RPC_METHOD_NOT_FOUND`.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T22:48:12Z",
      "diff_hunk" : "@@ -570,6 +600,7 @@ static const CRPCCommand commands[] =\n \n     /* Not shown in help */\n     { \"hidden\",             \"setmocktime\",            &setmocktime,            {\"timestamp\"}},\n+    { \"hidden\",             \"mockscheduler\",          &mockscheduler,          {\"delta_time\"}},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376125408",
      "id" : 376125408,
      "in_reply_to_id" : 375441938,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEyNTQwOA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 52,
      "path" : "src/rpc/misc.cpp",
      "position" : 54,
      "pull_request_review_id" : 354827089,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376125408",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376134174"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376134174"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa that misses the point above. if delta_seconds > element.first, it underflows and then it can be greater than now().\r\n\r\nI guess equivalently, if delta_seconds is too large, now() + delta_seconds may overflow... but that seems less likely because we don't know if this system_clock::now() which feeds into the queue is set to start at time 0 on startup.\r\n\r\n\r\nNote also that caching now(), were emplace hint not used, would mean that the tmp queue would potentially be unstable ordered w.r.t. jobs with the same timeout.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T23:11:42Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376134174",
      "id" : 376134174,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEzNDE3NA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354837858,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376134174",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376139778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376139778"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> if delta_seconds > element.first, it underflows and then it can be greater than now().\r\n\r\nAccording to https://en.cppreference.com/w/cpp/chrono/duration, the representation type for the standard clock values is signed, so underflow should not be any issue (or at least not more than we need to worry about the clock overflowing in the first place).\r\n\r\n> Note also that caching now(), were emplace hint not used, would mean that the tmp queue would potentially be unstable ordered w.r.t. jobs with the same timeout.\r\n\r\nIf that's a concern, it already is. There is no guarantee that subsequent calls to `now()` will be strictly increasing.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-06T23:28:11Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376139778",
      "id" : 376139778,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEzOTc3OA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354844714,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376139778",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376168538"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376168538"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "RE: underflow / overflow- \r\nthe intent is to ensure `delta_seconds` is reasonable. I'm thinking of asserting the value is between 0 & 3600 from both this `MockForward` method & the `mockscheduler` rpc method. \r\nand reverting to the original `temp_queue.emplace_hint(temp_queue.cend(), element.first - delta_seconds, element.second)`\r\n",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T01:10:59Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376168538",
      "id" : 376168538,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE2ODUzOA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354878310,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376168538",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376169344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376169344"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah -- note that it's boost and not std... I think that the seconds duration is guaranteed to be signed 64, but I couldn't find anything on system_clock's duration. Good catch on the non steady adjustable clock of system_clock, I had missed that. Seems like a general thing that our scheduler should be on a monotonic hardware clock rather than something that adjusting the system date could adjust (which would be another way to do this patch -- just fast forward the system time). ",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T01:13:56Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376169344",
      "id" : 376169344,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE2OTM0NA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354879172,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376169344",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376175543"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376175543"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Even with a monotonic clock there is no guarantee that subsequent requests to `now()` are *strictly* increasing (they'll be *monotonically* increasing, but that's not enough to guarantee a stable sorting order absent hints).",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T01:40:01Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376175543",
      "id" : 376175543,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE3NTU0Mw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 354886491,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376175543",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376199329"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376199329"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa what would you think about just abstracting out a new function named `AllowMockableTime()` and having it call MineBlocksOnDemand  -- that way someone can clean up the logic later, I'm sure we're doing other weird things like this that could also be fixed.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T03:29:29Z",
      "diff_hunk" : "@@ -366,6 +368,34 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",\n+            \"\\nBump the scheduler into the future (-regtest only)\\n\",\n+            {\n+                {\"delta_time\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of seconds to forward the scheduler into the future.\" },\n+            },\n+            RPCResults{},\n+            RPCExamples{\"\"},\n+        }.Check(request);\n+\n+    if (!Params().MineBlocksOnDemand()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376199329",
      "id" : 376199329,
      "in_reply_to_id" : 376118523,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE5OTMyOQ==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 354913433,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376199329",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376199487"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376199487"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Or just making it the responsibility of follow up work, I don't think it's that bad (if someone reviewed using MineBlocksOnDemand for this once... it should still be fine now)",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T03:30:27Z",
      "diff_hunk" : "@@ -366,6 +368,34 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",\n+            \"\\nBump the scheduler into the future (-regtest only)\\n\",\n+            {\n+                {\"delta_time\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of seconds to forward the scheduler into the future.\" },\n+            },\n+            RPCResults{},\n+            RPCExamples{\"\"},\n+        }.Check(request);\n+\n+    if (!Params().MineBlocksOnDemand()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376199487",
      "id" : 376199487,
      "in_reply_to_id" : 376118523,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE5OTQ4Nw==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 354913648,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376199487",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376506598"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376506598"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "updated",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T17:12:55Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // ensure scheduler has chance to process all tasks queued for before 1 ms from now.\n+    scheduler.scheduleFromNow([&]{ scheduler.stop(false); }, 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376506598",
      "id" : 376506598,
      "in_reply_to_id" : 375584339,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwNjU5OA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 355307342,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376506598",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376506845"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376506845"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "updated",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T17:13:25Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter](){counter++;};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376506845",
      "id" : 376506845,
      "in_reply_to_id" : 375584231,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwNjg0NQ==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 9,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 355307648,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376506845",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376507928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376507928"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "reverted to original (`element.first - delta_seconds`), but added checks in `MockForward` and `mockscheduler` that `delta_seconds` is between 0 and 3600. \r\n\r\nwhich means we no longer invoke `now()` =P \r\n\r\nlmk if there are any further concerns",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T17:15:55Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376507928",
      "id" : 376507928,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwNzkyOA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 355309139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376507928",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376509388"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376509388"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I agree that using `MineBlocksOnDemand` felt weird. Added `m_is_mockable_chain` to chainparams & implemented for `mockscheduler`. If it looks okay I'll do a follow up PR to use that for `mocktime`. ",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T17:19:14Z",
      "diff_hunk" : "@@ -366,6 +368,34 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",\n+            \"\\nBump the scheduler into the future (-regtest only)\\n\",\n+            {\n+                {\"delta_time\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of seconds to forward the scheduler into the future.\" },\n+            },\n+            RPCResults{},\n+            RPCExamples{\"\"},\n+        }.Check(request);\n+\n+    if (!Params().MineBlocksOnDemand()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376509388",
      "id" : 376509388,
      "in_reply_to_id" : 376118523,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwOTM4OA==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 28,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 355311096,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376509388",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376510655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376510655"
         }
      },
      "author_association" : "MEMBER",
      "body" : "lgtm",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-07T17:22:06Z",
      "diff_hunk" : "@@ -114,6 +114,27 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    {\n+        boost::unique_lock<boost::mutex> lock(newTaskMutex);\n+\n+        // use temp_queue to maintain updated schedule\n+        std::multimap<boost::chrono::system_clock::time_point, Function> temp_queue;\n+\n+        for (const auto& element : taskQueue) {\n+            boost::chrono::system_clock::time_point new_time = std::max(boost::chrono::system_clock::now() + delta_seconds, element.first) - delta_seconds;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376510655",
      "id" : 376510655,
      "in_reply_to_id" : 375582987,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUxMDY1NQ==",
      "original_commit_id" : "ecb0ad52a0f0c31a2f08e081f7ab6dfb88de3490",
      "original_position" : 13,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 355312770,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376510655",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "changes: \r\n- `mockscheduler` rpc updated to use new `m_is_mockable_chain` chainparams property instead of `MineBlocksOnDemand`\r\n- added checks to `mockscheduler` and `MockForward` methods to ensure `delta_seconds` is within acceptable range \r\n\r\nother comments: \r\n-  considered adding functional test to test `mockscheduler` rpc, but testing the success case would require actually invoking something scheduled from the c++ code, making it look extremely similar to the PR that provides context for & builds on this one. [link to test](https://github.com/bitcoin/bitcoin/pull/18038/files?file-filters%5B%5D=.py#diff-5e6f5e6aab04f82ec4b58148c4bdec72R68). So I don't think it makes sense to test independently. \r\n\r\nSo I believe all existing review comments are addressed. \r\n\r\nThis PR is ready for review :) ",
      "created_at" : "2020-02-07T18:19:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-583538538",
      "id" : 583538538,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzUzODUzOA==",
      "updated_at" : "2020-02-07T18:19:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583538538",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "s390x travis build is failing with \"Disk space is too low!\" error. everything else is green \r\n\r\nappveyor `wallet_resendwallettransactions.py` failed, seems unlikely that its related but not impossible since `MaybeResendWalletTxs` is called by the scheduler. investigating.",
      "created_at" : "2020-02-07T19:01:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-583556148",
      "id" : 583556148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzU1NjE0OA==",
      "updated_at" : "2020-02-07T19:01:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583556148",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376818501"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376818501"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit 69468a93737ed9d4a38e04bdce20778ce8191810:\r\n\r\nCould add a comment why 3600? Also, why not use a named compile time constant like `boost::chrono::hours{1}`?",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-09T21:47:44Z",
      "diff_hunk" : "@@ -114,6 +114,28 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    assert(delta_seconds.count() > 0 && delta_seconds.count() < 3600);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376818501",
      "id" : 376818501,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgxODUwMQ==",
      "original_commit_id" : "69468a93737ed9d4a38e04bdce20778ce8191810",
      "original_position" : 6,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 355636114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376818501",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376818713"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376818713"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    /**\r\n     * Mock the scheduler to fast forward in time\r\n```\r\n\r\nThis is not limited to regtest. It can be called in unit tests as well, or in #17037 testchains.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-09T21:50:57Z",
      "diff_hunk" : "@@ -55,6 +55,11 @@ class CScheduler\n     // need more accurate scheduling, don't use this method.\n     void scheduleEvery(Function f, int64_t deltaMilliSeconds);\n \n+    // Regtest only- mock the scheduler to fast forward in time",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376818713",
      "id" : 376818713,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgxODcxMw==",
      "original_commit_id" : "69468a93737ed9d4a38e04bdce20778ce8191810",
      "original_position" : 4,
      "path" : "src/scheduler.h",
      "position" : null,
      "pull_request_review_id" : 355636114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376818713",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376820054"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376820054"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit 3679f096c2ef52fa8673e5cd4064154a1889fa12\r\n\r\nNo features of boost::thread are needed here, so you might as well use a plain std thread\r\n```suggestion\r\n    std::thread scheduler_thread([&]() { scheduler.serviceQueue(); });\r\n```",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-09T22:07:45Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter]{counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376820054",
      "id" : 376820054,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgyMDA1NA==",
      "original_commit_id" : "3679f096c2ef52fa8673e5cd4064154a1889fa12",
      "original_position" : 22,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 355636114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376820054",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376820081"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376820081"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit 3679f096c2ef52fa8673e5cd4064154a1889fa12:\r\n\r\n```suggestion\r\n    BOOST_CHECK_EQUAL(num_tasks, 1);\r\n```",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-09T22:08:05Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter]{counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // ensure scheduler has chance to process all tasks queued for before 1 ms from now.\n+    scheduler.scheduleFromNow([&scheduler]{ scheduler.stop(false); }, 1);\n+    scheduler_thread.join();\n+\n+    // check that the queue only has one job remaining\n+    num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376820081",
      "id" : 376820081,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgyMDA4MQ==",
      "original_commit_id" : "3679f096c2ef52fa8673e5cd4064154a1889fa12",
      "original_position" : 33,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 355636114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376820081",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376820487"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376820487"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In commit 3392d690cfb338e1a9a9d7347710c0744e4486d5:\r\n\r\nthis should be true, otherwise one has to change this in the source code when wanting to test on testnet. While there is an argument for test params to be as close to main params as possible, I think this does not apply to params that have been introduced for primarily testing purposes. (See also my `m_is_test_chain`, which turned out to be too general and people prefer a per-parameter toggle).\r\n\r\nSo I think this should be true to not hinder testing on testnet.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-09T22:13:42Z",
      "diff_hunk" : "@@ -231,7 +232,7 @@ class CTestNetParams : public CChainParams {\n         fDefaultConsistencyChecks = false;\n         fRequireStandard = false;\n         m_is_test_chain = true;\n-\n+        m_is_mockable_chain = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376820487",
      "id" : 376820487,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgyMDQ4Nw==",
      "original_commit_id" : "3392d690cfb338e1a9a9d7347710c0744e4486d5",
      "original_position" : 13,
      "path" : "src/chainparams.cpp",
      "position" : 13,
      "pull_request_review_id" : 355636114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376820487",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376820692"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376820692"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit cf04e02bbe14257a1513b029231cb6a21c9766ac:\r\n\r\n```suggestion\r\n    RPCHelpMan{\"mockscheduler\",\r\n```\r\n\r\nExcessive whitespace?",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-09T22:16:22Z",
      "diff_hunk" : "@@ -366,6 +368,32 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376820692",
      "id" : 376820692,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgyMDY5Mg==",
      "original_commit_id" : "cf04e02bbe14257a1513b029231cb6a21c9766ac",
      "original_position" : 19,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 355636114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376820692",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376821035"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376821035"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit cf04e02bbe14257a1513b029231cb6a21c9766ac:\r\n\r\nWould be nice to protect against null pointer dereference. See `EnsureMemPool`",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-09T22:20:50Z",
      "diff_hunk" : "@@ -366,6 +368,32 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",\n+            \"\\nBump the scheduler into the future (-regtest only)\\n\",\n+            {\n+                {\"delta_time\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of seconds to forward the scheduler into the future.\" },\n+            },\n+            RPCResults{},\n+            RPCExamples{\"\"},\n+        }.Check(request);\n+\n+    if (!Params().IsMockableChain()) {\n+        throw std::runtime_error(\"mockscheduler is for regression testing (-regtest mode) only\");\n+    }\n+\n+    RPCTypeCheck(request.params, {UniValue::VNUM});\n+    int64_t delta_seconds = request.params[0].get_int64();\n+    if ((delta_seconds <= 0) || (delta_seconds > 3600)) {\n+        throw std::runtime_error(\"delta_time must be between 0 and 3600 seconds (1 hr)\");\n+    }\n+\n+    g_rpc_node->scheduler->MockForward(boost::chrono::seconds(delta_seconds));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r376821035",
      "id" : 376821035,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjgyMTAzNQ==",
      "original_commit_id" : "cf04e02bbe14257a1513b029231cb6a21c9766ac",
      "original_position" : 38,
      "path" : "src/rpc/misc.cpp",
      "position" : 42,
      "pull_request_review_id" : 355636114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376821035",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377276023"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377276023"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The same should be done in `src/test/util/setup_common.cpp`, no?",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-10T19:42:12Z",
      "diff_hunk" : "@@ -1269,6 +1269,9 @@ bool AppInitMain(NodeContext& node)\n     CScheduler::Function serviceLoop = std::bind(&CScheduler::serviceQueue, &scheduler);\n     threadGroup.create_thread(std::bind(&TraceThread<CScheduler::Function>, \"scheduler\", serviceLoop));\n \n+    assert(!node.scheduler);\n+    node.scheduler = &scheduler;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377276023",
      "id" : 377276023,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI3NjAyMw==",
      "original_commit_id" : "cf04e02bbe14257a1513b029231cb6a21c9766ac",
      "original_position" : 5,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 356210817,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377276023",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377279190"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377279190"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yup. using `boost_check_equal` was causing a warning I didn't understand, but after pushing I realized I just need to cast to `size_t`.  ",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-10T19:48:28Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter]{counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // ensure scheduler has chance to process all tasks queued for before 1 ms from now.\n+    scheduler.scheduleFromNow([&scheduler]{ scheduler.stop(false); }, 1);\n+    scheduler_thread.join();\n+\n+    // check that the queue only has one job remaining\n+    num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377279190",
      "id" : 377279190,
      "in_reply_to_id" : 376820081,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI3OTE5MA==",
      "original_commit_id" : "3679f096c2ef52fa8673e5cd4064154a1889fa12",
      "original_position" : 33,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 356214896,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377279190",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377284187"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377284187"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "hmmm, well if we want `m_is_mockable_chain` to be true on testnet, wouldn't it be better not to introduce the param and use the `m_is_test_chain` instead? ",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-10T19:58:14Z",
      "diff_hunk" : "@@ -231,7 +232,7 @@ class CTestNetParams : public CChainParams {\n         fDefaultConsistencyChecks = false;\n         fRequireStandard = false;\n         m_is_test_chain = true;\n-\n+        m_is_mockable_chain = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377284187",
      "id" : 377284187,
      "in_reply_to_id" : 376820487,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI4NDE4Nw==",
      "original_commit_id" : "3392d690cfb338e1a9a9d7347710c0744e4486d5",
      "original_position" : 13,
      "path" : "src/chainparams.cpp",
      "position" : 13,
      "pull_request_review_id" : 356221146,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377284187",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377286728"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377286728"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Although, conceptually, I don't know if I'm convinced. Mocking time seems useful for increasing automated test coverage, but running the node on testnet simulating closer to mainnet makes sense. But I feel pretty indifferent since even if time is allowed to be mocked on testnet, a user doesn't have to invoke it. And there's no concern around attack because its testnet. Mostly just trying to move the PR forward. ",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-10T20:03:37Z",
      "diff_hunk" : "@@ -231,7 +232,7 @@ class CTestNetParams : public CChainParams {\n         fDefaultConsistencyChecks = false;\n         fRequireStandard = false;\n         m_is_test_chain = true;\n-\n+        m_is_mockable_chain = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377286728",
      "id" : 377286728,
      "in_reply_to_id" : 376820487,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI4NjcyOA==",
      "original_commit_id" : "3392d690cfb338e1a9a9d7347710c0744e4486d5",
      "original_position" : 13,
      "path" : "src/chainparams.cpp",
      "position" : 13,
      "pull_request_review_id" : 356224552,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377286728",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377292698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377292698"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "hmm, I'm seeing the same amount of whitespace on the other `RPCHelpMan` calls in `rpc/misc` & `rpc/net` & `wallet/rpcwallet`. Are you seeing inconsistency? Is there something I'm missing? ",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-10T20:16:32Z",
      "diff_hunk" : "@@ -366,6 +368,32 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377292698",
      "id" : 377292698,
      "in_reply_to_id" : 376820692,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5MjY5OA==",
      "original_commit_id" : "cf04e02bbe14257a1513b029231cb6a21c9766ac",
      "original_position" : 19,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 356232453,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377292698",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377294176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377294176"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Feel free to ignore, this can be handled in the follow-up",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-10T20:19:28Z",
      "diff_hunk" : "@@ -231,7 +232,7 @@ class CTestNetParams : public CChainParams {\n         fDefaultConsistencyChecks = false;\n         fRequireStandard = false;\n         m_is_test_chain = true;\n-\n+        m_is_mockable_chain = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377294176",
      "id" : 377294176,
      "in_reply_to_id" : 376820487,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5NDE3Ng==",
      "original_commit_id" : "3392d690cfb338e1a9a9d7347710c0744e4486d5",
      "original_position" : 13,
      "path" : "src/chainparams.cpp",
      "position" : 13,
      "pull_request_review_id" : 356234134,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377294176",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377295887"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377295887"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Feel free to ignore this, but we haven't re-formatted them in b6fb617aaaad5f9cdd7f2ad2825b253ca792055d because they are still in flux.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-10T20:23:21Z",
      "diff_hunk" : "@@ -366,6 +368,32 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377295887",
      "id" : 377295887,
      "in_reply_to_id" : 376820692,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5NTg4Nw==",
      "original_commit_id" : "cf04e02bbe14257a1513b029231cb6a21c9766ac",
      "original_position" : 19,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 356236342,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377295887",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thank you for the review @MarcoFalke ! I addressed your concerns in a commit (with one open question), currently opened as a PR on my fork: https://github.com/amitiuttarwar/bitcoin/pull/2, will make as a follow up PR if this one gets accepted. \r\n\r\nTried to investigate the appveyor failure and cannot see how it could possibly be related to my changes. ",
      "created_at" : "2020-02-11T23:55:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-584925124",
      "id" : 584925124,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDkyNTEyNA==",
      "updated_at" : "2020-02-11T23:55:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584925124",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377969622"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377969622"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "addressed in follow up",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-11T23:55:32Z",
      "diff_hunk" : "@@ -1269,6 +1269,9 @@ bool AppInitMain(NodeContext& node)\n     CScheduler::Function serviceLoop = std::bind(&CScheduler::serviceQueue, &scheduler);\n     threadGroup.create_thread(std::bind(&TraceThread<CScheduler::Function>, \"scheduler\", serviceLoop));\n \n+    assert(!node.scheduler);\n+    node.scheduler = &scheduler;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377969622",
      "id" : 377969622,
      "in_reply_to_id" : 377276023,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk2OTYyMg==",
      "original_commit_id" : "cf04e02bbe14257a1513b029231cb6a21c9766ac",
      "original_position" : 5,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 357104851,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377969622",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377969706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377969706"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "addressed in follow up",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-11T23:55:39Z",
      "diff_hunk" : "@@ -366,6 +368,32 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",\n+            \"\\nBump the scheduler into the future (-regtest only)\\n\",\n+            {\n+                {\"delta_time\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of seconds to forward the scheduler into the future.\" },\n+            },\n+            RPCResults{},\n+            RPCExamples{\"\"},\n+        }.Check(request);\n+\n+    if (!Params().IsMockableChain()) {\n+        throw std::runtime_error(\"mockscheduler is for regression testing (-regtest mode) only\");\n+    }\n+\n+    RPCTypeCheck(request.params, {UniValue::VNUM});\n+    int64_t delta_seconds = request.params[0].get_int64();\n+    if ((delta_seconds <= 0) || (delta_seconds > 3600)) {\n+        throw std::runtime_error(\"delta_time must be between 0 and 3600 seconds (1 hr)\");\n+    }\n+\n+    g_rpc_node->scheduler->MockForward(boost::chrono::seconds(delta_seconds));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377969706",
      "id" : 377969706,
      "in_reply_to_id" : 376821035,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk2OTcwNg==",
      "original_commit_id" : "cf04e02bbe14257a1513b029231cb6a21c9766ac",
      "original_position" : 38,
      "path" : "src/rpc/misc.cpp",
      "position" : 42,
      "pull_request_review_id" : 357104884,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377969706",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377969811"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377969811"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "addressed in follow up",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-11T23:55:49Z",
      "diff_hunk" : "@@ -366,6 +368,32 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+static UniValue mockscheduler(const JSONRPCRequest& request)\n+{\n+        RPCHelpMan{\"mockscheduler\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377969811",
      "id" : 377969811,
      "in_reply_to_id" : 376820692,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk2OTgxMQ==",
      "original_commit_id" : "cf04e02bbe14257a1513b029231cb6a21c9766ac",
      "original_position" : 19,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 357104935,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377969811",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377969951"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377969951"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "addressed in follow up",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-11T23:56:01Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter]{counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n+\n+    // bump the scheduler forward 5 minutes\n+    scheduler.MockForward(boost::chrono::seconds(5*60));\n+\n+    // ensure scheduler has chance to process all tasks queued for before 1 ms from now.\n+    scheduler.scheduleFromNow([&scheduler]{ scheduler.stop(false); }, 1);\n+    scheduler_thread.join();\n+\n+    // check that the queue only has one job remaining\n+    num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377969951",
      "id" : 377969951,
      "in_reply_to_id" : 376820081,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk2OTk1MQ==",
      "original_commit_id" : "3679f096c2ef52fa8673e5cd4064154a1889fa12",
      "original_position" : 33,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 357105002,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377969951",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377970040"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377970040"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "addressed in follow up",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-11T23:56:08Z",
      "diff_hunk" : "@@ -155,4 +155,45 @@ BOOST_AUTO_TEST_CASE(singlethreadedscheduler_ordered)\n     BOOST_CHECK_EQUAL(counter2, 100);\n }\n \n+BOOST_AUTO_TEST_CASE(mockforward)\n+{\n+    CScheduler scheduler;\n+\n+    int counter{0};\n+    CScheduler::Function dummy = [&counter]{counter++;};\n+\n+    // schedule jobs for 2, 5 & 8 minutes into the future\n+    int64_t min_in_milli = 60*1000;\n+    scheduler.scheduleFromNow(dummy, 2*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 5*min_in_milli);\n+    scheduler.scheduleFromNow(dummy, 8*min_in_milli);\n+\n+    // check taskQueue\n+    boost::chrono::system_clock::time_point first, last;\n+    size_t num_tasks = scheduler.getQueueInfo(first, last);\n+    BOOST_CHECK(num_tasks == 3);\n+\n+    boost::thread scheduler_thread(std::bind(&CScheduler::serviceQueue, &scheduler));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377970040",
      "id" : 377970040,
      "in_reply_to_id" : 376820054,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk3MDA0MA==",
      "original_commit_id" : "3679f096c2ef52fa8673e5cd4064154a1889fa12",
      "original_position" : 22,
      "path" : "src/test/scheduler_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 357105054,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377970040",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377971402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377971402"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "addressed in follow up ",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-12T00:00:19Z",
      "diff_hunk" : "@@ -55,6 +55,11 @@ class CScheduler\n     // need more accurate scheduling, don't use this method.\n     void scheduleEvery(Function f, int64_t deltaMilliSeconds);\n \n+    // Regtest only- mock the scheduler to fast forward in time",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377971402",
      "id" : 377971402,
      "in_reply_to_id" : 376818713,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk3MTQwMg==",
      "original_commit_id" : "69468a93737ed9d4a38e04bdce20778ce8191810",
      "original_position" : 4,
      "path" : "src/scheduler.h",
      "position" : null,
      "pull_request_review_id" : 357106516,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377971402",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377971458"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377971458"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "addressed in follow up",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-12T00:00:30Z",
      "diff_hunk" : "@@ -114,6 +114,28 @@ void CScheduler::scheduleFromNow(CScheduler::Function f, int64_t deltaMilliSecon\n     schedule(f, boost::chrono::system_clock::now() + boost::chrono::milliseconds(deltaMilliSeconds));\n }\n \n+void CScheduler::MockForward(boost::chrono::seconds delta_seconds)\n+{\n+    assert(delta_seconds.count() > 0 && delta_seconds.count() < 3600);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377971458",
      "id" : 377971458,
      "in_reply_to_id" : 376818501,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk3MTQ1OA==",
      "original_commit_id" : "69468a93737ed9d4a38e04bdce20778ce8191810",
      "original_position" : 6,
      "path" : "src/scheduler.cpp",
      "position" : null,
      "pull_request_review_id" : 357106580,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377971458",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377971672"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377971672"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "not addressed, but noted as open question in the follow up https://github.com/amitiuttarwar/bitcoin/pull/2#issuecomment-584885826. going to resolve here.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-12T00:01:16Z",
      "diff_hunk" : "@@ -231,7 +232,7 @@ class CTestNetParams : public CChainParams {\n         fDefaultConsistencyChecks = false;\n         fRequireStandard = false;\n         m_is_test_chain = true;\n-\n+        m_is_mockable_chain = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r377971672",
      "id" : 377971672,
      "in_reply_to_id" : 376820487,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzk3MTY3Mg==",
      "original_commit_id" : "3392d690cfb338e1a9a9d7347710c0744e4486d5",
      "original_position" : 13,
      "path" : "src/chainparams.cpp",
      "position" : 13,
      "pull_request_review_id" : 357106831,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/377971672",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'd prefer to fixup the style fixes you want to make into the commits in this pull or not do them at all. Splitting them into a separate pull only causes noise in the git history and on GitHub.\r\n\r\nRationale is that we generally discourage style-only pull requests.",
      "created_at" : "2020-02-12T01:57:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-584979334",
      "id" : 584979334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDk3OTMzNA==",
      "updated_at" : "2020-02-12T14:02:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584979334",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "incorporated style updates & made `NodeContext.scheduler` a `unique_ptr` instead of raw pointer. \r\n\r\nupdate: Travis build failing on my new test. Working on debugging.",
      "created_at" : "2020-02-12T20:06:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-585393655",
      "id" : 585393655,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NTM5MzY1NQ==",
      "updated_at" : "2020-02-13T02:47:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/585393655",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Looks like travis fails with the boost exception \"invalid argument\" (https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-580650220)\r\n\r\n\r\n```\r\nRunning 3 test cases...\r\n\r\nTest cases order is shuffled using seed: 902768437\r\n\r\nEntering test module \"Bitcoin Core Test Suite\"\r\n\r\ntest/scheduler_tests.cpp(11): Entering test suite \"scheduler_tests\"\r\n\r\ntest/scheduler_tests.cpp(112): Entering test case \"singlethreadedscheduler_ordered\"\r\n\r\ntest/scheduler_tests.cpp(112): Leaving test case \"singlethreadedscheduler_ordered\"; testing time: 6488us\r\n\r\ntest/scheduler_tests.cpp(38): Entering test case \"manythreads\"\r\n\r\ntest/scheduler_tests.cpp(38): Leaving test case \"manythreads\"; testing time: 11938us\r\n\r\ntest/scheduler_tests.cpp(156): Entering test case \"mockforward\"\r\n\r\nterminate called after throwing an instance of 'boost::wrapexcept<boost::condition_error>'\r\n\r\n  what():  boost::condition_variable::do_wait_until failed in pthread_cond_timedwait: Invalid argument\r\n\r\nunknown location(0): fatal error: in \"scheduler_tests/mockforward\": signal: SIGABRT (application abort requested)\r\n\r\ntest/scheduler_tests.cpp(172): last checkpoint\r\n\r\ntest/scheduler_tests.cpp(156): Leaving test case \"mockforward\"; testing time: 455us\r\n\r\ntest/scheduler_tests.cpp(11): Leaving test suite \"scheduler_tests\"; testing time: 18977us\r\n\r\nLeaving test module \"Bitcoin Core Test Suite\"; testing time: 19091us\r\n\r\n*** 1 failure is detected in the test module \"Bitcoin Core Test Suite\"",
      "created_at" : "2020-02-13T14:12:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-585773643",
      "id" : 585773643,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NTc3MzY0Mw==",
      "updated_at" : "2020-02-13T14:12:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/585773643",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "yup :( I'm investigating. ",
      "created_at" : "2020-02-13T15:40:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-585821772",
      "id" : 585821772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NTgyMTc3Mg==",
      "updated_at" : "2020-02-13T15:40:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/585821772",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378972310"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378972310"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style-nit in commit 3f5cebe47b:\r\n\r\nUsing `/**` will make this a doxygen comment. I know that the other functions don't use doxygen comment, but for new code we should aim for that.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-13T16:28:03Z",
      "diff_hunk" : "@@ -55,6 +55,11 @@ class CScheduler\n     // need more accurate scheduling, don't use this method.\n     void scheduleEvery(Function f, int64_t deltaMilliSeconds);\n \n+    // Mock the scheduler to fast forward in time.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378972310",
      "id" : 378972310,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3MjMxMA==",
      "original_commit_id" : "db45f73ab93e207f792fb5bb11ca1ec2885d8a91",
      "original_position" : 4,
      "path" : "src/scheduler.h",
      "position" : null,
      "pull_request_review_id" : 358363413,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378972310",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378979325"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378979325"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style-nit in commit 047c1fd23ab7f281af7acd238f3bbb441817686c:\r\n\r\nAs you are changing this line anyway, might as well get rid of the std::bind mess\r\n\r\n\r\n```cpp\r\nCScheduler::Function serviceLoop = [&] { node.scheduler->serviceQueue(); };",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-13T16:39:18Z",
      "diff_hunk" : "@@ -1265,16 +1264,19 @@ bool AppInitMain(NodeContext& node)\n         }\n     }\n \n+    assert(!node.scheduler);\n+    node.scheduler = MakeUnique<CScheduler>();\n+\n     // Start the lightweight task scheduler thread\n-    CScheduler::Function serviceLoop = std::bind(&CScheduler::serviceQueue, &scheduler);\n+    CScheduler::Function serviceLoop = std::bind(&CScheduler::serviceQueue, node.scheduler.get());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378979325",
      "id" : 378979325,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3OTMyNQ==",
      "original_commit_id" : "db45f73ab93e207f792fb5bb11ca1ec2885d8a91",
      "original_position" : 17,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 358363413,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378979325",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378982074"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378982074"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style-nit in commit 047c1fd:\r\n\r\n\r\nIt should be safe and a bit cleaner to reset the scheduler unique_ptr at the end of `void Shutdown(NodeContext& node)`.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-13T16:43:11Z",
      "diff_hunk" : "@@ -157,7 +157,6 @@ NODISCARD static bool CreatePidFile()\n static std::unique_ptr<ECCVerifyHandle> globalVerifyHandle;\n \n static boost::thread_group threadGroup;\n-static CScheduler scheduler;\n \n void Interrupt(NodeContext& node)\n {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378982074",
      "id" : 378982074,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk4MjA3NA==",
      "original_commit_id" : "db45f73ab93e207f792fb5bb11ca1ec2885d8a91",
      "original_position" : 7,
      "path" : "src/init.cpp",
      "position" : 7,
      "pull_request_review_id" : 358363413,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378982074",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378983916"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378983916"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style-nit in commit 047c1fd23ab7f281af7acd238f3bbb441817686c:\r\n\r\n`g_rpc_node` might go away (#17548), and using `m_node` directly would be cleaner code anyway.",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-13T16:46:12Z",
      "diff_hunk" : "@@ -103,10 +103,12 @@ TestingSetup::TestingSetup(const std::string& chainName) : BasicTestingSetup(cha\n     g_rpc_node = &m_node;\n     RegisterAllCoreRPCCommands(tableRPC);\n \n+    g_rpc_node->scheduler = MakeUnique<CScheduler>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378983916",
      "id" : 378983916,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk4MzkxNg==",
      "original_commit_id" : "db45f73ab93e207f792fb5bb11ca1ec2885d8a91",
      "original_position" : 4,
      "path" : "src/test/util/setup_common.cpp",
      "position" : null,
      "pull_request_review_id" : 358363413,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378983916",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378985102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378985102"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style-nit in commit 047c1fd23ab7f281af7acd238f3bbb441817686c:\r\n\r\nSame here\r\n\r\n```suggestion\r\n    threadGroup.create_thread([&] { m_node.scheduler->serviceQueue(); });\r\n```\r\n",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-13T16:48:12Z",
      "diff_hunk" : "@@ -103,10 +103,12 @@ TestingSetup::TestingSetup(const std::string& chainName) : BasicTestingSetup(cha\n     g_rpc_node = &m_node;\n     RegisterAllCoreRPCCommands(tableRPC);\n \n+    g_rpc_node->scheduler = MakeUnique<CScheduler>();\n+\n     // We have to run a scheduler thread to prevent ActivateBestChain\n     // from blocking due to queue overrun.\n-    threadGroup.create_thread(std::bind(&CScheduler::serviceQueue, &scheduler));\n-    GetMainSignals().RegisterBackgroundSignalScheduler(scheduler);\n+    threadGroup.create_thread(std::bind(&CScheduler::serviceQueue, g_rpc_node->scheduler.get()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r378985102",
      "id" : 378985102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk4NTEwMg==",
      "original_commit_id" : "db45f73ab93e207f792fb5bb11ca1ec2885d8a91",
      "original_position" : 10,
      "path" : "src/test/util/setup_common.cpp",
      "position" : null,
      "pull_request_review_id" : 358363413,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/378985102",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r379969757"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/379969757"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also, the pointer should probably be reset in `~TestingSetup`",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-17T03:11:07Z",
      "diff_hunk" : "@@ -103,10 +103,12 @@ TestingSetup::TestingSetup(const std::string& chainName) : BasicTestingSetup(cha\n     g_rpc_node = &m_node;\n     RegisterAllCoreRPCCommands(tableRPC);\n \n+    g_rpc_node->scheduler = MakeUnique<CScheduler>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r379969757",
      "id" : 379969757,
      "in_reply_to_id" : 378983916,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTk2OTc1Nw==",
      "original_commit_id" : "db45f73ab93e207f792fb5bb11ca1ec2885d8a91",
      "original_position" : 4,
      "path" : "src/test/util/setup_common.cpp",
      "position" : null,
      "pull_request_review_id" : 359469048,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/379969757",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r380347417"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/380347417"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yeah totally. do you think the lack of reset could have somehow caused the failure [here](https://travis-ci.org/bitcoin/bitcoin/jobs/649620800)? I'll push shortly and observe, but still trying to fill in my conceptual understanding.\r\n\r\nnot directly related, but another thing I'm wondering is why the scheduler thread isn't interrupted [here](https://github.com/bitcoin/bitcoin/blob/master/src/init.cpp#L162)",
      "commit_id" : "832272895578711f0f52711dbce7d4da500d27e6",
      "created_at" : "2020-02-17T19:56:16Z",
      "diff_hunk" : "@@ -103,10 +103,12 @@ TestingSetup::TestingSetup(const std::string& chainName) : BasicTestingSetup(cha\n     g_rpc_node = &m_node;\n     RegisterAllCoreRPCCommands(tableRPC);\n \n+    g_rpc_node->scheduler = MakeUnique<CScheduler>();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#discussion_r380347417",
      "id" : 380347417,
      "in_reply_to_id" : 378983916,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDM0NzQxNw==",
      "original_commit_id" : "db45f73ab93e207f792fb5bb11ca1ec2885d8a91",
      "original_position" : 4,
      "path" : "src/test/util/setup_common.cpp",
      "position" : null,
      "pull_request_review_id" : 359942473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18037",
      "updated_at" : "2020-02-17T20:36:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/380347417",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1500952?v=4",
         "events_url" : "https://api.github.com/users/amitiuttarwar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/amitiuttarwar/followers",
         "following_url" : "https://api.github.com/users/amitiuttarwar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/amitiuttarwar",
         "id" : 1500952,
         "login" : "amitiuttarwar",
         "node_id" : "MDQ6VXNlcjE1MDA5NTI=",
         "organizations_url" : "https://api.github.com/users/amitiuttarwar/orgs",
         "received_events_url" : "https://api.github.com/users/amitiuttarwar/received_events",
         "repos_url" : "https://api.github.com/users/amitiuttarwar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/amitiuttarwar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/amitiuttarwar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 8bca30ea17cd4c1dacee28eaa27e5fa3493b021d, only change is some style fixups ð\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nACK 8bca30ea17cd4c1dacee28eaa27e5fa3493b021d, only change is some style fixups ð\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUjeVAv/YuSt6tTjGv6SeqSUSmrURxHQKmaO8WtGS57M8zxKiQLp2IlBrXaccECP\r\nktwXi7z+OxVlfaw/acuEoFZn5kIUjOC19D7tIegGh6qIWJxVYcT2cDghEG3JfTFD\r\nH+gDfpx6+JUjJcXybDwrc0jeOpva0aR6WOV/BBv+JuaOM0G2SXZPFS+DeUkSWGez\r\n8gMhSY4FE1sjGxtYSyhdtlHpROL1qX22joa8kdgVplJIuQJOmn8TGjI/4s4Xu6j7\r\n5Afa60Iqnbqb9paSMyEEi7XPhjOPKtLYWwB/K+itYjvbipaz4uw4yd5+YfMdYy45\r\nF/KSW9+7bYCSGE+ggEUQykrR60CYVPJay5WbwfDs0UdZhKmfyjlbx/iysTx63uKs\r\n4PKeLZoNCJynQA+nodf1vrXuA8nxJgfYdhDP8bWnUCMdcP84FKPdrG7r3v2x6fBt\r\nMeCCRSOXPNEAFtu59xnZw9mc+Dctx5EUyznhy5ybp/3QCUlM9DhxvTbx0H7sFzDo\r\nBTRQiIFP\r\n=2pAG\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `0370e988925c0bd1dc04b6ff2d771181e26d2b0eb3b28b69eb3c0a0976243393  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e8929401080370e988925c0bd1dc04b6ff2d771181e26d2b0eb3b28b69eb3c0a0976243393f01049574cb74c254b4cff2d1668f70cda6108fff01026c290b8151fb0781b6fc0cb81208ee708f1045e4b36fff0088fd6d203aa14532e0083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff0103be0ca71667e5d7ea20c51864f1c399f08f1045e4b36fff0086f80792bcdea6ad20083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6dfff01047d88e9bd9e0a63096af6fd0ba3e7d1a08f1045e4b36fff008a56702a3a200defa0083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6df010c2d3773832b121a1b02e763d79bdb94b08f1045e4b36fff0089da1ba29759a55190083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267)\r\n\r\n</details>\r\n",
      "created_at" : "2020-02-18T01:00:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-587225814",
      "id" : 587225814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NzIyNTgxNA==",
      "updated_at" : "2020-02-18T01:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/587225814",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This PR seems to have made bitcoinbuilds.org pretty unhappy:\r\n\r\n```\r\n  what():  boost::condition_variable::do_wait_until failed in pthread_cond_timedwait: Invalid argument\r\nunknown location(0): fatal error: in \"scheduler_tests/mockforward\": signal: SIGABRT (application abort requested)\r\ntest/scheduler_tests.cpp(172): last checkpoint\r\n```\r\nExample build:\r\nhttps://bitcoinbuilds.org/index.php?job=5c006a9e-b8e6-4932-a6a8-3ead3d1fc188\r\n\r\nAny ideas why we see a SIGABRT?\r\n\r\nI think it happens at `std::thread scheduler_thread([&]() { scheduler.serviceQueue(); });` in the scheduler tests.",
      "created_at" : "2020-02-19T17:39:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-588348216",
      "id" : 588348216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4ODM0ODIxNg==",
      "updated_at" : "2020-02-19T17:39:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/588348216",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jonasschnelli See #18174",
      "created_at" : "2020-02-19T18:02:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-588359944",
      "id" : 588359944,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4ODM1OTk0NA==",
      "updated_at" : "2020-02-19T18:15:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/588359944",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke: I guess you where trying to refer to #18174. Looking into that now...",
      "created_at" : "2020-02-19T18:05:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-588361380",
      "id" : 588361380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4ODM2MTM4MA==",
      "updated_at" : "2020-02-19T18:05:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/588361380",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Master (`Linux 64 depends tests`) fails when using ccache cache (seems to be reproducible 100%):\r\nhttps://bitcoinbuilds.org/index.php?job=c1d3a0f5-7d47-40e6-9c9b-cac397c5ff30\r\n\r\nMaster succeeds when clearing the ccache cache (but keeping the dependency cache):\r\nhttps://bitcoinbuilds.org/index.php?job=f28f0356-d431-4428-832b-49bc870042f5",
      "created_at" : "2020-02-19T18:26:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18037#issuecomment-588371299",
      "id" : 588371299,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18037",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4ODM3MTI5OQ==",
      "updated_at" : "2020-02-19T18:26:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/588371299",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
