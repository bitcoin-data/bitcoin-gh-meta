[
   {
      "author_association" : "MEMBER",
      "body" : "utACK 2667366 (based on https://github.com/bitcoin/bitcoin/pull/21365#issuecomment-846945215 review, plus the new functional test)",
      "created_at" : "2021-05-25T09:10:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#issuecomment-847696434",
      "id" : 847696434,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22051",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg0NzY5NjQzNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-25T09:10:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/847696434",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r642706287"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/642706287"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Are these `static` keywords here and one more below intentionally commented out?",
      "commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-05-31T23:41:43Z",
      "diff_hunk" : "@@ -370,3 +373,99 @@ CScript GetScriptForMultisig(int nRequired, const std::vector<CPubKey>& keys)\n bool IsValidDestination(const CTxDestination& dest) {\n     return dest.index() != 0;\n }\n+\n+/*static*/ TaprootBuilder::NodeInfo TaprootBuilder::Combine(NodeInfo&& a, NodeInfo&& b)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r642706287",
      "id" : 642706287,
      "line" : 377,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0MjcwNjI4Nw==",
      "original_commit_id" : "90fcac365e1616779b40a69736428435df75fdf2",
      "original_line" : 377,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/script/standard.cpp",
      "position" : 62,
      "pull_request_review_id" : 672568553,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-05-31T23:41:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/642706287",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r642711407"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/642711407"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, the `static` needs to be mentioned at declaration time (in the class in the .h) file, you can't repeat it at definition time. But putting it here in comments reminds the reader that it's actually a static member function.",
      "commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-06-01T00:11:11Z",
      "diff_hunk" : "@@ -370,3 +373,99 @@ CScript GetScriptForMultisig(int nRequired, const std::vector<CPubKey>& keys)\n bool IsValidDestination(const CTxDestination& dest) {\n     return dest.index() != 0;\n }\n+\n+/*static*/ TaprootBuilder::NodeInfo TaprootBuilder::Combine(NodeInfo&& a, NodeInfo&& b)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r642711407",
      "id" : 642711407,
      "in_reply_to_id" : 642706287,
      "line" : 377,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0MjcxMTQwNw==",
      "original_commit_id" : "90fcac365e1616779b40a69736428435df75fdf2",
      "original_line" : 377,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/script/standard.cpp",
      "position" : 62,
      "pull_request_review_id" : 672573530,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-01T00:11:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/642711407",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r643462050"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/643462050"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see, thanks! I had never seen this before.",
      "commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-06-01T20:37:08Z",
      "diff_hunk" : "@@ -370,3 +373,99 @@ CScript GetScriptForMultisig(int nRequired, const std::vector<CPubKey>& keys)\n bool IsValidDestination(const CTxDestination& dest) {\n     return dest.index() != 0;\n }\n+\n+/*static*/ TaprootBuilder::NodeInfo TaprootBuilder::Combine(NodeInfo&& a, NodeInfo&& b)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r643462050",
      "id" : 643462050,
      "in_reply_to_id" : 642706287,
      "line" : 377,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0MzQ2MjA1MA==",
      "original_commit_id" : "90fcac365e1616779b40a69736428435df75fdf2",
      "original_line" : 377,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/script/standard.cpp",
      "position" : 62,
      "pull_request_review_id" : 673557434,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-01T20:37:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/643462050",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code Review ACK 2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-06-02T21:01:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#issuecomment-853380102",
      "id" : 853380102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22051",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1MzM4MDEwMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-02T21:01:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/853380102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r645079290"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/645079290"
         }
      },
      "author_association" : "MEMBER",
      "body" : "C++'s dual use of the keyword `static` is kind of confusing, but not @sipa's fault of course. I think documenting that it's a static member function is useful here.",
      "commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-06-03T19:44:36Z",
      "diff_hunk" : "@@ -370,3 +373,99 @@ CScript GetScriptForMultisig(int nRequired, const std::vector<CPubKey>& keys)\n bool IsValidDestination(const CTxDestination& dest) {\n     return dest.index() != 0;\n }\n+\n+/*static*/ TaprootBuilder::NodeInfo TaprootBuilder::Combine(NodeInfo&& a, NodeInfo&& b)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r645079290",
      "id" : 645079290,
      "in_reply_to_id" : 642706287,
      "line" : 377,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NTA3OTI5MA==",
      "original_commit_id" : "90fcac365e1616779b40a69736428435df75fdf2",
      "original_line" : 377,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/script/standard.cpp",
      "position" : 62,
      "pull_request_review_id" : 675663415,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-03T19:44:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/645079290",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r646106907"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646106907"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: could add a comment that this is for `CNoDestination`.",
      "commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-06-06T09:55:24Z",
      "diff_hunk" : "@@ -638,6 +638,19 @@ class DescriptorImpl : public Descriptor\n     std::optional<OutputType> GetOutputType() const override { return std::nullopt; }\n };\n \n+static std::optional<OutputType> OutputTypeFromDestination(const CTxDestination& dest) {\n+    if (std::holds_alternative<PKHash>(dest) ||\n+        std::holds_alternative<ScriptHash>(dest)) {\n+        return OutputType::LEGACY;\n+    }\n+    if (std::holds_alternative<WitnessV0KeyHash>(dest) ||\n+        std::holds_alternative<WitnessV0ScriptHash>(dest) ||\n+        std::holds_alternative<WitnessUnknown>(dest)) {\n+        return OutputType::BECH32;\n+    }\n+    return std::nullopt;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r646106907",
      "id" : 646106907,
      "line" : 654,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NjEwNjkwNw==",
      "original_commit_id" : "41839bdb89b3777ece2318877b9c7921ecca2472",
      "original_line" : 651,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/script/descriptor.cpp",
      "position" : 44,
      "pull_request_review_id" : 676847870,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-06T20:31:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646106907",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r646109941"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646109941"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: param seems to be named `tap` everywhere else",
      "commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-06-06T10:21:20Z",
      "diff_hunk" : "@@ -3737,6 +3737,7 @@ class DescribeWalletAddressVisitor\n         return obj;\n     }\n \n+    UniValue operator()(const WitnessV1Taproot& id) const { return UniValue(UniValue::VOBJ); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r646109941",
      "id" : 646109941,
      "line" : 3740,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NjEwOTk0MQ==",
      "original_commit_id" : "a4bf84039c00b196b87f969acf6369d72c56ab46",
      "original_line" : 3740,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 676847870,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-06T20:31:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/646109941",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r647384770"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/647384770"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this can be replaced with `set(random.sample(KEYS, k=n))`",
      "commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-06-08T12:21:04Z",
      "diff_hunk" : "@@ -0,0 +1,272 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test generation and spending of P2TR addresses.\"\"\"\n+\n+import random\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.descriptors import descsum_create\n+from test_framework.script import (CScript, OP_CHECKSIG, taproot_construct)\n+from test_framework.segwit_addr import encode_segwit_address\n+\n+# xprvs/xpubs, and m/* derived x-only pubkeys (created using independent implementation)\n+KEYS = [\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPeNLUGrbv3b7qhUk1LQJZAGMuk9gVuKh9sd4BWGp1eMsehUni6qGb8bjkdwBxCbgNGdh2bYGACK5C5dRTaif9KBKGVnSezxV\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4XqNGAWGWSzmxGWFwVjVTjZxh2fioKbVYi7Jx8fdbprVWsdW7mHwqjchBVas8TLZG4Xwuz4RKU4iaCqiCvoSkFCzQptqk5Y1\",\n+        \"pubs\": [\n+            \"83d8ee77a0f3a32a5cea96fd1624d623b836c1e5d1ac2dcde46814b619320c18\",\n+            \"a30253b018ea6fca966135bf7dd8026915427f24ccf10d4e03f7870f4128569b\",\n+            \"a61e5749f2f3db9dc871d7b187e30bfd3297eea2557e9be99897ea8ff7a29a21\",\n+            \"8110cf482f66dc37125e619d73075af932521724ffc7108309e88f361efe8c8a\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPe98QUPieXy5KFPVjuZNpcC9JY7K7buJEm8nWvJogK4kTda7eLjK9U4PnMNbSjEkpjDJazeBZ4rhYNYD7N6GEdaysj1AYSb5\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4XcACN3PEwNjRpR1g4tZjBVk5pdMR2B6dbd3HYhdGVZNKofAiFZd9okBserZvv58A6tBX4pE64UpXGNTSesfUW7PpW36HuKz\",\n+        \"pubs\": [\n+            \"f95886b02a84928c5c15bdca32784993105f73de27fa6ad8c1a60389b999267c\",\n+            \"71522134160685eb779857033bfc84c7626f13556154653a51dd42619064e679\",\n+            \"48957b4158b2c5c3f4c000f51fd2cf0fd5ff8868ebfb194256f5e9131fc74bd8\",\n+            \"086dda8139b3a84944010648d2b674b70447be3ae59322c09a4907bc80be62c1\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPe3ZJmcj9aJ2EPZJYYCh6Lp3v82p75wspgaXmtDZ2RBtkAtWcGnW2VQDzMHQPBkCKMoYTqh1RfJKjv4PcmWVR7KqTpjsdboN\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4XWb6fGPjyhgLxapUhXszv7ehQYrQWDgDX4nYWcNcbgWcM2RhYo9s2mbZcfZJ8t5LzYcr24FK79zVybsw5Qj3Rtqug8jpJMy\",\n+        \"pubs\": [\n+            \"9fa5ffb68821cf559001caa0577eeea4978b29416def328a707b15e91701a2f7\",\n+            \"8a104c54cd34acba60c97dd8f1f7abc89ba9587afd88dc928e91aca7b1c50d20\",\n+            \"13ba6b252a4eb5ef31d39cb521724cdab19a698323f5c17093f28fb1821d052f\",\n+            \"f6c2b4863fd5ba1ba09e3a890caed8b75ffbe013ebab31a06ab87cd6f72506af\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPdKziibn63Rm6aNzp7dSjDnufZMStXr71Huz7iihCRpbZZZ6Voy5HyuHCWx6foHMipzMzUq4tZrtkZ24DJwz5EeNWdsuwX5h\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Wo2WcFSgSqRD9QWkGxddo6WSqsVBx7uQ8QEtM7WncKDRjhFEexK119NigyCsFygA4b7sAPQxqebyFGAZ9XVV1BtcgNzbCRR\",\n+        \"pubs\": [\n+            \"03a669ea926f381582ec4a000b9472ba8a17347f5fb159eddd4a07036a6718eb\",\n+            \"bbf56b14b119bccafb686adec2e3d2a6b51b1626213590c3afa815d1fd36f85d\",\n+            \"2994519e31bbc238a07d82f85c9832b831705d2ee4a2dbb477ecec8a3f570fe5\",\n+            \"68991b5c139a4c479f8c89d6254d288c533aefc0c5b91fac6c89019c4de64988\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPen4PGtDwURYnCtVMDejyE8vVwMGhQWfVqB2FBPdekhTacDW4vmsKTsgC1wsncVqXiZdX2YFGAnKoLXYf42M78fQJFzuDYFN\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4YF6BAXtXsqCtmv1HNyvsoSXHDsJzpnTtffH1onTEwC5SnLzCHPKPebh2i7Gxvi9kJNADcpuSmH8oM3rCYcHVtdXHjpYoKnX\",\n+        \"pubs\": [\n+            \"aba457d16a8d59151c387f24d1eb887efbe24644c1ee64b261282e7baebdb247\",\n+            \"c8558b7caf198e892032d91f1a48ee9bdc25462b83b4d0ac62bb7fb2a0df630e\",\n+            \"8a4bcaba0e970685858d133a4d0079c8b55bbc755599e212285691eb779ce3dc\",\n+            \"b0d68ada13e0d954b3921b88160d4453e9c151131c2b7c724e08f538a666ceb3\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPd91vCgRmbzA13wyip2RimYeVEkAyZvsEN5pUSB3T43SEBxPsytkxb42d64W2EiRE9CewpJQkzR8HKHLV8Uhk4dMF5yRPaTv\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Wc3i6L6N1Pp7cyVeyMcdLrFGXGDGzCfdCa5F4Zs3EY46N72Ws8QDEUYBVwXfDfda2UKSseSdU1fsBegJBhGCZyxkf28bkQ6\",\n+        \"pubs\": [\n+            \"9b4d495b74887815a1ff623c055c6eac6b6b2e07d2a016d6526ebac71dd99744\",\n+            \"8e971b781b7ce7ab742d80278f2dfe7dd330f3efd6d00047f4a2071f2e7553cb\",\n+            \"b811d66739b9f07435ccda907ec5cd225355321c35e0a7c7791232f24cf10632\",\n+            \"4cd27a5552c272bc80ba544e9cc6340bb906969f5e7a1510b6cef9592683fbc9\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPdEhLRxxwzTv2t18j7ruoffPeqAwVA2qXJ2P66RaMZLUWQ85SjoA7xPxdSgCB9UZ72m65qbnaLPtFTfHVP3MEmkpZk1Bv8RT\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Whj8KcdYPsa9T2efHC6iExzS7gynaJdv8WdripPwjq6NaH5gQJGrLmvUwHY1smhiakUosXNDTEa6qfKUQdLKV6DJBre6XvQ\",\n+        \"pubs\": [\n+            \"d0c19def28bb1b39451c1a814737615983967780d223b79969ba692182c6006b\",\n+            \"cb1d1b1dc62fec1894d4c3d9a1b6738e5ff9c273a64f74e9ab363095f45e9c47\",\n+            \"245be588f41acfaeb9481aa132717db56ee1e23eb289729fe2b8bde8f9a00830\",\n+            \"5bc4ad6d6187fa82728c85a073b428483295288f8aef5722e47305b5872f7169\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPcxbqxzcMAwQpiCD8x6qaZEJTxdKxw4w9GuMzDACTD9yhEsHGfqQcfYX4LivosLDDngTykYEp9JnTdcqY7cHqU8PpeFFKyV3\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4WRddreGwaM4wHDj57S2V8XuFF9NGMLjY7PckqZ23PebZR1wGA4w84uX2vZphdZVsnREjij1ibYjEBTaTVQCEZCLs4xUDapx\",\n+        \"pubs\": [\n+            \"065cc1b92bd99e5a3e626e8296a366b2d132688eb43aea19bc14fd8f43bf07fb\",\n+            \"5b95633a7dda34578b6985e6bfd85d83ec38b7ded892a9b74a3d899c85890562\",\n+            \"dc86d434b9a34495c8e845b969d51f80d19a8df03b400353ffe8036a0c22eb60\",\n+            \"06c8ffde238745b29ae8a97ae533e1f3edf214bba6ec58b5e7b9451d1d61ec19\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPe6zLoU8MTTXgsdJVNBErrYGpoGwHf5VGvwUzdNc7NHeCSzkJkniCxBhZWujXjmD4HZmBBrnr3URgJjM6GxRgMmEhLdqNTWG\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Xa28h7nwrsBoSepRXWRmRqsc5nyb5MHfmRjmFmRhYnG4d9dC7uxixN5AfsEv1Lz3mCAuWvERyvPgKozHUVjfo8EG6foJGy7\",\n+        \"pubs\": [\n+            \"d826a0a53abb6ffc60df25b9c152870578faef4b2eb5a09bdd672bbe32cdd79b\",\n+            \"939365e0359ff6bc6f6404ee220714c5d4a0d1e36838b9e2081ede217674e2ba\",\n+            \"4e8767edcf7d3d90258cfbbea01b784f4d2de813c4277b51279cf808bac410a2\",\n+            \"d42a2c280940bfc6ede971ae72cde2e1df96c6da7dab06a132900c6751ade208\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPeB5o5oCsN2dVxM2mtJiYERQEBRc4JNwC1DFGYaEdNkmh8jJYVPU76YhkFoRoWTdh1p3yQGykG8TfDW34dKgrgSx28gswUyL\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Xe7aySsTmSHcXNYi3duSoj11TweMiejaqhW3Ay4DZFPZJses4sfpk4b9VHRhn8v4cKTMjugMM3hqXcqSSmRdiW8QvASXjfY\",\n+        \"pubs\": [\n+            \"e360564b2e0e8d06681b6336a29d0750210e8f34afd9afb5e6fd5fe6dba26c81\",\n+            \"76b4900f00a1dcce463b6d8e02b768518fce4f9ecd6679a13ad78ea1e4815ad3\",\n+            \"5575556e263c8ed52e99ab02147cc05a738869afe0039911b5a60a780f4e43d2\",\n+            \"593b00e2c8d4bd6dda0fd9e238888acf427bb4e128887fd5a40e0e9da78cbc01\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPfEH6jHemkGDjZRnAaKFJVGH8pQU638E6SdbX9hxit1tK2sfFPfL6KS7v8FfUKxstbfEpzSymbdfBM9Y5UkrxErF9fJaKLK3\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4YhJtcwKN9fsr8TJ6jeSD4Zsv6vWPTQ2VH7rHn6nK4WWBCzKK7FkdVVwm3iztCU1UmStY4hX6gRbBmp9UzK9C59dQEzeXS12\",\n+        \"pubs\": [\n+            \"7631cacec3343052d87ef4d0065f61dde82d7d2db0c1cc02ef61ef3c982ea763\",\n+            \"c05e44a9e735d1b1bef62e2c0d886e6fb4923b2649b67828290f5cacc51c71b7\",\n+            \"b33198b20701afe933226c92fd0e3d51d3f266f1113d864dbd026ae3166ef7f2\",\n+            \"f99643ac3f4072ee4a949301e86963a9ca0ad57f2ef29f6b84fda037d7cac85b\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPdNWU38dT6aGxtqJR4oYS5kPpLVBcuKiiu7gqTYqMMqhUG6DP7pPahzPQu36sWSmeLCP1C4AwqcR5FX2RyRoZfd4B8pAnSdX\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4WqYFvnJ3Vyw5TrpME8jLf3zbd1DvKbX7jbwc5wewYLKLSFRzZWV6hZj7XhsXAy7fhE5jB25DiWyNM3ztXbsXHRVCrp5BiPY\",\n+        \"pubs\": [\n+            \"2258b1c3160be0864a541854eec9164a572f094f7562628281a8073bb89173a7\",\n+            \"83df59d0a5c951cdd62b7ab225a62079f48d2a333a86e66c35420d101446e92e\",\n+            \"2a654bf234d819055312f9ca03fad5836f9163b09cdd24d29678f694842b874a\",\n+            \"aa0334ab910047387c912a21ec0dab806a47ffa38365060dbc5d47c18c6e66e7\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8mGPkMVz5mZuJDnC2NjjAv7E9Zqa5LCgX4zawbZu5nzTtLb5kGhPwycX4H1gtW1f5ZdTKTNtQJ61hk71F2TdcQ93EFDTpUcPBr98QRji615\",\n+        \"xpub\": \"tpubDHxRtmYEE9FaBgoyv2QKaKmLibMWEfPb6NbNE7cCW4nripqrNfWz8UEPEPbHCrakwLvwFfsqoaf4pjX4gWStp4nECRf1QwBKPkLqnY8pHbj\",\n+        \"pubs\": [\n+            \"00a9da96087a72258f83b338ef7f0ea8cbbe05da5f18f091eb397d1ecbf7c3d3\",\n+            \"b2749b74d51a78f5fe3ebb3a7c0ff266a468cade143dfa265c57e325177edf00\",\n+            \"6b8747a6bbe4440d7386658476da51f6e49a220508a7ec77fe7bccc3e7baa916\",\n+            \"4674bf4d9ebbe01bf0aceaca2472f63198655ecf2df810f8d69b38421972318e\",\n+        ]\n+    }\n+]\n+\n+CHANGE_XPRV = \"tprv8ZgxMBicQKsPcyDrWwiecVnTtFmfRwbfFqEfR4ZGWvq5aTTwLBWmAm5zrbMcYtb9gQNFfhRfqhhrBG37U3nhmXxEgeEPBJGHAPrHCrAd1WX\"\n+CHANGE_XPUB = \"tpubD6NzVbkrYhZ4WSFeQbPF1uSaTHHbbGnZq8qShabZwCdUQwihxaLMMFhs2kidGF2qrRKiQVqw8VoyuTHj1bZqmMXMeciaU1gBjWA1sim2zUB\"\n+\n+# Point with no known discrete log.\n+H_POINT = \"50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\"\n+\n+\n+def key(hex_key):\n+    \"\"\"Construct an x-only pubkey from its hex representation.\"\"\"\n+    return bytes.fromhex(hex_key)\n+\n+def pk(hex_key):\n+    \"\"\"Construct a script expression for taproot_construct for pk(hex_key).\"\"\"\n+    return (None, CScript([bytes.fromhex(hex_key), OP_CHECKSIG]))\n+\n+def compute_taproot_address(pubkey, scripts):\n+    \"\"\"Compute the address for a taproot output with given inner key and scripts.\"\"\"\n+    tap = taproot_construct(pubkey, scripts)\n+    assert tap.scriptPubKey[0] == 0x51\n+    assert tap.scriptPubKey[1] == 0x20\n+    return encode_segwit_address(\"bcrt\", 1, tap.scriptPubKey[2:])\n+\n+class WalletTaprootTest(BitcoinTestFramework):\n+    \"\"\"Test generation and spending of P2TR address outputs.\"\"\"\n+\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+        self.extra_args = [['-keypool=100'], ['-keypool=100']]\n+        self.supports_cli = False\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def init_wallet(self, i):\n+        pass\n+\n+    @staticmethod\n+    def rand_keys(n):\n+        ret = []\n+        idxes = set()\n+        for _ in range(n):\n+            while True:\n+                i = random.randrange(len(KEYS))\n+                if not i in idxes:\n+                    break\n+            idxes.add(i)\n+            ret.append(KEYS[i])\n+        return ret",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r647384770",
      "id" : 647384770,
      "line" : 201,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzM4NDc3MA==",
      "original_commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "original_line" : 201,
      "original_position" : 201,
      "original_start_line" : 190,
      "path" : "test/functional/wallet_taproot.py",
      "position" : 201,
      "pull_request_review_id" : 678442468,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051",
      "side" : "RIGHT",
      "start_line" : 190,
      "start_side" : "RIGHT",
      "updated_at" : "2021-06-08T12:54:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/647384770",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r647561893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/647561893"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you're right.",
      "commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "created_at" : "2021-06-08T15:35:20Z",
      "diff_hunk" : "@@ -0,0 +1,272 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test generation and spending of P2TR addresses.\"\"\"\n+\n+import random\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.descriptors import descsum_create\n+from test_framework.script import (CScript, OP_CHECKSIG, taproot_construct)\n+from test_framework.segwit_addr import encode_segwit_address\n+\n+# xprvs/xpubs, and m/* derived x-only pubkeys (created using independent implementation)\n+KEYS = [\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPeNLUGrbv3b7qhUk1LQJZAGMuk9gVuKh9sd4BWGp1eMsehUni6qGb8bjkdwBxCbgNGdh2bYGACK5C5dRTaif9KBKGVnSezxV\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4XqNGAWGWSzmxGWFwVjVTjZxh2fioKbVYi7Jx8fdbprVWsdW7mHwqjchBVas8TLZG4Xwuz4RKU4iaCqiCvoSkFCzQptqk5Y1\",\n+        \"pubs\": [\n+            \"83d8ee77a0f3a32a5cea96fd1624d623b836c1e5d1ac2dcde46814b619320c18\",\n+            \"a30253b018ea6fca966135bf7dd8026915427f24ccf10d4e03f7870f4128569b\",\n+            \"a61e5749f2f3db9dc871d7b187e30bfd3297eea2557e9be99897ea8ff7a29a21\",\n+            \"8110cf482f66dc37125e619d73075af932521724ffc7108309e88f361efe8c8a\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPe98QUPieXy5KFPVjuZNpcC9JY7K7buJEm8nWvJogK4kTda7eLjK9U4PnMNbSjEkpjDJazeBZ4rhYNYD7N6GEdaysj1AYSb5\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4XcACN3PEwNjRpR1g4tZjBVk5pdMR2B6dbd3HYhdGVZNKofAiFZd9okBserZvv58A6tBX4pE64UpXGNTSesfUW7PpW36HuKz\",\n+        \"pubs\": [\n+            \"f95886b02a84928c5c15bdca32784993105f73de27fa6ad8c1a60389b999267c\",\n+            \"71522134160685eb779857033bfc84c7626f13556154653a51dd42619064e679\",\n+            \"48957b4158b2c5c3f4c000f51fd2cf0fd5ff8868ebfb194256f5e9131fc74bd8\",\n+            \"086dda8139b3a84944010648d2b674b70447be3ae59322c09a4907bc80be62c1\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPe3ZJmcj9aJ2EPZJYYCh6Lp3v82p75wspgaXmtDZ2RBtkAtWcGnW2VQDzMHQPBkCKMoYTqh1RfJKjv4PcmWVR7KqTpjsdboN\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4XWb6fGPjyhgLxapUhXszv7ehQYrQWDgDX4nYWcNcbgWcM2RhYo9s2mbZcfZJ8t5LzYcr24FK79zVybsw5Qj3Rtqug8jpJMy\",\n+        \"pubs\": [\n+            \"9fa5ffb68821cf559001caa0577eeea4978b29416def328a707b15e91701a2f7\",\n+            \"8a104c54cd34acba60c97dd8f1f7abc89ba9587afd88dc928e91aca7b1c50d20\",\n+            \"13ba6b252a4eb5ef31d39cb521724cdab19a698323f5c17093f28fb1821d052f\",\n+            \"f6c2b4863fd5ba1ba09e3a890caed8b75ffbe013ebab31a06ab87cd6f72506af\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPdKziibn63Rm6aNzp7dSjDnufZMStXr71Huz7iihCRpbZZZ6Voy5HyuHCWx6foHMipzMzUq4tZrtkZ24DJwz5EeNWdsuwX5h\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Wo2WcFSgSqRD9QWkGxddo6WSqsVBx7uQ8QEtM7WncKDRjhFEexK119NigyCsFygA4b7sAPQxqebyFGAZ9XVV1BtcgNzbCRR\",\n+        \"pubs\": [\n+            \"03a669ea926f381582ec4a000b9472ba8a17347f5fb159eddd4a07036a6718eb\",\n+            \"bbf56b14b119bccafb686adec2e3d2a6b51b1626213590c3afa815d1fd36f85d\",\n+            \"2994519e31bbc238a07d82f85c9832b831705d2ee4a2dbb477ecec8a3f570fe5\",\n+            \"68991b5c139a4c479f8c89d6254d288c533aefc0c5b91fac6c89019c4de64988\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPen4PGtDwURYnCtVMDejyE8vVwMGhQWfVqB2FBPdekhTacDW4vmsKTsgC1wsncVqXiZdX2YFGAnKoLXYf42M78fQJFzuDYFN\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4YF6BAXtXsqCtmv1HNyvsoSXHDsJzpnTtffH1onTEwC5SnLzCHPKPebh2i7Gxvi9kJNADcpuSmH8oM3rCYcHVtdXHjpYoKnX\",\n+        \"pubs\": [\n+            \"aba457d16a8d59151c387f24d1eb887efbe24644c1ee64b261282e7baebdb247\",\n+            \"c8558b7caf198e892032d91f1a48ee9bdc25462b83b4d0ac62bb7fb2a0df630e\",\n+            \"8a4bcaba0e970685858d133a4d0079c8b55bbc755599e212285691eb779ce3dc\",\n+            \"b0d68ada13e0d954b3921b88160d4453e9c151131c2b7c724e08f538a666ceb3\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPd91vCgRmbzA13wyip2RimYeVEkAyZvsEN5pUSB3T43SEBxPsytkxb42d64W2EiRE9CewpJQkzR8HKHLV8Uhk4dMF5yRPaTv\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Wc3i6L6N1Pp7cyVeyMcdLrFGXGDGzCfdCa5F4Zs3EY46N72Ws8QDEUYBVwXfDfda2UKSseSdU1fsBegJBhGCZyxkf28bkQ6\",\n+        \"pubs\": [\n+            \"9b4d495b74887815a1ff623c055c6eac6b6b2e07d2a016d6526ebac71dd99744\",\n+            \"8e971b781b7ce7ab742d80278f2dfe7dd330f3efd6d00047f4a2071f2e7553cb\",\n+            \"b811d66739b9f07435ccda907ec5cd225355321c35e0a7c7791232f24cf10632\",\n+            \"4cd27a5552c272bc80ba544e9cc6340bb906969f5e7a1510b6cef9592683fbc9\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPdEhLRxxwzTv2t18j7ruoffPeqAwVA2qXJ2P66RaMZLUWQ85SjoA7xPxdSgCB9UZ72m65qbnaLPtFTfHVP3MEmkpZk1Bv8RT\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Whj8KcdYPsa9T2efHC6iExzS7gynaJdv8WdripPwjq6NaH5gQJGrLmvUwHY1smhiakUosXNDTEa6qfKUQdLKV6DJBre6XvQ\",\n+        \"pubs\": [\n+            \"d0c19def28bb1b39451c1a814737615983967780d223b79969ba692182c6006b\",\n+            \"cb1d1b1dc62fec1894d4c3d9a1b6738e5ff9c273a64f74e9ab363095f45e9c47\",\n+            \"245be588f41acfaeb9481aa132717db56ee1e23eb289729fe2b8bde8f9a00830\",\n+            \"5bc4ad6d6187fa82728c85a073b428483295288f8aef5722e47305b5872f7169\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPcxbqxzcMAwQpiCD8x6qaZEJTxdKxw4w9GuMzDACTD9yhEsHGfqQcfYX4LivosLDDngTykYEp9JnTdcqY7cHqU8PpeFFKyV3\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4WRddreGwaM4wHDj57S2V8XuFF9NGMLjY7PckqZ23PebZR1wGA4w84uX2vZphdZVsnREjij1ibYjEBTaTVQCEZCLs4xUDapx\",\n+        \"pubs\": [\n+            \"065cc1b92bd99e5a3e626e8296a366b2d132688eb43aea19bc14fd8f43bf07fb\",\n+            \"5b95633a7dda34578b6985e6bfd85d83ec38b7ded892a9b74a3d899c85890562\",\n+            \"dc86d434b9a34495c8e845b969d51f80d19a8df03b400353ffe8036a0c22eb60\",\n+            \"06c8ffde238745b29ae8a97ae533e1f3edf214bba6ec58b5e7b9451d1d61ec19\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPe6zLoU8MTTXgsdJVNBErrYGpoGwHf5VGvwUzdNc7NHeCSzkJkniCxBhZWujXjmD4HZmBBrnr3URgJjM6GxRgMmEhLdqNTWG\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Xa28h7nwrsBoSepRXWRmRqsc5nyb5MHfmRjmFmRhYnG4d9dC7uxixN5AfsEv1Lz3mCAuWvERyvPgKozHUVjfo8EG6foJGy7\",\n+        \"pubs\": [\n+            \"d826a0a53abb6ffc60df25b9c152870578faef4b2eb5a09bdd672bbe32cdd79b\",\n+            \"939365e0359ff6bc6f6404ee220714c5d4a0d1e36838b9e2081ede217674e2ba\",\n+            \"4e8767edcf7d3d90258cfbbea01b784f4d2de813c4277b51279cf808bac410a2\",\n+            \"d42a2c280940bfc6ede971ae72cde2e1df96c6da7dab06a132900c6751ade208\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPeB5o5oCsN2dVxM2mtJiYERQEBRc4JNwC1DFGYaEdNkmh8jJYVPU76YhkFoRoWTdh1p3yQGykG8TfDW34dKgrgSx28gswUyL\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4Xe7aySsTmSHcXNYi3duSoj11TweMiejaqhW3Ay4DZFPZJses4sfpk4b9VHRhn8v4cKTMjugMM3hqXcqSSmRdiW8QvASXjfY\",\n+        \"pubs\": [\n+            \"e360564b2e0e8d06681b6336a29d0750210e8f34afd9afb5e6fd5fe6dba26c81\",\n+            \"76b4900f00a1dcce463b6d8e02b768518fce4f9ecd6679a13ad78ea1e4815ad3\",\n+            \"5575556e263c8ed52e99ab02147cc05a738869afe0039911b5a60a780f4e43d2\",\n+            \"593b00e2c8d4bd6dda0fd9e238888acf427bb4e128887fd5a40e0e9da78cbc01\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPfEH6jHemkGDjZRnAaKFJVGH8pQU638E6SdbX9hxit1tK2sfFPfL6KS7v8FfUKxstbfEpzSymbdfBM9Y5UkrxErF9fJaKLK3\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4YhJtcwKN9fsr8TJ6jeSD4Zsv6vWPTQ2VH7rHn6nK4WWBCzKK7FkdVVwm3iztCU1UmStY4hX6gRbBmp9UzK9C59dQEzeXS12\",\n+        \"pubs\": [\n+            \"7631cacec3343052d87ef4d0065f61dde82d7d2db0c1cc02ef61ef3c982ea763\",\n+            \"c05e44a9e735d1b1bef62e2c0d886e6fb4923b2649b67828290f5cacc51c71b7\",\n+            \"b33198b20701afe933226c92fd0e3d51d3f266f1113d864dbd026ae3166ef7f2\",\n+            \"f99643ac3f4072ee4a949301e86963a9ca0ad57f2ef29f6b84fda037d7cac85b\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8ZgxMBicQKsPdNWU38dT6aGxtqJR4oYS5kPpLVBcuKiiu7gqTYqMMqhUG6DP7pPahzPQu36sWSmeLCP1C4AwqcR5FX2RyRoZfd4B8pAnSdX\",\n+        \"xpub\": \"tpubD6NzVbkrYhZ4WqYFvnJ3Vyw5TrpME8jLf3zbd1DvKbX7jbwc5wewYLKLSFRzZWV6hZj7XhsXAy7fhE5jB25DiWyNM3ztXbsXHRVCrp5BiPY\",\n+        \"pubs\": [\n+            \"2258b1c3160be0864a541854eec9164a572f094f7562628281a8073bb89173a7\",\n+            \"83df59d0a5c951cdd62b7ab225a62079f48d2a333a86e66c35420d101446e92e\",\n+            \"2a654bf234d819055312f9ca03fad5836f9163b09cdd24d29678f694842b874a\",\n+            \"aa0334ab910047387c912a21ec0dab806a47ffa38365060dbc5d47c18c6e66e7\",\n+        ]\n+    },\n+    {\n+        \"xprv\": \"tprv8mGPkMVz5mZuJDnC2NjjAv7E9Zqa5LCgX4zawbZu5nzTtLb5kGhPwycX4H1gtW1f5ZdTKTNtQJ61hk71F2TdcQ93EFDTpUcPBr98QRji615\",\n+        \"xpub\": \"tpubDHxRtmYEE9FaBgoyv2QKaKmLibMWEfPb6NbNE7cCW4nripqrNfWz8UEPEPbHCrakwLvwFfsqoaf4pjX4gWStp4nECRf1QwBKPkLqnY8pHbj\",\n+        \"pubs\": [\n+            \"00a9da96087a72258f83b338ef7f0ea8cbbe05da5f18f091eb397d1ecbf7c3d3\",\n+            \"b2749b74d51a78f5fe3ebb3a7c0ff266a468cade143dfa265c57e325177edf00\",\n+            \"6b8747a6bbe4440d7386658476da51f6e49a220508a7ec77fe7bccc3e7baa916\",\n+            \"4674bf4d9ebbe01bf0aceaca2472f63198655ecf2df810f8d69b38421972318e\",\n+        ]\n+    }\n+]\n+\n+CHANGE_XPRV = \"tprv8ZgxMBicQKsPcyDrWwiecVnTtFmfRwbfFqEfR4ZGWvq5aTTwLBWmAm5zrbMcYtb9gQNFfhRfqhhrBG37U3nhmXxEgeEPBJGHAPrHCrAd1WX\"\n+CHANGE_XPUB = \"tpubD6NzVbkrYhZ4WSFeQbPF1uSaTHHbbGnZq8qShabZwCdUQwihxaLMMFhs2kidGF2qrRKiQVqw8VoyuTHj1bZqmMXMeciaU1gBjWA1sim2zUB\"\n+\n+# Point with no known discrete log.\n+H_POINT = \"50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\"\n+\n+\n+def key(hex_key):\n+    \"\"\"Construct an x-only pubkey from its hex representation.\"\"\"\n+    return bytes.fromhex(hex_key)\n+\n+def pk(hex_key):\n+    \"\"\"Construct a script expression for taproot_construct for pk(hex_key).\"\"\"\n+    return (None, CScript([bytes.fromhex(hex_key), OP_CHECKSIG]))\n+\n+def compute_taproot_address(pubkey, scripts):\n+    \"\"\"Compute the address for a taproot output with given inner key and scripts.\"\"\"\n+    tap = taproot_construct(pubkey, scripts)\n+    assert tap.scriptPubKey[0] == 0x51\n+    assert tap.scriptPubKey[1] == 0x20\n+    return encode_segwit_address(\"bcrt\", 1, tap.scriptPubKey[2:])\n+\n+class WalletTaprootTest(BitcoinTestFramework):\n+    \"\"\"Test generation and spending of P2TR address outputs.\"\"\"\n+\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+        self.extra_args = [['-keypool=100'], ['-keypool=100']]\n+        self.supports_cli = False\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def init_wallet(self, i):\n+        pass\n+\n+    @staticmethod\n+    def rand_keys(n):\n+        ret = []\n+        idxes = set()\n+        for _ in range(n):\n+            while True:\n+                i = random.randrange(len(KEYS))\n+                if not i in idxes:\n+                    break\n+            idxes.add(i)\n+            ret.append(KEYS[i])\n+        return ret",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22051#discussion_r647561893",
      "id" : 647561893,
      "in_reply_to_id" : 647384770,
      "line" : 201,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzU2MTg5Mw==",
      "original_commit_id" : "2667366aaa69447a9de4d819669d254a5ebd4d4b",
      "original_line" : 201,
      "original_position" : 201,
      "original_start_line" : 190,
      "path" : "test/functional/wallet_taproot.py",
      "position" : 201,
      "pull_request_review_id" : 678682441,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22051",
      "side" : "RIGHT",
      "start_line" : 190,
      "start_side" : "RIGHT",
      "updated_at" : "2021-06-08T15:35:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/647561893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
