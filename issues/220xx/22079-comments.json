[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2021-05-26T23:28:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-849185851",
      "id" : 849185851,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg0OTE4NTg1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-26T23:28:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/849185851",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, it's kind of fascinating this went without IPv6 support for so long.",
      "created_at" : "2021-05-27T11:37:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-849560169",
      "id" : 849560169,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg0OTU2MDE2OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-27T11:37:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/849560169",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22079#discussion_r641913585"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/641913585"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit , quote arg `='...'`?",
      "commit_id" : "9e493c0aa5e5d523ee4811607ad4a0d2ee7cc8cb",
      "created_at" : "2021-05-29T09:09:48Z",
      "diff_hunk" : "@@ -84,6 +84,7 @@ For instance:\n \n     $ bitcoind -zmqpubhashtx=tcp://127.0.0.1:28332 \\\n                -zmqpubhashtx=tcp://192.168.1.2:28332 \\\n+               -zmqpubhashblock=tcp://[::1]:28333 \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#discussion_r641913585",
      "id" : 641913585,
      "line" : 87,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0MTkxMzU4NQ==",
      "original_commit_id" : "9e493c0aa5e5d523ee4811607ad4a0d2ee7cc8cb",
      "original_line" : 87,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/zmq.md",
      "position" : 4,
      "pull_request_review_id" : 671729310,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22079",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-05-29T09:09:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/641913585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22079#discussion_r641972557"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/641972557"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done! (with double instead of single quotes)",
      "commit_id" : "fe8d37c9778f34be20d8925c0bea77098c8b47f1",
      "created_at" : "2021-05-29T18:53:10Z",
      "diff_hunk" : "@@ -84,6 +84,7 @@ For instance:\n \n     $ bitcoind -zmqpubhashtx=tcp://127.0.0.1:28332 \\\n                -zmqpubhashtx=tcp://192.168.1.2:28332 \\\n+               -zmqpubhashblock=tcp://[::1]:28333 \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#discussion_r641972557",
      "id" : 641972557,
      "in_reply_to_id" : 641913585,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0MTk3MjU1Nw==",
      "original_commit_id" : "9e493c0aa5e5d523ee4811607ad4a0d2ee7cc8cb",
      "original_line" : 87,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "doc/zmq.md",
      "position" : null,
      "pull_request_review_id" : 671766980,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22079",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-05-29T18:53:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/641972557",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/46975855?v=4",
         "events_url" : "https://api.github.com/users/n-thumann/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n-thumann/followers",
         "following_url" : "https://api.github.com/users/n-thumann/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n-thumann/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n-thumann",
         "id" : 46975855,
         "login" : "n-thumann",
         "node_id" : "MDQ6VXNlcjQ2OTc1ODU1",
         "organizations_url" : "https://api.github.com/users/n-thumann/orgs",
         "received_events_url" : "https://api.github.com/users/n-thumann/received_events",
         "repos_url" : "https://api.github.com/users/n-thumann/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n-thumann/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n-thumann"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-05-30T22:32:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-851071340",
      "id" : 851071340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1MTA3MTM0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-30T22:32:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/851071340",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@n-thumann: Would you mind rebasing this PR on master? Then #22103 is included, which fixed the IPv6 detection for *BSDs and macOS systems.",
      "created_at" : "2021-06-11T21:31:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-859920910",
      "id" : 859920910,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1OTkyMDkxMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-11T21:31:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/859920910",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @n-thumann: Would you mind rebasing this PR on master? Then #22103 is included, which fixed the IPv6 detection for *BSDs and macOS systems.\r\n\r\nDone âð» ",
      "created_at" : "2021-06-11T22:01:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-859931166",
      "id" : 859931166,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1OTkzMTE2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-11T22:01:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/859931166",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/46975855?v=4",
         "events_url" : "https://api.github.com/users/n-thumann/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n-thumann/followers",
         "following_url" : "https://api.github.com/users/n-thumann/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n-thumann/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n-thumann",
         "id" : 46975855,
         "login" : "n-thumann",
         "node_id" : "MDQ6VXNlcjQ2OTc1ODU1",
         "organizations_url" : "https://api.github.com/users/n-thumann/orgs",
         "received_events_url" : "https://api.github.com/users/n-thumann/received_events",
         "repos_url" : "https://api.github.com/users/n-thumann/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n-thumann/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n-thumann"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > @n-thumann: Would you mind rebasing this PR on master? Then #22103 is included, which fixed the IPv6 detection for *BSDs and macOS systems.\r\n> \r\n> Done âð»\r\n\r\nThanks!\r\n\r\nOn my system (OpenBSD 6.9), the functional test `interface_zmq.py` doesn't seem to get any notifications in the subscriber sockets in the PR branch. Only if I remove settings the sockopt `ZMQ_IPV6` from both server (bitcoind, publisher) and client (zmq interface Test, subscriber) it works again :/ would be interesting to know if this behaviour also shows up on other systems (that are not covered by the CI).\r\nMaybe it is connected to this ZMQ change: https://github.com/zeromq/libzmq/pull/2631 but that's just a vague guess...",
      "created_at" : "2021-06-11T23:41:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-859958788",
      "id" : 859958788,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1OTk1ODc4OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-11T23:41:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/859958788",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> On my system (OpenBSD 6.9), the functional test `interface_zmq.py` doesn't seem to get any notifications in the subscriber sockets in the PR branch. Only if I remove settings the sockopt `ZMQ_IPV6` from both server (bitcoind, publisher) and client (zmq interface Test, subscriber) it works again :/ would be interesting to know if this behaviour also shows up on other systems (that are not covered by the CI).\r\n> Maybe it is connected to this ZMQ change: [zeromq/libzmq#2631](https://github.com/zeromq/libzmq/pull/2631) but that's just a vague guess...\r\n\r\nI was able to confirm this behavior on OpenBSD, but not on any other OS (Debian, Ubuntu, macOS, FreeBSD). \r\nIt looks like that OpenBSD is a bit picky, when it comes to setting the `ZMQ_IPV6` option: While other OSes simply don't care (or bind dual-stacked), if the supplied address to listen on even is an IPv6 address, OpenBSD checks that. Therefore we must only set this option on OpenBSD, if it really is an IPv6 address. Same with the client side, so the functional test. If you want to have dual stack zmq on OpenBSD, you need to bind the socket twice, once for v4 and once for v6.\r\n@theStack feel free to test my latest changes ð ",
      "created_at" : "2021-06-13T11:06:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-860192603",
      "id" : 860192603,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2MDE5MjYwMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-13T11:12:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860192603",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/46975855?v=4",
         "events_url" : "https://api.github.com/users/n-thumann/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n-thumann/followers",
         "following_url" : "https://api.github.com/users/n-thumann/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n-thumann/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n-thumann",
         "id" : 46975855,
         "login" : "n-thumann",
         "node_id" : "MDQ6VXNlcjQ2OTc1ODU1",
         "organizations_url" : "https://api.github.com/users/n-thumann/orgs",
         "received_events_url" : "https://api.github.com/users/n-thumann/received_events",
         "repos_url" : "https://api.github.com/users/n-thumann/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n-thumann/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n-thumann"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It looks like that OpenBSD is a bit picky, when it comes to setting the `ZMQ_IPV6` option: While other OSes simply don't care (or bind dual-stacked), if the supplied address to listen on even is an IPv6 address, OpenBSD checks that. Therefore we must only set this option on OpenBSD, if it really is an IPv6 address. Same with the client side, so the functional test. If you want to have dual stack zmq on OpenBSD, you need to bind the socket twice, once for v4 and once for v6.\r\n> @theStack feel free to test my latest changes ð\r\n\r\nVery interesting, thanks for investigating deeper! I can confirm that the test succeeds with your latest changes. \r\nLooking at your fix, I'm wondering if we could simply _always_ only set `ZMQ_IPV6` if needed? That would avoid pre-processor conditionals depending on the OS (which is always kind of ugly and error-prone, considering that we check in code that is never compiled/run in the CI, in case of OpenBSD) and not cause troubles on other OSes that we didn't think of (e.g. DragonflyBSD?) but possibly have the same behaviour.\r\n",
      "created_at" : "2021-06-13T16:31:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-860237966",
      "id" : 860237966,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2MDIzNzk2Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-13T16:31:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860237966",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Looking at your fix, I'm wondering if we could simply _always_ only set `ZMQ_IPV6` if needed? That would avoid pre-processor conditionals depending on the OS (which is always kind of ugly and error-prone, considering that we check in code that is never compiled/run in the CI, in case of OpenBSD) and not cause troubles on other OSes that we didn't think of (e.g. DragonflyBSD?) but possibly have the same behavior.\r\n\r\nGood point! I've ran some more tests and indeed DragonFly BSD is also affected. I also confirmed that only setting `ZMQ_IPV6` if need has no negative impact / different behavior than always setting it on other OSes. Thus, I'll remove the pre-processor stuff ð\r\n\r\n<details>\r\n  <summary>Raw test results</summary>\r\n\r\n| OS | always set option | only set option, if v6 | listen address |Â socket type (netstat) |Â reachable via |\r\n| --- | --- | --- | --- | --- | --- |\r\n| macOS | | X | 127.0.0.1 | tcp4 | v4 |\r\n| macOS | X | | 127.0.0.1 | tcp4 | v4 |\r\n| macOS | | X | ::1 | tcp6 | v6 |\r\n| macOS | X | | ::1 | tcp6 | v6 |\r\n| macOS | | X | 0.0.0.0 | tcp4 | v4 |\r\n| macOS | X | | 0.0.0.0 | tcp4 | v4 |\r\n| macOS | | X | :: | tcp46 | v4 & v6 |\r\n| macOS | X | | :: | tcp46 | v4 & v6 |\r\n| --- | --- | --- | --- | --- | --- |\r\n| Debian | | X | 127.0.0.1 | tcp | v4 |\r\n| Debian | X | | 127.0.0.1 | tcp6 | v4 |\r\n| Debian | | X | ::1 | tcp6 | v6 |\r\n| Debian | X | | ::1 | tcp6 | v6 |\r\n| Debian | | X | 0.0.0.0 | tcp | v4 |\r\n| Debian | X | | 0.0.0.0 | tcp6 | v4 |\r\n| Debian | | X | :: | tcp6 | v4 & v6 |\r\n| Debian | X | | :: | tcp6 | v4 & v6 |\r\n| --- | --- | --- | --- | --- | --- |\r\n| FreeBSD | | X | 127.0.0.1 | tcp4 | v4 |\r\n| FreeBSD | X | | 127.0.0.1 | tcp4 | v4 |\r\n| FreeBSD | | X | ::1 | tcp6 | v6 |\r\n| FreeBSD | X | | ::1 | tcp6 | v6 |\r\n| FreeBSD | | X | 0.0.0.0 | tcp | v4 |\r\n| FreeBSD | X | | 0.0.0.0 | tcp4 | v4 |\r\n| FreeBSD | | X | :: | tcp46 | v4 & v6 |\r\n| FreeBSD | X | | :: | tcp46 | v4 & v6 |\r\n| --- | --- | --- | --- | --- | --- |\r\n| OpenBSD | | X | 127.0.0.1 | tcp | v4 |\r\n| OpenBSD | X | | 127.0.0.1 | fails | fails |\r\n| OpenBSD | | X | ::1 | tcp6 | v6 |\r\n| OpenBSD | X | | ::1 | tcp6 | v6 |\r\n| OpenBSD | | X | 0.0.0.0 | tcp | v4 |\r\n| OpenBSD | X | | 0.0.0.0 | fails | fails |\r\n| OpenBSD | | X | :: | tcp6 | v6 |\r\n| OpenBSD | X | | :: | tcp6 | v6 |\r\n| --- | --- | --- | --- | --- | --- |\r\n| DragonFly BSD | | X | 127.0.0.1 | tcp4 | v4 |\r\n| DragonFly BSD | X | | 127.0.0.1 | fails | fails |\r\n| DragonFly BSD | | X | ::1 | tcp6 | v6 |\r\n| DragonFly BSD | X | | ::1 | tcp6 | v6 |\r\n| DragonFly BSD | | X | 0.0.0.0 | tcp4 | v4 |\r\n| DragonFly BSD | X | | 0.0.0.0 | fails | fails |\r\n| DragonFly BSD | | X | :: | tcp6 | v6 |\r\n| DragonFly BSD | X | | :: | tcp6 | v6 |\r\n</details>\r\n",
      "created_at" : "2021-06-14T22:24:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-861034084",
      "id" : 861034084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2MTAzNDA4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-14T22:24:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861034084",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/46975855?v=4",
         "events_url" : "https://api.github.com/users/n-thumann/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n-thumann/followers",
         "following_url" : "https://api.github.com/users/n-thumann/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n-thumann/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n-thumann",
         "id" : 46975855,
         "login" : "n-thumann",
         "node_id" : "MDQ6VXNlcjQ2OTc1ODU1",
         "organizations_url" : "https://api.github.com/users/n-thumann/orgs",
         "received_events_url" : "https://api.github.com/users/n-thumann/received_events",
         "repos_url" : "https://api.github.com/users/n-thumann/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n-thumann/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n-thumann"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22079#discussion_r652098341"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/652098341"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is pretty ugly. Can we just ignore errors setting `ZMQ_IPV6` if the subsequent bind succeeds?",
      "commit_id" : "e1820a5a6fa5939c86aa3ed59879611cd869b790",
      "created_at" : "2021-06-15T19:41:21Z",
      "diff_hunk" : "@@ -107,6 +110,27 @@ bool CZMQAbstractPublishNotifier::Initialize(void *pcontext)\n             return false;\n         }\n \n+        int enable_ipv6 {1};\n+        #if defined(__OpenBSD__)\n+        // On OpenBSD the IPv6 option must not be set, if the address to bind isn't IPv6\n+        const std::string tcpPrefix = \"tcp://\";\n+        const int tcpIndex = address.rfind(tcpPrefix);\n+        const int portColonIndex = address.rfind(\":\");\n+        if (tcpIndex != -1 && portColonIndex != -1) {\n+            const std::string ip = address.substr(tcpPrefix.length(), portColonIndex - tcpPrefix.length());\n+            CNetAddr addr;\n+            LookupHost(ip, addr, false);\n+            if (!addr.IsIPv6())\n+                enable_ipv6 = {0};\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#discussion_r652098341",
      "id" : 652098341,
      "line" : 125,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjA5ODM0MQ==",
      "original_commit_id" : "e1820a5a6fa5939c86aa3ed59879611cd869b790",
      "original_line" : 125,
      "original_position" : 26,
      "original_start_line" : 116,
      "path" : "src/zmq/zmqpublishnotifier.cpp",
      "position" : 26,
      "pull_request_review_id" : 684418450,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22079",
      "side" : "RIGHT",
      "start_line" : 116,
      "start_side" : "RIGHT",
      "updated_at" : "2021-06-15T19:42:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/652098341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22079#discussion_r652129700"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/652129700"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I cleaned up a little bit, but I'm not sure, if ignoring an error while setting `ZMQ_IPV6` is a good idea: If it fails, the binding of an IPv6 address will also fail and and prior error could help narrowing down the issue. And if we set the option on e.g. OpenBSD without checking, the bind will always fail for IPv4.\r\nDid I got you right? You want to always set `ZMQ_IPV6` and see if the binding succeeds. If it does, all fine. If it didn't, what then?",
      "commit_id" : "7bbf6d8c92b17d8574987c50f1328e3d86f73846",
      "created_at" : "2021-06-15T20:32:09Z",
      "diff_hunk" : "@@ -107,6 +110,27 @@ bool CZMQAbstractPublishNotifier::Initialize(void *pcontext)\n             return false;\n         }\n \n+        int enable_ipv6 {1};\n+        #if defined(__OpenBSD__)\n+        // On OpenBSD the IPv6 option must not be set, if the address to bind isn't IPv6\n+        const std::string tcpPrefix = \"tcp://\";\n+        const int tcpIndex = address.rfind(tcpPrefix);\n+        const int portColonIndex = address.rfind(\":\");\n+        if (tcpIndex != -1 && portColonIndex != -1) {\n+            const std::string ip = address.substr(tcpPrefix.length(), portColonIndex - tcpPrefix.length());\n+            CNetAddr addr;\n+            LookupHost(ip, addr, false);\n+            if (!addr.IsIPv6())\n+                enable_ipv6 = {0};\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#discussion_r652129700",
      "id" : 652129700,
      "in_reply_to_id" : 652098341,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MjEyOTcwMA==",
      "original_commit_id" : "e1820a5a6fa5939c86aa3ed59879611cd869b790",
      "original_line" : 121,
      "original_position" : 26,
      "original_start_line" : 116,
      "path" : "src/zmq/zmqpublishnotifier.cpp",
      "position" : null,
      "pull_request_review_id" : 684460197,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22079",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-06-15T20:32:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/652129700",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/46975855?v=4",
         "events_url" : "https://api.github.com/users/n-thumann/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n-thumann/followers",
         "following_url" : "https://api.github.com/users/n-thumann/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n-thumann/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n-thumann",
         "id" : 46975855,
         "login" : "n-thumann",
         "node_id" : "MDQ6VXNlcjQ2OTc1ODU1",
         "organizations_url" : "https://api.github.com/users/n-thumann/orgs",
         "received_events_url" : "https://api.github.com/users/n-thumann/received_events",
         "repos_url" : "https://api.github.com/users/n-thumann/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n-thumann/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n-thumann"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I tend to agree with @luke-jr that having to analyze the address string first in order to set (or not set) a socket option is \"ugly\", but on the other hand I don't see another solution.\r\n\r\nAbsolutely! I'd be nice to have the plain address to bind, but the string entered by the user is the only thing to work with :/\r\n> Some suggestions: [...]\r\n\r\nApplied!\r\n",
      "created_at" : "2021-06-16T21:20:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-862735101",
      "id" : 862735101,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2MjczNTEwMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-16T21:20:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/862735101",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/46975855?v=4",
         "events_url" : "https://api.github.com/users/n-thumann/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n-thumann/followers",
         "following_url" : "https://api.github.com/users/n-thumann/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n-thumann/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n-thumann",
         "id" : 46975855,
         "login" : "n-thumann",
         "node_id" : "MDQ6VXNlcjQ2OTc1ODU1",
         "organizations_url" : "https://api.github.com/users/n-thumann/orgs",
         "received_events_url" : "https://api.github.com/users/n-thumann/received_events",
         "repos_url" : "https://api.github.com/users/n-thumann/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n-thumann/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n-thumann"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@n-thumann: looks good to me. Could you squash at least the last two commits (or probably better even the last three, in order to avoid an \"in-between\" state where the \"only set zmq_ipv6 if needed\" fix has only been applied on one side), in order to ease review?",
      "created_at" : "2021-06-18T13:50:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-864053624",
      "id" : 864053624,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2NDA1MzYyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-18T13:50:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864053624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Squashed :)",
      "created_at" : "2021-06-18T21:41:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-864288324",
      "id" : 864288324,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2NDI4ODMyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-18T21:41:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864288324",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/46975855?v=4",
         "events_url" : "https://api.github.com/users/n-thumann/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n-thumann/followers",
         "following_url" : "https://api.github.com/users/n-thumann/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n-thumann/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n-thumann",
         "id" : 46975855,
         "login" : "n-thumann",
         "node_id" : "MDQ6VXNlcjQ2OTc1ODU1",
         "organizations_url" : "https://api.github.com/users/n-thumann/orgs",
         "received_events_url" : "https://api.github.com/users/n-thumann/received_events",
         "repos_url" : "https://api.github.com/users/n-thumann/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n-thumann/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n-thumann"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Done! Btw, I really do appreciate your feedback!",
      "created_at" : "2021-06-20T14:59:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-864567355",
      "id" : 864567355,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2NDU2NzM1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-20T14:59:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864567355",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/46975855?v=4",
         "events_url" : "https://api.github.com/users/n-thumann/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n-thumann/followers",
         "following_url" : "https://api.github.com/users/n-thumann/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n-thumann/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n-thumann",
         "id" : 46975855,
         "login" : "n-thumann",
         "node_id" : "MDQ6VXNlcjQ2OTc1ODU1",
         "organizations_url" : "https://api.github.com/users/n-thumann/orgs",
         "received_events_url" : "https://api.github.com/users/n-thumann/received_events",
         "repos_url" : "https://api.github.com/users/n-thumann/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n-thumann/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n-thumann"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK e6998838e5548991274ad2bf1697d862905b8837",
      "created_at" : "2021-09-09T13:33:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-916100862",
      "id" : 916100862,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "IC_kwDOABII5842mpb-",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-09T13:33:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/916100862",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This went into 23.0, but I'm not sure it actually got a release note. Removing the label.",
      "created_at" : "2022-09-15T15:20:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22079#issuecomment-1248251680",
      "id" : 1248251680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22079",
      "node_id" : "IC_kwDOABII585KZs8g",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1248251680/reactions"
      },
      "updated_at" : "2022-09-15T15:20:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1248251680",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
