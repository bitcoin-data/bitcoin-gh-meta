[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194308210"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194308210"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is slightly different because `!IsBlockPruned` is true when `BLOCK_HAVE_DATA` but from the immediate code alone `nTx > 0` is not guaranteed. Is it the case that `BLOCK_HAVE_DATA` blocks are guaranteed to have `nTx > 0`?",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T07:11:23Z",
      "diff_hunk" : "@@ -4277,11 +4277,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194308210",
      "id" : 194308210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMwODIxMA==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 127453026,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194308210",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194308580"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194308580"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Explicit precedence for `chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave` would be nice",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T07:13:30Z",
      "diff_hunk" : "@@ -2040,8 +2040,7 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n             // If pruning, don't inv blocks unless we have on disk and are likely to still have\n             // for some reasonable time window (1 hour) that block relay might require.\n             const int nPrunedBlocksLikelyToHave = MIN_BLOCKS_TO_KEEP - 3600 / chainparams.GetConsensus().nPowTargetSpacing;\n-            if (fPruneMode && (!(pindex->nStatus & BLOCK_HAVE_DATA) || pindex->nHeight <= chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave))\n-            {\n+            if (fPruneMode && (IsBlockPruned(pindex) || pindex->nHeight <= chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194308580",
      "id" : 194308580,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMwODU4MA==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 6,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 127453466,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194308580",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194308812"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194308812"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just noting that I see you mention this in your notes: \"Note that nTx > 0? is supposed to always be equivalent to (pindex->nStatus & BLOCK_HAVE_DATA)?.\"",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T07:14:41Z",
      "diff_hunk" : "@@ -4277,11 +4277,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194308812",
      "id" : 194308812,
      "in_reply_to_id" : 194308210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMwODgxMg==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 127453744,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194308812",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194310667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194310667"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah. if nTx = 0, it means you do not have data (nStatus & BHD), and if nTx > 0, it means you do have data, so the two checks are supposed to be equivalent, but I think they're done as a safety harness. That said, in this case the old code does `block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0` which is identical to the `!IsBlockPruned` case, isn't it?",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T07:24:24Z",
      "diff_hunk" : "@@ -4277,11 +4277,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194310667",
      "id" : 194310667,
      "in_reply_to_id" : 194308210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMxMDY2Nw==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 127455898,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194310667",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194311026"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194311026"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You mean `()`? I don't think it's unclear that `<=` takes precedence over `-` (as opposed to e.g. `&&` and `||`)...",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T07:25:59Z",
      "diff_hunk" : "@@ -2040,8 +2040,7 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n             // If pruning, don't inv blocks unless we have on disk and are likely to still have\n             // for some reasonable time window (1 hour) that block relay might require.\n             const int nPrunedBlocksLikelyToHave = MIN_BLOCKS_TO_KEEP - 3600 / chainparams.GetConsensus().nPowTargetSpacing;\n-            if (fPruneMode && (!(pindex->nStatus & BLOCK_HAVE_DATA) || pindex->nHeight <= chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave))\n-            {\n+            if (fPruneMode && (IsBlockPruned(pindex) || pindex->nHeight <= chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194311026",
      "id" : 194311026,
      "in_reply_to_id" : 194308580,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMxMTAyNg==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 6,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 127456273,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194311026",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194315186"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194315186"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's not identical - via De Morgan's law:\r\n* IsBlockPruned: `!(nStatus & BLOCK_HAVE_DATA) && nTx > 0`\r\n* !IsBlockPruned: `(nStatus & BLOCK_HAVE_DATA) || nTx <= 0`",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T07:45:58Z",
      "diff_hunk" : "@@ -4277,11 +4277,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194315186",
      "id" : 194315186,
      "in_reply_to_id" : 194308210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMxNTE4Ng==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 127461202,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194315186",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ConceptACK for improved readability, though for the same reason I can't easily tell if it's correct :-)",
      "created_at" : "2018-06-11T08:04:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-396157042",
      "id" : 396157042,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjE1NzA0Mg==",
      "updated_at" : "2018-06-11T08:04:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396157042",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194322419"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194322419"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hm, you're right. I got the `nTx > 0` part backwards... Eesh.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T08:15:33Z",
      "diff_hunk" : "@@ -4277,11 +4277,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194322419",
      "id" : 194322419,
      "in_reply_to_id" : 194308210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMyMjQxOQ==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 127469635,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194322419",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194324920"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194324920"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The more I stare at the original line, the more I think the nTx part is backwards. I think they intended to check if it was pruned, but got the check to instead check if 'they have the data and the nTx > 0'. But if they have the data, nTx should always be > 0.\r\n\r\nI.e.\r\n* for a pruned block, `nTx > 0` but `nStatus & BHD == 0`\r\n* for a non-pruned block, `nTx > 0` and `nStatus & BHD != 0`\r\n* for a block the node has not retrieved yet, `nTx == 0` and `nStatus & BHD == 0`\r\n\r\nI.e.\r\n```\r\nnTx > 0 nStatus & BHD != 0 case\r\n======= ================== =====================\r\nfalse   false              block data never seen\r\nfalse   true               ?????\r\ntrue    false              pruned block\r\ntrue    true               block data available\r\n```\r\n\r\nThe code checks that case 2 in the above table (`false true`) is not the case, but this check is unnecessary.\r\n\r\nI think the `!IsBlockPruned()` replacement here is correct.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T08:26:03Z",
      "diff_hunk" : "@@ -4277,11 +4277,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194324920",
      "id" : 194324920,
      "in_reply_to_id" : 194308210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMyNDkyMA==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 127472694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194324920",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194335893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194335893"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Right, so my point is that, if the `false true ?????` case is relevant, then we need to exclude it. Looks like `CChainState::CheckBlockIndex` excludes that possibility (which is intuitive given coinbase exists at least), so I'm tending to agree with you: https://github.com/bitcoin/bitcoin/blob/master/src/validation.cpp#L4545",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T09:06:15Z",
      "diff_hunk" : "@@ -4277,11 +4277,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194335893",
      "id" : 194335893,
      "in_reply_to_id" : 194308210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDMzNTg5Mw==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 127485713,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194335893",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-06-11T09:12:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-396176052",
      "id" : 396176052,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjE3NjA1Mg==",
      "updated_at" : "2018-06-11T09:12:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396176052",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194341639"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194341639"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think it's ever possible for that case to happen, so I think `!IsBlockPruned()` does what we want here. I.e. it's not a relevant case. Note that this is a check that goes back in the blockchain and only stops if it encounters a missing block. That will only ever be the case if pruning is enabled, and will only ever be caused by pruning. Non-pruning nodes never have holes in the blockchain data (i.e. if they have block at `height=x`, they also have block at `height=x-1` for `x > 0`).",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T09:27:04Z",
      "diff_hunk" : "@@ -4277,11 +4277,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194341639",
      "id" : 194341639,
      "in_reply_to_id" : 194308210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDM0MTYzOQ==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 127492590,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194341639",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194385675"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194385675"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could drop `fPruneMode` because `fHavePruned` is only true if `fHavePruned` is also true. Same below.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-11T12:29:05Z",
      "diff_hunk" : "@@ -2040,8 +2040,7 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n             // If pruning, don't inv blocks unless we have on disk and are likely to still have\n             // for some reasonable time window (1 hour) that block relay might require.\n             const int nPrunedBlocksLikelyToHave = MIN_BLOCKS_TO_KEEP - 3600 / chainparams.GetConsensus().nPowTargetSpacing;\n-            if (fPruneMode && (!(pindex->nStatus & BLOCK_HAVE_DATA) || pindex->nHeight <= chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave))\n-            {\n+            if (fPruneMode && (IsBlockPruned(pindex) || pindex->nHeight <= chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194385675",
      "id" : 194385675,
      "in_reply_to_id" : 194308580,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDM4NTY3NQ==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 6,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 127546153,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194385675",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "As @sdaftuar pointed out before, the burden in reviewing validation changes may not be worth it, unless this is really incomplete. I don't think this improves readability that much, but I'm in the same position as @Sjors.",
      "created_at" : "2018-06-11T12:32:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-396227294",
      "id" : 396227294,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjIyNzI5NA==",
      "updated_at" : "2018-06-11T12:32:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396227294",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194634789"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194634789"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-12T07:13:04Z",
      "diff_hunk" : "@@ -2040,8 +2040,7 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n             // If pruning, don't inv blocks unless we have on disk and are likely to still have\n             // for some reasonable time window (1 hour) that block relay might require.\n             const int nPrunedBlocksLikelyToHave = MIN_BLOCKS_TO_KEEP - 3600 / chainparams.GetConsensus().nPowTargetSpacing;\n-            if (fPruneMode && (!(pindex->nStatus & BLOCK_HAVE_DATA) || pindex->nHeight <= chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave))\n-            {\n+            if (fPruneMode && (IsBlockPruned(pindex) || pindex->nHeight <= chainActive.Tip()->nHeight - nPrunedBlocksLikelyToHave)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194634789",
      "id" : 194634789,
      "in_reply_to_id" : 194308580,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDYzNDc4OQ==",
      "original_commit_id" : "106a2a5110665ad7a7ee890c97997e0a50a414b7",
      "original_position" : 6,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 127841522,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194634789",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@promag I feel like this makes it clear which of the two cases \"do we have this block yet\" versus \"is this block pruned\", which I believe improves readability enough to warrant the effort. If others think it's more trouble than it's worth I'll grumpily close, though. ;)",
      "created_at" : "2018-06-12T07:14:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-396489830",
      "id" : 396489830,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjQ4OTgzMA==",
      "updated_at" : "2018-06-12T07:14:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396489830",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194830636"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194830636"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, could drop first condition `block && ` and add `assert(block)` before the loop, like https://github.com/bitcoin/bitcoin/pull/13430/files#diff-a0c8f511d90e83aa9b5857e819ced344R1243.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-12T17:47:14Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194830636",
      "id" : 194830636,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDgzMDYzNg==",
      "original_commit_id" : "877c92bb9ac62c600576de6cf593842785a95d91",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 128076868,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194830636",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194916551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194916551"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`block` is updated inside the loop, so that sounds like it could be unsafe. (That said, not sure if there is ever a case where a `CBlockIndex` goes from being set to being unset, except for genesis block...)\r\n\r\nOh, and it is set to the already tested `chainActive.Tip()` so it should always start out non-null.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-12T23:18:03Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194916551",
      "id" : 194916551,
      "in_reply_to_id" : 194830636,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDkxNjU1MQ==",
      "original_commit_id" : "877c92bb9ac62c600576de6cf593842785a95d91",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 128181985,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194916551",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194923450"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194923450"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`block` is updated to `block->pprev` which is already tested.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-13T00:02:52Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r194923450",
      "id" : 194923450,
      "in_reply_to_id" : 194830636,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDkyMzQ1MA==",
      "original_commit_id" : "877c92bb9ac62c600576de6cf593842785a95d91",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 128189738,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194923450",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #13029 (Interpret absense of prune= as prune=1 if there are pruned blocks by Sjors)\n* #10973 (Refactor: separate wallet from node by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-06-14T20:22:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-397426363",
      "id" : 397426363,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NzQyNjM2Mw==",
      "updated_at" : "2018-06-27T10:49:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/397426363",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r195624215"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/195624215"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah, yes you're right. Done.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-15T03:09:39Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r195624215",
      "id" : 195624215,
      "in_reply_to_id" : 194830636,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NTYyNDIxNQ==",
      "original_commit_id" : "877c92bb9ac62c600576de6cf593842785a95d91",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 129031568,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-15T03:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/195624215",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Don't worry too much about #13029; I'm waiting to see if #11082 makes it in, in which case that one can be closed.",
      "created_at" : "2018-06-15T08:36:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-397553329",
      "id" : 397553329,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NzU1MzMyOQ==",
      "updated_at" : "2018-06-15T08:36:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/397553329",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r198326131"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/198326131"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why remove `block &&` here?",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-26T23:20:13Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r198326131",
      "id" : 198326131,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5ODMyNjEzMQ==",
      "original_commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : 9,
      "pull_request_review_id" : 132238652,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-26T23:20:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/198326131",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r198327183"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/198327183"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@sipa see above.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-26T23:27:09Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block && block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r198327183",
      "id" : 198327183,
      "in_reply_to_id" : 194830636,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5ODMyNzE4Mw==",
      "original_commit_id" : "877c92bb9ac62c600576de6cf593842785a95d91",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 132239893,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-26T23:27:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/198327183",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa Github comment threading is buggy, but yes, see discussion above -- `block` is known to be non-null because it is checked (1) before entry and (2) at each loop in the form `block->pprev`.",
      "created_at" : "2018-06-27T22:24:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-400848788",
      "id" : 400848788,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDg0ODc4OA==",
      "updated_at" : "2018-06-27T22:24:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400848788",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r198662331"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/198662331"
         }
      },
      "author_association" : "NONE",
      "body" : "Musisz wyreindeksowaÃÂ (ponownie pobraÃÂ caÃÂy ÃÂaÃÂcuch blockchain w przypadku oczyszczonego wÃÂzÃÂa",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-27T22:38:14Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r198662331",
      "id" : 198662331,
      "in_reply_to_id" : 198326131,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5ODY2MjMzMQ==",
      "original_commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : 9,
      "pull_request_review_id" : 132633989,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-27T22:38:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/198662331",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/39281497?v=4",
         "events_url" : "https://api.github.com/users/youmind/events{/privacy}",
         "followers_url" : "https://api.github.com/users/youmind/followers",
         "following_url" : "https://api.github.com/users/youmind/following{/other_user}",
         "gists_url" : "https://api.github.com/users/youmind/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/youmind",
         "id" : 39281497,
         "login" : "youmind",
         "node_id" : "MDQ6VXNlcjM5MjgxNDk3",
         "organizations_url" : "https://api.github.com/users/youmind/orgs",
         "received_events_url" : "https://api.github.com/users/youmind/received_events",
         "repos_url" : "https://api.github.com/users/youmind/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/youmind/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/youmind/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/youmind"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r198662500"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/198662500"
         }
      },
      "author_association" : "NONE",
      "body" : "ostatnia synchronizacja portfela wykracza poza dane przyciÃÂte",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-06-27T22:39:11Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r198662500",
      "id" : 198662500,
      "in_reply_to_id" : 198326131,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5ODY2MjUwMA==",
      "original_commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : 9,
      "pull_request_review_id" : 132634192,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-06-27T22:39:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/198662500",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/39281497?v=4",
         "events_url" : "https://api.github.com/users/youmind/events{/privacy}",
         "followers_url" : "https://api.github.com/users/youmind/followers",
         "following_url" : "https://api.github.com/users/youmind/following{/other_user}",
         "gists_url" : "https://api.github.com/users/youmind/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/youmind",
         "id" : 39281497,
         "login" : "youmind",
         "node_id" : "MDQ6VXNlcjM5MjgxNDk3",
         "organizations_url" : "https://api.github.com/users/youmind/orgs",
         "received_events_url" : "https://api.github.com/users/youmind/received_events",
         "repos_url" : "https://api.github.com/users/youmind/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/youmind/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/youmind/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/youmind"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r200180212"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/200180212"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@sipa `.Tip()` is always not null (at this point), and `block->pprev` is next `block` value.",
      "commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "created_at" : "2018-07-04T17:36:08Z",
      "diff_hunk" : "@@ -4281,11 +4281,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(const std::string& name,\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node\n         // or if he ran -disablewallet for a longer time, then decided to re-enable\n-        if (fPruneMode)\n-        {\n+        if (fPruneMode) {\n             CBlockIndex *block = chainActive.Tip();\n-            while (block && block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA) && block->pprev->nTx > 0 && pindexRescan != block)\n+            while (block->pprev && !IsBlockPruned(block->pprev) && pindexRescan != block) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#discussion_r200180212",
      "id" : 200180212,
      "in_reply_to_id" : 198326131,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMDE4MDIxMg==",
      "original_commit_id" : "55e760f54721f320e913f885c89490a9531faaa5",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : 9,
      "pull_request_review_id" : 134445685,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13430",
      "updated_at" : "2018-07-04T17:36:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/200180212",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14711](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14711.html) (Remove uses of chainActive and mapBlockIndex in wallet code by ryanofsky)\n* [#10973](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/10973.html) (Refactor: separate wallet from node by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-08-03T20:28:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-410367676",
      "id" : 410367676,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMDM2NzY3Ng==",
      "updated_at" : "2018-12-07T00:13:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/410367676",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--5d09a71f8925f3f132321140b44b946d-->The last travis run for this pull request was 56 days ago and is thus outdated. To trigger a fresh travis build, this pull request should be closed and re-opened.",
      "created_at" : "2018-08-10T12:37:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-412069660",
      "id" : 412069660,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxMjA2OTY2MA==",
      "updated_at" : "2018-08-10T12:37:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/412069660",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Might want to clarify the documentation of IsBlockPruned first? I.e. explain why it returns false for a block that has its data downloaded or why it returns false for a block that is missing its data.",
      "created_at" : "2019-04-22T18:30:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-485505154",
      "id" : 485505154,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTUwNTE1NA==",
      "updated_at" : "2019-04-22T18:30:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485505154",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke I kind of closed this out of frustration due to lack of feedback. I can reopen if you think it's worth it to try to get this merged.",
      "created_at" : "2019-04-24T04:35:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13430#issuecomment-486064191",
      "id" : 486064191,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13430",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NjA2NDE5MQ==",
      "updated_at" : "2019-04-24T04:35:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/486064191",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   }
]
