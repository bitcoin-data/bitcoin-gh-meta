[
   {
      "author_association" : "NONE",
      "body" : "> Not sure this is a good idea. If the user starts bitcoind at boot, he will need to wait potentially an annoyingly long time before he can login...?\r\n\r\nThe other way I could do it would be to have the initscript mark the service as inactive and fork a subshell process into the background to wait for the lock and eventually reinvoke the initscript (with `IN_BACKGROUND=yes`) to mark the service as started so any dependent services can start in the background.\r\n\r\nThat said, if you're using `rc_parallel=yes`, then I think you'd get a login prompt before BitcoinD has finished starting anyway, assuming your login manager doesn't (transitively) depend on `bitcoind`, which I can't imagine it would.",
      "created_at" : "2021-06-27T00:34:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-869079796",
      "id" : 869079796,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2OTA3OTc5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-27T00:34:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/869079796",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/797782?v=4",
         "events_url" : "https://api.github.com/users/whitslack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/whitslack/followers",
         "following_url" : "https://api.github.com/users/whitslack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/whitslack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/whitslack",
         "id" : 797782,
         "login" : "whitslack",
         "node_id" : "MDQ6VXNlcjc5Nzc4Mg==",
         "organizations_url" : "https://api.github.com/users/whitslack/orgs",
         "received_events_url" : "https://api.github.com/users/whitslack/received_events",
         "repos_url" : "https://api.github.com/users/whitslack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/whitslack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/whitslack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/whitslack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've never seen a login prompt before *all* startup has completed... (console login)",
      "created_at" : "2021-06-27T01:46:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-869085918",
      "id" : 869085918,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2OTA4NTkxOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-27T01:46:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/869085918",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Oh, sure. SystemV `init` with the default Gentoo config won't start `agetty` until `openrc` is finished transitioning to the `default` runlevel.\r\n\r\nSo, would you be more amenable to this change if I did the background thing? To be honest, that's how I've had it set up on my machine for years (since long before `-startupnotify` was implemented), but I assumed the rather gross hackishness of that solution would be more objectionable than the straightforward approach.",
      "created_at" : "2021-06-27T02:05:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-869087775",
      "id" : 869087775,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2OTA4Nzc3NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-27T02:05:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/869087775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/797782?v=4",
         "events_url" : "https://api.github.com/users/whitslack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/whitslack/followers",
         "following_url" : "https://api.github.com/users/whitslack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/whitslack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/whitslack",
         "id" : 797782,
         "login" : "whitslack",
         "node_id" : "MDQ6VXNlcjc5Nzc4Mg==",
         "organizations_url" : "https://api.github.com/users/whitslack/orgs",
         "received_events_url" : "https://api.github.com/users/whitslack/received_events",
         "repos_url" : "https://api.github.com/users/whitslack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/whitslack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/whitslack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/whitslack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm not familiar enough with the tradeoffs and implementation details, but it sounds like a better solution at face value.",
      "created_at" : "2021-06-27T05:00:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-869100855",
      "id" : 869100855,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2OTEwMDg1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-27T05:00:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/869100855",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Okay, I'll show you. Might take me a couple days to get to it.",
      "created_at" : "2021-06-27T05:02:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-869101026",
      "id" : 869101026,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2OTEwMTAyNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-27T05:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/869101026",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/797782?v=4",
         "events_url" : "https://api.github.com/users/whitslack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/whitslack/followers",
         "following_url" : "https://api.github.com/users/whitslack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/whitslack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/whitslack",
         "id" : 797782,
         "login" : "whitslack",
         "node_id" : "MDQ6VXNlcjc5Nzc4Mg==",
         "organizations_url" : "https://api.github.com/users/whitslack/orgs",
         "received_events_url" : "https://api.github.com/users/whitslack/received_events",
         "repos_url" : "https://api.github.com/users/whitslack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/whitslack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/whitslack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/whitslack"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@luke-jr: See #22354.",
      "created_at" : "2021-06-27T19:55:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-869216000",
      "id" : 869216000,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2OTIxNjAwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-27T19:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/869216000",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/797782?v=4",
         "events_url" : "https://api.github.com/users/whitslack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/whitslack/followers",
         "following_url" : "https://api.github.com/users/whitslack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/whitslack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/whitslack",
         "id" : 797782,
         "login" : "whitslack",
         "node_id" : "MDQ6VXNlcjc5Nzc4Mg==",
         "organizations_url" : "https://api.github.com/users/whitslack/orgs",
         "received_events_url" : "https://api.github.com/users/whitslack/received_events",
         "repos_url" : "https://api.github.com/users/whitslack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/whitslack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/whitslack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/whitslack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22354](https://github.com/bitcoin/bitcoin/pull/22354) (contrib/init: (OpenRC) use -startupnotify to wait for startup completion [alternative] by whitslack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-06-28T07:04:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-869416123",
      "id" : 869416123,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2OTQxNjEyMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-03T22:25:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/869416123",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Wouldn't `-daemonwait` help here? This option was added for doing a similar thing for the systemd script, and seems more straightforward.",
      "created_at" : "2021-07-07T10:52:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-875503645",
      "id" : 875503645,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTUwMzY0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T10:52:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875503645",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Wouldn't `-daemonwait` help here? This option was added for doing a similar thing for the systemd script, and seems more straightforward.\r\n\r\n@laanwj: That's the option I was searching for when I started out on this project, as I was certain I'd seen it mentioned in the Bitcoin Optech newsletter, but it's not listed in `--help`, so I abandoned that avenue. Thanks for the pointer.\r\n\r\nThat said, `-daemonwait` won't address @luke-jr's [concern](https://github.com/bitcoin/bitcoin/pull/22285#pullrequestreview-693367825), which I addressed in an alternative way using `-startupnotify` in #22354.",
      "created_at" : "2021-07-07T14:49:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-875669409",
      "id" : 875669409,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTY2OTQwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T14:49:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875669409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/797782?v=4",
         "events_url" : "https://api.github.com/users/whitslack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/whitslack/followers",
         "following_url" : "https://api.github.com/users/whitslack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/whitslack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/whitslack",
         "id" : 797782,
         "login" : "whitslack",
         "node_id" : "MDQ6VXNlcjc5Nzc4Mg==",
         "organizations_url" : "https://api.github.com/users/whitslack/orgs",
         "received_events_url" : "https://api.github.com/users/whitslack/received_events",
         "repos_url" : "https://api.github.com/users/whitslack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/whitslack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/whitslack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/whitslack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  it's not listed in --help, so I abandoned that avenue. Thanks for the pointer.\r\n\r\nAre you sure? It is mentioned in `--help` here:\r\n```\r\n  -daemonwait\r\n       Wait for initialization to be finished before exiting. This implies\r\n       -daemon (default: 0)\r\n```\r\nIt's relatively new, so make sure you check with at least 22.x.",
      "created_at" : "2021-08-16T14:35:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-899562250",
      "id" : 899562250,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "IC_kwDOABII5841njsK",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-16T14:35:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899562250",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> It's relatively new, so make sure you check with at least 22.x.\r\n\r\n@laanwj: Great! I don't run prerelease versions of Bitcoin Core, so I haven't seen it yet.\r\n\r\nNevertheless, naÃ¯vely using `-daemonwait` doesn't seem to be a good option here, as it would delay the completion of OpenRC's switch to the default runlevel at boot and thus will delay `init`'s startup of agetty/login for longer than may be desirable. Perhaps it would be feasible to start `bitcoind` with `-daemonwait` in a backgrounded subshell and call back to OpenRC to mark the service as started after the `bitcoind` launcher process returns to the subshell. That would address @luke-jr's concern without using `-startupnotify`.",
      "created_at" : "2021-08-17T19:33:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22285#issuecomment-900574795",
      "id" : 900574795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22285",
      "node_id" : "IC_kwDOABII5841ra5L",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-17T19:33:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900574795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/797782?v=4",
         "events_url" : "https://api.github.com/users/whitslack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/whitslack/followers",
         "following_url" : "https://api.github.com/users/whitslack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/whitslack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/whitslack",
         "id" : 797782,
         "login" : "whitslack",
         "node_id" : "MDQ6VXNlcjc5Nzc4Mg==",
         "organizations_url" : "https://api.github.com/users/whitslack/orgs",
         "received_events_url" : "https://api.github.com/users/whitslack/received_events",
         "repos_url" : "https://api.github.com/users/whitslack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/whitslack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/whitslack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/whitslack"
      }
   }
]
