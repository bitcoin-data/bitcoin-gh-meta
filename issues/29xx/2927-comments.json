[
   {
      "body" : "If using Bitcoin-Qt make sure to unset the UPnP option. For using bitcoind, I'm looking into a little patch currently.",
      "created_at" : "2013-08-25T11:21:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-23225947",
      "id" : 23225947,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2013-08-25T11:21:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/23225947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@63 Thanks for the report!  A lot of the developers build with UPNP much of the time (or, well, at least I do), unfortunate that this slipped through.\r\n\r\n@Diapolo we should not UPNP if listen=0, and separately, we should not UPNP if onlynet=tor.",
      "created_at" : "2013-08-25T11:52:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-23226338",
      "id" : 23226338,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2013-08-25T11:52:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/23226338",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "As far as I can see, -listen=0 should already disable UPnP by default. Only if you enable it explicitly through -upnp (or upnp=1), or the GUI should it be enabled. If that's not the case, it's a bug.",
      "created_at" : "2013-08-25T14:04:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-23228203",
      "id" : 23228203,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2013-08-25T14:04:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/23228203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa Reproduced in the latest master. \r\n\r\n`bitcoin.conf`:\r\n![](https://f.cloud.github.com/assets/5250052/1040007/00088eb8-0fa8-11e3-8c4c-3322daa47c3b.png)\r\n\r\nactive UPNP mappings on the router: \r\n![](https://f.cloud.github.com/assets/5250052/1040014/3e42dc92-0fa8-11e3-9dc9-da36f90be40a.png)\r\n",
      "created_at" : "2013-08-28T06:09:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-23393408",
      "id" : 23393408,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2013-08-28T06:11:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/23393408",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=3",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "body" : "My reasoning would be that the bind=XXX re-enables listen, and hence upnp is not disabled.\r\n\r\nEdit: does it work if you explicitly add upnp=0 to the config?\r\n",
      "created_at" : "2013-11-07T11:52:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-27956622",
      "id" : 27956622,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2013-11-07T11:53:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27956622",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "If you explicitly set listen to false, bind shouldn't re-enable it.\r\n",
      "created_at" : "2013-11-07T12:30:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-27958594",
      "id" : 27958594,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2013-11-07T12:30:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27958594",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Yes, @laanwj, running with the line \r\n\r\n    upnp=0 \r\n\r\nor compiling without UPNP does work, but logically if we're not `listen`ing it shouldn't be enabled to begin with, right?",
      "created_at" : "2013-11-29T00:55:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-29490948",
      "id" : 29490948,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2013-11-29T00:55:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29490948",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10137?v=3",
         "events_url" : "https://api.github.com/users/ghost/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ghost/followers",
         "following_url" : "https://api.github.com/users/ghost/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ghost/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ghost",
         "id" : 10137,
         "login" : "ghost",
         "organizations_url" : "https://api.github.com/users/ghost/orgs",
         "received_events_url" : "https://api.github.com/users/ghost/received_events",
         "repos_url" : "https://api.github.com/users/ghost/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ghost/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ghost/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ghost"
      }
   },
   {
      "body" : "Guess this needs to be fixed before 0.9 as well.\r\n",
      "created_at" : "2014-01-17T12:25:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-32601568",
      "id" : 32601568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2014-01-17T12:25:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/32601568",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Would this suffice (change in net.cpp)?\r\n\r\n<pre>\r\n    // only map ports when not using Tor\r\n    if (!IsLimited(NET_TOR))\r\n        // Map ports with UPnP\r\n        MapPort(GetBoolArg(\"-upnp\", fDefaultUpnp));\r\n</pre>\r\n\r\nWe already have in init.cpp the check for listen:\r\n<pre>\r\n    if (!GetBoolArg(\"-listen\", true)) {\r\n        // do not map ports or try to retrieve public IP when not listening (pointless)\r\n        SoftSetBoolArg(\"-upnp\", false);\r\n        SoftSetBoolArg(\"-discover\", false);\r\n    }\r\n</pre>",
      "created_at" : "2014-01-17T15:25:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-32614597",
      "id" : 32614597,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2014-01-17T15:25:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/32614597",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Your change would make it impossible to map ports when using Tor.\r\n\r\nThe goal is to make the default (if not overridden using -upnp) to not map ports when using Tor, not to make it completely impossible.\r\n",
      "created_at" : "2014-01-17T15:28:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-32614956",
      "id" : 32614956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2014-01-17T15:30:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/32614956",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I'm out... too many cases to consider for my ill brain ^^.",
      "created_at" : "2014-01-17T15:35:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-32615579",
      "id" : 32615579,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2014-01-17T15:35:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/32615579",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "This appears to have been already solved:\r\n\r\n    if (!GetBoolArg(\"-listen\", true)) {\r\n        // do not map ports or try to retrieve public IP when not listening (pointless)\r\n        if (SoftSetBoolArg(\"-upnp\", false))\r\n    ...\r\n\r\n\r\n",
      "created_at" : "2014-05-11T20:49:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-42782808",
      "id" : 42782808,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2014-05-11T20:49:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42782808",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell well, the problem seems to be that he has a bind:XXX statement (for a hidden service), which re-enables listen so it never goes into that.\r\n",
      "created_at" : "2014-05-12T05:57:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-42798268",
      "id" : 42798268,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2014-05-12T05:57:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42798268",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Foremost, if your goal is to hide completely behind a proxy you should use `-proxy`, not `-tor`. `-tor` is *only* meant for hyrid Tor/clearnet nodes.\r\n\r\nGiven that, see #6153 for fix.",
      "created_at" : "2015-05-18T09:24:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2927#issuecomment-102989530",
      "id" : 102989530,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2927",
      "updated_at" : "2015-05-18T09:24:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/102989530",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
