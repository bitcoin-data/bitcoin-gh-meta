[
   {
      "author_association" : "OWNER",
      "body" : "There have been some modifications to coin selection algorithm, maybe they improve things, see e.g. #4906\n",
      "created_at" : "2015-02-10T11:01:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5782#issuecomment-73681536",
      "id" : 73681536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5782",
      "updated_at" : "2015-02-10T11:01:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73681536",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the link! Unfortunally it doesn't seem to be related, but this issue is certainly something that probably won't appear outside of a testing environment. I created a test for it nevertheless:\n\nhttps://github.com/dexX7/bitcoin/blob/qa-coin-selection-limit/qa/rpc-tests/coinselection_size_limit.py\n\nThe problem is that the coin selection doesn't relate to the transaction size at all. I came up with three scenarios, all failing at the moment:\n\nScenario 1:\n- The actor starts with 1x 50.0 BTC and 1000x 0.05 BTC (100.0 BTC total) unspent outputs\n- Then tries to spend 49.5 BTC\n- The 50.0 BTC output should be selected, because the transaction would otherwise be too large\n\nScenario 2:\n- The actor starts with 500x 0.1 BTC and 1000x 0.05 BTC (100.0 BTC total) unspent outputs\n- Then tries to spend 49.5 BTC\n- A combination of coins should be selected, such that the created transaction is not too large\n\nScenario 3 (available as RPC test):\n- The actor starts with 1x 50.0 BTC, 500x 0.1 BTC and 1000x 0.05 BTC (150.0 BTC total) unspent outputs\n- Then tries to spend 49.5 BTC\n- A combination of coins should be selected, such that the created transaction is not too large\n\nFor each scenario at least one solution exists, where a combination of coins results in a transaction that has a size of less than `MAX_STANDARD_TX_SIZE`.\n",
      "created_at" : "2015-02-11T01:18:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5782#issuecomment-73819058",
      "id" : 73819058,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5782",
      "updated_at" : "2015-02-11T01:18:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73819058",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/5836089?v=4",
         "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dexX7/followers",
         "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dexX7",
         "id" : 5836089,
         "login" : "dexX7",
         "organizations_url" : "https://api.github.com/users/dexX7/orgs",
         "received_events_url" : "https://api.github.com/users/dexX7/received_events",
         "repos_url" : "https://api.github.com/users/dexX7/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dexX7"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is this a duplicate of  #1643?",
      "created_at" : "2018-04-29T13:11:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5782#issuecomment-385250511",
      "id" : 385250511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5782",
      "updated_at" : "2018-04-29T13:11:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385250511",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke: looks like both issues tackle coin selection, while @dooglus' is about minimizing fees, mine is about making sure the transaction creation doesn't fail to begin with. Though optimizing fees also results in small transactions.\r\n\r\nWhat's on top: there isn't a check during coin selection, whether the transaction is still within MAX_STANDARD_TX_SIZE.",
      "created_at" : "2018-04-29T23:25:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5782#issuecomment-385290023",
      "id" : 385290023,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5782",
      "updated_at" : "2018-04-29T23:25:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385290023",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/5836089?v=4",
         "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dexX7/followers",
         "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dexX7",
         "id" : 5836089,
         "login" : "dexX7",
         "organizations_url" : "https://api.github.com/users/dexX7/orgs",
         "received_events_url" : "https://api.github.com/users/dexX7/received_events",
         "repos_url" : "https://api.github.com/users/dexX7/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dexX7"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "From a quick glance, it looks to me that we still not check for the maximum weight during coin selection. So, while the much lighter modern input types make it even less likely that the max weight would be hit and at high feerates we deliberately aim for a small input weight, I don't think that we currently explicitly prevent that outcome during coin selection when it's in the consolidatory feerate range.\r\n\r\nIt would probably be a good first issue to check whether a selection result will be smaller than the maximum weight and to discard a selection result if not. Hopefully the other selection result candidates or a later back-off iteration would find a solution that fits then, but a slightly more involved task could be to add logic that guides coin selection to avoid exceeding the maximum weight if possible.",
      "created_at" : "2022-07-25T15:27:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5782#issuecomment-1194201017",
      "id" : 1194201017,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5782",
      "node_id" : "IC_kwDOABII585HLg-5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1194201017/reactions"
      },
      "updated_at" : "2022-07-25T15:27:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1194201017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   }
]
