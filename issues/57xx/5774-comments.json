[
   {
      "body" : "I don't understand the motivation here.  Rescan should not pointlessly scan blocks prior to key creation times. If there is some reason that creation times are being set incorrectly that must be fixed, not papered over with a bypass in rescan.\r\n\r\nIf you update the patch, please make sure the commit message explains the motivation for the change.",
      "created_at" : "2015-02-08T23:20:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5774#issuecomment-73438883",
      "id" : 73438883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5774",
      "updated_at" : "2015-02-08T23:20:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73438883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I guess there's two issues: the first being I think when someone starts bitcoin with `-rescan` it _should_ scan every block, as that is the safest behaviour and the one of least surprise. \r\n\r\nThe second issue, which I guess is not addressed by this pull request is someone does:\r\n`bitcoin-cli importprivkey $PRIV_KEY \"\" false`\r\n\r\nand then restarts bitcoind (with or without -rescan) it will only start scanning at the earliest key creation time, which may very well be after the key was used. Bitcoin should probably persist something into the wallet letting it know it needs to rescan from block 0, but I'm not familiar enough with the code to do this.",
      "created_at" : "2015-02-08T23:36:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5774#issuecomment-73439781",
      "id" : 73439781,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5774",
      "updated_at" : "2015-02-08T23:37:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73439781",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "As with many wallet behaviors, it is not documented (nor tested) what the behavior should be, so people give their own interpretation what it should be and try to fix it according to that. Not sure how to go forward here as there is clear disagreement.\r\n\r\nI don't think it makes sense to assume the user wants to rescan from block 0 on next restarts, eg people import keys that are newly generated and don't need rescans at all.",
      "created_at" : "2015-02-09T10:12:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5774#issuecomment-73484714",
      "id" : 73484714,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5774",
      "updated_at" : "2015-02-09T10:20:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73484714",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I guess two things to support my interpretation:\r\n\r\n\r\n* If I want to do a full scan (bad address seen date, importing without scanning), right now I'm forced to go `bitcoin-cli importprivkey $RANDOMPRIVKEY` to force the wallet to do a full scan. But `bitcoind -rescan` doesn't work. Strange, no?\r\n\r\n* When running `bitcoind -rescan` the logs even say that it's scanning from the genesis block:\r\nhttps://github.com/bitcoin/bitcoin/blob/425473c056424574f73935add3f110fbce770273/src/init.cpp#L1229\r\nwhich to me would indicate, that the intention of rescan is to actually rescan everything.\r\n\r\n* I believe I might have already lost some coins due to bitcoind's behaviour. My usage pattern has been this:\r\n`bitcoin-cli importprivkey $PRIVKEY1 \"\" false`\r\n`bitcoin-cli importprivkey $PRIVKEY2 \"\" false`\r\n...for all dozens of private keys I have..\r\n\r\nand then finally:\r\n\r\n`bitcoind -rescan`\r\n\r\nThe only reason I caught it this time, was because I knew i was missing a sizable amount of coins.\r\n\r\n\r\n>    I don't think it makes sense to assume the user wants to rescan from block 0 on next restarts eg\r\n>    people import keys that are newly generated and don't need rescans at all.\r\n\r\nThose people don't run with `bitcoind -rescan`\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
      "created_at" : "2015-02-09T14:36:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5774#issuecomment-73518102",
      "id" : 73518102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5774",
      "updated_at" : "2015-02-09T14:36:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73518102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "The -rescan option really shouldn't exist at all.  It mostly only remains as historical inertia.  The ability to run it has a marginal disk cost of 30+GBytes.  Keeping it around has (apparently!) allowed serious birthdate tracking bugs to persist. \r\n\r\nIn any case, the interface is never obligated to perform some behavior which should be indistinguishable from the perspective of the user. I think the behavior you're looking for would be one to wipe out the birthdays, not a change in rescan behavior.",
      "created_at" : "2015-02-09T15:31:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5774#issuecomment-73527880",
      "id" : 73527880,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5774",
      "updated_at" : "2015-02-09T15:32:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/73527880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Agree with @gmaxwell. \r\n\r\n- If you need behavior that clears the birthdays, add an option to clear the birthdays.\r\n- If you need importprivkey to be able to set the birthday for your imported key, add an argument to importprivkey with the birthdate. This makes it possible to distinguish importing a new key and an old key, and tells the client *from when* to rescan\r\n\r\nWe're not trying to deny that there is an issue here. Right now importprivkey is ambiguous. We just don't agree on this fix.",
      "created_at" : "2015-02-18T12:18:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5774#issuecomment-74855233",
      "id" : 74855233,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5774",
      "updated_at" : "2015-02-18T12:19:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/74855233",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
