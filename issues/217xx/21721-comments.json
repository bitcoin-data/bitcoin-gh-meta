[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "A further observation on MTP & period drift:\r\n\r\nSuppose I have release A which is start = today, stop = 3 years, height = start + 6 years blocks nomando noflagday.\r\n\r\nSuppose i have release B which is start = today, stop = 3 years - 2 periods expected time, height = start + 6 years blocks flagday mando\r\n\r\nI chose years to pick something where there could be a large amount of drift, because the effect is essentially duration invariant.\r\n\r\nBecause of difficulty adjustments and such, the 2 periods expected time, as set today 3 years from when it will actually be looked at, should always almost certainly guarantee that B's transition to mandatory signalling happens in at least one signalling period before the other activates.\r\n\r\nAssume that height is not yet reached and timeout hits:\r\nclients proceed in full consensus.\r\n\r\nAssume that height is already reached and timeout hits:\r\nWhat happens in this case is that B transitions to LOCKED_IN for 1 period of mandatory signalling, and in the next period proceeds to Active. The users of client A transition to LOCKED_IN 1 period later, and then Active 1 period later.\r\n\r\nThis means that miners for 1 signalling period would be SPV mining as the rule is yet to be active (policy protects them here).\r\n\r\nHowever, this is still relatively safe because of A miners to be on the chain that activated via B would still require B to have a majority of hashrate.\r\n\r\nTo modify this to be always in perfect lock step with A (and no handwave about SPV mining for just one period), OnTimeout could be modified to emit a MANDATORY_SIGNAL period before LOCKED_IN, so that A and B hit locked_in at the same time.\r\n\r\n",
      "created_at" : "2021-04-18T02:22:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21721#issuecomment-821918984",
      "id" : 821918984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21721",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTkxODk4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-18T02:22:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821918984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this is better discussed on the mailing list; the code doesn't seem like it adds much over saying \"imagine we have flag to say timeout switches to ACTIVE independently of signalling, and make signalling mandatory for every block in LOCKED_IN\" ?",
      "created_at" : "2021-04-18T03:15:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21721#issuecomment-821923592",
      "id" : 821923592,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21721",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTkyMzU5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-18T03:15:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821923592",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Sure; more than happy to close.\r\n\r\nMostly useful to open here -- regardless of where discussion should take place -- as the mailing list is non-ideal for looking at patches. I've just seen it claimed that such a patch was not possible in some places, so I wanted to create a concrete example to point to.\r\n\r\nI don't intend to open a mailing list discussion on this but if someone else does feel free to refer.",
      "created_at" : "2021-04-18T03:31:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21721#issuecomment-821924938",
      "id" : 821924938,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21721",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTkyNDkzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-18T03:31:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821924938",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   }
]
