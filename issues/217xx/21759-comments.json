[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @Xekyo for explaining all the stuffs to me",
      "created_at" : "2021-04-22T20:52:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#issuecomment-825177430",
      "id" : 825177430,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21759",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNTE3NzQzMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-22T20:52:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/825177430",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21359 (rpc: include_unsafe option for fundrawtransaction by t-bast)\n* #21207 (MOVEONLY: CWallet transaction code out of wallet.cpp/.h by ryanofsky)\n* #21206 (refactor: Make CWalletTx sync state type-safe by ryanofsky)\n* #17526 (Use Single Random Draw In addition to knapsack as coin selection fallback by achow101)\n* #17331 (Use effective values throughout coin selection by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-04-22T21:06:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#issuecomment-825185887",
      "id" : 825185887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21759",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNTE4NTg4Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-26T15:51:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/825185887",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, great job.",
      "created_at" : "2021-04-23T11:22:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#issuecomment-825590789",
      "id" : 825590789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21759",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNTU5MDc4OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-23T11:22:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/825590789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/58662979?v=4",
         "events_url" : "https://api.github.com/users/kiminuo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kiminuo/followers",
         "following_url" : "https://api.github.com/users/kiminuo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kiminuo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kiminuo",
         "id" : 58662979,
         "login" : "kiminuo",
         "node_id" : "MDQ6VXNlcjU4NjYyOTc5",
         "organizations_url" : "https://api.github.com/users/kiminuo/orgs",
         "received_events_url" : "https://api.github.com/users/kiminuo/received_events",
         "repos_url" : "https://api.github.com/users/kiminuo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kiminuo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kiminuo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620225230"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620225230"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this may be slightly more clear:\r\n```suggestion\r\n    /** Maximum number of unconfirmed ancestors aggregated across all UTXOs in an OutputGroup. */\r\n```",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T11:54:14Z",
      "diff_hunk" : "@@ -56,31 +57,58 @@ class CInputCoin {\n     }\n };\n \n+/** Parameters for filtering which OutputGroups we may use in coin selection.\n+ * We start by being very selective and requiring multiple confirmations and\n+ * then get more permissive if we cannot fund the transaction. */\n struct CoinEligibilityFilter\n {\n+    /** Minimum number of confirmations for outputs that we sent to ourselves.\n+     * We may use unconfirmed UTXOs sent from ourselves, e.g. change outputs. */\n     const int conf_mine;\n+    /** Minimum number of confirmations for outputs received from a different\n+     * wallet. We never spend unconfirmed foreign outputs as we cannot rely on these funds yet. */\n     const int conf_theirs;\n+    /** Maximum number of total unconfirmed ancestors for all UTXOs in the OutputGroup. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620225230",
      "id" : 620225230,
      "line" : 71,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDIyNTIzMA==",
      "original_commit_id" : "b74797a5e365665081074a39803bbc973f18f1a9",
      "original_line" : 71,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 23,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620225230",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620226932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620226932"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n     * least a certain number of confirmations on UTXOs received from outside wallets while trusting\r\n```\r\n",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T11:56:46Z",
      "diff_hunk" : "@@ -56,31 +57,58 @@ class CInputCoin {\n     }\n };\n \n+/** Parameters for filtering which OutputGroups we may use in coin selection.\n+ * We start by being very selective and requiring multiple confirmations and\n+ * then get more permissive if we cannot fund the transaction. */\n struct CoinEligibilityFilter\n {\n+    /** Minimum number of confirmations for outputs that we sent to ourselves.\n+     * We may use unconfirmed UTXOs sent from ourselves, e.g. change outputs. */\n     const int conf_mine;\n+    /** Minimum number of confirmations for outputs received from a different\n+     * wallet. We never spend unconfirmed foreign outputs as we cannot rely on these funds yet. */\n     const int conf_theirs;\n+    /** Maximum number of total unconfirmed ancestors for all UTXOs in the OutputGroup. */\n     const uint64_t max_ancestors;\n+    /** Maximum number of descendants that a single UTXO in the OutputGroup may have. */\n     const uint64_t max_descendants;\n-    const bool m_include_partial_groups{false}; //! Include partial destination groups when avoid_reuse and there are full groups\n+    /** When avoid_reuse=true and there are full groups (OUTPUT_GROUP_MAX_ENTRIES), whether or not to use any partial groups.*/\n+    const bool m_include_partial_groups{false};\n \n     CoinEligibilityFilter(int conf_mine, int conf_theirs, uint64_t max_ancestors) : conf_mine(conf_mine), conf_theirs(conf_theirs), max_ancestors(max_ancestors), max_descendants(max_ancestors) {}\n     CoinEligibilityFilter(int conf_mine, int conf_theirs, uint64_t max_ancestors, uint64_t max_descendants) : conf_mine(conf_mine), conf_theirs(conf_theirs), max_ancestors(max_ancestors), max_descendants(max_descendants) {}\n     CoinEligibilityFilter(int conf_mine, int conf_theirs, uint64_t max_ancestors, uint64_t max_descendants, bool include_partial) : conf_mine(conf_mine), conf_theirs(conf_theirs), max_ancestors(max_ancestors), max_descendants(max_descendants), m_include_partial_groups(include_partial) {}\n };\n \n+/** A group of UTXOs paid to the same output script. */\n struct OutputGroup\n {\n+    /** The list of UTXOs contained in this output group. */\n     std::vector<CInputCoin> m_outputs;\n+    /** Whether the UTXOs were sent by the wallet to itself. This is relevant because we may want at\n+     * least certain number of confirmations on UTXOs received from outside wallets while trusting",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620226932",
      "id" : 620226932,
      "line" : 89,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDIyNjkzMg==",
      "original_commit_id" : "b74797a5e365665081074a39803bbc973f18f1a9",
      "original_line" : 89,
      "original_position" : 42,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 42,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620226932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620232979"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620232979"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Since this is a patch to master, I think `use_bnb` still means \"only use BnB\". The try BnB first and then fall back to knapsack behavior gets introduced by #17331.\r\n```suggestion\r\n    /** Toggles use of the Branch and Bound coin selection algorithm instead of the knapsack solver. */\r\n```",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T12:06:18Z",
      "diff_hunk" : "@@ -604,17 +612,28 @@ class COutput\n     }\n };\n \n+/** Parameters for one iteration of Coin Selection. */\n struct CoinSelectionParams\n {\n+    /** When true, try to use the Branch and Bound algorithm before falling back to knapsack. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620232979",
      "id" : 620232979,
      "line" : 618,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDIzMjk3OQ==",
      "original_commit_id" : "b74797a5e365665081074a39803bbc973f18f1a9",
      "original_line" : 618,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 68,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620232979",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620240972"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620240972"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Mh, this one is a bit more subtle. How about:\r\n```suggestion\r\n    /** The feerate used to estimate an upper bound on what should be sufficient to spend the change output some time in the future. */",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T12:17:51Z",
      "diff_hunk" : "@@ -604,17 +612,28 @@ class COutput\n     }\n };\n \n+/** Parameters for one iteration of Coin Selection. */\n struct CoinSelectionParams\n {\n+    /** When true, try to use the Branch and Bound algorithm before falling back to knapsack. */\n     bool use_bnb = true;\n+    /** Size of a change output in bytes, determined by the output type. */\n     size_t change_output_size = 0;\n+    /** Size of the input to spend a change output in virtual bytes. */\n     size_t change_spend_size = 0;\n+    /** The targeted feerate of the transaction being built. */\n     CFeeRate m_effective_feerate;\n+    /** The feerate estimate used to calculate the upper bound of the cost to spend a change output. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620240972",
      "id" : 620240972,
      "line" : 626,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDI0MDk3Mg==",
      "original_commit_id" : "b74797a5e365665081074a39803bbc973f18f1a9",
      "original_line" : 626,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 76,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620240972",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620245335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620245335"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "How about\r\n```suggestion\r\n    /** Size of the transaction before coin selection, consisting of the header and recipient outputs and excluding inputs and change output(s). */\r\n```",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T12:24:02Z",
      "diff_hunk" : "@@ -604,17 +612,28 @@ class COutput\n     }\n };\n \n+/** Parameters for one iteration of Coin Selection. */\n struct CoinSelectionParams\n {\n+    /** When true, try to use the Branch and Bound algorithm before falling back to knapsack. */\n     bool use_bnb = true;\n+    /** Size of a change output in bytes, determined by the output type. */\n     size_t change_output_size = 0;\n+    /** Size of the input to spend a change output in virtual bytes. */\n     size_t change_spend_size = 0;\n+    /** The targeted feerate of the transaction being built. */\n     CFeeRate m_effective_feerate;\n+    /** The feerate estimate used to calculate the upper bound of the cost to spend a change output. */\n     CFeeRate m_long_term_feerate;\n+    /** If the cost to spend a change output at the discard feerate exceeds its value, drop it to fees. */\n     CFeeRate m_discard_feerate;\n+    /** Size of the transaction before inputs are selected, the header and recipient output(s). */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620245335",
      "id" : 620245335,
      "line" : 630,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDI0NTMzNQ==",
      "original_commit_id" : "b74797a5e365665081074a39803bbc973f18f1a9",
      "original_line" : 630,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 80,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620245335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620247643"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620247643"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n     * all coins from coin_control are selected; never select unconfirmed coins if they are not ours.\r\n```",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T12:27:14Z",
      "diff_hunk" : "@@ -753,8 +776,11 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n \n     /**\n      * Select a set of coins such that nValueRet >= nTargetValue and at least\n-     * all coins from coinControl are selected; Never select unconfirmed coins\n-     * if they are not ours\n+     * all coins from coin_ontrol are selected; Never select unconfirmed coins if they are not ours",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620247643",
      "id" : 620247643,
      "line" : 779,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDI0NzY0Mw==",
      "original_commit_id" : "b74797a5e365665081074a39803bbc973f18f1a9",
      "original_line" : 779,
      "original_position" : 70,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 147,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620247643",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620249485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620249485"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n   /** If the cost to spend a change output at this feerate is greater than the value of the output\r\n```",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T12:29:49Z",
      "diff_hunk" : "@@ -1025,7 +1064,12 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n      * Override with -fallbackfee\n      */\n     CFeeRate m_fallback_fee{DEFAULT_FALLBACK_FEE};\n+\n+    /** If the cost to spend a change output at this rate is greater than the value of the output",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620249485",
      "id" : 620249485,
      "line" : 1068,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDI0OTQ4NQ==",
      "original_commit_id" : "b74797a5e365665081074a39803bbc973f18f1a9",
      "original_line" : 1068,
      "original_position" : 124,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 213,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620249485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620253129"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620253129"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "\"at a target value and feerate\" sounds a bit odd to me. Maybe:\r\n```suggestion\r\n    // Coin Selection attempts to select inputs from a pool of eligible UTXOs to fund the\r\n    // transaction at a target feerate. If an attempt fails, more attempts may be made\r\n    // using a more permissive CoinEligibilityFilter.\r\n```",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T12:34:39Z",
      "diff_hunk" : "@@ -2502,16 +2502,53 @@ bool CWallet::SelectCoins(const std::vector<COutput>& vAvailableCoins, const CAm\n         // explicitly shuffling the outputs before processing\n         Shuffle(vCoins.begin(), vCoins.end(), FastRandomContext());\n     }\n-    bool res = value_to_select <= 0 ||\n-        SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(1, 6, 0), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used) ||\n-        SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(1, 1, 0), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used) ||\n-        (m_spend_zero_conf_change && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, 2), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) ||\n-        (m_spend_zero_conf_change && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, std::min((size_t)4, max_ancestors/3), std::min((size_t)4, max_descendants/3)), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) ||\n-        (m_spend_zero_conf_change && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, max_ancestors/2, max_descendants/2), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) ||\n-        (m_spend_zero_conf_change && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, max_ancestors-1, max_descendants-1, true /* include_partial_groups */), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) ||\n-        (m_spend_zero_conf_change && !fRejectLongChains && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, std::numeric_limits<uint64_t>::max(), std::numeric_limits<uint64_t>::max(), true /* include_partial_groups */), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used));\n \n-    // because SelectCoinsMinConf clears the setCoinsRet, we now add the possible inputs to the coinset\n+    // Coin Selection attempts to select inputs from a pool of eligible UTXOs to fund the\n+    // transaction at a target value and feerate. If an attempt fails, more attempts may be made\n+    // using a more permissive CoinEligibilityFilter.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620253129",
      "id" : 620253129,
      "line" : 2508,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDI1MzEyOQ==",
      "original_commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "original_line" : 2508,
      "original_position" : 38,
      "original_start_line" : 2506,
      "path" : "src/wallet/wallet.cpp",
      "position" : 38,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : 2506,
      "start_side" : "RIGHT",
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620253129",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620261467"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620261467"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Reviewers note that each `SelectCoinsMinConf` call here shares the same parameters except for differing `CoinEligibilityFilter`s.",
      "commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "created_at" : "2021-04-26T12:46:07Z",
      "diff_hunk" : "@@ -2502,16 +2502,53 @@ bool CWallet::SelectCoins(const std::vector<COutput>& vAvailableCoins, const CAm\n         // explicitly shuffling the outputs before processing\n         Shuffle(vCoins.begin(), vCoins.end(), FastRandomContext());\n     }\n-    bool res = value_to_select <= 0 ||\n-        SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(1, 6, 0), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used) ||\n-        SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(1, 1, 0), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used) ||\n-        (m_spend_zero_conf_change && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, 2), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) ||\n-        (m_spend_zero_conf_change && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, std::min((size_t)4, max_ancestors/3), std::min((size_t)4, max_descendants/3)), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) ||\n-        (m_spend_zero_conf_change && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, max_ancestors/2, max_descendants/2), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) ||\n-        (m_spend_zero_conf_change && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, max_ancestors-1, max_descendants-1, true /* include_partial_groups */), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) ||\n-        (m_spend_zero_conf_change && !fRejectLongChains && SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(0, 1, std::numeric_limits<uint64_t>::max(), std::numeric_limits<uint64_t>::max(), true /* include_partial_groups */), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used));\n \n-    // because SelectCoinsMinConf clears the setCoinsRet, we now add the possible inputs to the coinset\n+    // Coin Selection attempts to select inputs from a pool of eligible UTXOs to fund the\n+    // transaction at a target value and feerate. If an attempt fails, more attempts may be made\n+    // using a more permissive CoinEligibilityFilter.\n+    const bool res = [&] {\n+        // Pre-selected inputs already cover the target amount.\n+        if (value_to_select <= 0) return true;\n+\n+        // If possible, fund the transaction with confirmed UTXOs only. Prefer at least six\n+        // confirmations on outputs received from other wallets and only spend confirmed change.\n+        if (SelectCoinsMinConf(value_to_select, CoinEligibilityFilter(1, 6, 0), vCoins, setCoinsRet, nValueRet, coin_selection_params, bnb_used)) return true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#discussion_r620261467",
      "id" : 620261467,
      "line" : 2515,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDI2MTQ2Nw==",
      "original_commit_id" : "25d8a0be62f3ee821178da51633bc38b97ce84b4",
      "original_line" : 2515,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 45,
      "pull_request_review_id" : 644580944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21759",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T12:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620261467",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @Xekyo, took all suggestions",
      "created_at" : "2021-04-26T18:03:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#issuecomment-827039385",
      "id" : 827039385,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21759",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNzAzOTM4NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-26T18:03:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/827039385",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ReACK https://github.com/bitcoin/bitcoin/commit/6ba892126d354219b146f0c7f35d472f9c14bdac\r\n\r\nLGTM, @achow101, did we get this right?",
      "created_at" : "2021-04-26T18:28:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#issuecomment-827054251",
      "id" : 827054251,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21759",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNzA1NDI1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-26T18:28:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/827054251",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 6ba892126d354219b146f0c7f35d472f9c14bdac",
      "created_at" : "2021-04-26T18:35:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21759#issuecomment-827058482",
      "id" : 827058482,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21759",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNzA1ODQ4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-26T18:35:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/827058482",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
