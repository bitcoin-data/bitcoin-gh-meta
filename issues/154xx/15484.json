{
   "active_lock_reason" : "resolved",
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "<!-- This issue tracker is only for technical issues related to Bitcoin Core.\r\n\r\nGeneral bitcoin questions and/or support requests are best directed to the Bitcoin StackExchange at https://bitcoin.stackexchange.com.\r\n\r\nFor reporting security issues, please read instructions at https://bitcoincore.org/en/contact/.\r\n\r\nIf the node is \"stuck\" during sync or giving \"block checksum mismatch\" errors, please ensure your hardware is stable by running memtest and observe CPU temperature with a load-test tool such as linpack before creating an issue! -->\r\n\r\n<!-- Describe the issue -->\r\nI run several Bitcoin nodes on Amazon EC2 and notice some of them stop making feeler connections after a while.\r\nI checked the debug.log of the nodes and see that \"Potential stale tip detected, will try using extra outbound peer\" messages are printed out frequently, up to 10+ per day. \r\nThe messages appear more frequently when the feeler connections disappear. \r\n<!--- What behavior did you expect? -->\r\nI expect the nodes still make feeler connections in between events of the 9th outgoing connection made because of the stale tip. \r\nI presume SetTryNewOutboundPeer() incorrectly set the flags somewhere so that fFeeler is always false.\r\n<!--- What was the actual behavior (provide screenshots if the issue is GUI-related)? -->\r\n\r\n<!--- How reliably can you reproduce the issue, what are the steps to do so? -->\r\nThe problem happens naturally for some nodes after running 20-30 days. \r\nAll nodes are running Bitcoin core 0.17.0 by default non-stop on Ubuntu 18.04 LTS and with some minimal logging messages I added myself.  \r\nI tried to restart one node and the problem is gone. I guess because outgoing peers have been chosen again when node restarts.\r\n\r\n<!-- What version of Bitcoin Core are you using, where did you get it (website, self-compiled, etc)? -->\r\n\r\n<!-- What type of machine are you observing the error on (OS/CPU and disk type)? -->\r\n\r\n<!-- For the GUI-related issue on Linux provide names and versions of a distro, a desktop environment and a graphical shell (if relevant). -->\r\n\r\n<!-- Any extra information that might be useful in the debugging process. -->\r\n<!--- This is normally the contents of a `debug.log` or `config.log` file. Raw text or a link to a pastebin type site are preferred. -->",
   "closed_at" : "2020-10-20T14:50:49Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
      "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
      "followers_url" : "https://api.github.com/users/fanquake/followers",
      "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/fanquake",
      "id" : 863730,
      "login" : "fanquake",
      "node_id" : "MDQ6VXNlcjg2MzczMA==",
      "organizations_url" : "https://api.github.com/users/fanquake/orgs",
      "received_events_url" : "https://api.github.com/users/fanquake/received_events",
      "repos_url" : "https://api.github.com/users/fanquake/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/fanquake"
   },
   "comments" : 11,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15484/comments",
   "created_at" : "2019-02-26T13:40:27Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15484/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/15484",
   "id" : 414616404,
   "labels" : [
      {
         "color" : "006b75",
         "default" : false,
         "description" : null,
         "id" : 98298007,
         "name" : "P2P",
         "node_id" : "MDU6TGFiZWw5ODI5ODAwNw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15484/labels{/name}",
   "locked" : true,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU0MTQ2MTY0MDQ=",
   "number" : 15484,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15484/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "state_reason" : "completed",
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15484/timeline",
   "title" : "No feeler connection is made when our tip is stale",
   "updated_at" : "2022-02-15T10:48:14Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15484",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/3724433?v=4",
      "events_url" : "https://api.github.com/users/muoitranduc/events{/privacy}",
      "followers_url" : "https://api.github.com/users/muoitranduc/followers",
      "following_url" : "https://api.github.com/users/muoitranduc/following{/other_user}",
      "gists_url" : "https://api.github.com/users/muoitranduc/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/muoitranduc",
      "id" : 3724433,
      "login" : "muoitranduc",
      "node_id" : "MDQ6VXNlcjM3MjQ0MzM=",
      "organizations_url" : "https://api.github.com/users/muoitranduc/orgs",
      "received_events_url" : "https://api.github.com/users/muoitranduc/received_events",
      "repos_url" : "https://api.github.com/users/muoitranduc/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/muoitranduc/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/muoitranduc/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/muoitranduc"
   }
}
