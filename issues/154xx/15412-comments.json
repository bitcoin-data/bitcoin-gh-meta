[
   {
      "author_association" : "NONE",
      "body" : "It looks like the error is because the first input param to ```getblockstats``` get passed to ```ParseNonRFCJSONValue``` regardless if its a string (which shouldn't happen since that is valid in RFC4627 spec). This is also why the ```'\"<hash>\"'``` works, because it is considered invalid. \r\n\r\nThe issue lies in the check in ```client.cpp``` always returning true when searching ```vRPCConvertParams```. AFAIK this table is only used by bitcoin-cli and the GUI debug console\r\n\r\nI can think of solution whereby the call is changed from ```getblockstats <hash/height>```  to ```getblockstats <hash> <height>``` where height is the overriding input. However, that seems to be overkill since it's specifically a problem when calling via bitcoin-cli and the GUI debug console but would break backward compatibility. \r\n\r\nHappy to get some help in thinking of a better answer , but perhaps better parsing of the args is a preferred solution?",
      "created_at" : "2019-02-16T09:14:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15412#issuecomment-464321604",
      "id" : 464321604,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2NDMyMTYwNA==",
      "updated_at" : "2019-02-16T09:14:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/464321604",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/9293647?v=4",
         "events_url" : "https://api.github.com/users/IlyasRidhuan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/IlyasRidhuan/followers",
         "following_url" : "https://api.github.com/users/IlyasRidhuan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/IlyasRidhuan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/IlyasRidhuan",
         "id" : 9293647,
         "login" : "IlyasRidhuan",
         "node_id" : "MDQ6VXNlcjkyOTM2NDc=",
         "organizations_url" : "https://api.github.com/users/IlyasRidhuan/orgs",
         "received_events_url" : "https://api.github.com/users/IlyasRidhuan/received_events",
         "repos_url" : "https://api.github.com/users/IlyasRidhuan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/IlyasRidhuan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/IlyasRidhuan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/IlyasRidhuan"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There is no solution to this. `bitcoin-cli` parses some arguments as JSON, and some as strings. As a numeric argument is permitted, it has to be JSON here. That also implies that if you want to pass a string, you need to write it as a JSON string. To make what you're asking for work, `bitcoin-cli` would need to somehow recognize that specifically for `getblockstats` if the argument looks like a hash, it is in fact a string and not JSON.\r\n\r\nIt's probably better to have a separate `getblockstatsbyhash` RPC.\r\n\r\n",
      "created_at" : "2019-02-16T09:41:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15412#issuecomment-464325422",
      "id" : 464325422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2NDMyNTQyMg==",
      "updated_at" : "2019-02-16T09:41:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/464325422",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa do you think there would be a big downside if bitcoin-cli just stopped throwing \"Error parsing JSON\" errors and instead passed any argument that didn't parse as JSON as a literal string?",
      "created_at" : "2019-02-19T14:58:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15412#issuecomment-465162901",
      "id" : 465162901,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2NTE2MjkwMQ==",
      "updated_at" : "2019-02-19T15:51:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/465162901",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can't we just threat the argument as non-json string (no conversion) and parse the number/hash in the `getblockstats` call code?",
      "created_at" : "2019-02-20T06:00:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15412#issuecomment-465436871",
      "id" : 465436871,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2NTQzNjg3MQ==",
      "updated_at" : "2019-02-20T06:00:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/465436871",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Can't we just threat the argument as non-json string (no conversion) and parse the number/hash in the `getblockstats` call code?\r\n\r\nYes, but this seems like an inferior solution. My suggestion which would _simplify_ bitcoin-cli logic (just eliminating the exception on UniValue::read failure), where this would complicate the server side logic. Also, my suggestion could be general and work for any argument, where this require new code to be written for individual arguments.\r\n\r\nAlso, you didn't say what heuristic you would use to distinguish hash strings from height strings like `\"10000\"`. Maybe it is just checking string length. But any heuristic you wanted to use server side wouldn't be as good as the one I was suggesting client-side, because the server doesn't know the context of the call, so will make things jankier for clients other than `bitcoin-cli`. For example, if you're using python client right now, numbers are always treated as heights, strings are always treated as hashes. But with a server side check, some python strings would have to start being treated as heights and result in weird errors or return values.",
      "created_at" : "2019-02-20T11:27:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15412#issuecomment-465536159",
      "id" : 465536159,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2NTUzNjE1OQ==",
      "updated_at" : "2019-02-20T11:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/465536159",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Now that exactly one type has to be specified in the help via `RPCArg`, this is hopefully the only inconsistency we will ever see.\r\n\r\n@ryanofsky Mind to create a pull, so we can test this?",
      "created_at" : "2019-02-20T14:17:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15412#issuecomment-465593158",
      "id" : 465593158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2NTU5MzE1OA==",
      "updated_at" : "2019-02-20T14:17:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/465593158",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @ryanofsky Mind to create a pull, so we can test this?\r\n\r\nCreated #15448. This would also allow removing the ParseNonRFCJSONValue function.",
      "created_at" : "2019-02-20T15:19:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15412#issuecomment-465621887",
      "id" : 465621887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2NTYyMTg4Nw==",
      "updated_at" : "2019-02-20T15:19:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/465621887",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
