[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The 10% figure is extremely worrisome, I wonder how much of it is due to people copy and pasting configuration guides from the internet?  (e.g. https://ma.ttias.be/enable-the-rpc-json-api-with-password-authentication-in-bitcoin-core/  )\r\n\r\nIt is somewhat unfortunate because exposing rpcbind to a local, physically secure network or via things like wireguard  are both fairly reasonable things to do.\r\n\r\nPerhaps renaming the option to something like  insecurerpcbind= might be effective?\r\n\r\nAlternatively, one could add an unauthenticated command \"shutdown\" to the rpc that allows a remote party to trigger the node to turn off and refuse to restart (e.g. creating a file called YOUR_RPC_PORT_IS_NOT_SECURE and refusing to start while that file exists) whenever a wildcard rpcbind is used, so if you fail to secure it at least some whitehat could come cleanly shut you off before something worse happens...\r\n\r\nOr, for a less nuclear alternative, instead of shutting down: triggering a periodic error log (and rpc status warning)   \"ERROR: Your RPC is not secured against connections from <triggering IP>.\"\r\n\r\n",
      "created_at" : "2020-02-10T03:30:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18105#issuecomment-583940583",
      "id" : 583940583,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18105",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4Mzk0MDU4Mw==",
      "updated_at" : "2020-02-10T06:48:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583940583",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think this has been solved by luke in #14532 , no?\r\n\r\nWhat versions of Bitcoin Core are the 10% running?",
      "created_at" : "2020-02-10T13:11:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18105#issuecomment-584115181",
      "id" : 584115181,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18105",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDExNTE4MQ==",
      "updated_at" : "2020-02-10T13:11:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584115181",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@MarcoFalke \r\n\r\n```\r\n99  User Agent: /Satoshi:0.18.0/\r\n84  User Agent: /Satoshi:0.17.1/\r\n38  User Agent: /Satoshi:0.18.1/\r\n19  User Agent: /Satoshi:0.19.0.1/\r\n15  User Agent: /Satoshi:0.18.99/\r\n2   User Agent: /Satoshi:0.19.99/\r\n```\r\n\r\nFiltered for just modern versions. #14532 makes it harder to misconfigure, granted.\r\n\r\n",
      "created_at" : "2020-02-10T14:13:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18105#issuecomment-584141689",
      "id" : 584141689,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18105",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDE0MTY4OQ==",
      "updated_at" : "2020-02-10T14:17:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584141689",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/60858013?v=4",
         "events_url" : "https://api.github.com/users/wpeckr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wpeckr/followers",
         "following_url" : "https://api.github.com/users/wpeckr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wpeckr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wpeckr",
         "id" : 60858013,
         "login" : "wpeckr",
         "node_id" : "MDQ6VXNlcjYwODU4MDEz",
         "organizations_url" : "https://api.github.com/users/wpeckr/orgs",
         "received_events_url" : "https://api.github.com/users/wpeckr/received_events",
         "repos_url" : "https://api.github.com/users/wpeckr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wpeckr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wpeckr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wpeckr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@wpeckr Thanks a lot for opening this issue.  If 10% of our public node users are exposing their RPC port we're doing something wrong :)\r\n\r\nThis is something I've been worried about for quite a while (recent examples: https://github.com/bitcoin/bitcoin/pull/17156#issuecomment-579364107 + https://github.com/bitcoin/bitcoin/issues/17742#issuecomment-565632396 + correspondence with `security@` when reporting various RPC issues (incl. pre-auth)).\r\n\r\nGood to finally have this quantified: that helps getting the appropriate level of attention to the issue :)\r\n\r\nMay I ask what data source you used to arrive at that the 10% figure? It would be nice to have a public reference to point to in RPC security discussions.\r\n\r\nAlso, if anyone has aggregated [`zmap`](https://github.com/zmap/zmap) or [`masscan`](https://github.com/robertdavidgraham/masscan) results for portscans for a.) port 8333 vs. b.) port 8332 (RPC port) would be very interesting too.\r\n\r\n",
      "created_at" : "2020-02-10T15:20:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18105#issuecomment-584173897",
      "id" : 584173897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18105",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDE3Mzg5Nw==",
      "updated_at" : "2020-02-10T16:40:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584173897",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Unless you want to do it yourself, you're stuck with finding someone who has `massscan` results you can filter, so it's hard to reference a distinct and repeatable source. [shodan.io ](https://shodan.io/)is typically a useful resource for this sort of thing, but the information about port `8332` in particular is very poor and obviously incomplete. \r\n\r\n![Screenshot_2020-02-10 port 8332 - Shodan Search](https://user-images.githubusercontent.com/60858013/74201410-93986c00-4c61-11ea-870c-3bbee5b35fbd.png)\r\n\r\n----\r\n\r\nDigging around, there's a rather unfortunate number of high ranking google results with very incorrect information about how the interface works, and giving poor advice about it. These date from after #14532, so as a response to the restriction being added people have made instructions to work around it. \r\n\r\n* https://ma.ttias.be/enable-the-rpc-json-api-with-password-authentication-in-bitcoin-core/\r\n\r\n     Tells users how to set `rpcallowedips` to wildcard. \r\n\r\n* https://bitcoin.stackexchange.com/questions/87943/unable-to-bind-any-endpoint-for-rpc-server\r\n  \r\n    The same. \r\n\r\n* https://www.dosystemsinc.com/blog/full-node-installation\r\n\r\n    The same.\r\n\r\nand so forth.",
      "created_at" : "2020-02-11T00:08:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18105#issuecomment-584420316",
      "id" : 584420316,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18105",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDQyMDMxNg==",
      "updated_at" : "2020-02-11T00:08:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584420316",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/60858013?v=4",
         "events_url" : "https://api.github.com/users/wpeckr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wpeckr/followers",
         "following_url" : "https://api.github.com/users/wpeckr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wpeckr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wpeckr",
         "id" : 60858013,
         "login" : "wpeckr",
         "node_id" : "MDQ6VXNlcjYwODU4MDEz",
         "organizations_url" : "https://api.github.com/users/wpeckr/orgs",
         "received_events_url" : "https://api.github.com/users/wpeckr/received_events",
         "repos_url" : "https://api.github.com/users/wpeckr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wpeckr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wpeckr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wpeckr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "One potential solution mentioned would be to allow only a `/24` for `allowedips`, which would cut the amount of access down significantly and allow for use cases like internally routing with a VPN. This doesn't completely mitigate the issue of binding the socket globally however, as there's still pre-auth pre-check attack surface. ",
      "created_at" : "2020-02-11T00:14:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18105#issuecomment-584421761",
      "id" : 584421761,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18105",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDQyMTc2MQ==",
      "updated_at" : "2020-02-11T00:14:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584421761",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/60858013?v=4",
         "events_url" : "https://api.github.com/users/wpeckr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wpeckr/followers",
         "following_url" : "https://api.github.com/users/wpeckr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wpeckr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wpeckr",
         "id" : 60858013,
         "login" : "wpeckr",
         "node_id" : "MDQ6VXNlcjYwODU4MDEz",
         "organizations_url" : "https://api.github.com/users/wpeckr/orgs",
         "received_events_url" : "https://api.github.com/users/wpeckr/received_events",
         "repos_url" : "https://api.github.com/users/wpeckr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wpeckr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wpeckr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wpeckr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> remove or restrict rpcbind\r\n\r\n>The rpcbind option should either be restricted to allow for only single definitions of a host, or removed entirely to only permit binding to localhost for the management interface.\r\n\r\nI find these suggestions about RESTRICTING interesting especially after reading your comments in the only 2 pull requests that you have reviewed in this repository.\r\n\r\n> Filtered for just modern versions. #14532 makes it harder to misconfigure, granted.\r\n\r\nIf some user can use a wrong configuration based on his research, we can't really do much about it. Maybe document it in security best practices?",
      "created_at" : "2022-01-09T05:28:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18105#issuecomment-1008233512",
      "id" : 1008233512,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18105",
      "node_id" : "IC_kwDOABII5848GGwo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1008233512/reactions"
      },
      "updated_at" : "2022-01-09T05:29:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1008233512",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   }
]
