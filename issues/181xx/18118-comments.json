[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Your link is code that compares the blockchain database to the system's local clock at startup as the database is connected and before any nodes are contacted. I don't see how it relates to your comment.",
      "created_at" : "2020-02-11T13:15:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18118#issuecomment-584628750",
      "id" : 584628750,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18118",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDYyODc1MA==",
      "updated_at" : "2020-02-11T13:15:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584628750",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Then the only attack I see is if a Sybil attack pushes the node time forward 70 minutes **and** attacker finds a block that has a timestamp that is 189 minutes into the future (that nodes outside of the attack will not approve) **and** if a node restarts in 70 minutes. It seems like an unlikely scenario. I assume the Sybil attack can't motivate a restart.\r\n\r\nI guess this is not as bad as regular Culubas timejacking where nodes get a Sybil-attacked peer time that is 70 minutes in the past making them invalidate (for up to 70 minutes or may be longer?) blocks with times forwarded to the 120 minute limit, causing miners under those nodes to build on top of a chain that will lose and can be used for double spending.\r\n\r\nI think peer time was always a mistake but Culubas said that if local time was the only time \"a disagreement among nodes of only a second or slightly longer (something that will happen as nodes gradually calibrate their clocks) could allow an attacker to split the network or isolate a node.\"  I don't see how that could be done.",
      "created_at" : "2020-02-11T13:26:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18118#issuecomment-584633175",
      "id" : 584633175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18118",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NDYzMzE3NQ==",
      "updated_at" : "2020-02-11T15:29:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/584633175",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/18004719?v=4",
         "events_url" : "https://api.github.com/users/zawy12/events{/privacy}",
         "followers_url" : "https://api.github.com/users/zawy12/followers",
         "following_url" : "https://api.github.com/users/zawy12/following{/other_user}",
         "gists_url" : "https://api.github.com/users/zawy12/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/zawy12",
         "id" : 18004719,
         "login" : "zawy12",
         "node_id" : "MDQ6VXNlcjE4MDA0NzE5",
         "organizations_url" : "https://api.github.com/users/zawy12/orgs",
         "received_events_url" : "https://api.github.com/users/zawy12/received_events",
         "repos_url" : "https://api.github.com/users/zawy12/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/zawy12/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/zawy12/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/zawy12"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "That is pretty fringe-- particularly because peer-time only lets a nodes initial peers tweak their time, and mostly serves the purpose of fixing DST handling on windows hosts--, but sure, that startup test could be relaxed by another 70 minutes and not really lose any of it intended sensitivity to misconfigured hosts while avoiding a refusal to start in your suggested oddball confluence of events.\r\n\r\n",
      "created_at" : "2020-02-12T03:33:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18118#issuecomment-585010203",
      "id" : 585010203,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18118",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NTAxMDIwMw==",
      "updated_at" : "2020-02-12T03:33:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/585010203",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> peer-time ... mostly serves the purpose of fixing DST handling \r\n\r\nWhat other purpose does peer time serve? \r\n\r\nAllowing a Sybil attack to have control over something that's needed is something that's bad, unless it's beneficial most of the time, and the infrequent subversion is not a net loss.",
      "created_at" : "2020-02-12T08:54:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18118#issuecomment-585098908",
      "id" : 585098908,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18118",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NTA5ODkwOA==",
      "updated_at" : "2020-02-12T09:07:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/585098908",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/18004719?v=4",
         "events_url" : "https://api.github.com/users/zawy12/events{/privacy}",
         "followers_url" : "https://api.github.com/users/zawy12/followers",
         "following_url" : "https://api.github.com/users/zawy12/following{/other_user}",
         "gists_url" : "https://api.github.com/users/zawy12/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/zawy12",
         "id" : 18004719,
         "login" : "zawy12",
         "node_id" : "MDQ6VXNlcjE4MDA0NzE5",
         "organizations_url" : "https://api.github.com/users/zawy12/orgs",
         "received_events_url" : "https://api.github.com/users/zawy12/received_events",
         "repos_url" : "https://api.github.com/users/zawy12/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/zawy12/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/zawy12/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/zawy12"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If it doesn't work, it fails right at node start, and the maximum skew isn't enough to break things generally... Making it fairly uninteresting to attack.",
      "created_at" : "2020-02-12T09:16:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18118#issuecomment-585108013",
      "id" : 585108013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18118",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NTEwODAxMw==",
      "updated_at" : "2020-02-12T09:17:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/585108013",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I mean in general, why let a weak consensus mechanism, the median of peer time offset, be part of laying the foundation of POW consensus?  BFT requires a clock, so it seems the clock must be more secure than the consensus mechanism.\r\n\r\nBTW each message in distributed systems require sequential stamps according to IR2' in [Lamport 1978](https://lamport.azurewebsites.net/pubs/time-clocks.pdf). The MTP(11) gets the baseline, but not requiring it in every block has caused a lot of problems in alts trying to change things.\r\n\r\nAfter studying [every timestamp attack](https://github.com/zawy12/difficulty-algorithms/issues/30) it seems they all could have been prevented by following these two rules (in addition to not letting the difficulty algorithm change what the timestamps say and allowing a future timestamp that is greater than node time error but small compared to the difficulty algorithm's averaging window).  The requirement for POW to work is not that miners should be able to select the timestamp, but that future nodes connecting must make sure miners do not advance time. Therefore MTP(11) instead of sequential stamps in every block was a mistake.\r\n\r\nI just noticed in Lamport's paper he says clocks can't be set backwards. In this context, that means a clock can't be set to before a previously-validated timestamp. This would have prevented the  unlikely database error, which is what your suggested patch enforces.\r\n\r\nThat gives me a total of 5 time requirements for POW consensus:\r\n\r\n1. Nodes use their operator as an oracle to set the clock.\r\n2. FTL is > node timing errors & << difficulty averaging window.\r\n3. Sequential stamps on blocks even if it overrides 1 and 2.\r\n4. No calibrating clock back to before a previously-validated stamp.\r\n5. Do not let difficulty algorithm re-interpret the timestamps with things like timespan limits.\r\n\r\nThe only exception to rule 5 I've seen is that if the difficulty algorithm correctly adjusts and if the other rules are followed, I can't find an attack on symmetrical timespan limits.  ",
      "created_at" : "2020-02-12T09:21:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18118#issuecomment-585110048",
      "id" : 585110048,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18118",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4NTExMDA0OA==",
      "updated_at" : "2020-02-12T10:14:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/585110048",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/18004719?v=4",
         "events_url" : "https://api.github.com/users/zawy12/events{/privacy}",
         "followers_url" : "https://api.github.com/users/zawy12/followers",
         "following_url" : "https://api.github.com/users/zawy12/following{/other_user}",
         "gists_url" : "https://api.github.com/users/zawy12/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/zawy12",
         "id" : 18004719,
         "login" : "zawy12",
         "node_id" : "MDQ6VXNlcjE4MDA0NzE5",
         "organizations_url" : "https://api.github.com/users/zawy12/orgs",
         "received_events_url" : "https://api.github.com/users/zawy12/received_events",
         "repos_url" : "https://api.github.com/users/zawy12/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/zawy12/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/zawy12/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/zawy12"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing due to lack of momentum in the discussion. Can re-open if future interest.",
      "created_at" : "2022-08-02T17:20:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18118#issuecomment-1203009563",
      "id" : 1203009563,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18118",
      "node_id" : "IC_kwDOABII585HtHgb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1203009563/reactions"
      },
      "updated_at" : "2022-08-02T17:20:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1203009563",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/755825?v=4",
         "events_url" : "https://api.github.com/users/adamjonas/events{/privacy}",
         "followers_url" : "https://api.github.com/users/adamjonas/followers",
         "following_url" : "https://api.github.com/users/adamjonas/following{/other_user}",
         "gists_url" : "https://api.github.com/users/adamjonas/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/adamjonas",
         "id" : 755825,
         "login" : "adamjonas",
         "node_id" : "MDQ6VXNlcjc1NTgyNQ==",
         "organizations_url" : "https://api.github.com/users/adamjonas/orgs",
         "received_events_url" : "https://api.github.com/users/adamjonas/received_events",
         "repos_url" : "https://api.github.com/users/adamjonas/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/adamjonas/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/adamjonas/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/adamjonas"
      }
   }
]
