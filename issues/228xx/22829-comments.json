[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#21943](https://github.com/bitcoin/bitcoin/pull/21943) (Dedup and RAII-fy the creation of a copy of CConnman::vNodes by vasild)\n* [#21879](https://github.com/bitcoin/bitcoin/pull/21879) (Wrap accept() and extend usage of Sock by vasild)\n* [#21878](https://github.com/bitcoin/bitcoin/pull/21878) (Make all networking code mockable by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-08-30T00:21:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-907909717",
      "id" : 907909717,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII5842HZpV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907909717/reactions"
      },
      "updated_at" : "2021-11-19T06:41:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907909717",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK and clang 13 debug build is clean.",
      "created_at" : "2021-09-06T08:37:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-913459532",
      "id" : 913459532,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII5842cklM",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-06T08:37:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/913459532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> there is no chance that within one critical section, another one is called\r\n\r\nwhy? What prevents `ForEachNode` to call `DisconnectNode` or so via the lambda?",
      "created_at" : "2021-09-06T08:49:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-913467389",
      "id" : 913467389,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII5842cmf9",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-06T08:49:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/913467389",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The scripted diff could be shortened with a rename helper like 37dcd12d539e4a875581fa049aa0f7fafeb932a4",
      "created_at" : "2021-09-06T08:50:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-913468228",
      "id" : 913468228,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII5842cmtE",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-06T08:50:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/913468228",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > there is no chance that within one critical section, another one is called\r\n> \r\n> why? What prevents `ForEachNode` to call `DisconnectNode` or so via the lambda?\r\n\r\nWhat concrete mutex are you referring to? Note that this PR only tackles the RecursiveMutex->Mutex replacement for `vAddedNodes_cs` (which is only locked in a small number of places, see commit log message for details), _not_ vNodes_cs, which is a way more complex beast to beat.\r\n\r\n> The scripted diff could be shortened with a rename helper like [37dcd12](https://github.com/bitcoin/bitcoin/commit/37dcd12d539e4a875581fa049aa0f7fafeb932a4)\r\n\r\nGood idea, will do in a bit.",
      "created_at" : "2021-09-06T11:26:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-913573193",
      "id" : 913573193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII5842dAVJ",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-06T11:29:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/913573193",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force-pushed with changed commit subject for the scripted-diff (using a helper), as suggested by MarcoFalke (https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-913468228):\r\n```\r\n$ git range-diff 94a99d05...6f0930a9\r\n1:  cf29163ca ! 1:  887df8ecc scripted-diff: rename node vector/mutex members in CConnman\r\n    @@ Commit message\r\n         scripted-diff: rename node vector/mutex members in CConnman\r\n\r\n         -BEGIN VERIFY SCRIPT-\r\n    -    sed -i 's/cs_vAddedNodes/m_added_nodes_mutex/g' src/net.h src/net.cpp\r\n    -    sed -i 's/vAddedNodes/m_added_nodes/g' src/net.h src/net.cpp\r\n    -    sed -i 's/cs_vNodes/m_nodes_mutex/g' src/net.h src/net.cpp src/test/util/net.h\r\n    -    sed -i 's/vNodesDisconnectedCopy/nodes_disconnected_copy/g' src/net.cpp\r\n    -    sed -i 's/vNodesDisconnected/m_nodes_disconnected/g' src/net.h src/net.cpp\r\n    -    sed -i 's/vNodesCopy/nodes_copy/g' src/net.cpp\r\n    -    sed -i 's/vNodesSize/nodes_size/g' src/net.cpp\r\n    -    sed -i 's/vNodes/m_nodes/g' src/net.h src/net.cpp src/test/util/net.h\r\n    +\r\n    +    ren() { sed -i \"s/$1/$2/g\" $3 $4 $5; }\r\n    +\r\n    +    ren cs_vAddedNodes         m_added_nodes_mutex     src/net.h src/net.cpp\r\n    +    ren vAddedNodes            m_added_nodes           src/net.h src/net.cpp\r\n    +    ren cs_vNodes              m_nodes_mutex           src/net.h src/net.cpp src/test/util/net.h\r\n    +    ren vNodesDisconnectedCopy nodes_disconnected_copy src/net.cpp\r\n    +    ren vNodesDisconnected     m_nodes_disconnected    src/net.h src/net.cpp\r\n    +    ren vNodesCopy             nodes_copy              src/net.cpp\r\n    +    ren vNodesSize             nodes_size              src/net.cpp\r\n    +    ren vNodes                 m_nodes                 src/net.h src/net.cpp src/test/util/net.h\r\n    +\r\n         -END VERIFY SCRIPT-\r\n\r\n      ## src/net.cpp ##\r\n2:  5aca12d16 = 2:  73685d923 refactor: replace RecursiveMutex m_addr_fetches_mutex with Mutex\r\n3:  94a99d05f = 3:  6f0930a96 refactor: replace RecursiveMutex m_added_nodes_mutex with Mutex\r\n\r\n```",
      "created_at" : "2021-09-06T14:57:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-913709044",
      "id" : 913709044,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII5842dhf0",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-06T14:57:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/913709044",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22829#discussion_r721286937"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22829"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721286937"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: might use `std::atomic_uint64_t` if it is available on all platforms that we aim to support.",
      "commit_id" : "6f0930a965fcdffcb1b9e18d431ca73c5cd1a285",
      "created_at" : "2021-10-04T11:49:24Z",
      "diff_hunk" : "@@ -1030,9 +1030,8 @@ class CConnman\n     static bool NodeFullyConnected(const CNode* pnode);\n \n     // Network usage totals\n-    mutable RecursiveMutex cs_totalBytesRecv;\n     mutable RecursiveMutex cs_totalBytesSent;\n-    uint64_t nTotalBytesRecv GUARDED_BY(cs_totalBytesRecv) {0};\n+    std::atomic<uint64_t> nTotalBytesRecv{0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#discussion_r721286937",
      "id" : 721286937,
      "line" : 1034,
      "node_id" : "PRRC_kwDOABII584q_fcZ",
      "original_commit_id" : "6f0930a965fcdffcb1b9e18d431ca73c5cd1a285",
      "original_line" : 1034,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 49,
      "pull_request_review_id" : 770189977,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22829",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721286937/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-04T12:45:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721286937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22829#discussion_r721299442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22829"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721299442"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not necessary for this PR, but it is a good practice to avoid printouts (which may block) while holding mutexes. Feel free to take this or ignore it:\r\n```diff\r\n-                LOCK2(m_addr_fetches_mutex, m_added_nodes_mutex);\r\n-                if (m_addr_fetches.empty() && m_added_nodes.empty()) {\r\n-                    add_fixed_seeds_now = true;\r\n+                {\r\n+                    LOCK2(m_addr_fetches_mutex, m_added_nodes_mutex);\r\n+                    add_fixed_seeds_now = m_addr_fetches.empty() && m_added_nodes.empty();\r\n+                }\r\n+                if (add_fixed_seeds_now) {\r\n                     LogPrintf(\"Adding fixed seeds as -dnsseed=0, -addnode is not provided and all -see\r\n                 }\r\n```",
      "commit_id" : "6f0930a965fcdffcb1b9e18d431ca73c5cd1a285",
      "created_at" : "2021-10-04T12:07:49Z",
      "diff_hunk" : "@@ -1877,8 +1877,8 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n \n             // Checking !dnsseed is cheaper before locking 2 mutexes.\n             if (!add_fixed_seeds_now && !dnsseed) {\n-                LOCK2(m_addr_fetches_mutex, cs_vAddedNodes);\n-                if (m_addr_fetches.empty() && vAddedNodes.empty()) {\n+                LOCK2(m_addr_fetches_mutex, m_added_nodes_mutex);\n+                if (m_addr_fetches.empty() && m_added_nodes.empty()) {\n                     add_fixed_seeds_now = true;\n                     LogPrintf(\"Adding fixed seeds as -dnsseed=0, -addnode is not provided and all -seednode(s) attempted\\n\");\n                 }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#discussion_r721299442",
      "id" : 721299442,
      "line" : 1884,
      "node_id" : "PRRC_kwDOABII584q_ify",
      "original_commit_id" : "6f0930a965fcdffcb1b9e18d431ca73c5cd1a285",
      "original_line" : 1884,
      "original_position" : 281,
      "original_start_line" : 1880,
      "path" : "src/net.cpp",
      "position" : 281,
      "pull_request_review_id" : 770189977,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22829",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721299442/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1880,
      "start_side" : "LEFT",
      "updated_at" : "2021-10-04T12:45:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721299442",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22829#discussion_r721334273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22829"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721334273"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> std::atomic_uint64_t\r\n\r\nThe two are guaranteed to be the same either way.",
      "commit_id" : "6f0930a965fcdffcb1b9e18d431ca73c5cd1a285",
      "created_at" : "2021-10-04T12:52:44Z",
      "diff_hunk" : "@@ -1030,9 +1030,8 @@ class CConnman\n     static bool NodeFullyConnected(const CNode* pnode);\n \n     // Network usage totals\n-    mutable RecursiveMutex cs_totalBytesRecv;\n     mutable RecursiveMutex cs_totalBytesSent;\n-    uint64_t nTotalBytesRecv GUARDED_BY(cs_totalBytesRecv) {0};\n+    std::atomic<uint64_t> nTotalBytesRecv{0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#discussion_r721334273",
      "id" : 721334273,
      "in_reply_to_id" : 721286937,
      "line" : 1034,
      "node_id" : "PRRC_kwDOABII584q_rAB",
      "original_commit_id" : "6f0930a965fcdffcb1b9e18d431ca73c5cd1a285",
      "original_line" : 1034,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 49,
      "pull_request_review_id" : 770253605,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22829",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721334273/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-04T12:52:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/721334273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2021-10-08T14:23:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-938684311",
      "id" : 938684311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII58438y-X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/938684311/reactions"
      },
      "updated_at" : "2021-10-08T14:23:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/938684311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22829#discussion_r725074060"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22829"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725074060"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, could be\r\n```suggestion\r\n            WITH_LOCK(m_added_nodes_mutex, m_added_nodes = connOptions.m_added_nodes);\r\n```\r\nwithout surrounding braces.\r\n\r\nMayby, better to leave it (and other similar places) for a follow up.",
      "commit_id" : "6f0930a965fcdffcb1b9e18d431ca73c5cd1a285",
      "created_at" : "2021-10-08T14:43:16Z",
      "diff_hunk" : "@@ -793,8 +793,8 @@ class CConnman\n         }\n         vWhitelistedRange = connOptions.vWhitelistedRange;\n         {\n-            LOCK(cs_vAddedNodes);\n-            vAddedNodes = connOptions.m_added_nodes;\n+            LOCK(m_added_nodes_mutex);\n+            m_added_nodes = connOptions.m_added_nodes;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#discussion_r725074060",
      "id" : 725074060,
      "line" : 797,
      "node_id" : "PRRC_kwDOABII584rN8CM",
      "original_commit_id" : "6f0930a965fcdffcb1b9e18d431ca73c5cd1a285",
      "original_line" : 797,
      "original_position" : 7,
      "original_start_line" : 796,
      "path" : "src/net.h",
      "position" : 7,
      "pull_request_review_id" : 775103398,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22829",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725074060/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 796,
      "start_side" : "RIGHT",
      "updated_at" : "2021-10-08T14:47:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725074060",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-11-24T17:25:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-978081858",
      "id" : 978081858,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII5846TFhC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/978081858/reactions"
      },
      "updated_at" : "2021-11-24T17:25:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/978081858",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> <!--e57a25ab6845829454e8d69fc972939a-->\n> \n> The following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n> \n> <!--174a7506f384e20aa4161008e828411d-->\n> ### Conflicts\n> Reviewers, this pull request conflicts with the following ones:\n> \n> * [#21943](https://github.com/bitcoin/bitcoin/pull/21943) (Dedup and RAII-fy the creation of a copy of CConnman::vNodes by vasild)\n> * [#21879](https://github.com/bitcoin/bitcoin/pull/21879) (Wrap accept() and extend usage of Sock by vasild)\n> * [#21878](https://github.com/bitcoin/bitcoin/pull/21878) (Make all networking code mockable by vasild)\n> \n> If you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n\n",
      "created_at" : "2021-11-25T18:08:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22829#issuecomment-979406578",
      "id" : 979406578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22829",
      "node_id" : "IC_kwDOABII5846YI7y",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979406578/reactions"
      },
      "updated_at" : "2021-11-25T18:08:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979406578",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91693835?v=4",
         "events_url" : "https://api.github.com/users/mohammadhosein552zarei/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mohammadhosein552zarei/followers",
         "following_url" : "https://api.github.com/users/mohammadhosein552zarei/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mohammadhosein552zarei/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mohammadhosein552zarei",
         "id" : 91693835,
         "login" : "mohammadhosein552zarei",
         "node_id" : "U_kgDOBXcjCw",
         "organizations_url" : "https://api.github.com/users/mohammadhosein552zarei/orgs",
         "received_events_url" : "https://api.github.com/users/mohammadhosein552zarei/received_events",
         "repos_url" : "https://api.github.com/users/mohammadhosein552zarei/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mohammadhosein552zarei/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mohammadhosein552zarei/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mohammadhosein552zarei"
      }
   }
]
