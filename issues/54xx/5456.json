{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "I noticed the release 0.9.3 as well as Gitian builds, build with a Debian 7.6.0 VM via the \"old\" route, appear to have some issues with OpenSSL, CBigNum or CScriptNum in combination with Win x64.\n\nTo be more specific:\nOn Windows 8.1 x64 there are 798 scriptnum_tests failures when using the 64 bit build of the official release 0.9.3 and 0 failures when using the 32 bit build release:\n- http://bitwatch.co/uploads/win64_release_0_9_3.txt\n\nThen I used a v0.9.3~ non release as basis, added some code for debug output, and build on a Debian 7.6.0 VM via Gitian, following a similar route as outlined in the [doc/release-process.md](https://github.com/bitcoin/bitcoin/blob/3ae41a64dd79aa20bbb53a53ae8a2b654305b07e/doc/release-process.md) file, creating the following results:\n- http://bitwatch.co/uploads/win64_scriptnum_verbose_64.log (Gitian via Debian VM)\n- http://bitwatch.co/uploads/win64_scriptnum_verbose_32.log (Gitian via Debian VM)\n- http://bitwatch.co/uploads/ubuntu1404_scriptnum_verbose_64.log (Ubuntuu 14.04 x64)\n\nThe last log was not part of a Gitian build.\n\nClient information:\n\n```\nRelease 0.9.3, 32 bit:\nv0.9.3.0-g40d2041-beta, OpenSSL 1.0.1i 6 Aug 2014, build: Mon, 22 Sep 2014 16:42:15 +0200\n\nRelease 0.9.3, 64 bit:\nv0.9.3.0-g40d2041-beta, OpenSSL 1.0.1i 6 Aug 2014, build: Mon, 22 Sep 2014 16:42:15 +0200\n\nGitian/Debian verbose build, 32 bit:\nv0.9.3.0-ge449166-beta, OpenSSL 1.0.1i 6 Aug 2014, build: 9 Dec 2014 23:10:05 -0500\n\nGitian/Debian verbose build, 64 bit:\nv0.9.3.0-ge449166-beta, OpenSSL 1.0.1i 6 Aug 2014, build: 9 Dec 2014 23:10:05 -0500\n\nUbuntu 14.04 build:\nv0.9.3.0-5719766-dirty-beta, OpenSSL 1.0.1f 6 Jan 2014, build: 2014-12-10 10:58:05 +0100\n```\n\nA few samples to compare, whereby all failures are related to 64 bit builds, run on Win 8.1 x64:\n\n```\nbignum.ToHex():     100000078\nbignum.ToString():  4294967416\nbignum.getulong():  4294967416\nbignum.getuint():   120\nbignum.getint():    2147483647 <<\nscriptnum.getint(): 2147483647 <<\nbignum.getvch():    7800000001 << vch.size(): 5\nscriptnum.getvch(): 7800000001 << vch.size(): 5\n\nbignum.ToHex():     100000078\nbignum.ToString():  4294967416\nbignum.getulong():  120\nbignum.getuint():   120\nbignum.getint():    120 <<\nscriptnum.getint(): 2147483647 <<\nbignum.getvch():    7800000001 << vch.size(): 5\nscriptnum.getvch(): 7800000001 << vch.size(): 5\nscriptnum_tests.cpp(54): error in \"creation\": check verify(bignum, scriptnum) failed\n```\n\n```\nbignum.ToHex():     7fffffff\nbignum.ToString():  2147483647\nbignum.getulong():  2147483647\nbignum.getuint():   2147483647\nbignum.getint():    2147483647 <<\nscriptnum.getint(): 2147483647 <<\nbignum.getvch():    ffffff7f << vch.size(): 4\nscriptnum.getvch(): ffffff7f << vch.size(): 4\n\nbignum.ToHex():     78\nbignum.ToString():  120\nbignum.getulong():  120\nbignum.getuint():   120\nbignum.getint():    120 <<\nscriptnum.getint(): 2147483647 <<\nbignum.getvch():    ffffff7f << vch.size(): 4\nscriptnum.getvch(): ffffff7f << vch.size(): 4\nscriptnum_tests.cpp(55): error in \"creation\": check verify(bignum.getint(), ...\n```\n\n```\nbignum.ToHex():     7fffffff\nbignum.ToString():  2147483647\nbignum.getulong():  2147483647\nbignum.getuint():   2147483647\nbignum.getint():    2147483647 <<\nscriptnum.getint(): 2147483647 <<\nbignum.getvch():    ffffff7f << vch.size(): 4\nscriptnum.getvch(): ffffff7f << vch.size(): 4\n\nbignum.ToHex():     7fffffff\nbignum.ToString():  2147483647\nbignum.getulong():  2147483647\nbignum.getuint():   2147483647\nbignum.getint():    2147483647 <<\nscriptnum.getint(): 120 <<\nbignum.getvch():    78 << vch.size(): 1\nscriptnum.getvch(): 78 << vch.size(): 1\nscriptnum_tests.cpp(56): error in \"creation\": check verify(scriptnum.getint(), ...\n```\n\nThe arrows `<<` mark values that are used in the verification function ([scriptnum_tests.cpp#L18](https://github.com/bitcoin/bitcoin/blob/master/src/test/scriptnum_tests.cpp#L18)). Furthermore I prefixed all lines related to failures in verbose_64.log with `##`.\n\n`bignum.getvch()` and `scriptnum.getvch()` were embedded in `HexStr()` and the output was printed with `printf` and `%s`, `%lu`, `%u` and `%d` format specifiers.\n\nIt's not clear to me, if the results can be compared line by line, because they seem to differ in length sometimes, even without failure, but a look at [master/crypto/bn/bn.h](https://github.com/openssl/openssl/blob/master/crypto/bn/bn.h) already hints why this might be.\n\nMy very best and unsophisticated guess: OpenSSL and LLP64 are not the best friends.\n",
   "closed_at" : "2014-12-11T14:59:20Z",
   "closed_by" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/5836089?v=4",
      "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dexX7/followers",
      "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dexX7",
      "id" : 5836089,
      "login" : "dexX7",
      "node_id" : "MDQ6VXNlcjU4MzYwODk=",
      "organizations_url" : "https://api.github.com/users/dexX7/orgs",
      "received_events_url" : "https://api.github.com/users/dexX7/received_events",
      "repos_url" : "https://api.github.com/users/dexX7/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dexX7"
   },
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5456/comments",
   "created_at" : "2014-12-10T12:47:46Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5456/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/5456",
   "id" : 51554330,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      },
      {
         "color" : "d4c5f9",
         "default" : false,
         "id" : 62963516,
         "name" : "Tests",
         "node_id" : "MDU6TGFiZWw2Mjk2MzUxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5456/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU1MTU1NDMzMA==",
   "number" : 5456,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Release 0.9.3 + 0.9.3~ Gitian build on Win 8.1 x64 fails scriptnum_tests",
   "updated_at" : "2014-12-11T14:59:20Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5456",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/5836089?v=4",
      "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
      "followers_url" : "https://api.github.com/users/dexX7/followers",
      "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/dexX7",
      "id" : 5836089,
      "login" : "dexX7",
      "node_id" : "MDQ6VXNlcjU4MzYwODk=",
      "organizations_url" : "https://api.github.com/users/dexX7/orgs",
      "received_events_url" : "https://api.github.com/users/dexX7/received_events",
      "repos_url" : "https://api.github.com/users/dexX7/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/dexX7"
   }
}
