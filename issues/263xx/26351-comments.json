[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25573](https://github.com/bitcoin/bitcoin/pull/25573) ([POC] guix: produce a fully -static-pie x86_64 bitcoind using GCC and glibc by fanquake)\n* [#24123](https://github.com/bitcoin/bitcoin/pull/24123) (build: Pointer Authentication and Branch Target Identification for aarch64 Linux (Guix) by fanquake)\n* [#21778](https://github.com/bitcoin/bitcoin/pull/21778) (build: LLVM 14 & LLD based macOS toolchain by fanquake)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-10-20T09:26:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26351#issuecomment-1285219204",
      "id" : 1285219204,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26351",
      "node_id" : "IC_kwDOABII585MmuOE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285219204/reactions"
      },
      "updated_at" : "2022-10-20T09:26:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285219204",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I failed to build both this PR and the patched rc2 for the platform triple `x86_64-linux-gnu` (Guix commit 39dcbc7fa3c02ff5c9682f25e1c29667dbfe7827)\r\n\r\n```\r\nINFO: Building 4c35ccb86dbe for platform triple x86_64-linux-gnu:\r\n      ...using reference timestamp: 1666254014\r\n      ...running at most 32 jobs\r\n      ...from worktree directory: '/home/guix/bitcoin'\r\n          ...bind-mounted in container to: '/bitcoin'\r\n      ...in build directory: '/home/guix/bitcoin/guix-build-4c35ccb86dbe/distsrc-4c35ccb86dbe-x86_64-linux-gnu'\r\n          ...bind-mounted in container to: '/distsrc-base/distsrc-4c35ccb86dbe-x86_64-linux-gnu'\r\n      ...outputting in: '/home/guix/bitcoin/guix-build-4c35ccb86dbe/output/x86_64-linux-gnu'\r\n          ...bind-mounted in container to: '/outdir-base/x86_64-linux-gnu'\r\nRequired environment variables as seen inside the container:\r\n    DIST_ARCHIVE_BASE: /outdir-base/dist-archive\r\n    DISTNAME: bitcoin-4c35ccb86dbe\r\n    HOST: x86_64-linux-gnu\r\n    SOURCE_DATE_EPOCH: 1666254014\r\n    JOBS: 32\r\n    DISTSRC: /distsrc-base/distsrc-4c35ccb86dbe-x86_64-linux-gnu\r\n    OUTDIR: /outdir-base/x86_64-linux-gnu\r\n'/gnu/store/zh29y5bw1j0yw2i66qy640g9lj1fzl85-gcc-cross-x86_64-linux-gnu-10.3.0-lib\")))/lib/gcc/x86_64-linux-gnu/*/include' doesn't exist or isn't a directory... Abortingâ¦\r\n```\r\n\r\nSimilar error for `arm-linux-gnueabihf`, `aarch64-linux-gnu`, `riscv64-linux-gnu`, `powerpc64le-linux-gnu`, `x86_64-w64-mingw32`.\r\n\r\nBut I did manage to build `apple-darwin-unsigned` and `arm64-apple-darwin`. I tested that the Apple (Intel) binary actually works.\r\n\r\n`powerpc64-linux-gnu` failed with a different error:\r\n\r\n```\r\nINFO: Building f3fb6d2d4174 for platform triple powerpc64-linux-gnu:\r\n      ...using reference timestamp: 1666254014\r\n      ...running at most 32 jobs\r\n      ...from worktree directory: '/home/guix/bitcoin'\r\n          ...bind-mounted in container to: '/bitcoin'\r\n      ...in build directory: '/home/guix/bitcoin/guix-build-f3fb6d2d4174/distsrc-f3fb6d2d4174-powerpc64-linux-gnu'\r\n          ...bind-mounted in container to: '/distsrc-base/distsrc-f3fb6d2d4174-powerpc64-linux-gnu'\r\n      ...outputting in: '/home/guix/bitcoin/guix-build-f3fb6d2d4174/output/powerpc64-linux-gnu'\r\n          ...bind-mounted in container to: '/outdir-base/powerpc64-linux-gnu'\r\nBacktrace:\r\nIn srfi/srfi-1.scm:\r\n   586:29 19 (map1 (#<<manifest-entry> name: \"python-lief\" versio?> ?))\r\n   586:17 18 (map1 (#<<manifest-entry> name: \"powerpc64-linux-gnu-t?>))\r\nIn guix/profiles.scm:\r\n  1974:19 17 (_ _)\r\nIn guix/packages.scm:\r\n  1279:17 16 (supported-package? #<package powerpc64-linux-gnu-tool?> ?)\r\nIn guix/memoization.scm:\r\n    101:0 15 (_ #<hash-table 7fe44998ae20 704/883> #<package powerp?> ?)\r\nIn guix/packages.scm:\r\n  1249:12 14 (_)\r\nIn srfi/srfi-1.scm:\r\n   460:18 13 (fold #<procedure 7fe447e7de80 at guix/packages.scm:12?> ?)\r\nIn guix/packages.scm:\r\n  1253:42 12 (_ _ (\"x86_64-linux\" \"i686-linux\"))\r\nIn guix/memoization.scm:\r\n    101:0 11 (_ #<hash-table 7fe44998ae20 704/883> #<package glibc-?> ?)\r\nIn guix/packages.scm:\r\n  1249:12 10 (_)\r\nIn srfi/srfi-1.scm:\r\n   460:18  9 (fold #<procedure 7fe447e82b60 at guix/packages.scm:12?> ?)\r\nIn guix/packages.scm:\r\n  1253:42  8 (_ _ (\"x86_64-linux\" \"i686-linux\"))\r\nIn guix/memoization.scm:\r\n    101:0  7 (_ #<hash-table 7fe44998ae20 704/883> #<package linux-?> ?)\r\nIn guix/packages.scm:\r\n  1257:37  6 (_)\r\n  1517:16  5 (package->bag _ _ _ #:graft? _)\r\n  1622:43  4 (thunk)\r\nIn guix/build-system/gnu.scm:\r\n   188:19  3 (arguments _)\r\nIn gnu/packages/cross-base.scm:\r\n   352:33  2 (loop (#:phases (modify-phases %standard-phases # ?) ?) #)\r\nIn ice-9/boot-9.scm:\r\n  1685:16  1 (raise-exception _ #:continuable? _)\r\n  1685:16  0 (raise-exception _ #:continuable? _)\r\n\r\nice-9/boot-9.scm:1685:16: In procedure raise-exception:\r\nIn procedure struct-vtable: Wrong type argument in position 1 (expecting struct): #f\r\n```\r\n\r\nI encountered the same issue on my existing Guix machine once I updated its guix commit.\r\n\r\nUsing the latest guix master commit (4716cea6256523a8ecf90a426d675bfb7620f3e4) results in the same errors.\r\n\r\nIf I remove the spurious `\")))` then the path does exist. There's probably something wrong with the regex here (though it hasn't been touched in years):\r\nhttps://github.com/bitcoin/bitcoin/blob/995fdef14af2a8a97381d412e66a9b92192b39e1/contrib/guix/libexec/build.sh#L50-L57\r\n\r\nAdded some `&2> echo` statements in that function and narrowed it down to `store_path() linux-libre-headers-cross-x86_64-linux-gnu` and `gcc-cross-x86_64-linux-gnu [lib]` adding spurious brackets.\r\n\r\nWhich may be because the manifest file looks like so:\r\n```\r\n          (propagated-inputs\r\n            ((\"linux-libre-headers-cross-x86_64-linux-gnu\"\r\n              \"5.15.52\"\r\n              \"out\"\r\n              \"/gnu/store/3wl72wb29malv3idmpay05xj9l1xiir0-linux-libre-headers-cross-x86_64-linux-gnu-5.15.52\")))\r\n```\r\n",
      "created_at" : "2022-10-20T10:30:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26351#issuecomment-1285303889",
      "id" : 1285303889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26351",
      "node_id" : "IC_kwDOABII585MnC5R",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285303889/reactions"
      },
      "updated_at" : "2022-10-20T16:21:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285303889",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a commit that fixes the `store_path` regex to also drop closing brackets.\r\n\r\nThe `powerpc64-linux-gnu` still fails like it did above. Filed in #26354.\r\n\r\nI tried to build this host using the latest guix master 00ff6f7c399670a76efffb91276dea2633cc130c, but no luck ([branch](https://github.com/Sjors/bitcoin/tree/2022/10/guix-bump-timemachine-head)):\r\n\r\n```\r\n$ env HOSTS='powerpc64-linux-gnu' contrib/guix/guix-build \r\nChecking that we can connect to the guix-daemon...\r\n\r\nHint: If this hangs, you may want to try turning your guix-daemon off and on\r\n      again.\r\n\r\nmake: Entering directory '/home/guix/bitcoin/depends'\r\nmake[1]: Entering directory '/home/guix/bitcoin/depends'\r\nmake[1]: Leaving directory '/home/guix/bitcoin/depends'\r\nmake: Leaving directory '/home/guix/bitcoin/depends'\r\nINFO: Building 0b69be5e130e for platform triple powerpc64-linux-gnu:\r\n      ...using reference timestamp: 1666283660\r\n      ...running at most 32 jobs\r\n      ...from worktree directory: '/home/guix/bitcoin'\r\n          ...bind-mounted in container to: '/bitcoin'\r\n      ...in build directory: '/home/guix/bitcoin/guix-build-0b69be5e130e/distsrc-0b69be5e130e-powerpc64-linux-gnu'\r\n          ...bind-mounted in container to: '/distsrc-base/distsrc-0b69be5e130e-powerpc64-linux-gnu'\r\n      ...outputting in: '/home/guix/bitcoin/guix-build-0b69be5e130e/output/powerpc64-linux-gnu'\r\n          ...bind-mounted in container to: '/outdir-base/powerpc64-linux-gnu'\r\nBacktrace:\r\nIn srfi/srfi-1.scm:\r\n   586:29 19 (map1 (#<<manifest-entry> name: \"python-lief\" versio?> ?))\r\n   586:17 18 (map1 (#<<manifest-entry> name: \"powerpc64-linux-gnu-t?>))\r\nIn guix/profiles.scm:\r\n  1930:19 17 (_ _)\r\nIn guix/packages.scm:\r\n  1317:17 16 (supported-package? #<package powerpc64-linux-gnu-tool?> ?)\r\nIn guix/memoization.scm:\r\n    101:0 15 (_ #<hash-table 7f6da4355ec0 556/883> #<package powerp?> ?)\r\nIn guix/packages.scm:\r\n  1287:12 14 (_)\r\nIn srfi/srfi-1.scm:\r\n   460:18 13 (fold #<procedure 7f6da15e1f40 at guix/packages.scm:12?> ?)\r\nIn guix/packages.scm:\r\n  1291:42 12 (_ _ (\"x86_64-linux\" \"i686-linux\"))\r\nIn guix/memoization.scm:\r\n    101:0 11 (_ #<hash-table 7f6da4355ec0 556/883> #<package glibc-?> ?)\r\nIn guix/packages.scm:\r\n  1287:12 10 (_)\r\nIn srfi/srfi-1.scm:\r\n   460:18  9 (fold #<procedure 7f6da15e6f80 at guix/packages.scm:12?> ?)\r\nIn guix/packages.scm:\r\n  1291:42  8 (_ _ (\"x86_64-linux\" \"i686-linux\"))\r\nIn guix/memoization.scm:\r\n    101:0  7 (_ #<hash-table 7f6da4355ec0 556/883> #<package linux-?> ?)\r\nIn guix/packages.scm:\r\n  1295:37  6 (_)\r\n  1555:16  5 (package->bag _ _ _ #:graft? _)\r\n  1660:43  4 (thunk)\r\nIn guix/build-system/gnu.scm:\r\n   188:19  3 (arguments _)\r\nIn gnu/packages/cross-base.scm:\r\n   352:33  2 (loop (#:phases (modify-phases %standard-phases # ?) ?) #)\r\nIn ice-9/boot-9.scm:\r\n  1685:16  1 (raise-exception _ #:continuable? _)\r\n  1685:16  0 (raise-exception _ #:continuable? _)\r\n\r\nice-9/boot-9.scm:1685:16: In procedure raise-exception:\r\nIn procedure struct-vtable: Wrong type argument in position 1 (expecting struct): #f\r\n```",
      "created_at" : "2022-10-20T15:25:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26351#issuecomment-1285742288",
      "id" : 1285742288,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26351",
      "node_id" : "IC_kwDOABII585Mot7Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285742288/reactions"
      },
      "updated_at" : "2022-10-20T16:44:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285742288",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "As [discussed on IRC](https://gnusha.org/bitcoin-builds/2022-10-21.log) bumping the time machine hash may create more problems than it solves. I'll leave this PR open until there's a workaround for OpenSSL v1.1.1p.",
      "created_at" : "2022-10-21T07:34:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26351#issuecomment-1286575555",
      "id" : 1286575555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26351",
      "node_id" : "IC_kwDOABII585Mr5XD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286575555/reactions"
      },
      "updated_at" : "2022-10-21T07:34:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286575555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Found the workaround for OpenSSL v1.1.1p",
      "created_at" : "2022-11-03T12:04:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26351#issuecomment-1302001850",
      "id" : 1302001850,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26351",
      "node_id" : "IC_kwDOABII585Nmvi6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302001850/reactions"
      },
      "updated_at" : "2022-11-03T12:04:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302001850",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
