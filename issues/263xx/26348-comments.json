[
   {
      "author_association" : "MEMBER",
      "body" : "Isn't this already policy-accepted for P2SH, Segwit, and Taproot? Is there a benefit to having it raw?",
      "created_at" : "2022-10-20T03:56:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1284887445",
      "id" : 1284887445,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585MldOV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1284887445/reactions"
      },
      "updated_at" : "2022-10-20T03:56:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1284887445",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Interesting Script edge case!\r\n\r\nYou must have balanced the cost of proposing this standardness rule change, and making a PR touching consensus code, with switching to using Segwit scripts (either v0 or v1) which don't have this limitation (and have other advantages). Is there a particular reason why you can't migrate to Segwit?\r\n\r\n> Motivation for Changing Bitcoin's standard rules\r\n> Since having two execution paths for two different multisigs, one of them usually time-locked, is a very common use case, Bitcoin users can benefit from relaxing the standard rule and making two-paths multisigs standard.\r\nThe alternate way of having two-paths multisigs is by adding the CHECKMULTISIG at the end of every path. However, this reduces the maximum number of functionaries of the first (non time-locked) multisig, since the sum of both must be below 15.\r\n\r\nBitcoin users would probably just do that under P2WSH or Taproot nowadays. And that would be standard. But even under P2SH context it's far from being the only alternative. You could also just count public keys, for instance (untested):\r\n```\r\nIF\r\n  <pk_1> CHECKSIG SWAP\r\n  <pk_2> CHECKSIG ADD SWAP\r\n  ...\r\n  <pk_n> CHECKSIG ADD\r\n  <m> EQUAL\r\nELSE\r\n  <timelock> CSV DROP\r\n  <pk_1'> CHECKSIG SWAP\r\n  <pk_2'> CHECKSIG ADD SWAP\r\n  <pk_3'> CHECKSIG ADD SWAP\r\n  <pk_4'> CHECKSIG ADD\r\n  <3> EQUAL\r\nENDIF\r\n```\r\n\r\nFor a small number of pubkeys this is standard under P2SH, and the next limit you'd hit would probably be `MAX_SCRIPT_ELEMENT_SIZE` that limits the size of the redeem Script.\r\n\r\nWriting Scripts by hand is a huge footgun, and we now have [tooling to do that safely](https://bitcoin.sipa.be/miniscript/). The implementation of Miniscript in Bitcoin Core does not support P2SH context. But [other implementations do](https://github.com/rust-bitcoin/rust-miniscript) if you really can't migrate to at least Segwit v0.",
      "created_at" : "2022-10-20T08:59:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1285179390",
      "id" : 1285179390,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Mmkf-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285179390/reactions"
      },
      "updated_at" : "2022-10-20T08:59:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285179390",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [JeremyRubin](https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301013734) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#13525](https://github.com/bitcoin/bitcoin/pull/13525) (policy: Report reason inputs are nonstandard from AreInputsStandard by Empact)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-10-20T09:29:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1285222179",
      "id" : 1285222179,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Mmu8j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285222179/reactions"
      },
      "updated_at" : "2022-12-10T09:22:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285222179",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> You must have balanced the cost of proposing this standardness rule change, and making a PR touching consensus code, with switching to using Segwit scripts (either v0 or v1) which don't have this limitation (and have other advantages)\r\n\r\nThe cost for the RSK community to modify RSK to switch to segwit is very high, as it is a hard-fork. All the code that produces and interprets Bitcoin transactions is consensus code in RSK. \r\nOur current highest priority is to unblock the funds in the peg (currently one or more mining pools will temporarily help RSK to deliver the non-standard transactions into blocks, but this is far from ideal, as it affects RSK decentralization). \r\nWe cannot migrate to segwit as an emergency hard-fork. It would need months of development, months of testing, more months for activation on testnet, etc. We have already created a patch to migrate to the following redeem script:\r\n\r\n```\r\nOP_NOTIF \r\n\t...\r\n\tOP_PUSHNUM_N \r\n\tOP_CHECKMULTISIG\r\nOP_ELSE \r\n\tâ¦\r\n\tOP_PUSHNUM_4 \r\n        OP_CHECKMULTISIG\r\nOP_ENDIF \r\n\r\n```\r\nBut this is still a hard-fork, and the full upgrade can take several weeks, considering the public review stage and all further stages.\r\n\r\nThe RSK community mid-term plan is to migrate to segwit. \r\n\r\nRegarding touching the consensus code, I firmly believe that GetSigOpCount() should be split in two functions: one that is called only by consensus code and one that is only called by AreInputsStandard(). This is obvious to me, since the standard rules can change over time, but not the consensus rules, and there is a real risk that a tweak of the standard rules ends up hiding an unintended consensus change. I was surprised to discover that GetSigOpCount() is called by consensus code with fAccurate==true and fAccurate==false, so basically that function should be set in stone.\r\n\r\nTherefore, even if the you are in doubt if the addition of two-paths multisigs is a benefit, I hope you still see the benefit to split GetSigOpCount() into two initially mirrored functions with different names, and we can do this in a separate PR.\r\n\r\n",
      "created_at" : "2022-10-20T15:54:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1285796241",
      "id" : 1285796241,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Mo7GR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285796241/reactions"
      },
      "updated_at" : "2022-10-20T15:55:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285796241",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Isn't this already policy-accepted for P2SH, Segwit, and Taproot? Is there a benefit to having it raw?\r\n\r\nIt's not accepted in P2SH. That's the problem.\r\n",
      "created_at" : "2022-10-20T15:57:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1285799557",
      "id" : 1285799557,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Mo76F",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285799557/reactions"
      },
      "updated_at" : "2022-10-20T15:57:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1285799557",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I understand the urgency for the RSK community. To be clear i'm not opposing relaxing this standardness rule on its own, i'm just questioning whether it's worth it.\r\n\r\nYou mention the mid-term plan is for RSK to migrate to Segwit. But proposing a standardness rule change does not seem like a short-term plan to me: even in the best case scenario that this PR is getting enough interest, review (i haven't looked at the code yet but it's currently failing CI) and gets eventually merged before the next release branch-off, then that a release gets shipped with the new standardness rule and that at least part of the nodes and hashrate upgrade to this new rule. That's what, 1 year at least before your transactions get relayed? Is it reasonable to rely on direct communication with mining pools for that long? And won't the switch to Segwit happen before that?",
      "created_at" : "2022-10-21T11:00:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1286800067",
      "id" : 1286800067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585MswLD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286800067/reactions"
      },
      "updated_at" : "2022-10-21T11:00:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286800067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I've thought more about @darosior comment. \r\nHonestly, currently a review of this patch by bitcoin core developers is important to the bitcoin miners that will process (and help) the Rootstock community by mining the non-standard transactions required to migrate the funds to an updated script, so that there is a zero chance they create an invalid block.\r\n\r\nTherefore, even if the patch is not merged into Bitcoin, by reviewing the patch and giving your thumbs up that the code is sound, you're helping also the rootstock community. ",
      "created_at" : "2022-11-02T13:26:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1300405097",
      "id" : 1300405097,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Ngptp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1300405097/reactions"
      },
      "updated_at" : "2022-11-02T13:26:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1300405097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Regarding the CI failure, I fixed it. But this brings an interesting topic to discuss (separate of this patch):\r\n\r\nInvalid scripts are detected obviously at some later moment and transactions containing invalid scripts are never accepted into the memory pool.\r\nHowever, in case GetStandardSigOpCount() detects and invalid script (i.e. staring with ENDIF)  it's difficult to decide what GetStandardSigOpCount() should return.  If it returns 0, you let a script containing too many checksigs be executed by the node. This is bad, but gives the node the opportunity to ban the peer that sent the invalid transaction. If it returns a high value, you avoid high computations, but at the same time you do not get the chance to penalize the peer that sent the bad transaction.\r\n\r\nTo summarize, on an invalid script detected:\r\n\r\noption 1) return 20 -> avoid heavy computations, do not penalize\r\noption 2) return 0 -> let  heavy computations be performed, penalize\r\noption 3) continue but  revert to how the old GetSigOpCount() worked\r\n\r\nMy code currently does 3, from the point the script is detected as invalid.",
      "created_at" : "2022-11-02T13:32:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1300412192",
      "id" : 1300412192,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Ngrcg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1300412192/reactions"
      },
      "updated_at" : "2022-11-02T13:32:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1300412192",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tend to agree with darosior, see also the comment by achow101 in https://github.com/bitcoin/bitcoin/issues/20178#issuecomment-1293944720 .\r\n\r\nSo if it is not a goal to get this patch merged, it might be easier to comment out the `return false` in the policy check and send that patch to a miner along with your transaction.",
      "created_at" : "2022-11-02T13:37:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1300418783",
      "id" : 1300418783,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585NgtDf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1300418783/reactions"
      },
      "updated_at" : "2022-11-02T13:37:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1300418783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "But by changing our script to `IF ... <n> CHECKMULTISIG ELSE ... <q> CHECKMULTISIG ENDIF` we have to reduce the number of signatories from n=15 to n=11 (because the emergency multisig consumes 4 (q=4)). \r\n\r\nThis patch enables RSK to go back to having 15 signatories in one year.",
      "created_at" : "2022-11-02T17:40:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301000985",
      "id" : 1301000985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Ni7MZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301000985/reactions"
      },
      "updated_at" : "2022-11-02T17:40:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301000985",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Tend to agree with darosior, see also the comment by achow101 in [#20178 (comment)](https://github.com/bitcoin/bitcoin/issues/20178#issuecomment-1293944720) .\r\n> \r\n> So if it is not a goal to get this patch merged, it might be easier to comment out the `return false` in the policy check and send that patch to a miner along with your transaction.\r\n\r\nyou misunderstand: if core does not merge this patch, a sufficient number of miners will change to a proprietary ruleset to support rootstock. it would be a mistake, IMO, for core to not try to match the policy miners will adopt in a case like this.",
      "created_at" : "2022-11-02T17:52:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301013311",
      "id" : 1301013311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Ni-M_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301013311/reactions"
      },
      "updated_at" : "2022-11-02T17:52:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301013311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "strong concept ACK, will need to review the particulars of the patch.",
      "created_at" : "2022-11-02T17:52:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301013734",
      "id" : 1301013734,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Ni-Tm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301013734/reactions"
      },
      "updated_at" : "2022-11-02T17:52:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301013734",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think @darosior has already said what I would say. 15 sig limit seems like the limit due to legacy p2sh(unless you put all keys behind hashes, havent worked all that out), and future tooling subsumes this discussion post-segwit. So we're left with the immediate issue at hand.\r\n\r\nAnother alternative would be to ask RSK miners to mine these transactions directly?\r\n",
      "created_at" : "2022-11-02T20:04:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301166515",
      "id" : 1301166515,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Njjmz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301166515/reactions"
      },
      "updated_at" : "2022-11-02T20:04:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301166515",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Only a single level of nesting is supported. \"IF ELSE ENDIF CHECKMULTISIG\" is supported but \"IF IF ENDIF ENDIF CHECKMULTISIG\" is not supported.\r\n> There must be only two paths (IF ELSE ELSE ELSE ENDIF CHECKMULTISIG\" not supported).\r\n\r\nWas this chosen for a particular reason? Most of the patch complexity appears to be this restriction.",
      "created_at" : "2022-11-02T20:13:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301174848",
      "id" : 1301174848,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585NjlpA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301174848/reactions"
      },
      "updated_at" : "2022-11-02T20:13:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301174848",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> if core does not merge this patch, a sufficient number of miners will change to a proprietary ruleset to support rootstock. it would be a mistake, IMO, for core to not try to match the policy miners will adopt in a case like this.\r\n\r\nStrongly disagree. Miners should aim to match nodes, not vice-versa.",
      "created_at" : "2022-11-03T01:09:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301537982",
      "id" : 1301537982,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Nk-S-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301537982/reactions"
      },
      "updated_at" : "2022-11-03T01:09:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301537982",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "i don't think that's particularly true to how the mempool is used today. for example, fee estimation uses transactions that miners likely have to estimate how much fee to pay to be in the percentile desired by the user. if the user nodes do not have transactions that miners have, then the users fee estimation will be off, which is not incentive aligned for those users. so the users will want to -- especially in \"benign\" cases like this -- want to match miner policy.",
      "created_at" : "2022-11-03T01:24:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301544655",
      "id" : 1301544655,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Nk_7P",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301544655/reactions"
      },
      "updated_at" : "2022-11-03T01:24:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1301544655",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > Only a single level of nesting is supported. \"IF ELSE ENDIF CHECKMULTISIG\" is supported but \"IF IF ENDIF ENDIF CHECKMULTISIG\" is not supported.\r\n> > There must be only two paths (IF ELSE ELSE ELSE ENDIF CHECKMULTISIG\" not supported).\r\n> \r\n> Was this chosen for a particular reason? Most of the patch complexity appears to be this restriction.\r\n\r\nOn the contrary, making it work for arbitrary IF-nesting requires using an additional stack, which brings the same complexities as normal script execution. Also, AFAIK the policy regarding standard transaction rules has always been to enable the minimum subset of standard scripts to cover existing use cases, as an additional security barrier. Right?\r\n\r\n",
      "created_at" : "2022-11-04T02:51:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1302889491",
      "id" : 1302889491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585NqIQT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302889491/reactions"
      },
      "updated_at" : "2022-11-04T02:51:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302889491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > if core does not merge this patch, a sufficient number of miners will change to a proprietary ruleset to support rootstock. it would be a mistake, IMO, for core to not try to match the policy miners will adopt in a case like this.\r\n> \r\n> Strongly disagree. Miners should aim to match nodes, not vice-versa.\r\n\r\nI appreciate the interesting discussion regarding who establishes the mempool policy, and I think this is a hot topic right now,  but in this particular case, that political discussion will just obfuscate the simple fact that enabling a two-path multisig is a simple, concrete, rational, logical and necessary step to support the federated networks use case. The existence of the Rootstock sidechain is a proof that the two-path multisig script is useful.\r\n\r\nTemporarily some miners will apply this patch, and then the rootstock community will switch to an alternate script (that supports less signatories) so that miners can later revert the patch. \r\nBut the expectation in the rootstock community is that Rootstock can go back to the previous script in ~1 year if most Bitcoin nodes and miners consider this script standard. Switching to segwit IS an alternative, but the rootstock core devs are extremely caution on upgrading this core functionality of Rootstock, as the risks are high.\r\n \r\n ",
      "created_at" : "2022-11-04T03:06:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1302897478",
      "id" : 1302897478,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585NqKNG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302897478/reactions"
      },
      "updated_at" : "2022-11-04T03:06:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1302897478",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Apologies, I actually missed the crux of the solution here. I now know why the complexity is here.\r\n\r\n> Also, AFAIK the policy regarding standard transaction rules has always been to enable the minimum subset of standard scripts to cover existing use cases, as an additional security barrier. Right?\r\n\r\nThere is a counter-balance to making sure the new check isn't too complex, as there is a maintenance trade-off as well cost if we get the correctness wrong and it shuts off other scripts' standardness. If something was extremely simple and relaxed a bit further, it's worth consideration.\r\n\r\nf.e. we could relax `MAX_P2SH_SIGOPS` to exactly `MAX_PUBKEYS_PER_MULTISIG`. I'll leave you as the bitcoin script expert to tell me how bad that could be for legacy performance in adversarial case :)",
      "created_at" : "2022-11-04T13:52:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1303577306",
      "id" : 1303577306,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585NswLa",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1303577306/reactions"
      },
      "updated_at" : "2022-11-04T13:52:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1303577306",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "What is the current standard limit on the number of sigops in a P2WSH redeem script ?\r\nIt seems there is no per-script limit, but only a per-transaction limit.",
      "created_at" : "2022-11-14T21:46:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1314450223",
      "id" : 1314450223,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585OWOsv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1314450223/reactions"
      },
      "updated_at" : "2022-11-14T21:52:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1314450223",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "`static constexpr unsigned int MAX_STANDARD_TX_SIGOPS_COST{MAX_BLOCK_SIGOPS_COST/5};`\r\n",
      "created_at" : "2022-11-14T21:59:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1314462412",
      "id" : 1314462412,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585OWRrM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1314462412/reactions"
      },
      "updated_at" : "2022-11-14T21:59:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1314462412",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Theoretically, if every opcode in the script is a checksig, you can do 10k checks per script in P2WSH vs just 15 in P2SH. It seems that the only reason for such gap in cost is quadratic-hashing attacks.  Segwit checksigs do not force script [re-hashing](https://bitcointalk.org/?topic=140078), and that's why the limit is much much higher \r\n\r\nTherefore we can assume that MAX_P2SH_SIGOPS being low is a protection against quadratic-hashing attacks. When this limit was introduced (2014, see commit [here](https://github.com/bitcoin/bitcoin/commit/7f3b4e95695d50a4970e6eb91faa956ab276f161) and rationale [here](https://gist.github.com/gavinandresen/88be40c141bc67acb247)), the problem was already known (I reported it in 2013).\r\n\r\nTherefore, changing MAX_P2SH_SIGOPS to match exactly MAX_PUBKEYS_PER_MULTISIG, even if trivial, slightly degrades Bitcoin's DoS security.\r\n\r\nThe patch I propose is a little more complex but does not reduce the DoS security of Bitcoin in any way.\r\n",
      "created_at" : "2022-11-15T22:33:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1315957004",
      "id" : 1315957004,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585Ob-kM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1315957004/reactions"
      },
      "updated_at" : "2022-11-15T22:33:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1315957004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=4",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "node_id" : "MDQ6VXNlcjE3NTIzNDc=",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Therefore we can assume that MAX_P2SH_SIGOPS being low is a protection against quadratic-hashing attacks.\r\n\r\nI think `MAX_P2SH_SIGOPS` is just `floor(MAX_SCRIPT_ELEMENT_SIZE/CPubKey::COMPRESSED_SIZE) = floor(520/33) = floor(15.75..)` -- so the only way you could have more sigops than that is if you're doing multiple signatures by the same key (via `OP_DUP`) or if you're letting the signer provide keys as part of the p2sh stack.\r\n\r\nAs a result, I don't see how you get more than 10 normal keys in the script you've presented in the first place: the `NOTIF .. ELSE <h> CSV DROP 3 <e1> <e2> <e3> <e4> 4 ENDIF CHECKMULTISIG` part of your script will consume 148 bytes, leaving only 372 bytes for `<m> <key1> .. <keyn> <n>` which for n=10 consumes 342 bytes, and for n=11 would already overflow at 376 bytes. I believe that would cause a `SCRIPT_ERR_PUSH_SIZE` on the first run through of `EvalScript`, prior to the `SCRIPT_VERIFY_P2SH` run.\r\n\r\nPlaying with miniscript suggests a solution:\r\n\r\n```\r\nIF\r\n  DUP HASH160 <hash(K1)> EQUALVERIFY CHECKSIG TOALT\r\n  DUP HASH160 <hash(K2)> EQUALVERIFY CHECKSIG FROMALT ADD TOALT\r\n  ..\r\n  DUP HASH160 <hash(Kn)> EQUALVERIFY CHECKSIG FROMALT ADD\r\n  <m>\r\nELSE\r\n  DUP HASH160 <hash(E1)> EQUALVERIFY CHECKSIG TOALT\r\n  DUP HASH160 <hash(E2)> EQUALVERIFY CHECKSIG FROMALT ADD TOALT\r\n  DUP HASH160 <hash(E3)> EQUALVERIFY CHECKSIG FROMALT ADD TOALT\r\n  DUP HASH160 <hash(E4)> EQUALVERIFY CHECKSIG FROMALT ADD\r\n  <d> CSV DROP\r\n  3\r\nENDIF\r\nEQUAL\r\n```\r\n\r\nwhich would let you have n=14 via a 508 byte script (n=15 gives a 536 byte script). (If your emergency keys are also valid for regular usage, you could increase that up to n=18).\r\n\r\nIn general, the pkh approach would allow up to 20 distinct keys in a p2sh script (eg, if you wanted a 20-of-20 multisig), absent the `MAX_P2SH_SIGOPS` restriction. That makes me lean towards thinking it could make sense to increase `MAX_P2SH_SIGOPS` to 20.\r\n\r\n> Therefore, changing MAX_P2SH_SIGOPS to match exactly MAX_PUBKEYS_PER_MULTISIG, even if trivial, slightly degrades Bitcoin's DoS security.\r\n\r\nI don't think this is meaningfully true? You get `O(N**2)` hashing due to `N` being the number of signatures across the entire transaction (and also proportional to the overall size of the transaction), not just for a single input; so, assuming you're constrained to spending p2sh inputs, a 100kB tx would go from perhaps 1455 signatures (144MB of hashed data) to 1480 signatures (146MB of hashed data). (If you're able to construct bare multisig inputs, then you can do 1560 sigs in a standard tx (155MB of hashed data), though the setup for your attack will then be visible).\r\n\r\nI'm assuming a p2sh script of `<n> <pubkey> {DUP}*n <n> CHECKMULTISIG` for `n` equals 15 or 20 and that the signatures set R=G/2, to generate those numbers; I haven't checked how legacy hashing works in detail to be sure that actually generates `n` hashes over the entire tx rather than having some things cached.  Presuming you can't reuse signatures, and each signature is at least [57 bytes](https://lists.linuxfoundation.org/pipermail/lightning-dev/2015-November/000344.html) then a 100kB tx can't contain more than 1754 signatures, providing an upper bound of 175MB of hashing, presuming the interpreter is clever enough to only do one hash per signature.\r\n\r\nIn the worst conceivable case, where you somehow achieve 15 sigops with a 107 byte script (34 bytes to push a pubkey, 58 bytes to push a tiny exploitable signature, and 15 opcodes to generate 15 sigops from that), that would result in a 100kB tx requiring 1GB of hashing, while having 20 opcodes generate 20 sigops would result in 1.3GB of hashing (ie a 29% increase, vs the 33% increase of 20 vs 15).\r\n\r\nIf you're a miner, you're not constrained to 100kB txs, but in that case you're also not constrained by MAX_P2SH_SIGOPS either.\r\n\r\nSo in conclusion:\r\n * I think that the `IF .. n CHECKMULTISIG ELSE .. 4 CHECKMULTISIG ENDIF` [approach](https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1301000985) is strictly superior to the original proposal, as neither are able to support n>11.\r\n * For a short-term workaround, if I were a miner, I think the lower complexity of just increasing MAX_P2SH_SIGOPS from 15 to 20 is more appealing than running this patch.\r\n * I think RSK switching to segwit or taproot makes more sense than spending much development effort here\r\n * If RSK or others really want to do n>11 via p2sh and not p2wsh/p2tr, then increasing MAX_P2SH_SIGOPS from 15 to 20 in general seems plausible to me, but it's not at all clear it's worth the effort of either being sure that it doesn't make quadratic hashing more problematic, or improving the interpreter's caching to prevent that from being a problem.",
      "created_at" : "2022-12-10T09:22:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1345194305",
      "id" : 1345194305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585QLglB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345194305/reactions"
      },
      "updated_at" : "2022-12-10T09:22:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345194305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Related: https://github.com/bitcoin/bitcoin/issues/2256",
      "created_at" : "2022-12-10T09:53:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1345203367",
      "id" : 1345203367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585QLiyn",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345203367/reactions"
      },
      "updated_at" : "2022-12-10T09:53:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345203367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think RSK switching to segwit or taproot makes more sense than spending much development effort here\r\n\r\nissue seems to be that there are existing coins stuck because of this.",
      "created_at" : "2022-12-11T00:47:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1345420851",
      "id" : 1345420851,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585QMX4z",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345420851/reactions"
      },
      "updated_at" : "2022-12-11T00:47:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345420851",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > I think RSK switching to segwit or taproot makes more sense than spending much development effort here\r\n> \r\n> issue seems to be that there are existing coins stuck because of this.\r\n\r\nThe RSK mainnet address on bitcoin is https://mempool.space/address/3DsneJha6CY6X9gU2M9uEc4nSdbYECB4Gh which has no spends so does seem stuck, but I haven't been able to reconstruct the redeemScript that corresponds to that address. The commit_federation tx that updated to that address on the RSK chain seems to be https://explorer.rsk.co/tx/0x83708fd332cbe0f9614dd61d0c95c729aded0b7a94d793f22412493d6f867b43?__ctab=Logs but that just has the address hardcoded in the data as hex, and as far as I've tried, I can't make the newFederationBtcPublicKeys listed there and any of the script templates and emergency keys match up with the 3Dsne address; there's a tool at https://github.com/rsksmart/powpeg-details/ that seems like it should be able to provide the redeem script, but also doesn't seem to produce a match (it doesn't help that there seems to have been a [bug](https://github.com/rsksmart/rskj/pull/1826/commits/e8fb2c3fe9b8021af263b3a0f5738547545ecb05) where the CSV value was pushed with the wrong endinaness in some versions).\r\n\r\nThat stops me from being able to confirm that increasing MAX_P2SH_SIG_OPS actually unsticks these transactions.\r\n\r\nIf increasing MAX_P2SH_SIG_OPS does fix the problem, I think that is the immediate fix, and switching to `IF .. CHECKMULTSIG ELSE .. CHECKMULTISIG ENDIF` (see [RSKIP353](https://github.com/rsksmart/RSKIPs/blob/master/IPs/RSKIP353.md)) is the short/medium term solution (hopefully prior to switching to segwit/taproot over the medium/long term).\r\n\r\nSome RSK addresses on bitcoin testnet are:\r\n\r\n * https://mempool.space/testnet/address/2N1rW3cBZNzs2ZxSfyNW7cMcNBktt6fzs88 (post RSKIP353) \r\n * https://mempool.space/testnet/address/2NF9ndVaez5owUShjSxNnY2E31QkRjLu63k (post RSKIP353)\r\n * https://mempool.space/testnet/address/2N1y7hSneV9HuWnpLTtGqdRnway1Ag3dQoj (suffering from the bug here)\r\n\r\nThose at least seem like they match the script template in the way I'd expect.",
      "created_at" : "2022-12-11T04:02:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1345450658",
      "id" : 1345450658,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585QMfKi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345450658/reactions"
      },
      "updated_at" : "2022-12-11T04:02:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345450658",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> and as far as I've tried, I can't make the newFederationBtcPublicKeys listed there and any of the script templates and emergency keys match up with the 3Dsne address;\r\n\r\nApparently I failed to sort the emergency keys correctly. The redeemScript is `645521020ace50bab1230f8002a0bfe619482af74b338cc9e4c956add228df47e6adae1c210231a395e332dde8688800a0025cccc5771ea1aa874a633b8ab6e5c89d300c7c3621025093f439fb8006fd29ab56605ffec9cdc840d16d2361004e1337a2f86d8bd2db21026b472f7d59d201ff1f540f111b6eb329e071c30a9d23e3d2bcd128fe73dc254c2103250c11be0561b1d7ae168b1f59e39cbc1fd1ba3cf4d2140c1a365b2723a2bf93210357f7ed4c118e581f49cd3b4d9dd1edb4295f4def49d6dcf2faaaaac87a1a0a422103ae72827d25030818c4947a800187b1fbcc33ae751e248ae60094cc989fb880f62103e05bf6002b62651378b1954820539c36ca405cbb778c225395dd9ebff67802992103ecd8af1e93c57a1b8c7f917bd9980af798adeb0205e9687865673353eb041e8d59670350cd00b275532102370a9838e4d15708ad14a104ee5606b36caaaaf739d833e67770ce9fd9b3ec80210257c293086c4d4fe8943deda5f890a37d11bebd140e220faa76258a41d077b4d42103c2660a46aa73078ee6016dee953488566426cf55fc8011edd0085634d75395f92103cd3e383ec6e12719a6c69515e5559bcbe037d0aa24c187e1e26ce932e22ad7b35468ae`\r\n\r\nSo I think that confirms that changing MAX_P2SH_SIGOPS is a sufficient fix, and I've made a patchset which is available at https://github.com/ajtowns/bitcoin/tree/202212-rsk-p2sh-sigops . That only touches policy and test code so is hopefully fairly easy to verify for correctness, and should be a trivial merge on top of either 24.0.1 or master.\r\n\r\nI'm not sure if it would make sense to merge in general though, as the risk of expanding the attack service for quadratic hashing does exist, and the benefits of being able to do weird multisig things in p2sh rather than switching to segwit or taproot seem very small.\r\n\r\nEven if it's not merged in core, I think it would be reasonable for miners to run that patch temporarily in order to unstick RSK peg-out transactions, without requiring constant manual intervention.\r\n\r\nIf a miner really wanted to make sure that they don't introduce additional quadratic hashing risk, then I think you could set things up as follows:\r\n\r\n * public node 1, with `MAX_P2SH_SIGOPS=20` and `-limitancestorsize=86`\r\n * public node 2, default settings, with `MAX_P2SH_SIGOPS` unchanged at 15 -- presumably advertised somehow to RSK folks can manually connect to it and send txs.\r\n * private node, producing block templates for mining, connected to public node 1 and 2, with `MAX_P2SH_SIGOPS=20` and the default `-limitancestorsize`\r\n\r\nSetting `limitancestorsize` would mean that even if the increase in MAX_P2SH_SIGOPS allows you to do an additional 33% of sighash operations per byte, you're reducing both the bytes that you're hashing and the number of sighash operations to 86%, and `86%*86%*133% < 100%`. Past RSK txs seem to be capped at either 50 inputs or 50kB, either of which should work fine with that limitation.",
      "created_at" : "2022-12-20T10:36:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1359155300",
      "id" : 1359155300,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585RAxBk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1359155300/reactions"
      },
      "updated_at" : "2022-12-20T10:36:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1359155300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Spends seem to be going through on occasion now, eg: https://mempool.space/tx/b3ade8b5d893da6a76f1977ea27352ab1cac679eb5d950793161607088f01c14 albeit at relatively high fee rates, and the hard fork to a p2sh script that is spendable with current standardness rules is apparently due to activate ~tomorrow https://blog.rsk.co/noticia/rsk-hop-4-0-1-and-4-1-1-are-here-mainnet-versions/",
      "created_at" : "2023-01-15T08:30:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1383088148",
      "id" : 1383088148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585ScEAU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1383088148/reactions"
      },
      "updated_at" : "2023-01-15T08:30:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1383088148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Setting limitancestorsize would mean that even if the increase in MAX_P2SH_SIGOPS allows you to do an additional 33% of sighash operations per byte, you're reducing both the bytes that you're hashing and the number of sighash operations to 86%, and 86%*86%*133% < 100%. Past RSK txs seem to be capped at either 50 inputs or 50kB, either of which should work fine with that limitation.\r\n\r\nThis seems like a safe way to preserve the cap on sighashing while permitting these transactions.\r\n\r\n>  the hard fork to a p2sh script that is spendable with current standardness rules is apparently due to activate ~tomorrow https://blog.rsk.co/noticia/rsk-hop-4-0-1-and-4-1-1-are-here-mainnet-versions/\r\n\r\nAm I correct in understanding that, in addition to changing future redeemScripts, the hard fork (namely RSKIP357) increases the window within which RSK will try to get nonstandard migration transactions mined, i.e. RSK still needs some miner to include the nonstandard txns? Hoping to clarify whether the hard fork by itself automatically unblocks all stuck funds, my understanding is it doesn't (?).",
      "created_at" : "2023-01-16T11:58:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1383943774",
      "id" : 1383943774,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585SfU5e",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1383943774/reactions"
      },
      "updated_at" : "2023-01-16T12:09:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1383943774",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Am I correct in understanding that, in addition to changing future redeemScripts, the hard fork (namely RSKIP357) increases the window within which RSK will try to get nonstandard migration transactions mined, i.e. RSK still needs some miner to include the nonstandard txns? Hoping to clarify whether the hard fork by itself automatically unblocks all stuck funds, my understanding is it doesn't (?).\r\n\r\nMy understanding is the \"stuck\" funds are in [3DsneJha6CY6X9gU2M9uEc4nSdbYECB4Gh](https://mempool.space/address/3DsneJha6CY6X9gU2M9uEc4nSdbYECB4Gh) (~~2616 BTC~~ currently [EDIT: not sure how I got this wrong, but it should have been 3486 BTC?]) and need to be moved to whatever the new address is, once the new address is agreed upon. The timeline for that happening once the new address has been determined is increased by ~16x, from ~3.5 days to ~60 days. Once the new address is chosen and the 60 days are up, there shouldn't be any funds left in the 3Dsne address, so no further non-standard transactions should be needed. As I understand it, anyway.",
      "created_at" : "2023-01-16T14:22:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1384140396",
      "id" : 1384140396,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585SgE5s",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384140396/reactions"
      },
      "updated_at" : "2023-02-02T09:30:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384140396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The stuck funds have been moved to [35iEoWHfDfEXRQ5ZWM5F6eMsY2Uxrc64YK](https://mempool.space/address/35iEoWHfDfEXRQ5ZWM5F6eMsY2Uxrc64YK) which has successfully been spent from in tx [67e950218f85cf1c35ffcb0aad2436822b1de96c9d68a17ac8d9a14c4a02a85c](https://mempool.space/tx/67e950218f85cf1c35ffcb0aad2436822b1de96c9d68a17ac8d9a14c4a02a85c) (and that tx appears to have at least made it into my mempool when broadcast, prior to being mined). There's still about 0.0134 BTC in the old stuck address; meanwhile the new address now holds about 3476 BTC (funds were unstuck in block 773957, mined by marapool).\r\n\r\nSo I think this PR can be closed?",
      "created_at" : "2023-02-02T06:56:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1413238861",
      "id" : 1413238861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585UPFBN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1413238861/reactions"
      },
      "updated_at" : "2023-02-02T07:00:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1413238861",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Going to close this for now.",
      "created_at" : "2023-02-02T10:20:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26348#issuecomment-1413492417",
      "id" : 1413492417,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26348",
      "node_id" : "IC_kwDOABII585UQC7B",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1413492417/reactions"
      },
      "updated_at" : "2023-02-02T10:20:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1413492417",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
