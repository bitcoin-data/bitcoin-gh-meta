[
   {
      "author_association" : "MEMBER",
      "body" : "Looks like the UI model is not updated if `fQueueNotifications`, which happens if anything is in progress:\r\nhttps://github.com/bitcoin/bitcoin/blob/4c4ff4911a6dbf1555fb4cfc05092cb8fe2f9eba/src/qt/transactiontablemodel.cpp#L707-L722\r\n\r\nCouldn't we trigger the crash in this case?",
      "created_at" : "2019-09-25T22:58:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16952#issuecomment-535256201",
      "id" : 535256201,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16952",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNTI1NjIwMQ==",
      "updated_at" : "2019-09-25T22:58:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/535256201",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK addaf8af8268d918973883a304025d40af5a33c1 - tested that this fixes #16950\r\n\r\n> Couldn't we trigger the crash in this case?\r\n\r\nYes you can. Using this branch (addaf8af8268d918973883a304025d40af5a33c1), I triggered a rescan, called `removeprunedfunds` and tried opening the info dialog of the tx in the GUI:\r\n\r\n```bash\r\n* thread #1, name = 'bitcoin-main', queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x18)\r\n    frame #0: 0x00000001000bc638 bitcoin-qt`TransactionDesc::toHTML(interfaces::Node&, interfaces::Wallet&, TransactionRecord*, int) [inlined] std::__1::vector<CTxOut, std::__1::allocator<CTxOut> >::begin(this=0x0000000000000018 size=0) const at vector:1519:30 [opt]\r\n   1516\ttypename vector<_Tp, _Allocator>::const_iterator\r\n   1517\tvector<_Tp, _Allocator>::begin() const _NOEXCEPT\r\n   1518\t{\r\n-> 1519\t    return __make_iter(this->__begin_);\r\n   1520\t}\r\n   1521\t\r\n   1522\ttemplate <class _Tp, class _Allocator>\r\nTarget 0: (bitcoin-qt) stopped.\r\n```\r\n\r\nHowever, I'm not sure  fixing that (less likely to hit, and likely more involved to fix) case has to block this PR.",
      "created_at" : "2019-09-26T11:27:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16952#issuecomment-535460803",
      "id" : 535460803,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16952",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNTQ2MDgwMw==",
      "updated_at" : "2019-09-26T11:27:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/535460803",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Well maybe deletions shouldn't be queued?\r\n\r\nAgree it's unlikely. Thoughts Jonas?",
      "created_at" : "2019-09-26T11:45:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16952#issuecomment-535466178",
      "id" : 535466178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16952",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNTQ2NjE3OA==",
      "updated_at" : "2019-09-26T11:45:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/535466178",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Perhaps `removeprunedfunds` should fail if a rescan is in progress (etc), but I think that can wait for a separate PR.\r\n\r\ntACK addaf8a: tested with an unpruned wallet by calling `removeprunedfunds` on an RBF-replaced transaction. It neatly disappears from the UI.",
      "created_at" : "2019-09-27T17:01:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16952#issuecomment-536020152",
      "id" : 536020152,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16952",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNjAyMDE1Mg==",
      "updated_at" : "2019-09-27T17:01:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/536020152",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Perhaps `removeprunedfunds` should fail if a rescan is in progress (etc), but I think that can wait for a separate PR.\r\n\r\nJust to avoid the problem in the GUI? AFAIK there's no problem calling `removeprunedfunds` while rescanning in bitcoind.",
      "created_at" : "2019-09-27T21:11:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16952#issuecomment-536097861",
      "id" : 536097861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16952",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNjA5Nzg2MQ==",
      "updated_at" : "2019-09-27T21:11:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/536097861",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Just in general so that concurrency is easier to reason about. But if it already works, don't fix it :-)",
      "created_at" : "2019-09-28T08:10:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16952#issuecomment-536164704",
      "id" : 536164704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16952",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNjE2NDcwNA==",
      "updated_at" : "2019-09-28T08:10:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/536164704",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
