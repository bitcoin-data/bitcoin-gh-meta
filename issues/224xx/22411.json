{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "### Issue\r\nWhat are the rate limits for [`ping`](https://bitcoincore.org/en/doc/0.21.0/rpc/network/ping/) RPC which was added in https://github.com/bitcoin/bitcoin/pull/2937?\r\n\r\nIf no rate limits, do we need them? \r\n\r\n### What behavior did you expect?\r\n\r\nI was expecting some errors in bitcoind or maybe peers ban my node based on the rate limits mentioned in https://bitcointalk.org/index.php?topic=279652.msg3002232#msg3002232\r\n\r\n> I added a ratelimit to RPC-requested ping, so that it will limit to 1/second per peer.  The regular automated keepalive ping is immune to this.\r\n\r\nBut this comment says there is no rate limit:\r\n\r\n> Got rid of the idea of rate-limiting user-requested RPC pings, that simplifies a chunk of code.\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/2937#issuecomment-23245689\r\n\r\n### What was the actual behavior ?\r\n\r\nNo errors. Peers did not ban my node. I was sending 50-100 `ping` per second\r\n\r\n### How reliably can you reproduce the issue, what are the steps to do so?\r\n\r\nIts easy to reproduce. Everyone can use different ways to send `ping`. I used the below steps:\r\n\r\n1. Run `bitcoind` with bitcoin.conf:\r\n\r\n   ```\r\n   testnet=1\r\n   server=1\r\n   \r\n   test.rpcport=18444\r\n   rpcuser=user3\r\n   rpcpassword=password3\r\n   ```\r\n2. Use intruder in Burp Suite to brute force and send `ping` RPC with different id in each request.\r\n\r\n   Request:\r\n\r\n   ```\r\n   POST / HTTP/1.1\r\n   Host: 127.0.01:18444\r\n   Authorization: Basic dXNlcjM6cGFzc3dvcmQz\r\n   Content-Type: text/plain\r\n   Content-Length: 68\r\n\r\n   {\"jsonrpc\": \"1.0\", \"id\": \"$curltest$\", \"method\": \"ping\", \"params\": []}\r\n   ```\r\n\r\n3. Check peers with `-netinfo` and `getpeerinfo`. Keep an eye on bitcoind for errors.\r\n\r\n```\r\n$ bitcoin-cli -netinfo\r\nBitcoin Core v21.99.0-bb4790816d84 testnet - 70016/Satoshi:21.99.0/\r\n\r\n        ipv4    ipv6   onion   total   block\r\nin         0       0       1       1\r\nout        6       0       4      10       2\r\ntotal      6       0       5      11\r\n\r\nLocal addresses\r\neadtub66sw6z4rtzf753aplvy7psthggirtgowr3rsnebbpsws2vyxyd.onion     port  18333    score      4\r\n\r\n```\r\n\r\n`getpeerinfo` : https://pastebin.com/vKi5sfK2\r\n\r\nRequests sent at 06 Jul 2021 17:28:01 GMT (72111 - 72028 = 83)\r\n\r\n<details><summary>First</summary>\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/124644027-692afc80-deaf-11eb-8fae-a6d6cc56daae.png)\r\n\r\n</details>\r\n\r\n<details><summary>Last</summary>\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/124644109-82cc4400-deaf-11eb-9951-2c7dbe9ec241.png)\r\n\r\n</details>\r\n\r\n### Bitcoin Core version\r\n\r\nBitcoin Core v21.99.0-bb4790816d84 (Had compiled yesterday for testing PR 17355)\r\n\r\n### What type of machine are you observing the error on (OS/CPU and disk type)? \r\n\r\nLinux (Pop!_OS) as VM\r\n\r\nRelated question: https://bitcoin.stackexchange.com/questions/107431/what-is-ping-rpc-used-for\r\n\r\n\r\n",
   "closed_at" : "2021-07-07T07:53:50Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
      "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
      "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/MarcoFalke",
      "id" : 6399679,
      "login" : "MarcoFalke",
      "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
      "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
      "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
      "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/MarcoFalke"
   },
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22411/comments",
   "created_at" : "2021-07-06T18:00:21Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22411/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/22411",
   "id" : 938133097,
   "labels" : [
      {
         "color" : "006688",
         "default" : false,
         "description" : null,
         "id" : 477890092,
         "name" : "Questions and Help",
         "node_id" : "MDU6TGFiZWw0Nzc4OTAwOTI=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Questions%20and%20Help"
      },
      {
         "color" : "0052cc",
         "default" : false,
         "description" : null,
         "id" : 98279177,
         "name" : "RPC/REST/ZMQ",
         "node_id" : "MDU6TGFiZWw5ODI3OTE3Nw==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22411/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU5MzgxMzMwOTc=",
   "number" : 22411,
   "performed_via_github_app" : null,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Rate limits for `ping` RPC",
   "updated_at" : "2021-07-07T07:57:00Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22411",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
      "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
      "followers_url" : "https://api.github.com/users/prayank23/followers",
      "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
      "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/prayank23",
      "id" : 13405205,
      "login" : "prayank23",
      "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
      "organizations_url" : "https://api.github.com/users/prayank23/orgs",
      "received_events_url" : "https://api.github.com/users/prayank23/received_events",
      "repos_url" : "https://api.github.com/users/prayank23/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/prayank23"
   }
}
