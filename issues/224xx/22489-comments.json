[
   {
      "author_association" : "MEMBER",
      "body" : "Does this only occur on signet?",
      "created_at" : "2021-07-18T22:41:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882126090",
      "id" : 882126090,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lC0K",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-18T22:41:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882126090",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I just got this same error on testnet.\r\nSo it is not related to the network. ",
      "created_at" : "2021-07-18T23:09:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882129180",
      "id" : 882129180,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lDkc",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-18T23:09:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882129180",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I just got this same error on testnet.\r\nSo it is not related to the network.\r\n\r\nI get this error when I use `-datadir` while running `bitcoind` and forget to add it in `bitcoin-cli` command.\r\n\r\nMaybe you can try adding `-datadir` if you have used it while running `bitcoind` or check other things which maybe the reason why `bitcoin-cli` is unable to connect with `bitcoind` if it is running.",
      "created_at" : "2021-07-18T23:37:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882133530",
      "id" : 882133530,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lEoa",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-18T23:37:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882133530",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "The reason `bitcoin-cli` cannot connect to `bitcoind` is because this exception causes the node to shut down.\r\n\r\nI'm running the node with `bitcoind -testnet`, so it's getting the default `datadir`, which is `~/.bitcoin/testnet3`.\r\nOr `~/.bitcoin/signet` for signet.\r\n\r\nAfter the error occurred on testnet, I am unable to dump the wallets again on this network. I delete the bitcoin node directory and cloned it again from Github., I also unloaded and loaded the wallet, but the error persists.",
      "created_at" : "2021-07-18T23:48:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882135335",
      "id" : 882135335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lFEn",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-18T23:51:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882135335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This appears to be a race condition between two RPC handler threads. While one thread is running, another one has begun. Are you using `loadwallet` to load the wallet? While the wallet is loading, are you running `dumpwallet` immediately (before `loadwallet` has returned)? Does the wallet being loaded have unconfirmed transactions in the mempool when you loaded it?",
      "created_at" : "2021-07-19T00:26:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882142171",
      "id" : 882142171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lGvb",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T00:26:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882142171",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "1) Are you using loadwallet to load the wallet?\r\nNormally, when the node is started (`bitcoind -testnet`), the wallet is already loaded (it appears in `listwallets`). I run the `dumpwallet` command and the node gets this error.\r\nI tried loading and unloading the wallet to fix the problem, but it had no effect.\r\n\r\n2) While the wallet is loading, are you running dumpwallet immediately ?\r\nNo, I wait for the loading / unloading response.\r\n\r\n3) Does the wallet being loaded have unconfirmed transactions in the mempool when you loaded it?\r\nNo, all transactions have 6 or more confirmations.",
      "created_at" : "2021-07-19T00:58:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882149865",
      "id" : 882149865,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lInp",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T00:58:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882149865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "On signet, I have several wallets (legacy type) and this happens to all of them (since the first time I ran `dumpwallet`).\r\n\r\nOn testnet I only have one legacy type wallet and this command worked for a while. But it stopped working. There was no activity in the wallet between the period it worked and the period it stopped working.",
      "created_at" : "2021-07-19T01:03:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882151404",
      "id" : 882151404,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lI_s",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T01:03:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882151404",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The reason bitcoin-cli cannot connect to bitcoind is because this exception causes the node to shut down.\r\n\r\nInteresting. Just noticed you mentioned node stops after running this command. Maybe title of this issue can be changed to \r\n\r\n```diff\r\n-The dumpwallet RPC command does not work on signet / testnet\r\n+The dumpwallet RPC command stops/kills bitcoind\r\n```\r\n\r\nAlthough I compiled master branch just now and it works fine for me on testnet, regtest and mainnet.\r\n\r\n",
      "created_at" : "2021-07-19T01:17:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882155569",
      "id" : 882155569,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lKAx",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T01:17:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882155569",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@prayank23 Thanks for suggestion.\r\n\r\nThis is weird. What is causing this race condition?\r\nA few minutes ago I ran the command successfully on testnet, but soon after it stopped working.\r\n\r\n",
      "created_at" : "2021-07-19T01:42:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882164954",
      "id" : 882164954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lMTa",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T01:44:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882164954",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Note that this issue is due to the behavior of `DEBUG_LOCKORDER` so to test, you must have configured with `--enable-debug`. This is not something that would occur normally (releases are not compiled with debug), but it could cause a deadlock (hence the error). I am able to replicate this on regtest by first creating an unconfirmed transaction (`sendtoaddress` but don't do `generatetoaddress`), then reloading the wallet (either by restarting bitcoind or `unloadwallet`/`loadwallet`), and finally `dumpwallet`.\r\n\r\nI'm working on a fix.",
      "created_at" : "2021-07-19T01:52:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882169598",
      "id" : 882169598,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lNb-",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T01:52:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882169598",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I can confirm that I was able to run  `dumpwallet` without errors after recompiling the node without `--enable-debug`. ",
      "created_at" : "2021-07-19T02:25:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22489#issuecomment-882184189",
      "id" : 882184189,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22489",
      "node_id" : "IC_kwDOABII5840lQ_9",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T02:25:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882184189",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   }
]
