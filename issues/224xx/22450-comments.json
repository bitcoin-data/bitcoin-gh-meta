[
   {
      "author_association" : "MEMBER",
      "body" : "Another win for fuzzing, oh wow.",
      "created_at" : "2021-07-15T08:53:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-880519934",
      "id" : 880519934,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDUxOTkzNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T08:53:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880519934",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @vasild ",
      "created_at" : "2021-07-15T08:57:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-880522555",
      "id" : 880522555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDUyMjU1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T08:57:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880522555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Fuzzer rulez!",
      "created_at" : "2021-07-15T10:11:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-880572816",
      "id" : 880572816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDU3MjgxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T10:11:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880572816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The repositioning/rebucketing approach of `ResetI2PPorts()` introduced in #22112 seems very brittle. I think it would make much more sense just to remove any I2P addresses which don't have port 0, and then perhaps add them back through the public (and well-tested) `Add()` interface.\r\n\r\nI don't know the exact bug that leads to this internal addrman inconsistency, but this loop seems suspect to me:\r\n\r\n```\r\n    for (int bucket = 0; bucket < ADDRMAN_NEW_BUCKET_COUNT; ++bucket) {\r\n        for (int i = 0; i < ADDRMAN_BUCKET_SIZE; ++i) {\r\n            const auto id = vvNew[bucket][i];\r\n            if (id == -1) {\r\n                continue;\r\n            }\r\n            auto it = mapInfo.find(id);\r\n            if (it == mapInfo.end()) {\r\n                return;\r\n            }\r\n            auto& addr_info = it->second;\r\n            if (!addr_info.IsI2P() || addr_info.GetPort() == I2P_SAM31_PORT) {\r\n                continue;\r\n            }\r\n\r\n            auto addr_info_newport = addr_info;\r\n            // The below changes addr_info_newport.GetKey(), which is used in finding a\r\n            // bucket and a position within that bucket. So a re-bucketing may be necessary.\r\n            addr_info_newport.port = I2P_SAM31_PORT;\r\n\r\n            // Reposition entries of vvNew within the same bucket because we don't know the source\r\n            // address which led to the decision to store the entry in vvNew[bucket] so we can't\r\n            // re-evaluate that decision, but even if we could, CAddrInfo::GetNewBucket() does not\r\n            // use CAddrInfo::GetKey() so it would end up in the same bucket as before the port\r\n            // change.\r\n            const auto i_target = addr_info_newport.GetBucketPosition(nKey, true, bucket);\r\n\r\n            if (i_target == i) { // No need to re-position.\r\n                addr_info = addr_info_newport;\r\n                continue;\r\n            }\r\n\r\n            // Reposition from i to i_target, removing the entry from i_target (if any).\r\n            ClearNew(bucket, i_target);\r\n            vvNew[bucket][i_target] = id;\r\n            vvNew[bucket][i] = -1;\r\n            addr_info = addr_info_newport;\r\n        }\r\n    }\r\n```\r\n\r\nIf the same I2P address appears in multiple new buckets, then the first time this loop finds that address, it'll update the port and reposition it in that bucket. Any subsequent times that the address is encountered, it will already have had its port updated so the inner loop will `continue` due to `addr_info.GetPort() == I2P_SAM31_PORT`, but it'll be in the wrong position in its bucket. If we later try to promote the entry from new to tried, then this loop in `MakeTried()` will fail to find the entry in those buckets:\r\n\r\n```\r\n    // remove the entry from all new buckets\r\n    for (int bucket = 0; bucket < ADDRMAN_NEW_BUCKET_COUNT; bucket++) {\r\n        int pos = info.GetBucketPosition(nKey, true, bucket);\r\n        if (vvNew[bucket][pos] == nId) {\r\n            vvNew[bucket][pos] = -1;\r\n            info.nRefCount--;\r\n        }\r\n    }\r\n    nNew--;\r\n```\r\n\r\nI'm not sure whether this is the exact cause of this assert, but it seems like it could at least lead to inconsistencies. That's always a risk when reaching into the internal data structures of a complex class like addrman.",
      "created_at" : "2021-07-15T11:02:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-880602891",
      "id" : 880602891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDYwMjg5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T11:02:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880602891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "More crashes:\r\n\r\n```\r\n$ FUZZ=addrman_deserialize ./src/test/fuzz/fuzz ./crash-ef7d4a4f940b8fdb4999f6a92969260cf8e1405f.log \r\nINFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 2455641637\r\nINFO: Loaded 1 modules   (228950 inline 8-bit counters): 228950 [0x55bb030060f8, 0x55bb0303df4e), \r\nINFO: Loaded 1 PC tables (228950 PCs): 228950 [0x55bb0303df50,0x55bb033bc4b0), \r\n./src/test/fuzz/fuzz: Running 1 inputs 1 time(s) each.\r\nRunning: ./crash-ef7d4a4f940b8fdb4999f6a92969260cf8e1405f.log\r\nfuzz: addrman.cpp:149: void CAddrMan::SwapRandom(unsigned int, unsigned int): Assertion `nRndPos1 < vRandom.size() && nRndPos2 < vRandom.size()' failed.\r\n==412116== ERROR: libFuzzer: deadly signal\r\n...\r\n    #9 0x55bb026c65f9 in CAddrMan::SwapRandom(unsigned int, unsigned int) addrman.cpp:149:5\r\n    #10 0x55bb026c7758 in CAddrMan::Delete(int) addrman.cpp:173:5\r\n    #11 0x55bb026d1c0b in CAddrMan::ClearNew(int, int) addrman.cpp:192:13\r\n    #12 0x55bb026d1c0b in CAddrMan::ResetI2PPorts() addrman.cpp:819:17\r\n    #13 0x55bb025d122a in void CAddrMan::Unserialize<CDataStream>(CDataStream&) ./addrman.h:455:9\r\n    #14 0x55bb025b068d in void Unserialize<CDataStream, CAddrMan&>(CDataStream&, CAddrMan&) ./serialize.h:676:7\r\n    #15 0x55bb025b068d in CDataStream& CDataStream::operator>><CAddrMan&>(CAddrMan&) ./streams.h:428:9\r\n    #16 0x55bb025b068d in void (anonymous namespace)::DeserializeFromFuzzingInput<CAddrMan>(Span<unsigned char const>, CAddrMan&, std::optional<int>, int) test/fuzz/deserialize.cpp:87:12\r\n    #17 0x55bb025b068d in addrman_deserialize_fuzz_target(Span<unsigned char const>) test/fuzz/deserialize.cpp:201:1\r\n...\r\n```\r\n\r\n\r\n[crash-ef7d4a4f940b8fdb4999f6a92969260cf8e1405f.log](https://github.com/bitcoin/bitcoin/files/6822813/crash-ef7d4a4f940b8fdb4999f6a92969260cf8e1405f.log)\r\n",
      "created_at" : "2021-07-15T11:47:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-880629375",
      "id" : 880629375,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDYyOTM3NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T11:47:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880629375",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This is what the fuzzed addrman data produces at the end of `Unserialize()`, before `RemoveInvalid()` and before `ResetI2PPorts()`:\r\n\r\n```\r\nnNew=-1, nTried=5\r\nid=3, addr_info=[::]:0, in tried=1\r\nid=2, addr_info=4ucsbzifedsqkihfauqokbja4ucsbzifedsqkihfauqokbja4ucq.b32.i2p:8192, in tried=1\r\nid=1, addr_info=[::]:229, in tried=1\r\nid=0, addr_info=4ucsbzifedsqkihfauqokbja4ucsbzifedsqkihfauqokbja4ucq.b32.i2p:256, in tried=1\r\nid=-1, addr_info=[::]:8421, in tried=1\r\nvRandom=-1,0,1,2,3,\r\n```\r\n\r\nAfter `RemoveInvalid()`:\r\n\r\n```\r\nnNew=-1, nTried=3\r\nid=2, addr_info=4ucsbzifedsqkihfauqokbja4ucsbzifedsqkihfauqokbja4ucq.b32.i2p:8192, in tried=1\r\nid=0, addr_info=4ucsbzifedsqkihfauqokbja4ucsbzifedsqkihfauqokbja4ucq.b32.i2p:256, in tried=1\r\nid=-1, addr_info=[::]:8421, in tried=1\r\nvRandom=-1,0,2,\r\n```\r\n\r\nAfter `ResetI2PPorts()`:\r\n\r\n```\r\nnNew=0, nTried=2\r\nid=2, addr_info=4ucsbzifedsqkihfauqokbja4ucsbzifedsqkihfauqokbja4ucq.b32.i2p:0, in tried=0\r\nid=0, addr_info=4ucsbzifedsqkihfauqokbja4ucsbzifedsqkihfauqokbja4ucq.b32.i2p:0, in tried=1\r\nid=-1, addr_info=[::]:8421, in tried=1\r\nvRandom=-1,0,2,\r\n```\r\n\r\nLater `Serialize()` chokes on this because there is at least one entry in `mapInfo[]` with `nRefCount > 0` and `nNew` is `0`. The problem originated from the unserialized negative `nNew`. `ResetI2PPorts()` correctly moved one entry from \"tried\" to \"new\" and incremented `nNew` (from `-1` to `0`).\r\n\r\nTODO:\r\n* Why `RemoveInvalid()` did not remove `id=-1, addr_info=[::]:8421, in tried=1`?\r\n* Resolve the problem @jnewbery highlighted above.\r\n* See what is the other crash reported by @MarcoFalke above.\r\n\r\n@jnewbery \r\n> remove any I2P addresses which don't have port 0, and then perhaps add them back through the public (and well-tested) Add() interface\r\n\r\nI considered this approach and ditched it for some reason, but I do not remember why :/ It could have been that deleting an entry has to be done again by fiddling directly with the internal structures and was about as complicated as the current code. Will look at this again.",
      "created_at" : "2021-07-15T12:11:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-880643711",
      "id" : 880643711,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDY0MzcxMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T12:11:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880643711",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Why RemoveInvalid() did not remove id=-1, addr_info=[::]:8421, in tried=1?\r\n\r\nMaybe related: https://github.com/bitcoin/bitcoin/pull/22362",
      "created_at" : "2021-07-15T12:18:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-880647967",
      "id" : 880647967,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDY0Nzk2Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T12:18:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880647967",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just for reference, attaching the fuzzer input to reproduce the problem that is reported in the OP/description of this issue.\r\n\r\n[clusterfuzz-testcase-minimized-addrman_deserialize-5090634410098688.log](https://github.com/bitcoin/bitcoin/files/6830102/clusterfuzz-testcase-minimized-addrman_deserialize-5090634410098688.log)\r\n",
      "created_at" : "2021-07-16T10:44:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-881354785",
      "id" : 881354785,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "IC_kwDOABII5840iGgh",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-16T10:44:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/881354785",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Fix pending at https://github.com/bitcoin/bitcoin/pull/22455",
      "created_at" : "2021-07-16T16:40:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-881578008",
      "id" : 881578008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "IC_kwDOABII5840i9AY",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-16T16:40:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/881578008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "<details><summary>Reproduced on my old laptop with the addrman_deserialize fuzzer</summary><p>\r\n\r\n```\r\n#530590\tREDUCE cov: 2083 ft: 11547 corp: 872/18Mb lim: 1048575 exec/s: 80 rss: 683Mb L: 282/957238 MS: 2 EraseBytes-InsertRepeatedBytes-\r\nfuzz: ./addrman.h:261: void CAddrMan::Serialize(Stream &) const [Stream = CDataStream]: Assertion `nIds != nNew' failed.\r\n==4549== ERROR: libFuzzer: deadly signal\r\n    #0 0x55b32a31ddb1 in __GNU_EH_FRAME_HDR (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xea8db1)\r\n    #1 0x55b32a263ce8  (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xdeece8)\r\n    #2 0x55b32a247ad3  (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xdd2ad3)\r\n    #3 0x7f24ff51d13f  (/lib/x86_64-linux-gnu/libpthread.so.0+0x1413f)\r\n    #4 0x7f24ff189ce0 in __libc_signal_restore_set signal/../sysdeps/unix/sysv/linux/internal-signals.h:86:3\r\n    #5 0x7f24ff189ce0 in raise signal/../sysdeps/unix/sysv/linux/raise.c:48:3\r\n    #6 0x7f24ff173536 in abort stdlib/abort.c:79:7\r\n    #7 0x7f24ff17340e in __assert_fail_base assert/assert.c:92:3\r\n    #8 0x7f24ff182661 in __assert_fail assert/assert.c:101:3\r\n    #9 0x55b32a377569 in __GNU_EH_FRAME_HDR (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xf02569)\r\n    #10 0x55b32a3562df in __GNU_EH_FRAME_HDR (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xee12df)\r\n    #11 0x55b32a427581 in __GNU_EH_FRAME_HDR (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xfb2581)\r\n    #12 0x55b32a427103 in __GNU_EH_FRAME_HDR (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xfb2103)\r\n    #13 0x55b32a34bc45 in __GNU_EH_FRAME_HDR (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xed6c45)\r\n    #14 0x55b32a34bb0d in __GNU_EH_FRAME_HDR (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xed6b0d)\r\n    #15 0x55b32a34b8a8 in __GNU_EH_FRAME_HDR (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xed68a8)\r\n    #16 0x55b32b1b6cad in _end (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0x1d41cad)\r\n    #17 0x55b32b1b6958 in _end (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0x1d41958)\r\n    #18 0x55b32a249363  (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xdd4363)\r\n    #19 0x55b32a24886a  (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xdd386a)\r\n    #20 0x55b32a24a567  (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xdd5567)\r\n    #21 0x55b32a24b1a5  (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xdd61a5)\r\n    #22 0x55b32a23a487 in typeinfo name for boost::system::detail::system_error_category (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xdc5487)\r\n    #23 0x55b32a2644a2  (/home/jon/projects/bitcoin/bitcoin/src/test/fuzz/fuzz+0xdef4a2)\r\n    #24 0x7f24ff174d09 in __libc_start_main csu/../csu/libc-start.c:308:16\r\n    #25 0x55b32a2110a9 in secp256k1_fe_negate /home/jon/projects/bitcoin/bitcoin/src/secp256k1/./src/field_5x52_impl.h:383:48\r\n    #26 0x55b32a2110a9 in secp256k1_ecmult_strauss_wnaf /home/jon/projects/bitcoin/bitcoin/src/secp256k1/./src/ecmult_impl.h:547:13\r\n    #27 0x55b32a2110a9 in secp256k1_ecmult /home/jon/projects/bitcoin/bitcoin/src/secp256k1/./src/ecmult_impl.h:574:5\r\n\r\nNOTE: libFuzzer has rudimentary signal handlers.\r\n      Combine libFuzzer with AddressSanitizer or similar for better crash reports.\r\nSUMMARY: libFuzzer: deadly signal\r\nMS: 2 PersAutoDict-CrossOver- DE: \"+\\x00\"-; base unit: fbd17f1aa0fcc4e97f0bcafb8e19837f75cde233\r\nartifact_prefix='./'; Test unit written to ./crash-8dbb7526c0e5673271d4ef81bb819ae81f2bb000\r\n```\r\n</p></details>\r\n\r\n",
      "created_at" : "2021-07-17T12:25:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-881890380",
      "id" : 881890380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "IC_kwDOABII5840kJRM",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-17T12:25:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/881890380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Wrote a fuzz test in #22493 to reproduce on \"old\" master (without commit e0a2b39)",
      "created_at" : "2021-07-19T11:03:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-882455646",
      "id" : 882455646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "IC_kwDOABII5840mTRe",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T11:04:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882455646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Oh, nvm. Looks like a new unrelated bug. ð¥²\r\n\r\nEdit: Reported as #22494   ",
      "created_at" : "2021-07-19T11:13:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/22450#issuecomment-882463876",
      "id" : 882463876,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22450",
      "node_id" : "IC_kwDOABII5840mVSE",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-19T11:17:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/882463876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
