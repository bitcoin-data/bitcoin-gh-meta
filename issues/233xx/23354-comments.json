[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2021-10-25T15:53:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23354#issuecomment-951065763",
      "id" : 951065763,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23354",
      "node_id" : "IC_kwDOABII5844sByj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951065763/reactions"
      },
      "updated_at" : "2021-10-25T15:53:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951065763",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK d891ae768185b464cae476c16c74c365372d4a3c",
      "created_at" : "2021-10-26T08:05:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23354#issuecomment-951666409",
      "id" : 951666409,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23354",
      "node_id" : "IC_kwDOABII5844uUbp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951666409/reactions"
      },
      "updated_at" : "2021-10-26T08:05:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951666409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK d891ae768185b464cae476c16c74c365372d4a3c",
      "created_at" : "2021-10-26T08:32:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23354#issuecomment-951709094",
      "id" : 951709094,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23354",
      "node_id" : "IC_kwDOABII5844ue2m",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951709094/reactions"
      },
      "updated_at" : "2021-10-26T08:32:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951709094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I tested the \"correct\" error message (failing to load because of version). Testing the \"wrong\" error message (corruption) might be harder, as it requires `-checkaddrman` (or the implicit check), both of which are only in master, thus require re-compilation. So I think a regression-test with previous releases is not possible, at least not in the functional test framework.\r\n\r\nSo I tested the new format manually:\r\n\r\n```\r\n$ ./src/bitcoin-cli -regtest -datadir=/tmp/test_23354/ addpeeraddress \"250.1.1.2\" 12345 \r\n{\r\n  \"success\": true\r\n}\r\n$ ./src/bitcoin-cli -regtest -datadir=/tmp/test_23354/ addpeeraddress \"250.1.1.2\" 12367 \r\n{\r\n  \"success\": true\r\n}\r\n```\r\n\r\nStart with previous versions prints the correct error now:\r\n\r\n```\r\nBitcoin Core version v22.0.0 (release build)\r\n...\r\nERROR: DeserializeDB: Deserialize or I/O error - Unsupported format of addrman database: 4. It is compatible with formats >=4, but the maximum supported by this version of Bitcoin Core is 3.: iostream error\r\nRecreating peers.dat\r\n```\r\n\r\nor going back even further:\r\n\r\n```\r\nBitcoin Core version v0.20.1 (release build)\r\n...\r\nERROR: DeserializeDB: Deserialize or I/O error - Incorrect keysize in addrman deserialization: iostream error\r\nInvalid or missing peers.dat; recreating\r\n",
      "created_at" : "2021-10-26T12:44:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23354#issuecomment-951902357",
      "id" : 951902357,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23354",
      "node_id" : "IC_kwDOABII5844vOCV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951902357/reactions"
      },
      "updated_at" : "2021-10-26T12:44:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/951902357",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2021-10-29T09:22:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23354#issuecomment-954588496",
      "id" : 954588496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23354",
      "node_id" : "IC_kwDOABII58445d1Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954588496/reactions"
      },
      "updated_at" : "2021-10-29T09:22:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954588496",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
