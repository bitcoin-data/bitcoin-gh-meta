[
   {
      "body" : "fixed after a discussion with @theuni on IRC \r\nNow CheckIndexAgainstCheckpoint() takes CChainParams instead of uint256& hashGenesisBlock as parameter to avoid conflicts with work that he is doing in parallel related to checkpoints.\r\nReady for squash.\r\n#5968 and #5970 probably need to be adapted to CheckIndexAgainstCheckpoint depending on CChainParams.",
      "created_at" : "2015-04-08T13:26:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-90915036",
      "id" : 90915036,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-04-08T13:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/90915036",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r27987513"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/27987513"
         }
      },
      "body" : "Shouldn't these just return false? state is already set in CheckIndexAgainstCheckpoint().",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-04-08T16:35:01Z",
      "diff_hunk" : "@@ -2640,6 +2642,8 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         if (pindexPrev->nStatus & BLOCK_FAILED_MASK)\n             return state.DoS(100, error(\"%s: prev block invalid\", __func__), REJECT_INVALID, \"bad-prevblk\");\n     }\n+    if (!CheckIndexAgainstCheckpoint(pindexPrev, state, params, mapBlockIndex))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r27987513",
      "id" : 27987513,
      "original_commit_id" : "7461d64d85595fbb1083859393082a5841b34ba5",
      "original_position" : 62,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/27987513",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "2 more fixes, ready to squash",
      "created_at" : "2015-04-08T17:12:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-90977720",
      "id" : 90977720,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-04-08T17:12:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/90977720",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Needed rebase.",
      "created_at" : "2015-04-15T12:00:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-93355365",
      "id" : 93355365,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-04-15T12:00:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/93355365",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Somehow I missed this one. Renamed params to chainparams like everywhere else.",
      "created_at" : "2015-04-19T21:35:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-94317009",
      "id" : 94317009,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-04-19T21:35:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/94317009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "ping @theuni ",
      "created_at" : "2015-04-22T10:01:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-95109804",
      "id" : 95109804,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-04-22T10:01:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/95109804",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r28921127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/28921127"
         }
      },
      "body" : "nit: mapBlockIndex shadows the global, will be confusing when it's used.",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-04-22T22:28:53Z",
      "diff_hunk" : "@@ -2540,19 +2540,30 @@ bool CheckBlock(const CBlock& block, CValidationState& state, bool fCheckPOW, bo\n     return true;\n }\n \n-bool ContextualCheckBlockHeader(const CBlockHeader& block, CValidationState& state, CBlockIndex * const pindexPrev)\n+static bool CheckIndexAgainstCheckpoint(const CBlockIndex* pindexPrev, CValidationState& state, const CChainParams& chainparams, const BlockMap& mapBlockIndex)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r28921127",
      "id" : 28921127,
      "original_commit_id" : "e55ad4833676b3a1c4338c479478030c8ceb8eed",
      "original_position" : 5,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/28921127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "ut ack other than the nit",
      "created_at" : "2015-04-22T23:14:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-95363950",
      "id" : 95363950,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-04-22T23:14:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/95363950",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "nit solved",
      "created_at" : "2015-04-22T23:32:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-95367137",
      "id" : 95367137,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-04-22T23:32:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/95367137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Thanks, looks good.",
      "created_at" : "2015-04-23T21:06:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-95719104",
      "id" : 95719104,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-04-23T21:06:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/95719104",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29038007"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29038007"
         }
      },
      "body" : "I'd rather keep comparisons with the genesis block out of the \"checkpoints\" logic. That's purely philosophical, but we may get rid of checkpoints at some point, though the genesis block will always remain part of consensus.",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-04-24T10:11:39Z",
      "diff_hunk" : "@@ -2540,19 +2540,30 @@ bool CheckBlock(const CBlock& block, CValidationState& state, bool fCheckPOW, bo\n     return true;\n }\n \n-bool ContextualCheckBlockHeader(const CBlockHeader& block, CValidationState& state, CBlockIndex * const pindexPrev)\n+static bool CheckIndexAgainstCheckpoint(const CBlockIndex* pindexPrev, CValidationState& state, const CChainParams& chainparams, const BlockMap& blockIndexMap)\n {\n-    const Consensus::Params& consensusParams = Params().GetConsensus();\n-    uint256 hash = block.GetHash();\n-    if (hash == consensusParams.hashGenesisBlock)\n-        return true;\n-\n     assert(pindexPrev);\n+    if (*pindexPrev->phashBlock == chainparams.GetConsensus().hashGenesisBlock)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29038007",
      "id" : 29038007,
      "original_commit_id" : "b00583b134344b3902476b5ae040473e5862026a",
      "original_position" : 13,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29038007",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29099547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29099547"
         }
      },
      "body" : "Well, the question is, should we validate the genesis block?\r\nI don't think so, the genesis block is hardcoded, no need to check it redundantly from many computers. \r\nSo this is more moving that check out of consensus than \"moving it to the checkpoints logic\".\r\n\r\nBut of course, if your the tip of the chain index you're using (your pindexPrev) is the genesis block (that is, if you're validating the second block), you can skip the other checkpoint tests.\r\n\r\nWhat you want to check is that your chain index contains the genesis block. Or with checkpoints, you may even want to just check that your chain index contains the previous checkpoint (you have to be certain that all your checkpoints contain the genesis block when your hardcode them).\r\nIn that sense you can see the genesis block just as the oldest checkpoint possible.\r\n\r\nBut thanks for bringing this up, this is the only change in logic and what needs discussion.\r\n",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-04-25T10:11:47Z",
      "diff_hunk" : "@@ -2540,19 +2540,30 @@ bool CheckBlock(const CBlock& block, CValidationState& state, bool fCheckPOW, bo\n     return true;\n }\n \n-bool ContextualCheckBlockHeader(const CBlockHeader& block, CValidationState& state, CBlockIndex * const pindexPrev)\n+static bool CheckIndexAgainstCheckpoint(const CBlockIndex* pindexPrev, CValidationState& state, const CChainParams& chainparams, const BlockMap& blockIndexMap)\n {\n-    const Consensus::Params& consensusParams = Params().GetConsensus();\n-    uint256 hash = block.GetHash();\n-    if (hash == consensusParams.hashGenesisBlock)\n-        return true;\n-\n     assert(pindexPrev);\n+    if (*pindexPrev->phashBlock == chainparams.GetConsensus().hashGenesisBlock)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29099547",
      "id" : 29099547,
      "original_commit_id" : "b00583b134344b3902476b5ae040473e5862026a",
      "original_position" : 13,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29099547",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Needed rebase",
      "created_at" : "2015-05-06T10:45:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-99415255",
      "id" : 99415255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-06T10:45:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99415255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "@jtimon I think #6055 was a big improvement in readability for the checkpoint functions because it moved the \"what if checkpoints aren't enabled\" case out of the actual checkpoint logic. This would undo some of that.\r\n\r\nHow about removing the early return from ```CheckIndexAgainstCheckpoint()``` and instead calling into it like ```if (fCheckpointsEnabled && !CheckIndexAgainstCheckpoint(...))``` ?",
      "created_at" : "2015-05-06T16:29:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-99530132",
      "id" : 99530132,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-06T16:29:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99530132",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "I disagree that this undoes part of #6055 but I'm ok with your proposed alternative. I thought about it too but I didn't wanted to  take the ```assert(pindexPrev);``` out of the function as well.\r\n",
      "created_at" : "2015-05-06T16:52:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-99535651",
      "id" : 99535651,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-06T16:52:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99535651",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Sorry, that was poorly worded. It wouldn't undo any of #6055, but it would negate one of the beneficial side-effects of it.\r\n\r\nAs for not removing the assert, I don't follow. pindexPrev is used whether checkpoints are enabled or not, so relying on the assert in CheckIndexAgainstCheckpoint() even if checkpoints are disabled makes no sense to me.",
      "created_at" : "2015-05-06T17:09:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-99540013",
      "id" : 99540013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-06T17:09:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99540013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "I still disagree that it is removing one of the beneficial side effects of it, I don't think the negated condition is less readable...\r\n\r\nAnyway, what I mean is that if I want to maintain it almost equivalent (is not completely equivalent functionally because I'm changing the genesis check as discussed in the outdated comment by @sipa), I can't do just\r\n\r\n```\r\nif (fCheckpointsEnabled && !CheckIndexAgainstCheckpoint(...))\r\n```\r\n\r\nIt would need to be something like\r\n\r\n```\r\nassert(pindexPrev);\r\nif (fCheckpointsEnabled && !CheckIndexAgainstCheckpoint(...))\r\n```\r\n\r\nbecause pindexPrev shouldn't arrive NULL to  ContextualCheckBlockHeader.\r\nBut I'm fine with that, should I change it to that, then?",
      "created_at" : "2015-05-06T17:15:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-99541662",
      "id" : 99541662,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-06T17:15:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99541662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Yes, that looks good. Thanks.",
      "created_at" : "2015-05-06T17:27:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-99544306",
      "id" : 99544306,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-06T17:27:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99544306",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Done, changed as suggested by @theuni ",
      "created_at" : "2015-05-06T17:44:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-99549892",
      "id" : 99549892,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-10T17:22:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99549892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29905113"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29905113"
         }
      },
      "body" : "Any reason why the checkpoints check is moved?\r\n\r\nI think it's harmless to do so, but I was wondering if there is a reason.",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-05-07T23:10:59Z",
      "diff_hunk" : "@@ -2715,6 +2712,9 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         if (pindexPrev->nStatus & BLOCK_FAILED_MASK)\n             return state.DoS(100, error(\"%s: prev block invalid\", __func__), REJECT_INVALID, \"bad-prevblk\");\n     }\n+    assert(pindexPrev);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29905113",
      "id" : 29905113,
      "original_commit_id" : "102b09bff51c1bbf4fd0299bc90d6643a6e8284b",
      "original_position" : 60,
      "path" : "src/main.cpp",
      "position" : 50,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29905113",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29914432"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29914432"
         }
      },
      "body" : "No need to print an error in this case; it's perfectly legitimate that this fails.\r\n\r\nEDIT: Hmm, the rest of the checks prints stuff too. Never mind then, but I think we should fix that independently (there are probably already issues about that).",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-05-08T03:07:46Z",
      "diff_hunk" : "@@ -2824,8 +2824,11 @@ bool ProcessNewBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDis\n \n bool TestBlockValidity(CValidationState &state, const CBlock& block, CBlockIndex * const pindexPrev, bool fCheckPOW, bool fCheckMerkleRoot)\n {\n+    const CChainParams& chainparams = Params();\n     AssertLockHeld(cs_main);\n-    assert(pindexPrev == chainActive.Tip());\n+    assert(pindexPrev && pindexPrev == chainActive.Tip());\n+    if (fCheckpointsEnabled && !CheckIndexAgainstCheckpoint(pindexPrev, state, chainparams, block.GetHash(), mapBlockIndex))\n+        return error(\"%s: CheckIndexAgainstCheckpoint(): %s\", __func__, state.GetRejectReason().c_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29914432",
      "id" : 29914432,
      "original_commit_id" : "102b09bff51c1bbf4fd0299bc90d6643a6e8284b",
      "original_position" : 75,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29914432",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29930305"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29930305"
         }
      },
      "body" : "Apparently having the check of the global boolean outside of the function is more readable according to @theuni.",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-05-08T10:28:47Z",
      "diff_hunk" : "@@ -2715,6 +2712,9 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         if (pindexPrev->nStatus & BLOCK_FAILED_MASK)\n             return state.DoS(100, error(\"%s: prev block invalid\", __func__), REJECT_INVALID, \"bad-prevblk\");\n     }\n+    assert(pindexPrev);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29930305",
      "id" : 29930305,
      "original_commit_id" : "102b09bff51c1bbf4fd0299bc90d6643a6e8284b",
      "original_position" : 60,
      "path" : "src/main.cpp",
      "position" : 50,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29930305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29930473"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29930473"
         }
      },
      "body" : "Yes I'm trying to move the errors up (because logging errrors shouldnt be done in consensus, but one step at a time. That is the kind of change that is better done after the moveonly, hopefully, one day...",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-05-08T10:32:28Z",
      "diff_hunk" : "@@ -2824,8 +2824,11 @@ bool ProcessNewBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDis\n \n bool TestBlockValidity(CValidationState &state, const CBlock& block, CBlockIndex * const pindexPrev, bool fCheckPOW, bool fCheckMerkleRoot)\n {\n+    const CChainParams& chainparams = Params();\n     AssertLockHeld(cs_main);\n-    assert(pindexPrev == chainActive.Tip());\n+    assert(pindexPrev && pindexPrev == chainActive.Tip());\n+    if (fCheckpointsEnabled && !CheckIndexAgainstCheckpoint(pindexPrev, state, chainparams, block.GetHash(), mapBlockIndex))\n+        return error(\"%s: CheckIndexAgainstCheckpoint(): %s\", __func__, state.GetRejectReason().c_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29930473",
      "id" : 29930473,
      "original_commit_id" : "102b09bff51c1bbf4fd0299bc90d6643a6e8284b",
      "original_position" : 75,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29930473",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "@sipa I answered to your worries on checking the genesis block. You never answered back so I assume you were satisfied by my answer.",
      "created_at" : "2015-05-08T10:34:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-100186656",
      "id" : 100186656,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-08T10:34:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/100186656",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29995610"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29995610"
         }
      },
      "body" : "@sipa if you're referring to fCheckpointsEnabled moving out of CheckIndexAgainstCheckpoint(), I requested that to reduce the side-effects of CheckIndexAgainstCheckpoint(). Imo if possible the checkpoint functions should be side-effect free so that we know it's consensus-safe to simply not call them at all.",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-05-09T19:39:01Z",
      "diff_hunk" : "@@ -2715,6 +2712,9 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         if (pindexPrev->nStatus & BLOCK_FAILED_MASK)\n             return state.DoS(100, error(\"%s: prev block invalid\", __func__), REJECT_INVALID, \"bad-prevblk\");\n     }\n+    assert(pindexPrev);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29995610",
      "id" : 29995610,
      "original_commit_id" : "102b09bff51c1bbf4fd0299bc90d6643a6e8284b",
      "original_position" : 60,
      "path" : "src/main.cpp",
      "position" : 50,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29995610",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29997214"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29997214"
         }
      },
      "body" : "I'm referring to the fCheckpointsEnabled conditional. Just to the fact that\nthe checkpoints-checking point in this function moving.\n",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-05-09T23:30:16Z",
      "diff_hunk" : "@@ -2715,6 +2712,9 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         if (pindexPrev->nStatus & BLOCK_FAILED_MASK)\n             return state.DoS(100, error(\"%s: prev block invalid\", __func__), REJECT_INVALID, \"bad-prevblk\");\n     }\n+    assert(pindexPrev);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r29997214",
      "id" : 29997214,
      "original_commit_id" : "102b09bff51c1bbf4fd0299bc90d6643a6e8284b",
      "original_position" : 60,
      "path" : "src/main.cpp",
      "position" : 50,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/29997214",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r30001749"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/30001749"
         }
      },
      "body" : "@sipa I'm still not sure what you mean.\r\nThe checkpoints checks are moved out of ContextualCheckBlockHeader to keep them out of consensus.\r\nThen is moved up in the functions, because you should have your index checked before checking a new block, maybe they can be moved upper (and earlier in time) later. I suspect the index is checked in this way redundantly.\r\nIf this is an issue I can maintain the calls to CheckIndexAgainstCheckpoint right before the calls to ContextualCheckBlockHeader.",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-05-10T12:45:49Z",
      "diff_hunk" : "@@ -2715,6 +2712,9 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         if (pindexPrev->nStatus & BLOCK_FAILED_MASK)\n             return state.DoS(100, error(\"%s: prev block invalid\", __func__), REJECT_INVALID, \"bad-prevblk\");\n     }\n+    assert(pindexPrev);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r30001749",
      "id" : 30001749,
      "original_commit_id" : "102b09bff51c1bbf4fd0299bc90d6643a6e8284b",
      "original_position" : 60,
      "path" : "src/main.cpp",
      "position" : 50,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/30001749",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r30005789"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/30005789"
         }
      },
      "body" : "Sorry, I missed this was in AcceptBlockHeader already, and not in ContextualCheckBlockHeader anymore. Looks good.",
      "commit_id" : "425c3a87ff128bc068949b86e7f764c2c3e3f904",
      "created_at" : "2015-05-10T20:39:34Z",
      "diff_hunk" : "@@ -2715,6 +2712,9 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         if (pindexPrev->nStatus & BLOCK_FAILED_MASK)\n             return state.DoS(100, error(\"%s: prev block invalid\", __func__), REJECT_INVALID, \"bad-prevblk\");\n     }\n+    assert(pindexPrev);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#discussion_r30005789",
      "id" : 30005789,
      "original_commit_id" : "102b09bff51c1bbf4fd0299bc90d6643a6e8284b",
      "original_position" : 60,
      "path" : "src/main.cpp",
      "position" : 50,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5975",
      "updated_at" : "2015-06-10T11:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/30005789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Untested ACK",
      "created_at" : "2015-05-10T21:30:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-100703967",
      "id" : 100703967,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-10T21:30:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/100703967",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Updated without the unused blockIndexMap parameter.\r\nIt may take long until it gets used so better to just introduce it at that point.",
      "created_at" : "2015-05-27T13:45:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-105916511",
      "id" : 105916511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-05-27T13:45:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/105916511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Sorry: needs rebase after #5927, will merge after that.",
      "created_at" : "2015-06-10T08:42:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-110656788",
      "id" : 110656788,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-06-10T08:42:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/110656788",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "No worries, it was an easy rebase.",
      "created_at" : "2015-06-10T11:13:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-110703198",
      "id" : 110703198,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-06-10T11:13:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/110703198",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "This appears to have broken running bitcoind with -reindex(!); it appears the ```assert(pindexPrev)``` in AcceptBlockHeader can be reached when processing the genesis block from disk.  Can be reproduced by running ```qa/rpc-tests/reindex.py```.",
      "created_at" : "2015-06-16T18:56:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-112528359",
      "id" : 112528359,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-06-16T18:56:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/112528359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "@sdaftuar created #6299 to fix the bug.",
      "created_at" : "2015-06-17T19:30:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5975#issuecomment-112921324",
      "id" : 112921324,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5975",
      "updated_at" : "2015-06-17T19:30:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/112921324",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   }
]
