[
   {
      "body" : "This appears to revert part of #5877.\r\n\r\nCan you add a concrete test case for this? This more and more looks like just some occult incantation to ward off the evil spirits of bad locales :)\r\n",
      "created_at" : "2015-03-27T07:05:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#issuecomment-86849397",
      "id" : 86849397,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5950",
      "updated_at" : "2015-03-27T07:05:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/86849397",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5950#discussion_r27290989"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5950"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/27290989"
         }
      },
      "body" : "Nit: Wrong indentation, also true for ``bitdb.MakeMock();`` below.",
      "commit_id" : "3a3ecc02e55ba955ee535d645412ebb66295939a",
      "created_at" : "2015-03-27T12:28:40Z",
      "diff_hunk" : "@@ -37,6 +37,7 @@ BasicTestingSetup::~BasicTestingSetup()\n \n TestingSetup::TestingSetup()\n {\n+        SetupEnvironment();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#discussion_r27290989",
      "id" : 27290989,
      "original_commit_id" : "c2ce0632dbd4e1238912afa4ca815f83295feda8",
      "original_position" : 4,
      "path" : "src/test/test_bitcoin.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5950",
      "updated_at" : "2015-03-29T08:36:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/27290989",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@laanwj: Yeah, I'm truely sorry.. :/ I focused on addressing the deinitialization issue, which caused the crashes on Windows, probably with two steps forward, where only one was appropriate, as it seems.\r\n\r\nI further moved `TestingSetup()` from `TestingSetup()` to `BasicTestingSetup()`, after running a proper test.\r\n\r\nThe RPC test is available here:\r\nhttps://gist.github.com/dexX7/ab3f7411a9040e96d55c\r\n\r\nTravis build with the test, based on unfixed master (with delayed error assertion):\r\nhttps://travis-ci.org/dexX7/bitcoin/builds/56274510\r\n\r\nTravis build with the test, based on the [0.10 branch](https://github.com/bitcoin/bitcoin/compare/0.10...dexX7:0.10-init-locale-fallback-tests-fix):\r\nhttps://travis-ci.org/dexX7/bitcoin/builds/56281938\r\n\r\nTravis build with the test, based on this pull request:\r\nhttps://travis-ci.org/dexX7/bitcoin/builds/56281999\r\n\r\nMay I add the test to `qa/rpc-tests` as part of this PR, but without adding it to `qa/pull-tester/run-rpc-tests.sh`, as it is somewhat time consuming?\r\n\r\n@Diapolo: I'd be happy to format `src/test/test_bitcoin.cpp` and update the copyright header in `src/qt/test/test_main.cpp`, if that would be considered as appropriate for the scope of this PR?",
      "created_at" : "2015-03-29T09:05:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#issuecomment-87375726",
      "id" : 87375726,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5950",
      "updated_at" : "2015-03-29T09:11:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/87375726",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5836089?v=3",
         "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dexX7/followers",
         "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dexX7",
         "id" : 5836089,
         "login" : "dexX7",
         "organizations_url" : "https://api.github.com/users/dexX7/orgs",
         "received_events_url" : "https://api.github.com/users/dexX7/received_events",
         "repos_url" : "https://api.github.com/users/dexX7/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dexX7"
      }
   },
   {
      "body" : "> May I add the test to qa/rpc-tests as part of this PR, but without adding it to qa/pull-tester/run-rpc-tests.sh, as it is somewhat time consuming?\r\n\r\nSure! Although I'd prefer making the test consume less time, and adding it to the pull tester. What is so time consuming? The environment setup is one of the first things it does, after all, so at least in theory it could be a matter of quickly invoking the executables.\r\n\r\nIn any case you've convinced me enough to merge this, adding the test could be a further PR.\r\n",
      "created_at" : "2015-04-01T10:20:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#issuecomment-88428286",
      "id" : 88428286,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5950",
      "updated_at" : "2015-04-01T10:20:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88428286",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "> Although I'd prefer making the test consume less time, and adding it to the pull tester. What is so time consuming?\r\n\r\nThe test is probably far away from being optimal. :) While `bitcoind` is stopped as soon as possible, right now `test_bitcoin` and `test_bitcoin-qt` are executed four times each (with different locale settings), only to check, if the process terminates with exit status 0.\r\n\r\nEdit: `test_bitcoin` does not terminate immediately without the environment setup/locale guard, but instead a few tests fail.",
      "created_at" : "2015-04-01T10:32:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#issuecomment-88432371",
      "id" : 88432371,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5950",
      "updated_at" : "2015-04-01T10:35:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88432371",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5836089?v=3",
         "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dexX7/followers",
         "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dexX7",
         "id" : 5836089,
         "login" : "dexX7",
         "organizations_url" : "https://api.github.com/users/dexX7/orgs",
         "received_events_url" : "https://api.github.com/users/dexX7/received_events",
         "repos_url" : "https://api.github.com/users/dexX7/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dexX7"
      }
   },
   {
      "body" : "RE: making the test faster:  you can run just one bitcoind test suites or test cases using test_bitcoin --run_test=FOO  (run all tests in FOO test suite) or --run_test=FOO/BAR (run the BAR test in the FOO test suite).\r\n\r\nI believe multiple --run_test's can be given if you want to run more than one.\r\n\r\n",
      "created_at" : "2015-04-01T14:27:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#issuecomment-88504859",
      "id" : 88504859,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5950",
      "updated_at" : "2015-04-01T14:28:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88504859",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@gavinandresen: thanks for the hint, this is very useful!\r\n\r\nBut just to clarify: the errors were not visible right after starting the Boost tests, and not all tests fail, but only a few, which use `boost::path` in one way or another. Further, the actual failures are sort of opaque, and the underlying issue is expressed in more than one way (see: [bitcoin/jobs/56274515#L6165-L6228](https://travis-ci.org/dexX7/bitcoin/jobs/56274515#L6165-L6228)).",
      "created_at" : "2015-04-02T13:57:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#issuecomment-88910643",
      "id" : 88910643,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5950",
      "updated_at" : "2015-04-02T13:57:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88910643",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5836089?v=3",
         "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dexX7/followers",
         "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dexX7",
         "id" : 5836089,
         "login" : "dexX7",
         "organizations_url" : "https://api.github.com/users/dexX7/orgs",
         "received_events_url" : "https://api.github.com/users/dexX7/received_events",
         "repos_url" : "https://api.github.com/users/dexX7/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dexX7"
      }
   },
   {
      "body" : "@laanwj: would you like a similar fix for 0.10, too? I sort of have a bad feeling, because I initially changed `setenv(\"LC_ALL\", \"C\", 1)` to `std::locale::global(std::locale(\"C\"))`, which then turned out to be less reliable, and 0.10 currently still fails the [test](https://gist.github.com/dexX7/ab3f7411a9040e96d55c).",
      "created_at" : "2015-04-17T20:04:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#issuecomment-94063829",
      "id" : 94063829,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5950",
      "updated_at" : "2015-04-17T20:04:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/94063829",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5836089?v=3",
         "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dexX7/followers",
         "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dexX7",
         "id" : 5836089,
         "login" : "dexX7",
         "organizations_url" : "https://api.github.com/users/dexX7/orgs",
         "received_events_url" : "https://api.github.com/users/dexX7/received_events",
         "repos_url" : "https://api.github.com/users/dexX7/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dexX7"
      }
   },
   {
      "body" : "Yes, may be good idea\n",
      "created_at" : "2015-04-18T10:58:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5950#issuecomment-94155646",
      "id" : 94155646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5950",
      "updated_at" : "2015-04-18T10:58:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/94155646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
