[
   {
      "body" : "Same thing happens to bitcoind.\r\n\r\nC:\\Program Files\\Bitcoin\\daemon>bitcoind.exe  -datadir=H:\\bitcoin\r\nError: Error reading from database, shutting down.\r\n\r\nThis application has requested the Runtime to terminate it in an unusual way.\r\nPlease contact the application's support team for more information.\r\n\r\ndebug.log :\r\n\r\n2015-08-31 12:39:34 LevelDB read failure: Corruption: block checksum mismatch\r\n2015-08-31 12:39:34 Corruption: block checksum mismatch\r\n2015-08-31 12:39:34 Error: Error reading from database, shutting down.\r\n2015-08-31 12:39:34 Error reading from database: Database corrupted\r\n",
      "created_at" : "2015-08-31T13:57:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136378561",
      "id" : 136378561,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-08-31T13:57:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136378561",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9076680?v=3",
         "events_url" : "https://api.github.com/users/bol-van/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bol-van/followers",
         "following_url" : "https://api.github.com/users/bol-van/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bol-van/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bol-van",
         "id" : 9076680,
         "login" : "bol-van",
         "organizations_url" : "https://api.github.com/users/bol-van/orgs",
         "received_events_url" : "https://api.github.com/users/bol-van/received_events",
         "repos_url" : "https://api.github.com/users/bol-van/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bol-van/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bol-van/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bol-van"
      }
   },
   {
      "body" : "\"Error reading from database: Database corrupted\" levelDB corruption is usually caused by disk or memory corruption (while writing to disk).\r\nYou could try using `-par=1` to restrict syncing to one thread and then `-reindex`. Sometimes this helps when, for example, the CPU is overheating.\r\n",
      "created_at" : "2015-08-31T14:23:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136385890",
      "id" : 136385890,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-08-31T14:24:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136385890",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Unlikely this is RAM or DISK problem. OS runs stable for weeks, memtest report nothing.\r\nNo bad block events in the event log. One of the disks I tried to put db on is several days old.\r\nRam problems are mostly random. Here I have 100% failure result each time.\r\nAny ways to further diagnose the source of the problem ?",
      "created_at" : "2015-08-31T15:51:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136413008",
      "id" : 136413008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-08-31T17:24:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136413008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9076680?v=3",
         "events_url" : "https://api.github.com/users/bol-van/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bol-van/followers",
         "following_url" : "https://api.github.com/users/bol-van/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bol-van/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bol-van",
         "id" : 9076680,
         "login" : "bol-van",
         "organizations_url" : "https://api.github.com/users/bol-van/orgs",
         "received_events_url" : "https://api.github.com/users/bol-van/received_events",
         "repos_url" : "https://api.github.com/users/bol-van/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bol-van/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bol-van/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bol-van"
      }
   },
   {
      "body" : "I reproduced exact same behavior in VM with Windows Server 2003 X64.\r\nPls someone try to resync the whole db ! Am I alone with this ?",
      "created_at" : "2015-09-01T08:05:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136625521",
      "id" : 136625521,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-09-01T08:05:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136625521",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9076680?v=3",
         "events_url" : "https://api.github.com/users/bol-van/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bol-van/followers",
         "following_url" : "https://api.github.com/users/bol-van/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bol-van/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bol-van",
         "id" : 9076680,
         "login" : "bol-van",
         "organizations_url" : "https://api.github.com/users/bol-van/orgs",
         "received_events_url" : "https://api.github.com/users/bol-van/received_events",
         "repos_url" : "https://api.github.com/users/bol-van/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bol-van/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bol-van/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bol-van"
      }
   },
   {
      "body" : "I'd be interested to know if the same happens in that VM with Bitcoin 10.2.",
      "created_at" : "2015-09-01T09:47:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136653143",
      "id" : 136653143,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-09-01T09:47:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136653143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "You are able to reproduce the failure on other hardware?\r\nWhat about bitcoind or bitcoin-qt for Linux in a VM?",
      "created_at" : "2015-09-01T09:50:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136654810",
      "id" : 136654810,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-09-01T09:50:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136654810",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/93665?v=3",
         "events_url" : "https://api.github.com/users/wtogami/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wtogami/followers",
         "following_url" : "https://api.github.com/users/wtogami/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wtogami/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wtogami",
         "id" : 93665,
         "login" : "wtogami",
         "organizations_url" : "https://api.github.com/users/wtogami/orgs",
         "received_events_url" : "https://api.github.com/users/wtogami/received_events",
         "repos_url" : "https://api.github.com/users/wtogami/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wtogami/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wtogami/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wtogami"
      }
   },
   {
      "body" : "Additional notice.\r\n\r\nBoth 0.10.2 and 0.11.0 cannot start db sync when empty datadir is on \"\\\\\\\\vmware-host\\shared folders\" and successfully do when datadir is on windows network drive.\r\n\r\n2015-09-01 09:51:55 init message: Loading block index...\r\n2015-09-01 09:51:55 Opening LevelDB in Z:\\home-h\\Bit2test\\blocks\\index\r\n2015-09-01 09:51:55 Corruption: no meta-nextfile entry in descriptor\r\n2015-09-01 09:52:23 init message: Loading block index...\r\n2015-09-01 09:52:23 Wiping LevelDB in Z:\\home-h\\Bit2test\\blocks\\index\r\n2015-09-01 09:52:23 Opening LevelDB in Z:\\home-h\\Bit2test\\blocks\\index\r\n2015-09-01 09:52:23 Corruption: no meta-nextfile entry in descriptor\r\n2015-09-01 09:52:25 Shutdown: In progress...\r\n2015-09-01 09:52:25 StopNode()\r\n2015-09-01 09:52:25 Shutdown: done\r\n",
      "created_at" : "2015-09-01T09:54:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136657351",
      "id" : 136657351,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-09-01T09:55:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136657351",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9076680?v=3",
         "events_url" : "https://api.github.com/users/bol-van/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bol-van/followers",
         "following_url" : "https://api.github.com/users/bol-van/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bol-van/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bol-van",
         "id" : 9076680,
         "login" : "bol-van",
         "organizations_url" : "https://api.github.com/users/bol-van/orgs",
         "received_events_url" : "https://api.github.com/users/bol-van/received_events",
         "repos_url" : "https://api.github.com/users/bol-van/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bol-van/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bol-van/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bol-van"
      }
   },
   {
      "body" : "I have one guess. Trouble can be in memory mapped files. I know bitcoin core uses them, it can be seen in RamMap utility.\r\nI also run BURST coin pocminer. It extensively uses mapped files. Because of that kernel paged pool grows very large - up to more than half of the physical memory (its gigabytes). Huge pooltag is \"MmSt\", it contain PTEs. Detailed subject description is here : http://blogs.technet.com/b/askperf/archive/2011/09/23/getting-to-know-the-mmst-pool-tag.aspx\r\nI'm on 24 GB system and set the PoolUsageMaximum to 10 (its 10 percent of RAM, 2.4G in my case). This measure effectively limit MmSt growth and it worked great until... what changed in last weeks ?\r\nI replaced failing hard drive which contain 3 TB of BURST miner plots. This time I formatted NTFS volume with 64K cluster size (was 4K).\r\nAnd probably from that point bitcoin db corruptions started.\r\nNow i killed pocminer and trying to sync bitcoin both on the host and in VM.\r\nWithout pocminer bitcoin could start sync on vmware-host shared folder.\r\nWill report after my guess is confirmed or no.\r\n\r\nPS. Bitcoin 0.11.0 linux x86, runs on different hardware node without VM. Already synced till 1 year old, still no problem.",
      "created_at" : "2015-09-01T11:01:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136675165",
      "id" : 136675165,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-09-01T11:19:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136675165",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9076680?v=3",
         "events_url" : "https://api.github.com/users/bol-van/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bol-van/followers",
         "following_url" : "https://api.github.com/users/bol-van/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bol-van/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bol-van",
         "id" : 9076680,
         "login" : "bol-van",
         "organizations_url" : "https://api.github.com/users/bol-van/orgs",
         "received_events_url" : "https://api.github.com/users/bol-van/received_events",
         "repos_url" : "https://api.github.com/users/bol-van/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bol-van/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bol-van/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bol-van"
      }
   },
   {
      "body" : "Yes, trouble was triggered by BURST miner. Without it sync was successful.\r\nRunning with almost exhausted paged pool cause errors not only in bitcoin core but also have other negative effects and having large cluster volume seem to harden them.\r\n",
      "created_at" : "2015-09-02T04:30:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-136934849",
      "id" : 136934849,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-09-02T07:44:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/136934849",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9076680?v=3",
         "events_url" : "https://api.github.com/users/bol-van/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bol-van/followers",
         "following_url" : "https://api.github.com/users/bol-van/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bol-van/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bol-van",
         "id" : 9076680,
         "login" : "bol-van",
         "organizations_url" : "https://api.github.com/users/bol-van/orgs",
         "received_events_url" : "https://api.github.com/users/bol-van/received_events",
         "repos_url" : "https://api.github.com/users/bol-van/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bol-van/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bol-van/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bol-van"
      }
   },
   {
      "body" : "Thanks for looking into this so deeply. This issue could be useful for other people that experience issues on windows.\r\n\r\nI still wonder how the combination of hw and sw caused corruption, but it's likely the problem lies outside bitcoin core if it affects other software negatively as well.",
      "created_at" : "2015-09-02T10:28:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-137017958",
      "id" : 137017958,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-09-02T10:28:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/137017958",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "One of the negative effects was the following.\r\nAttempts to start db sync from bitcoin core running in vmware guest to vmware host drive were failing just at the start. Then I tried to mount network drive from vm guest to vm host using virtual network (regular 'net use \\\\\\\\192.168.1.5') and sync db to that drive.\r\nStart was successful but after some time I saw messages in the tray stating that windows could not flush data to network drive and data could be lost. Obviously, bitcoin core cannot display such messages, explorer.exe displays them. Event source is guest os kernel not being able to get read/write success confirmation from the server side.  Thus the lanmanserver (The 'Server' service) component on the host was experiencing problems in exhausting paged pool condition probably IO-related.\r\nIts all very strange because in the task manager on the host I see that pool is being trimmed from 2.8G to 800M after its exhaustion and then again grows to 2.8G.\r\nI can suppose some paged pool allocations or some map-view-of-file operations fail before MmSt trim actually happens. Kernel components are written well-checked to not crush in any possible condition, but still denial-of-service exists.\r\nWindows architecture problem ? I know burst miner is badly designed. It should not map terabytes of data files to memory. But also OS should not behave bad in this condition. If MmSt pool is like cache it must be trimmed transparently without alloc fails.\r\n\r\nFrom bitcoin core perspective may be some checks are missing or db engine lack enough atomicity to rollback failing changes ? At the moment I can state : BURST miner can kill bitcoin db in some conditions, possibly when burst plots are on a large cluster volume.\r\nThis is not HW related at all. Its mainly the OS problem not being too resistant to some conditions.",
      "created_at" : "2015-09-02T13:12:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/6606#issuecomment-137072428",
      "id" : 137072428,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6606",
      "updated_at" : "2015-09-02T13:47:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/137072428",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9076680?v=3",
         "events_url" : "https://api.github.com/users/bol-van/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bol-van/followers",
         "following_url" : "https://api.github.com/users/bol-van/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bol-van/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bol-van",
         "id" : 9076680,
         "login" : "bol-van",
         "organizations_url" : "https://api.github.com/users/bol-van/orgs",
         "received_events_url" : "https://api.github.com/users/bol-van/received_events",
         "repos_url" : "https://api.github.com/users/bol-van/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bol-van/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bol-van/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bol-van"
      }
   }
]
