[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019745"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019745"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Probably shouldn't set this until *after* the sanity checks...",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:15:22Z",
      "diff_hunk" : "@@ -2298,6 +2298,14 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int32_t nSleepTime = request.params[1].get_int();\n+    pwallet->nRelockTime = GetTime() + nSleepTime;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019745",
      "id" : 160019745,
      "original_commit_id" : "8600546d1b50cc1cc1d45f7bc29afc14d47ab8f9",
      "original_position" : 6,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019745",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019755"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019755"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Probably should use `int`, not `int32_t` (they're not guaranteed to be the same)",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:16:28Z",
      "diff_hunk" : "@@ -2298,6 +2298,14 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int32_t nSleepTime = request.params[1].get_int();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019755",
      "id" : 160019755,
      "original_commit_id" : "8600546d1b50cc1cc1d45f7bc29afc14d47ab8f9",
      "original_position" : 5,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019755",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019865"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019865"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:19:31Z",
      "diff_hunk" : "@@ -2298,6 +2298,14 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int32_t nSleepTime = request.params[1].get_int();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019865",
      "id" : 160019865,
      "in_reply_to_id" : 160019755,
      "original_commit_id" : "8600546d1b50cc1cc1d45f7bc29afc14d47ab8f9",
      "original_position" : 5,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069688,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019865",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019887"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019887"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oops, fixed.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:19:37Z",
      "diff_hunk" : "@@ -2298,6 +2298,14 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int32_t nSleepTime = request.params[1].get_int();\n+    pwallet->nRelockTime = GetTime() + nSleepTime;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019887",
      "id" : 160019887,
      "in_reply_to_id" : 160019745,
      "original_commit_id" : "8600546d1b50cc1cc1d45f7bc29afc14d47ab8f9",
      "original_position" : 6,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069693,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019887",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019905"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019905"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Still need to check the passphrase etc first... otherwise we've essentially tricked the wallet into lengthening its unlock time.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:21:10Z",
      "diff_hunk" : "@@ -2298,6 +2298,14 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int nSleepTime = request.params[1].get_int();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    pwallet->nRelockTime = GetTime() + nSleepTime;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019905",
      "id" : 160019905,
      "original_commit_id" : "370f1057661ed5de8efc64eec61813f12e9a1971",
      "original_position" : 10,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019905",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019931"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019931"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.\r\n\r\n`nRelockTime` isn't actually used for anything except displaying stuff in `getwalletinfo` so this wouldn't actually be a problem.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:23:33Z",
      "diff_hunk" : "@@ -2298,6 +2298,14 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int nSleepTime = request.params[1].get_int();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    pwallet->nRelockTime = GetTime() + nSleepTime;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019931",
      "id" : 160019931,
      "in_reply_to_id" : 160019905,
      "original_commit_id" : "370f1057661ed5de8efc64eec61813f12e9a1971",
      "original_position" : 10,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069745,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019931",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019947"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019947"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Do we want to allow zero?",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:24:58Z",
      "diff_hunk" : "@@ -2298,6 +2298,13 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int nSleepTime = request.params[1].get_int();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019947",
      "id" : 160019947,
      "original_commit_id" : "f94b423f276618a983993773a8b3c9c491d623db",
      "original_position" : 7,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069766,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019947",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019951"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019951"
         }
      },
      "author_association" : "MEMBER",
      "body" : "2147483648 is not guaranteed to be out of range.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:25:17Z",
      "diff_hunk" : "@@ -56,6 +56,11 @@ def run_test(self):\n         assert_raises_rpc_error(-14, \"wallet passphrase entered was incorrect\", self.nodes[0].walletpassphrase, passphrase, 10)\n         self.nodes[0].walletpassphrase(passphrase2, 10)\n         assert_equal(privkey, self.nodes[0].dumpprivkey(address))\n+        self.nodes[0].walletlock()\n+\n+        # Test timeout bounds\n+        assert_raises_rpc_error(-8, \"Timeout cannot be negative.\", self.nodes[0].walletpassphrase, passphrase, -10)\n+        assert_raises_rpc_error(-1, \"JSON integer out of range\", self.nodes[0].walletpassphrase, passphrase, 2147483648)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019951",
      "id" : 160019951,
      "original_commit_id" : "f94b423f276618a983993773a8b3c9c491d623db",
      "original_position" : 8,
      "path" : "test/functional/wallet-encryption.py",
      "position" : null,
      "pull_request_review_id" : 87069766,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019951",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019958"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019958"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Displaying the wrong time is kind of a problem, although maybe not a security one.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:26:14Z",
      "diff_hunk" : "@@ -2298,6 +2298,14 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int nSleepTime = request.params[1].get_int();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    pwallet->nRelockTime = GetTime() + nSleepTime;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019958",
      "id" : 160019958,
      "in_reply_to_id" : 160019905,
      "original_commit_id" : "370f1057661ed5de8efc64eec61813f12e9a1971",
      "original_position" : 10,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069778,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019958",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019984"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What would be the point of allowing 0?",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:27:25Z",
      "diff_hunk" : "@@ -2298,6 +2298,13 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int nSleepTime = request.params[1].get_int();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019984",
      "id" : 160019984,
      "in_reply_to_id" : 160019947,
      "original_commit_id" : "f94b423f276618a983993773a8b3c9c491d623db",
      "original_position" : 7,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069811,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019984",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019991"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019991"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps to just test if the passphrase is correct. (You're *currently* allowing zero here.)",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:28:18Z",
      "diff_hunk" : "@@ -2298,6 +2298,13 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int nSleepTime = request.params[1].get_int();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160019991",
      "id" : 160019991,
      "in_reply_to_id" : 160019947,
      "original_commit_id" : "f94b423f276618a983993773a8b3c9c491d623db",
      "original_position" : 7,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069817,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160019991",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160020062"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160020062"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> (You're currently allowing zero here.)\r\n\r\nRight.\r\n\r\nIt doesn't matter either way IMO.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:32:05Z",
      "diff_hunk" : "@@ -2298,6 +2298,13 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int nSleepTime = request.params[1].get_int();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160020062",
      "id" : 160020062,
      "in_reply_to_id" : 160019947,
      "original_commit_id" : "f94b423f276618a983993773a8b3c9c491d623db",
      "original_position" : 7,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87069888,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160020062",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160020102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160020102"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How can you guarantee that a number will be out of range?",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T07:34:54Z",
      "diff_hunk" : "@@ -56,6 +56,11 @@ def run_test(self):\n         assert_raises_rpc_error(-14, \"wallet passphrase entered was incorrect\", self.nodes[0].walletpassphrase, passphrase, 10)\n         self.nodes[0].walletpassphrase(passphrase2, 10)\n         assert_equal(privkey, self.nodes[0].dumpprivkey(address))\n+        self.nodes[0].walletlock()\n+\n+        # Test timeout bounds\n+        assert_raises_rpc_error(-8, \"Timeout cannot be negative.\", self.nodes[0].walletpassphrase, passphrase, -10)\n+        assert_raises_rpc_error(-1, \"JSON integer out of range\", self.nodes[0].walletpassphrase, passphrase, 2147483648)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160020102",
      "id" : 160020102,
      "in_reply_to_id" : 160019951,
      "original_commit_id" : "f94b423f276618a983993773a8b3c9c491d623db",
      "original_position" : 8,
      "path" : "test/functional/wallet-encryption.py",
      "position" : null,
      "pull_request_review_id" : 87069930,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160020102",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "I'd feel more comfortable using int64, but add a clamp (if value is over 100 years, set it to 100 years or so).",
      "created_at" : "2018-01-06T10:34:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-355738288",
      "id" : 355738288,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-06T10:34:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355738288",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160036843"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160036843"
         }
      },
      "author_association" : "NONE",
      "body" : "Why don't you add test for 2147483647? It should work correctly for this value but we don't test it today.\r\nOn the other hand waiting for timeout could be too long :) It should just accept the value.\r\n  ",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T22:55:58Z",
      "diff_hunk" : "@@ -56,6 +56,11 @@ def run_test(self):\n         assert_raises_rpc_error(-14, \"wallet passphrase entered was incorrect\", self.nodes[0].walletpassphrase, passphrase, 10)\n         self.nodes[0].walletpassphrase(passphrase2, 10)\n         assert_equal(privkey, self.nodes[0].dumpprivkey(address))\n+        self.nodes[0].walletlock()\n+\n+        # Test timeout bounds\n+        assert_raises_rpc_error(-8, \"Timeout cannot be negative.\", self.nodes[0].walletpassphrase, passphrase, -10)\n+        assert_raises_rpc_error(-1, \"JSON integer out of range\", self.nodes[0].walletpassphrase, passphrase, 2147483648)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160036843",
      "id" : 160036843,
      "in_reply_to_id" : 160019951,
      "original_commit_id" : "f94b423f276618a983993773a8b3c9c491d623db",
      "original_position" : 8,
      "path" : "test/functional/wallet-encryption.py",
      "position" : null,
      "pull_request_review_id" : 87086386,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160036843",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160036933"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160036933"
         }
      },
      "author_association" : "NONE",
      "body" : "Accepting 2147483647 (years long timeout) does not make too much sense in the time of Meltdown and Spectre vulnerabilities.\r\nAnyway having timeout on the level of single days can be too long for these type of attacks. ",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-06T23:01:17Z",
      "diff_hunk" : "@@ -2298,6 +2298,13 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int nSleepTime = request.params[1].get_int();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160036933",
      "id" : 160036933,
      "in_reply_to_id" : 160019947,
      "original_commit_id" : "f94b423f276618a983993773a8b3c9c491d623db",
      "original_position" : 7,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87086386,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160036933",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Giving big number does not make sense.\r\n\r\nYes it does.  A common and recommended configuration on a system with an online wallet which would otherwise not be encrypted is to encrypt and then manually unlock any time the system is restarted.  If we did not allow a setting which was effectively 'until restart' these systems would simply not use encryption.\r\n\r\nThis configuration saved localbitcoins loss of almost all their funds after a datacenter operator was social engineered, just as a single example. -- Facilities social engineering has historically been one of the most common compromise vectors, and it almost always results in a system reboot.\r\n\r\n> If it is intended to allow days then the timeout should be specified in \"days\" and not \"seconds\".\r\n\r\nDifferent applications have different scales.  More ordinary CLI user usage typical timeouts are just a few seconds or a few minutes.\r\n\r\n> What would be the point of allowing 0?\r\n\r\nTo trigger a keypool topup. (though I didn't look to see if that would be guaranteed to work, but we should make it do so by performing the topup on unlock while still holding the lock)\r\n\r\n> I'd feel more comfortable using int64, but add a clamp (if value is over 100 years, set it to 100 years or so).\r\n\r\nThat sounds fine, in particular we don't want people who have been happily using 999999999 to find it suddenly returning an error.\r\n  ",
      "created_at" : "2018-01-08T10:51:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-355934970",
      "id" : 355934970,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-08T10:52:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355934970",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I have changed this to clamp at 2^31 seconds so the wallet will lock for up to 2^31 seconds which is approximately 68 years. This number was chosen because the `time_t` type that is used for the timer can be a 32 bit signed integer on some systems so this will avoid sign flipping with such systems.",
      "created_at" : "2018-01-08T16:10:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-356011213",
      "id" : 356011213,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-08T16:10:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356011213",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160240189"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160240189"
         }
      },
      "author_association" : "NONE",
      "body" : "What was the root cause of  the behaviour described in #12100?\r\nIs it not this line that is causing this strange behaviour?",
      "commit_id" : "09fbbfaccaef0c521e077b349a3422065b493c16",
      "created_at" : "2018-01-08T19:55:08Z",
      "diff_hunk" : "@@ -2298,6 +2298,17 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int64_t nSleepTime = request.params[1].get_int64();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160240189",
      "id" : 160240189,
      "original_commit_id" : "09fbbfaccaef0c521e077b349a3422065b493c16",
      "original_position" : 5,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 87321031,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-08T19:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160240189",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't know why travis is failing.",
      "created_at" : "2018-01-08T20:00:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-356079074",
      "id" : 356079074,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-08T20:00:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356079074",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Maybe add a limit to \"help\" printout? \r\n2272:`            \"2. timeout            (numeric, required) The time to keep the decryption key in seconds.\\n\"`\r\n",
      "created_at" : "2018-01-08T21:35:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-356104054",
      "id" : 356104054,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-08T21:35:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356104054",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "It looks like Travis test fails on 32bit architecture. There is something wrong as you get a lot of messages like:\r\n`JSONRPCException: Error: Please enter the wallet passphrase with walletpassphrase first.`\r\nI don't know yet why you get it yet.\r\n\r\nAlso you can see that in the log printout there is a wrong value:\r\n`node1 2018-01-08 18:52:07.849526 queue run of timer lockwallet(wallet.dat) in -2147483648 seconds (using HTTP) `\r\nThe number is -2147483648 is 1L<<31 on 32bit architecture.\r\nThis faulty printout is probably caused by LogPrint string formatting in RPCRunLater:\r\n`LogPrint(BCLog::RPC, \"queue run of timer %s in %i seconds (using %s)\\n\", name, nSeconds, timerInterface->Name());`\r\n",
      "created_at" : "2018-01-09T21:14:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-356415999",
      "id" : 356415999,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-09T21:14:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356415999",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@bolekC Added some info about the limit to the help output.\r\n\r\nI think I fixed the travis error. It has to do with the type of the value being shifted. The log output is correct.",
      "created_at" : "2018-01-10T19:21:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-356708053",
      "id" : 356708053,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-10T19:21:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356708053",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160779697"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160779697"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Python allows [chained comparisons](https://docs.python.org/3/reference/expressions.html#comparisons): `expected_time <= actual_time < expected_time + 5`",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-10T19:43:52Z",
      "diff_hunk" : "@@ -56,6 +56,21 @@ def run_test(self):\n         assert_raises_rpc_error(-14, \"wallet passphrase entered was incorrect\", self.nodes[0].walletpassphrase, passphrase, 10)\n         self.nodes[0].walletpassphrase(passphrase2, 10)\n         assert_equal(privkey, self.nodes[0].dumpprivkey(address))\n+        self.nodes[0].walletlock()\n+\n+        # Test timeout bounds\n+        assert_raises_rpc_error(-8, \"Timeout cannot be negative.\", self.nodes[0].walletpassphrase, passphrase2, -10)\n+        # Check the timeout\n+        # Check a time less than the limit\n+        expected_time = int(time.time()) + (1 << 31) - 600\n+        self.nodes[0].walletpassphrase(passphrase2, (1 << 31) - 600)\n+        actual_time = self.nodes[0].getwalletinfo()['unlocked_until']\n+        assert actual_time < expected_time + 5 and actual_time >= expected_time # 5 second buffer",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160779697",
      "id" : 160779697,
      "original_commit_id" : "71620b3cb3b7fd340e65730865c601b291e57fd4",
      "original_position" : 13,
      "path" : "test/functional/wallet-encryption.py",
      "position" : null,
      "pull_request_review_id" : 87957333,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160779697",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160785990"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160785990"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-10T20:08:37Z",
      "diff_hunk" : "@@ -56,6 +56,21 @@ def run_test(self):\n         assert_raises_rpc_error(-14, \"wallet passphrase entered was incorrect\", self.nodes[0].walletpassphrase, passphrase, 10)\n         self.nodes[0].walletpassphrase(passphrase2, 10)\n         assert_equal(privkey, self.nodes[0].dumpprivkey(address))\n+        self.nodes[0].walletlock()\n+\n+        # Test timeout bounds\n+        assert_raises_rpc_error(-8, \"Timeout cannot be negative.\", self.nodes[0].walletpassphrase, passphrase2, -10)\n+        # Check the timeout\n+        # Check a time less than the limit\n+        expected_time = int(time.time()) + (1 << 31) - 600\n+        self.nodes[0].walletpassphrase(passphrase2, (1 << 31) - 600)\n+        actual_time = self.nodes[0].getwalletinfo()['unlocked_until']\n+        assert actual_time < expected_time + 5 and actual_time >= expected_time # 5 second buffer",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160785990",
      "id" : 160785990,
      "in_reply_to_id" : 160779697,
      "original_commit_id" : "71620b3cb3b7fd340e65730865c601b291e57fd4",
      "original_position" : 13,
      "path" : "test/functional/wallet-encryption.py",
      "position" : null,
      "pull_request_review_id" : 87964846,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160785990",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160793653"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160793653"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Might want to use the provided `assert_greater...` helper methods to give a more verbose output in case of failure.\r\n\r\nCurrent error shows only:\r\n\r\n```\r\nFile \"/home/travis/build/bitcoin/bitcoin/build/bitcoin-i686-pc-linux-gnu/test/functional/wallet-encryption.py\", line 68, in run_test\r\n    assert expected_time <= actual_time < expected_time + 5 # 5 second buffer\r\nAssertionError\r\n```\r\n\r\nand not by how much it was off.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-10T20:46:06Z",
      "diff_hunk" : "@@ -56,6 +56,21 @@ def run_test(self):\n         assert_raises_rpc_error(-14, \"wallet passphrase entered was incorrect\", self.nodes[0].walletpassphrase, passphrase, 10)\n         self.nodes[0].walletpassphrase(passphrase2, 10)\n         assert_equal(privkey, self.nodes[0].dumpprivkey(address))\n+        self.nodes[0].walletlock()\n+\n+        # Test timeout bounds\n+        assert_raises_rpc_error(-8, \"Timeout cannot be negative.\", self.nodes[0].walletpassphrase, passphrase2, -10)\n+        # Check the timeout\n+        # Check a time less than the limit\n+        expected_time = int(time.time()) + (1 << 31) - 600\n+        self.nodes[0].walletpassphrase(passphrase2, (1 << 31) - 600)\n+        actual_time = self.nodes[0].getwalletinfo()['unlocked_until']\n+        assert expected_time <= actual_time < expected_time + 5 # 5 second buffer",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160793653",
      "id" : 160793653,
      "original_commit_id" : "a36965c19896265b5ccb5f4a30315f32dc1e6b34",
      "original_position" : 13,
      "path" : "test/functional/wallet-encryption.py",
      "position" : null,
      "pull_request_review_id" : 87974325,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160793653",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160796267"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160796267"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-10T20:57:50Z",
      "diff_hunk" : "@@ -56,6 +56,21 @@ def run_test(self):\n         assert_raises_rpc_error(-14, \"wallet passphrase entered was incorrect\", self.nodes[0].walletpassphrase, passphrase, 10)\n         self.nodes[0].walletpassphrase(passphrase2, 10)\n         assert_equal(privkey, self.nodes[0].dumpprivkey(address))\n+        self.nodes[0].walletlock()\n+\n+        # Test timeout bounds\n+        assert_raises_rpc_error(-8, \"Timeout cannot be negative.\", self.nodes[0].walletpassphrase, passphrase2, -10)\n+        # Check the timeout\n+        # Check a time less than the limit\n+        expected_time = int(time.time()) + (1 << 31) - 600\n+        self.nodes[0].walletpassphrase(passphrase2, (1 << 31) - 600)\n+        actual_time = self.nodes[0].getwalletinfo()['unlocked_until']\n+        assert expected_time <= actual_time < expected_time + 5 # 5 second buffer",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160796267",
      "id" : 160796267,
      "in_reply_to_id" : 160793653,
      "original_commit_id" : "a36965c19896265b5ccb5f4a30315f32dc1e6b34",
      "original_position" : 13,
      "path" : "test/functional/wallet-encryption.py",
      "position" : null,
      "pull_request_review_id" : 87977536,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160796267",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I changed the clamp to be at 2^31 - 1 seconds. Hopefully that fixes the travis problem with 32-bit linux.",
      "created_at" : "2018-01-10T21:24:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-356741496",
      "id" : 356741496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-10T21:24:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356741496",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160806318"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160806318"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You could use the named constexpr `std::numeric_limits<int32_t>::max()`.\r\n\r\nAlso, how does that take into account your observation that \"the time_t type that is used for the timer can be a 32 bit signed integer on some systems\". (Considering that nSleepTime is multiplied by 1000 somewhere down in the call stack)",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-10T21:42:28Z",
      "diff_hunk" : "@@ -2298,6 +2298,17 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int64_t nSleepTime = request.params[1].get_int64();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    // Clamp timeout to 2^31 seconds\n+    if (nSleepTime > ((int64_t)1 << 31) - 1) {\n+        nSleepTime = ((int64_t)1 << 31) - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160806318",
      "id" : 160806318,
      "original_commit_id" : "7945bd09b9c0b4813c822eb08af60a6fb4248117",
      "original_position" : 21,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87989710,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160806318",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160810186"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160810186"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> You could use the named constexpr `std::numeric_limits<int32_t>::max()`.\r\n\r\nI'll try that now.\r\n\r\n> Also, how does that take into account your observation that \"the time_t type that is used for the timer can be a 32 bit signed integer on some systems\". (Considering that nSleepTime is multiplied by 1000 somewhere down in the call stack)\r\n\r\nIt's multiplied by 1000 and then divided by 1000 before going into the `time_t`.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-10T21:58:43Z",
      "diff_hunk" : "@@ -2298,6 +2298,17 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int64_t nSleepTime = request.params[1].get_int64();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    // Clamp timeout to 2^31 seconds\n+    if (nSleepTime > ((int64_t)1 << 31) - 1) {\n+        nSleepTime = ((int64_t)1 << 31) - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160810186",
      "id" : 160810186,
      "in_reply_to_id" : 160806318,
      "original_commit_id" : "7945bd09b9c0b4813c822eb08af60a6fb4248117",
      "original_position" : 21,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 87994352,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160810186",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160830277"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160830277"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ah, ok. But since nSleepTime represents a delta, that is added onto `GetTime()`, capping it at the max of int32_t is not enough?",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-10T23:41:47Z",
      "diff_hunk" : "@@ -2298,6 +2298,17 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int64_t nSleepTime = request.params[1].get_int64();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    // Clamp timeout to 2^31 seconds\n+    if (nSleepTime > ((int64_t)1 << 31) - 1) {\n+        nSleepTime = ((int64_t)1 << 31) - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160830277",
      "id" : 160830277,
      "in_reply_to_id" : 160806318,
      "original_commit_id" : "7945bd09b9c0b4813c822eb08af60a6fb4248117",
      "original_position" : 21,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 88017623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160830277",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160832057"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160832057"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The timer itself uses the delta. The only thing that's added is `wallet->nRelockTime` which is only used for display in `getwalletinfo`.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-10T23:54:40Z",
      "diff_hunk" : "@@ -2298,6 +2298,17 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int64_t nSleepTime = request.params[1].get_int64();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    // Clamp timeout to 2^31 seconds\n+    if (nSleepTime > ((int64_t)1 << 31) - 1) {\n+        nSleepTime = ((int64_t)1 << 31) - 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160832057",
      "id" : 160832057,
      "in_reply_to_id" : 160806318,
      "original_commit_id" : "7945bd09b9c0b4813c822eb08af60a6fb4248117",
      "original_position" : 21,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 88019826,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160832057",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "utACK, agree that clamping is marginally better in this specific case, as there is no standardized way to specify \"forever\" and unlocking for 68 years might was well be forever.",
      "created_at" : "2018-01-11T13:21:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-356932153",
      "id" : 356932153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-11T13:21:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356932153",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160956012"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160956012"
         }
      },
      "author_association" : "OWNER",
      "body" : "The clamping semantics need to be in the documentation.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-11T13:22:30Z",
      "diff_hunk" : "@@ -2269,7 +2269,7 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n             \"This is needed prior to performing transactions related to private keys such as sending bitcoins\\n\"\n             \"\\nArguments:\\n\"\n             \"1. \\\"passphrase\\\"     (string, required) The wallet passphrase\\n\"\n-            \"2. timeout            (numeric, required) The time to keep the decryption key in seconds.\\n\"\n+            \"2. timeout            (numeric, required) The time to keep the decryption key in seconds. Limited to at most 2147483647 (2^31 - 1) seconds.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r160956012",
      "id" : 160956012,
      "original_commit_id" : "6eeeb1329949ea2afc385ce1fca50087f4c40692",
      "original_position" : 5,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 88163793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160956012",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r161031786"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161031786"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-11T18:06:40Z",
      "diff_hunk" : "@@ -2269,7 +2269,7 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n             \"This is needed prior to performing transactions related to private keys such as sending bitcoins\\n\"\n             \"\\nArguments:\\n\"\n             \"1. \\\"passphrase\\\"     (string, required) The wallet passphrase\\n\"\n-            \"2. timeout            (numeric, required) The time to keep the decryption key in seconds.\\n\"\n+            \"2. timeout            (numeric, required) The time to keep the decryption key in seconds. Limited to at most 2147483647 (2^31 - 1) seconds.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r161031786",
      "id" : 161031786,
      "in_reply_to_id" : 160956012,
      "original_commit_id" : "6eeeb1329949ea2afc385ce1fca50087f4c40692",
      "original_position" : 5,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 88254860,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-12T05:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161031786",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Maybe you can add some more observability from C++ code to debug.log \r\nIt can help to find what is wrong with tests on 32bit.\r\n\r\nIt looks like you get similar fault as original one but only on 32 bits now. From the log you can see that actual_time is 0. This is taken from pwallet->nRelockTime. So if it is 0 then the wallet is locked. \r\n\r\nI don't see how this can happen. It might be some other fault related to the timers handling? \r\n\r\nI've tested a bit on the official release and I have found that the on 64bits it works fine for\r\n9223372036854775 and lower timeout values\r\nand fails for \r\n9223372036854776 and bigger timeout values (than again it works and fails in a cyclic way but I'have not found yet the cycle amplitude... maybe tomorrow but it is on the level of 2^53).\r\n\r\nThe point is that 9223372036854776 is nothing special when it comes to binary representation. This suggests that fault might be somewhere else.\r\n\r\n",
      "created_at" : "2018-01-11T22:02:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357075687",
      "id" : 357075687,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-11T22:02:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357075687",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@bolekC It has nothing to do with the 64 bit integer but rather overflowing on a 32-bit integer. Actually, this could be a problem related to single precision floats. I'm not sure, so I added debugging output so we can see what is wrong on travis.",
      "created_at" : "2018-01-11T22:55:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357088689",
      "id" : 357088689,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-11T22:55:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357088689",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This travis error continues to confuse me. It does not appear to be a sign issue in the `timeval` struct, yet the wallet is still locking immediately.",
      "created_at" : "2018-01-12T01:49:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357119485",
      "id" : 357119485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-12T01:49:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357119485",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I got fed up with debugging this thing and just lowered the clamp to 2^30 seconds. I believe that should work and ~34 years is still long enough.",
      "created_at" : "2018-01-12T05:00:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357143832",
      "id" : 357143832,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-12T05:00:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357143832",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Please adjust the OP, since that ends up in the commit body of the merge commit.",
      "created_at" : "2018-01-12T16:17:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357282781",
      "id" : 357282781,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-12T16:17:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357282781",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke adjusted",
      "created_at" : "2018-01-12T16:38:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357288738",
      "id" : 357288738,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-12T16:38:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357288738",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I still think we don't understand the fault's root cause very well. This 32bit failing doesn't give a rest.\r\nI have tested this functionality on 32bit version (0.15.1 without your fixes). What I have found is:\r\n\r\n1. with big timeout (e.g. famous 9223372036854776) bitcoind (sometimes!!!) crashes with\r\n`libevent: event.c:3117: Assertion tv->tv_usec >= 0 failed in timeout_next`\r\n- this one should be prevented by your solution\r\n- anyway worth to test\r\n\r\n2. when timeout + time() (given timeout + current system time in seconds) >= 3 663 264 070 then wallet is blocked immediately (like in original issue)\r\n- no idea why this happens\r\n- your solution may fail when timeout will be 2^30 and system time will be later than: GMT: Monday, 22 January 2052 07:44:06\r\n\r\nI suspect QTimer implementation but I have not succeeded to troubleshoot it yet.\r\n\r\nStill open questions: Why with high numbers wallet it re-locked immediately? What is causing this behaviour? Which code exactly? Is it QTimer?",
      "created_at" : "2018-01-12T21:09:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357354653",
      "id" : 357354653,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-12T21:09:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357354653",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I still think we don't understand the fault's root cause very well.\r\n\r\nThat's correct. I have no clue why it is failing, although I believe it has to do with floating point numbers. I'm pretty sure the issue has to do with the `timeval` struct, in particular `tv.tv_sec`'s type of `time_t`.\r\n\r\n> I suspect QTimer implementation but I have not succeeded to troubleshoot it yet.\r\n\r\nWe don't use QTimers. Rather it uses `libevent`, so the issue lies in their implementation AFAICT.",
      "created_at" : "2018-01-12T21:29:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357359409",
      "id" : 357359409,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-12T21:29:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357359409",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Sure it's `libevent`. I've mixed it up. There must be something wrong somewhere :)",
      "created_at" : "2018-01-12T22:59:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357377686",
      "id" : 357377686,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-12T22:59:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357377686",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "> We don't use QTimers. Rather it uses libevent, so the issue lies in their implementation AFAICT.\r\n\r\nIn the most common case, yes. IIRC it does use QTimers when -server is false in the GUI: in that case libevent isn't initialized. Multiple timer implementations can be registered through `RPCSetTimerInterface`.\r\n",
      "created_at" : "2018-01-15T08:39:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357615715",
      "id" : 357615715,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-15T08:39:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357615715",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Not sure why I didn't think of this sooner: but another thing we can do instead of clamping the time when larger than a certain value, is to not use a timer at all in that case - interpret large numbers as 'infinite', unlocking forever (or until manually re-locked). Of course, this needs to be documented.\r\n\r\nThis avoids having to cope with timer edge-case behavior entirely.\r\n",
      "created_at" : "2018-01-16T11:57:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-357938753",
      "id" : 357938753,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-16T11:58:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357938753",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r161797998"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161797998"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could just write 1L instead of casting 1.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-16T15:47:43Z",
      "diff_hunk" : "@@ -2298,6 +2299,17 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int64_t nSleepTime = request.params[1].get_int64();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    // Clamp timeout to 2^30 seconds\n+    if (nSleepTime > (int64_t)1 << 30) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r161797998",
      "id" : 161797998,
      "original_commit_id" : "0b63e3c7b20ea54930de3ec3955406e4d4737e3c",
      "original_position" : 21,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 21,
      "pull_request_review_id" : 89143143,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-16T15:50:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161797998",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Since it seems infeasible to support large timeouts and clamping doesn't work very well on every platform, I'd prefer the approach by @laanwj to unlock and just return and not set any (potentially false) timers",
      "created_at" : "2018-01-16T16:22:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358017765",
      "id" : 358017765,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-16T16:22:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358017765",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> clamping doesn't work very well on every platform\r\n\r\nWhere are you seeing this? It seems like current implementation should work on every platform. Agree that laanwj's suggestion would make code a little cleaner, but the behavior for all practical purposes would seem identical to what is implemented here.\r\n\r\nAlso, regardless of anything, current PR seems like an improvement over status the quo.",
      "created_at" : "2018-01-16T17:13:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358034251",
      "id" : 358034251,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-16T17:13:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358034251",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Where are you seeing this?\r\n\r\nThe \"magic value\" was determined by \"ok, `std::numeric_limits<int32_t>::max()` doesn't work, so let's go a bit lower and try again\". See\r\n\r\n> I got fed up with debugging this thing and just lowered the clamp to 2^30 seconds\r\n\r\n> Also, regardless of anything, current PR seems like an improvement over status the quo.\r\n\r\nAgree.",
      "created_at" : "2018-01-16T17:58:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358049514",
      "id" : 358049514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-16T17:58:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358049514",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r161839813"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161839813"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I was having some problems with using 1L on 32 bit systems so explicitly casting it like this seemed to be better.",
      "commit_id" : "134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-16T18:07:45Z",
      "diff_hunk" : "@@ -2298,6 +2299,17 @@ UniValue walletpassphrase(const JSONRPCRequest& request)\n     // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n     strWalletPass = request.params[0].get_str().c_str();\n \n+    // Get the timeout\n+    int64_t nSleepTime = request.params[1].get_int64();\n+    // Timeout cannot be negative, otherwise it will relock immediately\n+    if (nSleepTime < 0) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Timeout cannot be negative.\");\n+    }\n+    // Clamp timeout to 2^30 seconds\n+    if (nSleepTime > (int64_t)1 << 30) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#discussion_r161839813",
      "id" : 161839813,
      "in_reply_to_id" : 161797998,
      "original_commit_id" : "0b63e3c7b20ea54930de3ec3955406e4d4737e3c",
      "original_position" : 21,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 21,
      "pull_request_review_id" : 89193157,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12101",
      "updated_at" : "2018-01-16T18:07:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161839813",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 134cdc7cee3da7c554e40ad947a9cdcbb3069f13",
      "created_at" : "2018-01-16T18:08:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358053102",
      "id" : 358053102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-16T18:08:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358053102",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> clamping doesn't work very well on every platform\r\n\r\nWe would still need some magic value where all of the values less than it are valid timeouts. Using `std::numeric_limits<int32_t>::max()` as the cutoff magic value for an infinite timeout would still be problematic as using certain values less than that would still result in invalid timeouts. Changing it from clamping to \"infinite timeout cutoff\" doesn't resolve that problem.",
      "created_at" : "2018-01-16T18:13:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358054644",
      "id" : 358054644,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-16T18:13:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358054644",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think the suggestion is to simply not call RPCRunLater if there is an infinite timeout.",
      "created_at" : "2018-01-16T18:26:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358058562",
      "id" : 358058562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-16T18:26:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358058562",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Just to remind that **we don't know the root cause** of this behaviour. Suspected is `libevent` library.\r\n\r\nDescribed behaviour is that with big number wallet gets locked immediately so probably timeout is fired right after the command to set timer is given. I have observed also that sometimes this is few seconds delayed if bitcoind is heavily occupied with some tasks. This suggests event handling. \r\n\r\nFind a root cause to have 100% safe solution. I have not debugged it to this level yet (lack of time)",
      "created_at" : "2018-01-16T21:06:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358105623",
      "id" : 358105623,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-16T21:06:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358105623",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/35047517?v=4",
         "events_url" : "https://api.github.com/users/bolekC/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bolekC/followers",
         "following_url" : "https://api.github.com/users/bolekC/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bolekC/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bolekC",
         "id" : 35047517,
         "login" : "bolekC",
         "organizations_url" : "https://api.github.com/users/bolekC/orgs",
         "received_events_url" : "https://api.github.com/users/bolekC/received_events",
         "repos_url" : "https://api.github.com/users/bolekC/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bolekC/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bolekC/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bolekC"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`0 <= nSleepTime <= 1,073,741,824` in wallet/rpcwallet.cpp is an int64_t, measured in seconds\r\n\r\n`pwallet->nRelockTime = GetTime()+nSleepTime` in wallet/rpcwallet.cpp is an int64_t, so will only overflow when GetTime() returns `2**30*(2**33-1)` which is about 292 million millenia away, and it's only used for printing in any event.\r\n\r\n`nSleepTime` gets passed to RPCRunLater which multiplies it by 1000 to convert to milliseconds and passes it to RPCTimerInterface::NewTimer as an int64_t. `0 <= 1000*nSleepTime <= 1,073,741,824,000`, which fits in about 40 bits, so still doesn't overflow.\r\n\r\nRPCTimerInterface::NewTimer can be either QtRPCTimerInterface (using QTimers) or HTTPRPCTimerInterface (using libevent).\r\n\r\nQtRPCTimerInterface passes the millisecond value to QTimer::start(), which in Qt5 accepts a std::chrono::milliseconds which is specced to be at least 45 bits, so is fine. In Qt4.8 it's specced as an int, and if int maxes out at 2**31-1 will overflow if nSleepTime is 2147484 or above, which is about 24 days.\r\n\r\nHTTPRPCTimerInterface makes an HTTPRPCTimer, which populates a timeval with `millis/1000` and `(millis%1000)*1000`. The latter should be fine, the former will overflow if time_t maxes out at `2**31-1` and millis is at least `2**31*1000`, ie `nSleepTime >= 2**31` which is already forbidden. The timeval is then passed to libevent's `evtimer_add()`, and libevent then turns the time into an absolute value using `timeradd()` from `<sys/time.h>` which will overflow if the final time overflows time_t, ie the Y2038 bug. This will happen if nSleepTime is greater than about 631,300,000 which is about `2**(29.2)`, decreasing every second as 2038 gets closer.\r\n\r\nTrying on Debian/i386, I can confirm that libevent gets an event with a negative timeout in that scenario, which I would expect to behave badle. I can't actually get the event to trigger, however, so I'm not sure if this can be made to cause the wallet to actually be re-locked early. (Checking it's re-locked at the correct time doesn't seem worthwhile, since time_t will have wrapped by then, and who knows what will have broken...)\r\n\r\nSo if this needs to be improved further, maybe a check along the lines of `nRelockTime < std::numeric_limits<time_t>::max()` could be added.\r\n\r\nBut as is, I agree this makes things better than the status-quo, so ACK 134cdc7cee3da7c554e40ad947a9cdcbb3069f13 .",
      "created_at" : "2018-01-17T10:28:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358262507",
      "id" : 358262507,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-17T10:28:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358262507",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay, retrying with the limit being `2**31-1`, I get a libevent timeout at time `-631,298,485` which then gets handled immediately, causing the wallet to be relocked. I don't know why libevent handles that timeout immediately, but appears happy to leave a timeout corresponding to `-2**32` or just after Y2038 pending indefinitely.",
      "created_at" : "2018-01-17T10:36:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358264524",
      "id" : 358264524,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-17T10:36:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358264524",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "> Also, regardless of anything, current PR seems like an improvement over status the quo.\r\n\r\nOK, I agree. I was just a bit wary of setting a timer that we assume will never trigger at all, might as well not set it, but indeed this improves on the issue. Can be improved later.\r\nutACK 134cdc7",
      "created_at" : "2018-01-17T11:17:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-358274394",
      "id" : 358274394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-01-17T11:17:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358274394",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This change seems to break `wallet_encryption.py` on MacOS, see #12375 by @AkioNak. ",
      "created_at" : "2018-02-22T09:40:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12101#issuecomment-367623015",
      "id" : 367623015,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12101",
      "updated_at" : "2018-02-22T09:40:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/367623015",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
