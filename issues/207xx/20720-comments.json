[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, the issue is known in other open-source projects: https://github.com/gdnsd/gdnsd/commit/582004ebfee2e0d341e391e96f0ca116f443c413",
      "created_at" : "2020-12-19T09:20:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748447354",
      "id" : 748447354,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODQ0NzM1NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T09:20:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748447354",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cr ACK 01ca4bdadd250d24912cc08149a130a538e76a4f: patch looks correct",
      "created_at" : "2020-12-19T09:28:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748448292",
      "id" : 748448292,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODQ0ODI5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T09:28:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748448292",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This makes sense. For me it brings up the question \"why aren't we doing this for all hardening flags\"?\r\n",
      "created_at" : "2020-12-19T10:45:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748456438",
      "id" : 748456438,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODQ1NjQzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T10:45:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748456438",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for testing @hebasto. However the previous patch wasn't working correctly. The flag would actually **NEVER** be applied (even where it would work correctly), because the source being compiled wasn't valid ð¤¦ . I've fixed that now.\r\n\r\n> For me it brings up the question \"why aren't we doing this for all hardening flags\"?\r\n\r\nI'm currently reviewing all of our flags for any other subtle breakages. It very well might make sense to do this for all flags going forward.",
      "created_at" : "2020-12-20T08:12:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748576983",
      "id" : 748576983,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODU3Njk4Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T08:12:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748576983",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> ... because the source being compiled wasn't valid\r\n\r\nIndeed. I confused `AC_LANG_SOURCE` and `AC_LANG_PROGRAM` macros :man_facepalming: (btw, the latter seems more concise for this change).",
      "created_at" : "2020-12-20T09:42:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748585217",
      "id" : 748585217,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODU4NTIxNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T09:42:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748585217",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm currently reviewing all of our flags for any other subtle breakages. It very well might make sense to do this for all flags going forward.\r\n\r\nThinking about it, it *is* a bit of a compromise. We wouldn't want to increase the opportunity to silently lose hardening flags. Of course the security checks are the best place to verify this, but we don't have checks for all of the hardening mechanisms (if that is even possible).",
      "created_at" : "2020-12-20T12:08:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748599376",
      "id" : 748599376,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODU5OTM3Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T12:08:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748599376",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've changed the approach here to check for link errors, as even when the error is emitted, compilation succeeds, and the binaries produced will run. This means we can't just check if the compiler accepts the flag, or if compilation succeeds (without or without `-Werror`, and/or passing `-Wl,--fatal-warnings`, which may not be passed through to the linker).\r\n\r\nInstead we can do a link check, with `--fatal-warnings`, and not add `-fcf-protection` to our HARDENED_CXXFLAGS if we see any errors.\r\n\r\nI have only seen this link issue with Clang 7 (when support for `-fcf-protection` was introduced). Clang 8+ look ok.",
      "created_at" : "2020-12-20T14:00:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748611623",
      "id" : 748611623,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODYxMTYyMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T14:00:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748611623",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Unfortunately still broken on Debian 10.7.\r\n\r\n[build.log](https://github.com/bitcoin/bitcoin/files/5721546/build.log)\r\n",
      "created_at" : "2020-12-20T21:26:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748673073",
      "id" : 748673073,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODY3MzA3Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T21:26:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748673073",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/620611?v=4",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "node_id" : "MDQ6VXNlcjYyMDYxMQ==",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Unfortunately still broken on Debian 10.7.\r\n\r\nLooking at the build.log, the change here is working as expected and isn't adding `-fcf-protection` to the hardened flags when the linker emits an error:\r\n```bash\r\nchecking whether the linker accepts -fcf-protection=full... no\r\n....\r\nconfigure:20769: checking whether the linker accepts -fcf-protection=full\r\nconfigure:20788: clang++ -std=c++17 -o conftest -g -O2  -DHAVE_BUILD_INFO -D__STDC_FORMAT_MACROS  -Wl,--fatal-warnings -fcf-protection=full conftest.cpp  >&5\r\n/usr/bin/ld: error: /tmp/conftest-afee8c.o: <corrupt x86 feature size: 0x8>\r\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\r\nconfigure:20788: $? = 1\r\nconfigure: failed program was:\r\n```\r\n\r\nThe build error you're now seeing:\r\n```bash\r\n  CXXLD    test/fuzz/fuzz\r\n/usr/bin/ld: test/fuzz/fuzz-addrdb.o: in function `ConsumeNode(FuzzedDataProvider&)':\r\n/home/bitcoin/bitcoin/src/./test/fuzz/util.h:290: multiple definition of `ConsumeNode(FuzzedDataProvider&)'; test/fuzz/fuzz-addition_overflow.o:/home/bitcoin/bitcoin/src/./test/fuzz/util.h:290: first defined here\r\n/usr/bin/ld: test/fuzz/fuzz-addrdb.o: in function `ConsumeSubNet(FuzzedDataProvider&)':\r\n/home/bitcoin/bitcoin/src/./test/fuzz/util.h:275: multiple definition of `ConsumeSubNet(FuzzedDataProvider&)'; test/fuzz/fuzz-addition_overflow.o:/home/bitcoin/bitcoin/src/./test/fuzz/util.h:275: first defined here\r\n/usr/bin/ld: test/fuzz/fuzz-addrdb.o: in function `ConsumeAddress(FuzzedDataProvider&)':\r\n/home/bitcoin/bitcoin/src/./test/fuzz/util.h:285: multiple definition of `ConsumeAddress(FuzzedDataProvider&)'; test/fuzz/fuzz-addition_overflow.o:/home/bitcoin/bitcoin/src/./test/fuzz/util.h:285: first defined here\r\n...\r\n```\r\nlooks more like the one reported [here](https://github.com/bitcoin/bitcoin/pull/20560#issuecomment-748339644).",
      "created_at" : "2020-12-20T22:53:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748682651",
      "id" : 748682651,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODY4MjY1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T22:53:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748682651",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I was wrong, you're right, this is another failure described here https://github.com/bitcoin/bitcoin/pull/20560#issuecomment-748339644\r\n\r\n",
      "created_at" : "2020-12-20T23:14:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748685118",
      "id" : 748685118,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODY4NTExOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T23:14:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748685118",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/620611?v=4",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "node_id" : "MDQ6VXNlcjYyMDYxMQ==",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "tested ACK e9189a750b237eba1befc6b16c12c2cee3e0176c",
      "created_at" : "2020-12-20T23:28:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748686751",
      "id" : 748686751,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODY4Njc1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T23:28:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748686751",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/620611?v=4",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "node_id" : "MDQ6VXNlcjYyMDYxMQ==",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "not an ACK e9189a750b237eba1befc6b16c12c2cee3e0176c , I only tested configure on my system (gcc-10, clang-11):\r\n\r\n```diff\r\ndiff --git a/tmp/a_gcc b/tmp/b_gcc\r\nindex c0ef19c9a8..d7e3ac31c2 100644\r\n--- a/tmp/a_gcc\r\n+++ b/tmp/b_gcc\r\n@@ -174,7 +174,7 @@ checking whether C++ compiler accepts -fPIC... yes\r\n checking whether C++ compiler accepts -fstack-reuse=none... yes\r\n checking whether C++ compiler accepts -Wstack-protector... yes\r\n checking whether C++ compiler accepts -fstack-protector-all... yes\r\n-checking whether C++ compiler accepts -fcf-protection=full... yes\r\n+checking whether the linker accepts -fcf-protection=full... yes\r\n checking whether C++ compiler accepts -fstack-clash-protection... yes\r\n checking whether C++ preprocessor accepts -D_FORTIFY_SOURCE=2... yes\r\n checking whether C++ preprocessor accepts -U_FORTIFY_SOURCE... yes\r\n\r\n\r\ndiff --git a/tmp/a_clang b/tmp/b_clang\r\nindex 68c613d418..f238d83acd 100644\r\n--- a/tmp/a_clang\r\n+++ b/tmp/b_clang\r\n@@ -174,7 +174,7 @@ checking whether C++ compiler accepts -fPIC... yes\r\n checking whether C++ compiler accepts -fstack-reuse=none... no\r\n checking whether C++ compiler accepts -Wstack-protector... yes\r\n checking whether C++ compiler accepts -fstack-protector-all... yes\r\n-checking whether C++ compiler accepts -fcf-protection=full... yes\r\n+checking whether the linker accepts -fcf-protection=full... yes\r\n checking whether C++ compiler accepts -fstack-clash-protection... yes\r\n checking whether C++ preprocessor accepts -D_FORTIFY_SOURCE=2... yes\r\n checking whether C++ preprocessor accepts -U_FORTIFY_SOURCE... yes\r\n",
      "created_at" : "2020-12-21T07:31:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#issuecomment-748815722",
      "id" : 748815722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20720",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODgxNTcyMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-21T07:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748815722",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20720#discussion_r551249268"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20720"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551249268"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style nit: the readability could be improved\r\n```suggestion\r\n  AX_CHECK_LINK_FLAG([-fcf-protection=full], [HARDENED_CXXFLAGS=\"$HARDENED_CXXFLAGS -fcf-protection=full\"], [], [$LDFLAG_WERROR])\r\n```",
      "commit_id" : "e9189a750b237eba1befc6b16c12c2cee3e0176c",
      "created_at" : "2021-01-04T11:00:42Z",
      "diff_hunk" : "@@ -819,7 +819,10 @@ if test x$use_hardening != xno; then\n   AX_CHECK_COMPILE_FLAG([-Wstack-protector],[HARDENED_CXXFLAGS=\"$HARDENED_CXXFLAGS -Wstack-protector\"])\n   AX_CHECK_COMPILE_FLAG([-fstack-protector-all],[HARDENED_CXXFLAGS=\"$HARDENED_CXXFLAGS -fstack-protector-all\"])\n \n-  AX_CHECK_COMPILE_FLAG([-fcf-protection=full],[HARDENED_CXXFLAGS=\"$HARDENED_CXXFLAGS -fcf-protection=full\"])\n+  dnl -fcf-protection used with Clang 7 causes ld to emit warnings:\n+  dnl ld: error: ... <corrupt x86 feature size: 0x8>\n+  dnl Use CHECK_LINK_FLAG & --fatal-warnings to ensure we wont use the flag in this case.\n+  AX_CHECK_LINK_FLAG([-fcf-protection=full],[HARDENED_CXXFLAGS=\"$HARDENED_CXXFLAGS -fcf-protection=full\"],, [[$LDFLAG_WERROR]])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20720#discussion_r551249268",
      "id" : 551249268,
      "line" : 825,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTI0OTI2OA==",
      "original_commit_id" : "e9189a750b237eba1befc6b16c12c2cee3e0176c",
      "original_line" : 825,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "configure.ac",
      "position" : 8,
      "pull_request_review_id" : 560943752,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20720",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-04T11:01:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551249268",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   }
]
