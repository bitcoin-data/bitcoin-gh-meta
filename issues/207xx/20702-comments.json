[
   {
      "author_association" : "MEMBER",
      "body" : "I expect this to be a difficult sell because we generally don't treat any of the data files as a stable external interface. Pointers to the file system can be considered implementation details subject to change.\r\n\r\nBut on the other hand, the format of the block files *specifically* hasn't ever significantly changed, and is (I think) unlikely to change. \r\n\r\nTo be clear I definitely see when this can be useful. For example the size of our own `contrib/linearize` tool could be cut in half by using this.\r\n",
      "created_at" : "2020-12-18T13:26:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748083364",
      "id" : 748083364,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODA4MzM2NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-18T13:26:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748083364",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20012 (rpc: Remove duplicate name and argNames from CRPCCommand by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-12-18T16:58:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748204434",
      "id" : 748204434,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODIwNDQzNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-18T16:58:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748204434",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Perhaps there are ways to mitigate this issue? I could see two situations in which block data move around:\r\n\r\n* arbitrarily during run time - this seems incredibly unlikely outside of reorgs (reindexing needs to be done in case of reorgs anyway)\r\n* on upgrade - upgrade may take longer time because of this; similar things already happened to indexes\r\n\r\nA simple way to deal with these is to have some kind of \"block layout version\" that can be obtained over RPC. If the layout is ever changed, the version is bumped and indexers will need to reindex. As described above, this is most likely in case of a long upgrade needs to be done anyway, so it wouldn't be too annoying.\r\n\r\nTo make it a bit more future-proof we could have two version numbers: one for the format of blocks already on disk, another for format in general. If bitcoind is updated, the existing blocks are not changed, but future blocks may have some differences then the former version number doesn't change the latter does - avoids reindex when not actually needed and also avoids indexers that don't support a new version blindly attempting to process a layout they don't understand.\r\n\r\nI believe it'd be best to introduce this versioning right from the start. (Just return constant zeroes for now.)\r\n\r\nIf it ever happens that a single block (or a few blocks) is moved around, then doing full reindexing would be inefficient but I assume it'd be sensible to not try to solve it right now. That means let's not do something excessive like adding a layout version to each block now.",
      "created_at" : "2020-12-18T19:08:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748267420",
      "id" : 748267420,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODI2NzQyMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-18T19:08:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748267420",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546035310"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546035310"
         }
      },
      "author_association" : "NONE",
      "body" : "@romanz do you have any plan for what to do with `electrs` if this is removed in the future?",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-18T19:09:56Z",
      "diff_hunk" : "@@ -2470,6 +2470,60 @@ static RPCHelpMan dumptxoutset()\n     };\n }\n \n+static RPCHelpMan getblocklocations()\n+{\n+    return RPCHelpMan{\"getblocklocations\",\n+                \"\\nEXPERIMENTAL warning: this call may be removed or changed in future releases.\\n\"\n+                \"\\nReturns a JSON for the location of 'blockhash' and its previous 'nblocks' block and undo data.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546035310",
      "id" : 546035310,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjAzNTMxMA==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 2477,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 555747009,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546035310",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546043984"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546043984"
         }
      },
      "author_association" : "NONE",
      "body" : "Perhaps it'd make more sense to test that the blocks stored on the returned offsets contain the same data as when using `getblock` call?",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-18T19:21:55Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2019-2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the getblocklocations rpc call.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+\n+class GetblocklocationsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        \"\"\"Test a trivial usage of the getblocklocations RPC command.\"\"\"\n+        node = self.nodes[0]\n+        mocktime = node.getblockheader(node.getblockhash(0))['time'] + 1\n+        node.setmocktime(mocktime)\n+        node.generate(7)\n+\n+        EXPECTED_LOCATIONS = [\n+            {'file': 0, 'data': 1861, 'undo': 254, 'prev': '1893864d81638cae904357907559248964050547ddcd0dbe3f72e65b5a31bf1f'},\n+            {'file': 0, 'data': 1601, 'undo': 213, 'prev': '1b086a63a5d5c320c747fee32cdb819c6f4f9eb78c24b7c5a33ae794218dc639'},\n+            {'file': 0, 'data': 1341, 'undo': 172, 'prev': '448640031d1418c70a109ea4f88f497804f3336c7309ff7e535894beb80b26e4'},\n+            {'file': 0, 'data': 1081, 'undo': 131, 'prev': '602403f82060e224423a9f22062fad3f5333beeee3c30313f6ea808e37b7e0b2'},\n+            {'file': 0, 'data': 821, 'undo': 90, 'prev': '334ab00aba5d213c8f67161ddff346c4643d0709c3bdafa4b4b05fe6f7e4ed48'},\n+            {'file': 0, 'data': 561, 'undo': 49, 'prev': '43f10598f19eced9c514f5ae40dbce0ab101362a22e18820901c6e03d7babe0b'},\n+            {'file': 0, 'data': 301, 'undo': 8, 'prev': '0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206'},\n+            {'file': 0, 'data': 8, 'prev': '0000000000000000000000000000000000000000000000000000000000000000'},  # genesis block\n+        ]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546043984",
      "id" : 546043984,
      "line" : 34,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA0Mzk4NA==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 34,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/rpc_getblocklocations.py",
      "position" : 34,
      "pull_request_review_id" : 555747009,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546043984",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546044099"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546044099"
         }
      },
      "author_association" : "NONE",
      "body" : "I'd like to see this description clarified. Something like: \"The number of blocks to process, including the block with given blockhash. The blocks following the given block will be returned if bigger than one.\"\r\n\r\nI'm not entirely satisfied with my wording either, so will be happy for clearer version. The idea is to communicate what exactly is in the result.",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-18T19:22:13Z",
      "diff_hunk" : "@@ -2470,6 +2470,60 @@ static RPCHelpMan dumptxoutset()\n     };\n }\n \n+static RPCHelpMan getblocklocations()\n+{\n+    return RPCHelpMan{\"getblocklocations\",\n+                \"\\nEXPERIMENTAL warning: this call may be removed or changed in future releases.\\n\"\n+                \"\\nReturns a JSON for the location of 'blockhash' and its previous 'nblocks' block and undo data.\\n\",\n+                {\n+                    {\"blockhash\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The block hash\"},\n+                    {\"nblocks\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of block locations to return\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546044099",
      "id" : 546044099,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA0NDA5OQ==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 2480,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 555747009,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546044099",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546046367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546046367"
         }
      },
      "author_association" : "NONE",
      "body" : "I suppose this is hit (also) when the block is pruned? Perhaps document it?",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-18T19:25:04Z",
      "diff_hunk" : "@@ -2470,6 +2470,60 @@ static RPCHelpMan dumptxoutset()\n     };\n }\n \n+static RPCHelpMan getblocklocations()\n+{\n+    return RPCHelpMan{\"getblocklocations\",\n+                \"\\nEXPERIMENTAL warning: this call may be removed or changed in future releases.\\n\"\n+                \"\\nReturns a JSON for the location of 'blockhash' and its previous 'nblocks' block and undo data.\\n\",\n+                {\n+                    {\"blockhash\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The block hash\"},\n+                    {\"nblocks\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of block locations to return\"},\n+                },\n+                {\n+                    RPCResult{\n+                        RPCResult::Type::ARR, \"\", \"\",\n+                        {\n+                            {RPCResult::Type::NUM, \"file\", \"blk*.dat/rev*.dat file index\"},\n+                            {RPCResult::Type::NUM, \"data\", \"block data file offset\"},\n+                            {RPCResult::Type::NUM, \"undo\", \"undo data file offset (if exists)\"},\n+                            {RPCResult::Type::STR_HEX, \"prev\", \"previous block hash\"},\n+                        }\n+                    },\n+                },\n+                RPCExamples{\n+                    HelpExampleCli(\"getblocklocation\", \"\\\"00000000c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09\\\" 10\")\n+                },\n+                [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue {\n+\n+    uint256 hash(ParseHashV(request.params[0], \"blockhash\"));\n+    size_t nblocks = request.params[1].get_int();\n+\n+    const CBlockIndex* pblockindex = WITH_LOCK(cs_main, return LookupBlockIndex(hash));\n+    if (!pblockindex) {\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block not found\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546046367",
      "id" : 546046367,
      "line" : 2504,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA0NjM2Nw==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 2504,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 35,
      "pull_request_review_id" : 555758011,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546046367",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Supporting efficient indexes outside of Bitcoin Core is a critical privacy improvement. The Bitcoin Core wallet must keep the wallet's public keys unencrypted in order to track them, meaning that a compromise of the node is a complete compromise of the wallet privacy. \r\n\r\nA full index of the kind that electrs provides allows such knowledge of the public keys to be restricted to the period that the wallet is being accessed, and then in memory only. This reduces the attack surface considerably and greatly improves potential privacy. This is not a slight on the Bitcoin Core wallet, but a consequence of the architecture, in which privacy competes with the need for nodes to ideally be always-on and always-connected.\r\n\r\nSupporting efficient creation of these indexes means that more users will be able to host them, improving Bitcoin's privacy in general. Currently, with this RPC my electrs testnet full index is 2.6G in size which is reasonable in comparison to the 32G of the testnet3 blockchain, and the initial indexing time has been greatly reduced as well. \r\n",
      "created_at" : "2020-12-19T07:12:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748432555",
      "id" : 748432555,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODQzMjU1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T07:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748432555",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/862166?v=4",
         "events_url" : "https://api.github.com/users/craigraw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/craigraw/followers",
         "following_url" : "https://api.github.com/users/craigraw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/craigraw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/craigraw",
         "id" : 862166,
         "login" : "craigraw",
         "node_id" : "MDQ6VXNlcjg2MjE2Ng==",
         "organizations_url" : "https://api.github.com/users/craigraw/orgs",
         "received_events_url" : "https://api.github.com/users/craigraw/received_events",
         "repos_url" : "https://api.github.com/users/craigraw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/craigraw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/craigraw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/craigraw"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm all-in for adding APIs for more efficient external indexing. I share @laanwj concern about the stableness of file pointers.\r\n\r\nHowever, I disagree with @craigraw:\r\n\r\n> Supporting efficient indexes outside of Bitcoin Core is a critical privacy improvement. The Bitcoin Core wallet must keep the wallet's public keys unencrypted in order to track them, meaning that a compromise of the node is a complete compromise of the wallet privacy.\r\n\r\nI don't actually follow the exact use case here. But it looks like you want to reduce the wallet-privacy-exposure time (the time publickeys/scripts are exposed to the memory). Which I think is a valid point. Though indexing \"all\" addresses for this seems an inefficient trade-off.\r\n\r\nOne seeking limited exposure time for their public-keys/scripts could and maybe should use blockfiters. It seems much better to scale and the filters are of value for the entire network.\r\n\r\n**Just scan the filters (timespan from `last-wallet-sync` to `now`) and scan the relevant blocks. Should be fairly quick for a couple of days or weeks (seconds).**\r\n\r\nIn general, I discourage building full indexes for personal wallet backends. It is not efficient IMO and leads to development focus on the wrong end.\r\n\r\nA full address index can be of value for pure exploring, inspecting, developing, etc.\r\n\r\n\r\nConcept ~0 on this.",
      "created_at" : "2020-12-19T09:29:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748448367",
      "id" : 748448367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODQ0ODM2Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T09:29:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748448367",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546220308"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546220308"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If Electrum protocol will allow using the actual `scriptPubKey` for querying the historical transactions, it would be possible to use `blockfilterindex`-based RPC, such as https://github.com/bitcoin/bitcoin/pull/20664 (as suggested [here](https://github.com/bitcoin/bitcoin/pull/14053#issuecomment-747661798)).\r\nMaybe it can be supported with [bwt](https://github.com/shesek/bwt) if the full node has blockfilters?\r\nCC: @SomberNight @shesek",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-19T10:11:58Z",
      "diff_hunk" : "@@ -2470,6 +2470,60 @@ static RPCHelpMan dumptxoutset()\n     };\n }\n \n+static RPCHelpMan getblocklocations()\n+{\n+    return RPCHelpMan{\"getblocklocations\",\n+                \"\\nEXPERIMENTAL warning: this call may be removed or changed in future releases.\\n\"\n+                \"\\nReturns a JSON for the location of 'blockhash' and its previous 'nblocks' block and undo data.\\n\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546220308",
      "id" : 546220308,
      "in_reply_to_id" : 546035310,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIyMDMwOA==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 2477,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 555931783,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546220308",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546220361"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546220361"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Sounds good, will do.",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-19T10:12:28Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2019-2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the getblocklocations rpc call.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+\n+class GetblocklocationsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        \"\"\"Test a trivial usage of the getblocklocations RPC command.\"\"\"\n+        node = self.nodes[0]\n+        mocktime = node.getblockheader(node.getblockhash(0))['time'] + 1\n+        node.setmocktime(mocktime)\n+        node.generate(7)\n+\n+        EXPECTED_LOCATIONS = [\n+            {'file': 0, 'data': 1861, 'undo': 254, 'prev': '1893864d81638cae904357907559248964050547ddcd0dbe3f72e65b5a31bf1f'},\n+            {'file': 0, 'data': 1601, 'undo': 213, 'prev': '1b086a63a5d5c320c747fee32cdb819c6f4f9eb78c24b7c5a33ae794218dc639'},\n+            {'file': 0, 'data': 1341, 'undo': 172, 'prev': '448640031d1418c70a109ea4f88f497804f3336c7309ff7e535894beb80b26e4'},\n+            {'file': 0, 'data': 1081, 'undo': 131, 'prev': '602403f82060e224423a9f22062fad3f5333beeee3c30313f6ea808e37b7e0b2'},\n+            {'file': 0, 'data': 821, 'undo': 90, 'prev': '334ab00aba5d213c8f67161ddff346c4643d0709c3bdafa4b4b05fe6f7e4ed48'},\n+            {'file': 0, 'data': 561, 'undo': 49, 'prev': '43f10598f19eced9c514f5ae40dbce0ab101362a22e18820901c6e03d7babe0b'},\n+            {'file': 0, 'data': 301, 'undo': 8, 'prev': '0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206'},\n+            {'file': 0, 'data': 8, 'prev': '0000000000000000000000000000000000000000000000000000000000000000'},  # genesis block\n+        ]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546220361",
      "id" : 546220361,
      "in_reply_to_id" : 546043984,
      "line" : 34,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIyMDM2MQ==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 34,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/rpc_getblocklocations.py",
      "position" : 34,
      "pull_request_review_id" : 555931808,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546220361",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@jonasschnelli block filters would be a great argument if some benchmarks were provided and wallets actually supported them. Currently, one of the most reasonable wallets - Electrum requires a specific protocol which is not block filters. The server could perhaps use block filters in the background, the question is is it still possible/reasonable? My understanding is that block filters still have O(block_count) complexity, which seems high for each request.",
      "created_at" : "2020-12-19T10:19:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748453572",
      "id" : 748453572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODQ1MzU3Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T10:19:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748453572",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546223638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546223638"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good point - added a check in https://github.com/bitcoin/bitcoin/pull/20702/commits/9d5c2bb85c2601ad54fa9df49b4f13e0490fb421#diff-decae4be02fb8a47ab4557fe74a9cb853bdfa3ec0fa1b515c0a1e5de91f4ad0bR2506.",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-19T10:48:18Z",
      "diff_hunk" : "@@ -2470,6 +2470,60 @@ static RPCHelpMan dumptxoutset()\n     };\n }\n \n+static RPCHelpMan getblocklocations()\n+{\n+    return RPCHelpMan{\"getblocklocations\",\n+                \"\\nEXPERIMENTAL warning: this call may be removed or changed in future releases.\\n\"\n+                \"\\nReturns a JSON for the location of 'blockhash' and its previous 'nblocks' block and undo data.\\n\",\n+                {\n+                    {\"blockhash\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The block hash\"},\n+                    {\"nblocks\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of block locations to return\"},\n+                },\n+                {\n+                    RPCResult{\n+                        RPCResult::Type::ARR, \"\", \"\",\n+                        {\n+                            {RPCResult::Type::NUM, \"file\", \"blk*.dat/rev*.dat file index\"},\n+                            {RPCResult::Type::NUM, \"data\", \"block data file offset\"},\n+                            {RPCResult::Type::NUM, \"undo\", \"undo data file offset (if exists)\"},\n+                            {RPCResult::Type::STR_HEX, \"prev\", \"previous block hash\"},\n+                        }\n+                    },\n+                },\n+                RPCExamples{\n+                    HelpExampleCli(\"getblocklocation\", \"\\\"00000000c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09\\\" 10\")\n+                },\n+                [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue {\n+\n+    uint256 hash(ParseHashV(request.params[0], \"blockhash\"));\n+    size_t nblocks = request.params[1].get_int();\n+\n+    const CBlockIndex* pblockindex = WITH_LOCK(cs_main, return LookupBlockIndex(hash));\n+    if (!pblockindex) {\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block not found\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546223638",
      "id" : 546223638,
      "in_reply_to_id" : 546046367,
      "line" : 2504,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIyMzYzOA==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 2504,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 35,
      "pull_request_review_id" : 555933504,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:48:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546223638",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546223714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546223714"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated the documentation:\r\n```\r\ngetblocklocations \"blockhash\" nblocks\r\n\r\nEXPERIMENTAL warning: this call may be removed or changed in future releases.\r\n\r\nReturns a JSON for the file system location of 'blockhash' block and undo data.\r\n\r\nIt is possible to return also the locations of previous blocks, by specifying 'nblocks' > 1.\r\n\r\nArguments:\r\n1. blockhash    (string, required) The block hash\r\n2. nblocks      (numeric, required) Maximum number locations to return (up to genesis block)\r\n\r\nResult:\r\n[           (json array)\r\n  n,        (numeric) blk*.dat/rev*.dat file index\r\n  n,        (numeric) block data file offset\r\n  n,        (numeric) undo data file offset (if exists)\r\n  \"hex\",    (string) previous block hash\r\n  ...\r\n]\r\n\r\nExamples:\r\n> bitcoin-cli getblocklocation \"00000000c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09\" 10\r\n```\r\nWDYT?",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-19T10:49:01Z",
      "diff_hunk" : "@@ -2470,6 +2470,60 @@ static RPCHelpMan dumptxoutset()\n     };\n }\n \n+static RPCHelpMan getblocklocations()\n+{\n+    return RPCHelpMan{\"getblocklocations\",\n+                \"\\nEXPERIMENTAL warning: this call may be removed or changed in future releases.\\n\"\n+                \"\\nReturns a JSON for the location of 'blockhash' and its previous 'nblocks' block and undo data.\\n\",\n+                {\n+                    {\"blockhash\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The block hash\"},\n+                    {\"nblocks\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of block locations to return\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546223714",
      "id" : 546223714,
      "in_reply_to_id" : 546044099,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIyMzcxNA==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 2480,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 555933548,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:49:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546223714",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546223805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546223805"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done at https://github.com/bitcoin/bitcoin/pull/20702/commits/9d5c2bb85c2601ad54fa9df49b4f13e0490fb421.",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-19T10:50:01Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2019-2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the getblocklocations rpc call.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+\n+class GetblocklocationsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        \"\"\"Test a trivial usage of the getblocklocations RPC command.\"\"\"\n+        node = self.nodes[0]\n+        mocktime = node.getblockheader(node.getblockhash(0))['time'] + 1\n+        node.setmocktime(mocktime)\n+        node.generate(7)\n+\n+        EXPECTED_LOCATIONS = [\n+            {'file': 0, 'data': 1861, 'undo': 254, 'prev': '1893864d81638cae904357907559248964050547ddcd0dbe3f72e65b5a31bf1f'},\n+            {'file': 0, 'data': 1601, 'undo': 213, 'prev': '1b086a63a5d5c320c747fee32cdb819c6f4f9eb78c24b7c5a33ae794218dc639'},\n+            {'file': 0, 'data': 1341, 'undo': 172, 'prev': '448640031d1418c70a109ea4f88f497804f3336c7309ff7e535894beb80b26e4'},\n+            {'file': 0, 'data': 1081, 'undo': 131, 'prev': '602403f82060e224423a9f22062fad3f5333beeee3c30313f6ea808e37b7e0b2'},\n+            {'file': 0, 'data': 821, 'undo': 90, 'prev': '334ab00aba5d213c8f67161ddff346c4643d0709c3bdafa4b4b05fe6f7e4ed48'},\n+            {'file': 0, 'data': 561, 'undo': 49, 'prev': '43f10598f19eced9c514f5ae40dbce0ab101362a22e18820901c6e03d7babe0b'},\n+            {'file': 0, 'data': 301, 'undo': 8, 'prev': '0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206'},\n+            {'file': 0, 'data': 8, 'prev': '0000000000000000000000000000000000000000000000000000000000000000'},  # genesis block\n+        ]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546223805",
      "id" : 546223805,
      "in_reply_to_id" : 546043984,
      "line" : 34,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjIyMzgwNQ==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 34,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/rpc_getblocklocations.py",
      "position" : 34,
      "pull_request_review_id" : 555933600,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T10:50:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546223805",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> arbitrarily during run time - this seems incredibly unlikely outside of reorgs (reindexing needs to be done in case of reorgs anyway)\r\n\r\nBlocks don't move around on disk ever. A re-org keeps the old blocks, it only changes connections in the block database.\r\n(It might make the same block height point to a different block, of course, but this is not a different issue from when the RPC is used to retrieve the block data)\r\nThe only conflict  that can really happen right now is that the block file is deleted by pruning. But this can be avoided by making the client manage pruning through `pruneblockchain`.\r\n",
      "created_at" : "2020-12-19T11:02:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748458329",
      "id" : 748458329,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODQ1ODMyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T11:02:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748458329",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546255335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546255335"
         }
      },
      "author_association" : "NONE",
      "body" : "Looks good. :+1: ",
      "commit_id" : "9d5c2bb85c2601ad54fa9df49b4f13e0490fb421",
      "created_at" : "2020-12-19T16:16:59Z",
      "diff_hunk" : "@@ -2470,6 +2470,60 @@ static RPCHelpMan dumptxoutset()\n     };\n }\n \n+static RPCHelpMan getblocklocations()\n+{\n+    return RPCHelpMan{\"getblocklocations\",\n+                \"\\nEXPERIMENTAL warning: this call may be removed or changed in future releases.\\n\"\n+                \"\\nReturns a JSON for the location of 'blockhash' and its previous 'nblocks' block and undo data.\\n\",\n+                {\n+                    {\"blockhash\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The block hash\"},\n+                    {\"nblocks\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"Number of block locations to return\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#discussion_r546255335",
      "id" : 546255335,
      "in_reply_to_id" : 546044099,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjI1NTMzNQ==",
      "original_commit_id" : "6e61171710ac34c06e213db33ff9d07b170f22c2",
      "original_line" : 2480,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 555952034,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20702",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-19T16:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546255335",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Yeah, I meant in the future. Still unlikely. :) Pruning already needs to be disabled for `electrs` to work at all (this is well-documented), so doing anything else would be usage error.",
      "created_at" : "2020-12-19T16:20:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748494194",
      "id" : 748494194,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODQ5NDE5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T16:20:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748494194",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have changed the RPC to fail \"early\" in pruned mode.\r\nAlso, improved the tests to cover various batch sizes and RPC failures.\r\n",
      "created_at" : "2020-12-20T12:23:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-748600938",
      "id" : 748600938,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODYwMDkzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-20T12:23:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748600938",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> My understanding is that block filters still have O(block_count) complexity, which seems high for each request.\r\n\r\nIIUC, the blockfilters today take ~5.8GB so it would probably take a while scanning them given a specific address.\r\nUsing a \"global address index\" (like the one [suggested here](https://github.com/romanz/electrs/issues/308)) allows efficient lookup for all transactions funding/spending specific script pubkey. For example, I have looked up [375Bia3NWiBqR89184zxRTDk1hWRpfKKK1](https://blockstream.info/address/375Bia3NWiBqR89184zxRTDk1hWRpfKKK1) - having a short history (one funding transaction and one spending transactions).\r\n\r\n- First lookup (with cold OS cache - after `echo 3 | sudo tee /proc/sys/vm/drop_caches`):\r\n```\r\n[2020-12-29T14:07:58.433Z DEBUG electrs_rpc] 0: recv {\"jsonrpc\": \"2.0\", \"method\": \"blockchain.scripthash.subscribe\", \"id\": 11, \"params\": [\"217af682a23ba6d8ae1f59b24493d6ea4adec0e110899f1d04c95bacd86d1cde\"]}\r\n[2020-12-29T14:07:58.579Z DEBUG electrs_index::index] 217af682a23ba6d8ae1f59b24493d6ea4adec0e110899f1d04c95bacd86d1cde has 2 rows\r\n[2020-12-29T14:07:58.783Z DEBUG electrs_rpc] 0: send {\"id\":11,\"jsonrpc\":\"2.0\",\"result\":\"3f56029cc7c23fc5d4e5f4d43632530e4f7daec287b34b13f84c4b7d93448ab5\"}\r\n```\r\n\r\n- Subsequent lookups (with warm OS cache - after restarting `electrs`):\r\n```\r\n[2020-12-29T14:10:27.009Z DEBUG electrs_rpc] 0: recv {\"jsonrpc\": \"2.0\", \"method\": \"blockchain.scripthash.subscribe\", \"id\": 11, \"params\": [\"217af682a23ba6d8ae1f59b24493d6ea4adec0e110899f1d04c95bacd86d1cde\"]}\r\n[2020-12-29T14:10:27.018Z DEBUG electrs_index::index] 217af682a23ba6d8ae1f59b24493d6ea4adec0e110899f1d04c95bacd86d1cde has 2 rows\r\n[2020-12-29T14:10:27.019Z DEBUG electrs_rpc] 0: send {\"id\":11,\"jsonrpc\":\"2.0\",\"result\":\"3f56029cc7c23fc5d4e5f4d43632530e4f7daec287b34b13f84c4b7d93448ab5\"}\r\n```\r\n\r\nThe first lookup goes to RocksDB-based index, taking ~150ms (cold cache) / ~9ms (warm cache).\r\nThe subsequent reads go to the actual `blk*.dat` files to read the transactions from the filesystem, taking ~200ms (cold) / ~1m (warm).\r\nNote: the index and `blk*.dat` files are stored on a HDD-based storage.",
      "created_at" : "2020-12-29T14:20:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-752093143",
      "id" : 752093143,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MjA5MzE0Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-29T14:20:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/752093143",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "BTW, it takes ~1m22s to find the relevant blocks for [375Bia3NWiBqR89184zxRTDk1hWRpfKKK1](https://blockstream.info/address/375Bia3NWiBqR89184zxRTDk1hWRpfKKK1), using #20664 `scanblockfilters` using the same machine from https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-752093143:\r\n\r\n```\r\n$ ~/Code/bitcoin-core/src/bitcoin-cli getblockchaininfo | jq .blocks\r\n664151\r\n\r\n$ time ~/Code/bitcoin-core/src/bitcoin-cli scanblockfilters '[\"addr(375Bia3NWiBqR89184zxRTDk1hWRpfKKK1)\"]' 600000\r\n[\r\n  \"00000000000000000007316856900e76b4f7a9139cfbfba89842c8d196cd5f91\",\r\n  \"0000000000000000000855f761d212c4fa432977a4000c31996dab4713a57016\"\r\n]\r\n\r\nreal\t1m22.170s\r\nuser\t0m0.004s\r\nsys\t0m0.000s\r\n```",
      "created_at" : "2021-01-02T14:29:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-753480327",
      "id" : 753480327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzQ4MDMyNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-02T14:32:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753480327",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">But on the other hand, the format of the block files specifically hasn't ever significantly changed, and is (I think) unlikely to change.\r\n\r\nUndo files, on the other hand, I could see changing significantly, and are implementation-specific.\r\n\r\n> Pruning already needs to be disabled for electrs to work at all\r\n\r\nIt doesn't make sense to only add this for electrs. Please enable this for pruning...\r\n\r\nAs long as we don't reuse old block file numbers, it should be fine. (The application calling might need to handle the error, but it would need to handle a RPC exception too)",
      "created_at" : "2021-01-03T00:39:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-753549462",
      "id" : 753549462,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzU0OTQ2Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-03T00:39:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753549462",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@luke-jr I meant `electrs` will not work with pruning but yes, https://github.com/bitcoin/bitcoin/pull/20702/files#diff-decae4be02fb8a47ab4557fe74a9cb853bdfa3ec0fa1b515c0a1e5de91f4ad0bR2499 could be more fine-grained.",
      "created_at" : "2021-01-03T21:17:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-753677557",
      "id" : 753677557,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzY3NzU1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-03T21:17:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753677557",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think it would be best to simply remove the check entirely. Expect clients to deal with the possibility that on a pruned node the returned file could be missing.",
      "created_at" : "2021-01-03T21:21:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-753678032",
      "id" : 753678032,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzY3ODAzMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-03T21:21:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753678032",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@luke-jr yeah, I was originally thinking of distinguishing it from other errors when sending response to the client for debugging purposes. Should make error messages and troubleshooting much easier.",
      "created_at" : "2021-01-03T21:31:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-753678998",
      "id" : 753678998,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzY3ODk5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-03T21:31:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753678998",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It creates a race condition. Now there are two ways a pruned block might fail: an exception, or a missing file. Better to just have the missing file be consistently the only failure mode.\r\n\r\nAlso, an exception means you have to retry to get the locations of the other blocks. Instead, returning the deleted files means you can get all of the results and deal with the missing ones later without any further requests.",
      "created_at" : "2021-01-03T21:35:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-753679493",
      "id" : 753679493,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzY3OTQ5Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-03T21:35:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753679493",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Do I understand correctly that without explicit check, bitcoind just returns the location even if the file is actually deleted and the client then finds out that the file is deleted only by attempting to access it?",
      "created_at" : "2021-01-03T21:48:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-753680910",
      "id" : 753680910,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MzY4MDkxMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-03T21:48:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/753680910",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> But on the other hand, the format of the block files specifically hasn't ever significantly changed,\r\n\r\nThe format of the _files_ has when blocks could be added out of order, and it broke armory which expected to read them.  It was also discussed changing it to obfscuate the blocks to prevent anti-virus false positives but it turned out that AV systems simply ignore files over some threshold size and blocks are big enough.\r\n\r\n> and is (I think) unlikely to change.\r\n\r\nMaybe it's unlikely to change, but it isn't the case that there aren't reasons to change it.\r\n\r\nIn the blockstream bitcoinsatellite repository there is an alternative serializer for transactions that reduces the transaction sizes by ~25% ( https://github.com/Blockstream/bitcoinsatellite/blob/master/src/compressor.cpp ).  It could be deployed for local blockfiles at the cost of adding a to the places where the block is serialized/deserialized on disk and would reduce node storage for the blockchain currently by about 74GB in exchange for making operations which read blocks more cpu intense.  I'd personally have one more unpruned full node running at least for another year, with such a change. \r\n\r\n(I cite that code because its existing and not hypothetical-- it isn't even the limit of what could be done, but just a concrete example that requires very little change to the surrounding codebase, and could also be extended to reduce P2P bandwidth by a similar amount  (at least after erlay gets rid of most of the rumouring overhead)).\r\n\r\nIf you have to make a round trip request to the RPC to get the location is actually fetching the block itself over the RPC that much worse?  I would assume most of the cost is in the request roundtrip and for similar cost you could request the block and index it and maintain an index from address (or whatever) to block number/hash.\r\n\r\n",
      "created_at" : "2021-01-05T04:20:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-754383721",
      "id" : 754383721,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDM4MzcyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T04:20:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754383721",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@gmaxwell \r\n\r\nIsn't versioning sufficient to help with the API changing? Bitcoind changed its API in breaking way many times and it seems nobody cared. There's no need to *guarantee* it will not change, just bump a version number if it does.\r\n\r\n> If you have to make a round trip request to the RPC to get the location is actually fetching the block itself over the RPC that much worse?\r\n\r\nMy understanding is that script hash -> block location mappings are stored in `electrs` db, so it optimizes the *subsequent* queries of transactions - no RPC roundtrip, just read it from disk.",
      "created_at" : "2021-01-05T11:12:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-754571722",
      "id" : 754571722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDU3MTcyMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T11:12:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754571722",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@Kixunil   Lets imagine that we knew the next major version would add block compression (it certainly could, it's been written after all).  If that happened then every user of this interface would be broken by the change, and couldn't move forward without either radically changing what it was doing or adopting complex core specific code to decode the blocks.  So then compatibility becomes an impediment to implementing compression and improving it in subsequent versions.\r\n\r\nIf it were decided that it was okay to adopt this interface with no promise of compatibility in the future-- with an answer of \"tough luck\" should other improvements make it incompatible,  then what is the need to upstream a patch to add this interface?   Anyone who wanted it could apply it locally.  It would be an unsupported interface, but I think that is exactly what any interface where there isn't an intention to preserve it is just that-- an unsupported interface.\r\n\r\n >  Bitcoind changed its API in breaking way many times and it seems nobody cared.\r\n\r\nMany people have cared very much, and created ecosystem problems by delaying/avoiding upgrading because of a compatibility breaking change.  And this is with an API that mostly only exposed things whos functionality could be preserved if only with some minor renaming.\r\n\r\nThere is a big difference between a break where you have to change from reading in one place to reading in two others -- just a few minutes work and a minor change to the caller -- compared to a change where the equivalent functionality is just completely gone without any ready alternative.  I could cite an example where bitcoind interface changed in a way where the functionality was just gone with no ready drop in alternative, but that has been extremely rare (and the only example I can think of off the top of my head is where the removed functionality was basically broken).\r\n",
      "created_at" : "2021-01-05T15:16:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-754699293",
      "id" : 754699293,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDY5OTI5Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T15:16:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754699293",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Speaking as an external wallet developer, I hope to provide some context that may be useful. One of the original goals of my project was to provide an application that took full advantage of a local copy of the blockchain, providing enough functionality to convince people to run their own node, and thus increasing the number of nodes and improving the bitcoin network generally. To name some of these features: Quick loading of any wallet, blockchain exploration, transaction history analysis, and the privacy aspect I mentioned above. As we see from the timing results, some of these are not practical without access to the full ledger, with the addition of an address-based index.\r\n\r\nThe reality is however that it is quite resource intensive to maintain such an index - for example runnning ElectrumX requires an SSD and long initial processing, resulting in a 60GB mainnet index replicating much blockchain data, and requiring further processing to maintain. Few users have the capacity for such an undertaking. On the other hand, this proposal reduces required disk space, but more importantly indexing time, making it much more accessible particularly to pre-built node offerings.\r\n\r\nTherefore, the tradeoff to maintaining conservative and restricted access to confirmed blocks may be fewer full nodes, as projects which attempt to fully leverage a local ledger fail to get critical mass due to the high initial bar to gain relevant access to it.\r\n\r\n> couldn't move forward without ... adopting complex core specific code to decode the blocks\r\n\r\nIMO, there would certainly be considerable motivation to port such code - the value of direct access to the ledger is substantial.",
      "created_at" : "2021-01-06T08:22:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-755156736",
      "id" : 755156736,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTE1NjczNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T08:22:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755156736",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/862166?v=4",
         "events_url" : "https://api.github.com/users/craigraw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/craigraw/followers",
         "following_url" : "https://api.github.com/users/craigraw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/craigraw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/craigraw",
         "id" : 862166,
         "login" : "craigraw",
         "node_id" : "MDQ6VXNlcjg2MjE2Ng==",
         "organizations_url" : "https://api.github.com/users/craigraw/orgs",
         "received_events_url" : "https://api.github.com/users/craigraw/received_events",
         "repos_url" : "https://api.github.com/users/craigraw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/craigraw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/craigraw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/craigraw"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@craigraw That's an interesting perspective I hadn't considered: that having access to an indexed blockchain means address/key/script information can be offline more of the time.\n\nI'm not sure there is much that can be done about that. I consider anything that needs fast access to the full blockchain (even absent any indexing) as inherently too resource intensive and unscalable already. It's not realistic to assume end users will want to dedicate the resources to operate that, and thus any infrastructure relying on that will inevitably end up with trusted third parties. Whether a copy of the chain is involved in doing so seems like a small (literally, 2) constant factor that at best kicks the can down the road for a few years. It doesn't even need to be a factor two; you can run Bitcoin Core in pruning mode, and an indexing service (which copies the full blocks into its database, in whatever form is most convenient to them) that does not prune on top.\n\nIMHO the most scalable approach is simply having local wallets (online, but possibly offline most of the time) that scan each block once (in full, or using filters) and remember transactions that matter to them. That doesn't need fast access (just streaming), and doesn't need indexing.\n\nThere are of course use cases for full indexing; debugging, certain large services, ... and we should enable them the best we can. But it feels hacky, and hard to maintain a stable interface, to try to do that using Bitcoin Core's own storage, which was never designed for this purpose, and will going forward have different priorities.",
      "created_at" : "2021-01-06T08:58:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-755173363",
      "id" : 755173363,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTE3MzM2Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T08:58:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755173363",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Many thanks for the comments and the feedback!\r\n\r\n> But it feels hacky, and hard to maintain a stable interface, to try to do that using Bitcoin Core's own storage, which was never designed for this purpose, and will going forward have different priorities.\r\n\r\nI agree that the current implementation is indeed \"hacky\" - will try to come up with a better approach.\r\n",
      "created_at" : "2021-01-07T07:48:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-755947769",
      "id" : 755947769,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTk0Nzc2OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-07T07:49:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755947769",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/9900?v=4",
         "events_url" : "https://api.github.com/users/romanz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/romanz/followers",
         "following_url" : "https://api.github.com/users/romanz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/romanz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/romanz",
         "id" : 9900,
         "login" : "romanz",
         "node_id" : "MDQ6VXNlcjk5MDA=",
         "organizations_url" : "https://api.github.com/users/romanz/orgs",
         "received_events_url" : "https://api.github.com/users/romanz/received_events",
         "repos_url" : "https://api.github.com/users/romanz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/romanz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/romanz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/romanz"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> It's not realistic to assume end users will want to dedicate the resources to operate that\r\n\r\nI'm not sure. People have the option to pirate digital content for free, yet many choose to spend money instead. The best theory explaining it so far is convenience. If this applies more widely, if having chain indexed has significantly better UX, then I expect at least some people paying for it.\r\n\r\n> IMHO the most scalable approach is simply having local wallets (online, but possibly offline most of the time) that scan each block once (in full, or using filters) and remember transactions that matter to them. That doesn't need fast access (just streaming), and doesn't need indexing.\r\n\r\nFrankly, EPS tried this and it led to UX so horrible that I'm highly surprised anyone is using it at all. Perhaps there's a different way to do it that would be saner but I'm not convinced there's an obvious solution.\r\n\r\n Anyway, since @romanz agreed to look into other solutions, I'm not going to push this further. Just wanted to give an insight from my experience.\r\n",
      "created_at" : "2021-01-07T15:41:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20702#issuecomment-756194295",
      "id" : 756194295,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20702",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NjE5NDI5NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-07T15:41:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/756194295",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1178779?v=4",
         "events_url" : "https://api.github.com/users/Kixunil/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kixunil/followers",
         "following_url" : "https://api.github.com/users/Kixunil/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kixunil/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kixunil",
         "id" : 1178779,
         "login" : "Kixunil",
         "node_id" : "MDQ6VXNlcjExNzg3Nzk=",
         "organizations_url" : "https://api.github.com/users/Kixunil/orgs",
         "received_events_url" : "https://api.github.com/users/Kixunil/received_events",
         "repos_url" : "https://api.github.com/users/Kixunil/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kixunil/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kixunil"
      }
   }
]
