[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r337701626"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337701626"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@instagibbs wrote:\r\n> At the risk of making the error message less precise, I think this whole block is easier to read if it just relies on `GetReservedDestination` to check if `CanGetAddress` is true or not. You also can just not store `ret` and use it directly in the conditional.",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-10-22T19:14:47Z",
      "diff_hunk" : "@@ -2980,21 +2981,23 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r337701626",
      "id" : 337701626,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNzcwMTYyNg==",
      "original_commit_id" : "b2da2d9e56307f6a32ba6a39c293358580a2a91f",
      "original_position" : 13,
      "path" : "src/wallet/wallet.cpp",
      "position" : 9,
      "pull_request_review_id" : 305445885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337701626",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "appreciated, will review",
      "created_at" : "2019-10-22T19:16:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545112411",
      "id" : 545112411,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NTExMjQxMQ==",
      "updated_at" : "2019-10-22T19:16:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545112411",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2019-10-22T22:14:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545179108",
      "id" : 545179108,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NTE3OTEwOA==",
      "updated_at" : "2020-04-04T03:16:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545179108",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Looks like you could avoid `failed_to_get_change_address` by applying\r\n```diff\r\n--- a/src/wallet/wallet.cpp\r\n+++ b/src/wallet/wallet.cpp\r\n@@ -2968,7 +2968,7 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\r\n             // TODO: pass in scriptChange instead of reservedest so\r\n             // change transaction isn't always pay-to-bitcoin-address\r\n             CScript scriptChange;\r\n-            bool failed_to_get_change_address{false};\r\n+            assert(scriptChange.empty());\r\n\r\n             // coin control: send change to custom address\r\n             if (!boost::get<CNoDestination>(&coin_control.destChange)) {\r\n@@ -2984,7 +2984,6 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\r\n                 // Reserve a new key pair from key pool. If it fails, provide a dummy\r\n                 // destination in case we don't need change.\r\n                 if (!CanGetAddresses(true)) {\r\n-                    failed_to_get_change_address = true;\r\n                     strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\r\n                 } else {\r\n                     CTxDestination dest;\r\n@@ -2993,7 +2992,6 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\r\n                     if (ret) {\r\n                         scriptChange = GetScriptForDestination(dest);\r\n                     } else {\r\n-                        failed_to_get_change_address = true;\r\n                         strFailReason = _(\"Keypool ran out, please call keypoolrefill first\").translated;\r\n                     }\r\n\r\n@@ -3210,10 +3208,9 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\r\n             }\r\n\r\n             // Give up if change keypool ran out and we failed to find a solution without change:\r\n-            if (failed_to_get_change_address && nChangePosInOut != -1) {\r\n+            if (scriptChange.empty() && nChangePosInOut != -1) {\r\n                 return false;\r\n             }\r\n-\r\n         }\r\n\r\n         // Shuffle selected coins and fill in final vin\r\n```",
      "created_at" : "2019-10-23T10:18:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545374547",
      "id" : 545374547,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NTM3NDU0Nw==",
      "updated_at" : "2019-10-23T10:19:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545374547",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-10-23T10:22:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545375875",
      "id" : 545375875,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NTM3NTg3NQ==",
      "updated_at" : "2019-10-23T10:22:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545375875",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated with @promag's suggestion to avoid `failed_to_get_change_address` and @instagibbs suggestion to simplify the change address check.",
      "created_at" : "2019-10-23T13:21:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545440441",
      "id" : 545440441,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NTQ0MDQ0MQ==",
      "updated_at" : "2019-10-23T13:21:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545440441",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338072692"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338072692"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, remove ð.",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-10-23T14:11:47Z",
      "diff_hunk" : "@@ -3200,6 +3201,12 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 coin_selection_params.use_bnb = false;\n                 continue;\n             }\n+\n+            // Give up if change keypool ran out and we failed to find a solution without change:\n+            if (scriptChange.empty() && nChangePosInOut != -1) {\n+                return false;\n+            }\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338072692",
      "id" : 338072692,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODA3MjY5Mg==",
      "original_commit_id" : "3deb73c853ac80cb9028746c5439af68b310678e",
      "original_position" : 34,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 305922931,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338072692",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338313880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338313880"
         }
      },
      "author_association" : "MEMBER",
      "body" : "To avoid overestimating on fees, maybe move `change_prototype_txout` and `change_output_size` setting into here?. Then set `change_output_size` to 0 below in the else block.",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-10-23T22:48:48Z",
      "diff_hunk" : "@@ -2980,14 +2981,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n                 if (reservedest.GetReservedDestination(change_type, dest, true)) {\n                     scriptChange = GetScriptForDestination(dest);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338313880",
      "id" : 338313880,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODMxMzg4MA==",
      "original_commit_id" : "db2e40036f5467f266d1e3972b2d0e46988c1ee7",
      "original_position" : 18,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 306235397,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338313880",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338623327"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338623327"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done, but I wasn't able to write a test that shows a difference. ",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-10-24T14:56:27Z",
      "diff_hunk" : "@@ -2980,14 +2981,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n                 if (reservedest.GetReservedDestination(change_type, dest, true)) {\n                     scriptChange = GetScriptForDestination(dest);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338623327",
      "id" : 338623327,
      "in_reply_to_id" : 338313880,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODYyMzMyNw==",
      "original_commit_id" : "db2e40036f5467f266d1e3972b2d0e46988c1ee7",
      "original_position" : 18,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 306641955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338623327",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@achow101 suggested in https://github.com/bitcoin/bitcoin/pull/16944#discussion_r338308868 to avoid knapsack when there's no change. I added a commit that achieves that, but it's non-trivial.\r\n\r\nIt does this by enabling BnB when subtracting fees from outputs. Gotchas:\r\n1. when coins are pre-selected, it still uses knapsack\r\n2. it still excludes dust inputs based on their value minus the fees needed to spend them, but it does not use their effective value in BnB. I don't think this matters in practice, because `subtractFeesFromOutputs` is generally used to spend either _all_ coins or a selected bunch. But there is an edge case where e.g. it can choose between two 0.01 BTC inputs, one SegWit and one legacy, and it won't care.\r\n\r\nI tested #16944 on top of this, in particular: GUI coin selection still works with a watch-only wallet without keypool.",
      "created_at" : "2019-10-24T15:04:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545961422",
      "id" : 545961422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NTk2MTQyMg==",
      "updated_at" : "2019-10-24T19:03:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545961422",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> @achow101 suggested in [#16944 (comment)](https://github.com/bitcoin/bitcoin/pull/16944#discussion_r338308868) to avoid knapsack when there's no change. I added a commit that achieves that, but it's non-trivial.\r\n\r\nIn the interest of reducing complexity, I think that change should be done as a separate PR. I do plan on working on the coin selection logic again soon and clean this up as well.",
      "created_at" : "2019-10-24T20:23:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-546087219",
      "id" : 546087219,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjA4NzIxOQ==",
      "updated_at" : "2019-10-24T20:23:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546087219",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@achow101 done, I moved that commit into #17246",
      "created_at" : "2019-10-25T08:32:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-546258522",
      "id" : 546258522,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjI1ODUyMg==",
      "updated_at" : "2019-10-25T08:32:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546258522",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-10-29T13:20:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-547415396",
      "id" : 547415396,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzQxNTM5Ng==",
      "updated_at" : "2019-10-29T13:20:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547415396",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r340615439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340615439"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`GetScriptForDestination(dest)` is called twice here if we can reserve a dest. I would optimize this slightly: \r\n\r\n```suggestion\r\n                if (!reservedest.GetReservedDestination(change_type, dest, true)) {\r\n                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;\r\n                }\r\n                scriptChange = GetScriptForDestination(dest);\r\n```\r\n\r\nThe suggestion should replace L2537 - 2542. Seems I can not edit that part of my suggestion.",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-10-30T13:35:48Z",
      "diff_hunk" : "@@ -2529,20 +2530,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n-                bool ret = reservedest.GetReservedDestination(change_type, dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = \"Keypool ran out, please call keypoolrefill first\";\n-                    return false;\n+                if (reservedest.GetReservedDestination(change_type, dest, true)) {\n+                    scriptChange = GetScriptForDestination(dest);\n+                } else {\n+                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;\n                 }\n-\n                 scriptChange = GetScriptForDestination(dest);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r340615439",
      "id" : 340615439,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDYxNTQzOQ==",
      "original_commit_id" : "388b153f9ea7ae9cc47e928e08d4f244ee624571",
      "original_position" : 32,
      "path" : "src/wallet/wallet.cpp",
      "position" : 21,
      "pull_request_review_id" : 309202786,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340615439",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r340618350"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340618350"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this error message is ambiguous: It could mean we can't generate a transaction with change without a change address because we can't get the dest. But it could also mean we can not generate a transaction that does not need a change at all. I could see my self thinking here: \"What do you mean? I have change in this tx!\".",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-10-30T13:40:32Z",
      "diff_hunk" : "@@ -2529,20 +2530,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n-                bool ret = reservedest.GetReservedDestination(change_type, dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = \"Keypool ran out, please call keypoolrefill first\";\n-                    return false;\n+                if (reservedest.GetReservedDestination(change_type, dest, true)) {\n+                    scriptChange = GetScriptForDestination(dest);\n+                } else {\n+                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r340618350",
      "id" : 340618350,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDYxODM1MA==",
      "original_commit_id" : "388b153f9ea7ae9cc47e928e08d4f244ee624571",
      "original_position" : 29,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 309202786,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340618350",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342142258"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342142258"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This seems unnecessary? How could it ever NOT be empty here?",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-11-04T16:26:40Z",
      "diff_hunk" : "@@ -2517,6 +2517,7 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n             // TODO: pass in scriptChange instead of reservedest so\n             // change transaction isn't always pay-to-bitcoin-address\n             CScript scriptChange;\n+            assert(scriptChange.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342142258",
      "id" : 342142258,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjE0MjI1OA==",
      "original_commit_id" : "388b153f9ea7ae9cc47e928e08d4f244ee624571",
      "original_position" : 4,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 311192093,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342142258",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157746"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157746"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed. I added a potentially more useful assert below `scriptChange = GetScriptForDestination(dest);`",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-11-04T16:55:26Z",
      "diff_hunk" : "@@ -2517,6 +2517,7 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n             // TODO: pass in scriptChange instead of reservedest so\n             // change transaction isn't always pay-to-bitcoin-address\n             CScript scriptChange;\n+            assert(scriptChange.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157746",
      "id" : 342157746,
      "in_reply_to_id" : 342142258,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjE1Nzc0Ng==",
      "original_commit_id" : "388b153f9ea7ae9cc47e928e08d4f244ee624571",
      "original_position" : 4,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 311212631,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157746",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157753"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157753"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Changed to: `Transaction needs a change address, but we can't generate it. Please call keypoolrefill first.`",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-11-04T16:55:27Z",
      "diff_hunk" : "@@ -2529,20 +2530,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n-                bool ret = reservedest.GetReservedDestination(change_type, dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = \"Keypool ran out, please call keypoolrefill first\";\n-                    return false;\n+                if (reservedest.GetReservedDestination(change_type, dest, true)) {\n+                    scriptChange = GetScriptForDestination(dest);\n+                } else {\n+                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157753",
      "id" : 342157753,
      "in_reply_to_id" : 340618350,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjE1Nzc1Mw==",
      "original_commit_id" : "388b153f9ea7ae9cc47e928e08d4f244ee624571",
      "original_position" : 29,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 311212644,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157753",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157780"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157780"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2019-11-04T16:55:30Z",
      "diff_hunk" : "@@ -2529,20 +2530,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n-                bool ret = reservedest.GetReservedDestination(change_type, dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = \"Keypool ran out, please call keypoolrefill first\";\n-                    return false;\n+                if (reservedest.GetReservedDestination(change_type, dest, true)) {\n+                    scriptChange = GetScriptForDestination(dest);\n+                } else {\n+                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;\n                 }\n-\n                 scriptChange = GetScriptForDestination(dest);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157780",
      "id" : 342157780,
      "in_reply_to_id" : 340615439,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjE1Nzc4MA==",
      "original_commit_id" : "388b153f9ea7ae9cc47e928e08d4f244ee624571",
      "original_position" : 32,
      "path" : "src/wallet/wallet.cpp",
      "position" : 21,
      "pull_request_review_id" : 311212679,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157780",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-11-22T22:10:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-557713342",
      "id" : 557713342,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzcxMzM0Mg==",
      "updated_at" : "2019-11-22T22:10:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557713342",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@instagibbs @achow101 @fjahr @luke-jr this should be ready for another review. @gwillen you may also find it useful.",
      "created_at" : "2020-01-30T14:23:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-580276061",
      "id" : 580276061,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDI3NjA2MQ==",
      "updated_at" : "2020-01-30T14:23:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580276061",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r373864657"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373864657"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think L2634-2635 can be removed again. They are already declared in L2578-2579.",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2020-02-02T18:15:08Z",
      "diff_hunk" : "@@ -2630,18 +2630,13 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  post-backup change.\n \n                 // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n                 CTxDestination dest;\n-                bool ret = reservedest.GetReservedDestination(dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = _(\"Keypool ran out, please call keypoolrefill first\").translated;\n+                const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n+                ReserveDestination reservedest(this, change_type);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r373864657",
      "id" : 373864657,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NDY1Nw==",
      "original_commit_id" : "c7d433f572088c859b58624e78b79de4aa234bc2",
      "original_position" : 14,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 351957951,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:20:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373864657",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r374588579"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374588579"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Odd, removed again.",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2020-02-04T10:27:07Z",
      "diff_hunk" : "@@ -2630,18 +2630,13 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  post-backup change.\n \n                 // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n                 CTxDestination dest;\n-                bool ret = reservedest.GetReservedDestination(dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = _(\"Keypool ran out, please call keypoolrefill first\").translated;\n+                const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n+                ReserveDestination reservedest(this, change_type);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r374588579",
      "id" : 374588579,
      "in_reply_to_id" : 373864657,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDU4ODU3OQ==",
      "original_commit_id" : "c7d433f572088c859b58624e78b79de4aa234bc2",
      "original_position" : 14,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 352867749,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "updated_at" : "2020-02-04T10:27:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374588579",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Code review ACK 92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2020-02-05T10:49:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-582350028",
      "id" : 582350028,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MjM1MDAyOA==",
      "updated_at" : "2020-02-05T10:49:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582350028",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks @Sjors. Clever way.\r\nutACK 92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2020-04-16T06:19:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-614438822",
      "id" : 614438822,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNDQzODgyMg==",
      "updated_at" : "2020-04-16T06:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614438822",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This should have its release notes part (added label).",
      "created_at" : "2020-04-16T06:21:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-614439195",
      "id" : 614439195,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNDQzOTE5NQ==",
      "updated_at" : "2020-04-16T06:21:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614439195",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r409683229"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409683229"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's not clear to me what this assert is checking for.\r\n\r\nIf `dest` is not empty, we got a change destination and so `scriptChange` is not empty. If dest is empty, then `scriptChange` will be empty. So this just covers all cases and can't fail?",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2020-04-16T16:18:17Z",
      "diff_hunk" : "@@ -2629,13 +2629,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 if (!reservedest.GetReservedDestination(dest, true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. Please call keypoolrefill first.\").translated;\n-                    return false;\n+                    strFailReason = _(\"Transaction needs a change address, but we can't generate it. Please call keypoolrefill first.\").translated;\n                 }\n                 scriptChange = GetScriptForDestination(dest);\n+                assert(!dest.empty() || scriptChange.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r409683229",
      "id" : 409683229,
      "line" : 2639,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY4MzIyOQ==",
      "original_commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "original_line" : 2639,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 22,
      "pull_request_review_id" : 394794219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-16T16:18:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409683229",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r410073296"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410073296"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I can't remember why I wrote this, but I think the idea was to ensure `GetScriptForDestination()` returns an empty script for an empty destination. Perhaps that's overkill; I can drop it if there's any other changes needed in this PR.",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2020-04-17T08:31:12Z",
      "diff_hunk" : "@@ -2629,13 +2629,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 if (!reservedest.GetReservedDestination(dest, true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. Please call keypoolrefill first.\").translated;\n-                    return false;\n+                    strFailReason = _(\"Transaction needs a change address, but we can't generate it. Please call keypoolrefill first.\").translated;\n                 }\n                 scriptChange = GetScriptForDestination(dest);\n+                assert(!dest.empty() || scriptChange.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r410073296",
      "id" : 410073296,
      "in_reply_to_id" : 409683229,
      "line" : 2639,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3MzI5Ng==",
      "original_commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "original_line" : 2639,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 22,
      "pull_request_review_id" : 395261757,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-17T08:31:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410073296",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r410338333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410338333"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I guess it's fine, but it just seems like useless code that might be confusing to future readers. I would suggest that it be removed in a followup that touches this code.",
      "commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2020-04-17T16:34:41Z",
      "diff_hunk" : "@@ -2629,13 +2629,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 if (!reservedest.GetReservedDestination(dest, true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. Please call keypoolrefill first.\").translated;\n-                    return false;\n+                    strFailReason = _(\"Transaction needs a change address, but we can't generate it. Please call keypoolrefill first.\").translated;\n                 }\n                 scriptChange = GetScriptForDestination(dest);\n+                assert(!dest.empty() || scriptChange.empty());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r410338333",
      "id" : 410338333,
      "in_reply_to_id" : 409683229,
      "line" : 2639,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDMzODMzMw==",
      "original_commit_id" : "92bcd70808b9cac56b184903aa6d37baf9641b37",
      "original_line" : 2639,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 22,
      "pull_request_review_id" : 395605032,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-17T16:34:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410338333",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 92bcd70808b9cac56b184903aa6d37baf9641b37",
      "created_at" : "2020-04-17T16:34:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-615345149",
      "id" : 615345149,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNTM0NTE0OQ==",
      "updated_at" : "2020-04-17T16:34:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/615345149",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@achow101 can you add any relevant release notes to https://github.com/bitcoin-core/bitcoin-devwiki/wiki/0.20.0-Release-Notes-Draft ?",
      "created_at" : "2020-05-23T07:30:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-633001089",
      "id" : 633001089,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMzAwMTA4OQ==",
      "updated_at" : "2020-05-23T07:30:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633001089",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@fanquake note that this isn't in 0.20",
      "created_at" : "2020-05-27T09:28:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-634542910",
      "id" : 634542910,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDU0MjkxMA==",
      "updated_at" : "2020-05-27T09:28:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634542910",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
