[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339254720"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339254720"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Refactor: Split up CWallet and LegacyScriptPubKeyMan and classes\" (194227b1173b0dd9a51d24e245ddaa601d36a109)\r\n\r\nWould be better not to reference `m_wallet` here. `m_wallet` is a temporary alias so any references added now will have to be removed later, causing unnecessary churn. Would suggest reverting the commit back to your previous af8780a65a530c48a0abc7f3ef6915f33d30943f push, and just adding the linter fixes in 626eed831918ac4f492b94ad0131f65d67fd1785 ",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-25T22:04:40Z",
      "diff_hunk" : "@@ -421,47 +418,47 @@ bool CWallet::AddKeyPubKeyWithDB(WalletBatch& batch, const CKey& secret, const C\n                                                  secret.GetPrivKey(),\n                                                  mapKeyMetadata[pubkey.GetID()]);\n     }\n-    UnsetWalletFlagWithDB(batch, WALLET_FLAG_BLANK_WALLET);\n+    m_storage.UnsetWalletFlagWithDB(batch, WALLET_FLAG_BLANK_WALLET);\n     return true;\n }\n \n-bool CWallet::LoadCScript(const CScript& redeemScript)\n+bool LegacyScriptPubKeyMan::LoadCScript(const CScript& redeemScript)\n {\n     /* A sanity check was added in pull #3843 to avoid adding redeemScripts\n      * that never can be redeemed. However, old wallets may still contain\n      * these. Do not add them to the wallet and warn. */\n     if (redeemScript.size() > MAX_SCRIPT_ELEMENT_SIZE)\n     {\n         std::string strAddr = EncodeDestination(ScriptHash(redeemScript));\n-        WalletLogPrintf(\"%s: Warning: This wallet contains a redeemScript of size %i which exceeds maximum size %i thus can never be redeemed. Do not use address %s.\\n\", __func__, redeemScript.size(), MAX_SCRIPT_ELEMENT_SIZE, strAddr);\n+        m_wallet.WalletLogPrintf(\"%s: Warning: This wallet contains a redeemScript of size %i which exceeds maximum size %i thus can never be redeemed. Do not use address %s.\\n\", __func__, redeemScript.size(), MAX_SCRIPT_ELEMENT_SIZE, strAddr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339254720",
      "id" : 339254720,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTI1NDcyMA==",
      "original_commit_id" : "194227b1173b0dd9a51d24e245ddaa601d36a109",
      "original_position" : 184,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : null,
      "pull_request_review_id" : 307472747,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T16:25:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339254720",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339255102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339255102"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Refactor: Split up CWallet and LegacyScriptPubKeyMan and classes\" (194227b1173b0dd9a51d24e245ddaa601d36a109)\r\n\r\nExtra lock here seems not ideal. This commit is not supposed to change behavior in any way. Other places in this commit I just added AssertLockHelds where needed to avoid clang lock warnings, but here I'm not even seeing that is necessary.",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-25T22:06:18Z",
      "diff_hunk" : "@@ -337,37 +343,38 @@ BOOST_AUTO_TEST_CASE(LoadReceiveRequests)\n     BOOST_CHECK_EQUAL(values[1], \"val_rr1\");\n }\n \n-// Test some watch-only wallet methods by the procedure of loading (LoadWatchOnly),\n+// Test some watch-only LegacyScriptPubKeyMan methods by the procedure of loading (LoadWatchOnly),\n // checking (HaveWatchOnly), getting (GetWatchPubKey) and removing (RemoveWatchOnly) a\n // given PubKey, resp. its corresponding P2PK Script. Results of the the impact on\n // the address -> PubKey map is dependent on whether the PubKey is a point on the curve\n-static void TestWatchOnlyPubKey(CWallet& wallet, const CPubKey& add_pubkey)\n+static void TestWatchOnlyPubKey(LegacyScriptPubKeyMan* spk_man, const CPubKey& add_pubkey)\n {\n     CScript p2pk = GetScriptForRawPubKey(add_pubkey);\n     CKeyID add_address = add_pubkey.GetID();\n     CPubKey found_pubkey;\n-    LOCK(wallet.cs_wallet);\n+    LOCK2(spk_man->cs_wallet, spk_man->cs_KeyStore);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339255102",
      "id" : 339255102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTI1NTEwMg==",
      "original_commit_id" : "194227b1173b0dd9a51d24e245ddaa601d36a109",
      "original_position" : 69,
      "path" : "src/wallet/test/wallet_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 307472747,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T16:25:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339255102",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339259163"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339259163"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It was failing the tests without it.",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-25T22:25:23Z",
      "diff_hunk" : "@@ -337,37 +343,38 @@ BOOST_AUTO_TEST_CASE(LoadReceiveRequests)\n     BOOST_CHECK_EQUAL(values[1], \"val_rr1\");\n }\n \n-// Test some watch-only wallet methods by the procedure of loading (LoadWatchOnly),\n+// Test some watch-only LegacyScriptPubKeyMan methods by the procedure of loading (LoadWatchOnly),\n // checking (HaveWatchOnly), getting (GetWatchPubKey) and removing (RemoveWatchOnly) a\n // given PubKey, resp. its corresponding P2PK Script. Results of the the impact on\n // the address -> PubKey map is dependent on whether the PubKey is a point on the curve\n-static void TestWatchOnlyPubKey(CWallet& wallet, const CPubKey& add_pubkey)\n+static void TestWatchOnlyPubKey(LegacyScriptPubKeyMan* spk_man, const CPubKey& add_pubkey)\n {\n     CScript p2pk = GetScriptForRawPubKey(add_pubkey);\n     CKeyID add_address = add_pubkey.GetID();\n     CPubKey found_pubkey;\n-    LOCK(wallet.cs_wallet);\n+    LOCK2(spk_man->cs_wallet, spk_man->cs_KeyStore);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339259163",
      "id" : 339259163,
      "in_reply_to_id" : 339255102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTI1OTE2Mw==",
      "original_commit_id" : "194227b1173b0dd9a51d24e245ddaa601d36a109",
      "original_position" : 69,
      "path" : "src/wallet/test/wallet_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 307478347,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T16:25:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339259163",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17283](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17283.html) (rpc: improve getaddressinfo test coverage, help, code docs by jonatack)\n* [#17246](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17246.html) (wallet: avoid knapsack when there's no change by Sjors)\n* [#17237](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17237.html) (wallet: LearnRelatedScripts only if KeepDestination by promag)\n* [#17219](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17219.html) (wallet: allow transaction without change if keypool is empty by Sjors)\n* [#17211](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17211.html) (Allow fundrawtransaction and walletcreatefundedpsbt to take external inputs by achow101)\n* [#16946](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16946.html) (wallet: include a checksum of encrypted private keys by achow101)\n* [#16910](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16910.html) (wallet: reduce loading time by using unordered maps by achow101)\n* [#16546](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16546.html) ([WIP] External signer support - Wallet Box edition by Sjors)\n* [#16528](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16528.html) ([WIP] Native Descriptor Wallets (take 2) by achow101)\n* [#16224](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16224.html) (gui: Bilingual GUI error messages by hebasto)\n* [#15931](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15931.html) (Remove GetDepthInMainChain dependency on locked chain interface by ariard)\n* [#15761](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15761.html) (Replace -upgradewallet startup option with upgradewallet RPC by achow101)\n* [#15294](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15294.html) ([moveonly] wallet: Extract RipeMd160 by Empact)\n* [#14942](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14942.html) (wallet: Make scan / abort status private to CWallet by Empact)\n* [#14707](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14707.html) ([RPC] Include coinbase transactions in receivedby RPCs by andrewtoth)\n* [#14384](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14384.html) (Fire TransactionRemovedFromMempool callbacks from mempool by l2a5b1)\n* [#14144](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14144.html) (Refactoring: Clarify code using encrypted_batch in CWallet by domob1812)\n* [#10785](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/10785.html) (Serialization improvements by sipa)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-10-25T22:45:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#issuecomment-546536564",
      "id" : 546536564,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17260",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjUzNjU2NA==",
      "updated_at" : "2019-10-29T08:19:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546536564",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339265025"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339265025"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Reverted and squashed linter changes.",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-25T22:56:22Z",
      "diff_hunk" : "@@ -421,47 +418,47 @@ bool CWallet::AddKeyPubKeyWithDB(WalletBatch& batch, const CKey& secret, const C\n                                                  secret.GetPrivKey(),\n                                                  mapKeyMetadata[pubkey.GetID()]);\n     }\n-    UnsetWalletFlagWithDB(batch, WALLET_FLAG_BLANK_WALLET);\n+    m_storage.UnsetWalletFlagWithDB(batch, WALLET_FLAG_BLANK_WALLET);\n     return true;\n }\n \n-bool CWallet::LoadCScript(const CScript& redeemScript)\n+bool LegacyScriptPubKeyMan::LoadCScript(const CScript& redeemScript)\n {\n     /* A sanity check was added in pull #3843 to avoid adding redeemScripts\n      * that never can be redeemed. However, old wallets may still contain\n      * these. Do not add them to the wallet and warn. */\n     if (redeemScript.size() > MAX_SCRIPT_ELEMENT_SIZE)\n     {\n         std::string strAddr = EncodeDestination(ScriptHash(redeemScript));\n-        WalletLogPrintf(\"%s: Warning: This wallet contains a redeemScript of size %i which exceeds maximum size %i thus can never be redeemed. Do not use address %s.\\n\", __func__, redeemScript.size(), MAX_SCRIPT_ELEMENT_SIZE, strAddr);\n+        m_wallet.WalletLogPrintf(\"%s: Warning: This wallet contains a redeemScript of size %i which exceeds maximum size %i thus can never be redeemed. Do not use address %s.\\n\", __func__, redeemScript.size(), MAX_SCRIPT_ELEMENT_SIZE, strAddr);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339265025",
      "id" : 339265025,
      "in_reply_to_id" : 339254720,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTI2NTAyNQ==",
      "original_commit_id" : "194227b1173b0dd9a51d24e245ddaa601d36a109",
      "original_position" : 184,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : null,
      "pull_request_review_id" : 307485535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T16:25:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339265025",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The code at 1c49a20cb10f2d48cf23bb364d586a9c1e86d5ec matches the first three commits in #17261 modulo the linter changes and extra lock discussed above. I in turn [verified](https://github.com/bitcoin/bitcoin/pull/17261#issuecomment-546582908) that #17261 matches what I previously reviewed.\r\n\r\nI'll review this PR on its own merits later.",
      "created_at" : "2019-10-26T08:44:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#issuecomment-546583678",
      "id" : 546583678,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17260",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NjU4MzY3OA==",
      "updated_at" : "2019-10-26T08:44:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546583678",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339300716"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339300716"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> It was failing the tests without it.\r\n\r\nSo this is definitely a bug. There canât be any changes in behavior in this PR. All it is supposed do is add wrapper functions and variable aliases. If any side effects are present from this, it means something has gone wrong.\r\n\r\nAny case I reproduced the problem and found it was limited to tests and caused by me pulling in some test-only LOCK changes that didn't belong here in a bad rebase. This PR can be fixed by just updating the tip from 1c49a20cb10f2d48cf23bb364d586a9c1e86d5ec to f201ba59ffd2e071a36a688b80d2cff9a9c44bb2 ([compare](https://github.com/bitcoin/bitcoin/compare/1c49a20cb10f2d48cf23bb364d586a9c1e86d5ec..f201ba59ffd2e071a36a688b80d2cff9a9c44bb2)) from my updated [`pr/keyman`](https://github.com/ryanofsky/bitcoin/commits/pr/keyman) branch. Getting rid of the unintended test locking changes also makes this PR slightly smaller.\r\n\r\n(You can also reset #17261 to the updated [`pr/keyman`](https://github.com/ryanofsky/bitcoin/commits/pr/keyman) branch with no loss since I pulled in your updated SigningProvider commit there.)",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-26T13:45:33Z",
      "diff_hunk" : "@@ -337,37 +343,38 @@ BOOST_AUTO_TEST_CASE(LoadReceiveRequests)\n     BOOST_CHECK_EQUAL(values[1], \"val_rr1\");\n }\n \n-// Test some watch-only wallet methods by the procedure of loading (LoadWatchOnly),\n+// Test some watch-only LegacyScriptPubKeyMan methods by the procedure of loading (LoadWatchOnly),\n // checking (HaveWatchOnly), getting (GetWatchPubKey) and removing (RemoveWatchOnly) a\n // given PubKey, resp. its corresponding P2PK Script. Results of the the impact on\n // the address -> PubKey map is dependent on whether the PubKey is a point on the curve\n-static void TestWatchOnlyPubKey(CWallet& wallet, const CPubKey& add_pubkey)\n+static void TestWatchOnlyPubKey(LegacyScriptPubKeyMan* spk_man, const CPubKey& add_pubkey)\n {\n     CScript p2pk = GetScriptForRawPubKey(add_pubkey);\n     CKeyID add_address = add_pubkey.GetID();\n     CPubKey found_pubkey;\n-    LOCK(wallet.cs_wallet);\n+    LOCK2(spk_man->cs_wallet, spk_man->cs_KeyStore);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339300716",
      "id" : 339300716,
      "in_reply_to_id" : 339255102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTMwMDcxNg==",
      "original_commit_id" : "194227b1173b0dd9a51d24e245ddaa601d36a109",
      "original_position" : 69,
      "path" : "src/wallet/test/wallet_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 307526785,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T16:25:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339300716",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339306257"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339306257"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-26T16:25:19Z",
      "diff_hunk" : "@@ -337,37 +343,38 @@ BOOST_AUTO_TEST_CASE(LoadReceiveRequests)\n     BOOST_CHECK_EQUAL(values[1], \"val_rr1\");\n }\n \n-// Test some watch-only wallet methods by the procedure of loading (LoadWatchOnly),\n+// Test some watch-only LegacyScriptPubKeyMan methods by the procedure of loading (LoadWatchOnly),\n // checking (HaveWatchOnly), getting (GetWatchPubKey) and removing (RemoveWatchOnly) a\n // given PubKey, resp. its corresponding P2PK Script. Results of the the impact on\n // the address -> PubKey map is dependent on whether the PubKey is a point on the curve\n-static void TestWatchOnlyPubKey(CWallet& wallet, const CPubKey& add_pubkey)\n+static void TestWatchOnlyPubKey(LegacyScriptPubKeyMan* spk_man, const CPubKey& add_pubkey)\n {\n     CScript p2pk = GetScriptForRawPubKey(add_pubkey);\n     CKeyID add_address = add_pubkey.GetID();\n     CPubKey found_pubkey;\n-    LOCK(wallet.cs_wallet);\n+    LOCK2(spk_man->cs_wallet, spk_man->cs_KeyStore);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339306257",
      "id" : 339306257,
      "in_reply_to_id" : 339255102,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTMwNjI1Nw==",
      "original_commit_id" : "194227b1173b0dd9a51d24e245ddaa601d36a109",
      "original_position" : 69,
      "path" : "src/wallet/test/wallet_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 307533150,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T16:25:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339306257",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339308211"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339308211"
         }
      },
      "author_association" : "MEMBER",
      "body" : "FWIW: I'm no longer in favor of splitting this out. For example this RPC method relies on `ImportPrivKeys` which is no longer a method on `CWallet`, but on`LegacyScriptPubKeyMan` (and not of its parent class `ScriptPubKeyMan`). This is in contrast to methods like `setwalletflag` that still call `CWallet` methods.",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-26T17:20:03Z",
      "diff_hunk" : "@@ -138,6 +138,11 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot import private keys to a wallet with private keys disabled\");\n     }\n \n+    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!spk_man) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339308211",
      "id" : 339308211,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTMwODIxMQ==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 20,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 20,
      "pull_request_review_id" : 307531781,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T17:22:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339308211",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339308494"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339308494"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's a bit weird to have a definition in a cpp file. On a local branch I was able to move this to `scriptpubkeyman.h` in the second commit, courtesy of circular includes.",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-26T17:27:23Z",
      "diff_hunk" : "@@ -238,17 +236,7 @@ std::string COutput::ToString() const\n     return strprintf(\"COutput(%s, %d, %d) [%s]\", tx->GetHash().ToString(), i, nDepth, FormatMoney(tx->tx->vout[i].nValue));\n }\n \n-std::vector<CKeyID> GetAffectedKeys(const CScript& spk, const SigningProvider& provider)\n-{\n-    std::vector<CScript> dummy;\n-    FlatSigningProvider out;\n-    InferDescriptor(spk, provider)->Expand(0, DUMMY_SIGNING_PROVIDER, dummy, out);\n-    std::vector<CKeyID> ret;\n-    for (const auto& entry : out.pubkeys) {\n-        ret.push_back(entry.first);\n-    }\n-    return ret;\n-}\n+std::vector<CKeyID> GetAffectedKeys(const CScript& spk, const SigningProvider& provider);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339308494",
      "id" : 339308494,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTMwODQ5NA==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 37,
      "path" : "src/wallet/wallet.cpp",
      "position" : 37,
      "pull_request_review_id" : 307535902,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T17:27:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339308494",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339311168"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339311168"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339308211\r\n\r\n> FWIW: I'm no longer in favor of splitting this out. For example this RPC method relies on `ImportPrivKeys` which is no longer a method on `CWallet`, but on`LegacyScriptPubKeyMan` (and not of its parent class `ScriptPubKeyMan`). This is in contrast to methods like `setwalletflag` that still call `CWallet` methods.\r\n\r\n:thumbsup:\r\n\r\nFor reference, Sjors is referring back to his suggestion from https://github.com/bitcoin/bitcoin/pull/16341#issuecomment-540067319 to move this code, and saying it doesn't necessarily apply anymore, so the PR should be good here.\r\n",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-26T18:44:42Z",
      "diff_hunk" : "@@ -138,6 +138,11 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot import private keys to a wallet with private keys disabled\");\n     }\n \n+    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!spk_man) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339311168",
      "id" : 339311168,
      "in_reply_to_id" : 339308211,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTMxMTE2OA==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 20,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 20,
      "pull_request_review_id" : 307538786,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T19:01:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339311168",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339311207"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339311207"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"MOVEONLY: Move key handling code out of wallet to keyman file\" (6702048f91089d7a565e5ca5f7c8dcd2ca405a85):\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339308494\r\n\r\n> It's a bit weird to have a definition in a cpp file. On a local branch I was able to move this to `scriptpubkeyman.h` in the second commit, courtesy of circular includes.\r\n\r\nThere's a later commit that moves this declaration at the same time as moving the call: 8e743b90f5cec16383d2bf862b625c286db83661, so no need to necessarily move it here, even though it is a reasonable suggestion.",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-26T18:45:49Z",
      "diff_hunk" : "@@ -238,17 +236,7 @@ std::string COutput::ToString() const\n     return strprintf(\"COutput(%s, %d, %d) [%s]\", tx->GetHash().ToString(), i, nDepth, FormatMoney(tx->tx->vout[i].nValue));\n }\n \n-std::vector<CKeyID> GetAffectedKeys(const CScript& spk, const SigningProvider& provider)\n-{\n-    std::vector<CScript> dummy;\n-    FlatSigningProvider out;\n-    InferDescriptor(spk, provider)->Expand(0, DUMMY_SIGNING_PROVIDER, dummy, out);\n-    std::vector<CKeyID> ret;\n-    for (const auto& entry : out.pubkeys) {\n-        ret.push_back(entry.first);\n-    }\n-    return ret;\n-}\n+std::vector<CKeyID> GetAffectedKeys(const CScript& spk, const SigningProvider& provider);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339311207",
      "id" : 339311207,
      "in_reply_to_id" : 339308494,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTMxMTIwNw==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 37,
      "path" : "src/wallet/wallet.cpp",
      "position" : 37,
      "pull_request_review_id" : 307538786,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-26T19:03:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339311207",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339505236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339505236"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, could add some helper to do this repeated check (currently 9 times), like `GetLegacyScriptPubKeyMan(pwallet)`?",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-28T11:01:12Z",
      "diff_hunk" : "@@ -138,6 +138,11 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot import private keys to a wallet with private keys disabled\");\n     }\n \n+    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!spk_man) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339505236",
      "id" : 339505236,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTUwNTIzNg==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 20,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 20,
      "pull_request_review_id" : 307772038,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-28T11:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339505236",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339775866"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339775866"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339505236\r\n\r\n> nit, could add some helper to do this repeated check (currently 9 times), like `GetLegacyScriptPubKeyMan(pwallet)`?\r\n\r\nWould be a nice followup. My preference would be to do it in a later PR though to avoid delay on this one, since this PR is pretty big and already has some acks.",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-28T20:27:55Z",
      "diff_hunk" : "@@ -138,6 +138,11 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot import private keys to a wallet with private keys disabled\");\n     }\n \n+    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!spk_man) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339775866",
      "id" : 339775866,
      "in_reply_to_id" : 339505236,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTc3NTg2Ng==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 20,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 20,
      "pull_request_review_id" : 308127065,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-28T20:40:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339775866",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339797903"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339797903"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agreed for follow up.",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-28T21:19:04Z",
      "diff_hunk" : "@@ -138,6 +138,11 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot import private keys to a wallet with private keys disabled\");\n     }\n \n+    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n+    if (!spk_man) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r339797903",
      "id" : 339797903,
      "in_reply_to_id" : 339505236,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTc5NzkwMw==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 20,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 20,
      "pull_request_review_id" : 308155765,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-28T21:19:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339797903",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340029481"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340029481"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why is this removed?",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-29T11:50:31Z",
      "diff_hunk" : "@@ -379,18 +378,16 @@ void CWallet::UpdateTimeFirstKey(int64_t nCreateTime)\n     }\n }\n \n-bool CWallet::AddKeyPubKey(const CKey& secret, const CPubKey &pubkey)\n+bool LegacyScriptPubKeyMan::AddKeyPubKey(const CKey& secret, const CPubKey &pubkey)\n {\n-    WalletBatch batch(*database);\n-    return CWallet::AddKeyPubKeyWithDB(batch, secret, pubkey);\n+    WalletBatch batch(m_storage.GetDatabase());\n+    return LegacyScriptPubKeyMan::AddKeyPubKeyWithDB(batch, secret, pubkey);\n }\n \n-bool CWallet::AddKeyPubKeyWithDB(WalletBatch& batch, const CKey& secret, const CPubKey& pubkey)\n+bool LegacyScriptPubKeyMan::AddKeyPubKeyWithDB(WalletBatch& batch, const CKey& secret, const CPubKey& pubkey)\n {\n-    AssertLockHeld(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340029481",
      "id" : 340029481,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDAyOTQ4MQ==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 157,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : null,
      "pull_request_review_id" : 308449790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-29T12:18:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340029481",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340031507"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340031507"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit f201ba59ffd2e071a36a688b80d2cff9a9c44bb2:\r\n\r\nCould clarify that this is \"for all ScriptPubKeyMans of a wallet\" and not (*\"for all ScriptPubKeyMans of all wallets\"*)",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-29T11:55:40Z",
      "diff_hunk" : "@@ -16,6 +16,25 @@\n \n enum class OutputType;\n \n+// Wallet storage things that ScriptPubKeyMans need in order to be able to store things to the wallet database.\n+// It provides access to things that are part of the entire wallet and not specific to a ScriptPubKeyMan such as\n+// wallet flags, wallet version, encryption keys, encryption status, and the database itself. This allows a\n+// ScriptPubKeyMan to have callbacks into CWallet without causing a circular dependency.\n+// WalletStorage should be the same for all ScriptPubKeyMans.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340031507",
      "id" : 340031507,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDAzMTUwNw==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 8,
      "path" : "src/wallet/scriptpubkeyman.h",
      "position" : 23,
      "pull_request_review_id" : 308449790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-29T12:18:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340031507",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340033021"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340033021"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How is this supposed to work? The pointer was already dereferenced in the line above",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-29T11:59:15Z",
      "diff_hunk" : "@@ -248,6 +247,14 @@ const CWalletTx* CWallet::GetWalletTx(const uint256& hash) const\n     return &(it->second);\n }\n \n+void CWallet::UpgradeKeyMetadata()\n+{\n+    AssertLockHeld(m_spk_man->cs_wallet);\n+    if (m_spk_man) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340033021",
      "id" : 340033021,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDAzMzAyMQ==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 28,
      "path" : "src/wallet/wallet.cpp",
      "position" : 301,
      "pull_request_review_id" : 308449790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-29T12:18:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340033021",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340034123"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340034123"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why is a nullptr check required above but not here?",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-29T12:02:04Z",
      "diff_hunk" : "@@ -554,11 +562,11 @@ bool CWallet::EncryptWallet(const SecureString& strWalletPassphrase)\n         Unlock(strWalletPassphrase);\n \n         // if we are using HD, replace the HD seed with a new one\n-        if (IsHDEnabled()) {\n-            SetHDSeed(GenerateNewSeed());\n+        if (m_spk_man->IsHDEnabled()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340034123",
      "id" : 340034123,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDAzNDEyMw==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 66,
      "path" : "src/wallet/wallet.cpp",
      "position" : 429,
      "pull_request_review_id" : 308449790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-29T12:18:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340034123",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340036269"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340036269"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why is this not setting the error string?",
      "commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "created_at" : "2019-10-29T12:07:42Z",
      "diff_hunk" : "@@ -2693,7 +2782,12 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 const CScript& scriptPubKey = coin.txout.scriptPubKey;\n                 SignatureData sigdata;\n \n-                if (!ProduceSignature(*this, MutableTransactionSignatureCreator(&txNew, nIn, coin.txout.nValue, SIGHASH_ALL), scriptPubKey, sigdata))\n+                const SigningProvider* provider = GetSigningProvider();\n+                if (!provider) {\n+                    return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#discussion_r340036269",
      "id" : 340036269,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDAzNjI2OQ==",
      "original_commit_id" : "f201ba59ffd2e071a36a688b80d2cff9a9c44bb2",
      "original_position" : 267,
      "path" : "src/wallet/wallet.cpp",
      "position" : 774,
      "pull_request_review_id" : 308449790,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17260",
      "updated_at" : "2019-10-29T12:18:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340036269",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This had the nice side effect of cutting peak memory use during compilation: \r\n\r\nhttps://codespeed.bitcoinperf.com/timeline/?exe=3%2C4%2C2%2C1%2C5&base=1%2B23&ben=build.make.1.clang.mem-usage&env=1&revs=10&equid=off&quarts=on&extr=on\r\n\r\nhttps://codespeed.bitcoinperf.com/timeline/?exe=3%2C4%2C2%2C1%2C5&base=1%2B23&ben=build.make.1.gcc.mem-usage&env=1&revs=10&equid=off&quarts=on&extr=on",
      "created_at" : "2019-11-02T17:38:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#issuecomment-549065193",
      "id" : 549065193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17260",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTA2NTE5Mw==",
      "updated_at" : "2019-11-02T17:38:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549065193",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "So I might just be being lazy...\r\n\r\nBut can you do a bit more documentation on this one? This breaks some of my outstanding work (not PR'd yet) and I'd like to better understand where I should be making this functionality live...",
      "created_at" : "2019-11-24T05:12:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#issuecomment-557858675",
      "id" : 557858675,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17260",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1Nzg1ODY3NQ==",
      "updated_at" : "2019-11-24T05:12:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557858675",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I guess mostly it's just stuff moving into scriptpubkeyman? But do I need to replicate the logic elsewhere now? ",
      "created_at" : "2019-11-24T05:19:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#issuecomment-557859025",
      "id" : 557859025,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17260",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1Nzg1OTAyNQ==",
      "updated_at" : "2019-11-24T05:19:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557859025",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@JeremyRubin Have you read https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Wallet-Class-Structure-Changes\r\n\r\nBasically a bunch of things are moving into LegacyScriptPubKeyMan, and some of those that were moved become generic interfaces in CWallet which call the appropriate ScriptPubKeyMan.",
      "created_at" : "2019-11-24T07:04:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17260#issuecomment-557863523",
      "id" : 557863523,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17260",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1Nzg2MzUyMw==",
      "updated_at" : "2019-11-24T07:04:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557863523",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
