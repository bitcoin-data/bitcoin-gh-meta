[
   {
      "author_association" : "MEMBER",
      "body" : "No opposition to having this, but wouldn't `bitcoin-wallet-tool` be the designated place for this?",
      "created_at" : "2019-04-06T07:11:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480480966",
      "id" : 480480966,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDQ4MDk2Ng==",
      "updated_at" : "2019-04-06T07:11:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480480966",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> No opposition to having this, but wouldn't `bitcoin-wallet-tool` be the designated place for this?\r\n\r\nI'm not really a fan of putting things that users might actually use and want to use in a place that is less accessible. `bitcoin-wallet-tool` is command line only and many users won't know how to use it. With an RPC, most users will be able to use it since there is a RPC console in the GUI.",
      "created_at" : "2019-04-06T15:51:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480514693",
      "id" : 480514693,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDUxNDY5Mw==",
      "updated_at" : "2019-04-06T15:51:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480514693",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272800660"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272800660"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot set a HD seed on a non-HD wallet. Use the upgradewallet RPC in order to upgrade a non-HD wallet to HD\");\r\n```",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-06T16:19:21Z",
      "diff_hunk" : "@@ -3797,7 +3797,7 @@ UniValue sethdseed(const JSONRPCRequest& request)\n \n     // Do not do anything to non-HD wallets\n     if (!pwallet->CanSupportFeature(FEATURE_HD)) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot set a HD seed on a non-HD wallet. Start with -upgradewallet in order to upgrade a non-HD wallet to HD\");\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot set a HD seed on a non-HD wallet. Use the upgradewallet command in order to upgrade a non-HD wallet to HD\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272800660",
      "id" : 272800660,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MjgwMDY2MA==",
      "original_commit_id" : "0612304818b477f91a8c2daf56d7a9f7e4588fe2",
      "original_line" : 3800,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 223546850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272800660",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272800667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272800667"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\nstatic UniValue upgradewallet(const JSONRPCRequest& request)\r\n```",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-06T16:19:33Z",
      "diff_hunk" : "@@ -4018,6 +4018,92 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue upgradewallet(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272800667",
      "id" : 272800667,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MjgwMDY2Nw==",
      "original_commit_id" : "0612304818b477f91a8c2daf56d7a9f7e4588fe2",
      "original_line" : 4021,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 223546850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272800667",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272800740"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272800740"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could use a const object that is in scope even when no help was not requested? That way checking the arguments could be done through the HelpMan in the future. See for example `const RPCHelpMan help{\"sendmany\",` for what I mean.",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-06T16:21:48Z",
      "diff_hunk" : "@@ -4018,6 +4018,92 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue upgradewallet(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    if (request.fHelp || request.params.size() > 1)\n+        throw std::runtime_error(\n+            RPCHelpMan{\"upgradewallet\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272800740",
      "id" : 272800740,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MjgwMDc0MA==",
      "original_commit_id" : "0612304818b477f91a8c2daf56d7a9f7e4588fe2",
      "original_line" : 4032,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 223546850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272800740",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272800829"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272800829"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This fails to compile.\r\n\r\nMind to make a move-only of the upgrade code into a standalone member function, that is merely called by the RPC instead of moving the whole wallet logic into the rpc file?",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-06T16:24:49Z",
      "diff_hunk" : "@@ -4018,6 +4018,92 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue upgradewallet(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    if (request.fHelp || request.params.size() > 1)\n+        throw std::runtime_error(\n+            RPCHelpMan{\"upgradewallet\",\n+                \"\\nUpgrade the wallet. Upgrades to the latest version if no version number is specified\\n\"\n+                \"New keys may be generated and a new wallet backup will need to be made.\" +\n+                    HelpRequiringPassphrase(pwallet) + \"\\n\",\n+                {\n+                    {\"version\", RPCArg::Type::NUM, /* default */ strprintf(\"%d\", FEATURE_LATEST), \"The version number to upgrade to. Default is the latest wallet version\"}\n+                },\n+                RPCResults{},\n+                RPCExamples{\n+                    HelpExampleCli(\"upgradewallet\", \"169900\")\n+                    + HelpExampleRpc(\"upgradewallet\", \"169900\")\n+                }\n+            }.ToString());\n+\n+    RPCTypeCheck(request.params, {UniValue::VNUM}, true);\n+\n+    auto locked_chain = pwallet->chain().lock();\n+    LOCK(pwallet->cs_wallet);\n+\n+    EnsureWalletIsUnlocked(pwallet);\n+\n+    int version = FEATURE_LATEST;\n+    if (!request.params[0].isNull()) {\n+        version = request.params[0].get_int();\n+    }\n+\n+    int prev_version = pwallet->GetVersion();\n+    if (version < prev_version) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot downgrade wallet\");\n+    } else if (version == prev_version) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet is already upgraded\");\n+    }\n+\n+    pwallet->SetMaxVersion(version);\n+\n+    pwallet->WalletLogPrintf(\"Performing wallet upgrade to %i\\n\", version);\n+\n+    // Do not upgrade versions to any version between HD_SPLIT and FEATURE_PRE_SPLIT_KEYPOOL unless already supporting HD_SPLIT\n+    if (!pwallet->CanSupportFeature(FEATURE_HD_SPLIT) && version >= FEATURE_HD_SPLIT && version < FEATURE_PRE_SPLIT_KEYPOOL) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot upgrade a non HD split wallet without upgrading to support pre split keypool. Please use the upgradewallet command.\");\n+    }\n+\n+    pwallet->SetMinVersion(version); // permanently upgrade the wallet after making sure we can upgrade",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272800829",
      "id" : 272800829,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MjgwMDgyOQ==",
      "original_commit_id" : "0612304818b477f91a8c2daf56d7a9f7e4588fe2",
      "original_line" : 4074,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 223546850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272800829",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Related: #13044",
      "created_at" : "2019-04-06T16:26:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480517346",
      "id" : 480517346,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDUxNzM0Ng==",
      "updated_at" : "2019-04-06T16:26:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480517346",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272801797"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272801797"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-06T16:56:33Z",
      "diff_hunk" : "@@ -4018,6 +4018,92 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue upgradewallet(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    if (request.fHelp || request.params.size() > 1)\n+        throw std::runtime_error(\n+            RPCHelpMan{\"upgradewallet\",\n+                \"\\nUpgrade the wallet. Upgrades to the latest version if no version number is specified\\n\"\n+                \"New keys may be generated and a new wallet backup will need to be made.\" +\n+                    HelpRequiringPassphrase(pwallet) + \"\\n\",\n+                {\n+                    {\"version\", RPCArg::Type::NUM, /* default */ strprintf(\"%d\", FEATURE_LATEST), \"The version number to upgrade to. Default is the latest wallet version\"}\n+                },\n+                RPCResults{},\n+                RPCExamples{\n+                    HelpExampleCli(\"upgradewallet\", \"169900\")\n+                    + HelpExampleRpc(\"upgradewallet\", \"169900\")\n+                }\n+            }.ToString());\n+\n+    RPCTypeCheck(request.params, {UniValue::VNUM}, true);\n+\n+    auto locked_chain = pwallet->chain().lock();\n+    LOCK(pwallet->cs_wallet);\n+\n+    EnsureWalletIsUnlocked(pwallet);\n+\n+    int version = FEATURE_LATEST;\n+    if (!request.params[0].isNull()) {\n+        version = request.params[0].get_int();\n+    }\n+\n+    int prev_version = pwallet->GetVersion();\n+    if (version < prev_version) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot downgrade wallet\");\n+    } else if (version == prev_version) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Wallet is already upgraded\");\n+    }\n+\n+    pwallet->SetMaxVersion(version);\n+\n+    pwallet->WalletLogPrintf(\"Performing wallet upgrade to %i\\n\", version);\n+\n+    // Do not upgrade versions to any version between HD_SPLIT and FEATURE_PRE_SPLIT_KEYPOOL unless already supporting HD_SPLIT\n+    if (!pwallet->CanSupportFeature(FEATURE_HD_SPLIT) && version >= FEATURE_HD_SPLIT && version < FEATURE_PRE_SPLIT_KEYPOOL) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot upgrade a non HD split wallet without upgrading to support pre split keypool. Please use the upgradewallet command.\");\n+    }\n+\n+    pwallet->SetMinVersion(version); // permanently upgrade the wallet after making sure we can upgrade",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272801797",
      "id" : 272801797,
      "in_reply_to_id" : 272800829,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MjgwMTc5Nw==",
      "original_commit_id" : "0612304818b477f91a8c2daf56d7a9f7e4588fe2",
      "original_line" : 4074,
      "original_position" : 75,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 223548199,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272801797",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272801801"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272801801"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-06T16:56:38Z",
      "diff_hunk" : "@@ -4018,6 +4018,92 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue upgradewallet(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    if (request.fHelp || request.params.size() > 1)\n+        throw std::runtime_error(\n+            RPCHelpMan{\"upgradewallet\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272801801",
      "id" : 272801801,
      "in_reply_to_id" : 272800740,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MjgwMTgwMQ==",
      "original_commit_id" : "0612304818b477f91a8c2daf56d7a9f7e4588fe2",
      "original_line" : 4032,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 223548203,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272801801",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272801804"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272801804"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-06T16:56:42Z",
      "diff_hunk" : "@@ -4018,6 +4018,92 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue upgradewallet(const JSONRPCRequest& request)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272801804",
      "id" : 272801804,
      "in_reply_to_id" : 272800667,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MjgwMTgwNA==",
      "original_commit_id" : "0612304818b477f91a8c2daf56d7a9f7e4588fe2",
      "original_line" : 4021,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 223548207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272801804",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272801807"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272801807"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-06T16:56:46Z",
      "diff_hunk" : "@@ -3797,7 +3797,7 @@ UniValue sethdseed(const JSONRPCRequest& request)\n \n     // Do not do anything to non-HD wallets\n     if (!pwallet->CanSupportFeature(FEATURE_HD)) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot set a HD seed on a non-HD wallet. Start with -upgradewallet in order to upgrade a non-HD wallet to HD\");\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot set a HD seed on a non-HD wallet. Use the upgradewallet command in order to upgrade a non-HD wallet to HD\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r272801807",
      "id" : 272801807,
      "in_reply_to_id" : 272800660,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MjgwMTgwNw==",
      "original_commit_id" : "0612304818b477f91a8c2daf56d7a9f7e4588fe2",
      "original_line" : 3800,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 223548214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/272801807",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18531 (rpc: Assert that RPCArg names are equal to CRPCCommand ones by MarcoFalke)\n* #18192 (Bugfix: Wallet: Safely deal with change in the address book by luke-jr)\n* #17211 (Allow fundrawtransaction and walletcreatefundedpsbt to take external inputs by achow101)\n* #17127 (util: Correct permissions for datadir and wallets subdir by hebasto)\n* #15719 (Drop Chain::requestMempoolTransactions method by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-04-06T17:26:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480521997",
      "id" : 480521997,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDUyMTk5Nw==",
      "updated_at" : "2020-04-05T22:53:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480521997",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK although I agree with @laanwj that a utility function that does not require access to the chainstate or P2P rightly lives in the wallet tool.\r\n\r\n>  I'm not really a fan of putting things that users might actually use and want to use in a place that is less accessible [...] With an RPC, most users will be able to use it since there is a RPC console in the GUI.\r\n\r\nI'd disagree that RPC is accessible to users who aren't able to use the command line. We shouldn't encourage users to type commands into the debug command window if they're not able to use the command line. Besides, `upgradewallet` is currently command line only, so moving it to the wallet tool maintains exactly the same level of accessibility.",
      "created_at" : "2019-04-06T18:48:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480528308",
      "id" : 480528308,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDUyODMwOA==",
      "updated_at" : "2019-04-06T18:48:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480528308",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is this something that we'd like to be accessible to wallets why they're loaded? If so, it needs to be an RPC (and possibly also in the wallet tool). ",
      "created_at" : "2019-04-06T19:04:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480529447",
      "id" : 480529447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDUyOTQ0Nw==",
      "updated_at" : "2019-04-06T19:04:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480529447",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Is this something that we'd like to be accessible to wallets why they're loaded?\r\n\r\nI would like it to be.",
      "created_at" : "2019-04-06T20:04:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480533618",
      "id" : 480533618,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDUzMzYxOA==",
      "updated_at" : "2019-04-06T20:04:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480533618",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Is this something that we'd like to be accessible to wallets while they're loaded?\r\n\r\nThis seems to me to potentially add complexity in future. I could imagine there may be some potential upgrade actions that would conflict badly when executed on a running wallet. Why not keep it simple and only allow upgrade when the wallet is not running?\r\n\r\nEDIT: to be clear, I'm not NACKing this. I think an `upgradewallet` RPC is certainly an improvement over the command line option, and doesn't preclude also adding it to the wallet tool. I just think that the offline wallet tool would be an even better place for it.",
      "created_at" : "2019-04-07T20:26:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480626179",
      "id" : 480626179,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDYyNjE3OQ==",
      "updated_at" : "2019-04-07T23:08:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480626179",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK removing the `-upgradewallet` argument.\r\n\r\nWhy not add `upgrade` option to `loadwallet` RPC?",
      "created_at" : "2019-04-08T14:25:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-480853986",
      "id" : 480853986,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDg1Mzk4Ng==",
      "updated_at" : "2019-04-08T14:25:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480853986",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Why not add `upgrade` option to `loadwallet` RPC?\r\n\r\nI think it makes more sense to have upgrading be separate from loading.",
      "created_at" : "2019-04-09T14:34:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-481278120",
      "id" : 481278120,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTI3ODEyMA==",
      "updated_at" : "2019-04-09T14:34:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481278120",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think it makes more sense to have upgrading be separate from loading.\r\n\r\nCan you justify that? Upgrading wallets is something that most users will very rarely (if ever) have to do. What's the benefit to adding the flexibility to upgrade wallets during runtime? The downsides seem pretty obvious to me (potential increased complexity and having to reason about interactions with other wallet operations) so I'd like to understand what you're weighing that against.",
      "created_at" : "2019-04-09T14:46:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-481283456",
      "id" : 481283456,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTI4MzQ1Ng==",
      "updated_at" : "2019-04-09T14:46:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481283456",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'd disagree that RPC is accessible to users who aren't able to use the command line. We shouldn't encourage users to type commands into the debug command window if they're not able to use the command line. Besides, `upgradewallet` is currently command line only, so moving it to the wallet tool maintains exactly the same level of accessibility.\r\n\r\nI disagree. It is far easier for users to understand and use the RPC console than it is for them to use and understand the wallet tool. The instructions for opening up the RPC console and then entering a command are far simpler than the instructions for using the wallet tool. There is exactly one set of instructions that users have to follow with the only thing that they need to consider is their wallet name and making sure that that wallet is selected.\r\n\r\nConversely, with the wallet tool, the instructions for using it are dependent on how the user installed the software (i.e. they need to know the install location) and whether they changed the data directory. Then they have to specify the wallet in the command line which may involve escaping or quoting. All of these are extra options and information that users need to know which they may not. With the RPC console, all that stuff is already handled for them. The instructions are far simpler and easier to understand when using the RPC console than when using the command line wallet tool.\r\n\r\nIn a similar vein, I disagree with \"We shouldn't encourage users to type commands into the debug command window if they're not able to use the command line.\" As I mentioned, using the RPC console is far easier than using the command line. While they are similar, the command line has so many extra rules and gotchas that the RPC console does not. A user can be fine and comfortable using the RPC console but not able to use the command line simply because the command line does many other things that can cause screwups.\r\n\r\n> Can you justify that? Upgrading wallets is something that most users will very rarely (if ever) have to do. What's the benefit to adding the flexibility to upgrade wallets during runtime?\r\n\r\nConceptually, loading and upgrading are two separate functions that should be defined separately. From a UX standpoint, it makes more sense to users to do an explicit upgrade as a separate command rather than as an argument to some other command. If bundled with `loadwallet`, I suspect that many users would miss the important step of unloading the wallet first and generally cause headaches all around as they complain and ask how to actually upgrade their wallets. Keep in mind that while upgrades may be infrequent, many users are still using non-HD wallets and have been waiting for an easy way to upgrade their non-HD wallets to HD; `upgradewallet` would provide that easy method.\r\n\r\n> The downsides seem pretty obvious to me (potential increased complexity and having to reason about interactions with other wallet operations) so I'd like to understand what you're weighing that against.\r\n\r\nI really don't think that's a reason against this. By that logic we just shouldn't change anything because it increases complexity and we have to reason about interactions with other operations.\r\n\r\nMoving upgrading to its own code will actually make it less complex and simpler. Currently I have it as largely a move-only, but it can actually be simplified. Keeping it as part of loading means that it has to distinguish between a new wallet and a wallet being upgraded. They follow largely the same codepaths but have just slightly different logic. The fact that these two are together in `CreateWalletFromFile` actually makes the upgrade logic hard to understand and reason about. I had a hard time determining whether the upgrade logic was actually upgrading correctly. By separating the upgrade logic into its own function, we can clean it up so that what it does is not confusing and can be followed. This actually reduces the complexity of the code.",
      "created_at" : "2019-04-10T06:48:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-481557033",
      "id" : 481557033,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTU1NzAzMw==",
      "updated_at" : "2019-04-10T06:48:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481557033",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK moving it to either or both (tool and rpc)",
      "created_at" : "2019-04-10T13:31:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-481691925",
      "id" : 481691925,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTY5MTkyNQ==",
      "updated_at" : "2019-04-10T13:31:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481691925",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The RPC variant probably has the advantage that the function could be added to the File menu later on (maybe right next to \"Backup wallet...\"), which would also alleviate the concerns about having users enter random stuff in the console",
      "created_at" : "2019-04-12T18:34:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-482679097",
      "id" : 482679097,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MjY3OTA5Nw==",
      "updated_at" : "2019-04-12T18:34:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/482679097",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/425166?v=4",
         "events_url" : "https://api.github.com/users/flack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/flack/followers",
         "following_url" : "https://api.github.com/users/flack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/flack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/flack",
         "id" : 425166,
         "login" : "flack",
         "node_id" : "MDQ6VXNlcjQyNTE2Ng==",
         "organizations_url" : "https://api.github.com/users/flack/orgs",
         "received_events_url" : "https://api.github.com/users/flack/received_events",
         "repos_url" : "https://api.github.com/users/flack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/flack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/flack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/flack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-04-17T19:23:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-484227084",
      "id" : 484227084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NDIyNzA4NA==",
      "updated_at" : "2019-04-17T19:23:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/484227084",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nit: commit messages misspell upgrade multiple times",
      "created_at" : "2019-04-20T21:12:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-485173032",
      "id" : 485173032,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTE3MzAzMg==",
      "updated_at" : "2019-04-20T21:12:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485173032",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r277146727"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277146727"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is removed in the wrong commit.",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-20T21:19:11Z",
      "diff_hunk" : "@@ -4064,67 +4064,6 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n         }\n     }\n \n-    int prev_version = walletInstance->GetVersion();\n-    if (gArgs.GetBoolArg(\"-upgradewallet\", fFirstRun))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r277146727",
      "id" : 277146727,
      "line" : 3834,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzE0NjcyNw==",
      "original_commit_id" : "65e296dcc66cac1eac32e9a9052be747742caad7",
      "original_line" : 3834,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 228891304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277146727",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r277149102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277149102"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-20T23:28:14Z",
      "diff_hunk" : "@@ -4064,67 +4064,6 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n         }\n     }\n \n-    int prev_version = walletInstance->GetVersion();\n-    if (gArgs.GetBoolArg(\"-upgradewallet\", fFirstRun))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r277149102",
      "id" : 277149102,
      "in_reply_to_id" : 277146727,
      "line" : 3834,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzE0OTEwMg==",
      "original_commit_id" : "65e296dcc66cac1eac32e9a9052be747742caad7",
      "original_line" : 3834,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 228893772,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277149102",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Nit: commit messages misspell upgrade multiple times\r\n\r\nFixed\r\n\r\n> The first commit is convoluted/difficult to review\r\n\r\nHow so? It's mostly just a move\r\n\r\n> broken (-upgradewallet no longer works).\r\n\r\nShould be fixed\r\n",
      "created_at" : "2019-04-20T23:28:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-485196235",
      "id" : 485196235,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTE5NjIzNQ==",
      "updated_at" : "2019-04-20T23:28:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485196235",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Re first commit: Since it's on the object, you drop the `walletInstance->` everywhere. I'd suggest a minimal moveonly commit, then a subsequent one that makes the changes.",
      "created_at" : "2019-04-20T23:44:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-485198521",
      "id" : 485198521,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTE5ODUyMQ==",
      "updated_at" : "2019-04-20T23:44:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485198521",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r277149385"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277149385"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Part of this is supposed to run by default if `fFirstRun`.",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-20T23:46:08Z",
      "diff_hunk" : "@@ -4041,64 +4041,10 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n         }\n     }\n \n-    int prev_version = walletInstance->GetVersion();\n-    if (gArgs.GetBoolArg(\"-upgradewallet\", fFirstRun))\n-    {\n-        int nMaxVersion = gArgs.GetArg(\"-upgradewallet\", 0);\n-        if (nMaxVersion == 0) // the -upgradewallet without argument case\n-        {\n-            walletInstance->WalletLogPrintf(\"Performing wallet upgrade to %i\\n\", FEATURE_LATEST);\n-            nMaxVersion = FEATURE_LATEST;\n-            walletInstance->SetMinVersion(FEATURE_LATEST); // permanently upgrade the wallet immediately\n-        }\n-        else\n-            walletInstance->WalletLogPrintf(\"Allowing wallet upgrade up to %i\\n\", nMaxVersion);\n-        if (nMaxVersion < walletInstance->GetVersion())\n-        {\n-            chain.initError(_(\"Cannot downgrade wallet\"));\n-            return nullptr;\n-        }\n-        walletInstance->SetMaxVersion(nMaxVersion);\n-    }\n-\n-    // Upgrade to HD if explicit upgrade\n     if (gArgs.GetBoolArg(\"-upgradewallet\", false)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r277149385",
      "id" : 277149385,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzE0OTM4NQ==",
      "original_commit_id" : "d9a66f9ed63ea73eae85665ca6c52bc27b4870d4",
      "original_line" : 4044,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 228894089,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277149385",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r277200284"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277200284"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That part is completely redundant. It just sets the wallet version but `SetMinVersion` is already called below in the `if (fFirstRun)` block. Furthermore, that call forces the wallet version to be the latest version so whatever version number specified for `-upgradewallet` that would have been set is overridden anyways.",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-04-22T03:48:53Z",
      "diff_hunk" : "@@ -4041,64 +4041,10 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n         }\n     }\n \n-    int prev_version = walletInstance->GetVersion();\n-    if (gArgs.GetBoolArg(\"-upgradewallet\", fFirstRun))\n-    {\n-        int nMaxVersion = gArgs.GetArg(\"-upgradewallet\", 0);\n-        if (nMaxVersion == 0) // the -upgradewallet without argument case\n-        {\n-            walletInstance->WalletLogPrintf(\"Performing wallet upgrade to %i\\n\", FEATURE_LATEST);\n-            nMaxVersion = FEATURE_LATEST;\n-            walletInstance->SetMinVersion(FEATURE_LATEST); // permanently upgrade the wallet immediately\n-        }\n-        else\n-            walletInstance->WalletLogPrintf(\"Allowing wallet upgrade up to %i\\n\", nMaxVersion);\n-        if (nMaxVersion < walletInstance->GetVersion())\n-        {\n-            chain.initError(_(\"Cannot downgrade wallet\"));\n-            return nullptr;\n-        }\n-        walletInstance->SetMaxVersion(nMaxVersion);\n-    }\n-\n-    // Upgrade to HD if explicit upgrade\n     if (gArgs.GetBoolArg(\"-upgradewallet\", false)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r277200284",
      "id" : 277200284,
      "in_reply_to_id" : 277149385,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NzIwMDI4NA==",
      "original_commit_id" : "d9a66f9ed63ea73eae85665ca6c52bc27b4870d4",
      "original_line" : 4044,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 228949792,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/277200284",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've done some commit reorganization as suggested by @luke-jr so this should be easier to review now.",
      "created_at" : "2019-04-22T04:25:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-485320969",
      "id" : 485320969,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTMyMDk2OQ==",
      "updated_at" : "2019-04-22T04:25:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485320969",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r301618241"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301618241"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This comment isnt related to the lock, is it ?",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-07-09T14:30:07Z",
      "diff_hunk" : "@@ -4315,6 +4254,66 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     return walletInstance;\n }\n \n+bool CWallet::UpgradeWallet(int version, std::string& out)\n+{\n+    int prev_version = GetVersion();\n+    int nMaxVersion = version;\n+    if (nMaxVersion == 0) // the -upgradewallet without argument case\n+    {\n+        WalletLogPrintf(\"Performing wallet upgrade to %i\\n\", FEATURE_LATEST);\n+        nMaxVersion = FEATURE_LATEST;\n+        SetMinVersion(FEATURE_LATEST); // permanently upgrade the wallet immediately\n+    }\n+    else\n+        WalletLogPrintf(\"Allowing wallet upgrade up to %i\\n\", nMaxVersion);\n+    if (nMaxVersion < GetVersion())\n+    {\n+        out = _(\"Cannot downgrade wallet\");\n+        return false;\n+    }\n+    SetMaxVersion(nMaxVersion);\n+\n+    // Upgrade to HD if explicit upgrade\n+    LOCK(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r301618241",
      "id" : 301618241,
      "line" : 4113,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTYxODI0MQ==",
      "original_commit_id" : "30b71d308e944942c5c39bb13f073e63356e1b86",
      "original_line" : 4113,
      "original_position" : 92,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 68,
      "pull_request_review_id" : 259542078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301618241",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r301787825"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301787825"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2019-07-09T20:50:06Z",
      "diff_hunk" : "@@ -4315,6 +4254,66 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     return walletInstance;\n }\n \n+bool CWallet::UpgradeWallet(int version, std::string& out)\n+{\n+    int prev_version = GetVersion();\n+    int nMaxVersion = version;\n+    if (nMaxVersion == 0) // the -upgradewallet without argument case\n+    {\n+        WalletLogPrintf(\"Performing wallet upgrade to %i\\n\", FEATURE_LATEST);\n+        nMaxVersion = FEATURE_LATEST;\n+        SetMinVersion(FEATURE_LATEST); // permanently upgrade the wallet immediately\n+    }\n+    else\n+        WalletLogPrintf(\"Allowing wallet upgrade up to %i\\n\", nMaxVersion);\n+    if (nMaxVersion < GetVersion())\n+    {\n+        out = _(\"Cannot downgrade wallet\");\n+        return false;\n+    }\n+    SetMaxVersion(nMaxVersion);\n+\n+    // Upgrade to HD if explicit upgrade\n+    LOCK(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r301787825",
      "id" : 301787825,
      "in_reply_to_id" : 301618241,
      "line" : 4113,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMTc4NzgyNQ==",
      "original_commit_id" : "30b71d308e944942c5c39bb13f073e63356e1b86",
      "original_line" : 4113,
      "original_position" : 92,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 68,
      "pull_request_review_id" : 259752105,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-13T17:36:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/301787825",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2019-07-09T20:50:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-509802035",
      "id" : 509802035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTgwMjAzNQ==",
      "updated_at" : "2019-07-09T20:50:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509802035",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-08-02T16:26:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-517763617",
      "id" : 517763617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNzc2MzYxNw==",
      "updated_at" : "2019-08-02T16:26:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/517763617",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-10-21T13:33:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-544516572",
      "id" : 544516572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NDUxNjU3Mg==",
      "updated_at" : "2019-10-21T13:33:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544516572",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-10-29T13:21:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-547416027",
      "id" : 547416027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NzQxNjAyNw==",
      "updated_at" : "2019-10-29T13:21:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/547416027",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-11-04T16:02:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-549421965",
      "id" : 549421965,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTQyMTk2NQ==",
      "updated_at" : "2019-11-04T16:02:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549421965",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This is currently getting messed up by the ScriptPubKeyMan changes. Will fix, rebase, and address comments after ScriptPubKeyMan is fully introduced.",
      "created_at" : "2019-11-04T18:44:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-549491984",
      "id" : 549491984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTQ5MTk4NA==",
      "updated_at" : "2019-11-04T18:44:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549491984",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@achow101, could you please rebase your patches?",
      "created_at" : "2019-11-30T11:30:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-559952224",
      "id" : 559952224,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTk1MjIyNA==",
      "updated_at" : "2019-11-30T11:30:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559952224",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1184492?v=4",
         "events_url" : "https://api.github.com/users/codewiz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/codewiz/followers",
         "following_url" : "https://api.github.com/users/codewiz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/codewiz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/codewiz",
         "id" : 1184492,
         "login" : "codewiz",
         "node_id" : "MDQ6VXNlcjExODQ0OTI=",
         "organizations_url" : "https://api.github.com/users/codewiz/orgs",
         "received_events_url" : "https://api.github.com/users/codewiz/received_events",
         "repos_url" : "https://api.github.com/users/codewiz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/codewiz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/codewiz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/codewiz"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Will fix, rebase, and address comments after ScriptPubKeyMan is fully introduced.",
      "created_at" : "2019-12-01T02:32:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-560042719",
      "id" : 560042719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MDA0MjcxOQ==",
      "updated_at" : "2019-12-01T02:32:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/560042719",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've rebased and fixed this up a bit, but it does kind of conflict with the ScriptPubKeyMan changes.",
      "created_at" : "2019-12-04T01:17:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-561430782",
      "id" : 561430782,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MTQzMDc4Mg==",
      "updated_at" : "2019-12-04T01:17:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/561430782",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2020-01-30T06:08:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-580098544",
      "id" : 580098544,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDA5ODU0NA==",
      "updated_at" : "2020-01-30T06:08:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580098544",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-03-31T13:17:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-606620674",
      "id" : 606620674,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjYyMDY3NA==",
      "updated_at" : "2020-03-31T13:17:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606620674",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Happy to review this once rebased as there are still users broken after multiple releases (it's been almost a year now... :/), see https://github.com/bitcoin/bitcoin/issues/16091.",
      "created_at" : "2020-03-31T13:24:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-606624866",
      "id" : 606624866,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjYyNDg2Ng==",
      "updated_at" : "2020-03-31T13:24:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606624866",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-04-06T21:00:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-610034116",
      "id" : 610034116,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxMDAzNDExNg==",
      "updated_at" : "2020-04-06T21:00:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/610034116",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Maybe split out the first commit (move-only) as a separate pull, to cut down on the conflicts in the future?",
      "created_at" : "2020-04-06T21:24:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#issuecomment-610044967",
      "id" : 610044967,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15761",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxMDA0NDk2Nw==",
      "updated_at" : "2020-04-06T21:25:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/610044967",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r410878408"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410878408"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit 1e48796c99b63aa8fa8451ce7b0c20759ea43500\r\n\r\nThis is a bug and it needs to call walletInstance->UpgradeWallet, but I see the code is removed in the next commit anyway",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2020-04-19T11:02:58Z",
      "diff_hunk" : "@@ -3831,7 +3831,7 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     }\n \n     if (gArgs.GetBoolArg(\"-upgradewallet\", false)) {\n-        if (!UpgradeWallet(walletInstance, gArgs.GetBoolArg(\"-upgradewallet\", 0), error, warnings)) {\n+        if (!UpgradeWallet(gArgs.GetBoolArg(\"-upgradewallet\", 0), error, warnings)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r410878408",
      "id" : 410878408,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3ODQwOA==",
      "original_commit_id" : "1e48796c99b63aa8fa8451ce7b0c20759ea43500",
      "original_line" : 3834,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 396003989,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-19T11:05:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410878408",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r410878661"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410878661"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            {\"version\", RPCArg::Type::NUM, /* default */ strprintf(\"%d\", WalletFeature::LATEST), \"The version number to upgrade to. Default is the latest wallet version\"}\r\n```\r\n\r\nUnrelated nit for future cleanup: This should probably be scoped and not in the global namespace",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2020-04-19T11:04:19Z",
      "diff_hunk" : "@@ -4245,6 +4245,45 @@ UniValue walletcreatefundedpsbt(const JSONRPCRequest& request)\n     return result;\n }\n \n+static UniValue upgradewallet(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp)) {\n+        return NullUniValue;\n+    }\n+\n+    RPCHelpMan{\"upgradewallet\",\n+        \"\\nUpgrade the wallet. Upgrades to the latest version if no version number is specified\\n\"\n+        \"New keys may be generated and a new wallet backup will need to be made.\",\n+        {\n+            {\"version\", RPCArg::Type::NUM, /* default */ strprintf(\"%d\", FEATURE_LATEST), \"The version number to upgrade to. Default is the latest wallet version\"}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r410878661",
      "id" : 410878661,
      "line" : 4261,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3ODY2MQ==",
      "original_commit_id" : "92263cce5b6c6b66296dadda5f29724611db0160",
      "original_line" : 4261,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 35,
      "pull_request_review_id" : 396003989,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-19T11:05:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410878661",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r411393493"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/411393493"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Luckily it doesn't compile:\r\n\r\n```\r\nwallet/wallet.cpp:3831:14: error: call to non-static member function without an object argument\r\n        if (!UpgradeWallet(gArgs.GetBoolArg(\"-upgradewallet\", 0), error, warnings)) {\r\n             ^~~~~~~~~~~~~\r\n1 error generated.\r\n",
      "commit_id" : "0d32d661481f099af572e7a08a50e17bcc165c44",
      "created_at" : "2020-04-20T13:50:40Z",
      "diff_hunk" : "@@ -3831,7 +3831,7 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     }\n \n     if (gArgs.GetBoolArg(\"-upgradewallet\", false)) {\n-        if (!UpgradeWallet(walletInstance, gArgs.GetBoolArg(\"-upgradewallet\", 0), error, warnings)) {\n+        if (!UpgradeWallet(gArgs.GetBoolArg(\"-upgradewallet\", 0), error, warnings)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15761#discussion_r411393493",
      "id" : 411393493,
      "in_reply_to_id" : 410878408,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTM5MzQ5Mw==",
      "original_commit_id" : "1e48796c99b63aa8fa8451ce7b0c20759ea43500",
      "original_line" : 3834,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 396471566,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15761",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-20T13:50:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/411393493",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
