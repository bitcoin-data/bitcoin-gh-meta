[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It seems that ProcessImportDescriptor doesn't find any pubkeys in this descriptor (map_pubkeys is empty.) I suspect the first one appearing to be have origin info is a red herring -- I think I independently imported it by itself earlier, when testing other stuff.",
      "created_at" : "2019-04-04T06:02:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15743#issuecomment-479761859",
      "id" : 479761859,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15743",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3OTc2MTg1OQ==",
      "updated_at" : "2019-04-04T06:02:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/479761859",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ok, the problem is indeed that ExpandHelper does not extract pubkeys from multisig descriptors. It does from single-key descriptors, but seemingly sort of by accident. MakeScripts on single-key descriptors fills in the pubkey into the FlatSigningProvider, as well as making the scripts. MakeScripts on a multisig descriptor does not. So even though ExpandHelper does not add pubkeys to the FlatSigningProvider, MakeScripts does (usually), so they make it in there anyway.\r\n\r\nThis logic seems kind of tangled, and it's not clear to me exactly what the right thing is to do here.",
      "created_at" : "2019-04-04T07:01:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15743#issuecomment-479775719",
      "id" : 479775719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15743",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3OTc3NTcxOQ==",
      "updated_at" : "2019-04-04T07:01:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/479775719",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa, it looks like you wrote this -- want to shed light?\r\n\r\nSee e.g. https://github.com/bitcoin/bitcoin/commit/11e0fd8d66677a92b6d12a39d0a26f1b39d9a46e -- you note that this is only required for public key descriptor types, but I think you missed that multisig is one such. You also edited the comment for MakeScripts to mention origin info, but this confuses me because MakeScripts doesn't seem to handle that, that gets handled in ExpandHelper.",
      "created_at" : "2019-04-04T07:06:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15743#issuecomment-479777146",
      "id" : 479777146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15743",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3OTc3NzE0Ng==",
      "updated_at" : "2019-04-04T07:06:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/479777146",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gwillen No, for multisig we intentionally do not import the public keys:\r\n* It's unnecessary; we only need pubkeys imported if they'd be encountered in hashed form. For multisig scripts, they appear in full as public keys in the (known) script.\r\n* It's damaging; importing the public keys would imply making payments to those keys themselves (outside of a multisig context) treated as watched, setting the user up to be scammed.\r\n\r\nI'm going to investigate why the origin info disappears and why importmultisig gives a weird warning; perhaps those are indirect side effects of not importing the pubkey.",
      "created_at" : "2019-04-04T15:02:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15743#issuecomment-479934931",
      "id" : 479934931,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15743",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3OTkzNDkzMQ==",
      "updated_at" : "2019-04-04T15:03:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/479934931",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa Importmultisig gives a weird warning because it warns if (1) you import watchonly and (2) you have private keys for all the pubkeys you import.\r\n\r\nSince for multisig we import zero pubkeys, we always (trivially) have the private keys for all of them, so it warns that we are importing something watchonly even though it is \"spendable\" since we have \"all\" the private keys.",
      "created_at" : "2019-04-04T17:57:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15743#issuecomment-480000737",
      "id" : 480000737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15743",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDAwMDczNw==",
      "updated_at" : "2019-04-04T17:57:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480000737",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "My assumption was that key origin info has to be attached to a key, so that not importing a key will prevent the origin info from being used. That's why I was focused on the keys not being imported. ",
      "created_at" : "2019-04-04T18:05:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/15743#issuecomment-480003510",
      "id" : 480003510,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15743",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDAwMzUxMA==",
      "updated_at" : "2019-04-04T18:05:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480003510",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   }
]
