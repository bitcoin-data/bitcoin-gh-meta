{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "I am testing a simple escrow transaction where the sender gets to send the UTXO back to himself after 512 seconds (1 block in CSV).\r\nnSequence = the token in redeem script = 4194305. \r\nusing decoderawtransaction & manually parsing the hex data, it looks like there are no errors. \r\nHave searched for the error message in the codebase and am not able to figure out where 'unknown error' may be indicating. \r\nis this a bug? or am I just missing something? thanks!  \r\n\r\nfor easy readability, I've attached my parsed version of the transaction hex at the end.  \r\n\r\n```\r\n$ bitcoin-cli -regtest sendrawtransaction \r\n02000000013246884b0078951ca69508a9bd6667b16bc8967edd1b01378c010aae6fac36b901000000bf00473044022054b2af907f7be9a1719869db04acf5171c958fcbeda6b8bc8bd5052330fc88b60220\r\n2592fe1bdbcdcb4b132505a265cf7d55efdf9d2b8de7a83ab786c29c7ab9ab9001004c7363522102e28\r\n87490bd940ef9122575269db1e4d91eeacc2fd85f61b06e443ddd6414736b210281cd7c6b17e5a62786b2f1f4fa0f71126c39540129e7692dabde56d601c1fc3d52ae6703010040b2752102e2887490bd940ef9122575269db1e4d91eeacc2fd85f61b06e443ddd6414736bac6801004000014060e429010000001976a91492d85871fe16cac1cf847ee1b88b9973907670e788ac00000000\r\n```\r\n```\r\nerror code: -26\r\nerror message:\r\n64: non-mandatory-script-verify-flag (unknown error)\r\n```\r\n\r\n<!--- What behavior did you expect? -->\r\nI expected the transaction to be broadcast successfully since the UTXO was clearly more than 512 seconds old by the time I made my numerous attempts. \r\n\r\nI have checked the script works with the btcdeb debugger, which skipped the sequence check. \r\nSo it shouldn't be an issue with the signature, or the conditional part of the script. It should be an issue with CSV. \r\n\r\n<!--- What was the actual behavior (provide screenshots if the issue is GUI-related)? -->\r\n\r\n<!--- How reliably can you reproduce the issue, what are the steps to do so? -->\r\n\r\n<!-- What version of Bitcoin Core are you using, where did you get it (website, self-compiled, etc)? -->\r\n```\r\n$ bitcoin-cli -regtest getinfo \r\n{\r\n  \"deprecation-warning\": \"WARNING: getinfo is deprecated and will be fully removed in 0.16. Projects should transition to using getblockchaininfo, getnetworkinfo, and getwalletinfo before upgrading to 0.16\",\r\n  \"version\": 150100,\r\n  \"protocolversion\": 70015,\r\n  \"walletversion\": 139900,\r\n  \"balance\": 14699.99972510,\r\n  \"blocks\": 100609,\r\n  \"timeoffset\": 0,\r\n  \"connections\": 0,\r\n  \"proxy\": \"\",\r\n  \"difficulty\": 4.656542373906925e-10,\r\n  \"testnet\": false,\r\n  \"keypoololdest\": 1522968861,\r\n  \"keypoolsize\": 1999,\r\n  \"paytxfee\": 0.00000000,\r\n  \"relayfee\": 0.00001000,\r\n  \"errors\": \"\"\r\n}\r\n```\r\n\r\n<!-- What type of machine are you observing the error on (OS/CPU and disk type)? -->\r\nMacOS, 2.6 GHz Intel Core i5, SSD \r\n\r\n<!-- Any extra information that might be useful in the debugging process. -->\r\n<!--- This is normally the contents of a `debug.log` or `config.log` file. Raw text or a link to a pastebin type site are preferred. -->\r\n```\r\n\r\nbitcoin-cli -regtest decoderawtransaction 02000000013246884b0078951ca69508a9bd6667b16bc8967edd1b01378c010aae6fac36b901000000bf00473044022054b2af907f7be9a1719869db04acf5171c958fcbeda6b8bc8bd5052330fc88b602202592fe1bdbcdcb4b132505a265cf7d55efdf9d2b8de7a83ab786c29c7ab9ab9001004c7363522102e2887490bd940ef9122575269db1e4d91eeacc2fd85f61b06e443ddd6414736b210281cd7c6b17e5a62786b2f1f4fa0f71126c39540129e7692dabde56d601c1fc3d52ae6703010040b2752102e2887490bd940ef9122575269db1e4d91eeacc2fd85f61b06e443ddd6414736bac6801004000014060e429010000001976a91492d85871fe16cac1cf847ee1b88b9973907670e788ac00000000  \r\n{\r\n  \"txid\": \"7f196d44abc0fe0c363b087c8d4dfd690f73a0c25c39e15c194f1addc371b1cf\",\r\n  \"hash\": \"7f196d44abc0fe0c363b087c8d4dfd690f73a0c25c39e15c194f1addc371b1cf\",\r\n  \"version\": 2,\r\n  \"size\": 276,\r\n  \"vsize\": 276,\r\n  \"locktime\": 0,\r\n  \"vin\": [\r\n    {\r\n      \"txid\": \"b936ac6fae0a018c37011bdd7e96c86bb16766bda90895a61c9578004b884632\",\r\n      \"vout\": 1,\r\n      \"scriptSig\": {\r\n        \"asm\": \"0 3044022054b2af907f7be9a1719869db04acf5171c958fcbeda6b8bc8bd5052330fc88b602202592fe1bdbcdcb4b132505a265cf7d55efdf9d2b8de7a83ab786c29c7ab9ab90[ALL] 0 63522102e2887490bd940ef9122575269db1e4d91eeacc2fd85f61b06e443ddd6414736b210281cd7c6b17e5a62786b2f1f4fa0f71126c39540129e7692dabde56d601c1fc3d52ae6703010040b2752102e2887490bd940ef9122575269db1e4d91eeacc2fd85f61b06e443ddd6414736bac68\",\r\n        \"hex\": \"00473044022054b2af907f7be9a1719869db04acf5171c958fcbeda6b8bc8bd5052330fc88b602202592fe1bdbcdcb4b132505a265cf7d55efdf9d2b8de7a83ab786c29c7ab9ab9001004c7363522102e2887490bd940ef9122575269db1e4d91eeacc2fd85f61b06e443ddd6414736b210281cd7c6b17e5a62786b2f1f4fa0f71126c39540129e7692dabde56d601c1fc3d52ae6703010040b2752102e2887490bd940ef9122575269db1e4d91eeacc2fd85f61b06e443ddd6414736bac68\"\r\n      },\r\n      \"sequence\": 4194305\r\n    }\r\n  ],\r\n  \"vout\": [\r\n    {\r\n      \"value\": 49.97800000,\r\n      \"n\": 0,\r\n      \"scriptPubKey\": {\r\n        \"asm\": \"OP_DUP OP_HASH160 92d85871fe16cac1cf847ee1b88b9973907670e7 OP_EQUALVERIFY OP_CHECKSIG\",\r\n        \"hex\": \"76a91492d85871fe16cac1cf847ee1b88b9973907670e788ac\",\r\n        \"reqSigs\": 1,\r\n        \"type\": \"pubkeyhash\",\r\n        \"addresses\": [\r\n          \"mtuQ81VrJ4eXmv8igrdkQXd9WF7x8pFnns\"\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n[finaltransaction2.txt](https://github.com/bitcoin/bitcoin/files/1930442/finaltransaction2.txt)",
   "closed_at" : "2018-04-20T15:26:19Z",
   "closed_by" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/26187282?v=4",
      "events_url" : "https://api.github.com/users/annjieching/events{/privacy}",
      "followers_url" : "https://api.github.com/users/annjieching/followers",
      "following_url" : "https://api.github.com/users/annjieching/following{/other_user}",
      "gists_url" : "https://api.github.com/users/annjieching/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/annjieching",
      "id" : 26187282,
      "login" : "annjieching",
      "node_id" : "MDQ6VXNlcjI2MTg3Mjgy",
      "organizations_url" : "https://api.github.com/users/annjieching/orgs",
      "received_events_url" : "https://api.github.com/users/annjieching/received_events",
      "repos_url" : "https://api.github.com/users/annjieching/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/annjieching/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/annjieching/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/annjieching"
   },
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13035/comments",
   "created_at" : "2018-04-20T02:40:20Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13035/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/13035",
   "id" : 316106713,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13035/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWUzMTYxMDY3MTM=",
   "number" : 13035,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Error sending transaction from P2SH with CSV & conditions",
   "updated_at" : "2018-04-20T15:26:19Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13035",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/26187282?v=4",
      "events_url" : "https://api.github.com/users/annjieching/events{/privacy}",
      "followers_url" : "https://api.github.com/users/annjieching/followers",
      "following_url" : "https://api.github.com/users/annjieching/following{/other_user}",
      "gists_url" : "https://api.github.com/users/annjieching/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/annjieching",
      "id" : 26187282,
      "login" : "annjieching",
      "node_id" : "MDQ6VXNlcjI2MTg3Mjgy",
      "organizations_url" : "https://api.github.com/users/annjieching/orgs",
      "received_events_url" : "https://api.github.com/users/annjieching/received_events",
      "repos_url" : "https://api.github.com/users/annjieching/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/annjieching/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/annjieching/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/annjieching"
   }
}
