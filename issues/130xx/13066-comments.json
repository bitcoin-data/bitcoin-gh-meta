[
   {
      "author_association" : "MEMBER",
      "body" : "> The cron job that runs every day would fail because of git checkout a single commit, not a branch.\r\n\r\nMind to elaborate why it wouldn't work on a \"single commit\"?",
      "created_at" : "2018-04-24T13:35:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-383932454",
      "id" : 383932454,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-24T13:35:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383932454",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`git rev-parse --abbrev-ref HEAD` does not work with commit, it always returns `HEAD`.\r\nAnd git would not return to latest commit after the script.\r\nBut I don't know if this is the exact reason. I just test on my PC, the script failed to check signature at random commit.",
      "created_at" : "2018-04-24T13:49:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-383937635",
      "id" : 383937635,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-24T14:09:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383937635",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "> Also, I modify the current shell script to python, it makes the script speed up a lot.\r\n> The python code tree_sha512sum was copied from github-merge.py\r\n\r\nThanks! Yes, the current implementation has been slow especially the treehash512 checking, my implementation from `github-merge.py` only uses a single call to `ls-tree` which makes it more efficient.\r\n\r\nConcept ACK.\r\n",
      "created_at" : "2018-04-24T15:27:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-383975065",
      "id" : 383975065,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-24T15:27:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383975065",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think we should remove the shell script after this has been converted to python. Objections, @TheBlueMatt ?",
      "created_at" : "2018-04-24T15:35:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-383977612",
      "id" : 383977612,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-24T15:35:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383977612",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183781782"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183781782"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Shouldn't this be `INITIAL_COMMIT` instead of `HEAD`?",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-04-24T15:40:28Z",
      "diff_hunk" : "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+import os\n+import sys\n+from sys import stdin,stdout,stderr\n+import subprocess\n+from subprocess import PIPE\n+import hashlib\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split() # perms, 'blob', blobid\n+        assert(metadata[1] == b'blob')\n+        name = line[name_sep+1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=PIPE, stdin=PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert(reply[0] == blob and reply[1] == b'blob')\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert(p.stdout.read(1) == b'\\n') # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()\n+    if p.wait():\n+        raise IOError('Non-zero return value executing git cat-file')\n+    return overall.hexdigest()\n+\n+def main():\n+    dir = os.path.dirname(os.path.abspath(__file__))\n+    print(\"Using verify-commits data from \" + dir)\n+\n+    VERIFIED_ROOT = open(dir + \"/trusted-git-root\", \"r\").read().splitlines()[0]\n+    VERIFIED_SHA512_ROOT = open(dir + \"/trusted-sha512-root-commit\", \"r\").read().splitlines()[0]\n+    REVSIG_ALLOWED = open(dir + \"/allow-revsig-commits\", \"r\").read().splitlines()\n+    DIRTY_ALLOWED = open(dir + \"/allow-dirty-commits\", \"r\").read().splitlines()\n+\n+    CURRENT_COMMIT = \"HEAD\" if len(sys.argv) == 1 else sys.argv[1]\n+\n+    if ' ' in CURRENT_COMMIT:\n+        print(\"Commit must not contain spaces?\", file=sys.stderr)\n+        exit(1)\n+\n+    VERIFY_TREE = True if len(sys.argv) >= 3 and sys.argv[2] == \"--tree-check\" else False\n+    NO_SHA1 = True\n+    PREV_COMMIT = \"\"\n+    INITIAL_COMMIT = CURRENT_COMMIT\n+\n+    BRANCH = subprocess.check_output([GIT,'rev-parse','--abbrev-ref','HEAD'], universal_newlines=True).splitlines()[0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183781782",
      "id" : 183781782,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4Mzc4MTc4Mg==",
      "original_commit_id" : "902e9f986685d9e428221f7b251b81fa0c3e4fca",
      "original_position" : 80,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 114845376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183781782",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183783951"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183783951"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's a direct transcription from the shell script at least:\r\n```bash\r\nBRANCH=\"$(git rev-parse --abbrev-ref HEAD)\"\r\n```",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-04-24T15:46:15Z",
      "diff_hunk" : "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+import os\n+import sys\n+from sys import stdin,stdout,stderr\n+import subprocess\n+from subprocess import PIPE\n+import hashlib\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split() # perms, 'blob', blobid\n+        assert(metadata[1] == b'blob')\n+        name = line[name_sep+1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=PIPE, stdin=PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert(reply[0] == blob and reply[1] == b'blob')\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert(p.stdout.read(1) == b'\\n') # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()\n+    if p.wait():\n+        raise IOError('Non-zero return value executing git cat-file')\n+    return overall.hexdigest()\n+\n+def main():\n+    dir = os.path.dirname(os.path.abspath(__file__))\n+    print(\"Using verify-commits data from \" + dir)\n+\n+    VERIFIED_ROOT = open(dir + \"/trusted-git-root\", \"r\").read().splitlines()[0]\n+    VERIFIED_SHA512_ROOT = open(dir + \"/trusted-sha512-root-commit\", \"r\").read().splitlines()[0]\n+    REVSIG_ALLOWED = open(dir + \"/allow-revsig-commits\", \"r\").read().splitlines()\n+    DIRTY_ALLOWED = open(dir + \"/allow-dirty-commits\", \"r\").read().splitlines()\n+\n+    CURRENT_COMMIT = \"HEAD\" if len(sys.argv) == 1 else sys.argv[1]\n+\n+    if ' ' in CURRENT_COMMIT:\n+        print(\"Commit must not contain spaces?\", file=sys.stderr)\n+        exit(1)\n+\n+    VERIFY_TREE = True if len(sys.argv) >= 3 and sys.argv[2] == \"--tree-check\" else False\n+    NO_SHA1 = True\n+    PREV_COMMIT = \"\"\n+    INITIAL_COMMIT = CURRENT_COMMIT\n+\n+    BRANCH = subprocess.check_output([GIT,'rev-parse','--abbrev-ref','HEAD'], universal_newlines=True).splitlines()[0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183783951",
      "id" : 183783951,
      "in_reply_to_id" : 183781782,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4Mzc4Mzk1MQ==",
      "original_commit_id" : "902e9f986685d9e428221f7b251b81fa0c3e4fca",
      "original_position" : 80,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 114847992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183783951",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183785186"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183785186"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No, it is a string 'HEAD', it would return a branch name. If you put a commit id, it returns nothing.",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-04-24T15:49:52Z",
      "diff_hunk" : "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+import os\n+import sys\n+from sys import stdin,stdout,stderr\n+import subprocess\n+from subprocess import PIPE\n+import hashlib\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split() # perms, 'blob', blobid\n+        assert(metadata[1] == b'blob')\n+        name = line[name_sep+1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=PIPE, stdin=PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert(reply[0] == blob and reply[1] == b'blob')\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert(p.stdout.read(1) == b'\\n') # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()\n+    if p.wait():\n+        raise IOError('Non-zero return value executing git cat-file')\n+    return overall.hexdigest()\n+\n+def main():\n+    dir = os.path.dirname(os.path.abspath(__file__))\n+    print(\"Using verify-commits data from \" + dir)\n+\n+    VERIFIED_ROOT = open(dir + \"/trusted-git-root\", \"r\").read().splitlines()[0]\n+    VERIFIED_SHA512_ROOT = open(dir + \"/trusted-sha512-root-commit\", \"r\").read().splitlines()[0]\n+    REVSIG_ALLOWED = open(dir + \"/allow-revsig-commits\", \"r\").read().splitlines()\n+    DIRTY_ALLOWED = open(dir + \"/allow-dirty-commits\", \"r\").read().splitlines()\n+\n+    CURRENT_COMMIT = \"HEAD\" if len(sys.argv) == 1 else sys.argv[1]\n+\n+    if ' ' in CURRENT_COMMIT:\n+        print(\"Commit must not contain spaces?\", file=sys.stderr)\n+        exit(1)\n+\n+    VERIFY_TREE = True if len(sys.argv) >= 3 and sys.argv[2] == \"--tree-check\" else False\n+    NO_SHA1 = True\n+    PREV_COMMIT = \"\"\n+    INITIAL_COMMIT = CURRENT_COMMIT\n+\n+    BRANCH = subprocess.check_output([GIT,'rev-parse','--abbrev-ref','HEAD'], universal_newlines=True).splitlines()[0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183785186",
      "id" : 183785186,
      "in_reply_to_id" : 183781782,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4Mzc4NTE4Ng==",
      "original_commit_id" : "902e9f986685d9e428221f7b251b81fa0c3e4fca",
      "original_position" : 80,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 114849592,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183785186",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183789095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183789095"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> 'HEAD', it would return a branch name. If you put a commit id, it returns nothing.\r\n\r\nIt always returns a commit id for me.",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-04-24T16:00:31Z",
      "diff_hunk" : "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+import os\n+import sys\n+from sys import stdin,stdout,stderr\n+import subprocess\n+from subprocess import PIPE\n+import hashlib\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split() # perms, 'blob', blobid\n+        assert(metadata[1] == b'blob')\n+        name = line[name_sep+1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=PIPE, stdin=PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert(reply[0] == blob and reply[1] == b'blob')\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert(p.stdout.read(1) == b'\\n') # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()\n+    if p.wait():\n+        raise IOError('Non-zero return value executing git cat-file')\n+    return overall.hexdigest()\n+\n+def main():\n+    dir = os.path.dirname(os.path.abspath(__file__))\n+    print(\"Using verify-commits data from \" + dir)\n+\n+    VERIFIED_ROOT = open(dir + \"/trusted-git-root\", \"r\").read().splitlines()[0]\n+    VERIFIED_SHA512_ROOT = open(dir + \"/trusted-sha512-root-commit\", \"r\").read().splitlines()[0]\n+    REVSIG_ALLOWED = open(dir + \"/allow-revsig-commits\", \"r\").read().splitlines()\n+    DIRTY_ALLOWED = open(dir + \"/allow-dirty-commits\", \"r\").read().splitlines()\n+\n+    CURRENT_COMMIT = \"HEAD\" if len(sys.argv) == 1 else sys.argv[1]\n+\n+    if ' ' in CURRENT_COMMIT:\n+        print(\"Commit must not contain spaces?\", file=sys.stderr)\n+        exit(1)\n+\n+    VERIFY_TREE = True if len(sys.argv) >= 3 and sys.argv[2] == \"--tree-check\" else False\n+    NO_SHA1 = True\n+    PREV_COMMIT = \"\"\n+    INITIAL_COMMIT = CURRENT_COMMIT\n+\n+    BRANCH = subprocess.check_output([GIT,'rev-parse','--abbrev-ref','HEAD'], universal_newlines=True).splitlines()[0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183789095",
      "id" : 183789095,
      "in_reply_to_id" : 183781782,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4Mzc4OTA5NQ==",
      "original_commit_id" : "902e9f986685d9e428221f7b251b81fa0c3e4fca",
      "original_position" : 80,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 114854418,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183789095",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "All the unclean merge commits are from 2016 or earlier. Perhaps instead there can just be a threshold that skips the validation below a certain age (say, 1 month)?",
      "created_at" : "2018-04-24T18:17:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-384030349",
      "id" : 384030349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-24T18:17:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384030349",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : ">All the unclean merge commits are from 2016 or earlier. Perhaps instead there can just be a threshold that skips the validation below a certain age (say, 1 month)?\r\n\r\nOr do we need a trusted-clean-merge-root? This can be when that merge policy start.",
      "created_at" : "2018-04-25T06:16:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-384172308",
      "id" : 384172308,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-25T06:29:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384172308",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183951335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183951335"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Well, the git version might be different. I'm using git 2.1.4",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-04-25T06:24:53Z",
      "diff_hunk" : "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+import os\n+import sys\n+from sys import stdin,stdout,stderr\n+import subprocess\n+from subprocess import PIPE\n+import hashlib\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split() # perms, 'blob', blobid\n+        assert(metadata[1] == b'blob')\n+        name = line[name_sep+1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=PIPE, stdin=PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert(reply[0] == blob and reply[1] == b'blob')\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert(p.stdout.read(1) == b'\\n') # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()\n+    if p.wait():\n+        raise IOError('Non-zero return value executing git cat-file')\n+    return overall.hexdigest()\n+\n+def main():\n+    dir = os.path.dirname(os.path.abspath(__file__))\n+    print(\"Using verify-commits data from \" + dir)\n+\n+    VERIFIED_ROOT = open(dir + \"/trusted-git-root\", \"r\").read().splitlines()[0]\n+    VERIFIED_SHA512_ROOT = open(dir + \"/trusted-sha512-root-commit\", \"r\").read().splitlines()[0]\n+    REVSIG_ALLOWED = open(dir + \"/allow-revsig-commits\", \"r\").read().splitlines()\n+    DIRTY_ALLOWED = open(dir + \"/allow-dirty-commits\", \"r\").read().splitlines()\n+\n+    CURRENT_COMMIT = \"HEAD\" if len(sys.argv) == 1 else sys.argv[1]\n+\n+    if ' ' in CURRENT_COMMIT:\n+        print(\"Commit must not contain spaces?\", file=sys.stderr)\n+        exit(1)\n+\n+    VERIFY_TREE = True if len(sys.argv) >= 3 and sys.argv[2] == \"--tree-check\" else False\n+    NO_SHA1 = True\n+    PREV_COMMIT = \"\"\n+    INITIAL_COMMIT = CURRENT_COMMIT\n+\n+    BRANCH = subprocess.check_output([GIT,'rev-parse','--abbrev-ref','HEAD'], universal_newlines=True).splitlines()[0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r183951335",
      "id" : 183951335,
      "in_reply_to_id" : 183781782,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4Mzk1MTMzNQ==",
      "original_commit_id" : "902e9f986685d9e428221f7b251b81fa0c3e4fca",
      "original_position" : 80,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 115047632,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183951335",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Test for only checking commits in one month: https://travis-ci.org/ken2812221/bitcoin/jobs/371267929",
      "created_at" : "2018-04-25T13:44:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-384291527",
      "id" : 384291527,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-25T21:05:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384291527",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r184097993"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184097993"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh yeah, that's it. To me this seems like a thing to fix (The script shouldn't depends on what version of git you are using)\r\n\r\nAlso, I still think that the correct thing to use here is `INITIAL_COMMIT`. I.e. `git log --format=\"%H\" -1 \"${INITIAL_COMMIT}\"`. Otherwise a comment might be appropriate to say why `HEAD` is used here.",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-04-25T15:13:02Z",
      "diff_hunk" : "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+import os\n+import sys\n+from sys import stdin,stdout,stderr\n+import subprocess\n+from subprocess import PIPE\n+import hashlib\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split() # perms, 'blob', blobid\n+        assert(metadata[1] == b'blob')\n+        name = line[name_sep+1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=PIPE, stdin=PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert(reply[0] == blob and reply[1] == b'blob')\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert(p.stdout.read(1) == b'\\n') # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()\n+    if p.wait():\n+        raise IOError('Non-zero return value executing git cat-file')\n+    return overall.hexdigest()\n+\n+def main():\n+    dir = os.path.dirname(os.path.abspath(__file__))\n+    print(\"Using verify-commits data from \" + dir)\n+\n+    VERIFIED_ROOT = open(dir + \"/trusted-git-root\", \"r\").read().splitlines()[0]\n+    VERIFIED_SHA512_ROOT = open(dir + \"/trusted-sha512-root-commit\", \"r\").read().splitlines()[0]\n+    REVSIG_ALLOWED = open(dir + \"/allow-revsig-commits\", \"r\").read().splitlines()\n+    DIRTY_ALLOWED = open(dir + \"/allow-dirty-commits\", \"r\").read().splitlines()\n+\n+    CURRENT_COMMIT = \"HEAD\" if len(sys.argv) == 1 else sys.argv[1]\n+\n+    if ' ' in CURRENT_COMMIT:\n+        print(\"Commit must not contain spaces?\", file=sys.stderr)\n+        exit(1)\n+\n+    VERIFY_TREE = True if len(sys.argv) >= 3 and sys.argv[2] == \"--tree-check\" else False\n+    NO_SHA1 = True\n+    PREV_COMMIT = \"\"\n+    INITIAL_COMMIT = CURRENT_COMMIT\n+\n+    BRANCH = subprocess.check_output([GIT,'rev-parse','--abbrev-ref','HEAD'], universal_newlines=True).splitlines()[0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r184097993",
      "id" : 184097993,
      "in_reply_to_id" : 183781782,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDA5Nzk5Mw==",
      "original_commit_id" : "902e9f986685d9e428221f7b251b81fa0c3e4fca",
      "original_position" : 80,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 115223718,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184097993",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r184146078"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184146078"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I use it just because the original shell script, so I change it to `git show -s --format=\"%H\" ${INITIAL_COMMIT}` now, and looks like we don't need to change the travis script.",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-04-25T17:35:11Z",
      "diff_hunk" : "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+import os\n+import sys\n+from sys import stdin,stdout,stderr\n+import subprocess\n+from subprocess import PIPE\n+import hashlib\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split() # perms, 'blob', blobid\n+        assert(metadata[1] == b'blob')\n+        name = line[name_sep+1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=PIPE, stdin=PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert(reply[0] == blob and reply[1] == b'blob')\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert(p.stdout.read(1) == b'\\n') # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()\n+    if p.wait():\n+        raise IOError('Non-zero return value executing git cat-file')\n+    return overall.hexdigest()\n+\n+def main():\n+    dir = os.path.dirname(os.path.abspath(__file__))\n+    print(\"Using verify-commits data from \" + dir)\n+\n+    VERIFIED_ROOT = open(dir + \"/trusted-git-root\", \"r\").read().splitlines()[0]\n+    VERIFIED_SHA512_ROOT = open(dir + \"/trusted-sha512-root-commit\", \"r\").read().splitlines()[0]\n+    REVSIG_ALLOWED = open(dir + \"/allow-revsig-commits\", \"r\").read().splitlines()\n+    DIRTY_ALLOWED = open(dir + \"/allow-dirty-commits\", \"r\").read().splitlines()\n+\n+    CURRENT_COMMIT = \"HEAD\" if len(sys.argv) == 1 else sys.argv[1]\n+\n+    if ' ' in CURRENT_COMMIT:\n+        print(\"Commit must not contain spaces?\", file=sys.stderr)\n+        exit(1)\n+\n+    VERIFY_TREE = True if len(sys.argv) >= 3 and sys.argv[2] == \"--tree-check\" else False\n+    NO_SHA1 = True\n+    PREV_COMMIT = \"\"\n+    INITIAL_COMMIT = CURRENT_COMMIT\n+\n+    BRANCH = subprocess.check_output([GIT,'rev-parse','--abbrev-ref','HEAD'], universal_newlines=True).splitlines()[0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r184146078",
      "id" : 184146078,
      "in_reply_to_id" : 183781782,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDE0NjA3OA==",
      "original_commit_id" : "902e9f986685d9e428221f7b251b81fa0c3e4fca",
      "original_position" : 80,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 115281291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184146078",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Squashed and delete shell script.\r\n\r\nWe can run the run the script in about 80 seconds, so can we revert fa6f12af6baa97961dc4ae03708bd52cb7918ea0?",
      "created_at" : "2018-04-25T20:50:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-384429470",
      "id" : 384429470,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-25T21:19:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384429470",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think the PR title should be \"Migrate verify-commits script to python, run in travis\" (or similar)",
      "created_at" : "2018-04-26T08:14:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-384553551",
      "id" : 384553551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-26T08:14:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384553551",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jonasschnelli Thanks",
      "created_at" : "2018-04-26T08:17:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-384554279",
      "id" : 384554279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-26T08:17:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384554279",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "I did a timing comparison locally, this is an impressive win (given that the checks are correct):\r\n```\r\ncontrib/verify-commits/verify-commits.py \r\n(all the way to dc0305d15aa02819cd4763e1efe3876d674faea7, after verifying 2627)\r\nreal    5m36.844s\r\nuser    3m52.696s\r\nsys     1m1.720s\r\n\r\ncontrib/verify-commits/verify-commits.sh \r\n(and it wasn't even completely finished yet, only up to commit 6052d509105790a26b3ad5df43dd61e7f1b24a12, after verifying 1940)\r\nreal    32m1.084s\r\nuser    25m57.068s\r\nsys     4m16.484s\r\n```",
      "created_at" : "2018-04-27T14:04:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-384979974",
      "id" : 384979974,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-27T14:04:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384979974",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "IRC discussion:\r\n> **&lt;wumpus>** ken2812221: so to be clear: the only expected difference in behavior between your python script and the shell script is that your script only verifies merges up to a certain depth?\r\n> **&lt;wumpus>** (which is a sensible change, as the shell script throws an error there, not allowing it to verify the gpg signatures deeper either)\r\n>  **&lt;ken2812221>** Yes.\r\n\r\nAs far as I see this is the case, so utACK 058d18bdf302976b6d59752ab816463c89f70404.",
      "created_at" : "2018-04-27T14:54:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-384994840",
      "id" : 384994840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-27T14:54:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384994840",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm fine with migrating this to python, but I certainly dont know python well enough to verify something that is intended to be a secure way of checking our git tree, nor maintain it in the future. If this change means I dont have to and others will, however, thats fine.",
      "created_at" : "2018-04-27T16:52:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-385029649",
      "id" : 385029649,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-27T16:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385029649",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "NACK changing the script to only verify up to N commits instead of up to a trusted root by default. Its fine to do that on travis but that obviously defeats the point of \"checking the git commits come from a trusted source and don't just have a different timestamp on them\".",
      "created_at" : "2018-04-27T16:54:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-385030243",
      "id" : 385030243,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-27T16:54:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385030243",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have two ways to do this. The first, add allow-unclean-merge-commits. The list is following.\r\n```\r\n6052d509105790a26b3ad5df43dd61e7f1b24a12\r\n3798e5de334c3deb5f71302b782f6b8fbd5087f1\r\n326ffed09bfcc209a2efd6a2ebc69edf6bd200b5\r\n97d83739db0631be5d4ba86af3616014652c00ec\r\n```\r\nThe second way is add trusted-unclean-merge-commit-root. It would be\r\n```\r\n6052d509105790a26b3ad5df43dd61e7f1b24a12\r\n```\r\n\r\n@TheBlueMatt Which way would you prefer?",
      "created_at" : "2018-04-27T20:06:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-385079930",
      "id" : 385079930,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-27T20:06:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385079930",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Given that the speedup is just based on skipping verification, I'd slightly prefer to stick around with the bash script for now and do the python transcribe in a follow up pr.",
      "created_at" : "2018-04-27T20:10:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-385081089",
      "id" : 385081089,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-27T20:10:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385081089",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke If we do the entire verification in python, it still just take 18 mins on travis.",
      "created_at" : "2018-04-27T20:16:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-385082503",
      "id" : 385082503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "updated_at" : "2018-04-27T20:16:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385082503",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've re-designed this. Now we verify all the things by default.\r\n- Add `--disable-tree-check` option, not to check SHA-512 tree\r\n- Add `--clean-merge NUMBER` option, only verify commits after &lt;NUMBER> days ago\r\n\r\nTravis running time:\r\n\r\n|option|time|\r\n|-|-|\r\n|verify-commits.py|[25m47.02s(1547.02s)](https://travis-ci.org/ken2812221/bitcoin/jobs/373321423)|\r\n|verify-commits.py --disable-tree-check|[19m10.08s(1150.08s)](https://travis-ci.org/ken2812221/bitcoin/jobs/373321423)|\r\n|verify-commits.py --clean-merge 30|[9m18.18s(558.18s)](https://travis-ci.org/ken2812221/bitcoin/jobs/373321423)|\r\n|verify-commits.py --disable-tree-check --clean-merge 30|[1m16.51s(76.51s)](https://travis-ci.org/ken2812221/bitcoin/jobs/373321423)|\r\n\r\nSince the cron job always fail, I've created a respository to verify this daily.\r\n [![Build Status](https://travis-ci.org/ken2812221/bitcoin-verify-commits.svg?branch=master)](https://travis-ci.org/ken2812221/bitcoin-verify-commits)",
      "created_at" : "2018-05-01T03:37:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-385591669",
      "id" : 385591669,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM4NTU5MTY2OQ==",
      "updated_at" : "2018-05-02T16:40:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385591669",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r186765107"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186765107"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You're already importing subprocess. Suggest you just use `subprocess.PIPE` throughout.\r\n\r\nSame for `sys.stderr` below.",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-05-08T15:16:39Z",
      "diff_hunk" : "@@ -0,0 +1,131 @@\n+#!/usr/bin/env python3\n+import argparse\n+import hashlib\n+import os\n+import subprocess\n+import sys\n+import time\n+from subprocess import PIPE",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r186765107",
      "id" : 186765107,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4Njc2NTEwNw==",
      "original_commit_id" : "e537dc7d216d586ce4dd07c91e9b5eb45866f432",
      "original_position" : 8,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 118408733,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/186765107",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194467943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194467943"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Please include a copyright notice and module docstring, eg:\r\n\r\n```python\r\n# Copyright (c) 2018 The Bitcoin Core developers\r\n# Distributed under the MIT software license, see the accompanying\r\n# file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n\"\"\"Verify commits against a trusted keys list.\"\"\"\r\n```",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-06-11T16:35:57Z",
      "diff_hunk" : "@@ -0,0 +1,131 @@\n+#!/usr/bin/env python3",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194467943",
      "id" : 194467943,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDQ2Nzk0Mw==",
      "original_commit_id" : "3ef832708661ddcfa9b38b5de68c86aeab6a9085",
      "original_position" : 1,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : 1,
      "pull_request_review_id" : 118408733,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194467943",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194468676"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194468676"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: update the comment to say that this is copied from `github-merge.py`",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-06-11T16:38:12Z",
      "diff_hunk" : "@@ -0,0 +1,131 @@\n+#!/usr/bin/env python3\n+import argparse\n+import hashlib\n+import os\n+import subprocess\n+import sys\n+import time\n+from subprocess import PIPE\n+from sys import stderr\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194468676",
      "id" : 194468676,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDQ2ODY3Ng==",
      "original_commit_id" : "3ef832708661ddcfa9b38b5de68c86aeab6a9085",
      "original_position" : 14,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : null,
      "pull_request_review_id" : 118408733,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194468676",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194469228"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194469228"
         }
      },
      "author_association" : "MEMBER",
      "body" : "A few line breaks would be helpful here!",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-06-11T16:39:57Z",
      "diff_hunk" : "@@ -0,0 +1,131 @@\n+#!/usr/bin/env python3\n+import argparse\n+import hashlib\n+import os\n+import subprocess\n+import sys\n+import time\n+from subprocess import PIPE\n+from sys import stderr\n+\n+GIT = os.getenv('GIT','git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split() # perms, 'blob', blobid\n+        assert(metadata[1] == b'blob')\n+        name = line[name_sep+1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=PIPE, stdin=PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert(reply[0] == blob and reply[1] == b'blob')\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert(p.stdout.read(1) == b'\\n') # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()\n+    if p.wait():\n+        raise IOError('Non-zero return value executing git cat-file')\n+    return overall.hexdigest()\n+\n+def main():",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194469228",
      "id" : 194469228,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDQ2OTIyOA==",
      "original_commit_id" : "3ef832708661ddcfa9b38b5de68c86aeab6a9085",
      "original_position" : 62,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : 68,
      "pull_request_review_id" : 118408733,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T14:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194469228",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery Thanks for your review! I would like to take your nits.",
      "created_at" : "2018-06-12T12:19:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-396569061",
      "id" : 396569061,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjU2OTA2MQ==",
      "updated_at" : "2018-06-12T12:19:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396569061",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I would like to take your nits.\r\n\r\nGreat! Feel free to squash the changes into your commit.\r\n\r\nI've now tested this and verified that:\r\n\r\n- `f8feaa4636260b599294c7285bcf1c8b7737f74e` and `8040ae6fc576e9504186f2ae3ff2c8125de1095c` do have missing/incorrect Tree_SHA512 digests in the git logs, and do not contain malicious code.\r\n- `6052d509105790a26b3ad5df43dd61e7f1b24a12`, `3798e5de334c3deb5f71302b782f6b8fbd5087f1`, `326ffed09bfcc209a2efd6a2ebc69edf6bd200b5` and `97d83739db0631be5d4ba86af3616014652c00ec` are not clean merges and do not contain malicious code.\r\n\r\nTested ACK 8c1515e4393afe12d76f12565f712ca8b26152a8.",
      "created_at" : "2018-06-12T14:31:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-396611171",
      "id" : 396611171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjYxMTE3MQ==",
      "updated_at" : "2018-06-12T14:31:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396611171",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Squashed",
      "created_at" : "2018-06-12T14:49:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-396617529",
      "id" : 396617529,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjYxNzUyOQ==",
      "updated_at" : "2018-06-12T14:49:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396617529",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm still wondering why migrate to python? It seems like most of the new code just does the same stuff that the old code did but instead of bash pipes it does a bunch of stdin/out reading, which I find way less readable.\r\n\r\nDefinitely Concept ACK the allow-unclean-merge-commits file and just making travis only go back a ways instead of doing a full check.",
      "created_at" : "2018-06-12T15:06:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-396623553",
      "id" : 396623553,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjYyMzU1Mw==",
      "updated_at" : "2018-06-12T15:06:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396623553",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "node_id" : "MDQ6VXNlcjY0OTI0Ng==",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@TheBlueMatt The major reason I do this PR is that bash script is too slow. It took about three hours to verify commits to trusted git root and unclean merges with bash and took about one hour with python on my PC. \r\n\r\nAlso, current bash script only check Tree-SHA512 with commit HEAD, it would take even longer if we check it every commit.",
      "created_at" : "2018-06-12T15:15:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#issuecomment-396627068",
      "id" : 396627068,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13066",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjYyNzA2OA==",
      "updated_at" : "2018-06-12T15:21:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396627068",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194793674"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194793674"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It seems possible this code could hang depending on internals of git or the operating system, if reads from stdin are buffered. I think moving this stdin.close() line up to where the stdin.flush() is could avoid this. Another option is to use https://docs.python.org/3/library/subprocess.html#subprocess.Popen.communicate, which avoids deadlocks of this type.",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-06-12T15:52:28Z",
      "diff_hunk" : "@@ -0,0 +1,155 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Verify commits against a trusted keys list.\"\"\"\n+import argparse\n+import hashlib\n+import os\n+import subprocess\n+import sys\n+import time\n+\n+GIT = os.getenv('GIT', 'git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    \"\"\"Calculate the Tree-sha512 for the commit.\n+\n+    This is copied from github-merge.py.\"\"\"\n+\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split()  # perms, 'blob', blobid\n+        assert metadata[1] == b'blob'\n+        name = line[name_sep + 1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=subprocess.PIPE, stdin=subprocess.PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert reply[0] == blob and reply[1] == b'blob'\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert p.stdout.read(1) == b'\\n'  # ignore LF that follows blob data\n+        # update overall hash with file hash\n+        overall.update(dig.encode(\"utf-8\"))\n+        overall.update(\"  \".encode(\"utf-8\"))\n+        overall.update(f)\n+        overall.update(\"\\n\".encode(\"utf-8\"))\n+    p.stdin.close()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194793674",
      "id" : 194793674,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDc5MzY3NA==",
      "original_commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "original_position" : 63,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : 63,
      "pull_request_review_id" : 128032306,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T15:56:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194793674",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194794892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194794892"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It's better to move code that has side effects outside of assert statements, because assert statements are stripped out with python's `-O` option.",
      "commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "created_at" : "2018-06-12T15:55:36Z",
      "diff_hunk" : "@@ -0,0 +1,155 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Verify commits against a trusted keys list.\"\"\"\n+import argparse\n+import hashlib\n+import os\n+import subprocess\n+import sys\n+import time\n+\n+GIT = os.getenv('GIT', 'git')\n+\n+def tree_sha512sum(commit='HEAD'):\n+    \"\"\"Calculate the Tree-sha512 for the commit.\n+\n+    This is copied from github-merge.py.\"\"\"\n+\n+    # request metadata for entire tree, recursively\n+    files = []\n+    blob_by_name = {}\n+    for line in subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', commit]).splitlines():\n+        name_sep = line.index(b'\\t')\n+        metadata = line[:name_sep].split()  # perms, 'blob', blobid\n+        assert metadata[1] == b'blob'\n+        name = line[name_sep + 1:]\n+        files.append(name)\n+        blob_by_name[name] = metadata[2]\n+\n+    files.sort()\n+    # open connection to git-cat-file in batch mode to request data for all blobs\n+    # this is much faster than launching it per file\n+    p = subprocess.Popen([GIT, 'cat-file', '--batch'], stdout=subprocess.PIPE, stdin=subprocess.PIPE)\n+    overall = hashlib.sha512()\n+    for f in files:\n+        blob = blob_by_name[f]\n+        # request blob\n+        p.stdin.write(blob + b'\\n')\n+        p.stdin.flush()\n+        # read header: blob, \"blob\", size\n+        reply = p.stdout.readline().split()\n+        assert reply[0] == blob and reply[1] == b'blob'\n+        size = int(reply[2])\n+        # hash the blob data\n+        intern = hashlib.sha512()\n+        ptr = 0\n+        while ptr < size:\n+            bs = min(65536, size - ptr)\n+            piece = p.stdout.read(bs)\n+            if len(piece) == bs:\n+                intern.update(piece)\n+            else:\n+                raise IOError('Premature EOF reading git cat-file output')\n+            ptr += bs\n+        dig = intern.hexdigest()\n+        assert p.stdout.read(1) == b'\\n'  # ignore LF that follows blob data",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13066#discussion_r194794892",
      "id" : 194794892,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDc5NDg5Mg==",
      "original_commit_id" : "e5b2cd8e7564b9fc2ed4f63fe49efb0af60b4460",
      "original_position" : 57,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : 57,
      "pull_request_review_id" : 128032306,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13066",
      "updated_at" : "2018-06-12T15:56:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194794892",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
