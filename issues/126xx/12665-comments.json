[
   {
      "author_association" : "MEMBER",
      "body" : "WIP: Will move annotations to header files where appropriate.",
      "created_at" : "2018-03-11T09:30:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372101487",
      "id" : 372101487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-11T09:30:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372101487",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r173670354"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173670354"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This 1 line diff should be a separate pull request",
      "commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "created_at" : "2018-03-11T21:26:00Z",
      "diff_hunk" : "@@ -502,10 +502,10 @@ void CTxMemPool::removeRecursive(const CTransaction &origTx, MemPoolRemovalReaso\n     }\n }\n \n-void CTxMemPool::removeForReorg(const CCoinsViewCache *pcoins, unsigned int nMemPoolHeight, int flags)\n+void CTxMemPool::removeForReorg(const CCoinsViewCache *pcoins, unsigned int nMemPoolHeight, int flags) EXCLUSIVE_LOCKS_REQUIRED(cs_main, cs, mempool.cs)\n {\n     // Remove transactions spending a coinbase which are now immature and no-longer-final transactions\n-    LOCK(cs);\n+    AssertLockHeld(cs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r173670354",
      "id" : 173670354,
      "original_commit_id" : "aa224a20d6a018afeb847a28cd09ee5cdd9b95e9",
      "original_position" : 9,
      "path" : "src/txmempool.cpp",
      "position" : null,
      "pull_request_review_id" : 102896904,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665",
      "updated_at" : "2018-04-22T09:44:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173670354",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-03-11T21:27:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372150790",
      "id" : 372150790,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-11T21:27:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372150790",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r173672583"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173672583"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That assertion does not seem to hold, so I think it should be removed. I'll investigate.",
      "commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "created_at" : "2018-03-11T22:31:23Z",
      "diff_hunk" : "@@ -502,10 +502,10 @@ void CTxMemPool::removeRecursive(const CTransaction &origTx, MemPoolRemovalReaso\n     }\n }\n \n-void CTxMemPool::removeForReorg(const CCoinsViewCache *pcoins, unsigned int nMemPoolHeight, int flags)\n+void CTxMemPool::removeForReorg(const CCoinsViewCache *pcoins, unsigned int nMemPoolHeight, int flags) EXCLUSIVE_LOCKS_REQUIRED(cs_main, cs, mempool.cs)\n {\n     // Remove transactions spending a coinbase which are now immature and no-longer-final transactions\n-    LOCK(cs);\n+    AssertLockHeld(cs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r173672583",
      "id" : 173672583,
      "in_reply_to_id" : 173670354,
      "original_commit_id" : "aa224a20d6a018afeb847a28cd09ee5cdd9b95e9",
      "original_position" : 9,
      "path" : "src/txmempool.cpp",
      "position" : null,
      "pull_request_review_id" : 102899069,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665",
      "updated_at" : "2018-04-22T09:44:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173672583",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke Updated! Please review :-)",
      "created_at" : "2018-03-12T06:59:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372210389",
      "id" : 372210389,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-12T06:59:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372210389",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Concept ACK - Unlike the title implies, not all the added run time checking requirements have an associated AssertLockHeld/AssertLockNotHeld (e.g. CoinSelection) is this on purpose?",
      "created_at" : "2018-03-13T11:49:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372638788",
      "id" : 372638788,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-13T11:49:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372638788",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj Thanks for reporting. The annotations for `CoinSelection` and two other functions were incorrect. That is now fixed.\r\n\r\nThe intention is that literally all `EXCLUSIVE_LOCKS_REQUIRED`/`LOCKS_EXCLUDED`:s added in this PR should follow either directly or indirectly from `AssertLockHeld(Ã¢ÂÂ¦)`/`AssertLockNotHeld(Ã¢ÂÂ¦)`:s already existing in the repo.\r\n\r\nConsider the case where function `A(Ã¢ÂÂ¦)` contains `AssertLockHeld(cs_foo)` (without\r\nfirst locking `cs_foo` in `A`), and that `B(Ã¢ÂÂ¦)` calls `A(Ã¢ÂÂ¦)` (without first locking `cs_main`):\r\n* It _directly_ follows that: `A(Ã¢ÂÂ¦)` should have an `EXCLUSIVE_LOCKS_REQUIRED(cs_foo)` annotation.\r\n* It _indirectly_ follows that: `B(Ã¢ÂÂ¦)` should have an `EXCLUSIVE_LOCKS_REQUIRED(cs_foo)` annotation.\r\n\r\nI'll run through all annotations again to verify that they all follow directly or indirectly from `AssertLockHeld(Ã¢ÂÂ¦)`/`AssertLockNotHeld(Ã¢ÂÂ¦)`:s.\r\n\r\nThese are the annotations added Ã¢ÂÂ let me know if something sticks out/looks weird:\r\n\r\n```\r\n[Edit: List moved to PR description. See above!]\r\n```",
      "created_at" : "2018-03-13T13:52:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372671990",
      "id" : 372671990,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-13T21:21:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372671990",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Sadly that still didn't catch my [mistake here](https://github.com/bitcoin/bitcoin/pull/12565/files#r171235800), but I assume this is a step in that direction.\r\n\r\nLightly tested on macOS (no change, as expected).\r\n\r\n@practicalswift maybe you can put that overview and additional explanation (\"directly follows that...\") in the commit message or PR description?\r\n\r\nI didn't see a `EXCLUSIVE_LOCKS_REQUIRED ` in `LoadChainTip`; I assume that's done in a some dependent function? Maybe that can be made explicit in your overview if it's not too tedious?\r\n\r\nThe `EXLCUSIVE_LOCKS...` stuff in `validation.h` is not repeated in `validation.cpp`, that's intentional?\r\n\r\nShould violations merely throw warnings?",
      "created_at" : "2018-03-13T20:57:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372815880",
      "id" : 372815880,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-13T21:06:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372815880",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-03-13T21:11:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372819980",
      "id" : 372819980,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-13T21:11:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372819980",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors No intention to repeat annotations :-)  Which specific annotations did you see repeated in `validation.cpp`? Did you check them in the files or just in the summary?\r\n\r\nViolations are checked by Travis and cause a Travis build failure if found Ã¢ÂÂ see [`configure.ac`](https://github.com/bitcoin/bitcoin/blob/f13d756cdd9445d1478a70c5387df2a444045f6e/configure.ac#L251-L257).",
      "created_at" : "2018-03-14T09:19:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372954279",
      "id" : 372954279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-14T09:19:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372954279",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors Did you mean that you didn't see any `AssertLockHeld(Ã¢ÂÂ¦)` in `LoadChainTip`? :-)\r\n",
      "created_at" : "2018-03-14T09:22:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-372955186",
      "id" : 372955186,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-14T09:22:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372955186",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Which specific annotations did you see repeated in validation.cpp\r\n\r\nNone, so that's all good. I just found it slightly confusing that some annotations are in .h files and others in .cpp files.\r\n\r\n> Did you mean that you didn't see any `AssertLockHeld(Ã¢ÂÂ¦)` in `LoadChainTip`?\r\n\r\nYes, sorry. To more specific, no `AssertLockHeld(mempool.cs)`. But if you're happy and the compiler is happy, I'm happy :-)",
      "created_at" : "2018-03-14T14:10:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-373034128",
      "id" : 373034128,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-14T14:10:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373034128",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors The annotations should be in the header files, but not all functions are exported so that's why some annotations end up in the `.h` files.\r\n\r\n`LoadChainTip` is annotated with `EXCLUSIVE_LOCKS_REQUIRED(mempool.cs)` since it (indirectly) calls `CheckSequenceLocks` (which contains `AssertLockHeld(mempool.cs)`) without first locking `mempool.cs`.\r\n\r\nThe call stack looks like this:\r\n\r\n```\r\nLoadChainTip\r\n  ActivateBestChain\r\n    ActivateBestChainStep\r\n      UpdateMempoolForReorg\r\n        AcceptToMemoryPool\r\n          AcceptToMemoryPoolWithTime\r\n            AcceptToMemoryPoolWorker\r\n              CheckSequenceLocks\r\n```",
      "created_at" : "2018-03-14T19:59:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-373155264",
      "id" : 373155264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-14T19:59:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373155264",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Concept ACK",
      "created_at" : "2018-03-15T01:07:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-373226320",
      "id" : 373226320,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-03-15T01:07:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373226320",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased!",
      "created_at" : "2018-04-03T11:35:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-378219292",
      "id" : 378219292,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-03T11:35:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378219292",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased again!",
      "created_at" : "2018-04-09T08:33:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-379676332",
      "id" : 379676332,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-09T08:33:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/379676332",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj This PR is a subset of #11226 (closed in favour of smaller locking PR:s). PR #11226 had a 0.17.0 milestone (originally a 0.16.0 milestone actually). Would it be possible to get a 0.17.0 milestone for this PR?\r\n\r\nOf the locking PR:s this should be the best candidate for early merge. It contains only locking annotations for which we are already asserting using `AssertLockHeld(Ã¢ÂÂ¦)`. Since this PR doesn't change runtime behaviour (compile-time checks only) it should be low risk.\r\n\r\nHaving this PR merged would make the other locking assertions PR:s much smaller and easier to review since this PR contains the bulk of the assertions which the other PR:s contain too.\r\n\r\nKeeping this PR rebased is getting a bit time consuming, so let me know if I can do anything to facilitate merging :-)",
      "created_at" : "2018-04-09T08:47:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-379680038",
      "id" : 379680038,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-09T13:47:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/379680038",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebase number 3 performed :-)",
      "created_at" : "2018-04-09T22:43:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-379916459",
      "id" : 379916459,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-09T22:43:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/379916459",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can confirm 9d3e5374e30cd2b1c04c0bb45da24236eb3b2b37 still compiles on macOS.\r\n\r\n@TheBlueMatt and @promag recently worked on concurrency related bugs in `init.cpp`, so they might be able to review.",
      "created_at" : "2018-04-11T11:18:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-380416864",
      "id" : 380416864,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-11T11:18:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/380416864",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebase number 4 performed :-)  Please review :-)",
      "created_at" : "2018-04-22T09:44:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-383368594",
      "id" : 383368594,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-22T09:44:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383368594",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj This PR is getting a bit heavy to keep up-to-date. Do you think this PR has a chance of getting a 0.17.0 milestone (like #11226 had before getting closed in favour of this and other smaller PR:s)? :-)",
      "created_at" : "2018-04-22T09:53:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-383368975",
      "id" : 383368975,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-22T09:53:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383368975",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r183235850"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183235850"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I fail to see how this could compile, since we never `LOCK(mempool.cs)` before calling into this, no?",
      "commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "created_at" : "2018-04-22T12:57:35Z",
      "diff_hunk" : "@@ -1133,7 +1133,7 @@ UniValue sendrawtransaction(const JSONRPCRequest& request)\n     return hashTx.GetHex();\n }\n \n-UniValue testmempoolaccept(const JSONRPCRequest& request)\n+UniValue testmempoolaccept(const JSONRPCRequest& request) EXCLUSIVE_LOCKS_REQUIRED(mempool.cs)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r183235850",
      "id" : 183235850,
      "original_commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "original_position" : 14,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : 14,
      "pull_request_review_id" : 114200406,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665",
      "updated_at" : "2018-04-22T12:57:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183235850",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r183235863"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183235863"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same here",
      "commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "created_at" : "2018-04-22T12:58:01Z",
      "diff_hunk" : "@@ -202,7 +202,7 @@ void TestPackageSelection(const CChainParams& chainparams, CScript scriptPubKey,\n }\n \n // NOTE: These tests rely on CreateNewBlock doing its own self-validation!\n-BOOST_AUTO_TEST_CASE(CreateNewBlock_validity)\n+BOOST_AUTO_TEST_CASE(CreateNewBlock_validity) EXCLUSIVE_LOCKS_REQUIRED(mempool.cs)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r183235863",
      "id" : 183235863,
      "original_commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "original_position" : 14,
      "path" : "src/test/miner_tests.cpp",
      "position" : 14,
      "pull_request_review_id" : 114200418,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665",
      "updated_at" : "2018-04-22T12:58:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183235863",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r183235900"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183235900"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It seem the lock is taken here, but you require `EXCLUSIVE_LOCKS_REQUIRED(mempool.cs)`",
      "commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "created_at" : "2018-04-22T12:59:21Z",
      "diff_hunk" : "@@ -502,7 +502,7 @@ void CTxMemPool::removeRecursive(const CTransaction &origTx, MemPoolRemovalReaso\n     }\n }\n \n-void CTxMemPool::removeForReorg(const CCoinsViewCache *pcoins, unsigned int nMemPoolHeight, int flags)\n+void CTxMemPool::removeForReorg(const CCoinsViewCache *pcoins, unsigned int nMemPoolHeight, int flags) EXCLUSIVE_LOCKS_REQUIRED(cs_main, mempool.cs)\n {\n     // Remove transactions spending a coinbase which are now immature and no-longer-final transactions\n     LOCK(cs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r183235900",
      "id" : 183235900,
      "original_commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "original_position" : 8,
      "path" : "src/txmempool.cpp",
      "position" : 8,
      "pull_request_review_id" : 114200452,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665",
      "updated_at" : "2018-04-22T12:59:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183235900",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r183235928"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183235928"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What about adding `static` to functions that have their lock annotations added in the cpp file and not in the header?",
      "commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "created_at" : "2018-04-22T13:00:22Z",
      "diff_hunk" : "@@ -468,7 +467,7 @@ static bool IsCurrentForFeeEstimation()\n  * and instead just erase from the mempool as needed.\n  */\n \n-void UpdateMempoolForReorg(DisconnectedBlockTransactions &disconnectpool, bool fAddToMempool)\n+void UpdateMempoolForReorg(DisconnectedBlockTransactions &disconnectpool, bool fAddToMempool) EXCLUSIVE_LOCKS_REQUIRED(cs_main, mempool.cs)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#discussion_r183235928",
      "id" : 183235928,
      "original_commit_id" : "9a17c13c04142c9eec204fff29b8ea6a07a75e37",
      "original_position" : 33,
      "path" : "src/validation.cpp",
      "position" : 33,
      "pull_request_review_id" : 114200483,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12665",
      "updated_at" : "2018-04-22T13:00:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183235928",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke Updated. I've now tried to address your feedback. Turns out that I was a bit too strict with the locking requirements for `mempool.cs`, so the updated diff is significantly smaller and hopefully easier to review. Please re-review :-)",
      "created_at" : "2018-04-24T22:06:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-384095381",
      "id" : 384095381,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-24T22:06:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384095381",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK (could use `::mempool.cs` instead of `mempool.cs`, since it is referring to the global, I guess)\r\n\r\nAlso, you could split up the `cs_wallet` and `::mempool.cs` into two separate prs. I have the feeling it is easier to get stuff in that only touches a single \"module\".",
      "created_at" : "2018-04-25T18:56:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-384396842",
      "id" : 384396842,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-25T18:56:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384396842",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke Thanks for the utACK!\r\n\r\n\r\nAdded a commit which changed from `mempool.cs` to `::mempool.cs`.\r\n\r\nI've now split up this PR into four separate PRs Ã¢ÂÂ one per lock:\r\n* `cs_KeyStore`: #13077\r\n* `::mempool.cs`: #13080\r\n* `cs_wallet`: #13081\r\n* `cs_main`: #13083\r\n\r\nPlease review these four :-)",
      "created_at" : "2018-04-25T21:41:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12665#issuecomment-384443430",
      "id" : 384443430,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12665",
      "updated_at" : "2018-04-25T21:41:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384443430",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
