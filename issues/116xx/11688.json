{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "It appears that the bitcoin-cli rpc commands for a transaction respond with incorrect details.\r\n\r\n### Can you reliably reproduce the issue?\r\n\r\nThe first thing I do is mine 100 blocks to have some bitcoin to test with:\r\n```\r\n$ bitcoin-cli -rpcuser=test -rpcpassword=test -rpcport=8332 generate 101\r\n[\r\n  \"51c24890e1054206bc3473833bd537dbb08872ba7e25b609d89a8ee1d92619cb\", \r\n  \"4d5a1e4cd3ab2487099b6ddddcef4b30072b3107f302e68193618d12eb464e9d\",\r\n  ...\r\n  ]\r\n```\r\n\r\nThen I create an address to send to:\r\n```\r\n$ bitcoin-cli -rpcuser=test -rpcpassword=test -rpcport=8332 getnewaddress\r\nmgzERsvgbuWN8F2cASyNG9a5TmciUgVpPh\r\n```\r\n\r\nThen I create a transaction:\r\n```\r\n$ bitcoin-cli -rpcuser=test -rpcpassword=test -rpcport=8332 sendtoaddress mgzERsvgbuWN8F2cASyNG9a5TmciUgVpPh 5\r\ncb342f29e8ddadd7dc79d8ed173384be300ee8f8555d0db369b058c8d9cc0874\r\n```\r\n\r\nI mine some more blocks so that the transaction is confirmed.\r\n```\r\n$ bitcoin-cli -rpcuser=test -rpcpassword=test -rpcport=8332 generate 101\r\n[\r\n    \"1740036ad18ab8299af71722425aa37c99e80883ecc57c923e6117144936c932\", \r\n    \"6859ab4bd12c550b3f9e50d77f7493d303afcca9649ff44e51df36045affa4bd\", \r\n    ...\r\n    ]\r\n```\r\n\r\nAt this point, I would expect to be able to call `gettransaction`  on the transaction and look at the details array to understand where the bitcoin is being sent from and to.\r\n\r\nHowever, the details seem to show that the transaction is sending Bitcoin to the from and to the same address.\r\n\r\n```\r\n$ bitcoin-cli -rpcuser=test -rpcpassword=test -rpcport=8332 gettransaction cb342f29e8ddadd7dc79d8ed173384be300ee8f8555d0db369b058c8d9cc0874\r\n{\r\n    \"amount\": 0.00000000,\r\n    \"fee\": -0.00003840,\r\n    \"confirmations\": 102,\r\n    \"blockhash\": \"1740036ad18ab8299af71722425aa37c99e80883ecc57c923e6117144936c932\",\r\n    \"blockindex\": 1,\r\n    \"blocktime\": 1510688324,\r\n    \"txid\": \"cb342f29e8ddadd7dc79d8ed173384be300ee8f8555d0db369b058c8d9cc0874\",\r\n    \"walletconflicts\": [\r\n    ],\r\n    \"time\": 1510687907,\r\n    \"timereceived\": 1510687907,\r\n    \"bip125-replaceable\": \"no\",\r\n    \"details\": [\r\n        {\r\n        \"account\": \"\",\r\n        \"address\": \"mgzERsvgbuWN8F2cASyNG9a5TmciUgVpPh\", // This appears to be deducing 5 BTC from the destination account\r\n        \"category\": \"send\",\r\n        \"amount\": -5.00000000,\r\n        \"label\": \"\",\r\n        \"vout\": 1,\r\n        \"fee\": -0.00003840,\r\n        \"abandoned\": false\r\n        }, \r\n        {\r\n        \"account\": \"\",\r\n        \"address\": \"mgzERsvgbuWN8F2cASyNG9a5TmciUgVpPh\", // This appears to be adding 5 BTC to the destination account \r\n        \"category\": \"receive\",\r\n        \"amount\": 5.00000000,\r\n        \"label\": \"\",\r\n        \"vout\": 1\r\n        }\r\n    ],\r\n    \"hex\": \"0200000001013c38f8b9e881bed8d9b2faab08b906872e892b81bc9cdcbdb7f67ef4c2ee36000000004847304402201b5739ad42af1f0c5ba39f95aaa00c3741e3f2b254b4db6c7935301c6d10bfec02204201ae0428c09dfd7e8502c76ac41616a009cacc2ecb01ab52192bd093fc08f701feffffff02007e380c010000001976a9144f1a967f4b556a1d3203b17034b2508278edc11e88ac0065cd1d000000001976a9141020d353ca4f37c41f88fca92ba7187627fd4ac788ac65000000\"\r\n}\r\n```\r\n\r\nWhen I decode the hex, however, the vout and vin details appear to be correct.\r\n\r\n```\r\n$ bitcoin-cli -rpcuser=test -rpcpassword=test -rpcport=8332 decoderawtransaction 0200000001013c38f8b9e881bed8d9b2faab08b906872e892b81bc9cdcbdb7f67ef4c2ee36000000004847304402201b5739ad42af1f0c5ba39f95aaa00c3741e3f2b254b4db6c7935301c6d10bfec02204201ae0428c09dfd7e8502c76ac41616a009cacc2ecb01ab52192bd093fc08f701feffffff02007e380c010000001976a9144f1a967f4b556a1d3203b17034b2508278edc11e88ac0065cd1d000000001976a9141020d353ca4f37c41f88fca92ba7187627fd4ac788ac65000000\r\n{\r\n  \"txid\": \"cb342f29e8ddadd7dc79d8ed173384be300ee8f8555d0db369b058c8d9cc0874\",\r\n  \"hash\": \"cb342f29e8ddadd7dc79d8ed173384be300ee8f8555d0db369b058c8d9cc0874\",\r\n  \"version\": 2,\r\n  \"size\": 191,\r\n  \"vsize\": 191,\r\n  \"locktime\": 101,\r\n  \"vin\": [\r\n    {\r\n      \"txid\": \"36eec2f47ef6b7bddc9cbc812b892e8706b908abfab2d9d8be81e8b9f8383c01\",\r\n      \"vout\": 0,\r\n      \"scriptSig\": {\r\n        \"asm\": \"304402201b5739ad42af1f0c5ba39f95aaa00c3741e3f2b254b4db6c7935301c6d10bfec02204201ae0428c09dfd7e8502c76ac41616a009cacc2ecb01ab52192bd093fc08f7[ALL]\",\r\n        \"hex\": \"47304402201b5739ad42af1f0c5ba39f95aaa00c3741e3f2b254b4db6c7935301c6d10bfec02204201ae0428c09dfd7e8502c76ac41616a009cacc2ecb01ab52192bd093fc08f701\"\r\n      },\r\n      \"sequence\": 4294967294\r\n    }\r\n  ],\r\n  \"vout\": [\r\n    {\r\n      \"value\": 44.99996160,\r\n      \"n\": 0,\r\n      \"scriptPubKey\": {\r\n        \"asm\": \"OP_DUP OP_HASH160 4f1a967f4b556a1d3203b17034b2508278edc11e OP_EQUALVERIFY OP_CHECKSIG\",\r\n        \"hex\": \"76a9144f1a967f4b556a1d3203b17034b2508278edc11e88ac\",\r\n        \"reqSigs\": 1,\r\n        \"type\": \"pubkeyhash\",\r\n        \"addresses\": [\r\n          \"mnjDXZqKEV5getLX2NWTxxqaTJbxi4PDzk\"\r\n        ]\r\n      }\r\n    }, \r\n    {\r\n      \"value\": 5.00000000,\r\n      \"n\": 1,\r\n      \"scriptPubKey\": {\r\n        \"asm\": \"OP_DUP OP_HASH160 1020d353ca4f37c41f88fca92ba7187627fd4ac7 OP_EQUALVERIFY OP_CHECKSIG\",\r\n        \"hex\": \"76a9141020d353ca4f37c41f88fca92ba7187627fd4ac788ac\",\r\n        \"reqSigs\": 1,\r\n        \"type\": \"pubkeyhash\",\r\n        \"addresses\": [\r\n          \"mgzERsvgbuWN8F2cASyNG9a5TmciUgVpPh\"\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n### What version of bitcoin-core are you using?\r\nRunning the 0.15.0.1 release: https://bitcoin.org/bin/bitcoin-core-0.15.0.1/bitcoin-0.15.0.1-x86_64-linux-gnu.tar.gz\r\n\r\nRunning the bitcoind node with the -regtest command.\r\n\r\n### Machine specs:\r\n- OS: Ubuntu 16.04 (virtualized)\r\n- CPU: 4 Core\r\n- RAM: 4gb\r\n- Disk size: na\r\n- Disk Type (HD/SDD): SSD\r\n",
   "closed_at" : "2017-11-14T20:50:28Z",
   "closed_by" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
      "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
      "followers_url" : "https://api.github.com/users/sipa/followers",
      "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/sipa",
      "id" : 548488,
      "login" : "sipa",
      "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
      "organizations_url" : "https://api.github.com/users/sipa/orgs",
      "received_events_url" : "https://api.github.com/users/sipa/received_events",
      "repos_url" : "https://api.github.com/users/sipa/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/sipa"
   },
   "comments" : 5,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11688/comments",
   "created_at" : "2017-11-14T20:39:05Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11688/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/11688",
   "id" : 273934774,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11688/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWUyNzM5MzQ3NzQ=",
   "number" : 11688,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "title" : "Rpc transaction details appear incorrect",
   "updated_at" : "2017-11-14T23:06:18Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11688",
   "user" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/1569744?v=4",
      "events_url" : "https://api.github.com/users/jsfour/events{/privacy}",
      "followers_url" : "https://api.github.com/users/jsfour/followers",
      "following_url" : "https://api.github.com/users/jsfour/following{/other_user}",
      "gists_url" : "https://api.github.com/users/jsfour/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/jsfour",
      "id" : 1569744,
      "login" : "jsfour",
      "node_id" : "MDQ6VXNlcjE1Njk3NDQ=",
      "organizations_url" : "https://api.github.com/users/jsfour/orgs",
      "received_events_url" : "https://api.github.com/users/jsfour/received_events",
      "repos_url" : "https://api.github.com/users/jsfour/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/jsfour/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/jsfour/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/jsfour"
   }
}
