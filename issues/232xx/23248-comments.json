[
   {
      "author_association" : "MEMBER",
      "body" : "cc @practicalswift ",
      "created_at" : "2021-10-11T10:36:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-939904179",
      "id" : 939904179,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844Bcyz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939904179/reactions"
      },
      "updated_at" : "2021-10-11T10:36:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939904179",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There is also a `/usr/bin/ld: warning: libunwind.so.1, needed by /lib/x86_64-linux-gnu/libc++.so.1, may conflict with libunwind.so.8`, not sure if important.",
      "created_at" : "2021-10-11T10:43:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-939909138",
      "id" : 939909138,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844BeAS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939909138/reactions"
      },
      "updated_at" : "2021-10-11T10:43:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939909138",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If someone is bored and wants to bisect a bit more:\r\n\r\n* :heavy_check_mark: clang-7\r\n* :heavy_check_mark: clang-10\r\n* :heavy_check_mark: clang-11\r\n* :heavy_check_mark: clang-12 (focal) :x: clang-12 (impish)\r\n* :x: clang-13",
      "created_at" : "2021-10-11T11:29:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-939942711",
      "id" : 939942711,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844BmM3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939942711/reactions"
      },
      "updated_at" : "2021-10-11T12:42:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939942711",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for reporting!\r\n\r\nDoes adding `allowed_syscalls.insert(__NR_mincore)` to `AllowAddressSpaceAccess` in `SeccompPolicyBuilder` solve the issue?",
      "created_at" : "2021-10-11T12:10:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-939972569",
      "id" : 939972569,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844BtfZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939972569/reactions"
      },
      "updated_at" : "2021-10-11T12:10:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939972569",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yes, the following diff fixes that issue. Is there a reason why the system call name wasn't printed? Maybe we can remove the logging if it doesn't work reliably anyway. See also https://github.com/bitcoin/bitcoin/pull/20487#discussion_r712430747\r\n\r\n```diff\r\ndiff --git a/src/util/syscall_sandbox.cpp b/src/util/syscall_sandbox.cpp\r\nindex 7e76ecbf3..8128a33f4 100644\r\n--- a/src/util/syscall_sandbox.cpp\r\n+++ b/src/util/syscall_sandbox.cpp\r\n@@ -537,6 +537,7 @@ public:\r\n \r\n     void AllowAddressSpaceAccess()\r\n     {\r\n+           allowed_syscalls.insert(__NR_mincore);\r\n         allowed_syscalls.insert(__NR_brk);        // change data segment size\r\n         allowed_syscalls.insert(__NR_madvise);    // give advice about use of memory\r\n         allowed_syscalls.insert(__NR_membarrier); // issue memory barriers on a set of threads\r\n",
      "created_at" : "2021-10-11T13:02:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-940009400",
      "id" : 940009400,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844B2e4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940009400/reactions"
      },
      "updated_at" : "2021-10-11T13:02:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940009400",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke \r\n\r\nLogging should always work as long as the logging machinery itself does not invoke a disallowed syscall. The logging function itself operates under the sandbox restrictions.\r\n\r\nIt could be that the logging itself is (indirectly) invoking `mincore` on this system.\r\n\r\nI think you can test this hypothesis by adding `mincore` as an allowed syscall, and then add a dummy call â¦\r\n\r\n```c++\r\n    // The getgroups syscall is assumed NOT to be allowed by the syscall sandbox policy.\r\n    std::array<gid_t, 1> groups;\r\n    [[maybe_unused]] int32_t ignored = getgroups(groups.size(), groups.data());\r\n```\r\n\r\nâ¦ at the start of `init::SanityChecks()` (prior to the syscall violation you reported).\r\n\r\n`getgroups` is guaranteed to be disallowed by the syscall sandbox (it is used for testing the sandbox functionality), so starting `bitcoind -regtest -sandbox=log-and-abort` should give an error message about a disallowed syscall.\r\n\r\nYou can test if that works with and without `mincore` as an allowed syscall to see if my hypothesis holds :)",
      "created_at" : "2021-10-11T13:32:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-940036270",
      "id" : 940036270,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844B9Cu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940036270/reactions"
      },
      "updated_at" : "2021-10-11T13:32:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940036270",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Btw, another issue happens on Fedora 35:\r\n\r\n* Install fresh Fedora 35\r\n* Compile Bitcoin Core with `dnf install gcc-c++ libtool make autoconf automake python3 clang llvm     curl wget htop git vim ccache  lbzip2  gdb   -y && git clone https://github.com/bitcoin/bitcoin.git ./bitcoin-core && cd bitcoin-core && ( cd depends && make CC=clang CXX=clang++ DEBUG=1 NO_QT=1 NO_WALLET=1 NO_ZMQ=1 NO_UPNP=1 NO_NATPMP=1 -j $(nproc) ) &&  ./autogen.sh && CONFIG_SITE=\"$PWD/depends/x86_64-pc-linux-gnu/share/config.site\" ./configure CC=clang CXX=clang++` && make -j $(nproc) src/bitcoind`\r\n* Run `gdb --args ./src/bitcoind -sandbox=log-and-abort -datadir=/tmp -regtest`\r\n* `run`\r\n\r\n\r\n```\r\n(gdb) run\r\nStarting program: /bitcoin-core/src/bitcoind -sandbox=log-and-abort -datadir=/tmp -regtest\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\r\n2021-10-11T13:30:02Z Bitcoin Core version v22.99.0-1790a8ddacae (release build)\r\n2021-10-11T13:30:02Z Validating signatures for all blocks.\r\n2021-10-11T13:30:02Z Setting nMinimumChainWork=0000000000000000000000000000000000000000000000000000000000000000\r\n2021-10-11T13:30:02Z Experimental syscall sandbox enabled (-sandbox=log-and-abort): bitcoind will terminate if an unexpected (not allowlisted) syscall is invoked.\r\n2021-10-11T13:30:02Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\r\n2021-10-11T13:30:02Z Using RdSeed as additional entropy source\r\n2021-10-11T13:30:02Z Using RdRand as an additional entropy source\r\n2021-10-11T13:30:02Z No wallet support compiled in!\r\n2021-10-11T13:30:02Z Default data directory /root/.bitcoin\r\n2021-10-11T13:30:02Z Using data directory /tmp/regtest\r\n2021-10-11T13:30:02Z Config file: /tmp/bitcoin.conf (not found, skipping)\r\n2021-10-11T13:30:02Z Command-line arg: datadir=\"/tmp\"\r\n2021-10-11T13:30:02Z Command-line arg: regtest=\"\"\r\n2021-10-11T13:30:02Z Command-line arg: sandbox=\"log-and-abort\"\r\n2021-10-11T13:30:02Z Using at most 125 automatic connections (524288 file descriptors available)\r\n2021-10-11T13:30:02Z Using 16 MiB out of 32/2 requested for signature cache, able to store 524288 elements\r\n2021-10-11T13:30:02Z Using 16 MiB out of 32/2 requested for script execution cache, able to store 524288 elements\r\n2021-10-11T13:30:02Z Script verification uses 7 additional threads\r\n\r\nProgram received signal SIGSYS, Bad system call.\r\n0x00007ffff7bb368d in clone3 () from /lib64/libc.so.6\r\nMissing separate debuginfos, use: dnf debuginfo-install glibc-2.34-7.fc35.x86_64 libgcc-11.2.1-1.fc35.x86_64 libstdc++-11.2.1-1.fc35.x86_64\r\n(gdb) bt\r\n#0  0x00007ffff7bb368d in clone3 () from /lib64/libc.so.6\r\n#1  0x00007ffff7bb36f1 in __clone_internal () from /lib64/libc.so.6\r\n#2  0x00007ffff7b2e785 in create_thread () from /lib64/libc.so.6\r\n#3  0x00007ffff7b2f22b in pthread_create@GLIBC_2.2.5 () from /lib64/libc.so.6\r\n#4  0x00007ffff7e7af3a in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) () from /lib64/libstdc++.so.6\r\n#5  0x0000555555946cd7 in void std::__cxx1998::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<CCheckQueue<CScriptCheck>::StartWorkerThreads(int)::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::__cxx1998::vector<std::thread, std::allocator<std::thread> > >, CCheckQueue<CScriptCheck>::StartWorkerThreads(int)::{lambda()#1}&&) ()\r\n#6  0x0000555555946b58 in std::thread& std::__cxx1998::vector<std::thread, std::allocator<std::thread> >::emplace_back<CCheckQueue<CScriptCheck>::StartWorkerThreads(int)::{lambda()#1}>(CCheckQueue<CScriptCheck>::StartWorkerThreads(int)::{lambda()#1}&&) ()\r\n#7  0x00005555559397d3 in CCheckQueue<CScriptCheck>::StartWorkerThreads(int) ()\r\n#8  0x00005555559090c3 in StartScriptCheckWorkerThreads(int) ()\r\n#9  0x00005555555c148c in AppInitMain(NodeContext&, interfaces::BlockAndHeaderTipInfo*) ()\r\n#10 0x00005555555a80af in main ()\r\n",
      "created_at" : "2021-10-11T13:34:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-940038221",
      "id" : 940038221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844B9hN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940038221/reactions"
      },
      "updated_at" : "2021-10-11T13:34:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940038221",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> You can test if that works with and without mincore as an allowed syscall to see if my hypothesis holds :)\r\n\r\nYes, that worked:\r\n\r\n```\r\n$ ./src/bitcoind -sandbox=log-and-abort -datadir=/tmp -regtest \r\nERROR: The syscall \"getgroups\" (syscall number 115) is not allowed by the syscall sandbox in thread \"init\". Please report.\r\nlibc++abi: terminating\r\nBad system call (core dumped)\r\n```\r\n\r\nHowever, I am still wondering if logging can be removed, since it might break sometimes (inevitably) and would simplify maintenance (e.g. #23196 wouldn't be needed)",
      "created_at" : "2021-10-11T13:39:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-940042177",
      "id" : 940042177,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844B-fB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940042177/reactions"
      },
      "updated_at" : "2021-10-11T13:39:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940042177",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke \r\n\r\n> 0x00007ffff7bb368d in clone3 () from /lib64/libc.so.6\r\n\r\nSounds like `allowed_syscalls.insert(__NR_clone3)` is needed in `AllowProcessStartOrDeath()` :)\r\n\r\nThanks a lot for testing on newer and diverse systems. My testing has been somewhat focused on various Ubuntu based systems (primarily LTS editions).\r\n\r\nFWIW from the original PR https://github.com/bitcoin/bitcoin/pull/20487#issuecomment-857707559: _As have been noted in previous discussions above syscall sandboxing is a type of feature that needs experimentation and fine-tuning for different environments to catch potential diversity in syscall use across systems. Such experimentation was required when sandboxing using seccomp-bpf was introduced in projects such as Chromium, OpenSSH and Tor, and it will be required for Bitcoin Core too. There is really no way around it :)_",
      "created_at" : "2021-10-11T13:49:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-940049789",
      "id" : 940049789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844CAV9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940049789/reactions"
      },
      "updated_at" : "2021-10-11T13:49:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940049789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fedora can be fixed with:\r\n\r\n```diff\r\ndiff --git a/src/util/syscall_sandbox.cpp b/src/util/syscall_sandbox.cpp\r\nindex 7e76ecbf3..ee1b13142 100644\r\n--- a/src/util/syscall_sandbox.cpp\r\n+++ b/src/util/syscall_sandbox.cpp\r\n@@ -115,6 +115,7 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\r\n     {__NR_clock_nanosleep, \"clock_nanosleep\"},\r\n     {__NR_clock_settime, \"clock_settime\"},\r\n     {__NR_clone, \"clone\"},\r\n+    {__NR_clone3, \"clone3\"},\r\n     {__NR_close, \"close\"},\r\n     {__NR_connect, \"connect\"},\r\n     {__NR_copy_file_range, \"copy_file_range\"},\r\n@@ -705,6 +706,7 @@ public:\r\n     void AllowProcessStartOrDeath()\r\n     {\r\n         allowed_syscalls.insert(__NR_clone);      // create a child process\r\n+        allowed_syscalls.insert(__NR_clone3);      // create a child process\r\n         allowed_syscalls.insert(__NR_exit);       // terminate the calling process\r\n         allowed_syscalls.insert(__NR_exit_group); // exit all threads in a process\r\n         allowed_syscalls.insert(__NR_fork);       // create a child process\r\n",
      "created_at" : "2021-10-11T13:52:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-940052298",
      "id" : 940052298,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844CA9K",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940052298/reactions"
      },
      "updated_at" : "2021-10-11T13:52:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940052298",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Note that as we add \"new\" syscalls such as `clone3` which may not be available in the user's (older) headers then these must be added with â¦\r\n\r\n```c++\r\n#ifndef __NR_<syscall>\r\n#define __NR_<syscall> <syscall_number>\r\n#endif\r\n```\r\n\r\nâ¦ as we've done with `statx`, `getrandom`, `membarrier` and other newly introduced syscalls :)\r\n\r\nThis requirement holds regardless of if we choose to remove the logging functionality or not.\r\n\r\nSee this comment in `syscall_sandbox.cpp`:\r\n\r\n```c++\r\n// Define system call numbers for x86_64 that are referenced in the system call profile\r\n// but not provided by the kernel headers used in the GUIX build.\r\n```\r\n\r\n> However, I am still wondering if logging can be removed, since it might break sometimes (inevitably) and would simplify maintenance (e.g. #23196 wouldn't be needed)\r\n\r\nPlease note the analysis in https://github.com/bitcoin/bitcoin/pull/23196#issuecomment-937727694: if that holds the we shouldn't see any more compile-time issues going forward :)",
      "created_at" : "2021-10-11T13:59:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-940057894",
      "id" : 940057894,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844CCUm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940057894/reactions"
      },
      "updated_at" : "2021-10-11T14:00:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940057894",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, see #23255 ",
      "created_at" : "2021-10-11T14:09:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/23248#issuecomment-940066967",
      "id" : 940066967,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23248",
      "node_id" : "IC_kwDOABII5844CEiX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940066967/reactions"
      },
      "updated_at" : "2021-10-11T14:09:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/940066967",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
