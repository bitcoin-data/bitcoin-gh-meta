[
   {
      "author_association" : "MEMBER",
      "body" : "Note that bumpfee does not take this into account yet, but it's next on my list.",
      "created_at" : "2021-10-05T23:22:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-935049936",
      "id" : 935049936,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5843u7rQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935049936/reactions"
      },
      "updated_at" : "2021-10-05T23:22:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935049936",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2021-10-05T23:23:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-935053378",
      "id" : 935053378,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5843u8hC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935053378/reactions"
      },
      "updated_at" : "2021-10-05T23:23:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935053378",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @t-bast maybe @apoelstra ",
      "created_at" : "2021-10-06T00:26:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-935140775",
      "id" : 935140775,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5843vR2n",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935140775/reactions"
      },
      "updated_at" : "2021-10-06T00:26:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935140775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, I'll test this today with lightning transactions.\r\nShould this PR update the release notes?",
      "created_at" : "2021-10-06T06:46:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-935590919",
      "id" : 935590919,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5843w_wH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935590919/reactions"
      },
      "updated_at" : "2021-10-06T06:46:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935590919",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723015304"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723015304"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Isn't this already done in `SetOptionsInputWeights`?",
      "commit_id" : "5c2ff2578512fca8134d68a8a86ae144c9335cca",
      "created_at" : "2021-10-06T08:41:12Z",
      "diff_hunk" : "@@ -4707,10 +4767,15 @@ static RPCHelpMan walletcreatefundedpsbt()\n         }, true\n     );\n \n+    UniValue options = request.params[3];\n+    if (options.exists(\"input_weights\")) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify weight in inputs instead\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723015304",
      "id" : 723015304,
      "line" : 4772,
      "node_id" : "PRRC_kwDOABII584rGFaI",
      "original_commit_id" : "5c2ff2578512fca8134d68a8a86ae144c9335cca",
      "original_line" : 4772,
      "original_position" : 122,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 122,
      "pull_request_review_id" : 772362588,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723015304/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T08:41:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723015304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I tested https://github.com/bitcoin/bitcoin/pull/23201/commits/5c2ff2578512fca8134d68a8a86ae144c9335cca with lightning transactions, and I'm correctly able to specify input weights for non-standard inputs. Thanks @achow101!",
      "created_at" : "2021-10-06T09:14:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-935811299",
      "id" : 935811299,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5843x1jj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935811299/reactions"
      },
      "updated_at" : "2021-10-06T09:14:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/935811299",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23545](https://github.com/bitcoin/bitcoin/pull/23545) (scripted-diff: Use clang-tidy syntax for C++ named arguments by MarcoFalke)\n* [#23475](https://github.com/bitcoin/bitcoin/pull/23475) (wallet: add config to prioritize a solution that doesn't create change in coin selection by brunoerg)\n* [#23202](https://github.com/bitcoin/bitcoin/pull/23202) (wallet: allow psbtbumpfee to work with txs with external inputs by achow101)\n* [#19602](https://github.com/bitcoin/bitcoin/pull/19602) (wallet: Migrate legacy wallets to descriptor wallets by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-10-06T11:23:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-936035567",
      "id" : 936035567,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5843ysTv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/936035567/reactions"
      },
      "updated_at" : "2022-01-15T06:57:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/936035567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-10-06T11:59:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-936098325",
      "id" : 936098325,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5843y7oV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/936098325/reactions"
      },
      "updated_at" : "2021-10-06T11:59:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/936098325",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723399460"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723399460"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Indeed, removed.",
      "commit_id" : "675309b8685933848998b4503bdbc74054c74832",
      "created_at" : "2021-10-06T15:31:28Z",
      "diff_hunk" : "@@ -4707,10 +4767,15 @@ static RPCHelpMan walletcreatefundedpsbt()\n         }, true\n     );\n \n+    UniValue options = request.params[3];\n+    if (options.exists(\"input_weights\")) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify weight in inputs instead\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723399460",
      "id" : 723399460,
      "in_reply_to_id" : 723015304,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rHjMk",
      "original_commit_id" : "5c2ff2578512fca8134d68a8a86ae144c9335cca",
      "original_line" : 4772,
      "original_position" : 122,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 772873773,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723399460/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T15:31:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723399460",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723737247"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723737247"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: use WITNESS_SCALE_FACTOR",
      "commit_id" : "a19169ac6039ea45d5e1641ab190f6f8b6317bc0",
      "created_at" : "2021-10-06T23:00:17Z",
      "diff_hunk" : "@@ -3339,6 +3340,35 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n         }\n     }\n \n+    if (options.exists(\"input_weights\")) {\n+        const UniValue& inputs = options[\"input_weights\"].get_array();\n+        for (unsigned int i = 0; i < inputs.size(); ++i) {\n+            const UniValue& input = inputs[i].get_obj();\n+\n+            uint256 txid = ParseHashO(input, \"txid\");\n+\n+            const UniValue& vout_v = find_value(input, \"vout\");\n+            if (!vout_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing vout key\");\n+            }\n+            int vout = vout_v.get_int();\n+            if (vout < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, vout cannot be negative\");\n+            }\n+\n+            const UniValue& weight_v = find_value(input, \"weight\");\n+            if (!weight_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing weight key\");\n+            }\n+            int64_t weight = weight_v.get_int64();\n+            if (weight < 40 * 4) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723737247",
      "id" : 723737247,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rI1qf",
      "original_commit_id" : "c3fbbe7de9087205ed5e3c01e348005d88e7bb53",
      "original_line" : 3364,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 773302897,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723737247/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T23:08:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723737247",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723739242"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723739242"
         }
      },
      "author_association" : "MEMBER",
      "body" : "higher lower fee?",
      "commit_id" : "a19169ac6039ea45d5e1641ab190f6f8b6317bc0",
      "created_at" : "2021-10-06T23:05:34Z",
      "diff_hunk" : "@@ -1032,10 +1037,38 @@ def test_external_inputs(self):\n         assert signed_tx['complete']\n \n         funded_tx = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}})\n-        signed_tx = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n-        assert not signed_tx['complete']\n-        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx['hex'])\n-        assert signed_tx['complete']\n+        signed_tx1 = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n+        assert not signed_tx1['complete']\n+        signed_tx2 = self.nodes[0].signrawtransactionwithwallet(signed_tx1['hex'])\n+        assert signed_tx2['complete']\n+\n+        unsigned_weight = self.nodes[0].decoderawtransaction(signed_tx1[\"hex\"])[\"weight\"]\n+        signed_weight = self.nodes[0].decoderawtransaction(signed_tx2[\"hex\"])[\"weight\"]\n+        # Input's weight is difference between weight of signed and unsigned,\n+        # and the weight of stuff that didn't change (prevout, sequence, 1 byte of scriptSig)\n+        input_weight = signed_weight - unsigned_weight + (45 * 4)\n+        low_input_weight = input_weight // 2\n+        high_input_weight = input_weight * 2\n+\n+        # Funding should also work if the input weight is provided\n+        funded_tx = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}]})\n+        signed_tx = wallet.signrawtransactionwithwallet(funded_tx[\"hex\"])\n+        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx[\"hex\"])\n+        assert self.nodes[0].testmempoolaccept([signed_tx[\"hex\"]])[0][\"allowed\"]\n+        # Reducing the weight should have a lower fee\n+        funded_tx2 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": low_input_weight}]})\n+        assert_greater_than(funded_tx[\"fee\"], funded_tx2[\"fee\"])\n+        # Increasing the weight should have a higher lower fee",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723739242",
      "id" : 723739242,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rI2Jq",
      "original_commit_id" : "7121427e245b640bd3b9598494ba5af97f1f544b",
      "original_line" : 1061,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 773302897,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723739242/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T23:08:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723739242",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723749363"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723749363"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "a19169ac6039ea45d5e1641ab190f6f8b6317bc0",
      "created_at" : "2021-10-06T23:33:34Z",
      "diff_hunk" : "@@ -3339,6 +3340,35 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n         }\n     }\n \n+    if (options.exists(\"input_weights\")) {\n+        const UniValue& inputs = options[\"input_weights\"].get_array();\n+        for (unsigned int i = 0; i < inputs.size(); ++i) {\n+            const UniValue& input = inputs[i].get_obj();\n+\n+            uint256 txid = ParseHashO(input, \"txid\");\n+\n+            const UniValue& vout_v = find_value(input, \"vout\");\n+            if (!vout_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing vout key\");\n+            }\n+            int vout = vout_v.get_int();\n+            if (vout < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, vout cannot be negative\");\n+            }\n+\n+            const UniValue& weight_v = find_value(input, \"weight\");\n+            if (!weight_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing weight key\");\n+            }\n+            int64_t weight = weight_v.get_int64();\n+            if (weight < 40 * 4) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723749363",
      "id" : 723749363,
      "in_reply_to_id" : 723737247,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rI4nz",
      "original_commit_id" : "c3fbbe7de9087205ed5e3c01e348005d88e7bb53",
      "original_line" : 3364,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 773317911,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723749363/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T23:33:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723749363",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723749384"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723749384"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "a19169ac6039ea45d5e1641ab190f6f8b6317bc0",
      "created_at" : "2021-10-06T23:33:38Z",
      "diff_hunk" : "@@ -1032,10 +1037,38 @@ def test_external_inputs(self):\n         assert signed_tx['complete']\n \n         funded_tx = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}})\n-        signed_tx = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n-        assert not signed_tx['complete']\n-        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx['hex'])\n-        assert signed_tx['complete']\n+        signed_tx1 = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n+        assert not signed_tx1['complete']\n+        signed_tx2 = self.nodes[0].signrawtransactionwithwallet(signed_tx1['hex'])\n+        assert signed_tx2['complete']\n+\n+        unsigned_weight = self.nodes[0].decoderawtransaction(signed_tx1[\"hex\"])[\"weight\"]\n+        signed_weight = self.nodes[0].decoderawtransaction(signed_tx2[\"hex\"])[\"weight\"]\n+        # Input's weight is difference between weight of signed and unsigned,\n+        # and the weight of stuff that didn't change (prevout, sequence, 1 byte of scriptSig)\n+        input_weight = signed_weight - unsigned_weight + (45 * 4)\n+        low_input_weight = input_weight // 2\n+        high_input_weight = input_weight * 2\n+\n+        # Funding should also work if the input weight is provided\n+        funded_tx = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}]})\n+        signed_tx = wallet.signrawtransactionwithwallet(funded_tx[\"hex\"])\n+        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx[\"hex\"])\n+        assert self.nodes[0].testmempoolaccept([signed_tx[\"hex\"]])[0][\"allowed\"]\n+        # Reducing the weight should have a lower fee\n+        funded_tx2 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": low_input_weight}]})\n+        assert_greater_than(funded_tx[\"fee\"], funded_tx2[\"fee\"])\n+        # Increasing the weight should have a higher lower fee",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r723749384",
      "id" : 723749384,
      "in_reply_to_id" : 723739242,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rI4oI",
      "original_commit_id" : "7121427e245b640bd3b9598494ba5af97f1f544b",
      "original_line" : 1061,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 773317941,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723749384/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-06T23:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/723749384",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-10-07T19:40:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-938098965",
      "id" : 938098965,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII58436kEV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/938098965/reactions"
      },
      "updated_at" : "2021-10-07T19:40:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/938098965",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725094128"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725094128"
         }
      },
      "author_association" : "NONE",
      "body" : "Isn't \"no weight\" -1? If so, shouldn't this be ` >= 0`?",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:08:33Z",
      "diff_hunk" : "@@ -114,9 +114,29 @@ class CCoinControl\n         vOutpoints.assign(setSelected.begin(), setSelected.end());\n     }\n \n+    void SetInputWeight(const COutPoint& outpoint, int64_t weight)\n+    {\n+        m_input_weights[outpoint] = weight;\n+    }\n+\n+    bool HasInputWeight(const COutPoint& outpoint) const\n+    {\n+        return m_input_weights.count(outpoint) > 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725094128",
      "id" : 725094128,
      "line" : 124,
      "node_id" : "PRRC_kwDOABII584rOA7w",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 124,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 11,
      "pull_request_review_id" : 775131271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725094128/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:25:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725094128",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/68476452?v=4",
         "events_url" : "https://api.github.com/users/yanmaani/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yanmaani/followers",
         "following_url" : "https://api.github.com/users/yanmaani/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yanmaani/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yanmaani",
         "id" : 68476452,
         "login" : "yanmaani",
         "node_id" : "MDQ6VXNlcjY4NDc2NDUy",
         "organizations_url" : "https://api.github.com/users/yanmaani/orgs",
         "received_events_url" : "https://api.github.com/users/yanmaani/received_events",
         "repos_url" : "https://api.github.com/users/yanmaani/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yanmaani/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yanmaani/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yanmaani"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725095840"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725095840"
         }
      },
      "author_association" : "NONE",
      "body" : "Would be cleaner to concatenate this across multiple lines so you don't have to scroll out, no?",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:10:47Z",
      "diff_hunk" : "@@ -3177,9 +3177,27 @@ static RPCHelpMan listunspent()\n     };\n }\n \n+static RPCArg InputWeightsDoc(bool include=false)\n+{\n+    if (include) {\n+        return {\n+            \"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+             {\n+                 {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                 {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                 {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, including the weight of the outpoint and sequence number. Note that signature sizes are not guaranteed to be consistent, so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725095840",
      "id" : 725095840,
      "line" : 3188,
      "node_id" : "PRRC_kwDOABII584rOBWg",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3188,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 12,
      "pull_request_review_id" : 775131271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725095840/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:25:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725095840",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/68476452?v=4",
         "events_url" : "https://api.github.com/users/yanmaani/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yanmaani/followers",
         "following_url" : "https://api.github.com/users/yanmaani/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yanmaani/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yanmaani",
         "id" : 68476452,
         "login" : "yanmaani",
         "node_id" : "MDQ6VXNlcjY4NDc2NDUy",
         "organizations_url" : "https://api.github.com/users/yanmaani/orgs",
         "received_events_url" : "https://api.github.com/users/yanmaani/received_events",
         "repos_url" : "https://api.github.com/users/yanmaani/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yanmaani/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yanmaani/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yanmaani"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725097038"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725097038"
         }
      },
      "author_association" : "NONE",
      "body" : "Any reason here not to use a C++-style loop? Granted, it's not a big difference.",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:12:22Z",
      "diff_hunk" : "@@ -3367,6 +3387,35 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n         }\n     }\n \n+    if (options.exists(\"input_weights\")) {\n+        const UniValue& inputs = options[\"input_weights\"].get_array();\n+        for (unsigned int i = 0; i < inputs.size(); ++i) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725097038",
      "id" : 725097038,
      "line" : 3392,
      "node_id" : "PRRC_kwDOABII584rOBpO",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3392,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 51,
      "pull_request_review_id" : 775131271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725097038/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:25:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725097038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/68476452?v=4",
         "events_url" : "https://api.github.com/users/yanmaani/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yanmaani/followers",
         "following_url" : "https://api.github.com/users/yanmaani/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yanmaani/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yanmaani",
         "id" : 68476452,
         "login" : "yanmaani",
         "node_id" : "MDQ6VXNlcjY4NDc2NDUy",
         "organizations_url" : "https://api.github.com/users/yanmaani/orgs",
         "received_events_url" : "https://api.github.com/users/yanmaani/received_events",
         "repos_url" : "https://api.github.com/users/yanmaani/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yanmaani/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yanmaani/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yanmaani"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725098362"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725098362"
         }
      },
      "author_association" : "NONE",
      "body" : "Comment here explaining the name of the parameter?",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:14:21Z",
      "diff_hunk" : "@@ -3446,7 +3512,7 @@ static RPCHelpMan fundrawtransaction()\n                                 },\n                             },\n                         },\n-                        FundTxDoc()),\n+                        FundTxDoc(true)),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725098362",
      "id" : 725098362,
      "line" : 3515,
      "node_id" : "PRRC_kwDOABII584rOB96",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3515,
      "original_position" : 110,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 110,
      "pull_request_review_id" : 775131271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725098362/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:25:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725098362",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/68476452?v=4",
         "events_url" : "https://api.github.com/users/yanmaani/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yanmaani/followers",
         "following_url" : "https://api.github.com/users/yanmaani/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yanmaani/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yanmaani",
         "id" : 68476452,
         "login" : "yanmaani",
         "node_id" : "MDQ6VXNlcjY4NDc2NDUy",
         "organizations_url" : "https://api.github.com/users/yanmaani/orgs",
         "received_events_url" : "https://api.github.com/users/yanmaani/received_events",
         "repos_url" : "https://api.github.com/users/yanmaani/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yanmaani/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yanmaani/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yanmaani"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725099707"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725099707"
         }
      },
      "author_association" : "NONE",
      "body" : "What's going on here? Are there two mutually exclusive ways to give the input weights?",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:16:02Z",
      "diff_hunk" : "@@ -3404,6 +3453,23 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n     }\n }\n \n+static void SetOptionsInputWeights(const UniValue& inputs, UniValue& options)\n+{\n+    if (options.exists(\"input_weights\")) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725099707",
      "id" : 725099707,
      "line" : 3458,
      "node_id" : "PRRC_kwDOABII584rOCS7",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3458,
      "original_position" : 87,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 87,
      "pull_request_review_id" : 775131271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725099707/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:25:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725099707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/68476452?v=4",
         "events_url" : "https://api.github.com/users/yanmaani/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yanmaani/followers",
         "following_url" : "https://api.github.com/users/yanmaani/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yanmaani/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yanmaani",
         "id" : 68476452,
         "login" : "yanmaani",
         "node_id" : "MDQ6VXNlcjY4NDc2NDUy",
         "organizations_url" : "https://api.github.com/users/yanmaani/orgs",
         "received_events_url" : "https://api.github.com/users/yanmaani/received_events",
         "repos_url" : "https://api.github.com/users/yanmaani/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yanmaani/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yanmaani/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yanmaani"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725101698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725101698"
         }
      },
      "author_association" : "NONE",
      "body" : "Pardon my ignorance here, but why do we need it in `mapWallet` if we have its size?",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:18:43Z",
      "diff_hunk" : "@@ -463,15 +463,17 @@ bool SelectCoins(const CWallet& wallet, const std::vector<COutput>& vAvailableCo\n             }\n             input_bytes = GetTxSpendSize(wallet, wtx, outpoint.n, false);\n             txout = wtx.tx->vout.at(outpoint.n);\n-        }\n-        if (input_bytes == -1) {\n-            // The input is external. We either did not find the tx in mapWallet, or we did but couldn't compute the input size with wallet data\n+        } else {\n+            // The input is external. We did not find the tx in mapWallet.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725101698",
      "id" : 725101698,
      "line" : 467,
      "node_id" : "PRRC_kwDOABII584rOCyC",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 467,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 8,
      "pull_request_review_id" : 775131271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725101698/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:25:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725101698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/68476452?v=4",
         "events_url" : "https://api.github.com/users/yanmaani/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yanmaani/followers",
         "following_url" : "https://api.github.com/users/yanmaani/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yanmaani/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yanmaani",
         "id" : 68476452,
         "login" : "yanmaani",
         "node_id" : "MDQ6VXNlcjY4NDc2NDUy",
         "organizations_url" : "https://api.github.com/users/yanmaani/orgs",
         "received_events_url" : "https://api.github.com/users/yanmaani/received_events",
         "repos_url" : "https://api.github.com/users/yanmaani/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yanmaani/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yanmaani/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yanmaani"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725104913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725104913"
         }
      },
      "author_association" : "NONE",
      "body" : "Are you missing the `Specify weight in inputs instead` error case?",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:22:59Z",
      "diff_hunk" : "@@ -1023,6 +1023,11 @@ def test_external_inputs(self):\n         assert_raises_rpc_error(-5, \"'01234567890a0b0c0d0e0f' is not a valid public key\", wallet.fundrawtransaction, raw_tx, {\"solving_data\": {\"pubkeys\":[\"01234567890a0b0c0d0e0f\"]}})\n         assert_raises_rpc_error(-5, \"'not a script' is not hex\", wallet.fundrawtransaction, raw_tx, {\"solving_data\": {\"scripts\":[\"not a script\"]}})\n         assert_raises_rpc_error(-8, \"Unable to parse descriptor 'not a descriptor'\", wallet.fundrawtransaction, raw_tx, {\"solving_data\": {\"descriptors\":[\"not a descriptor\"]}})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, missing vout key\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"]}]})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, vout cannot be negative\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": -1}]})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, missing weight key\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"]}]})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, weight cannot be less than 160\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": 159}]})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, weight cannot be less than 160\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": -1}]})\n ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725104913",
      "id" : 725104913,
      "line" : 1031,
      "node_id" : "PRRC_kwDOABII584rODkR",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 1031,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 9,
      "pull_request_review_id" : 775131271,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725104913/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:25:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725104913",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/68476452?v=4",
         "events_url" : "https://api.github.com/users/yanmaani/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yanmaani/followers",
         "following_url" : "https://api.github.com/users/yanmaani/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yanmaani/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yanmaani",
         "id" : 68476452,
         "login" : "yanmaani",
         "node_id" : "MDQ6VXNlcjY4NDc2NDUy",
         "organizations_url" : "https://api.github.com/users/yanmaani/orgs",
         "received_events_url" : "https://api.github.com/users/yanmaani/received_events",
         "repos_url" : "https://api.github.com/users/yanmaani/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yanmaani/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yanmaani/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yanmaani"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725125227"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725125227"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is checking whether the outpoint exists in the map. The result of `count` is always 0 or 1, it does not actually fetch the value stored.",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:50:42Z",
      "diff_hunk" : "@@ -114,9 +114,29 @@ class CCoinControl\n         vOutpoints.assign(setSelected.begin(), setSelected.end());\n     }\n \n+    void SetInputWeight(const COutPoint& outpoint, int64_t weight)\n+    {\n+        m_input_weights[outpoint] = weight;\n+    }\n+\n+    bool HasInputWeight(const COutPoint& outpoint) const\n+    {\n+        return m_input_weights.count(outpoint) > 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725125227",
      "id" : 725125227,
      "in_reply_to_id" : 725094128,
      "line" : 124,
      "node_id" : "PRRC_kwDOABII584rOIhr",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 124,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 11,
      "pull_request_review_id" : 775173618,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725125227/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:50:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725125227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725130904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725130904"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes.\r\n\r\nFor `send` and `walletcreatefundedpsbt`, the weights can and should be specified in the inputs array. To avoid conflicts, these are mutually exclusive. `input_weights` exists for `fundrawtransaction` because it does not have an `inputs` array. However it is also useful to be able to pass it as part of the `options` object, which is what this function does.",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:58:20Z",
      "diff_hunk" : "@@ -3404,6 +3453,23 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n     }\n }\n \n+static void SetOptionsInputWeights(const UniValue& inputs, UniValue& options)\n+{\n+    if (options.exists(\"input_weights\")) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725130904",
      "id" : 725130904,
      "in_reply_to_id" : 725099707,
      "line" : 3458,
      "node_id" : "PRRC_kwDOABII584rOJ6Y",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3458,
      "original_position" : 87,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 87,
      "pull_request_review_id" : 775181098,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725130904/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:58:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725130904",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725131187"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725131187"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sorry for causing the conflict, but it might be cleaner to just inline the doc here if only one RPC method is using it and none of the others.\r\n\r\n```suggestion\r\n                            },\r\n                            {\"input_weights\", RPCArg::.......\r\n```",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:58:42Z",
      "diff_hunk" : "@@ -3446,7 +3512,7 @@ static RPCHelpMan fundrawtransaction()\n                                 },\n                             },",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725131187",
      "id" : 725131187,
      "line" : 3513,
      "node_id" : "PRRC_kwDOABII584rOJ-z",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3513,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 107,
      "pull_request_review_id" : 775181460,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725131187/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:58:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725131187",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725131633"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725131633"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We are not guaranteed to have the size.",
      "commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "created_at" : "2021-10-08T15:59:24Z",
      "diff_hunk" : "@@ -463,15 +463,17 @@ bool SelectCoins(const CWallet& wallet, const std::vector<COutput>& vAvailableCo\n             }\n             input_bytes = GetTxSpendSize(wallet, wtx, outpoint.n, false);\n             txout = wtx.tx->vout.at(outpoint.n);\n-        }\n-        if (input_bytes == -1) {\n-            // The input is external. We either did not find the tx in mapWallet, or we did but couldn't compute the input size with wallet data\n+        } else {\n+            // The input is external. We did not find the tx in mapWallet.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725131633",
      "id" : 725131633,
      "in_reply_to_id" : 725101698,
      "line" : 467,
      "node_id" : "PRRC_kwDOABII584rOKFx",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 467,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 8,
      "pull_request_review_id" : 775182121,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725131633/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T15:59:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725131633",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725138412"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138412"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "created_at" : "2021-10-08T16:09:18Z",
      "diff_hunk" : "@@ -3177,9 +3177,27 @@ static RPCHelpMan listunspent()\n     };\n }\n \n+static RPCArg InputWeightsDoc(bool include=false)\n+{\n+    if (include) {\n+        return {\n+            \"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+             {\n+                 {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                 {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                 {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, including the weight of the outpoint and sequence number. Note that signature sizes are not guaranteed to be consistent, so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725138412",
      "id" : 725138412,
      "in_reply_to_id" : 725095840,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rOLvs",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3188,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 775191352,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138412/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T16:09:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138412",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725138464"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138464"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "created_at" : "2021-10-08T16:09:23Z",
      "diff_hunk" : "@@ -3367,6 +3387,35 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n         }\n     }\n \n+    if (options.exists(\"input_weights\")) {\n+        const UniValue& inputs = options[\"input_weights\"].get_array();\n+        for (unsigned int i = 0; i < inputs.size(); ++i) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725138464",
      "id" : 725138464,
      "in_reply_to_id" : 725097038,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rOLwg",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3392,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 775191443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138464/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T16:09:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138464",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725138729"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138729"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed the comment, the help can actually be inline.",
      "commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "created_at" : "2021-10-08T16:09:43Z",
      "diff_hunk" : "@@ -3446,7 +3512,7 @@ static RPCHelpMan fundrawtransaction()\n                                 },\n                             },\n                         },\n-                        FundTxDoc()),\n+                        FundTxDoc(true)),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725138729",
      "id" : 725138729,
      "in_reply_to_id" : 725098362,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rOL0p",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3515,
      "original_position" : 110,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 775191738,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138729/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T16:09:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725138729",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725139015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725139015"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done. For some reason I thought it needed to be in that function, but actually it doesn't.",
      "commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "created_at" : "2021-10-08T16:10:07Z",
      "diff_hunk" : "@@ -3446,7 +3512,7 @@ static RPCHelpMan fundrawtransaction()\n                                 },\n                             },",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725139015",
      "id" : 725139015,
      "in_reply_to_id" : 725131187,
      "line" : 3491,
      "node_id" : "PRRC_kwDOABII584rOL5H",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 3491,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 68,
      "pull_request_review_id" : 775192075,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725139015/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T16:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725139015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725147359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725147359"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added to `rpc_psbt` and `wallet_send` where it actually can be an error.",
      "commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "created_at" : "2021-10-08T16:22:25Z",
      "diff_hunk" : "@@ -1023,6 +1023,11 @@ def test_external_inputs(self):\n         assert_raises_rpc_error(-5, \"'01234567890a0b0c0d0e0f' is not a valid public key\", wallet.fundrawtransaction, raw_tx, {\"solving_data\": {\"pubkeys\":[\"01234567890a0b0c0d0e0f\"]}})\n         assert_raises_rpc_error(-5, \"'not a script' is not hex\", wallet.fundrawtransaction, raw_tx, {\"solving_data\": {\"scripts\":[\"not a script\"]}})\n         assert_raises_rpc_error(-8, \"Unable to parse descriptor 'not a descriptor'\", wallet.fundrawtransaction, raw_tx, {\"solving_data\": {\"descriptors\":[\"not a descriptor\"]}})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, missing vout key\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"]}]})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, vout cannot be negative\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": -1}]})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, missing weight key\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"]}]})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, weight cannot be less than 160\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": 159}]})\n+        assert_raises_rpc_error(-8, \"Invalid parameter, weight cannot be less than 160\", wallet.fundrawtransaction, raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": -1}]})\n ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725147359",
      "id" : 725147359,
      "in_reply_to_id" : 725104913,
      "line" : 1031,
      "node_id" : "PRRC_kwDOABII584rON7f",
      "original_commit_id" : "d0592296b13c6316cd681fc0df1effcf9c7e31e4",
      "original_line" : 1031,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 9,
      "pull_request_review_id" : 775203058,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725147359/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-08T16:22:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725147359",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725480194"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725480194"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Assuming this numbers are denoting 8 bit boundaries, why its not 255 and 265?   ",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2021-10-09T12:14:12Z",
      "diff_hunk" : "@@ -1462,6 +1462,34 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n+static void FillInputToWeight(CTxIn& txin, int64_t target_weight)\n+{\n+    int64_t txin_weight = GetTransactionInputWeight(txin);\n+    // Subtract current txin weight, which should include empty witness stack\n+    int64_t add_weight = target_weight - txin_weight;\n+\n+    // We will want to subtract the size of the Compact Size UInt that will also be serialized.\n+    // However doing so when the size is near a boundary can result in a problem where it is not\n+    // possible to have a stack element size and combination to exactly equal a target.\n+    // To avoid this possibility, if the weight to add is less than 10 bytes greater than\n+    // a boundary, the size will be split so that 2/3rds will be in one stack element, and\n+    // the remaining 1/3rd in another. Using 3rds allows us to avoid additional boundaries.\n+    // 10 bytes is used because that accounts for the maximum size. This does not need to be super precise.\n+    if ((add_weight >= 253 && add_weight < 263)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725480194",
      "id" : 725480194,
      "line" : 1523,
      "node_id" : "PRRC_kwDOABII584rPfMC",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 1523,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 17,
      "pull_request_review_id" : 775572778,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725480194/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-16T08:54:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725480194",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725497018"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725497018"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This can have the `complete == true/false` assertions too.",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2021-10-09T14:53:22Z",
      "diff_hunk" : "@@ -1032,10 +1037,38 @@ def test_external_inputs(self):\n         assert signed_tx['complete']\n \n         funded_tx = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}})\n-        signed_tx = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n-        assert not signed_tx['complete']\n-        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx['hex'])\n-        assert signed_tx['complete']\n+        signed_tx1 = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n+        assert not signed_tx1['complete']\n+        signed_tx2 = self.nodes[0].signrawtransactionwithwallet(signed_tx1['hex'])\n+        assert signed_tx2['complete']\n+\n+        unsigned_weight = self.nodes[0].decoderawtransaction(signed_tx1[\"hex\"])[\"weight\"]\n+        signed_weight = self.nodes[0].decoderawtransaction(signed_tx2[\"hex\"])[\"weight\"]\n+        # Input's weight is difference between weight of signed and unsigned,\n+        # and the weight of stuff that didn't change (prevout, sequence, 1 byte of scriptSig)\n+        input_weight = signed_weight - unsigned_weight + (45 * 4)\n+        low_input_weight = input_weight // 2\n+        high_input_weight = input_weight * 2\n+\n+        # Funding should also work if the input weight is provided\n+        funded_tx = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}]})\n+        signed_tx = wallet.signrawtransactionwithwallet(funded_tx[\"hex\"])\n+        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx[\"hex\"])\n+        assert self.nodes[0].testmempoolaccept([signed_tx[\"hex\"]])[0][\"allowed\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r725497018",
      "id" : 725497018,
      "line" : 1047,
      "node_id" : "PRRC_kwDOABII584rPjS6",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 1047,
      "original_position" : 37,
      "original_start_line" : 1055,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 55,
      "pull_request_review_id" : 775572778,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725497018/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1045,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-15T11:53:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/725497018",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "LGTM",
      "created_at" : "2021-10-11T10:46:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-939911058",
      "id" : 939911058,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5844BeeS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939911058/reactions"
      },
      "updated_at" : "2021-10-11T10:46:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/939911058",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/68476452?v=4",
         "events_url" : "https://api.github.com/users/yanmaani/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yanmaani/followers",
         "following_url" : "https://api.github.com/users/yanmaani/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yanmaani/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yanmaani",
         "id" : 68476452,
         "login" : "yanmaani",
         "node_id" : "MDQ6VXNlcjY4NDc2NDUy",
         "organizations_url" : "https://api.github.com/users/yanmaani/orgs",
         "received_events_url" : "https://api.github.com/users/yanmaani/received_events",
         "repos_url" : "https://api.github.com/users/yanmaani/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yanmaani/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yanmaani/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yanmaani"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731363383"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731363383"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It seems that all callers already check for this. Instead of returning -1, how about\r\n```cpp\r\nint64_t GetInputWeight(const COutPoint& outpoint) const\r\n{\r\n    auto it = m_input_weights.find(output);\r\n    assert(it != m_input_weights.end();\r\n    return it->second;\r\n}\r\n```",
      "commit_id" : "cea4f3489b675c9271c91da6f9bd9d9f4eff5af0",
      "created_at" : "2021-10-18T22:35:43Z",
      "diff_hunk" : "@@ -114,9 +114,29 @@ class CCoinControl\n         vOutpoints.assign(setSelected.begin(), setSelected.end());\n     }\n \n+    void SetInputWeight(const COutPoint& outpoint, int64_t weight)\n+    {\n+        m_input_weights[outpoint] = weight;\n+    }\n+\n+    bool HasInputWeight(const COutPoint& outpoint) const\n+    {\n+        return m_input_weights.count(outpoint) > 0;\n+    }\n+\n+    int64_t GetInputWeight(const COutPoint& outpoint) const\n+    {\n+        if (HasInputWeight(outpoint)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731363383",
      "id" : 731363383,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rl7g3",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 129,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 782637722,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731363383/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-18T22:53:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731363383",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731367942"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731367942"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Instead of this check, check below:\r\n```cpp\r\nif (!weights.empty()) {\r\n    options.pushKV(\"input_weights\", weights);\r\n}\r\n```",
      "commit_id" : "cea4f3489b675c9271c91da6f9bd9d9f4eff5af0",
      "created_at" : "2021-10-18T22:46:22Z",
      "diff_hunk" : "@@ -3404,6 +3431,23 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n     }\n }\n \n+static void SetOptionsInputWeights(const UniValue& inputs, UniValue& options)\n+{\n+    if (options.exists(\"input_weights\")) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify weight in inputs instead\");\n+    }\n+    if (inputs.size() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731367942",
      "id" : 731367942,
      "line" : 3439,
      "node_id" : "PRRC_kwDOABII584rl8oG",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 3439,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 50,
      "pull_request_review_id" : 782637722,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731367942/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-18T22:53:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731367942",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731394750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731394750"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "cea4f3489b675c9271c91da6f9bd9d9f4eff5af0",
      "created_at" : "2021-10-18T23:57:05Z",
      "diff_hunk" : "@@ -114,9 +114,29 @@ class CCoinControl\n         vOutpoints.assign(setSelected.begin(), setSelected.end());\n     }\n \n+    void SetInputWeight(const COutPoint& outpoint, int64_t weight)\n+    {\n+        m_input_weights[outpoint] = weight;\n+    }\n+\n+    bool HasInputWeight(const COutPoint& outpoint) const\n+    {\n+        return m_input_weights.count(outpoint) > 0;\n+    }\n+\n+    int64_t GetInputWeight(const COutPoint& outpoint) const\n+    {\n+        if (HasInputWeight(outpoint)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731394750",
      "id" : 731394750,
      "in_reply_to_id" : 731363383,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rmDK-",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 129,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 782674268,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731394750/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-18T23:57:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731394750",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731394871"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731394871"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This doesn't work because `inputs.getValues()` expects `inputs` to be non-null.",
      "commit_id" : "cea4f3489b675c9271c91da6f9bd9d9f4eff5af0",
      "created_at" : "2021-10-18T23:57:25Z",
      "diff_hunk" : "@@ -3404,6 +3431,23 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n     }\n }\n \n+static void SetOptionsInputWeights(const UniValue& inputs, UniValue& options)\n+{\n+    if (options.exists(\"input_weights\")) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify weight in inputs instead\");\n+    }\n+    if (inputs.size() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731394871",
      "id" : 731394871,
      "in_reply_to_id" : 731367942,
      "line" : 3439,
      "node_id" : "PRRC_kwDOABII584rmDM3",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 3439,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 50,
      "pull_request_review_id" : 782674406,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731394871/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-18T23:57:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731394871",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731436662"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731436662"
         }
      },
      "author_association" : "NONE",
      "body" : "> It seems that all callers already check for this. Instead of returning -1, how about\n> \n> ```cpp\n> \n> int64_t GetInputWeight(const COutPoint& outpoint) const\n> \n> {\n> \n>     auto it = m_input_weights.find(output);\n> \n>     assert(it != m_input_weights.end();\n> \n>     return it->second;\n> \n> }\n> \n> ```\n\n",
      "commit_id" : "cea4f3489b675c9271c91da6f9bd9d9f4eff5af0",
      "created_at" : "2021-10-19T02:02:43Z",
      "diff_hunk" : "@@ -114,9 +114,29 @@ class CCoinControl\n         vOutpoints.assign(setSelected.begin(), setSelected.end());\n     }\n \n+    void SetInputWeight(const COutPoint& outpoint, int64_t weight)\n+    {\n+        m_input_weights[outpoint] = weight;\n+    }\n+\n+    bool HasInputWeight(const COutPoint& outpoint) const\n+    {\n+        return m_input_weights.count(outpoint) > 0;\n+    }\n+\n+    int64_t GetInputWeight(const COutPoint& outpoint) const\n+    {\n+        if (HasInputWeight(outpoint)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731436662",
      "id" : 731436662,
      "in_reply_to_id" : 731363383,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584rmNZ2",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 129,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : null,
      "pull_request_review_id" : 782723007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731436662/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-19T02:03:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731436662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/87052011?v=4",
         "events_url" : "https://api.github.com/users/Sophia60/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sophia60/followers",
         "following_url" : "https://api.github.com/users/Sophia60/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sophia60/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sophia60",
         "id" : 87052011,
         "login" : "Sophia60",
         "node_id" : "MDQ6VXNlcjg3MDUyMDEx",
         "organizations_url" : "https://api.github.com/users/Sophia60/orgs",
         "received_events_url" : "https://api.github.com/users/Sophia60/received_events",
         "repos_url" : "https://api.github.com/users/Sophia60/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sophia60/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sophia60/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sophia60"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731579384"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731579384"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, right ð  you can keep the check below to avoid `\"input_weights\": []`.",
      "commit_id" : "cea4f3489b675c9271c91da6f9bd9d9f4eff5af0",
      "created_at" : "2021-10-19T07:40:10Z",
      "diff_hunk" : "@@ -3404,6 +3431,23 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n     }\n }\n \n+static void SetOptionsInputWeights(const UniValue& inputs, UniValue& options)\n+{\n+    if (options.exists(\"input_weights\")) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify weight in inputs instead\");\n+    }\n+    if (inputs.size() == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r731579384",
      "id" : 731579384,
      "in_reply_to_id" : 731367942,
      "line" : 3439,
      "node_id" : "PRRC_kwDOABII584rmwP4",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 3439,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 50,
      "pull_request_review_id" : 782898092,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731579384/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-10-19T07:40:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/731579384",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Looks like this PR has multiple concept ACKs (and an E2E test with lightning!), is it possible to move forward with it?",
      "created_at" : "2021-11-10T13:54:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-965198257",
      "id" : 965198257,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5845h8Gx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/965198257/reactions"
      },
      "updated_at" : "2021-11-10T13:54:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/965198257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It would be really great to have this PR integrated for pre-signed transaction protocols (and ideally a follow-up to add these arguments to the bump fee RPCs), it would really make using the `bitcoind` RPC much smoother!",
      "created_at" : "2021-11-29T15:46:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-981760029",
      "id" : 981760029,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5846hHgd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/981760029/reactions"
      },
      "updated_at" : "2021-11-29T15:46:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/981760029",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/31281497?v=4",
         "events_url" : "https://api.github.com/users/t-bast/events{/privacy}",
         "followers_url" : "https://api.github.com/users/t-bast/followers",
         "following_url" : "https://api.github.com/users/t-bast/following{/other_user}",
         "gists_url" : "https://api.github.com/users/t-bast/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/t-bast",
         "id" : 31281497,
         "login" : "t-bast",
         "node_id" : "MDQ6VXNlcjMxMjgxNDk3",
         "organizations_url" : "https://api.github.com/users/t-bast/orgs",
         "received_events_url" : "https://api.github.com/users/t-bast/received_events",
         "repos_url" : "https://api.github.com/users/t-bast/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/t-bast/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/t-bast/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/t-bast"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-12-08T05:22:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-988509631",
      "id" : 988509631,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII584663W_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/988509631/reactions"
      },
      "updated_at" : "2021-12-08T05:22:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/988509631",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-12-09T17:10:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-990048646",
      "id" : 990048646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5847AvGG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/990048646/reactions"
      },
      "updated_at" : "2021-12-09T17:10:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/990048646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r778190801"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778190801"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "this will be skipped if `!coin_control.GetExternalOutput(outpoint, txout)`, which should happen for some external inputs, no?",
      "commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "created_at" : "2022-01-04T15:53:54Z",
      "diff_hunk" : "@@ -454,15 +454,17 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n             }\n             input_bytes = GetTxSpendSize(wallet, wtx, outpoint.n, false);\n             txout = wtx.tx->vout.at(outpoint.n);\n-        }\n-        if (input_bytes == -1) {\n-            // The input is external. We either did not find the tx in mapWallet, or we did but couldn't compute the input size with wallet data\n+        } else {\n+            // The input is external. We did not find the tx in mapWallet.\n             if (!coin_control.GetExternalOutput(outpoint, txout)) {\n-                // Not ours, and we don't have solving data.\n                 return std::nullopt;\n             }\n             input_bytes = CalculateMaximumSignedInputSize(txout, &coin_control.m_external_provider, /* use_max_sig */ true);\n         }\n+        // If available, override calculated size with coin control specified size\n+        if (coin_control.HasInputWeight(outpoint)) {\n+            input_bytes = GetVirtualTransactionSize(coin_control.GetInputWeight(outpoint), 0, 0);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r778190801",
      "id" : 778190801,
      "line" : 467,
      "node_id" : "PRRC_kwDOABII584uYj_R",
      "original_commit_id" : "e150c15f66818a4ded2e0038ee273a139cd9e2bb",
      "original_line" : 467,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 18,
      "pull_request_review_id" : 843722749,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778190801/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-04T15:58:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/778190801",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r781484817"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781484817"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think that's right. If `!coin_control.GetExternalOutput`, then we can't do coin selection at all and would have returned at an earlier point.",
      "commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "created_at" : "2022-01-10T19:24:34Z",
      "diff_hunk" : "@@ -454,15 +454,17 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n             }\n             input_bytes = GetTxSpendSize(wallet, wtx, outpoint.n, false);\n             txout = wtx.tx->vout.at(outpoint.n);\n-        }\n-        if (input_bytes == -1) {\n-            // The input is external. We either did not find the tx in mapWallet, or we did but couldn't compute the input size with wallet data\n+        } else {\n+            // The input is external. We did not find the tx in mapWallet.\n             if (!coin_control.GetExternalOutput(outpoint, txout)) {\n-                // Not ours, and we don't have solving data.\n                 return std::nullopt;\n             }\n             input_bytes = CalculateMaximumSignedInputSize(txout, &coin_control.m_external_provider, /* use_max_sig */ true);\n         }\n+        // If available, override calculated size with coin control specified size\n+        if (coin_control.HasInputWeight(outpoint)) {\n+            input_bytes = GetVirtualTransactionSize(coin_control.GetInputWeight(outpoint), 0, 0);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r781484817",
      "id" : 781484817,
      "in_reply_to_id" : 778190801,
      "line" : 467,
      "node_id" : "PRRC_kwDOABII584ulIMR",
      "original_commit_id" : "e150c15f66818a4ded2e0038ee273a139cd9e2bb",
      "original_line" : 467,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 18,
      "pull_request_review_id" : 848247234,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781484817/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-10T19:24:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/781484817",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r783933728"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783933728"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in e519573f81:\r\n\r\nIt may be confusing if you expect the input to be in weight units, but mention using 73 bytes in the helpstring",
      "commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "created_at" : "2022-01-13T12:58:45Z",
      "diff_hunk" : "@@ -625,6 +669,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                                    {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, \"\n+                                        \"including the weight of the outpoint and sequence number. \"\n+                                        \"Note that signature sizes are not guaranteed to be consistent, \"\n+                                        \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r783933728",
      "id" : 783933728,
      "line" : 679,
      "node_id" : "PRRC_kwDOABII584uueEg",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 679,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 76,
      "pull_request_review_id" : 851677138,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783933728/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T13:37:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783933728",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r783940124"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783940124"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Please add some unit tests for this function? Given that there's so much consideration for boundaries, etc.",
      "commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "created_at" : "2022-01-13T13:07:35Z",
      "diff_hunk" : "@@ -1474,6 +1474,34 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n+static void FillInputToWeight(CTxIn& txin, int64_t target_weight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r783940124",
      "id" : 783940124,
      "line" : 1477,
      "node_id" : "PRRC_kwDOABII584uufoc",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 1477,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 851677138,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783940124/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T13:37:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783940124",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r783948566"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783948566"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Perhaps also test providing a feerate and ensure that the fee / total size is enough?",
      "commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "created_at" : "2022-01-13T13:18:42Z",
      "diff_hunk" : "@@ -1027,10 +1032,38 @@ def test_external_inputs(self):\n         assert signed_tx['complete']\n \n         funded_tx = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}})\n-        signed_tx = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n-        assert not signed_tx['complete']\n-        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx['hex'])\n-        assert signed_tx['complete']\n+        signed_tx1 = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n+        assert not signed_tx1['complete']\n+        signed_tx2 = self.nodes[0].signrawtransactionwithwallet(signed_tx1['hex'])\n+        assert signed_tx2['complete']\n+\n+        unsigned_weight = self.nodes[0].decoderawtransaction(signed_tx1[\"hex\"])[\"weight\"]\n+        signed_weight = self.nodes[0].decoderawtransaction(signed_tx2[\"hex\"])[\"weight\"]\n+        # Input's weight is difference between weight of signed and unsigned,\n+        # and the weight of stuff that didn't change (prevout, sequence, 1 byte of scriptSig)\n+        input_weight = signed_weight - unsigned_weight + (45 * 4)\n+        low_input_weight = input_weight // 2\n+        high_input_weight = input_weight * 2\n+\n+        # Funding should also work if the input weight is provided\n+        funded_tx = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}]})\n+        signed_tx = wallet.signrawtransactionwithwallet(funded_tx[\"hex\"])\n+        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx[\"hex\"])\n+        assert self.nodes[0].testmempoolaccept([signed_tx[\"hex\"]])[0][\"allowed\"]\n+        # Reducing the weight should have a lower fee\n+        funded_tx2 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": low_input_weight}]})\n+        assert_greater_than(funded_tx[\"fee\"], funded_tx2[\"fee\"])\n+        # Increasing the weight should have a higher fee",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r783948566",
      "id" : 783948566,
      "line" : 1056,
      "node_id" : "PRRC_kwDOABII584uuhsW",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 1056,
      "original_position" : 41,
      "original_start_line" : 1049,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 41,
      "pull_request_review_id" : 851677138,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783948566/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1049,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-13T13:37:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783948566",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r784272109"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784272109"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm not sure how to better word this. Signatures have different weights depending on whether they are witness, but they all have the same max physical bytes size.",
      "commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "created_at" : "2022-01-13T19:42:37Z",
      "diff_hunk" : "@@ -625,6 +669,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                                    {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, \"\n+                                        \"including the weight of the outpoint and sequence number. \"\n+                                        \"Note that signature sizes are not guaranteed to be consistent, \"\n+                                        \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r784272109",
      "id" : 784272109,
      "in_reply_to_id" : 783933728,
      "line" : 679,
      "node_id" : "PRRC_kwDOABII584uvwrt",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 679,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 76,
      "pull_request_review_id" : 852166435,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784272109/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T19:42:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784272109",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r784743548"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784743548"
         }
      },
      "author_association" : "MEMBER",
      "body" : "True, that makes sense.\r\n\r\nI guess my actual concern was that people might mix up weight units and virtual bytes, and end up with bugs where they underestimate the size and don't add enough fees. But given that they'd be off by a factor of 4 and you have a sanity check minimum 160, probably they'll discover this mistake really quickly.",
      "commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "created_at" : "2022-01-14T10:47:18Z",
      "diff_hunk" : "@@ -625,6 +669,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                                    {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, \"\n+                                        \"including the weight of the outpoint and sequence number. \"\n+                                        \"Note that signature sizes are not guaranteed to be consistent, \"\n+                                        \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r784743548",
      "id" : 784743548,
      "in_reply_to_id" : 783933728,
      "line" : 679,
      "node_id" : "PRRC_kwDOABII584uxjx8",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 679,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 76,
      "pull_request_review_id" : 852776598,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784743548/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-14T10:47:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784743548",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785131131"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785131131"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-14T19:49:26Z",
      "diff_hunk" : "@@ -1474,6 +1474,34 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n+static void FillInputToWeight(CTxIn& txin, int64_t target_weight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785131131",
      "id" : 785131131,
      "in_reply_to_id" : 783940124,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584uzCZ7",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 1477,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 853326035,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785131131/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-14T19:49:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785131131",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785131158"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785131158"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-14T19:49:30Z",
      "diff_hunk" : "@@ -1027,10 +1032,38 @@ def test_external_inputs(self):\n         assert signed_tx['complete']\n \n         funded_tx = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}})\n-        signed_tx = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n-        assert not signed_tx['complete']\n-        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx['hex'])\n-        assert signed_tx['complete']\n+        signed_tx1 = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n+        assert not signed_tx1['complete']\n+        signed_tx2 = self.nodes[0].signrawtransactionwithwallet(signed_tx1['hex'])\n+        assert signed_tx2['complete']\n+\n+        unsigned_weight = self.nodes[0].decoderawtransaction(signed_tx1[\"hex\"])[\"weight\"]\n+        signed_weight = self.nodes[0].decoderawtransaction(signed_tx2[\"hex\"])[\"weight\"]\n+        # Input's weight is difference between weight of signed and unsigned,\n+        # and the weight of stuff that didn't change (prevout, sequence, 1 byte of scriptSig)\n+        input_weight = signed_weight - unsigned_weight + (45 * 4)\n+        low_input_weight = input_weight // 2\n+        high_input_weight = input_weight * 2\n+\n+        # Funding should also work if the input weight is provided\n+        funded_tx = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}]})\n+        signed_tx = wallet.signrawtransactionwithwallet(funded_tx[\"hex\"])\n+        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx[\"hex\"])\n+        assert self.nodes[0].testmempoolaccept([signed_tx[\"hex\"]])[0][\"allowed\"]\n+        # Reducing the weight should have a lower fee\n+        funded_tx2 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": low_input_weight}]})\n+        assert_greater_than(funded_tx[\"fee\"], funded_tx2[\"fee\"])\n+        # Increasing the weight should have a higher fee",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785131158",
      "id" : 785131158,
      "in_reply_to_id" : 783948566,
      "line" : 1051,
      "node_id" : "PRRC_kwDOABII584uzCaW",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 1051,
      "original_position" : 41,
      "original_start_line" : 1049,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 59,
      "pull_request_review_id" : 853326079,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785131158/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1044,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-14T19:49:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785131158",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785296288"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785296288"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should this be \"maximum weight\" or provided \"user input weight\"? ",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-15T10:52:13Z",
      "diff_hunk" : "@@ -115,9 +115,28 @@ class CCoinControl\n         vOutpoints.assign(setSelected.begin(), setSelected.end());\n     }\n \n+    void SetInputWeight(const COutPoint& outpoint, int64_t weight)\n+    {\n+        m_input_weights[outpoint] = weight;\n+    }\n+\n+    bool HasInputWeight(const COutPoint& outpoint) const\n+    {\n+        return m_input_weights.count(outpoint) > 0;\n+    }\n+\n+    int64_t GetInputWeight(const COutPoint& outpoint) const\n+    {\n+        auto it = m_input_weights.find(outpoint);\n+        assert(it != m_input_weights.end());\n+        return it->second;\n+    }\n+\n private:\n     std::set<COutPoint> setSelected;\n     std::map<COutPoint, CTxOut> m_external_txouts;\n+    //! Map of COutPoints to the maximum weight for that input",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785296288",
      "id" : 785296288,
      "line" : 138,
      "node_id" : "PRRC_kwDOABII584uzqug",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 138,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 24,
      "pull_request_review_id" : 775572778,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785296288/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-15T11:53:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785296288",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785655153"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785655153"
         }
      },
      "author_association" : "MEMBER",
      "body" : "maybe just put \"serialized size\" to make it clear this comment is not suggesting how much weight it takes on any particular context.",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T05:59:21Z",
      "diff_hunk" : "@@ -625,6 +669,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                                    {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, \"\n+                                        \"including the weight of the outpoint and sequence number. \"\n+                                        \"Note that signature sizes are not guaranteed to be consistent, \"\n+                                        \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785655153",
      "id" : 785655153,
      "in_reply_to_id" : 783933728,
      "line" : 680,
      "node_id" : "PRRC_kwDOABII584u1CVx",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 680,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 76,
      "pull_request_review_id" : 853906031,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785655153/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T05:59:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785655153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785706830"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785706830"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Can this error message be written like \"input weights already exists in option, remove them and try again\"? It might be a little more clear on the intent of this check? This clearly tells whats wrong in the option values and how to fix it.    ",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T07:47:09Z",
      "diff_hunk" : "@@ -585,6 +612,23 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n     }\n }\n \n+static void SetOptionsInputWeights(const UniValue& inputs, UniValue& options)\n+{\n+    if (options.exists(\"input_weights\")) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify weight in inputs instead\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785706830",
      "id" : 785706830,
      "line" : 618,
      "node_id" : "PRRC_kwDOABII584u1O9O",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 618,
      "original_position" : 48,
      "original_start_line" : 617,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 48,
      "pull_request_review_id" : 853976269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785706830/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 617,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T11:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785706830",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785709242"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785709242"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Or may be just add one more line saying \"weight = total byte size * 4\"? In that way it conveys both that these are two different units and how to go from one to another. ",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T07:51:37Z",
      "diff_hunk" : "@@ -625,6 +669,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                                    {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, \"\n+                                        \"including the weight of the outpoint and sequence number. \"\n+                                        \"Note that signature sizes are not guaranteed to be consistent, \"\n+                                        \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785709242",
      "id" : 785709242,
      "in_reply_to_id" : 783933728,
      "line" : 680,
      "node_id" : "PRRC_kwDOABII584u1Pi6",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 680,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 76,
      "pull_request_review_id" : 853976269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 1,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785709242/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T11:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785709242",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785710287"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785710287"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think its more standard to call it an index? \r\n```suggestion\r\n                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output index\"},\r\n```",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T07:53:35Z",
      "diff_hunk" : "@@ -626,6 +670,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785710287",
      "id" : 785710287,
      "line" : 676,
      "node_id" : "PRRC_kwDOABII584u1PzP",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 676,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 72,
      "pull_request_review_id" : 853976269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785710287/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T11:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785710287",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785776462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785776462"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this is an extra space? ",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T09:26:32Z",
      "diff_hunk" : "@@ -939,6 +939,9 @@ bool AddWalletSetting(interfaces::Chain& chain, const std::string& wallet_name);\n bool RemoveWalletSetting(interfaces::Chain& chain, const std::string& wallet_name);\n \n bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut &txout, bool use_max_sig);\n+\n+void FillInputToWeight(CTxIn& txin, int64_t target_weight);\n } // namespace wallet\n \n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785776462",
      "id" : 785776462,
      "line" : 946,
      "node_id" : "PRRC_kwDOABII584u1f9O",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 946,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 8,
      "pull_request_review_id" : 853976269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785776462/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T11:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785776462",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785839927"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785839927"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I would expect the solving data error should notify here \"solving data not provided\" or something like that. Not \"Insufficient funds\". Can this be ensured by putting required funds in input and then omitting solving data? ",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T10:43:47Z",
      "diff_hunk" : "@@ -1003,14 +1005,19 @@ def test_external_inputs(self):\n         ext_utxo = self.nodes[0].listunspent(addresses=[addr])[0]\n \n         # An external input without solving data should result in an error\n-        raw_tx = wallet.createrawtransaction([ext_utxo], {self.nodes[0].getnewaddress(): 15})\n+        raw_tx = wallet.createrawtransaction([ext_utxo], {self.nodes[0].getnewaddress(): ext_utxo[\"amount\"] / 2})\n         assert_raises_rpc_error(-4, \"Insufficient funds\", wallet.fundrawtransaction, raw_tx)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785839927",
      "id" : 785839927,
      "line" : 1009,
      "node_id" : "PRRC_kwDOABII584u1vc3",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 1009,
      "original_position" : 15,
      "original_start_line" : 1008,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 15,
      "pull_request_review_id" : 853976269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785839927/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1008,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T11:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785839927",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785840712"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785840712"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Same regarding \"Insufficient funds\" error here.",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T10:44:49Z",
      "diff_hunk" : "@@ -622,26 +626,97 @@ def test_psbt_input_keys(psbt_input, keys):\n         addr_info = self.nodes[0].getaddressinfo(addr)\n \n         self.nodes[0].sendtoaddress(addr, 10)\n+        self.nodes[0].sendtoaddress(wallet.getnewaddress(), 10)\n         self.generate(self.nodes[0], 6)\n         ext_utxo = self.nodes[0].listunspent(addresses=[addr])[0]\n \n         # An external input without solving data should result in an error\n-        assert_raises_rpc_error(-4, \"Insufficient funds\", self.nodes[1].walletcreatefundedpsbt, [ext_utxo], {self.nodes[0].getnewaddress(): 10 + ext_utxo['amount']}, 0, {'add_inputs': True})\n+        assert_raises_rpc_error(-4, \"Insufficient funds\", wallet.walletcreatefundedpsbt, [ext_utxo], {self.nodes[0].getnewaddress(): 15})",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785840712",
      "id" : 785840712,
      "line" : 634,
      "node_id" : "PRRC_kwDOABII584u1vpI",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 634,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "test/functional/rpc_psbt.py",
      "position" : 27,
      "pull_request_review_id" : 853976269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785840712/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T11:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785840712",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785856067"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785856067"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "We can also send by providing solving data and descriptor. I think those checks could get covered here too like other tests. ",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T11:00:10Z",
      "diff_hunk" : "@@ -518,5 +518,42 @@ def run_test(self):\n         assert signed[\"complete\"]\n         self.nodes[0].finalizepsbt(signed[\"psbt\"])\n \n+        dec = self.nodes[0].decodepsbt(signed[\"psbt\"])\n+        for i, txin in enumerate(dec[\"tx\"][\"vin\"]):\n+            if txin[\"txid\"] == ext_utxo[\"txid\"] and txin[\"vout\"] == ext_utxo[\"vout\"]:\n+                input_idx = i\n+                break\n+        psbt_in = dec[\"inputs\"][input_idx]\n+        # Calculate the input weight\n+        # (prevout + sequence + length of scriptSig + 2 bytes buffer) * 4 + len of scriptwitness\n+        len_scriptsig = len(psbt_in[\"final_scriptSig\"][\"hex\"]) // 2 if \"final_scriptSig\" in psbt_in else 0\n+        len_scriptwitness = len(psbt_in[\"final_scriptwitness\"][\"hex\"]) // 2 if \"final_scriptwitness\" in psbt_in else 0\n+        input_weight = ((44 + len_scriptsig + 2) * 4) + len_scriptwitness\n+\n+        # Input weight error conditions\n+        assert_raises_rpc_error(\n+            -8,\n+            \"Specify weight in inputs instead\",\n+            ext_wallet.send,\n+            outputs={self.nodes[0].getnewaddress(): 15},\n+            options={\"inputs\": [ext_utxo], \"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": 1000}]}\n+        )\n+\n+        # Funding should also work when input weights are provided\n+        res = self.test_send(\n+            from_wallet=ext_wallet,\n+            to_wallet=self.nodes[0],\n+            amount=15,\n+            inputs=[{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}],\n+            add_inputs=True,\n+            psbt=True,\n+            include_watching=True\n+        )\n+        signed = ext_wallet.walletprocesspsbt(res[\"psbt\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785856067",
      "id" : 785856067,
      "line" : 552,
      "node_id" : "PRRC_kwDOABII584u1zZD",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 552,
      "original_position" : 35,
      "original_start_line" : 543,
      "path" : "test/functional/wallet_send.py",
      "position" : 35,
      "pull_request_review_id" : 853976269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785856067/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 543,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T11:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785856067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is this for 0.23?",
      "created_at" : "2022-01-17T11:34:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-1014423734",
      "id" : 1014423734,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII5848duC2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 1,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1014423734/reactions"
      },
      "updated_at" : "2022-01-17T11:34:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1014423734",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785979972"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785979972"
         }
      },
      "author_association" : "MEMBER",
      "body" : "linter:\r\n\r\ntest/functional/rpc_fundrawtransaction.py:1059:9: F841 local variable 'signed_tx4' is assigned to but never used",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T12:52:39Z",
      "diff_hunk" : "@@ -1020,10 +1027,45 @@ def test_external_inputs(self):\n         assert signed_tx['complete']\n \n         funded_tx = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}})\n-        signed_tx = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n-        assert not signed_tx['complete']\n-        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx['hex'])\n-        assert signed_tx['complete']\n+        signed_tx1 = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n+        assert not signed_tx1['complete']\n+        signed_tx2 = self.nodes[0].signrawtransactionwithwallet(signed_tx1['hex'])\n+        assert signed_tx2['complete']\n+\n+        unsigned_weight = self.nodes[0].decoderawtransaction(signed_tx1[\"hex\"])[\"weight\"]\n+        signed_weight = self.nodes[0].decoderawtransaction(signed_tx2[\"hex\"])[\"weight\"]\n+        # Input's weight is difference between weight of signed and unsigned,\n+        # and the weight of stuff that didn't change (prevout, sequence, 1 byte of scriptSig)\n+        input_weight = signed_weight - unsigned_weight + (41 * 4)\n+        low_input_weight = input_weight // 2\n+        high_input_weight = input_weight * 2\n+\n+        # Funding should also work if the input weight is provided\n+        funded_tx = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}]})\n+        signed_tx = wallet.signrawtransactionwithwallet(funded_tx[\"hex\"])\n+        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx[\"hex\"])\n+        assert self.nodes[0].testmempoolaccept([signed_tx[\"hex\"]])[0][\"allowed\"]\n+        # Reducing the weight should have a lower fee\n+        funded_tx2 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": low_input_weight}]})\n+        assert_greater_than(funded_tx[\"fee\"], funded_tx2[\"fee\"])\n+        # Increasing the weight should have a higher fee\n+        funded_tx2 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": high_input_weight}]})\n+        assert_greater_than(funded_tx2[\"fee\"], funded_tx[\"fee\"])\n+        # The provided weight should override the calculated weight when solving data is provided\n+        funded_tx3 = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}, \"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": high_input_weight}]})\n+        assert_equal(funded_tx2[\"fee\"], funded_tx3[\"fee\"])\n+        # The feerate should be met\n+        funded_tx4 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": high_input_weight}], \"fee_rate\": 10})\n+        signed_tx4 = wallet.signrawtransactionwithwallet(funded_tx4[\"hex\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785979972",
      "id" : 785979972,
      "line" : 1059,
      "node_id" : "PRRC_kwDOABII584u2RpE",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 1059,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 67,
      "pull_request_review_id" : 854359346,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785979972/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T14:16:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785979972",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785982082"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785982082"
         }
      },
      "author_association" : "MEMBER",
      "body" : "\"weight = total byte size * 4\" is not true.\r\n\r\nI would add \"Remember to use weight units, not serialized size or virtual bytes, when calculating signature size\" to the end of the helpstring. Sorry to be nitpicking this, it's not blocking for me.",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T12:55:34Z",
      "diff_hunk" : "@@ -625,6 +669,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                                    {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, \"\n+                                        \"including the weight of the outpoint and sequence number. \"\n+                                        \"Note that signature sizes are not guaranteed to be consistent, \"\n+                                        \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785982082",
      "id" : 785982082,
      "in_reply_to_id" : 783933728,
      "line" : 680,
      "node_id" : "PRRC_kwDOABII584u2SKC",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 680,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 76,
      "pull_request_review_id" : 854359346,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785982082/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T14:16:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785982082",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785983616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785983616"
         }
      },
      "author_association" : "MEMBER",
      "body" : "imo maximum weight. This is `CCoinControl` so everything is implicitly user input.",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T12:57:52Z",
      "diff_hunk" : "@@ -115,9 +115,28 @@ class CCoinControl\n         vOutpoints.assign(setSelected.begin(), setSelected.end());\n     }\n \n+    void SetInputWeight(const COutPoint& outpoint, int64_t weight)\n+    {\n+        m_input_weights[outpoint] = weight;\n+    }\n+\n+    bool HasInputWeight(const COutPoint& outpoint) const\n+    {\n+        return m_input_weights.count(outpoint) > 0;\n+    }\n+\n+    int64_t GetInputWeight(const COutPoint& outpoint) const\n+    {\n+        auto it = m_input_weights.find(outpoint);\n+        assert(it != m_input_weights.end());\n+        return it->second;\n+    }\n+\n private:\n     std::set<COutPoint> setSelected;\n     std::map<COutPoint, CTxOut> m_external_txouts;\n+    //! Map of COutPoints to the maximum weight for that input",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r785983616",
      "id" : 785983616,
      "in_reply_to_id" : 785296288,
      "line" : 138,
      "node_id" : "PRRC_kwDOABII584u2SiA",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 138,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/coincontrol.h",
      "position" : 24,
      "pull_request_review_id" : 854359346,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785983616/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T14:16:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785983616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786094708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786094708"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> I don't think that's right. If !coin_control.GetExternalOutput, then we can't do coin selection at all and would have returned at an earlier point.\r\n\r\nReviewed code and I agree with this. If it's an external input, we must have not found it in `mapWallet`. If we also didn't find it in `GetExternalOutput()`, then we already returned `nullopt` on line 461.",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T15:10:10Z",
      "diff_hunk" : "@@ -454,15 +454,17 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n             }\n             input_bytes = GetTxSpendSize(wallet, wtx, outpoint.n, false);\n             txout = wtx.tx->vout.at(outpoint.n);\n-        }\n-        if (input_bytes == -1) {\n-            // The input is external. We either did not find the tx in mapWallet, or we did but couldn't compute the input size with wallet data\n+        } else {\n+            // The input is external. We did not find the tx in mapWallet.\n             if (!coin_control.GetExternalOutput(outpoint, txout)) {\n-                // Not ours, and we don't have solving data.\n                 return std::nullopt;\n             }\n             input_bytes = CalculateMaximumSignedInputSize(txout, &coin_control.m_external_provider, /* use_max_sig */ true);\n         }\n+        // If available, override calculated size with coin control specified size\n+        if (coin_control.HasInputWeight(outpoint)) {\n+            input_bytes = GetVirtualTransactionSize(coin_control.GetInputWeight(outpoint), 0, 0);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786094708",
      "id" : 786094708,
      "in_reply_to_id" : 778190801,
      "line" : 468,
      "node_id" : "PRRC_kwDOABII584u2tp0",
      "original_commit_id" : "e150c15f66818a4ded2e0038ee273a139cd9e2bb",
      "original_line" : 468,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 18,
      "pull_request_review_id" : 854529030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786094708/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T16:17:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786094708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786127043"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786127043"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Manually tested this function a little bit. Passing in any `target_weight` less than 166 causes this to crash.\r\nError is `cannot create std::vector larger than max_size()` because `add_weight` is 0 and the compact size of that is 1, so you're calling `scriptWitness.stack.emplace()` with an argument of -1 bytes.\r\n\r\nAlso when I print `GetTransactionInputWeight(CTxIn())`, I get 165.\r\n\r\nI don't know if 166 would be a better minimum than 160. But my point is, this function has some preconditions, i.e. `assert(txin_weight < target_weight)` and `assert(add_weight >= GetSizeOfCompactSize(add_weight)`, that aren't enforced by the RPC input sanitization. It's probably not good to crash if the user passes in a legal input? Perhaps they're confused and thought they were putting 162 virtual bytes, for example.",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T15:50:39Z",
      "diff_hunk" : "@@ -1507,6 +1507,34 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n+void FillInputToWeight(CTxIn& txin, int64_t target_weight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786127043",
      "id" : 786127043,
      "line" : 1510,
      "node_id" : "PRRC_kwDOABII584u21jD",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 1510,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 854529030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786127043/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T16:36:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786127043",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786135708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786135708"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I was confused about this as well since I had never come across compact size uints before. It helped me to read serialize.h and about tx serialization ([bip141](https://github.com/bitcoin/bips/blob/master/bip-0144.mediawiki#serialization) and [this doc](https://developer.bitcoin.org/reference/transactions.html#raw-transaction-format)).\r\n\r\nThis is just saying that when the stack size goes from 252 to 253, you need more bytes to encode the size in the serialized transaction. It's not the same as a byte boundary since (I assume) you need to reserve a few values for codifying how many bytes it is.",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T16:01:37Z",
      "diff_hunk" : "@@ -1462,6 +1462,34 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n+static void FillInputToWeight(CTxIn& txin, int64_t target_weight)\n+{\n+    int64_t txin_weight = GetTransactionInputWeight(txin);\n+    // Subtract current txin weight, which should include empty witness stack\n+    int64_t add_weight = target_weight - txin_weight;\n+\n+    // We will want to subtract the size of the Compact Size UInt that will also be serialized.\n+    // However doing so when the size is near a boundary can result in a problem where it is not\n+    // possible to have a stack element size and combination to exactly equal a target.\n+    // To avoid this possibility, if the weight to add is less than 10 bytes greater than\n+    // a boundary, the size will be split so that 2/3rds will be in one stack element, and\n+    // the remaining 1/3rd in another. Using 3rds allows us to avoid additional boundaries.\n+    // 10 bytes is used because that accounts for the maximum size. This does not need to be super precise.\n+    if ((add_weight >= 253 && add_weight < 263)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786135708",
      "id" : 786135708,
      "in_reply_to_id" : 725480194,
      "line" : 1523,
      "node_id" : "PRRC_kwDOABII584u23qc",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 1523,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 17,
      "pull_request_review_id" : 854529030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786135708/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T16:17:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786135708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786137903"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786137903"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Did you consider having an upper bound for weights as well? e.g. based on `MAX_STANDARD_SCRIPTSIG_SIZE * WITNESS_SCALE_FACTOR` or even `MAX_STANDARD_TX_WEIGHT`?",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T16:04:29Z",
      "diff_hunk" : "@@ -548,6 +549,32 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n         }\n     }\n \n+    if (options.exists(\"input_weights\")) {\n+        for (const UniValue& input : options[\"input_weights\"].get_array().getValues()) {\n+            uint256 txid = ParseHashO(input, \"txid\");\n+\n+            const UniValue& vout_v = find_value(input, \"vout\");\n+            if (!vout_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing vout key\");\n+            }\n+            int vout = vout_v.get_int();\n+            if (vout < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, vout cannot be negative\");\n+            }\n+\n+            const UniValue& weight_v = find_value(input, \"weight\");\n+            if (!weight_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing weight key\");\n+            }\n+            int64_t weight = weight_v.get_int64();\n+            if (weight < 40 * WITNESS_SCALE_FACTOR) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, weight cannot be less than 160 (40 bytes (size of outpoint + sequence) * 4 (witness scaling factor))\");\n+            }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786137903",
      "id" : 786137903,
      "line" : 572,
      "node_id" : "PRRC_kwDOABII584u24Mv",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 572,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 32,
      "pull_request_review_id" : 854529030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786137903/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T16:17:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786137903",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786141492"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786141492"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Seems like changing `FillInputToWeight` to not be static and adding its unit tests were squashed into 8a1ea6a050 but should have been squashed into 9191748088 instead?",
      "commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "created_at" : "2022-01-17T16:09:31Z",
      "diff_hunk" : "@@ -1507,7 +1507,7 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n-static void FillInputToWeight(CTxIn& txin, int64_t target_weight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786141492",
      "id" : 786141492,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u25E0",
      "original_commit_id" : "8a1ea6a050dbcae3c06e483f6413f0e060632987",
      "original_line" : 1510,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 854529030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786141492/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T16:17:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786141492",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786151588"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786151588"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in 52d8d44adb\r\n```suggestion\r\nfrom decimal import Decimal\r\nfrom itertools import product\r\nfrom math import ceil\r\n```",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T16:23:29Z",
      "diff_hunk" : "@@ -4,6 +4,8 @@\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \"\"\"Test the fundrawtransaction RPC.\"\"\"\n \n+import math\n+\n from decimal import Decimal\n from itertools import product",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786151588",
      "id" : 786151588,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u27ik",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 9,
      "original_position" : 7,
      "original_start_line" : 7,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 854607992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786151588/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T17:29:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786151588",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786180828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786180828"
         }
      },
      "author_association" : "MEMBER",
      "body" : "typo?\r\n```suggestion\r\n        input_weight = ((41 + len_scriptsig + 2) * 4) + len_scriptwitness\r\n```",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T17:08:07Z",
      "diff_hunk" : "@@ -518,5 +518,42 @@ def run_test(self):\n         assert signed[\"complete\"]\n         self.nodes[0].finalizepsbt(signed[\"psbt\"])\n \n+        dec = self.nodes[0].decodepsbt(signed[\"psbt\"])\n+        for i, txin in enumerate(dec[\"tx\"][\"vin\"]):\n+            if txin[\"txid\"] == ext_utxo[\"txid\"] and txin[\"vout\"] == ext_utxo[\"vout\"]:\n+                input_idx = i\n+                break\n+        psbt_in = dec[\"inputs\"][input_idx]\n+        # Calculate the input weight\n+        # (prevout + sequence + length of scriptSig + 2 bytes buffer) * 4 + len of scriptwitness\n+        len_scriptsig = len(psbt_in[\"final_scriptSig\"][\"hex\"]) // 2 if \"final_scriptSig\" in psbt_in else 0\n+        len_scriptwitness = len(psbt_in[\"final_scriptwitness\"][\"hex\"]) // 2 if \"final_scriptwitness\" in psbt_in else 0\n+        input_weight = ((44 + len_scriptsig + 2) * 4) + len_scriptwitness",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786180828",
      "id" : 786180828,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3Crc",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 531,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : null,
      "pull_request_review_id" : 854607992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786180828/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T17:29:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786180828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786182033"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786182033"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Recommend adding the feerate check here too, it caught the `input_weight` being off up there^\r\n(also added `fee_rate=10` to the `self.test_send()` call above)\r\n\r\n```suggestion\r\n        testres = self.nodes[0].testmempoolaccept([tx[\"hex\"]])[0]\r\n        assert testres[\"allowed\"]\r\n        assert_fee_amount(testres[\"fees\"][\"base\"], testres[\"vsize\"], Decimal(0.0001))\r\n```",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T17:10:07Z",
      "diff_hunk" : "@@ -518,5 +518,42 @@ def run_test(self):\n         assert signed[\"complete\"]\n         self.nodes[0].finalizepsbt(signed[\"psbt\"])\n \n+        dec = self.nodes[0].decodepsbt(signed[\"psbt\"])\n+        for i, txin in enumerate(dec[\"tx\"][\"vin\"]):\n+            if txin[\"txid\"] == ext_utxo[\"txid\"] and txin[\"vout\"] == ext_utxo[\"vout\"]:\n+                input_idx = i\n+                break\n+        psbt_in = dec[\"inputs\"][input_idx]\n+        # Calculate the input weight\n+        # (prevout + sequence + length of scriptSig + 2 bytes buffer) * 4 + len of scriptwitness\n+        len_scriptsig = len(psbt_in[\"final_scriptSig\"][\"hex\"]) // 2 if \"final_scriptSig\" in psbt_in else 0\n+        len_scriptwitness = len(psbt_in[\"final_scriptwitness\"][\"hex\"]) // 2 if \"final_scriptwitness\" in psbt_in else 0\n+        input_weight = ((44 + len_scriptsig + 2) * 4) + len_scriptwitness\n+\n+        # Input weight error conditions\n+        assert_raises_rpc_error(\n+            -8,\n+            \"Specify weight in inputs instead\",\n+            ext_wallet.send,\n+            outputs={self.nodes[0].getnewaddress(): 15},\n+            options={\"inputs\": [ext_utxo], \"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": 1000}]}\n+        )\n+\n+        # Funding should also work when input weights are provided\n+        res = self.test_send(\n+            from_wallet=ext_wallet,\n+            to_wallet=self.nodes[0],\n+            amount=15,\n+            inputs=[{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}],\n+            add_inputs=True,\n+            psbt=True,\n+            include_watching=True\n+        )\n+        signed = ext_wallet.walletprocesspsbt(res[\"psbt\"])\n+        signed = ext_fund.walletprocesspsbt(res[\"psbt\"])\n+        assert signed[\"complete\"]\n+        tx = self.nodes[0].finalizepsbt(signed[\"psbt\"])\n+        assert self.nodes[0].testmempoolaccept([tx[\"hex\"]])[0][\"allowed\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786182033",
      "id" : 786182033,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3C-R",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 556,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : null,
      "pull_request_review_id" : 854607992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786182033/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T17:29:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786182033",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786212409"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786212409"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Currently the only error message `SelectCoins` can return (which is where we find this failure) is \"Insufficient funds\". I think it is an orthogonal change to change that to return better errors, and can be done in a future PR.",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T17:49:41Z",
      "diff_hunk" : "@@ -1003,14 +1005,19 @@ def test_external_inputs(self):\n         ext_utxo = self.nodes[0].listunspent(addresses=[addr])[0]\n \n         # An external input without solving data should result in an error\n-        raw_tx = wallet.createrawtransaction([ext_utxo], {self.nodes[0].getnewaddress(): 15})\n+        raw_tx = wallet.createrawtransaction([ext_utxo], {self.nodes[0].getnewaddress(): ext_utxo[\"amount\"] / 2})\n         assert_raises_rpc_error(-4, \"Insufficient funds\", wallet.fundrawtransaction, raw_tx)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786212409",
      "id" : 786212409,
      "in_reply_to_id" : 785839927,
      "line" : 1009,
      "node_id" : "PRRC_kwDOABII584u3KY5",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 1009,
      "original_position" : 15,
      "original_start_line" : 1008,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 17,
      "pull_request_review_id" : 854678262,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786212409/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1008,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T17:49:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786212409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786214468"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786214468"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That is already being tested above.",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T17:53:59Z",
      "diff_hunk" : "@@ -518,5 +518,42 @@ def run_test(self):\n         assert signed[\"complete\"]\n         self.nodes[0].finalizepsbt(signed[\"psbt\"])\n \n+        dec = self.nodes[0].decodepsbt(signed[\"psbt\"])\n+        for i, txin in enumerate(dec[\"tx\"][\"vin\"]):\n+            if txin[\"txid\"] == ext_utxo[\"txid\"] and txin[\"vout\"] == ext_utxo[\"vout\"]:\n+                input_idx = i\n+                break\n+        psbt_in = dec[\"inputs\"][input_idx]\n+        # Calculate the input weight\n+        # (prevout + sequence + length of scriptSig + 2 bytes buffer) * 4 + len of scriptwitness\n+        len_scriptsig = len(psbt_in[\"final_scriptSig\"][\"hex\"]) // 2 if \"final_scriptSig\" in psbt_in else 0\n+        len_scriptwitness = len(psbt_in[\"final_scriptwitness\"][\"hex\"]) // 2 if \"final_scriptwitness\" in psbt_in else 0\n+        input_weight = ((44 + len_scriptsig + 2) * 4) + len_scriptwitness\n+\n+        # Input weight error conditions\n+        assert_raises_rpc_error(\n+            -8,\n+            \"Specify weight in inputs instead\",\n+            ext_wallet.send,\n+            outputs={self.nodes[0].getnewaddress(): 15},\n+            options={\"inputs\": [ext_utxo], \"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": 1000}]}\n+        )\n+\n+        # Funding should also work when input weights are provided\n+        res = self.test_send(\n+            from_wallet=ext_wallet,\n+            to_wallet=self.nodes[0],\n+            amount=15,\n+            inputs=[{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}],\n+            add_inputs=True,\n+            psbt=True,\n+            include_watching=True\n+        )\n+        signed = ext_wallet.walletprocesspsbt(res[\"psbt\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786214468",
      "id" : 786214468,
      "in_reply_to_id" : 785856067,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3K5E",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 553,
      "original_position" : 35,
      "original_start_line" : 543,
      "path" : "test/functional/wallet_send.py",
      "position" : null,
      "pull_request_review_id" : 854680972,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786214468/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T17:54:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786214468",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217136"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217136"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've added \"Remember to convert serialized sizes to weight units when necessary.\"",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T17:59:42Z",
      "diff_hunk" : "@@ -625,6 +669,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},\n+                                    {\"weight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The maximum weight for this input, \"\n+                                        \"including the weight of the outpoint and sequence number. \"\n+                                        \"Note that signature sizes are not guaranteed to be consistent, \"\n+                                        \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217136",
      "id" : 786217136,
      "in_reply_to_id" : 783933728,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3Liw",
      "original_commit_id" : "386768e4605bcbd0f0daa597440d1dc8acf2ad32",
      "original_line" : 680,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 854684653,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217136/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T17:59:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217136",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217291"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217291"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:00:05Z",
      "diff_hunk" : "@@ -1032,10 +1037,38 @@ def test_external_inputs(self):\n         assert signed_tx['complete']\n \n         funded_tx = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}})\n-        signed_tx = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n-        assert not signed_tx['complete']\n-        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx['hex'])\n-        assert signed_tx['complete']\n+        signed_tx1 = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n+        assert not signed_tx1['complete']\n+        signed_tx2 = self.nodes[0].signrawtransactionwithwallet(signed_tx1['hex'])\n+        assert signed_tx2['complete']\n+\n+        unsigned_weight = self.nodes[0].decoderawtransaction(signed_tx1[\"hex\"])[\"weight\"]\n+        signed_weight = self.nodes[0].decoderawtransaction(signed_tx2[\"hex\"])[\"weight\"]\n+        # Input's weight is difference between weight of signed and unsigned,\n+        # and the weight of stuff that didn't change (prevout, sequence, 1 byte of scriptSig)\n+        input_weight = signed_weight - unsigned_weight + (45 * 4)\n+        low_input_weight = input_weight // 2\n+        high_input_weight = input_weight * 2\n+\n+        # Funding should also work if the input weight is provided\n+        funded_tx = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}]})\n+        signed_tx = wallet.signrawtransactionwithwallet(funded_tx[\"hex\"])\n+        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx[\"hex\"])\n+        assert self.nodes[0].testmempoolaccept([signed_tx[\"hex\"]])[0][\"allowed\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217291",
      "id" : 786217291,
      "in_reply_to_id" : 725497018,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3LlL",
      "original_commit_id" : "0224b9db65824064ca3a28f9802f5327735b95bb",
      "original_line" : 1047,
      "original_position" : 37,
      "original_start_line" : 1055,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 854684899,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217291/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T18:00:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217291",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217556"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217556"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Changed to \"Input weights should be specified in inputs rather than in options.\"",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:00:38Z",
      "diff_hunk" : "@@ -585,6 +612,23 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n     }\n }\n \n+static void SetOptionsInputWeights(const UniValue& inputs, UniValue& options)\n+{\n+    if (options.exists(\"input_weights\")) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Specify weight in inputs instead\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217556",
      "id" : 786217556,
      "in_reply_to_id" : 785706830,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3LpU",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 618,
      "original_position" : 48,
      "original_start_line" : 617,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 854685268,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217556/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T18:00:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217556",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217604"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217604"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:00:46Z",
      "diff_hunk" : "@@ -626,6 +670,16 @@ RPCHelpMan fundrawtransaction()\n                                     {\"vout_index\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED, \"The zero-based output index, before a change output is added.\"},\n                                 },\n                             },\n+                            {\"input_weights\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED_NAMED_ARG, \"Inputs and their corresponding weights\",\n+                                {\n+                                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id\"},\n+                                    {\"vout\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The output number\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217604",
      "id" : 786217604,
      "in_reply_to_id" : 785710287,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3LqE",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 676,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 854685355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217604/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T18:00:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217604",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217632"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217632"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:00:50Z",
      "diff_hunk" : "@@ -939,6 +939,9 @@ bool AddWalletSetting(interfaces::Chain& chain, const std::string& wallet_name);\n bool RemoveWalletSetting(interfaces::Chain& chain, const std::string& wallet_name);\n \n bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut &txout, bool use_max_sig);\n+\n+void FillInputToWeight(CTxIn& txin, int64_t target_weight);\n } // namespace wallet\n \n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217632",
      "id" : 786217632,
      "in_reply_to_id" : 785776462,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3Lqg",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 946,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 854685397,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217632/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T18:00:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217632",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217758"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217758"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oops, removed",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:01:07Z",
      "diff_hunk" : "@@ -1020,10 +1027,45 @@ def test_external_inputs(self):\n         assert signed_tx['complete']\n \n         funded_tx = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}})\n-        signed_tx = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n-        assert not signed_tx['complete']\n-        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx['hex'])\n-        assert signed_tx['complete']\n+        signed_tx1 = wallet.signrawtransactionwithwallet(funded_tx['hex'])\n+        assert not signed_tx1['complete']\n+        signed_tx2 = self.nodes[0].signrawtransactionwithwallet(signed_tx1['hex'])\n+        assert signed_tx2['complete']\n+\n+        unsigned_weight = self.nodes[0].decoderawtransaction(signed_tx1[\"hex\"])[\"weight\"]\n+        signed_weight = self.nodes[0].decoderawtransaction(signed_tx2[\"hex\"])[\"weight\"]\n+        # Input's weight is difference between weight of signed and unsigned,\n+        # and the weight of stuff that didn't change (prevout, sequence, 1 byte of scriptSig)\n+        input_weight = signed_weight - unsigned_weight + (41 * 4)\n+        low_input_weight = input_weight // 2\n+        high_input_weight = input_weight * 2\n+\n+        # Funding should also work if the input weight is provided\n+        funded_tx = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}]})\n+        signed_tx = wallet.signrawtransactionwithwallet(funded_tx[\"hex\"])\n+        signed_tx = self.nodes[0].signrawtransactionwithwallet(signed_tx[\"hex\"])\n+        assert self.nodes[0].testmempoolaccept([signed_tx[\"hex\"]])[0][\"allowed\"]\n+        # Reducing the weight should have a lower fee\n+        funded_tx2 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": low_input_weight}]})\n+        assert_greater_than(funded_tx[\"fee\"], funded_tx2[\"fee\"])\n+        # Increasing the weight should have a higher fee\n+        funded_tx2 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": high_input_weight}]})\n+        assert_greater_than(funded_tx2[\"fee\"], funded_tx[\"fee\"])\n+        # The provided weight should override the calculated weight when solving data is provided\n+        funded_tx3 = wallet.fundrawtransaction(raw_tx, {\"solving_data\": {\"descriptors\": [desc]}, \"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": high_input_weight}]})\n+        assert_equal(funded_tx2[\"fee\"], funded_tx3[\"fee\"])\n+        # The feerate should be met\n+        funded_tx4 = wallet.fundrawtransaction(raw_tx, {\"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": high_input_weight}], \"fee_rate\": 10})\n+        signed_tx4 = wallet.signrawtransactionwithwallet(funded_tx4[\"hex\"])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786217758",
      "id" : 786217758,
      "in_reply_to_id" : 785979972,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3Lse",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 1059,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 854685586,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217758/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T18:01:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786217758",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786218642"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786218642"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Apparently `GetTransactionInputWeight` includes the empty witness, and I forgot to include the empty scriptSig in my calculation.\r\n\r\nI've changed restriction to be at least 165 bytes. `FillInputToWeight` will also check the size meets the minimum. If it does not, it will just do nothing rather than crashing. There are also unit tests for this lower bound. `add_weight` should always be at least 1 now, and that is fine.",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:03:01Z",
      "diff_hunk" : "@@ -1507,6 +1507,34 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n+void FillInputToWeight(CTxIn& txin, int64_t target_weight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786218642",
      "id" : 786218642,
      "in_reply_to_id" : 786127043,
      "line" : 1510,
      "node_id" : "PRRC_kwDOABII584u3L6S",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 1510,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 4,
      "pull_request_review_id" : 854686868,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786218642/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T18:03:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786218642",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786219034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219034"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oops, fixed.",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:04:01Z",
      "diff_hunk" : "@@ -1507,7 +1507,7 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n-static void FillInputToWeight(CTxIn& txin, int64_t target_weight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786219034",
      "id" : 786219034,
      "in_reply_to_id" : 786141492,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3MAa",
      "original_commit_id" : "8a1ea6a050dbcae3c06e483f6413f0e060632987",
      "original_line" : 1510,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 854687526,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219034/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T18:04:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219034",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786219060"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219060"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:04:06Z",
      "diff_hunk" : "@@ -4,6 +4,8 @@\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \"\"\"Test the fundrawtransaction RPC.\"\"\"\n \n+import math\n+\n from decimal import Decimal\n from itertools import product",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786219060",
      "id" : 786219060,
      "in_reply_to_id" : 786151588,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3MA0",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 9,
      "original_position" : 7,
      "original_start_line" : 7,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 854687567,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219060/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-17T18:04:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219060",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786219092"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219092"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:04:11Z",
      "diff_hunk" : "@@ -518,5 +518,42 @@ def run_test(self):\n         assert signed[\"complete\"]\n         self.nodes[0].finalizepsbt(signed[\"psbt\"])\n \n+        dec = self.nodes[0].decodepsbt(signed[\"psbt\"])\n+        for i, txin in enumerate(dec[\"tx\"][\"vin\"]):\n+            if txin[\"txid\"] == ext_utxo[\"txid\"] and txin[\"vout\"] == ext_utxo[\"vout\"]:\n+                input_idx = i\n+                break\n+        psbt_in = dec[\"inputs\"][input_idx]\n+        # Calculate the input weight\n+        # (prevout + sequence + length of scriptSig + 2 bytes buffer) * 4 + len of scriptwitness\n+        len_scriptsig = len(psbt_in[\"final_scriptSig\"][\"hex\"]) // 2 if \"final_scriptSig\" in psbt_in else 0\n+        len_scriptwitness = len(psbt_in[\"final_scriptwitness\"][\"hex\"]) // 2 if \"final_scriptwitness\" in psbt_in else 0\n+        input_weight = ((44 + len_scriptsig + 2) * 4) + len_scriptwitness",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786219092",
      "id" : 786219092,
      "in_reply_to_id" : 786180828,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3MBU",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 531,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : null,
      "pull_request_review_id" : 854687614,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219092/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T18:04:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219092",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786219125"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219125"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-17T18:04:16Z",
      "diff_hunk" : "@@ -518,5 +518,42 @@ def run_test(self):\n         assert signed[\"complete\"]\n         self.nodes[0].finalizepsbt(signed[\"psbt\"])\n \n+        dec = self.nodes[0].decodepsbt(signed[\"psbt\"])\n+        for i, txin in enumerate(dec[\"tx\"][\"vin\"]):\n+            if txin[\"txid\"] == ext_utxo[\"txid\"] and txin[\"vout\"] == ext_utxo[\"vout\"]:\n+                input_idx = i\n+                break\n+        psbt_in = dec[\"inputs\"][input_idx]\n+        # Calculate the input weight\n+        # (prevout + sequence + length of scriptSig + 2 bytes buffer) * 4 + len of scriptwitness\n+        len_scriptsig = len(psbt_in[\"final_scriptSig\"][\"hex\"]) // 2 if \"final_scriptSig\" in psbt_in else 0\n+        len_scriptwitness = len(psbt_in[\"final_scriptwitness\"][\"hex\"]) // 2 if \"final_scriptwitness\" in psbt_in else 0\n+        input_weight = ((44 + len_scriptsig + 2) * 4) + len_scriptwitness\n+\n+        # Input weight error conditions\n+        assert_raises_rpc_error(\n+            -8,\n+            \"Specify weight in inputs instead\",\n+            ext_wallet.send,\n+            outputs={self.nodes[0].getnewaddress(): 15},\n+            options={\"inputs\": [ext_utxo], \"input_weights\": [{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": 1000}]}\n+        )\n+\n+        # Funding should also work when input weights are provided\n+        res = self.test_send(\n+            from_wallet=ext_wallet,\n+            to_wallet=self.nodes[0],\n+            amount=15,\n+            inputs=[{\"txid\": ext_utxo[\"txid\"], \"vout\": ext_utxo[\"vout\"], \"weight\": input_weight}],\n+            add_inputs=True,\n+            psbt=True,\n+            include_watching=True\n+        )\n+        signed = ext_wallet.walletprocesspsbt(res[\"psbt\"])\n+        signed = ext_fund.walletprocesspsbt(res[\"psbt\"])\n+        assert signed[\"complete\"]\n+        tx = self.nodes[0].finalizepsbt(signed[\"psbt\"])\n+        assert self.nodes[0].testmempoolaccept([tx[\"hex\"]])[0][\"allowed\"]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786219125",
      "id" : 786219125,
      "in_reply_to_id" : 786182033,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584u3MB1",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 556,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "test/functional/wallet_send.py",
      "position" : null,
      "pull_request_review_id" : 854687668,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219125/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-17T18:04:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786219125",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786581710"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786581710"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah ok.. Ya probably a good idea for a future PR.",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-18T09:52:33Z",
      "diff_hunk" : "@@ -1003,14 +1005,19 @@ def test_external_inputs(self):\n         ext_utxo = self.nodes[0].listunspent(addresses=[addr])[0]\n \n         # An external input without solving data should result in an error\n-        raw_tx = wallet.createrawtransaction([ext_utxo], {self.nodes[0].getnewaddress(): 15})\n+        raw_tx = wallet.createrawtransaction([ext_utxo], {self.nodes[0].getnewaddress(): ext_utxo[\"amount\"] / 2})\n         assert_raises_rpc_error(-4, \"Insufficient funds\", wallet.fundrawtransaction, raw_tx)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r786581710",
      "id" : 786581710,
      "in_reply_to_id" : 785839927,
      "line" : 1009,
      "node_id" : "PRRC_kwDOABII584u4kjO",
      "original_commit_id" : "52d8d44adba48c23b6047418eec431fbb39fd8db",
      "original_line" : 1009,
      "original_position" : 15,
      "original_start_line" : 1008,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 17,
      "pull_request_review_id" : 855177837,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786581710/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1008,
      "start_side" : "RIGHT",
      "updated_at" : "2022-01-18T09:52:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/786581710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/rajarshimaitra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rajarshimaitra/followers",
         "following_url" : "https://api.github.com/users/rajarshimaitra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rajarshimaitra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rajarshimaitra",
         "id" : 36541669,
         "login" : "rajarshimaitra",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/rajarshimaitra/orgs",
         "received_events_url" : "https://api.github.com/users/rajarshimaitra/received_events",
         "repos_url" : "https://api.github.com/users/rajarshimaitra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rajarshimaitra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rajarshimaitra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rajarshimaitra"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r788303644"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788303644"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: let's assert that no witness data exists yet?",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-20T02:39:01Z",
      "diff_hunk" : "@@ -1507,6 +1507,41 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n+void FillInputToWeight(CTxIn& txin, int64_t target_weight)\n+{\n+    int64_t txin_weight = GetTransactionInputWeight(txin);\n+\n+    // Do nothing if the weight that should be added is less than the weight that already exists\n+    if (target_weight <= txin_weight) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r788303644",
      "id" : 788303644,
      "line" : 1515,
      "node_id" : "PRRC_kwDOABII584u_I8c",
      "original_commit_id" : "e7a318a8a88489477264060ccb332a719260fa67",
      "original_line" : 1515,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 9,
      "pull_request_review_id" : 857578495,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788303644/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-20T02:53:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788303644",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r788304947"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788304947"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If the given value is \"too low\" as per https://github.com/bitcoin/bitcoin/pull/23201/commits/e7a318a8a88489477264060ccb332a719260fa67#diff-1f2db0e4d5c12d109c7f0962333c245b49b696cb39ff432da048e9d6c08944d8R1515, it looks like logic uses just thinks it signed and returns `true`.\r\n\r\nThere's test coverage from the RPC perspective but ideally we'd catch this issue by returning false?",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-20T02:42:54Z",
      "diff_hunk" : "@@ -1515,6 +1550,12 @@ bool CWallet::DummySignTx(CMutableTransaction &txNew, const std::vector<CTxOut>\n     for (const auto& txout : txouts)\n     {\n         CTxIn& txin = txNew.vin[nIn];\n+        // If weight was provided, fill the input to that weight\n+        if (coin_control && coin_control->HasInputWeight(txin.prevout)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r788304947",
      "id" : 788304947,
      "line" : 1554,
      "node_id" : "PRRC_kwDOABII584u_JQz",
      "original_commit_id" : "e7a318a8a88489477264060ccb332a719260fa67",
      "original_line" : 1554,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 47,
      "pull_request_review_id" : 857578495,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788304947/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-20T02:53:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788304947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r788308300"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788308300"
         }
      },
      "author_association" : "MEMBER",
      "body" : "follow-up only: would be nice if this kind of thing wasn't checked in two places in different ways. I prefer the other approach of directly measuring what a blank input size is.",
      "commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "created_at" : "2022-01-20T02:51:46Z",
      "diff_hunk" : "@@ -548,6 +549,35 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n         }\n     }\n \n+    if (options.exists(\"input_weights\")) {\n+        for (const UniValue& input : options[\"input_weights\"].get_array().getValues()) {\n+            uint256 txid = ParseHashO(input, \"txid\");\n+\n+            const UniValue& vout_v = find_value(input, \"vout\");\n+            if (!vout_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing vout key\");\n+            }\n+            int vout = vout_v.get_int();\n+            if (vout < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, vout cannot be negative\");\n+            }\n+\n+            const UniValue& weight_v = find_value(input, \"weight\");\n+            if (!weight_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing weight key\");\n+            }\n+            int64_t weight = weight_v.get_int64();\n+            if (weight < 41 * WITNESS_SCALE_FACTOR + 1) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r788308300",
      "id" : 788308300,
      "line" : 570,
      "node_id" : "PRRC_kwDOABII584u_KFM",
      "original_commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "original_line" : 570,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 30,
      "pull_request_review_id" : 857578495,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788308300/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-20T02:53:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/788308300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r790925653"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790925653"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "3866272c450cc659207fbc2cff3c690ae8593341",
      "created_at" : "2022-01-24T16:29:48Z",
      "diff_hunk" : "@@ -1507,6 +1507,41 @@ bool DummySignInput(const SigningProvider& provider, CTxIn &tx_in, const CTxOut\n     return true;\n }\n \n+void FillInputToWeight(CTxIn& txin, int64_t target_weight)\n+{\n+    int64_t txin_weight = GetTransactionInputWeight(txin);\n+\n+    // Do nothing if the weight that should be added is less than the weight that already exists\n+    if (target_weight <= txin_weight) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r790925653",
      "id" : 790925653,
      "in_reply_to_id" : 788303644,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vJJFV",
      "original_commit_id" : "e7a318a8a88489477264060ccb332a719260fa67",
      "original_line" : 1515,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 861219914,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790925653/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-24T16:29:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790925653",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r790926139"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790926139"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Changed to return a bool.",
      "commit_id" : "3866272c450cc659207fbc2cff3c690ae8593341",
      "created_at" : "2022-01-24T16:30:05Z",
      "diff_hunk" : "@@ -1515,6 +1550,12 @@ bool CWallet::DummySignTx(CMutableTransaction &txNew, const std::vector<CTxOut>\n     for (const auto& txout : txouts)\n     {\n         CTxIn& txin = txNew.vin[nIn];\n+        // If weight was provided, fill the input to that weight\n+        if (coin_control && coin_control->HasInputWeight(txin.prevout)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r790926139",
      "id" : 790926139,
      "in_reply_to_id" : 788304947,
      "line" : 1562,
      "node_id" : "PRRC_kwDOABII584vJJM7",
      "original_commit_id" : "e7a318a8a88489477264060ccb332a719260fa67",
      "original_line" : 1562,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 55,
      "pull_request_review_id" : 861220307,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790926139/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-24T16:30:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790926139",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r790926441"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790926441"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "3866272c450cc659207fbc2cff3c690ae8593341",
      "created_at" : "2022-01-24T16:30:15Z",
      "diff_hunk" : "@@ -548,6 +549,35 @@ void FundTransaction(CWallet& wallet, CMutableTransaction& tx, CAmount& fee_out,\n         }\n     }\n \n+    if (options.exists(\"input_weights\")) {\n+        for (const UniValue& input : options[\"input_weights\"].get_array().getValues()) {\n+            uint256 txid = ParseHashO(input, \"txid\");\n+\n+            const UniValue& vout_v = find_value(input, \"vout\");\n+            if (!vout_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing vout key\");\n+            }\n+            int vout = vout_v.get_int();\n+            if (vout < 0) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, vout cannot be negative\");\n+            }\n+\n+            const UniValue& weight_v = find_value(input, \"weight\");\n+            if (!weight_v.isNum()) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid parameter, missing weight key\");\n+            }\n+            int64_t weight = weight_v.get_int64();\n+            if (weight < 41 * WITNESS_SCALE_FACTOR + 1) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#discussion_r790926441",
      "id" : 790926441,
      "in_reply_to_id" : 788308300,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vJJRp",
      "original_commit_id" : "db4efdeb6d5ffd982777197d72c8c2a0f1ea82f9",
      "original_line" : 570,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 861220537,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23201",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790926441/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-24T16:30:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790926441",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "reACK https://github.com/bitcoin/bitcoin/pull/23201/commits/3866272c450cc659207fbc2cff3c690ae8593341",
      "created_at" : "2022-01-24T23:40:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-1020661236",
      "id" : 1020661236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII58481g30",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020661236/reactions"
      },
      "updated_at" : "2022-01-24T23:40:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020661236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@t-bast want to take another look here?",
      "created_at" : "2022-01-25T02:50:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-1020756768",
      "id" : 1020756768,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII584814Mg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020756768/reactions"
      },
      "updated_at" : "2022-01-25T02:50:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020756768",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "reACK 3866272 via range-diff\r\n\r\nChanges since last review:\r\n- Changed `FillInputToWeight()` to return a bool for information about whether filling happened or if the input was invalid, changed DummySigns and tests to reflect that.\r\n- assertions in `FillInputToWeight()` that scriptSig and witness start out empty\r\n- changed the 165 input minimum to be calculated using size of empty input instead of arithmetic, added a CHECK_NONFATAL that it matches 165",
      "created_at" : "2022-01-25T10:11:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23201#issuecomment-1021020126",
      "id" : 1021020126,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23201",
      "node_id" : "IC_kwDOABII584824fe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021020126/reactions"
      },
      "updated_at" : "2022-01-25T10:11:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021020126",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   }
]
