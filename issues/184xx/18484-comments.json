[
   {
      "author_association" : "MEMBER",
      "body" : "utACK c0f9a61793ffccb6af97ffb6b4a156780e1a4597\r\n\r\nAfter this it seems that `GetScriptForWitness` is only used in `bitcoin-tx` (all in places were more explicit constructions of scripts would be preferable) and in tests. Maybe it's time (in a different PR) to get rid of it entirely.",
      "created_at" : "2020-03-31T18:07:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18484#issuecomment-606786579",
      "id" : 606786579,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18484",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjc4NjU3OQ==",
      "updated_at" : "2020-03-31T18:07:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606786579",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18484#discussion_r401123383"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18484"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/401123383"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit. I think this might work:\r\n\r\n```suggestion\r\n        redeem_script = CScript([OP_0, sha256(check_script(witness_script))]).hex()\r\n```",
      "commit_id" : "cd3b1569d9ad8e24d3a222aff74e0c254baadf79",
      "created_at" : "2020-03-31T18:26:07Z",
      "diff_hunk" : "@@ -168,6 +170,44 @@ def witness_script_test(self):\n         assert 'complete' in spending_tx_signed\n         assert_equal(spending_tx_signed['complete'], True)\n \n+        # Now try with a P2PKH script as the witnessScript\n+        embedded_addr_info = self.nodes[1].getaddressinfo(self.nodes[1].getnewaddress('', 'legacy'))\n+        embedded_privkey = self.nodes[1].dumpprivkey(embedded_addr_info['address'])\n+        witness_script = embedded_addr_info['scriptPubKey']\n+        redeem_script = hexlify(CScript([OP_0, sha256(check_script(witness_script))])).decode()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18484#discussion_r401123383",
      "id" : 401123383,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTEyMzM4Mw==",
      "original_commit_id" : "c0f9a61793ffccb6af97ffb6b4a156780e1a4597",
      "original_line" : 177,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "test/functional/rpc_signrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 384994207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18484",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-31T22:42:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/401123383",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18484#discussion_r401146860"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18484"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/401146860"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "cd3b1569d9ad8e24d3a222aff74e0c254baadf79",
      "created_at" : "2020-03-31T19:04:13Z",
      "diff_hunk" : "@@ -168,6 +170,44 @@ def witness_script_test(self):\n         assert 'complete' in spending_tx_signed\n         assert_equal(spending_tx_signed['complete'], True)\n \n+        # Now try with a P2PKH script as the witnessScript\n+        embedded_addr_info = self.nodes[1].getaddressinfo(self.nodes[1].getnewaddress('', 'legacy'))\n+        embedded_privkey = self.nodes[1].dumpprivkey(embedded_addr_info['address'])\n+        witness_script = embedded_addr_info['scriptPubKey']\n+        redeem_script = hexlify(CScript([OP_0, sha256(check_script(witness_script))])).decode()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18484#discussion_r401146860",
      "id" : 401146860,
      "in_reply_to_id" : 401123383,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE0Njg2MA==",
      "original_commit_id" : "c0f9a61793ffccb6af97ffb6b4a156780e1a4597",
      "original_line" : 177,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "test/functional/rpc_signrawtransaction.py",
      "position" : null,
      "pull_request_review_id" : 385022394,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18484",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-31T22:42:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/401146860",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "weak ACK cd3b1569d9, only checked that the test fails without the code change ð°\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nweak ACK cd3b1569d9, only checked that the test fails without the code change ð°\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUjCbwwAsp2heFGb1866a8x98h5pUos0kinxV/wI5wCnXhsD698tiLJMjYSr0q6U\r\nY5GZwCHJLQTgAwI+SB7j4c/YZONMro+sspVT6RzeBNEmZ+sGRTfpDSDJ8ia95zuZ\r\nlKbSab1ClG7IgmuLpxOag2twuwtY48RT8HOcC1xcMaipDylBdM2uRrFHKJE7CW6H\r\nUDaFGunaLDJDqjWjYG7Y62G1u2IF4nNQu/8FqoyMOx0gXTDQo5pv/M6HYDD0JYZV\r\nfNC2clH/wcaqY2dP0khpBTrBoOh8V/1VPswc9VgW7/TEI36c8Vk0KZ2u8DbKY9e9\r\n3PSwN6gE6U6VgDfTLclF52lC+OR0snp8meIgziPey9IhPXZITNRFVaE963EtjVed\r\nuOI4T20GU8f7tIOw4om7Y7dVRMY+z08VfksdhppwgdMwSwW2CIeRl+KByBRmUbGw\r\naRGLVysoFFI26MgI37KyLGIptLGC/zPPgJHxvS+l6X6Ofhp0RxyyTyrDycc6yiQi\r\nHH6jdJlB\r\n=HXml\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `881a6eae6982f18b4068be3f58ea3caa8e81d392053eea501c317ee5ae66cb93  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e892940108881a6eae6982f18b4068be3f58ea3caa8e81d392053eea501c317ee5ae66cb93f01097108fc018532eb8dbbd741e14e5cdde08fff01014e5e833e8c063f9fa56d3b0a6a1486808f1045e869276f008c3d34336f0278b3c0083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff0103585c55bc9613a7818c5a5e6af9589da08f1045e869276f008238a927bc8bdf9a70083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6df010861fb03e4fa143e20dd4142ba2db395d08f1045e869276f008bc904dcd3b9f8e030083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6d)\r\n\r\n</details>\r\n",
      "created_at" : "2020-04-03T01:33:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18484#issuecomment-608180393",
      "id" : 608180393,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18484",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwODE4MDM5Mw==",
      "updated_at" : "2020-04-03T01:33:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/608180393",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Appveyor failure in signrawtransaction: https://ci.appveyor.com/project/DrahtBot/bitcoin/builds/31864368\r\n\r\nOpen-Close to re-run ci. See https://github.com/bitcoin/bitcoin/issues/15847#issuecomment-487591130",
      "created_at" : "2020-04-03T01:34:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18484#issuecomment-608180534",
      "id" : 608180534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18484",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwODE4MDUzNA==",
      "updated_at" : "2020-04-03T01:34:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/608180534",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/18484/commits/cd3b1569d9ad8e24d3a222aff74e0c254baadf79",
      "created_at" : "2020-04-06T16:41:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18484#issuecomment-609905895",
      "id" : 609905895,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18484",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwOTkwNTg5NQ==",
      "updated_at" : "2020-04-06T16:41:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/609905895",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18484#discussion_r404261813"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18484"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404261813"
         }
      },
      "author_association" : "MEMBER",
      "body" : "verified that reverting the change in rawtransaction_util.cpp::219 causes the test to fail here with `redeemScript does not correspond to witnessScript (-8)`",
      "commit_id" : "cd3b1569d9ad8e24d3a222aff74e0c254baadf79",
      "created_at" : "2020-04-06T17:24:02Z",
      "diff_hunk" : "@@ -168,6 +169,44 @@ def witness_script_test(self):\n         assert 'complete' in spending_tx_signed\n         assert_equal(spending_tx_signed['complete'], True)\n \n+        # Now try with a P2PKH script as the witnessScript\n+        embedded_addr_info = self.nodes[1].getaddressinfo(self.nodes[1].getnewaddress('', 'legacy'))\n+        embedded_privkey = self.nodes[1].dumpprivkey(embedded_addr_info['address'])\n+        witness_script = embedded_addr_info['scriptPubKey']\n+        redeem_script = CScript([OP_0, sha256(check_script(witness_script))]).hex()\n+        addr = script_to_p2sh(redeem_script)\n+        script_pub_key = self.nodes[1].validateaddress(addr)['scriptPubKey']\n+        # Fund that address\n+        txid = self.nodes[0].sendtoaddress(addr, 10)\n+        vout = find_vout_for_address(self.nodes[0], txid, addr)\n+        self.nodes[0].generate(1)\n+        # Now create and sign a transaction spending that output on node[0], which doesn't know the scripts or keys\n+        spending_tx = self.nodes[0].createrawtransaction([{'txid': txid, 'vout': vout}], {self.nodes[1].getnewaddress(): Decimal(\"9.999\")})\n+        spending_tx_signed = self.nodes[0].signrawtransactionwithkey(spending_tx, [embedded_privkey], [{'txid': txid, 'vout': vout, 'scriptPubKey': script_pub_key, 'redeemScript': redeem_script, 'witnessScript': witness_script, 'amount': 10}])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18484#discussion_r404261813",
      "id" : 404261813,
      "line" : 185,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI2MTgxMw==",
      "original_commit_id" : "cd3b1569d9ad8e24d3a222aff74e0c254baadf79",
      "original_line" : 185,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "test/functional/rpc_signrawtransaction.py",
      "position" : 31,
      "pull_request_review_id" : 388462749,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18484",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-06T17:30:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/404261813",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
