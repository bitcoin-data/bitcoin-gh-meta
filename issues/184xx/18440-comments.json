[
   {
      "author_association" : "MEMBER",
      "body" : "Seems more like a race independent of valgrind, since there is a suspected duplicate bug report here: #11425 ",
      "created_at" : "2020-03-26T15:40:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18440#issuecomment-604503147",
      "id" : 604503147,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18440",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNDUwMzE0Nw==",
      "updated_at" : "2020-03-26T15:40:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/604503147",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nice catch!\r\n\r\nFrom the Valgrind documentation FWIW:\r\n\r\n> The main thing to point out with respect to threaded programs is that your program will use the native threading library, but Valgrind serialises execution so that only one (kernel) thread is running at a time. This approach avoids the horrible implementation problems of implementing a truly multithreaded version of Valgrind, but it does mean that threaded apps never use more than one CPU simultaneously, even if you have a multiprocessor or multicore machine.\r\n>\r\n> Valgrind doesn't schedule the threads itself. It merely ensures that only one thread runs at once, using a simple locking scheme. The actual thread scheduling remains under control of the OS kernel. What this does mean, though, is that your program will see very different scheduling when run on Valgrind than it does when running normally. This is both because Valgrind is serialising the threads, and because the code runs so much slower than normal.\r\n>\r\n> This difference in scheduling may cause your program to behave differently, if you have some kind of concurrency, critical race, locking, or similar, bugs. In that case you might consider using the tools Helgrind and/or DRD to track them down.",
      "created_at" : "2020-03-26T17:54:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18440#issuecomment-604581905",
      "id" : 604581905,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18440",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNDU4MTkwNQ==",
      "updated_at" : "2020-03-26T17:54:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/604581905",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I would assume it is a race in the test code, not in Bitcoin Core",
      "created_at" : "2020-03-26T17:56:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18440#issuecomment-604583312",
      "id" : 604583312,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18440",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNDU4MzMxMg==",
      "updated_at" : "2020-03-26T17:56:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/604583312",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
