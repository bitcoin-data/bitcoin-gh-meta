[
   {
      "author_association" : "MEMBER",
      "body" : "Is this a bug report about fundraw, or about tx relay (feefilter), or about estimatesmart?\r\n\r\nCan you reproduce the issue?",
      "created_at" : "2020-03-30T23:10:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-606299071",
      "id" : 606299071,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjI5OTA3MQ==",
      "updated_at" : "2020-03-30T23:10:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606299071",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah I found this while fiddling with things in Elements and reproduced this using Bitcoin Core 0.19.1. I can't say for sure which one of the parts is behaving wrongly.\r\n\r\nThis is a stat of one of the txs:\r\n```\r\n  \"size\": 418,\r\n  \"vsize\": 256,\r\n  \"weight\": 1024,\r\n```\r\nand \r\n```\r\n  \"fee\": -0.00000281,\r\n```\r\nSo that would be `1097.65625` sat/kvB. Which seems to be undershooting the feerate I'm setting in fundraw. So I'd think it's a fundraw bug.\r\n\r\nActually that's more interesting because it's not 1099, which could be a rounding problem. In Elements I was getting 99 instead of 100, which I attributed to rounding. But here it seems like the difference is 2.5 sats, which is more significant. It seems it's significant enough to not be allowed in the peer's mempool. (In my Elements testing, the txs did get relayed despite calculating to 1 sat/vkB short.)",
      "created_at" : "2020-03-31T09:54:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-606521012",
      "id" : 606521012,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjUyMTAxMg==",
      "updated_at" : "2020-03-31T11:23:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606521012",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/853468?v=4",
         "events_url" : "https://api.github.com/users/stevenroose/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stevenroose/followers",
         "following_url" : "https://api.github.com/users/stevenroose/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stevenroose/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stevenroose",
         "id" : 853468,
         "login" : "stevenroose",
         "node_id" : "MDQ6VXNlcjg1MzQ2OA==",
         "organizations_url" : "https://api.github.com/users/stevenroose/orgs",
         "received_events_url" : "https://api.github.com/users/stevenroose/received_events",
         "repos_url" : "https://api.github.com/users/stevenroose/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stevenroose/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stevenroose/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stevenroose"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If you can reproduce, steps to reproduce or even a functional test would be useful to debug this. Or a debug log might even help",
      "created_at" : "2020-04-03T01:35:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-608180797",
      "id" : 608180797,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwODE4MDc5Nw==",
      "updated_at" : "2020-04-03T01:35:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/608180797",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "My OP kind-of explains the way to reproduce this. I noticed this in Elements and reproduced it in Core using the steps I gave in the OP.\r\n\r\nAlso, proving/testing the fee estimation aspect of this is also hard to do in a functional test because it's time-consuming.",
      "created_at" : "2020-04-06T15:47:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-609876051",
      "id" : 609876051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwOTg3NjA1MQ==",
      "updated_at" : "2020-04-06T15:47:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/609876051",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/853468?v=4",
         "events_url" : "https://api.github.com/users/stevenroose/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stevenroose/followers",
         "following_url" : "https://api.github.com/users/stevenroose/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stevenroose/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stevenroose",
         "id" : 853468,
         "login" : "stevenroose",
         "node_id" : "MDQ6VXNlcjg1MzQ2OA==",
         "organizations_url" : "https://api.github.com/users/stevenroose/orgs",
         "received_events_url" : "https://api.github.com/users/stevenroose/received_events",
         "repos_url" : "https://api.github.com/users/stevenroose/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stevenroose/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stevenroose/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stevenroose"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@stevenroose have you continued to see this with subsequent releases or have further insight into the issue since your last comment?",
      "created_at" : "2022-08-03T15:18:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-1204092366",
      "id" : 1204092366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "IC_kwDOABII585HxP3O",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1204092366/reactions"
      },
      "updated_at" : "2022-08-03T15:18:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1204092366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/755825?v=4",
         "events_url" : "https://api.github.com/users/adamjonas/events{/privacy}",
         "followers_url" : "https://api.github.com/users/adamjonas/followers",
         "following_url" : "https://api.github.com/users/adamjonas/following{/other_user}",
         "gists_url" : "https://api.github.com/users/adamjonas/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/adamjonas",
         "id" : 755825,
         "login" : "adamjonas",
         "node_id" : "MDQ6VXNlcjc1NTgyNQ==",
         "organizations_url" : "https://api.github.com/users/adamjonas/orgs",
         "received_events_url" : "https://api.github.com/users/adamjonas/received_events",
         "repos_url" : "https://api.github.com/users/adamjonas/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/adamjonas/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/adamjonas/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/adamjonas"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Likely related to https://github.com/bitcoin/bitcoin/issues/11800",
      "created_at" : "2022-10-03T14:49:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-1265579634",
      "id" : 1265579634,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "IC_kwDOABII585LbzZy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1265579634/reactions"
      },
      "updated_at" : "2022-10-03T14:49:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1265579634",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I guess there are two bugs?\r\n\r\n* fee estimation returning something lower than the min fee, which was fixed in https://github.com/bitcoin/bitcoin/pull/22722\r\n* The wallet somehow creating a tx with fee lower than the min fee\r\n\r\nTo debug the wallet issue, it would be good to double check in the debug log. The wallet should print a fee estimation debug info:\r\n\r\n```cpp\r\nwallet.WalletLogPrintf(\"Fee Calculation: Fee:%d Bytes:%u Tgt:%d (requested %d) Reason: ...\r\n```\r\n\r\n",
      "created_at" : "2022-10-03T14:59:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-1265596562",
      "id" : 1265596562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "IC_kwDOABII585Lb3iS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1265596562/reactions"
      },
      "updated_at" : "2022-10-03T14:59:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1265596562",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I wrote a basic [test](https://github.com/willcl-ark/bitcoin/commit/2c5a1e5778c73da8104f520c4505fffae7567bd7) to exercise a few of the possible cases here, although I am unsure whether OP was using full blocks, or just mining regularly...\r\n\r\n1) Create a rawtx with the `feeRate` with the setting specified in OP, sign it and send it, which seems to work every time without undercutting the fees and so failing `-minrelaytxfee` checks.\r\n2) Create a rawtx with a `feeRate` *deliberately lower* than the node's `-mintxfee` setting (which it seems is permitted by the `override_min_fee` bool in `FundTransaction`), sign it and send it. This transaction will enter senders mempool but is not accepted by the receiver who has `-minrelaytxfee` set to a value which excludes the transaction due to policy.\r\n",
      "created_at" : "2022-10-07T11:46:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-1271487580",
      "id" : 1271487580,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "IC_kwDOABII585LyVxc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1271487580/reactions"
      },
      "updated_at" : "2022-10-07T11:46:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1271487580",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing for now, the rpc issue should be fixed, but the wallet one needs more infos to debug.",
      "created_at" : "2022-10-17T07:01:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/18475#issuecomment-1280381558",
      "id" : 1280381558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18475",
      "node_id" : "IC_kwDOABII585MURJ2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1280381558/reactions"
      },
      "updated_at" : "2022-10-17T07:01:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1280381558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
