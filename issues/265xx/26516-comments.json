[
   {
      "author_association" : "MEMBER",
      "body" : "The GUI Peers details \"Transaction Relay\" tooltip text in master should be updated, but I haven't included it here to limit this pull to changes only for potential backport.  Done in https://github.com/bitcoin-core/gui/pull/681.",
      "created_at" : "2022-11-17T04:43:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26516#issuecomment-1318062876",
      "id" : 1318062876,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26516",
      "node_id" : "IC_kwDOABII585OkAsc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318062876/reactions"
      },
      "updated_at" : "2022-11-17T04:59:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318062876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26727](https://github.com/bitcoin/bitcoin/pull/26727) (rpc: remove optional from fStateStats fields by fanquake)\n* [#26621](https://github.com/bitcoin/bitcoin/pull/26621) (refactor: Continue moving application data from CNode to Peer by dergoegge)\n* [#26328](https://github.com/bitcoin/bitcoin/pull/26328) (netinfo: fix relaytxes doc, display 3 relaytxes states by jonatack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-11-17T17:03:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26516#issuecomment-1318938569",
      "id" : 1318938569,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26516",
      "node_id" : "IC_kwDOABII585OnWfJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318938569/reactions"
      },
      "updated_at" : "2022-12-19T21:38:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318938569",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26516#discussion_r1027145609"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1027145609"
         }
      },
      "author_association" : "MEMBER",
      "body" : "But this is incorrect. The default doesn't matter here - the value that it had for the entire connection is what it should be during disconnection. That value is gone at this point. So either we can't send the field, or can't send the peer entirely. Sending \"false\" is wrong.",
      "commit_id" : "5dcc095dc780c491c2680b160fbc7689adedcea1",
      "created_at" : "2022-11-19T21:29:06Z",
      "diff_hunk" : "@@ -200,9 +200,7 @@ static RPCHelpMan getpeerinfo()\n         ServiceFlags services{fStateStats ? statestats.their_services : ServiceFlags::NODE_NONE};\n         obj.pushKV(\"services\", strprintf(\"%016x\", services));\n         obj.pushKV(\"servicesnames\", GetServicesNames(services));\n-        if (fStateStats) {\n-            obj.pushKV(\"relaytxes\", statestats.m_relay_txs);\n-        }\n+        obj.pushKV(\"relaytxes\", fStateStats ? statestats.m_relay_txs : false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26516#discussion_r1027145609",
      "id" : 1027145609,
      "line" : 203,
      "node_id" : "PRRC_kwDOABII5849OP-J",
      "original_commit_id" : "5dcc095dc780c491c2680b160fbc7689adedcea1",
      "original_line" : 203,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 16,
      "pull_request_review_id" : 1187123503,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26516",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1027145609/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-19T21:29:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1027145609",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26516#discussion_r1037036889"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26516"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1037036889"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think agree with the statement above, [fStateStats](https://github.com/jonatack/bitcoin/blob/2022-11-getpeerinfo-relayxes/src/net_processing.cpp#L1552) is only true if the peer id exists in [m_node_states](https://github.com/jonatack/bitcoin/blob/2022-11-getpeerinfo-relayxes/src/net_processing.cpp#L733) and [m_peer_map](https://github.com/jonatack/bitcoin/blob/2022-11-getpeerinfo-relayxes/src/net_processing.cpp#L730), so it seems like the node shouldn't exist in the return value at all.\r\n\r\nI guess according to the comment at https://github.com/bitcoin/bitcoin/pull/26457#pullrequestreview-1181641835, there is the potential for a race condition, but seems awkward to replicate in the wild as any disconnection removes the nodes pointers and states entirely by the time the rpc is called.",
      "commit_id" : "5dcc095dc780c491c2680b160fbc7689adedcea1",
      "created_at" : "2022-12-01T12:13:29Z",
      "diff_hunk" : "@@ -200,9 +200,7 @@ static RPCHelpMan getpeerinfo()\n         ServiceFlags services{fStateStats ? statestats.their_services : ServiceFlags::NODE_NONE};\n         obj.pushKV(\"services\", strprintf(\"%016x\", services));\n         obj.pushKV(\"servicesnames\", GetServicesNames(services));\n-        if (fStateStats) {\n-            obj.pushKV(\"relaytxes\", statestats.m_relay_txs);\n-        }\n+        obj.pushKV(\"relaytxes\", fStateStats ? statestats.m_relay_txs : false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26516#discussion_r1037036889",
      "id" : 1037036889,
      "in_reply_to_id" : 1027145609,
      "line" : 203,
      "node_id" : "PRRC_kwDOABII5849z-1Z",
      "original_commit_id" : "5dcc095dc780c491c2680b160fbc7689adedcea1",
      "original_line" : 203,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 16,
      "pull_request_review_id" : 1200878139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26516",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1037036889/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-12-01T12:13:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1037036889",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18324680?v=4",
         "events_url" : "https://api.github.com/users/ccdle12/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ccdle12/followers",
         "following_url" : "https://api.github.com/users/ccdle12/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ccdle12/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ccdle12",
         "id" : 18324680,
         "login" : "ccdle12",
         "node_id" : "MDQ6VXNlcjE4MzI0Njgw",
         "organizations_url" : "https://api.github.com/users/ccdle12/orgs",
         "received_events_url" : "https://api.github.com/users/ccdle12/received_events",
         "repos_url" : "https://api.github.com/users/ccdle12/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ccdle12/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ccdle12/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ccdle12"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "What is the status of this?\r\n\r\nThink I agree with the two commentors above. Returning (potentially) incorrect data, just so that we have a value for a field that may otherwise not be present (but only if you're racing a peer disconnect when calling the RPC, where it's unclear if we should even be providing data), doesn't necessarily seem like an improvement.  \r\n\r\n@mzumsande given that you're listed as co-author, do you have any thoughts?",
      "created_at" : "2022-12-05T10:42:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26516#issuecomment-1337116436",
      "id" : 1337116436,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26516",
      "node_id" : "IC_kwDOABII585PsscU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1337116436/reactions"
      },
      "updated_at" : "2022-12-05T10:42:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1337116436",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> As for the fields of CNodeStateStats I think that the race at shutdown should be fixed.\r\n\r\n@mzumsande Thanks. I agree, and think either of the approaches, of not returning data when it can't be/isn't complete, or taking a lock and ensuring data is complete, are better approaches than filling fields with default values, in the case that data may be missing.",
      "created_at" : "2022-12-06T11:27:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26516#issuecomment-1339180571",
      "id" : 1339180571,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26516",
      "node_id" : "IC_kwDOABII585P0kYb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1339180571/reactions"
      },
      "updated_at" : "2022-12-06T11:27:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1339180571",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing in favor of #26328.",
      "created_at" : "2023-01-10T21:11:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26516#issuecomment-1377860710",
      "id" : 1377860710,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26516",
      "node_id" : "IC_kwDOABII585SIHxm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1377860710/reactions"
      },
      "updated_at" : "2023-01-10T21:11:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1377860710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
