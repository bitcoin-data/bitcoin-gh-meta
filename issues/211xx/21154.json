{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "NONE",
   "body" : "Running `bitcoin-qt.exe -testnet` creates a separate testnet QSettings called `Bitcoin-Qt-testnet`. I assume this was done on purpose, so you can easily run testnet settings in parallel to mainnet.\r\n\r\n**Expected behavior**\r\n\r\nChanging settings in the `Bitcoin-Qt-testnet` QSettings should be reflected in the Qt wallet when running with `-testnet`.\r\n\r\nFor example, on Windows the QSettings are stored in the registry. The testnet key is here:\r\n\r\n![image](https://user-images.githubusercontent.com/78885860/107659308-4d685500-6c87-11eb-87b0-79e5e87b1653.png)\r\n\r\n**Actual behavior**\r\n\r\nThe `Bitcoin-Qt-testnet` settings are ignored, and `Bitcoin-Qt` mainnet settings are used in stead.\r\n\r\n**To reproduce**\r\n\r\nOn a clean system, start the wallet for the first time in `-testnet` mode. In the start wizard, change any option (e.g. the path). Observe how all defaults are written to `Bitcoin-Qt-testnet`, but the updated settings are written to the (previously empty) `Bitcoin-Qt` QSettings:\r\n\r\n![image](https://user-images.githubusercontent.com/78885860/107662270-6aeaee00-6c8a-11eb-893c-ddbab9798c99.png)\r\n\r\n**What is happening**\r\n\r\nIt appears as if during the initialization of the app (while writing default settings), the appName (and QSettings based on appName) is still `QAPP_APP_NAME_TESTNET`. Yet later (when reading the settings) the app name changed to `QAPP_APP_NAME_DEFAULT`.\r\n\r\n**What causes this**\r\n\r\nPerhaps because here the appName is set to `QAPP_APP_NAME_DEFAULT`:\r\nhttps://github.com/bitcoin/bitcoin/blob/8e1913ae025ad8912457abe24ae5c61da02fc17a/src/qt/bitcoin.cpp#L496-L501\r\n\r\nRather than the one from the test NetworkStyle:\r\nhttps://github.com/bitcoin/bitcoin/blob/8e1913ae025ad8912457abe24ae5c61da02fc17a/src/qt/networkstyle.cpp#L14-L24\r\n\r\nPerhaps it would work as intended if we would use the NetworkStyle app name. E.g.:\r\n\r\n```diff\r\n    /// 3. Application identification\r\n    // must be set before OptionsModel is initialized or translations are loaded,\r\n    // as it is used to locate QSettings\r\n    QApplication::setOrganizationName(QAPP_ORG_NAME);\r\n    QApplication::setOrganizationDomain(QAPP_ORG_DOMAIN);\r\n-    QApplication::setApplicationName(QAPP_APP_NAME_DEFAULT);\r\n+    QApplication::setApplicationName(networkStyle->getAppName());\r\n```\r\n\r\n**System information**\r\n\r\nWindows 10\r\nBitcoin 0.21 precompiled\r\n\r\n**Extra info**\r\n\r\nIt is possible that the intended behavior was never finished and forgotten, or it was never intended to work the way I am assuming.\r\n\r\nOriginally found on Syscoin here: https://github.com/syscoin/syscoin/issues/417",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21154/comments",
   "created_at" : "2021-02-11T15:59:09Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21154/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/21154",
   "id" : 806523307,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "description" : null,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21154/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU4MDY1MjMzMDc=",
   "number" : 21154,
   "performed_via_github_app" : null,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Testnet configuration is ignored.",
   "updated_at" : "2021-02-11T16:02:58Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21154",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/78885860?v=4",
      "events_url" : "https://api.github.com/users/beirut-boop/events{/privacy}",
      "followers_url" : "https://api.github.com/users/beirut-boop/followers",
      "following_url" : "https://api.github.com/users/beirut-boop/following{/other_user}",
      "gists_url" : "https://api.github.com/users/beirut-boop/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/beirut-boop",
      "id" : 78885860,
      "login" : "beirut-boop",
      "node_id" : "MDQ6VXNlcjc4ODg1ODYw",
      "organizations_url" : "https://api.github.com/users/beirut-boop/orgs",
      "received_events_url" : "https://api.github.com/users/beirut-boop/received_events",
      "repos_url" : "https://api.github.com/users/beirut-boop/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/beirut-boop/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/beirut-boop/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/beirut-boop"
   }
}
