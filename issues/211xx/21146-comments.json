[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20833 (rpc/validation: enable packages through testmempoolaccept by glozow)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-02-11T05:56:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-777219401",
      "id" : 777219401,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21146",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc3NzIxOTQwMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-24T01:50:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/777219401",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r574866661"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574866661"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "âï¸ this is the main change ð ",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-11T22:20:07Z",
      "diff_hunk" : "@@ -671,7 +691,7 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n     // we have all inputs cached now, so switch back to dummy (to protect\n     // against bugs where we pull more inputs from disk that miss being added\n     // to coins_to_uncache)\n-    m_view.SetBackend(m_dummy);\n+    m_viewmempool.SetBackend(m_dummy);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r574866661",
      "id" : 574866661,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg2NjY2MQ==",
      "original_commit_id" : "14c94b30f1dba81ebb5b9af1b834db7d2a88f297",
      "original_line" : 708,
      "original_position" : 104,
      "original_start_line" : 674,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 589036012,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574866661",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Do you think you can take the following diff in the doc followup commit ?\r\n\r\n```\r\ndiff --git a/src/rpc/rawtransaction.cpp b/src/rpc/rawtransaction.cpp\r\nindex ac4240447..f8f4a6d94 100644\r\n--- a/src/rpc/rawtransaction.cpp\r\n+++ b/src/rpc/rawtransaction.cpp\r\n@@ -896,7 +896,7 @@ static RPCHelpMan testmempoolaccept()\r\n                         {\r\n                             {RPCResult::Type::STR_HEX, \"txid\", \"The transaction hash in hex\"},\r\n                             {RPCResult::Type::STR_HEX, \"wtxid\", \"The transaction witness hash in hex\"},\r\n-                            {RPCResult::Type::BOOL, \"allowed\", \"If the mempool allows this tx to be inserted\"},\r\n+                            {RPCResult::Type::BOOL, \"allowed\", \"If the mempool and client specified maxfeerate allows this tx to be inserted\"},\r\n                             {RPCResult::Type::NUM, \"vsize\", \"Virtual transaction size as defined in BIP 141. This is different from actual serialized size for witness transactions as witness data is discounted (only present when 'allowed' is true)\"},\r\n                             {RPCResult::Type::OBJ, \"fees\", \"Transaction fees (only present if 'allowed' is true)\",\r\n                             {\r\n```\r\n\r\nThat would close my [#21704](https://github.com/bitcoin/bitcoin/issues/21074) concerns for now :) ?",
      "created_at" : "2021-02-12T14:02:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-778213317",
      "id" : 778213317,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21146",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc3ODIxMzMxNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-12T14:02:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/778213317",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-02-20T09:56:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-782598141",
      "id" : 782598141,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21146",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MjU5ODE0MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-20T09:56:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/782598141",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased",
      "created_at" : "2021-02-20T17:57:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-782723514",
      "id" : 782723514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21146",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MjcyMzUxNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-20T17:57:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/782723514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r580289237"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580289237"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You switch `m_view.SetBackend(m_dummy)` to `m_viewmempool.SetBackend(m_dummy)` in commit _[validation] disconnect m_viewmempool from coins cache when unnecessary_.\r\n\r\nI think perhaps in that commit you should just add `m_viewmempool.SetBackend(m_dummy)`, and then in the subsequent commit (_[validation] keep m_view->m_viewmempool connected_), you should remove `m_view.SetBackend(m_dummy)`. That keeps the commits more separated (the first is adding the m_viewmempool // CoinsTip() split, and the second is removing the m_view // m_viewmempool split).",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-22T14:25:51Z",
      "diff_hunk" : "@@ -671,7 +691,7 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n     // we have all inputs cached now, so switch back to dummy (to protect\n     // against bugs where we pull more inputs from disk that miss being added\n     // to coins_to_uncache)\n-    m_view.SetBackend(m_dummy);\n+    m_viewmempool.SetBackend(m_dummy);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r580289237",
      "id" : 580289237,
      "in_reply_to_id" : 574866661,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDI4OTIzNw==",
      "original_commit_id" : "14c94b30f1dba81ebb5b9af1b834db7d2a88f297",
      "original_line" : 708,
      "original_position" : 104,
      "original_start_line" : 674,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 595400630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580289237",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r580443711"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580443711"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good point! Done in the last push",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-22T17:33:22Z",
      "diff_hunk" : "@@ -671,7 +691,7 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n     // we have all inputs cached now, so switch back to dummy (to protect\n     // against bugs where we pull more inputs from disk that miss being added\n     // to coins_to_uncache)\n-    m_view.SetBackend(m_dummy);\n+    m_viewmempool.SetBackend(m_dummy);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r580443711",
      "id" : 580443711,
      "in_reply_to_id" : 574866661,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDQ0MzcxMQ==",
      "original_commit_id" : "14c94b30f1dba81ebb5b9af1b834db7d2a88f297",
      "original_line" : 708,
      "original_position" : 104,
      "original_start_line" : 674,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 595602611,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580443711",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the review @jnewbery! Addressed your comments. Added some sentences about the uncaching behavior to https://github.com/bitcoin/bitcoin/commit/acef823e895b80fd7f4c2f5a44c3470fe46c1a6a commit log. ",
      "created_at" : "2021-02-22T17:49:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-783552771",
      "id" : 783552771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21146",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MzU1Mjc3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-22T17:49:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783552771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK acef823e895b80fd7f4c2f5a44c3470fe46c1a6a",
      "created_at" : "2021-02-22T19:34:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-783619963",
      "id" : 783619963,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21146",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MzYxOTk2Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-22T19:34:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783619963",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r581258456"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581258456"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I would rather keep coin cache cleanup at this location. After this change, it's spread in two locations : in case of success evaluation in `AcceptSingleTransaction`, in case of failure in `MemPoolAccept` destructor. A reviewer has to read both locations now. \r\n\r\nFurther, it's harder to qualify that cleanup is reserved for success path in `AcceptSingleTransaction`, considering that `MemPoolAcceptResult` internal state is provided by `Workspace`.\r\n\r\nAlso, I don't know about relying on RAII semantic, the destructor will be only called when object is going out of scope. In that case, does it mean we'll only cleanup when caller ends up ? For e.g, if the caller was `BroadcastTransaction`, may the coin cache cleanup on `cs_main` lock tacking before `RelayTransaction` ?",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-23T17:54:46Z",
      "diff_hunk" : "@@ -1088,20 +1104,10 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       bool bypass_limits, bool test_accept)\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n-    std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache, test_accept };\n-\n+    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, test_accept };\n     assert(std::addressof(::ChainstateActive()) == std::addressof(active_chainstate));\n     const MempoolAcceptResult result = MemPoolAccept(pool, active_chainstate).AcceptSingleTransaction(tx, args);\n-    if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\n-        // Remove coins that were not present in the coins cache before calling ATMPW;\n-        // this is to prevent memory DoS in case we receive a large number of\n-        // invalid transactions that attempt to overrun the in-memory coins cache\n-        // (`CCoinsViewCache::cacheCoins`).\n \n-        for (const COutPoint& hashTx : coins_to_uncache)\n-            active_chainstate.CoinsTip().Uncache(hashTx);\n-    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r581258456",
      "id" : 581258456,
      "line" : 1104,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MTI1ODQ1Ng==",
      "original_commit_id" : "acef823e895b80fd7f4c2f5a44c3470fe46c1a6a",
      "original_line" : 1104,
      "original_position" : 156,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 143,
      "pull_request_review_id" : 596623419,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581258456",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r581329523"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581329523"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> After this change, it's spread in two locations : in case of success evaluation in AcceptSingleTransaction, in case of failure in MemPoolAccept destructor. \r\n\r\nNot really. The only location a reviewer has to check is wherever they _want_ to keep the coins in cache. Also, the change here means that if someone forgets to consider uncaching, it defaults to uncache all. This is safer.\r\n\r\n\r\n> Also, I don't know about relying on RAII semantic, the destructor will be only called when object is going out of scope. In that case, does it mean we'll only cleanup when caller ends up ? For e.g, if the caller was BroadcastTransaction, may the coin cache cleanup on cs_main lock tacking before RelayTransaction ?\r\n\r\nThe two possible callers of `MemPoolAccept` are ATMP and ProcessNewPackage They invoke it like this:\r\n\r\n```c\r\nconst MempoolAcceptResult result = MemPoolAccept(pool, active_chainstate).AcceptSingleTransaction(tx, args);\r\n```\r\n\r\nafaik it goes out of scope immediately, before the lock is released.\r\n",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-23T19:31:39Z",
      "diff_hunk" : "@@ -1088,20 +1104,10 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       bool bypass_limits, bool test_accept)\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n-    std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache, test_accept };\n-\n+    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, test_accept };\n     assert(std::addressof(::ChainstateActive()) == std::addressof(active_chainstate));\n     const MempoolAcceptResult result = MemPoolAccept(pool, active_chainstate).AcceptSingleTransaction(tx, args);\n-    if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\n-        // Remove coins that were not present in the coins cache before calling ATMPW;\n-        // this is to prevent memory DoS in case we receive a large number of\n-        // invalid transactions that attempt to overrun the in-memory coins cache\n-        // (`CCoinsViewCache::cacheCoins`).\n \n-        for (const COutPoint& hashTx : coins_to_uncache)\n-            active_chainstate.CoinsTip().Uncache(hashTx);\n-    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r581329523",
      "id" : 581329523,
      "in_reply_to_id" : 581258456,
      "line" : 1104,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MTMyOTUyMw==",
      "original_commit_id" : "acef823e895b80fd7f4c2f5a44c3470fe46c1a6a",
      "original_line" : 1104,
      "original_position" : 156,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 143,
      "pull_request_review_id" : 596721571,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581329523",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r581948585"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581948585"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Not really. The only location a reviewer has to check is wherever they want to keep the coins in cache. \r\n\r\nDepends what you're willingly to convince yourself by reviewing. Assuming uncaching  in case of failures is the correct behavior, looking at the proposed changes, you have to a) verify that uncaching code is well-implemented in `MemPoolAccept` destructor, b) identify that caching conservation is covering all success paths and thus dissociate success code path from errors one in `AcceptSingleTransaction` and c) ensure the RAAI semantic is enforced as intended. IMHO, more complex than current one-place location.\r\n\r\nThat said, I think the code is correct, and each one review process and code style flavors might turn as really abstract discussion so not going to argue further :)",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-24T13:14:57Z",
      "diff_hunk" : "@@ -1088,20 +1104,10 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       bool bypass_limits, bool test_accept)\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n-    std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache, test_accept };\n-\n+    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, test_accept };\n     assert(std::addressof(::ChainstateActive()) == std::addressof(active_chainstate));\n     const MempoolAcceptResult result = MemPoolAccept(pool, active_chainstate).AcceptSingleTransaction(tx, args);\n-    if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\n-        // Remove coins that were not present in the coins cache before calling ATMPW;\n-        // this is to prevent memory DoS in case we receive a large number of\n-        // invalid transactions that attempt to overrun the in-memory coins cache\n-        // (`CCoinsViewCache::cacheCoins`).\n \n-        for (const COutPoint& hashTx : coins_to_uncache)\n-            active_chainstate.CoinsTip().Uncache(hashTx);\n-    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r581948585",
      "id" : 581948585,
      "in_reply_to_id" : 581258456,
      "line" : 1104,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MTk0ODU4NQ==",
      "original_commit_id" : "acef823e895b80fd7f4c2f5a44c3470fe46c1a6a",
      "original_line" : 1104,
      "original_position" : 156,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 143,
      "pull_request_review_id" : 597463707,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581948585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r582118131"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582118131"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> The two possible callers of MemPoolAccept are ATMP and ProcessNewPackage They invoke it like this:\r\n> \r\n> `const MempoolAcceptResult result = MemPoolAccept(pool, active_chainstate).AcceptSingleTransaction(tx, args);`\r\n> \r\n> afaik it goes out of scope immediately, before the lock is released.\r\n\r\nI believe you're right. In that expression, `MemPoolAccept()` is a temporary, and the lifetime rules for temporaries are\r\n\r\n> All temporary objects are destroyed as the last step in evaluating the full-expression that (lexically) contains the point where they were created, and if multiple temporary objects were created, they are destroyed in the order opposite to the order of creation. This is true even if that evaluation ends in throwing an exception.\r\n\r\nhttps://en.cppreference.com/w/cpp/language/lifetime#Temporary_object_lifetime\r\n\r\nNote that there are two exceptions to that rule, neither of which apply here:\r\n\r\n> - The lifetime of a temporary object may be extended by binding to a const lvalue reference or to an rvalue reference (since C++11), see reference initialization for details.\r\n> - The lifetime of a temporary object created when evaluating the default arguments of a default constructor used to initialize an element of an array ends before the next element of the array begins initialization.\r\n\r\n",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-24T16:41:05Z",
      "diff_hunk" : "@@ -1088,20 +1104,10 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       bool bypass_limits, bool test_accept)\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n-    std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache, test_accept };\n-\n+    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, test_accept };\n     assert(std::addressof(::ChainstateActive()) == std::addressof(active_chainstate));\n     const MempoolAcceptResult result = MemPoolAccept(pool, active_chainstate).AcceptSingleTransaction(tx, args);\n-    if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\n-        // Remove coins that were not present in the coins cache before calling ATMPW;\n-        // this is to prevent memory DoS in case we receive a large number of\n-        // invalid transactions that attempt to overrun the in-memory coins cache\n-        // (`CCoinsViewCache::cacheCoins`).\n \n-        for (const COutPoint& hashTx : coins_to_uncache)\n-            active_chainstate.CoinsTip().Uncache(hashTx);\n-    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r582118131",
      "id" : 582118131,
      "in_reply_to_id" : 581258456,
      "line" : 1104,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjExODEzMQ==",
      "original_commit_id" : "acef823e895b80fd7f4c2f5a44c3470fe46c1a6a",
      "original_line" : 1104,
      "original_position" : 156,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 143,
      "pull_request_review_id" : 597689563,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582118131",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r582119695"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582119695"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You can const this if you want",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-24T16:43:05Z",
      "diff_hunk" : "@@ -1088,20 +1104,10 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       bool bypass_limits, bool test_accept)\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n-    std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache, test_accept };\n-\n+    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, test_accept };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r582119695",
      "id" : 582119695,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjExOTY5NQ==",
      "original_commit_id" : "acef823e895b80fd7f4c2f5a44c3470fe46c1a6a",
      "original_line" : 1107,
      "original_position" : 145,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 597691635,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582119695",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r582120303"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582120303"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Consider removing \"After we've (potentially) uncached entries\". That was referring to the line above. Now that it's removed, that part of the comment is not particularly relevant here.",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-24T16:43:52Z",
      "diff_hunk" : "@@ -1088,20 +1104,10 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       bool bypass_limits, bool test_accept)\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n-    std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache, test_accept };\n-\n+    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, test_accept };\n     assert(std::addressof(::ChainstateActive()) == std::addressof(active_chainstate));\n     const MempoolAcceptResult result = MemPoolAccept(pool, active_chainstate).AcceptSingleTransaction(tx, args);\n-    if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\n-        // Remove coins that were not present in the coins cache before calling ATMPW;\n-        // this is to prevent memory DoS in case we receive a large number of\n-        // invalid transactions that attempt to overrun the in-memory coins cache\n-        // (`CCoinsViewCache::cacheCoins`).\n \n-        for (const COutPoint& hashTx : coins_to_uncache)\n-            active_chainstate.CoinsTip().Uncache(hashTx);\n-    }\n     // After we've (potentially) uncached entries, ensure our coins cache is still within its size limits",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r582120303",
      "id" : 582120303,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjEyMDMwMw==",
      "original_commit_id" : "acef823e895b80fd7f4c2f5a44c3470fe46c1a6a",
      "original_line" : 1111,
      "original_position" : 157,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 597691635,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-25T17:33:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582120303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r583033965"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583033965"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I always wanna const",
      "commit_id" : "aeaf5407c3870a1fd824209b0d0a2630c1fb3493",
      "created_at" : "2021-02-25T17:40:02Z",
      "diff_hunk" : "@@ -1088,20 +1104,10 @@ static MempoolAcceptResult AcceptToMemoryPoolWithTime(const CChainParams& chainp\n                                                       bool bypass_limits, bool test_accept)\n                                                       EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n-    std::vector<COutPoint> coins_to_uncache;\n-    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, coins_to_uncache, test_accept };\n-\n+    MemPoolAccept::ATMPArgs args { chainparams, nAcceptTime, bypass_limits, test_accept };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#discussion_r583033965",
      "id" : 583033965,
      "in_reply_to_id" : 582119695,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzAzMzk2NQ==",
      "original_commit_id" : "acef823e895b80fd7f4c2f5a44c3470fe46c1a6a",
      "original_line" : 1107,
      "original_position" : 145,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 598832197,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21146",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-25T17:40:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583033965",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm working on #20833 and realized I don't need to keep `m_view` and `m_viewmempool` connected for it to work ð so I took out the 3rd commit (_[validation] keep m_view->m_viewmempool connected_). @ariard you might find this PR a bit more acceptable now :). I'll try to add https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-778213317 to a different PR that's more relevant to the RPC code.\r\n\r\nAlso addressed @jnewbery's comments https://github.com/bitcoin/bitcoin/pull/21146#discussion_r582119695 and https://github.com/bitcoin/bitcoin/pull/21146#discussion_r582120303.",
      "created_at" : "2021-02-25T17:51:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-786086551",
      "id" : 786086551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21146",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4NjA4NjU1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-25T18:03:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/786086551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I still think this would be a nice change but since I don't need this for #20833 anymore, I'm closing this to focus on that instead.",
      "created_at" : "2021-03-02T18:27:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21146#issuecomment-789116795",
      "id" : 789116795,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21146",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4OTExNjc5NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T18:27:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789116795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   }
]
