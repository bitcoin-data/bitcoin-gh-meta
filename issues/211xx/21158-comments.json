[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r575665561"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/575665561"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I would advice introducing the code style changes in their own commit. Also, I think it's clearer to keep the `Tx` prefix, you have other class of inputs in the codebase beyond transaction like hash elements.",
      "commit_id" : "698391966afd0004d6d31fc590ffb8e4222408b8",
      "created_at" : "2021-02-13T13:09:38Z",
      "diff_hunk" : "@@ -13,13 +13,13 @@\n namespace {\n \n /** A class that deserializes a single CTransaction one time. */\n-class TxInputStream\n+class InputStream",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r575665561",
      "id" : 575665561,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTY2NTU2MQ==",
      "original_commit_id" : "883cac2efec37e4aa01b419c0291e55bb36c40d7",
      "original_line" : 16,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/script/bitcoinconsensus.cpp",
      "position" : null,
      "pull_request_review_id" : 589967020,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T17:43:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/575665561",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r575668119"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/575668119"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Have a look on b7dbeb2, I think you should bump the API version, at least it was done for segwit support.\r\n\r\nI think you should also add a commit to document this change in `doc/shared-libraries.md`.",
      "commit_id" : "698391966afd0004d6d31fc590ffb8e4222408b8",
      "created_at" : "2021-02-13T13:37:11Z",
      "diff_hunk" : "@@ -92,18 +98,41 @@ static int verify_script(const unsigned char *scriptPubKey, unsigned int scriptP\n         set_error(err, bitcoinconsensus_ERR_OK);\n \n         PrecomputedTransactionData txdata(tx);\n+\n+        if (spentOutputs != nullptr && flags & bitcoinconsensus_SCRIPT_FLAGS_VERIFY_TAPROOT) {\n+            txdata.Init(tx, std::move(spent_outputs));\n+        }\n+\n         return VerifyScript(tx.vin[nIn].scriptSig, CScript(scriptPubKey, scriptPubKey + scriptPubKeyLen), &tx.vin[nIn].scriptWitness, flags, TransactionSignatureChecker(&tx, nIn, amount, txdata), nullptr);\n     } catch (const std::exception&) {\n         return set_error(err, bitcoinconsensus_ERR_TX_DESERIALIZE); // Error deserializing\n     }\n }\n \n+int bitcoinconsensus_verify_script_with_spent_outputs(const unsigned char *scriptPubKey, unsigned int scriptPubKeyLen, int64_t amount,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r575668119",
      "id" : 575668119,
      "line" : 115,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTY2ODExOQ==",
      "original_commit_id" : "883cac2efec37e4aa01b419c0291e55bb36c40d7",
      "original_line" : 115,
      "original_position" : 64,
      "original_start_line" : null,
      "path" : "src/script/bitcoinconsensus.cpp",
      "position" : 57,
      "pull_request_review_id" : 589967020,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T17:43:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/575668119",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r575668577"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/575668577"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Check the equality between inputs/outputs against `tx.vin.size()` (a `bitcoinconsensus_ERR_OUTP_INDEX` ?)",
      "commit_id" : "698391966afd0004d6d31fc590ffb8e4222408b8",
      "created_at" : "2021-02-13T13:40:52Z",
      "diff_hunk" : "@@ -75,14 +75,20 @@ static bool verify_flags(unsigned int flags)\n \n static int verify_script(const unsigned char *scriptPubKey, unsigned int scriptPubKeyLen, CAmount amount,\n                                     const unsigned char *txTo        , unsigned int txToLen,\n+                                    const unsigned char* spentOutputs, unsigned int spentOutputsLen,\n                                     unsigned int nIn, unsigned int flags, bitcoinconsensus_error* err)\n {\n     if (!verify_flags(flags)) {\n         return set_error(err, bitcoinconsensus_ERR_INVALID_FLAGS);\n     }\n     try {\n-        TxInputStream stream(PROTOCOL_VERSION, txTo, txToLen);\n+        InputStream stream(PROTOCOL_VERSION, txTo, txToLen);\n         CTransaction tx(deserialize, stream);\n+        std::vector<CTxOut> spent_outputs;\n+        if (spentOutputs != nullptr) {\n+            InputStream spent_outputs_stream(PROTOCOL_VERSION, spentOutputs, spentOutputsLen);\n+            spent_outputs_stream >> spent_outputs;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r575668577",
      "id" : 575668577,
      "line" : 94,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTY2ODU3Nw==",
      "original_commit_id" : "883cac2efec37e4aa01b419c0291e55bb36c40d7",
      "original_line" : 94,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/script/bitcoinconsensus.cpp",
      "position" : 38,
      "pull_request_review_id" : 589967020,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T17:43:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/575668577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Thanks for adding this. If the API is bumped, take care to notify library users through mentioning the change in 0.22 release note (`doc/release-noted.md`)\r\n\r\n@ariard Thanks for the review. Do you have a suggestion about which section the change should be mentioned in?",
      "created_at" : "2021-02-14T01:46:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-778706812",
      "id" : 778706812,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc3ODcwNjgxMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-14T01:46:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/778706812",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/777143?v=4",
         "events_url" : "https://api.github.com/users/jrawsthorne/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrawsthorne/followers",
         "following_url" : "https://api.github.com/users/jrawsthorne/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrawsthorne/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrawsthorne",
         "id" : 777143,
         "login" : "jrawsthorne",
         "node_id" : "MDQ6VXNlcjc3NzE0Mw==",
         "organizations_url" : "https://api.github.com/users/jrawsthorne/orgs",
         "received_events_url" : "https://api.github.com/users/jrawsthorne/received_events",
         "repos_url" : "https://api.github.com/users/jrawsthorne/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrawsthorne/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrawsthorne/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrawsthorne"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jrawsthorne \"Tools and Utilities\" sounds good to me.",
      "created_at" : "2021-02-14T22:06:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-778849336",
      "id" : 778849336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc3ODg0OTMzNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-02-14T22:06:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/778849336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r577344462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/577344462"
         }
      },
      "author_association" : "NONE",
      "body" : "there is a typo in the function name\r\n```suggestion\r\n`bitcoinconsensus_verify_script`, `bitcoinconsensus_verify_script_with_amount` and `bitcoinconsensus_verify_script_with_spent_outputs` return an `int` with the status of the verification. It will be `1` if the input script correctly spends the previous output `scriptPubKey`.\r\n```",
      "commit_id" : "698391966afd0004d6d31fc590ffb8e4222408b8",
      "created_at" : "2021-02-17T05:56:28Z",
      "diff_hunk" : "@@ -11,13 +11,14 @@ The interface is defined in the C header `bitcoinconsensus.h` located in `src/sc\n \n #### Version\n \n-`bitcoinconsensus_version` returns an `unsigned int` with the API version *(currently `1`)*.\n+`bitcoinconsensus_version` returns an `unsigned int` with the API version *(currently `2`)*.\n \n #### Script Validation\n \n-`bitcoinconsensus_verify_script` returns an `int` with the status of the verification. It will be `1` if the input script correctly spends the previous output `scriptPubKey`.\n+`bitcoinconsensus_verify_script`, `bitcoinconsensus_verify_script_with_amounts` and `bitcoinconsensus_verify_script_with_spent_outputs` return an `int` with the status of the verification. It will be `1` if the input script correctly spends the previous output `scriptPubKey`.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r577344462",
      "id" : 577344462,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NzM0NDQ2Mg==",
      "original_commit_id" : "01086293a76ad161dcbc14360bc7cc2c72b65708",
      "original_line" : 18,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "doc/shared-libraries.md",
      "position" : null,
      "pull_request_review_id" : 591859157,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T17:43:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/577344462",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/29142493?v=4",
         "events_url" : "https://api.github.com/users/SomberNight/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SomberNight/followers",
         "following_url" : "https://api.github.com/users/SomberNight/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SomberNight/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SomberNight",
         "id" : 29142493,
         "login" : "SomberNight",
         "node_id" : "MDQ6VXNlcjI5MTQyNDkz",
         "organizations_url" : "https://api.github.com/users/SomberNight/orgs",
         "received_events_url" : "https://api.github.com/users/SomberNight/received_events",
         "repos_url" : "https://api.github.com/users/SomberNight/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SomberNight/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SomberNight/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SomberNight"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r577345442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/577345442"
         }
      },
      "author_association" : "NONE",
      "body" : "same as above, typo in function name",
      "commit_id" : "698391966afd0004d6d31fc590ffb8e4222408b8",
      "created_at" : "2021-02-17T05:59:00Z",
      "diff_hunk" : "@@ -26,6 +27,28 @@ The interface is defined in the C header `bitcoinconsensus.h` located in `src/sc\n - `unsigned int flags` - The script validation flags *(see below)*.\n - `bitcoinconsensus_error* err` - Will have the error/success code for the operation *(see below)*.\n \n+###### bitcoinconsensus_verify_script_with_amounts",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r577345442",
      "id" : 577345442,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NzM0NTQ0Mg==",
      "original_commit_id" : "01086293a76ad161dcbc14360bc7cc2c72b65708",
      "original_line" : 30,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "doc/shared-libraries.md",
      "position" : null,
      "pull_request_review_id" : 591859157,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T17:43:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/577345442",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/29142493?v=4",
         "events_url" : "https://api.github.com/users/SomberNight/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SomberNight/followers",
         "following_url" : "https://api.github.com/users/SomberNight/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SomberNight/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SomberNight",
         "id" : 29142493,
         "login" : "SomberNight",
         "node_id" : "MDQ6VXNlcjI5MTQyNDkz",
         "organizations_url" : "https://api.github.com/users/SomberNight/orgs",
         "received_events_url" : "https://api.github.com/users/SomberNight/received_events",
         "repos_url" : "https://api.github.com/users/SomberNight/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SomberNight/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SomberNight/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SomberNight"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r581144674"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581144674"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you update this to point to `rust-bitcoinconsensus` :) ?",
      "commit_id" : "698391966afd0004d6d31fc590ffb8e4222408b8",
      "created_at" : "2021-02-23T15:39:01Z",
      "diff_hunk" : "@@ -42,6 +66,8 @@ The interface is defined in the C header `bitcoinconsensus.h` located in `src/sc\n - `bitcoinconsensus_ERR_DESERIALIZE` - An error deserializing `txTo`\n - `bitcoinconsensus_ERR_AMOUNT_REQUIRED` - Input amount is required if WITNESS is used\n - `bitcoinconsensus_ERR_INVALID_FLAGS` - Script verification `flags` are invalid (i.e. not part of the libconsensus interface)\n+- `bitcoinconsensus_ERR_SPENT_OUTPUTS_REQUIRED` - Spent outputs are required if TAPROOT is used\n+- `bitcoinconsensus_ERR_SPENT_OUTPUTS_MISMATCH` - Spent outputs size doesn't match tx inputs size\n \n ### Example Implementations",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r581144674",
      "id" : 581144674,
      "line" : 72,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MTE0NDY3NA==",
      "original_commit_id" : "28245a8641c6a4688f20f5c01645583234a51286",
      "original_line" : 72,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "doc/shared-libraries.md",
      "position" : 61,
      "pull_request_review_id" : 596477139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-26T17:43:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/581144674",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #22440 by JeremyRubin\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-03-02T11:39:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-788845197",
      "id" : 788845197,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODg0NTE5Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-14T09:52:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788845197",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\nðµï¸ @harding has been requested to review this pull request as specified in the REVIEWERS file.",
      "created_at" : "2021-03-15T16:50:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-799574662",
      "id" : 799574662,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5OTU3NDY2Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-15T16:50:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799574662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-04-13T03:55:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-818411950",
      "id" : 818411950,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxODQxMTk1MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-13T03:55:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818411950",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code Review ACK 7c85ec9. Changes from last ACK is complying VerifyScript call to new MissingDataBehavior introduced by b77b0cc and mention of rust-bitcoin lib.",
      "created_at" : "2021-04-16T16:50:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-821306887",
      "id" : 821306887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTMwNjg4Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-16T16:50:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821306887",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-04-20T12:59:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-823253559",
      "id" : 823253559,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMzI1MzU1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-20T12:59:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/823253559",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jrawsthorne I think this needs rebase, but that would be cool to land this for downstream projects.",
      "created_at" : "2021-04-26T17:33:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-827020410",
      "id" : 827020410,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNzAyMDQxMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-26T17:33:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/827020410",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Thanks @ariard, rebased",
      "created_at" : "2021-04-26T17:44:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-827026932",
      "id" : 827026932,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNzAyNjkzMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-26T17:44:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/827026932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/777143?v=4",
         "events_url" : "https://api.github.com/users/jrawsthorne/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrawsthorne/followers",
         "following_url" : "https://api.github.com/users/jrawsthorne/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrawsthorne/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrawsthorne",
         "id" : 777143,
         "login" : "jrawsthorne",
         "node_id" : "MDQ6VXNlcjc3NzE0Mw==",
         "organizations_url" : "https://api.github.com/users/jrawsthorne/orgs",
         "received_events_url" : "https://api.github.com/users/jrawsthorne/received_events",
         "repos_url" : "https://api.github.com/users/jrawsthorne/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrawsthorne/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrawsthorne/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrawsthorne"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code Review ACK 096ab5c.\r\n\r\nDiff since last ack is swallowing release-note changes.",
      "created_at" : "2021-04-30T13:59:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-830115608",
      "id" : 830115608,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgzMDExNTYwOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-30T13:59:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/830115608",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@SomberNight I guess you're also interested to for downstream support, if you have time to review again, that would be cool :) ",
      "created_at" : "2021-04-30T14:00:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-830116356",
      "id" : 830116356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgzMDExNjM1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-30T14:00:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/830116356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-06-12T10:59:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-860037224",
      "id" : 860037224,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2MDAzNzIyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-12T10:59:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860037224",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r650464544"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/650464544"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Generally macro statements aren't indented like the code they're included in.",
      "commit_id" : "698391966afd0004d6d31fc590ffb8e4222408b8",
      "created_at" : "2021-06-13T03:48:28Z",
      "diff_hunk" : "@@ -1704,11 +1747,23 @@ static void AssetTest(const UniValue& test)\n         PrecomputedTransactionData txdata;\n         txdata.Init(tx, std::vector<CTxOut>(prevouts));\n         CachingTransactionSignatureChecker txcheck(&tx, idx, prevouts[idx].nValue, true, txdata);\n+\n+        #if defined(HAVE_CONSENSUS_LIB)\n+        CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n+        stream << tx;\n+        CDataStream spent_outputs_stream(SER_NETWORK, PROTOCOL_VERSION);\n+        spent_outputs_stream << prevouts;\n+        #endif\n+\n         for (const auto flags : ALL_CONSENSUS_FLAGS) {\n             // If a test is supposed to fail with test_flags, it should also fail with any superset thereof.\n             if ((flags & test_flags) == test_flags) {\n                 bool ret = VerifyScript(tx.vin[idx].scriptSig, prevouts[idx].scriptPubKey, &tx.vin[idx].scriptWitness, flags, txcheck, nullptr);\n                 BOOST_CHECK(!ret);\n+                #if defined(HAVE_CONSENSUS_LIB)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r650464544",
      "id" : 650464544,
      "line" : 1763,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MDQ2NDU0NA==",
      "original_commit_id" : "d0c6b1a9b6452f53d958513a9acc4f811a690ab4",
      "original_line" : 1763,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/test/script_tests.cpp",
      "position" : 80,
      "pull_request_review_id" : 682368872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-13T03:57:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/650464544",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r650465133"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/650465133"
         }
      },
      "author_association" : "MEMBER",
      "body" : "BIP341-342 (343 isn't a thing).",
      "commit_id" : "698391966afd0004d6d31fc590ffb8e4222408b8",
      "created_at" : "2021-06-13T03:56:01Z",
      "diff_hunk" : "@@ -53,9 +55,11 @@ enum\n     bitcoinconsensus_SCRIPT_FLAGS_VERIFY_CHECKLOCKTIMEVERIFY = (1U << 9), // enable CHECKLOCKTIMEVERIFY (BIP65)\n     bitcoinconsensus_SCRIPT_FLAGS_VERIFY_CHECKSEQUENCEVERIFY = (1U << 10), // enable CHECKSEQUENCEVERIFY (BIP112)\n     bitcoinconsensus_SCRIPT_FLAGS_VERIFY_WITNESS             = (1U << 11), // enable WITNESS (BIP141)\n+    bitcoinconsensus_SCRIPT_FLAGS_VERIFY_TAPROOT             = (1U << 17), // enable TAPROOT (BIP341-343)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r650465133",
      "id" : 650465133,
      "line" : 58,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MDQ2NTEzMw==",
      "original_commit_id" : "d0c6b1a9b6452f53d958513a9acc4f811a690ab4",
      "original_line" : 58,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/script/bitcoinconsensus.h",
      "position" : 22,
      "pull_request_review_id" : 682368872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-13T03:57:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/650465133",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r650526893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/650526893"
         }
      },
      "author_association" : "NONE",
      "body" : "Oops, fixed in d82e5de6a41794cc8fd1e3afaa12af26bb7be926",
      "commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "created_at" : "2021-06-13T13:28:06Z",
      "diff_hunk" : "@@ -53,9 +55,11 @@ enum\n     bitcoinconsensus_SCRIPT_FLAGS_VERIFY_CHECKLOCKTIMEVERIFY = (1U << 9), // enable CHECKLOCKTIMEVERIFY (BIP65)\n     bitcoinconsensus_SCRIPT_FLAGS_VERIFY_CHECKSEQUENCEVERIFY = (1U << 10), // enable CHECKSEQUENCEVERIFY (BIP112)\n     bitcoinconsensus_SCRIPT_FLAGS_VERIFY_WITNESS             = (1U << 11), // enable WITNESS (BIP141)\n+    bitcoinconsensus_SCRIPT_FLAGS_VERIFY_TAPROOT             = (1U << 17), // enable TAPROOT (BIP341-343)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r650526893",
      "id" : 650526893,
      "in_reply_to_id" : 650465133,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MDUyNjg5Mw==",
      "original_commit_id" : "d0c6b1a9b6452f53d958513a9acc4f811a690ab4",
      "original_line" : 58,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/script/bitcoinconsensus.h",
      "position" : null,
      "pull_request_review_id" : 682411104,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-13T13:28:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/650526893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/777143?v=4",
         "events_url" : "https://api.github.com/users/jrawsthorne/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrawsthorne/followers",
         "following_url" : "https://api.github.com/users/jrawsthorne/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrawsthorne/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrawsthorne",
         "id" : 777143,
         "login" : "jrawsthorne",
         "node_id" : "MDQ6VXNlcjc3NzE0Mw==",
         "organizations_url" : "https://api.github.com/users/jrawsthorne/orgs",
         "received_events_url" : "https://api.github.com/users/jrawsthorne/received_events",
         "repos_url" : "https://api.github.com/users/jrawsthorne/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrawsthorne/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrawsthorne/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrawsthorne"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r650526906"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/650526906"
         }
      },
      "author_association" : "NONE",
      "body" : "Thanks, didn't know that. Fixed in d82e5de6a41794cc8fd1e3afaa12af26bb7be926",
      "commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "created_at" : "2021-06-13T13:28:10Z",
      "diff_hunk" : "@@ -1704,11 +1747,23 @@ static void AssetTest(const UniValue& test)\n         PrecomputedTransactionData txdata;\n         txdata.Init(tx, std::vector<CTxOut>(prevouts));\n         CachingTransactionSignatureChecker txcheck(&tx, idx, prevouts[idx].nValue, true, txdata);\n+\n+        #if defined(HAVE_CONSENSUS_LIB)\n+        CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n+        stream << tx;\n+        CDataStream spent_outputs_stream(SER_NETWORK, PROTOCOL_VERSION);\n+        spent_outputs_stream << prevouts;\n+        #endif\n+\n         for (const auto flags : ALL_CONSENSUS_FLAGS) {\n             // If a test is supposed to fail with test_flags, it should also fail with any superset thereof.\n             if ((flags & test_flags) == test_flags) {\n                 bool ret = VerifyScript(tx.vin[idx].scriptSig, prevouts[idx].scriptPubKey, &tx.vin[idx].scriptWitness, flags, txcheck, nullptr);\n                 BOOST_CHECK(!ret);\n+                #if defined(HAVE_CONSENSUS_LIB)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r650526906",
      "id" : 650526906,
      "in_reply_to_id" : 650464544,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1MDUyNjkwNg==",
      "original_commit_id" : "d0c6b1a9b6452f53d958513a9acc4f811a690ab4",
      "original_line" : 1763,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/test/script_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 682411110,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-13T13:28:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/650526906",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/777143?v=4",
         "events_url" : "https://api.github.com/users/jrawsthorne/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrawsthorne/followers",
         "following_url" : "https://api.github.com/users/jrawsthorne/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrawsthorne/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrawsthorne",
         "id" : 777143,
         "login" : "jrawsthorne",
         "node_id" : "MDQ6VXNlcjc3NzE0Mw==",
         "organizations_url" : "https://api.github.com/users/jrawsthorne/orgs",
         "received_events_url" : "https://api.github.com/users/jrawsthorne/received_events",
         "repos_url" : "https://api.github.com/users/jrawsthorne/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrawsthorne/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrawsthorne/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrawsthorne"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Thanks for your review @sipa, I've addressed your comments. Also pinging @ariard ",
      "created_at" : "2021-06-13T13:29:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-860211279",
      "id" : 860211279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2MDIxMTI3OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-13T13:29:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860211279",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/777143?v=4",
         "events_url" : "https://api.github.com/users/jrawsthorne/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrawsthorne/followers",
         "following_url" : "https://api.github.com/users/jrawsthorne/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrawsthorne/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrawsthorne",
         "id" : 777143,
         "login" : "jrawsthorne",
         "node_id" : "MDQ6VXNlcjc3NzE0Mw==",
         "organizations_url" : "https://api.github.com/users/jrawsthorne/orgs",
         "received_events_url" : "https://api.github.com/users/jrawsthorne/received_events",
         "repos_url" : "https://api.github.com/users/jrawsthorne/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrawsthorne/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrawsthorne/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrawsthorne"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r656702135"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/656702135"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Might be nicer to let the caller pass in an array rather than have to serialise the vector?",
      "commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "created_at" : "2021-06-23T01:56:04Z",
      "diff_hunk" : "@@ -83,6 +84,14 @@ static int verify_script(const unsigned char *scriptPubKey, unsigned int scriptP\n     try {\n         TxInputStream stream(PROTOCOL_VERSION, txTo, txToLen);\n         CTransaction tx(deserialize, stream);\n+        std::vector<CTxOut> spent_outputs;\n+        if (spentOutputs != nullptr) {\n+            TxInputStream spent_outputs_stream(PROTOCOL_VERSION, spentOutputs, spentOutputsLen);\n+            spent_outputs_stream >> spent_outputs;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r656702135",
      "id" : 656702135,
      "line" : 90,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NjcwMjEzNQ==",
      "original_commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "original_line" : 90,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/script/bitcoinconsensus.cpp",
      "position" : 34,
      "pull_request_review_id" : 690144169,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-23T01:56:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/656702135",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r656702414"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/656702414"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This leaves me guessing how to call this function.",
      "commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "created_at" : "2021-06-23T01:56:52Z",
      "diff_hunk" : "@@ -26,6 +27,28 @@ The interface is defined in the C header `bitcoinconsensus.h` located in `src/sc\n - `unsigned int flags` - The script validation flags *(see below)*.\n - `bitcoinconsensus_error* err` - Will have the error/success code for the operation *(see below)*.\n \n+###### bitcoinconsensus_verify_script_with_amount\n+- `const unsigned char *scriptPubKey` - The previous output script that encumbers spending.\n+- `unsigned int scriptPubKeyLen` - The number of bytes for the `scriptPubKey`.\n+- `int64_t amount` - The amount spent in the input\n+- `const unsigned char *txTo` - The transaction with the input that is spending the previous output.\n+- `unsigned int txToLen` - The number of bytes for the `txTo`.\n+- `unsigned int nIn` - The index of the input in `txTo` that spends the `scriptPubKey`.\n+- `unsigned int flags` - The script validation flags *(see below)*.\n+- `bitcoinconsensus_error* err` - Will have the error/success code for the operation *(see below)*.\n+\n+###### bitcoinconsensus_verify_script_with_spent_outputs\n+- `const unsigned char *scriptPubKey` - The previous output script that encumbers spending.\n+- `unsigned int scriptPubKeyLen` - The number of bytes for the `scriptPubKey`.\n+- `int64_t amount` - The amount spent in the input\n+- `const unsigned char *txTo` - The transaction with the input that is spending the previous output.\n+- `unsigned int txToLen` - The number of bytes for the `txTo`.\n+- `const unsigned char *spentOutputs` - Previous outputs spent in the transaction",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r656702414",
      "id" : 656702414,
      "line" : 46,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NjcwMjQxNA==",
      "original_commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "original_line" : 46,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "doc/shared-libraries.md",
      "position" : 37,
      "pull_request_review_id" : 690144169,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-23T01:56:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/656702414",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r663488098"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/663488098"
         }
      },
      "author_association" : "NONE",
      "body" : "Correct me if I'm wrong but I thought it would have to be a vector and that can't be exposed as part of the C API",
      "commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "created_at" : "2021-07-04T11:17:43Z",
      "diff_hunk" : "@@ -83,6 +84,14 @@ static int verify_script(const unsigned char *scriptPubKey, unsigned int scriptP\n     try {\n         TxInputStream stream(PROTOCOL_VERSION, txTo, txToLen);\n         CTransaction tx(deserialize, stream);\n+        std::vector<CTxOut> spent_outputs;\n+        if (spentOutputs != nullptr) {\n+            TxInputStream spent_outputs_stream(PROTOCOL_VERSION, spentOutputs, spentOutputsLen);\n+            spent_outputs_stream >> spent_outputs;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r663488098",
      "id" : 663488098,
      "in_reply_to_id" : 656702135,
      "line" : 90,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MzQ4ODA5OA==",
      "original_commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "original_line" : 90,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/script/bitcoinconsensus.cpp",
      "position" : 34,
      "pull_request_review_id" : 698663800,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-04T11:17:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/663488098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/777143?v=4",
         "events_url" : "https://api.github.com/users/jrawsthorne/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrawsthorne/followers",
         "following_url" : "https://api.github.com/users/jrawsthorne/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrawsthorne/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrawsthorne",
         "id" : 777143,
         "login" : "jrawsthorne",
         "node_id" : "MDQ6VXNlcjc3NzE0Mw==",
         "organizations_url" : "https://api.github.com/users/jrawsthorne/orgs",
         "received_events_url" : "https://api.github.com/users/jrawsthorne/received_events",
         "repos_url" : "https://api.github.com/users/jrawsthorne/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrawsthorne/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrawsthorne/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrawsthorne"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r663488100"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/663488100"
         }
      },
      "author_association" : "NONE",
      "body" : "Do you want to add something like \"serialized as a vector of TxOut\" or something more substantial?",
      "commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "created_at" : "2021-07-04T11:17:45Z",
      "diff_hunk" : "@@ -26,6 +27,28 @@ The interface is defined in the C header `bitcoinconsensus.h` located in `src/sc\n - `unsigned int flags` - The script validation flags *(see below)*.\n - `bitcoinconsensus_error* err` - Will have the error/success code for the operation *(see below)*.\n \n+###### bitcoinconsensus_verify_script_with_amount\n+- `const unsigned char *scriptPubKey` - The previous output script that encumbers spending.\n+- `unsigned int scriptPubKeyLen` - The number of bytes for the `scriptPubKey`.\n+- `int64_t amount` - The amount spent in the input\n+- `const unsigned char *txTo` - The transaction with the input that is spending the previous output.\n+- `unsigned int txToLen` - The number of bytes for the `txTo`.\n+- `unsigned int nIn` - The index of the input in `txTo` that spends the `scriptPubKey`.\n+- `unsigned int flags` - The script validation flags *(see below)*.\n+- `bitcoinconsensus_error* err` - Will have the error/success code for the operation *(see below)*.\n+\n+###### bitcoinconsensus_verify_script_with_spent_outputs\n+- `const unsigned char *scriptPubKey` - The previous output script that encumbers spending.\n+- `unsigned int scriptPubKeyLen` - The number of bytes for the `scriptPubKey`.\n+- `int64_t amount` - The amount spent in the input\n+- `const unsigned char *txTo` - The transaction with the input that is spending the previous output.\n+- `unsigned int txToLen` - The number of bytes for the `txTo`.\n+- `const unsigned char *spentOutputs` - Previous outputs spent in the transaction",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r663488100",
      "id" : 663488100,
      "in_reply_to_id" : 656702414,
      "line" : 46,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MzQ4ODEwMA==",
      "original_commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "original_line" : 46,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "doc/shared-libraries.md",
      "position" : 37,
      "pull_request_review_id" : 698663803,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-04T11:17:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/663488100",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/777143?v=4",
         "events_url" : "https://api.github.com/users/jrawsthorne/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jrawsthorne/followers",
         "following_url" : "https://api.github.com/users/jrawsthorne/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jrawsthorne/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jrawsthorne",
         "id" : 777143,
         "login" : "jrawsthorne",
         "node_id" : "MDQ6VXNlcjc3NzE0Mw==",
         "organizations_url" : "https://api.github.com/users/jrawsthorne/orgs",
         "received_events_url" : "https://api.github.com/users/jrawsthorne/received_events",
         "repos_url" : "https://api.github.com/users/jrawsthorne/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jrawsthorne/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jrawsthorne/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jrawsthorne"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-07-21T10:00:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-884060971",
      "id" : 884060971,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "IC_kwDOABII5840sbMr",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-21T10:00:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/884060971",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r693136247"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/693136247"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It could take in a pointer to an array of {pointer to utxo, length} structs or so, as well as the number of inputs. That's not particularly convenient to use, but neither is the current interface (as it probably requires serialization code on the caller side).",
      "commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "created_at" : "2021-08-20T18:18:37Z",
      "diff_hunk" : "@@ -83,6 +84,14 @@ static int verify_script(const unsigned char *scriptPubKey, unsigned int scriptP\n     try {\n         TxInputStream stream(PROTOCOL_VERSION, txTo, txToLen);\n         CTransaction tx(deserialize, stream);\n+        std::vector<CTxOut> spent_outputs;\n+        if (spentOutputs != nullptr) {\n+            TxInputStream spent_outputs_stream(PROTOCOL_VERSION, spentOutputs, spentOutputsLen);\n+            spent_outputs_stream >> spent_outputs;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#discussion_r693136247",
      "id" : 693136247,
      "in_reply_to_id" : 656702135,
      "line" : 90,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MzEzNjI0Nw==",
      "original_commit_id" : "c23996ad35511bd8936e7bb38286c377eda67583",
      "original_line" : 90,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "src/script/bitcoinconsensus.cpp",
      "position" : 34,
      "pull_request_review_id" : 735280369,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21158",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-20T18:18:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/693136247",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--13523179cfe9479db18ec6c5d236f789-->There hasn't been much activity lately and the patch still needs rebase. What is the status here?\n\n* Is it still relevant? â¡ï¸ Please solve the conflicts to make it ready for review and to ensure the CI passes.\n* Is it no longer relevant? â¡ï¸ Please close.\n* Did the author lose interest or time to work on this? â¡ï¸ Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\n",
      "created_at" : "2021-12-22T12:28:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21158#issuecomment-999541319",
      "id" : 999541319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21158",
      "node_id" : "IC_kwDOABII5847k8pH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/999541319/reactions"
      },
      "updated_at" : "2021-12-22T12:28:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/999541319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
