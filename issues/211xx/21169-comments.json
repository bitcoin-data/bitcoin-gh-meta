[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r575675324"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/575675324"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\r\n```",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-02-13T14:52:14Z",
      "diff_hunk" : "@@ -0,0 +1,381 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/ref.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string rpc_method, const std::vector<std::string>& arguments)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r575675324",
      "id" : 575675324,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTY3NTMyNA==",
      "original_commit_id" : "e4e3b56d30587c18e6e8dec0ef88bec2207e8735",
      "original_line" : 47,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 589972631,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/575675324",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r576402952"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/576402952"
         }
      },
      "author_association" : "MEMBER",
      "body" : "First code review LGTM otherwise.",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-02-15T20:10:17Z",
      "diff_hunk" : "@@ -0,0 +1,381 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/ref.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string rpc_method, const std::vector<std::string>& arguments)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r576402952",
      "id" : 576402952,
      "in_reply_to_id" : 575675324,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjQwMjk1Mg==",
      "original_commit_id" : "e4e3b56d30587c18e6e8dec0ef88bec2207e8735",
      "original_line" : 47,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 590731477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/576402952",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r580039685"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580039685"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should use MakeNoLogFileContext?",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-02-22T07:47:42Z",
      "diff_hunk" : "@@ -0,0 +1,381 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/ref.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        util::Ref context{m_node};\n+        JSONRPCRequest request{context};\n+        request.fHelp = false;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        request.strMethod = rpc_method;\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",         // avoid DNS lookups\n+    \"addnode\",               // avoid DNS lookups\n+    \"addpeeraddress\",        // avoid DNS lookups\n+    \"analyzepsbt\",           // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"decoderawtransaction\",  // avoid signed integer overflow in ValueFromAmount(long const&) (https://github.com/bitcoin/bitcoin/pull/20406)\n+    \"dumptxoutset\",          // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\",            // avoid writing to disk\n+#endif\n+    \"generatetoaddress\",     // avoid timeout\n+    \"gettxoutproof\",         // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\",          // avoid reading from disk\n+#endif\n+    \"invalidateblock\",       // avoid nullptr dereference in CBlockIndexWorkComparator::operator() (https://github.com/bitcoin/bitcoin/issues/20914)\n+#ifdef ENABLE_WALLET\n+    \"loadwallet\",            // avoid reading from disk\n+#endif\n+    \"mockscheduler\",         // avoid assertion failure (Assertion `delta_seconds.count() > 0 && delta_seconds < std::chrono::hours{1}' failed.)\n+    \"prioritisetransaction\", // avoid signed integer overflow in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) (https://github.com/bitcoin/bitcoin/issues/20626)\n+    \"setban\",                // avoid DNS lookups\n+    \"stop\",                  // avoid shutdown state\n+};\n+\n+// RPC commands which are safe for fuzzing.\n+const std::vector<std::string> RPC_COMMANDS_SAFE_FOR_FUZZING{\n+    \"clearbanned\",\n+    \"combinepsbt\",\n+    \"combinerawtransaction\",\n+    \"converttopsbt\",\n+    \"createmultisig\",\n+    \"createpsbt\",\n+    \"createrawtransaction\",\n+    \"decodepsbt\",\n+    \"decodescript\",\n+    \"deriveaddresses\",\n+    \"disconnectnode\",\n+    \"echo\",\n+    \"echojson\",\n+    \"estimaterawfee\",\n+    \"estimatesmartfee\",\n+    \"finalizepsbt\",\n+    \"generate\",\n+    \"generateblock\",\n+    \"generatetodescriptor\",\n+    \"getaddednodeinfo\",\n+    \"getbestblockhash\",\n+    \"getblock\",\n+    \"getblockchaininfo\",\n+    \"getblockcount\",\n+    \"getblockfilter\",\n+    \"getblockhash\",\n+    \"getblockheader\",\n+    \"getblockstats\",\n+    \"getblocktemplate\",\n+    \"getchaintips\",\n+    \"getchaintxstats\",\n+    \"getconnectioncount\",\n+    \"getdescriptorinfo\",\n+    \"getdifficulty\",\n+    \"getindexinfo\",\n+    \"getmemoryinfo\",\n+    \"getmempoolancestors\",\n+    \"getmempooldescendants\",\n+    \"getmempoolentry\",\n+    \"getmempoolinfo\",\n+    \"getmininginfo\",\n+    \"getnettotals\",\n+    \"getnetworkhashps\",\n+    \"getnetworkinfo\",\n+    \"getnodeaddresses\",\n+    \"getpeerinfo\",\n+    \"getrawmempool\",\n+    \"getrawtransaction\",\n+    \"getrpcinfo\",\n+    \"gettxout\",\n+    \"gettxoutsetinfo\",\n+    \"help\",\n+    \"joinpsbts\",\n+    \"listbanned\",\n+    \"logging\",\n+    \"ping\",\n+    \"preciousblock\",\n+    \"pruneblockchain\",\n+    \"reconsiderblock\",\n+    \"savemempool\",\n+    \"scantxoutset\",\n+    \"sendrawtransaction\",\n+    \"setmocktime\",\n+    \"setnetworkactive\",\n+    \"signmessagewithprivkey\",\n+    \"signrawtransactionwithkey\",\n+    \"submitblock\",\n+    \"submitheader\",\n+    \"syncwithvalidationinterfacequeue\",\n+    \"testmempoolaccept\",\n+    \"uptime\",\n+    \"utxoupdatepsbt\",\n+    \"validateaddress\",\n+    \"verifychain\",\n+    \"verifymessage\",\n+    \"verifytxoutproof\",\n+    \"waitforblock\",\n+    \"waitforblockheight\",\n+    \"waitfornewblock\",\n+};\n+\n+std::string ConsumeScalarRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    const size_t max_string_length = 4096;\n+    std::string r;\n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            // string argument\n+            r = fuzzed_data_provider.ConsumeRandomLengthString(max_string_length);\n+        },\n+        [&] {\n+            // base64 argument\n+            r = EncodeBase64(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // hex argument\n+            r = HexStr(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // bool argument\n+            r = fuzzed_data_provider.ConsumeBool() ? \"true\" : \"false\";\n+        },\n+        [&] {\n+            // range argument\n+            r = \"[\" + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + \",\" + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + \"]\";\n+        },\n+        [&] {\n+            // integral argument (int64_t)\n+            r = ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>());\n+        },\n+        [&] {\n+            // integral argument (uint64_t)\n+            r = ToString(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        },\n+        [&] {\n+            // floating point argument\n+            r = strprintf(\"%f\", fuzzed_data_provider.ConsumeFloatingPoint<double>());\n+        },\n+        [&] {\n+            // tx destination argument\n+            r = EncodeDestination(ConsumeTxDestination(fuzzed_data_provider));\n+        },\n+        [&] {\n+            // uint160 argument\n+            r = ConsumeUInt160(fuzzed_data_provider).ToString();\n+        },\n+        [&] {\n+            // uint256 argument\n+            r = ConsumeUInt256(fuzzed_data_provider).ToString();\n+        },\n+        [&] {\n+            // base32 argument\n+            r = EncodeBase32(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // base58 argument\n+            r = EncodeBase58(MakeUCharSpan(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length)));\n+        },\n+        [&] {\n+            // base58 argument with checksum\n+            r = EncodeBase58Check(MakeUCharSpan(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length)));\n+        },\n+        [&] {\n+            // hex encoded block\n+            std::optional<CBlock> opt_block = ConsumeDeserializable<CBlock>(fuzzed_data_provider);\n+            if (!opt_block) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_block;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // hex encoded block header\n+            std::optional<CBlockHeader> opt_block_header = ConsumeDeserializable<CBlockHeader>(fuzzed_data_provider);\n+            if (!opt_block_header) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_block_header;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // hex encoded tx\n+            std::optional<CMutableTransaction> opt_tx = ConsumeDeserializable<CMutableTransaction>(fuzzed_data_provider);\n+            if (!opt_tx) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, fuzzed_data_provider.ConsumeBool() ? PROTOCOL_VERSION : (PROTOCOL_VERSION | SERIALIZE_TRANSACTION_NO_WITNESS)};\n+            data_stream << *opt_tx;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // base64 encoded psbt\n+            std::optional<PartiallySignedTransaction> opt_psbt = ConsumeDeserializable<PartiallySignedTransaction>(fuzzed_data_provider);\n+            if (!opt_psbt) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_psbt;\n+            r = EncodeBase64({data_stream.begin(), data_stream.end()});\n+        },\n+        [&] {\n+            // base58 encoded key\n+            const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+            CKey key;\n+            key.Set(random_bytes.begin(), random_bytes.end(), fuzzed_data_provider.ConsumeBool());\n+            if (!key.IsValid()) {\n+                return;\n+            }\n+            r = EncodeSecret(key);\n+        },\n+        [&] {\n+            // hex encoded pubkey\n+            const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+            CKey key;\n+            key.Set(random_bytes.begin(), random_bytes.end(), fuzzed_data_provider.ConsumeBool());\n+            if (!key.IsValid()) {\n+                return;\n+            }\n+            r = HexStr(key.GetPubKey());\n+        });\n+    return r;\n+}\n+\n+std::string ConsumeArrayRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    std::vector<std::string> scalar_arguments;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        scalar_arguments.push_back(ConsumeScalarRPCArgument(fuzzed_data_provider));\n+    }\n+    return \"[\\\"\" + Join(scalar_arguments, \"\\\",\\\"\") + \"\\\"]\";\n+}\n+\n+std::string ConsumeRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    return fuzzed_data_provider.ConsumeBool() ? ConsumeScalarRPCArgument(fuzzed_data_provider) : ConsumeArrayRPCArgument(fuzzed_data_provider);\n+}\n+\n+RPCFuzzTestingSetup* InitializeRPCFuzzTestingSetup()\n+{\n+    static std::unique_ptr<RPCFuzzTestingSetup> setup = std::make_unique<RPCFuzzTestingSetup>(CBaseChainParams::REGTEST, std::vector<const char*>{\"-nodebuglogfile\"});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r580039685",
      "id" : 580039685,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDAzOTY4NQ==",
      "original_commit_id" : "e4e3b56d30587c18e6e8dec0ef88bec2207e8735",
      "original_line" : 318,
      "original_position" : 318,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 595076304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580039685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I am not sure if this is worth it. This needs a lot of maintenance (adding or removing rpcs, marking them unsafe, ...) and I am sceptical that this will find any actual issues.",
      "created_at" : "2021-02-22T07:49:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#issuecomment-783166677",
      "id" : 783166677,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21169",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4MzE2NjY3Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-09T16:57:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783166677",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke to clarify, are you a NACK on this?",
      "created_at" : "2021-04-27T16:35:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#issuecomment-827747428",
      "id" : 827747428,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21169",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNzc0NzQyOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-27T16:35:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/827747428",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/755825?v=4",
         "events_url" : "https://api.github.com/users/adamjonas/events{/privacy}",
         "followers_url" : "https://api.github.com/users/adamjonas/followers",
         "following_url" : "https://api.github.com/users/adamjonas/following{/other_user}",
         "gists_url" : "https://api.github.com/users/adamjonas/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/adamjonas",
         "id" : 755825,
         "login" : "adamjonas",
         "node_id" : "MDQ6VXNlcjc1NTgyNQ==",
         "organizations_url" : "https://api.github.com/users/adamjonas/orgs",
         "received_events_url" : "https://api.github.com/users/adamjonas/received_events",
         "repos_url" : "https://api.github.com/users/adamjonas/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/adamjonas/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/adamjonas/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/adamjonas"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@adamjonas\r\n\r\nGood question and thanks for asking it explicitly! :)\r\n\r\nI should probably have stated that more clearly in the PR description, but it should be noted that this fuzzing harness is by far is the \"most covering\" harness in the repo.\r\n\r\nIncluding this harness in the existing set of fuzzing harnesses adds coverage to five(!) percent of the code base that is currently uncovered by fuzz testing. The total fuzzing coverage increases from 65% to 70%.\r\n\r\nThe opportunities to achieve such extreme coverage jumps from adding a single harness are _extremely_ rare at the relatively high levels of fuzzing coverage we've reached. TBH it would feel a bit disappointing if we had to pass on the excellent coverage opportunity that RPC fuzzing brings :)\r\n\r\n@MarcoFalke, if we can find a way to reduce/mitigate the potential maintenance work you predict in https://github.com/bitcoin/bitcoin/pull/21169#issuecomment-783166677 would you be willing to reconsider your position? :)",
      "created_at" : "2021-04-27T19:42:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#issuecomment-827874086",
      "id" : 827874086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21169",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyNzg3NDA4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-27T20:09:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/827874086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621602312"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621602312"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good point! Done!",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-27T21:09:02Z",
      "diff_hunk" : "@@ -0,0 +1,381 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/ref.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        util::Ref context{m_node};\n+        JSONRPCRequest request{context};\n+        request.fHelp = false;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        request.strMethod = rpc_method;\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",         // avoid DNS lookups\n+    \"addnode\",               // avoid DNS lookups\n+    \"addpeeraddress\",        // avoid DNS lookups\n+    \"analyzepsbt\",           // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"decoderawtransaction\",  // avoid signed integer overflow in ValueFromAmount(long const&) (https://github.com/bitcoin/bitcoin/pull/20406)\n+    \"dumptxoutset\",          // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\",            // avoid writing to disk\n+#endif\n+    \"generatetoaddress\",     // avoid timeout\n+    \"gettxoutproof\",         // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\",          // avoid reading from disk\n+#endif\n+    \"invalidateblock\",       // avoid nullptr dereference in CBlockIndexWorkComparator::operator() (https://github.com/bitcoin/bitcoin/issues/20914)\n+#ifdef ENABLE_WALLET\n+    \"loadwallet\",            // avoid reading from disk\n+#endif\n+    \"mockscheduler\",         // avoid assertion failure (Assertion `delta_seconds.count() > 0 && delta_seconds < std::chrono::hours{1}' failed.)\n+    \"prioritisetransaction\", // avoid signed integer overflow in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) (https://github.com/bitcoin/bitcoin/issues/20626)\n+    \"setban\",                // avoid DNS lookups\n+    \"stop\",                  // avoid shutdown state\n+};\n+\n+// RPC commands which are safe for fuzzing.\n+const std::vector<std::string> RPC_COMMANDS_SAFE_FOR_FUZZING{\n+    \"clearbanned\",\n+    \"combinepsbt\",\n+    \"combinerawtransaction\",\n+    \"converttopsbt\",\n+    \"createmultisig\",\n+    \"createpsbt\",\n+    \"createrawtransaction\",\n+    \"decodepsbt\",\n+    \"decodescript\",\n+    \"deriveaddresses\",\n+    \"disconnectnode\",\n+    \"echo\",\n+    \"echojson\",\n+    \"estimaterawfee\",\n+    \"estimatesmartfee\",\n+    \"finalizepsbt\",\n+    \"generate\",\n+    \"generateblock\",\n+    \"generatetodescriptor\",\n+    \"getaddednodeinfo\",\n+    \"getbestblockhash\",\n+    \"getblock\",\n+    \"getblockchaininfo\",\n+    \"getblockcount\",\n+    \"getblockfilter\",\n+    \"getblockhash\",\n+    \"getblockheader\",\n+    \"getblockstats\",\n+    \"getblocktemplate\",\n+    \"getchaintips\",\n+    \"getchaintxstats\",\n+    \"getconnectioncount\",\n+    \"getdescriptorinfo\",\n+    \"getdifficulty\",\n+    \"getindexinfo\",\n+    \"getmemoryinfo\",\n+    \"getmempoolancestors\",\n+    \"getmempooldescendants\",\n+    \"getmempoolentry\",\n+    \"getmempoolinfo\",\n+    \"getmininginfo\",\n+    \"getnettotals\",\n+    \"getnetworkhashps\",\n+    \"getnetworkinfo\",\n+    \"getnodeaddresses\",\n+    \"getpeerinfo\",\n+    \"getrawmempool\",\n+    \"getrawtransaction\",\n+    \"getrpcinfo\",\n+    \"gettxout\",\n+    \"gettxoutsetinfo\",\n+    \"help\",\n+    \"joinpsbts\",\n+    \"listbanned\",\n+    \"logging\",\n+    \"ping\",\n+    \"preciousblock\",\n+    \"pruneblockchain\",\n+    \"reconsiderblock\",\n+    \"savemempool\",\n+    \"scantxoutset\",\n+    \"sendrawtransaction\",\n+    \"setmocktime\",\n+    \"setnetworkactive\",\n+    \"signmessagewithprivkey\",\n+    \"signrawtransactionwithkey\",\n+    \"submitblock\",\n+    \"submitheader\",\n+    \"syncwithvalidationinterfacequeue\",\n+    \"testmempoolaccept\",\n+    \"uptime\",\n+    \"utxoupdatepsbt\",\n+    \"validateaddress\",\n+    \"verifychain\",\n+    \"verifymessage\",\n+    \"verifytxoutproof\",\n+    \"waitforblock\",\n+    \"waitforblockheight\",\n+    \"waitfornewblock\",\n+};\n+\n+std::string ConsumeScalarRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    const size_t max_string_length = 4096;\n+    std::string r;\n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            // string argument\n+            r = fuzzed_data_provider.ConsumeRandomLengthString(max_string_length);\n+        },\n+        [&] {\n+            // base64 argument\n+            r = EncodeBase64(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // hex argument\n+            r = HexStr(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // bool argument\n+            r = fuzzed_data_provider.ConsumeBool() ? \"true\" : \"false\";\n+        },\n+        [&] {\n+            // range argument\n+            r = \"[\" + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + \",\" + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + \"]\";\n+        },\n+        [&] {\n+            // integral argument (int64_t)\n+            r = ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>());\n+        },\n+        [&] {\n+            // integral argument (uint64_t)\n+            r = ToString(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        },\n+        [&] {\n+            // floating point argument\n+            r = strprintf(\"%f\", fuzzed_data_provider.ConsumeFloatingPoint<double>());\n+        },\n+        [&] {\n+            // tx destination argument\n+            r = EncodeDestination(ConsumeTxDestination(fuzzed_data_provider));\n+        },\n+        [&] {\n+            // uint160 argument\n+            r = ConsumeUInt160(fuzzed_data_provider).ToString();\n+        },\n+        [&] {\n+            // uint256 argument\n+            r = ConsumeUInt256(fuzzed_data_provider).ToString();\n+        },\n+        [&] {\n+            // base32 argument\n+            r = EncodeBase32(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // base58 argument\n+            r = EncodeBase58(MakeUCharSpan(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length)));\n+        },\n+        [&] {\n+            // base58 argument with checksum\n+            r = EncodeBase58Check(MakeUCharSpan(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length)));\n+        },\n+        [&] {\n+            // hex encoded block\n+            std::optional<CBlock> opt_block = ConsumeDeserializable<CBlock>(fuzzed_data_provider);\n+            if (!opt_block) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_block;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // hex encoded block header\n+            std::optional<CBlockHeader> opt_block_header = ConsumeDeserializable<CBlockHeader>(fuzzed_data_provider);\n+            if (!opt_block_header) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_block_header;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // hex encoded tx\n+            std::optional<CMutableTransaction> opt_tx = ConsumeDeserializable<CMutableTransaction>(fuzzed_data_provider);\n+            if (!opt_tx) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, fuzzed_data_provider.ConsumeBool() ? PROTOCOL_VERSION : (PROTOCOL_VERSION | SERIALIZE_TRANSACTION_NO_WITNESS)};\n+            data_stream << *opt_tx;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // base64 encoded psbt\n+            std::optional<PartiallySignedTransaction> opt_psbt = ConsumeDeserializable<PartiallySignedTransaction>(fuzzed_data_provider);\n+            if (!opt_psbt) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_psbt;\n+            r = EncodeBase64({data_stream.begin(), data_stream.end()});\n+        },\n+        [&] {\n+            // base58 encoded key\n+            const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+            CKey key;\n+            key.Set(random_bytes.begin(), random_bytes.end(), fuzzed_data_provider.ConsumeBool());\n+            if (!key.IsValid()) {\n+                return;\n+            }\n+            r = EncodeSecret(key);\n+        },\n+        [&] {\n+            // hex encoded pubkey\n+            const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+            CKey key;\n+            key.Set(random_bytes.begin(), random_bytes.end(), fuzzed_data_provider.ConsumeBool());\n+            if (!key.IsValid()) {\n+                return;\n+            }\n+            r = HexStr(key.GetPubKey());\n+        });\n+    return r;\n+}\n+\n+std::string ConsumeArrayRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    std::vector<std::string> scalar_arguments;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        scalar_arguments.push_back(ConsumeScalarRPCArgument(fuzzed_data_provider));\n+    }\n+    return \"[\\\"\" + Join(scalar_arguments, \"\\\",\\\"\") + \"\\\"]\";\n+}\n+\n+std::string ConsumeRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    return fuzzed_data_provider.ConsumeBool() ? ConsumeScalarRPCArgument(fuzzed_data_provider) : ConsumeArrayRPCArgument(fuzzed_data_provider);\n+}\n+\n+RPCFuzzTestingSetup* InitializeRPCFuzzTestingSetup()\n+{\n+    static std::unique_ptr<RPCFuzzTestingSetup> setup = std::make_unique<RPCFuzzTestingSetup>(CBaseChainParams::REGTEST, std::vector<const char*>{\"-nodebuglogfile\"});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621602312",
      "id" : 621602312,
      "in_reply_to_id" : 580039685,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTYwMjMxMg==",
      "original_commit_id" : "e4e3b56d30587c18e6e8dec0ef88bec2207e8735",
      "original_line" : 318,
      "original_position" : 318,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646361286,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621602312",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621607064"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621607064"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed!",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-27T21:17:03Z",
      "diff_hunk" : "@@ -0,0 +1,381 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/ref.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string rpc_method, const std::vector<std::string>& arguments)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621607064",
      "id" : 621607064,
      "in_reply_to_id" : 575675324,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTYwNzA2NA==",
      "original_commit_id" : "e4e3b56d30587c18e6e8dec0ef88bec2207e8735",
      "original_line" : 47,
      "original_position" : 47,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646367092,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621607064",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621833653"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621833653"
         }
      },
      "author_association" : "MEMBER",
      "body" : "fixed?",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T05:49:47Z",
      "diff_hunk" : "@@ -0,0 +1,380 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",        // avoid DNS lookups\n+    \"addnode\",              // avoid DNS lookups\n+    \"addpeeraddress\",       // avoid DNS lookups\n+    \"analyzepsbt\",          // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"decoderawtransaction\", // avoid signed integer overflow in ValueFromAmount(long const&) (https://github.com/bitcoin/bitcoin/pull/20406)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621833653",
      "id" : 621833653,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTgzMzY1Mw==",
      "original_commit_id" : "555556e2fe864c0644de4e3e75d1833d43b6eb19",
      "original_line" : 72,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646616471,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621833653",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621836878"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621836878"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    const char* limit_to_rpc_command_env = std::getenv(\"LIMIT_TO_RPC_COMMAND\");\r\n```",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T05:57:25Z",
      "diff_hunk" : "@@ -0,0 +1,380 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",        // avoid DNS lookups\n+    \"addnode\",              // avoid DNS lookups\n+    \"addpeeraddress\",       // avoid DNS lookups\n+    \"analyzepsbt\",          // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"decoderawtransaction\", // avoid signed integer overflow in ValueFromAmount(long const&) (https://github.com/bitcoin/bitcoin/pull/20406)\n+    \"dumptxoutset\",         // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout\n+    \"gettxoutproof\",     // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\", // avoid reading from disk\n+#endif\n+    \"invalidateblock\", // avoid nullptr dereference in CBlockIndexWorkComparator::operator() (https://github.com/bitcoin/bitcoin/issues/20914)\n+#ifdef ENABLE_WALLET\n+    \"loadwallet\", // avoid reading from disk\n+#endif\n+    \"mockscheduler\",         // avoid assertion failure (Assertion `delta_seconds.count() > 0 && delta_seconds < std::chrono::hours{1}' failed.)\n+    \"prioritisetransaction\", // avoid signed integer overflow in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) (https://github.com/bitcoin/bitcoin/issues/20626)\n+    \"setban\",                // avoid DNS lookups\n+    \"stop\",                  // avoid shutdown state\n+};\n+\n+// RPC commands which are safe for fuzzing.\n+const std::vector<std::string> RPC_COMMANDS_SAFE_FOR_FUZZING{\n+    \"clearbanned\",\n+    \"combinepsbt\",\n+    \"combinerawtransaction\",\n+    \"converttopsbt\",\n+    \"createmultisig\",\n+    \"createpsbt\",\n+    \"createrawtransaction\",\n+    \"decodepsbt\",\n+    \"decodescript\",\n+    \"deriveaddresses\",\n+    \"disconnectnode\",\n+    \"echo\",\n+    \"echojson\",\n+    \"estimaterawfee\",\n+    \"estimatesmartfee\",\n+    \"finalizepsbt\",\n+    \"generate\",\n+    \"generateblock\",\n+    \"generatetodescriptor\",\n+    \"getaddednodeinfo\",\n+    \"getbestblockhash\",\n+    \"getblock\",\n+    \"getblockchaininfo\",\n+    \"getblockcount\",\n+    \"getblockfilter\",\n+    \"getblockhash\",\n+    \"getblockheader\",\n+    \"getblockstats\",\n+    \"getblocktemplate\",\n+    \"getchaintips\",\n+    \"getchaintxstats\",\n+    \"getconnectioncount\",\n+    \"getdescriptorinfo\",\n+    \"getdifficulty\",\n+    \"getindexinfo\",\n+    \"getmemoryinfo\",\n+    \"getmempoolancestors\",\n+    \"getmempooldescendants\",\n+    \"getmempoolentry\",\n+    \"getmempoolinfo\",\n+    \"getmininginfo\",\n+    \"getnettotals\",\n+    \"getnetworkhashps\",\n+    \"getnetworkinfo\",\n+    \"getnodeaddresses\",\n+    \"getpeerinfo\",\n+    \"getrawmempool\",\n+    \"getrawtransaction\",\n+    \"getrpcinfo\",\n+    \"gettxout\",\n+    \"gettxoutsetinfo\",\n+    \"help\",\n+    \"joinpsbts\",\n+    \"listbanned\",\n+    \"logging\",\n+    \"ping\",\n+    \"preciousblock\",\n+    \"pruneblockchain\",\n+    \"reconsiderblock\",\n+    \"savemempool\",\n+    \"scantxoutset\",\n+    \"sendrawtransaction\",\n+    \"setmocktime\",\n+    \"setnetworkactive\",\n+    \"signmessagewithprivkey\",\n+    \"signrawtransactionwithkey\",\n+    \"submitblock\",\n+    \"submitheader\",\n+    \"syncwithvalidationinterfacequeue\",\n+    \"testmempoolaccept\",\n+    \"uptime\",\n+    \"utxoupdatepsbt\",\n+    \"validateaddress\",\n+    \"verifychain\",\n+    \"verifymessage\",\n+    \"verifytxoutproof\",\n+    \"waitforblock\",\n+    \"waitforblockheight\",\n+    \"waitfornewblock\",\n+};\n+\n+std::string ConsumeScalarRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    const size_t max_string_length = 4096;\n+    std::string r;\n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            // string argument\n+            r = fuzzed_data_provider.ConsumeRandomLengthString(max_string_length);\n+        },\n+        [&] {\n+            // base64 argument\n+            r = EncodeBase64(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // hex argument\n+            r = HexStr(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // bool argument\n+            r = fuzzed_data_provider.ConsumeBool() ? \"true\" : \"false\";\n+        },\n+        [&] {\n+            // range argument\n+            r = \"[\" + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + \",\" + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + \"]\";\n+        },\n+        [&] {\n+            // integral argument (int64_t)\n+            r = ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>());\n+        },\n+        [&] {\n+            // integral argument (uint64_t)\n+            r = ToString(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        },\n+        [&] {\n+            // floating point argument\n+            r = strprintf(\"%f\", fuzzed_data_provider.ConsumeFloatingPoint<double>());\n+        },\n+        [&] {\n+            // tx destination argument\n+            r = EncodeDestination(ConsumeTxDestination(fuzzed_data_provider));\n+        },\n+        [&] {\n+            // uint160 argument\n+            r = ConsumeUInt160(fuzzed_data_provider).ToString();\n+        },\n+        [&] {\n+            // uint256 argument\n+            r = ConsumeUInt256(fuzzed_data_provider).ToString();\n+        },\n+        [&] {\n+            // base32 argument\n+            r = EncodeBase32(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // base58 argument\n+            r = EncodeBase58(MakeUCharSpan(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length)));\n+        },\n+        [&] {\n+            // base58 argument with checksum\n+            r = EncodeBase58Check(MakeUCharSpan(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length)));\n+        },\n+        [&] {\n+            // hex encoded block\n+            std::optional<CBlock> opt_block = ConsumeDeserializable<CBlock>(fuzzed_data_provider);\n+            if (!opt_block) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_block;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // hex encoded block header\n+            std::optional<CBlockHeader> opt_block_header = ConsumeDeserializable<CBlockHeader>(fuzzed_data_provider);\n+            if (!opt_block_header) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_block_header;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // hex encoded tx\n+            std::optional<CMutableTransaction> opt_tx = ConsumeDeserializable<CMutableTransaction>(fuzzed_data_provider);\n+            if (!opt_tx) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, fuzzed_data_provider.ConsumeBool() ? PROTOCOL_VERSION : (PROTOCOL_VERSION | SERIALIZE_TRANSACTION_NO_WITNESS)};\n+            data_stream << *opt_tx;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // base64 encoded psbt\n+            std::optional<PartiallySignedTransaction> opt_psbt = ConsumeDeserializable<PartiallySignedTransaction>(fuzzed_data_provider);\n+            if (!opt_psbt) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_psbt;\n+            r = EncodeBase64({data_stream.begin(), data_stream.end()});\n+        },\n+        [&] {\n+            // base58 encoded key\n+            const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+            CKey key;\n+            key.Set(random_bytes.begin(), random_bytes.end(), fuzzed_data_provider.ConsumeBool());\n+            if (!key.IsValid()) {\n+                return;\n+            }\n+            r = EncodeSecret(key);\n+        },\n+        [&] {\n+            // hex encoded pubkey\n+            const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+            CKey key;\n+            key.Set(random_bytes.begin(), random_bytes.end(), fuzzed_data_provider.ConsumeBool());\n+            if (!key.IsValid()) {\n+                return;\n+            }\n+            r = HexStr(key.GetPubKey());\n+        });\n+    return r;\n+}\n+\n+std::string ConsumeArrayRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    std::vector<std::string> scalar_arguments;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        scalar_arguments.push_back(ConsumeScalarRPCArgument(fuzzed_data_provider));\n+    }\n+    return \"[\\\"\" + Join(scalar_arguments, \"\\\",\\\"\") + \"\\\"]\";\n+}\n+\n+std::string ConsumeRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    return fuzzed_data_provider.ConsumeBool() ? ConsumeScalarRPCArgument(fuzzed_data_provider) : ConsumeArrayRPCArgument(fuzzed_data_provider);\n+}\n+\n+RPCFuzzTestingSetup* InitializeRPCFuzzTestingSetup()\n+{\n+    static const auto setup = MakeNoLogFileContext<RPCFuzzTestingSetup>();\n+    SetRPCWarmupFinished();\n+    return setup.get();\n+}\n+}; // namespace\n+\n+void initialize_rpc()\n+{\n+    rpc_testing_setup = InitializeRPCFuzzTestingSetup();\n+    const std::vector<std::string> supported_rpc_commands = rpc_testing_setup->GetRPCCommands();\n+    for (const std::string& rpc_command : supported_rpc_commands) {\n+        const bool safe_for_fuzzing = std::find(RPC_COMMANDS_SAFE_FOR_FUZZING.begin(), RPC_COMMANDS_SAFE_FOR_FUZZING.end(), rpc_command) != RPC_COMMANDS_SAFE_FOR_FUZZING.end();\n+        const bool not_safe_for_fuzzing = std::find(RPC_COMMANDS_NOT_SAFE_FOR_FUZZING.begin(), RPC_COMMANDS_NOT_SAFE_FOR_FUZZING.end(), rpc_command) != RPC_COMMANDS_NOT_SAFE_FOR_FUZZING.end();\n+        if (!(safe_for_fuzzing || not_safe_for_fuzzing)) {\n+            std::cerr << \"Error: RPC command \\\"\" << rpc_command << \"\\\" not found in RPC_COMMANDS_SAFE_FOR_FUZZING or RPC_COMMANDS_NOT_SAFE_FOR_FUZZING. Please update \" << __FILE__ << \".\\n\";\n+            std::terminate();\n+        }\n+        if (safe_for_fuzzing && not_safe_for_fuzzing) {\n+            std::cerr << \"Error: RPC command \\\"\" << rpc_command << \"\\\" found in *both* RPC_COMMANDS_SAFE_FOR_FUZZING and RPC_COMMANDS_NOT_SAFE_FOR_FUZZING. Please update \" << __FILE__ << \".\\n\";\n+            std::terminate();\n+        }\n+    }\n+    for (const std::string& rpc_command : RPC_COMMANDS_SAFE_FOR_FUZZING) {\n+        const bool supported_rpc_command = std::find(supported_rpc_commands.begin(), supported_rpc_commands.end(), rpc_command) != supported_rpc_commands.end();\n+        if (!supported_rpc_command) {\n+            std::cerr << \"Error: Unknown RPC command \\\"\" << rpc_command << \"\\\" found in RPC_COMMANDS_SAFE_FOR_FUZZING. Please update \" << __FILE__ << \".\\n\";\n+            std::terminate();\n+        }\n+    }\n+    for (const std::string& rpc_command : RPC_COMMANDS_NOT_SAFE_FOR_FUZZING) {\n+        const bool supported_rpc_command = std::find(supported_rpc_commands.begin(), supported_rpc_commands.end(), rpc_command) != supported_rpc_commands.end();\n+        if (!supported_rpc_command) {\n+            std::cerr << \"Error: Unknown RPC command \\\"\" << rpc_command << \"\\\" found in RPC_COMMANDS_NOT_SAFE_FOR_FUZZING. Please update \" << __FILE__ << \".\\n\";\n+            std::terminate();\n+        }\n+    }\n+    const char* limit_to_rpc_command_env = getenv(\"LIMIT_TO_RPC_COMMAND\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621836878",
      "id" : 621836878,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTgzNjg3OA==",
      "original_commit_id" : "555556e2fe864c0644de4e3e75d1833d43b6eb19",
      "original_line" : 353,
      "original_position" : 353,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646616471,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621836878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621837799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621837799"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\nstd::string g_limit_to_rpc_command;\r\n```",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T05:59:31Z",
      "diff_hunk" : "@@ -0,0 +1,380 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621837799",
      "id" : 621837799,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTgzNzc5OQ==",
      "original_commit_id" : "555556e2fe864c0644de4e3e75d1833d43b6eb19",
      "original_line" : 62,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646616471,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621837799",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621839108"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621839108"
         }
      },
      "author_association" : "MEMBER",
      "body" : "fixed",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T06:02:35Z",
      "diff_hunk" : "@@ -0,0 +1,380 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",        // avoid DNS lookups\n+    \"addnode\",              // avoid DNS lookups\n+    \"addpeeraddress\",       // avoid DNS lookups\n+    \"analyzepsbt\",          // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"decoderawtransaction\", // avoid signed integer overflow in ValueFromAmount(long const&) (https://github.com/bitcoin/bitcoin/pull/20406)\n+    \"dumptxoutset\",         // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout\n+    \"gettxoutproof\",     // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\", // avoid reading from disk\n+#endif\n+    \"invalidateblock\", // avoid nullptr dereference in CBlockIndexWorkComparator::operator() (https://github.com/bitcoin/bitcoin/issues/20914)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621839108",
      "id" : 621839108,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTgzOTEwOA==",
      "original_commit_id" : "555556e2fe864c0644de4e3e75d1833d43b6eb19",
      "original_line" : 83,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646622591,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:38:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621839108",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621857715"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621857715"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed! Thanks!",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T06:39:17Z",
      "diff_hunk" : "@@ -0,0 +1,380 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",        // avoid DNS lookups\n+    \"addnode\",              // avoid DNS lookups\n+    \"addpeeraddress\",       // avoid DNS lookups\n+    \"analyzepsbt\",          // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"decoderawtransaction\", // avoid signed integer overflow in ValueFromAmount(long const&) (https://github.com/bitcoin/bitcoin/pull/20406)\n+    \"dumptxoutset\",         // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout\n+    \"gettxoutproof\",     // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\", // avoid reading from disk\n+#endif\n+    \"invalidateblock\", // avoid nullptr dereference in CBlockIndexWorkComparator::operator() (https://github.com/bitcoin/bitcoin/issues/20914)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621857715",
      "id" : 621857715,
      "in_reply_to_id" : 621839108,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTg1NzcxNQ==",
      "original_commit_id" : "555556e2fe864c0644de4e3e75d1833d43b6eb19",
      "original_line" : 83,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646643949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:39:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621857715",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621857792"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621857792"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed! Thanks!",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T06:39:25Z",
      "diff_hunk" : "@@ -0,0 +1,380 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",        // avoid DNS lookups\n+    \"addnode\",              // avoid DNS lookups\n+    \"addpeeraddress\",       // avoid DNS lookups\n+    \"analyzepsbt\",          // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"decoderawtransaction\", // avoid signed integer overflow in ValueFromAmount(long const&) (https://github.com/bitcoin/bitcoin/pull/20406)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621857792",
      "id" : 621857792,
      "in_reply_to_id" : 621833653,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTg1Nzc5Mg==",
      "original_commit_id" : "555556e2fe864c0644de4e3e75d1833d43b6eb19",
      "original_line" : 72,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646644023,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:39:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621857792",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621857947"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621857947"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed. Thanks!",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T06:39:43Z",
      "diff_hunk" : "@@ -0,0 +1,380 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",        // avoid DNS lookups\n+    \"addnode\",              // avoid DNS lookups\n+    \"addpeeraddress\",       // avoid DNS lookups\n+    \"analyzepsbt\",          // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"decoderawtransaction\", // avoid signed integer overflow in ValueFromAmount(long const&) (https://github.com/bitcoin/bitcoin/pull/20406)\n+    \"dumptxoutset\",         // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout\n+    \"gettxoutproof\",     // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\", // avoid reading from disk\n+#endif\n+    \"invalidateblock\", // avoid nullptr dereference in CBlockIndexWorkComparator::operator() (https://github.com/bitcoin/bitcoin/issues/20914)\n+#ifdef ENABLE_WALLET\n+    \"loadwallet\", // avoid reading from disk\n+#endif\n+    \"mockscheduler\",         // avoid assertion failure (Assertion `delta_seconds.count() > 0 && delta_seconds < std::chrono::hours{1}' failed.)\n+    \"prioritisetransaction\", // avoid signed integer overflow in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) (https://github.com/bitcoin/bitcoin/issues/20626)\n+    \"setban\",                // avoid DNS lookups\n+    \"stop\",                  // avoid shutdown state\n+};\n+\n+// RPC commands which are safe for fuzzing.\n+const std::vector<std::string> RPC_COMMANDS_SAFE_FOR_FUZZING{\n+    \"clearbanned\",\n+    \"combinepsbt\",\n+    \"combinerawtransaction\",\n+    \"converttopsbt\",\n+    \"createmultisig\",\n+    \"createpsbt\",\n+    \"createrawtransaction\",\n+    \"decodepsbt\",\n+    \"decodescript\",\n+    \"deriveaddresses\",\n+    \"disconnectnode\",\n+    \"echo\",\n+    \"echojson\",\n+    \"estimaterawfee\",\n+    \"estimatesmartfee\",\n+    \"finalizepsbt\",\n+    \"generate\",\n+    \"generateblock\",\n+    \"generatetodescriptor\",\n+    \"getaddednodeinfo\",\n+    \"getbestblockhash\",\n+    \"getblock\",\n+    \"getblockchaininfo\",\n+    \"getblockcount\",\n+    \"getblockfilter\",\n+    \"getblockhash\",\n+    \"getblockheader\",\n+    \"getblockstats\",\n+    \"getblocktemplate\",\n+    \"getchaintips\",\n+    \"getchaintxstats\",\n+    \"getconnectioncount\",\n+    \"getdescriptorinfo\",\n+    \"getdifficulty\",\n+    \"getindexinfo\",\n+    \"getmemoryinfo\",\n+    \"getmempoolancestors\",\n+    \"getmempooldescendants\",\n+    \"getmempoolentry\",\n+    \"getmempoolinfo\",\n+    \"getmininginfo\",\n+    \"getnettotals\",\n+    \"getnetworkhashps\",\n+    \"getnetworkinfo\",\n+    \"getnodeaddresses\",\n+    \"getpeerinfo\",\n+    \"getrawmempool\",\n+    \"getrawtransaction\",\n+    \"getrpcinfo\",\n+    \"gettxout\",\n+    \"gettxoutsetinfo\",\n+    \"help\",\n+    \"joinpsbts\",\n+    \"listbanned\",\n+    \"logging\",\n+    \"ping\",\n+    \"preciousblock\",\n+    \"pruneblockchain\",\n+    \"reconsiderblock\",\n+    \"savemempool\",\n+    \"scantxoutset\",\n+    \"sendrawtransaction\",\n+    \"setmocktime\",\n+    \"setnetworkactive\",\n+    \"signmessagewithprivkey\",\n+    \"signrawtransactionwithkey\",\n+    \"submitblock\",\n+    \"submitheader\",\n+    \"syncwithvalidationinterfacequeue\",\n+    \"testmempoolaccept\",\n+    \"uptime\",\n+    \"utxoupdatepsbt\",\n+    \"validateaddress\",\n+    \"verifychain\",\n+    \"verifymessage\",\n+    \"verifytxoutproof\",\n+    \"waitforblock\",\n+    \"waitforblockheight\",\n+    \"waitfornewblock\",\n+};\n+\n+std::string ConsumeScalarRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    const size_t max_string_length = 4096;\n+    std::string r;\n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            // string argument\n+            r = fuzzed_data_provider.ConsumeRandomLengthString(max_string_length);\n+        },\n+        [&] {\n+            // base64 argument\n+            r = EncodeBase64(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // hex argument\n+            r = HexStr(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // bool argument\n+            r = fuzzed_data_provider.ConsumeBool() ? \"true\" : \"false\";\n+        },\n+        [&] {\n+            // range argument\n+            r = \"[\" + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + \",\" + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + \"]\";\n+        },\n+        [&] {\n+            // integral argument (int64_t)\n+            r = ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>());\n+        },\n+        [&] {\n+            // integral argument (uint64_t)\n+            r = ToString(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        },\n+        [&] {\n+            // floating point argument\n+            r = strprintf(\"%f\", fuzzed_data_provider.ConsumeFloatingPoint<double>());\n+        },\n+        [&] {\n+            // tx destination argument\n+            r = EncodeDestination(ConsumeTxDestination(fuzzed_data_provider));\n+        },\n+        [&] {\n+            // uint160 argument\n+            r = ConsumeUInt160(fuzzed_data_provider).ToString();\n+        },\n+        [&] {\n+            // uint256 argument\n+            r = ConsumeUInt256(fuzzed_data_provider).ToString();\n+        },\n+        [&] {\n+            // base32 argument\n+            r = EncodeBase32(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length));\n+        },\n+        [&] {\n+            // base58 argument\n+            r = EncodeBase58(MakeUCharSpan(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length)));\n+        },\n+        [&] {\n+            // base58 argument with checksum\n+            r = EncodeBase58Check(MakeUCharSpan(fuzzed_data_provider.ConsumeRandomLengthString(max_string_length)));\n+        },\n+        [&] {\n+            // hex encoded block\n+            std::optional<CBlock> opt_block = ConsumeDeserializable<CBlock>(fuzzed_data_provider);\n+            if (!opt_block) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_block;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // hex encoded block header\n+            std::optional<CBlockHeader> opt_block_header = ConsumeDeserializable<CBlockHeader>(fuzzed_data_provider);\n+            if (!opt_block_header) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_block_header;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // hex encoded tx\n+            std::optional<CMutableTransaction> opt_tx = ConsumeDeserializable<CMutableTransaction>(fuzzed_data_provider);\n+            if (!opt_tx) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, fuzzed_data_provider.ConsumeBool() ? PROTOCOL_VERSION : (PROTOCOL_VERSION | SERIALIZE_TRANSACTION_NO_WITNESS)};\n+            data_stream << *opt_tx;\n+            r = HexStr(data_stream);\n+        },\n+        [&] {\n+            // base64 encoded psbt\n+            std::optional<PartiallySignedTransaction> opt_psbt = ConsumeDeserializable<PartiallySignedTransaction>(fuzzed_data_provider);\n+            if (!opt_psbt) {\n+                return;\n+            }\n+            CDataStream data_stream{SER_NETWORK, PROTOCOL_VERSION};\n+            data_stream << *opt_psbt;\n+            r = EncodeBase64({data_stream.begin(), data_stream.end()});\n+        },\n+        [&] {\n+            // base58 encoded key\n+            const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+            CKey key;\n+            key.Set(random_bytes.begin(), random_bytes.end(), fuzzed_data_provider.ConsumeBool());\n+            if (!key.IsValid()) {\n+                return;\n+            }\n+            r = EncodeSecret(key);\n+        },\n+        [&] {\n+            // hex encoded pubkey\n+            const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(32);\n+            CKey key;\n+            key.Set(random_bytes.begin(), random_bytes.end(), fuzzed_data_provider.ConsumeBool());\n+            if (!key.IsValid()) {\n+                return;\n+            }\n+            r = HexStr(key.GetPubKey());\n+        });\n+    return r;\n+}\n+\n+std::string ConsumeArrayRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    std::vector<std::string> scalar_arguments;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        scalar_arguments.push_back(ConsumeScalarRPCArgument(fuzzed_data_provider));\n+    }\n+    return \"[\\\"\" + Join(scalar_arguments, \"\\\",\\\"\") + \"\\\"]\";\n+}\n+\n+std::string ConsumeRPCArgument(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    return fuzzed_data_provider.ConsumeBool() ? ConsumeScalarRPCArgument(fuzzed_data_provider) : ConsumeArrayRPCArgument(fuzzed_data_provider);\n+}\n+\n+RPCFuzzTestingSetup* InitializeRPCFuzzTestingSetup()\n+{\n+    static const auto setup = MakeNoLogFileContext<RPCFuzzTestingSetup>();\n+    SetRPCWarmupFinished();\n+    return setup.get();\n+}\n+}; // namespace\n+\n+void initialize_rpc()\n+{\n+    rpc_testing_setup = InitializeRPCFuzzTestingSetup();\n+    const std::vector<std::string> supported_rpc_commands = rpc_testing_setup->GetRPCCommands();\n+    for (const std::string& rpc_command : supported_rpc_commands) {\n+        const bool safe_for_fuzzing = std::find(RPC_COMMANDS_SAFE_FOR_FUZZING.begin(), RPC_COMMANDS_SAFE_FOR_FUZZING.end(), rpc_command) != RPC_COMMANDS_SAFE_FOR_FUZZING.end();\n+        const bool not_safe_for_fuzzing = std::find(RPC_COMMANDS_NOT_SAFE_FOR_FUZZING.begin(), RPC_COMMANDS_NOT_SAFE_FOR_FUZZING.end(), rpc_command) != RPC_COMMANDS_NOT_SAFE_FOR_FUZZING.end();\n+        if (!(safe_for_fuzzing || not_safe_for_fuzzing)) {\n+            std::cerr << \"Error: RPC command \\\"\" << rpc_command << \"\\\" not found in RPC_COMMANDS_SAFE_FOR_FUZZING or RPC_COMMANDS_NOT_SAFE_FOR_FUZZING. Please update \" << __FILE__ << \".\\n\";\n+            std::terminate();\n+        }\n+        if (safe_for_fuzzing && not_safe_for_fuzzing) {\n+            std::cerr << \"Error: RPC command \\\"\" << rpc_command << \"\\\" found in *both* RPC_COMMANDS_SAFE_FOR_FUZZING and RPC_COMMANDS_NOT_SAFE_FOR_FUZZING. Please update \" << __FILE__ << \".\\n\";\n+            std::terminate();\n+        }\n+    }\n+    for (const std::string& rpc_command : RPC_COMMANDS_SAFE_FOR_FUZZING) {\n+        const bool supported_rpc_command = std::find(supported_rpc_commands.begin(), supported_rpc_commands.end(), rpc_command) != supported_rpc_commands.end();\n+        if (!supported_rpc_command) {\n+            std::cerr << \"Error: Unknown RPC command \\\"\" << rpc_command << \"\\\" found in RPC_COMMANDS_SAFE_FOR_FUZZING. Please update \" << __FILE__ << \".\\n\";\n+            std::terminate();\n+        }\n+    }\n+    for (const std::string& rpc_command : RPC_COMMANDS_NOT_SAFE_FOR_FUZZING) {\n+        const bool supported_rpc_command = std::find(supported_rpc_commands.begin(), supported_rpc_commands.end(), rpc_command) != supported_rpc_commands.end();\n+        if (!supported_rpc_command) {\n+            std::cerr << \"Error: Unknown RPC command \\\"\" << rpc_command << \"\\\" found in RPC_COMMANDS_NOT_SAFE_FOR_FUZZING. Please update \" << __FILE__ << \".\\n\";\n+            std::terminate();\n+        }\n+    }\n+    const char* limit_to_rpc_command_env = getenv(\"LIMIT_TO_RPC_COMMAND\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621857947",
      "id" : 621857947,
      "in_reply_to_id" : 621836878,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTg1Nzk0Nw==",
      "original_commit_id" : "555556e2fe864c0644de4e3e75d1833d43b6eb19",
      "original_line" : 353,
      "original_position" : 353,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646644243,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:39:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621857947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621858008"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621858008"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Addressed. Thanks!",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T06:39:50Z",
      "diff_hunk" : "@@ -0,0 +1,380 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string limit_to_rpc_command;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621858008",
      "id" : 621858008,
      "in_reply_to_id" : 621837799,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTg1ODAwOA==",
      "original_commit_id" : "555556e2fe864c0644de4e3e75d1833d43b6eb19",
      "original_line" : 62,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : null,
      "pull_request_review_id" : 646644313,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T06:39:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621858008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK 545404e7e1c72985557ccffe865cea269143e5dd\r\n\r\nIf this is leading to too much (maintenance) hassle, it can be reverted.",
      "created_at" : "2021-04-28T07:45:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#issuecomment-828229380",
      "id" : 828229380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21169",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyODIyOTM4MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-28T07:45:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/828229380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621920004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621920004"
         }
      },
      "author_association" : "MEMBER",
      "body" : "why is this unsafe, but the other generate* calls are safe?",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T08:10:05Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string g_limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",  // avoid DNS lookups\n+    \"addnode\",        // avoid DNS lookups\n+    \"addpeeraddress\", // avoid DNS lookups\n+    \"analyzepsbt\",    // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"dumptxoutset\",   // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621920004",
      "id" : 621920004,
      "line" : 77,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTkyMDAwNA==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 77,
      "original_position" : 77,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 77,
      "pull_request_review_id" : 646723483,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T08:19:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621920004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621920136"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621920136"
         }
      },
      "author_association" : "MEMBER",
      "body" : "unused?",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T08:10:14Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621920136",
      "id" : 621920136,
      "line" : 6,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTkyMDEzNg==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 6,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 6,
      "pull_request_review_id" : 646723483,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T08:19:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621920136",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621920483"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621920483"
         }
      },
      "author_association" : "MEMBER",
      "body" : "unused?",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T08:10:41Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621920483",
      "id" : 621920483,
      "line" : 8,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTkyMDQ4Mw==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 8,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 8,
      "pull_request_review_id" : 646723483,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T08:19:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621920483",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621920578"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621920578"
         }
      },
      "author_association" : "MEMBER",
      "body" : "fixed?",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T08:10:48Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string g_limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",  // avoid DNS lookups\n+    \"addnode\",        // avoid DNS lookups\n+    \"addpeeraddress\", // avoid DNS lookups\n+    \"analyzepsbt\",    // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"dumptxoutset\",   // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout\n+    \"gettxoutproof\",     // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\", // avoid reading from disk\n+    \"loadwallet\",   // avoid reading from disk\n+#endif\n+    \"mockscheduler\",         // avoid assertion failure (Assertion `delta_seconds.count() > 0 && delta_seconds < std::chrono::hours{1}' failed.)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621920578",
      "id" : 621920578,
      "line" : 83,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTkyMDU3OA==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 83,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 83,
      "pull_request_review_id" : 646723483,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T08:19:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621920578",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621927784"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621927784"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This seems dangerous. If the rpc is ever changed to take a file path, how would we know to adjust this line?",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-28T08:19:39Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string g_limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",  // avoid DNS lookups\n+    \"addnode\",        // avoid DNS lookups\n+    \"addpeeraddress\", // avoid DNS lookups\n+    \"analyzepsbt\",    // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"dumptxoutset\",   // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout\n+    \"gettxoutproof\",     // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\", // avoid reading from disk\n+    \"loadwallet\",   // avoid reading from disk\n+#endif\n+    \"mockscheduler\",         // avoid assertion failure (Assertion `delta_seconds.count() > 0 && delta_seconds < std::chrono::hours{1}' failed.)\n+    \"prioritisetransaction\", // avoid signed integer overflow in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) (https://github.com/bitcoin/bitcoin/issues/20626)\n+    \"setban\",                // avoid DNS lookups\n+    \"stop\",                  // avoid shutdown state\n+};\n+\n+// RPC commands which are safe for fuzzing.\n+const std::vector<std::string> RPC_COMMANDS_SAFE_FOR_FUZZING{\n+    \"clearbanned\",\n+    \"combinepsbt\",\n+    \"combinerawtransaction\",\n+    \"converttopsbt\",\n+    \"createmultisig\",\n+    \"createpsbt\",\n+    \"createrawtransaction\",\n+    \"decodepsbt\",\n+    \"decoderawtransaction\",\n+    \"decodescript\",\n+    \"deriveaddresses\",\n+    \"disconnectnode\",\n+    \"echo\",\n+    \"echojson\",\n+    \"estimaterawfee\",\n+    \"estimatesmartfee\",\n+    \"finalizepsbt\",\n+    \"generate\",\n+    \"generateblock\",\n+    \"generatetodescriptor\",\n+    \"getaddednodeinfo\",\n+    \"getbestblockhash\",\n+    \"getblock\",\n+    \"getblockchaininfo\",\n+    \"getblockcount\",\n+    \"getblockfilter\",\n+    \"getblockhash\",\n+    \"getblockheader\",\n+    \"getblockstats\",\n+    \"getblocktemplate\",\n+    \"getchaintips\",\n+    \"getchaintxstats\",\n+    \"getconnectioncount\",\n+    \"getdescriptorinfo\",\n+    \"getdifficulty\",\n+    \"getindexinfo\",\n+    \"getmemoryinfo\",\n+    \"getmempoolancestors\",\n+    \"getmempooldescendants\",\n+    \"getmempoolentry\",\n+    \"getmempoolinfo\",\n+    \"getmininginfo\",\n+    \"getnettotals\",\n+    \"getnetworkhashps\",\n+    \"getnetworkinfo\",\n+    \"getnodeaddresses\",\n+    \"getpeerinfo\",\n+    \"getrawmempool\",\n+    \"getrawtransaction\",\n+    \"getrpcinfo\",\n+    \"gettxout\",\n+    \"gettxoutsetinfo\",\n+    \"help\",\n+    \"invalidateblock\",\n+    \"joinpsbts\",\n+    \"listbanned\",\n+    \"logging\",\n+    \"ping\",\n+    \"preciousblock\",\n+    \"pruneblockchain\",\n+    \"reconsiderblock\",\n+    \"savemempool\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r621927784",
      "id" : 621927784,
      "line" : 152,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTkyNzc4NA==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 152,
      "original_position" : 152,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 152,
      "pull_request_review_id" : 646723483,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-28T08:19:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/621927784",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623306715"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623306715"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks! Addressed in #21810:\r\n\r\n```\r\n    \"generatetoaddress\",    // avoid prohibitively slow execution (when `num_blocks` is large)\r\n    \"generatetodescriptor\", // avoid prohibitively slow execution (when `nblocks` is large)\r\n```",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-29T18:48:52Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string g_limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",  // avoid DNS lookups\n+    \"addnode\",        // avoid DNS lookups\n+    \"addpeeraddress\", // avoid DNS lookups\n+    \"analyzepsbt\",    // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"dumptxoutset\",   // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623306715",
      "id" : 623306715,
      "in_reply_to_id" : 621920004,
      "line" : 77,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzMwNjcxNQ==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 77,
      "original_position" : 77,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 77,
      "pull_request_review_id" : 648541424,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-29T18:48:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623306715",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623311399"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623311399"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good point. Disabled as a precautionary measure in #21810.\r\n\r\n`dump*`, `save*`, `import*` and `load*` commands should probably not be part of `RPC_COMMANDS_SAFE_FOR_FUZZING`.\r\n\r\nLonger term we could perhaps also find a clever way to annotate/auto-detect RPC commands with file path arguments and have them automatically removed from `RPC_COMMANDS_SAFE_FOR_FUZZING` if they are incorrectly included there for some reason. Belts and suspenders! :)",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-29T18:56:17Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string g_limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",  // avoid DNS lookups\n+    \"addnode\",        // avoid DNS lookups\n+    \"addpeeraddress\", // avoid DNS lookups\n+    \"analyzepsbt\",    // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"dumptxoutset\",   // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout\n+    \"gettxoutproof\",     // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\", // avoid reading from disk\n+    \"loadwallet\",   // avoid reading from disk\n+#endif\n+    \"mockscheduler\",         // avoid assertion failure (Assertion `delta_seconds.count() > 0 && delta_seconds < std::chrono::hours{1}' failed.)\n+    \"prioritisetransaction\", // avoid signed integer overflow in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) (https://github.com/bitcoin/bitcoin/issues/20626)\n+    \"setban\",                // avoid DNS lookups\n+    \"stop\",                  // avoid shutdown state\n+};\n+\n+// RPC commands which are safe for fuzzing.\n+const std::vector<std::string> RPC_COMMANDS_SAFE_FOR_FUZZING{\n+    \"clearbanned\",\n+    \"combinepsbt\",\n+    \"combinerawtransaction\",\n+    \"converttopsbt\",\n+    \"createmultisig\",\n+    \"createpsbt\",\n+    \"createrawtransaction\",\n+    \"decodepsbt\",\n+    \"decoderawtransaction\",\n+    \"decodescript\",\n+    \"deriveaddresses\",\n+    \"disconnectnode\",\n+    \"echo\",\n+    \"echojson\",\n+    \"estimaterawfee\",\n+    \"estimatesmartfee\",\n+    \"finalizepsbt\",\n+    \"generate\",\n+    \"generateblock\",\n+    \"generatetodescriptor\",\n+    \"getaddednodeinfo\",\n+    \"getbestblockhash\",\n+    \"getblock\",\n+    \"getblockchaininfo\",\n+    \"getblockcount\",\n+    \"getblockfilter\",\n+    \"getblockhash\",\n+    \"getblockheader\",\n+    \"getblockstats\",\n+    \"getblocktemplate\",\n+    \"getchaintips\",\n+    \"getchaintxstats\",\n+    \"getconnectioncount\",\n+    \"getdescriptorinfo\",\n+    \"getdifficulty\",\n+    \"getindexinfo\",\n+    \"getmemoryinfo\",\n+    \"getmempoolancestors\",\n+    \"getmempooldescendants\",\n+    \"getmempoolentry\",\n+    \"getmempoolinfo\",\n+    \"getmininginfo\",\n+    \"getnettotals\",\n+    \"getnetworkhashps\",\n+    \"getnetworkinfo\",\n+    \"getnodeaddresses\",\n+    \"getpeerinfo\",\n+    \"getrawmempool\",\n+    \"getrawtransaction\",\n+    \"getrpcinfo\",\n+    \"gettxout\",\n+    \"gettxoutsetinfo\",\n+    \"help\",\n+    \"invalidateblock\",\n+    \"joinpsbts\",\n+    \"listbanned\",\n+    \"logging\",\n+    \"ping\",\n+    \"preciousblock\",\n+    \"pruneblockchain\",\n+    \"reconsiderblock\",\n+    \"savemempool\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623311399",
      "id" : 623311399,
      "in_reply_to_id" : 621927784,
      "line" : 152,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzMxMTM5OQ==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 152,
      "original_position" : 152,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 152,
      "pull_request_review_id" : 648547448,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-29T19:05:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623311399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623316981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623316981"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks! Addressed in follow-up.",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-29T19:05:04Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623316981",
      "id" : 623316981,
      "in_reply_to_id" : 621920136,
      "line" : 6,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzMxNjk4MQ==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 6,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 6,
      "pull_request_review_id" : 648554651,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-29T19:05:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623316981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623317017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623317017"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks! Addressed in follow-up.",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-29T19:05:08Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623317017",
      "id" : 623317017,
      "in_reply_to_id" : 621920483,
      "line" : 8,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzMxNzAxNw==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 8,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 8,
      "pull_request_review_id" : 648554709,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-29T19:05:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623317017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623317211"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623317211"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Seems so! Thanks! Re-enabled in follow-up.",
      "commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "created_at" : "2021-04-29T19:05:27Z",
      "diff_hunk" : "@@ -0,0 +1,378 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <base58.h>\n+#include <chainparamsbase.h>\n+#include <core_io.h>\n+#include <interfaces/chain.h>\n+#include <key.h>\n+#include <key_io.h>\n+#include <node/context.h>\n+#include <primitives/block.h>\n+#include <primitives/transaction.h>\n+#include <psbt.h>\n+#include <rpc/blockchain.h>\n+#include <rpc/client.h>\n+#include <rpc/request.h>\n+#include <rpc/server.h>\n+#include <rpc/util.h>\n+#include <span.h>\n+#include <streams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n+#include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/strencodings.h>\n+#include <util/string.h>\n+#include <util/time.h>\n+\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <optional>\n+#include <stdexcept>\n+#include <string>\n+#include <vector>\n+\n+namespace {\n+struct RPCFuzzTestingSetup : public TestingSetup {\n+    RPCFuzzTestingSetup(const std::string& chain_name, const std::vector<const char*>& extra_args) : TestingSetup{chain_name, extra_args}\n+    {\n+    }\n+\n+    UniValue CallRPC(const std::string& rpc_method, const std::vector<std::string>& arguments)\n+    {\n+        JSONRPCRequest request;\n+        request.context = &m_node;\n+        request.strMethod = rpc_method;\n+        request.params = RPCConvertValues(rpc_method, arguments);\n+        return tableRPC.execute(request);\n+    }\n+\n+    std::vector<std::string> GetRPCCommands() const\n+    {\n+        return tableRPC.listCommands();\n+    }\n+};\n+\n+RPCFuzzTestingSetup* rpc_testing_setup = nullptr;\n+std::string g_limit_to_rpc_command;\n+\n+// RPC commands which are not appropriate for fuzzing: such as RPC commands\n+// reading or writing to a filename passed as an RPC parameter, RPC commands\n+// resulting in network activity, etc.\n+const std::vector<std::string> RPC_COMMANDS_NOT_SAFE_FOR_FUZZING{\n+    \"addconnection\",  // avoid DNS lookups\n+    \"addnode\",        // avoid DNS lookups\n+    \"addpeeraddress\", // avoid DNS lookups\n+    \"analyzepsbt\",    // avoid signed integer overflow in CFeeRate::GetFee(unsigned long) (https://github.com/bitcoin/bitcoin/issues/20607)\n+    \"dumptxoutset\",   // avoid writing to disk\n+#ifdef ENABLE_WALLET\n+    \"dumpwallet\", // avoid writing to disk\n+#endif\n+    \"echoipc\",           // avoid assertion failure (Assertion `\"EnsureAnyNodeContext(request.context).init\" && check' failed.)\n+    \"generatetoaddress\", // avoid timeout\n+    \"gettxoutproof\",     // avoid slow execution\n+#ifdef ENABLE_WALLET\n+    \"importwallet\", // avoid reading from disk\n+    \"loadwallet\",   // avoid reading from disk\n+#endif\n+    \"mockscheduler\",         // avoid assertion failure (Assertion `delta_seconds.count() > 0 && delta_seconds < std::chrono::hours{1}' failed.)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21169#discussion_r623317211",
      "id" : 623317211,
      "in_reply_to_id" : 621920578,
      "line" : 83,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzMxNzIxMQ==",
      "original_commit_id" : "545404e7e1c72985557ccffe865cea269143e5dd",
      "original_line" : 83,
      "original_position" : 83,
      "original_start_line" : null,
      "path" : "src/test/fuzz/rpc.cpp",
      "position" : 83,
      "pull_request_review_id" : 648554979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21169",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-29T19:05:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623317211",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
