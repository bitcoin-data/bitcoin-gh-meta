[
   {
      "author_association" : "MEMBER",
      "body" : "+1 for improving robustness here. Silently failing errors are horrible for troubleshooting.\r\n\r\nEdit: https://github.com/bitcoin/bitcoin/pull/16837#discussion_r322842701  illustrates, again, why this is important",
      "created_at" : "2019-09-10T07:36:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16838#issuecomment-529812128",
      "id" : 529812128,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16838",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyOTgxMjEyOA==",
      "updated_at" : "2019-09-10T16:32:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/529812128",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I spent some time looking at this today. Would it be ok if we required gnu `sed` in depends (there is some precedent as we require `glibtoolize` elsewhere in the build system)? Otherwise I'm not sure that the suggested approach would work out of the box on macOS (BSD sed).\r\n\r\nI did have a look at the approach in https://stackoverflow.com/a/28966696, but that seemed a bit messy. Will revisit later on.",
      "created_at" : "2019-09-16T05:16:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16838#issuecomment-531643848",
      "id" : 531643848,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16838",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMTY0Mzg0OA==",
      "updated_at" : "2019-09-16T05:16:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/531643848",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "~~Doesn't `sed -i` already rely on GNU sed? I don't remember seeing it in BSDs.~~\r\n\r\nApparently it does, just checked on FreeBSD at least and\r\n```\r\n     -i extension\r\n             Edit files in-place similarly to -I, but treat each file\r\n             independently from other files.  In particular, line numbers in\r\n             each file start at 1, the \"$\" address matches the last line of\r\n             the current file, and address ranges are limited to the current\r\n             file.  (See Sed Addresses.) The net result is as though each file\r\n             were edited by a separate sed instance.\r\n```",
      "created_at" : "2019-09-16T10:36:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16838#issuecomment-531723552",
      "id" : 531723552,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16838",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMTcyMzU1Mg==",
      "updated_at" : "2019-09-16T10:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/531723552",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Couldn't we mock (or wrap) `sed` while doing depends? That way we can control the exit code.\r\n\r\nA wrapper that does the following, should be good enough:\r\n```\r\n  - check that ${file}_BACKUP does not exist\r\n  - run replacement with unmodified sed on $file, additionally passing `--in-place=_BACKUP`\r\n  - assert that $file differs from $file_BACKUP\r\n  - delete $file_BACKUP",
      "created_at" : "2019-09-16T16:18:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16838#issuecomment-531849929",
      "id" : 531849929,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16838",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMTg0OTkyOQ==",
      "updated_at" : "2019-09-16T16:18:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/531849929",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Couldn't we mock (or wrap) `sed` while doing depends? That way we can control the exit code.\r\n> \r\n> A wrapper that does the following, should be good enough:\r\n> \r\n> ```\r\n>   - check that ${file}_BACKUP does not exist\r\n>   - run replacement with unmodified sed on $file, additionally passing `--in-place=_BACKUP`\r\n>   - assert that $file differs from $file_BACKUP\r\n>   - delete $file_BACKUP\r\n> ```\r\n\r\nHow would we make that wrapper accessible in the Makefile? Somethine like `SHELL = /usr/bin/env PATH=$(CURDIR)/wrappers:${PATH} sh`?",
      "created_at" : "2019-09-16T17:38:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16838#issuecomment-531880653",
      "id" : 531880653,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16838",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMTg4MDY1Mw==",
      "updated_at" : "2019-09-16T17:38:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/531880653",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yeah, something like that.",
      "created_at" : "2019-09-16T19:14:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16838#issuecomment-531917658",
      "id" : 531917658,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16838",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMTkxNzY1OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2019-09-16T19:14:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/531917658",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've removed \"good first issue\" here, as the remaining `sed` usage is basically contained to qt (1 in libxcb that we ), and is non-trivial to remove.",
      "created_at" : "2021-03-31T08:48:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16838#issuecomment-810894204",
      "id" : 810894204,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16838",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMDg5NDIwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-31T08:48:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/810894204",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
