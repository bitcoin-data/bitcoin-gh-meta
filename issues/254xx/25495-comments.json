[
   {
      "author_association" : "MEMBER",
      "body" : "utACK af56d63eca8a246c02506c2aef7ea8a22e2d07bb\r\n\r\n(I looked just at the diff, and guessed why the original code was wrong without looking at the description)",
      "created_at" : "2022-06-28T22:34:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1169356211",
      "id" : 1169356211,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585FsvWz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169356211/reactions"
      },
      "updated_at" : "2022-06-28T22:37:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169356211",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK af56d63eca8a246c02506c2aef7ea8a22e2d07bb\r\n\r\nAgree we should continue searching even solution with zero waste was found. Didn't test",
      "created_at" : "2022-06-29T06:52:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1169601907",
      "id" : 1169601907,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585FtrVz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169601907/reactions"
      },
      "updated_at" : "2022-06-29T06:52:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169601907",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2022-06-29T11:59:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1169893368",
      "id" : 1169893368,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Fuyf4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169893368/reactions"
      },
      "updated_at" : "2022-06-29T15:18:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169893368",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK af56d63eca8a246c02506c2aef7ea8a22e2d07bb\r\n\r\nOops, yes, waste can be negative.",
      "created_at" : "2022-06-29T14:48:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1170078335",
      "id" : 1170078335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Fvfp_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1170078335/reactions"
      },
      "updated_at" : "2022-06-29T14:48:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1170078335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@Xekyo Can you point me to why this decision is so or where this discussion happened?\r\n\r\n> ..we should prefer solutions with more inputs over solutions with fewer according to previous decisions\r\n\r\nIn your [paper](https://murch.one/wp-content/uploads/2016/11/erhardt2016coinselection.pdf), section 3.1.4 discusses conflicting goals, although it isn't all-together clear to me that we should maximize the number of UTXOs used.  If however, we do want to maximize the number of UTXOs used, I think the [sort](https://github.com/bitcoin/bitcoin/blob/6b254814c076054eedc4311698d16c8971937814/src/wallet/coinselection.cpp#L84) should be reversed here so the selection process starts with the smallest (non-dust) utxos?",
      "created_at" : "2022-08-20T13:45:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1221317767",
      "id" : 1221317767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Iy9SH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1221317767/reactions"
      },
      "updated_at" : "2022-08-20T13:45:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1221317767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@yancyribbens: The code had an early exit when an input set happened to achieve a `waste` score of 0. Waste is calculated by comparing the current cost of spending inputs with a hypothetical long-term cost (and adding the cost of change or excess in the case of changeless solutions). Specifically, the input-component of the waste score is calculated from `input_weight Ã (feerate - longterm_feerate)`. As you can see, if the current feerate is lower than the long-term feerate, the waste score of inputs will be negative. (I [blogged about the waste metric](https://murch.one/posts/waste-metric/), if you want to read more.) By picking the input set that results in the lowest waste score, we automatically prefer spending _more_ and _heavier_ inputs at low feerates, and _fewer_ and _lighter_ inputs at high feerates. \r\n\r\nE.g. at 1â¯s/vB, we would prefer a solution with two P2PKH (2Ã148â¯B Ã (1â¯s/vB - 10â¯s/vB) = -2664â¯s)â¯inputs over a solution with three P2WPKH inputs (3Ã68â¯vB Ã (1â¯s/vB - 10â¯s/vB) = -1836â¯s), and a solution with three P2WPKH inputs over a solution with two P2WPKH inputs (2Ã68â¯vB Ã (1â¯s/vB - 10â¯s/vB) = -1224â¯s). \r\n\r\nOn the other hand, at high feerates say 60â¯s/vB, we'll prefer a solution with one P2PKH input (148â¯B Ã (60â¯s/vB - 10â¯s/vB)â¯= 7400â¯s) over one with three P2WPKH inputs (148â¯B < 3Ã68 vB), but prefer two P2WPKH inputs over one P2PKH input (2Ã68â¯vBâ¯< 148â¯B), and obviously one P2WPKH over a solution with two P2WPKH inputs.\r\n\r\nOver the course of many transactions, this causes our wallet to opportunistically use more and heavier UTXOs at low feerates, which reduces our overall transaction fees, while preventing runaway UTXO pool bloat as we have seen from strategies that always try to minimize the input set (e.g. largest first selection).\r\n\r\nSo, we don't want to maximize the UTXOs used, but we just want to prefer spending them at lower feerates when it is opportune. By starting with the biggest UTXOs, we'll find one solution as quick as possible, but the algorithm hypothetically enumerates all possible input set (except that we stop after trying 100,000 combinations). While the reverse sort order would also enumerate all, I would expect that it performs much worse to find the first solution. It would be like trying to fill a bucket with sand and rocks where we currently put the rocks first, then pour the sand, and then instead pour the sand first and then try to fit the big rocks: the smaller pieces are much more likely to fit a remaining gap.",
      "created_at" : "2022-09-02T16:30:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1235698538",
      "id" : 1235698538,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Jp0Nq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1235698538/reactions"
      },
      "updated_at" : "2022-09-02T16:30:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1235698538",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@Xekyo thanks, I read your blog post.  I understand the strategy where when fees are cheap, keep adding utxos to the selection and if fees are expensive go for a minimal utxo selection set.  The thing that I think is confusing is the terminology, specifically \"negative waste\".  Personally, I think \"weight\" is a better word that we should be aiming to minimize.\r\n\r\nFor example:\r\n`selection_weight = current_waste + input_weight Ã (feerate - longterm_feerate)`\r\n\r\nWe therefore try to minimize the selection weight, and waste is always the excess (positive) amount.",
      "created_at" : "2022-09-04T11:54:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1236320966",
      "id" : 1236320966,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585JsMLG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1236320966/reactions"
      },
      "updated_at" : "2022-09-04T11:54:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1236320966",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the feedback that the terminology is confusing. Would consequently referring to it as `waste_score` as in my blog post be less confusing? I'm afraid that overloading the term âweightâ with a second meaning in the context of transaction building would not be a good way reduce the confusion. I guess in hindsight it might have been better to invert it and call it `opportunity_cost`, `input_set_preference` or similar.",
      "created_at" : "2022-09-06T14:53:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1238264483",
      "id" : 1238264483,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Jzmqj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238264483/reactions"
      },
      "updated_at" : "2022-09-06T15:05:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1238264483",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks BTW for writing up the terminology in your blog post.  It's much easier to understand than trying to read the reference implementation.  \r\n\r\nIn your post you describe `weight` as:\r\n> weight: total weight of the input set\r\n\r\nWhich I think is a bit confusing since you're defining weight in terms of itself.  Reading the history of [weight](https://en.bitcoin.it/wiki/Weight_units) it looks like it can also be called `vbytes` which to me helps make sense of what weight is (a measure of data size after some possible transform).\r\n\r\nI understand not wanting to overload the term \"weight\", however in terms of graph theory, I think \"weight\" is typical terminology used to describe the value assigned to an edge.  In the case of DFS, using graph terminology feels fitting.\r\n\r\nI think `waste_score` is better, or maybe even just `score`.  Terminology that helps describe the combination of `?=waste + vbytes` or `?=waste + weight` (preference of following an edge) would be helpful.  In hindsight I think `edge_weight = waste + vbytes * (feerate - longterm_feerate)` would be preferable.  `opportunity_cost` and `input_set_preference` are good as well I think.\r\n\r\n",
      "created_at" : "2022-09-08T08:50:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1240421086",
      "id" : 1240421086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585J71Le",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1240421086/reactions"
      },
      "updated_at" : "2022-09-08T08:50:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1240421086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> In your post you describe `weight` as:\r\n> \r\n> > weight: total weight of the input set\r\n> \r\n> Which I think is a bit confusing since you're defining weight in terms of itself.\r\n\r\nOh, I'm explaining what the components of the formula, not defining terms.\r\n\r\n> Reading the history of [weight](https://en.bitcoin.it/wiki/Weight_units) it looks like it can also be called `vbytes` which to me helps make sense of what weight is (a measure of data size after some possible transform).\r\n\r\nI guess I could have added a bit more detail here in my blog post. There are four terms referring to different expressions of transaction size in Bitcoin:\r\n- size (raw byte length):  \r\n  The actual amount of bytes necessary to transfer or store a transaction. The relevant metric in the context of the pre-segwit blocksize limit. \r\n- weight\r\n  The weight of a transaction with 1â¯weightunit per byte of witness data and 4â¯weightunits per byte of non-witness data. Used in the context of the post-segwit blockweight limit.\r\n- virtual size\r\n  Derived from weight by dividing by 4, to make it more human-comparable to values people were used to before segwit.\r\n- stripped size\r\n  The remaining size of a transaction after pruning the witness data. Relevant for non-segwit only, who don't process witness data and continue to enforce the blocksize limit.\r\n\r\nThe formula works out when using weight and the feerate is given in `sat/kWU`. If the feerate were given in `sat/kvB` as Bitcoin Core usually uses, one should use the vsize.\r\n\r\n> I think `edge_weight = waste + vbytes * (feerate - longterm_feerate)` would be preferable.\r\n\r\nIt's not clear to me what you're proposing here, given that `vbytes * (feerate - longterm_feerate)` is already a component of waste. I also don't see what the inspiration for âedgeâ in this context would be.",
      "created_at" : "2022-09-13T18:16:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1245787081",
      "id" : 1245787081,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585KQTPJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1245787081/reactions"
      },
      "updated_at" : "2022-09-13T18:16:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1245787081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the explanation.\r\n\r\n> It's not clear to me what you're proposing here, given that vbytes * (feerate - longterm_feerate) is already a component of waste\r\n\r\nI had thought  `weight` and `virtual size` where interchangeable terms although it looks like I was mistaken.\r\n\r\n>  I also don't see what the inspiration for âedgeâ in this context would be.\r\n\r\nThe use of `edge` here was to try and avoid confusion with block `weight`.  I agree with your earlier post that overloading the therm `weight` is confusing.  Using `edge_weight` would make it clear we are talking about the `weight` of each edge (branch), not the block `weight`.  Although, perhaps `waste_score` or  `opportunity_cost` is better since `weight` is not in the name at all.\r\n\r\n\r\n\r\n",
      "created_at" : "2022-09-14T11:08:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1246606816",
      "id" : 1246606816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585KTbXg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1246606816/reactions"
      },
      "updated_at" : "2022-09-14T11:08:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1246606816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "As a follow-up to clarify perhaps: `weight` in the context of the waste score is not at all redefined. It's exactly the same âweightâ as in the context of the block weight limit and transaction weight. I just clarify for the formula that only the weight of the inputs is relevant in the context. You could of course use the complete weight of the resulting transaction, but the weight of the transaction header and recipient outputs would be the same for all solutions and thus just shift all compared values by a fixed offset respective to comparing the weight of the inputs.",
      "created_at" : "2022-09-15T18:49:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1248476008",
      "id" : 1248476008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Kajto",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1248476008/reactions"
      },
      "updated_at" : "2022-09-15T18:49:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1248476008",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> weight in the context of the waste score is not at all redefined.\r\n\r\nI understand that.  Originally, I had proposed re-defining `waste` to be a component of `weight` since I think a negate waste is confusing.\r\n\r\n> I'm afraid that overloading the term âweightâ\r\n\r\nNow that I understand better what block weight is, I agree that overloading the term would be confusing.\r\n\r\n> you could of course use the complete weight of the resulting transaction\r\n\r\nI'm not sure what is meant by this.  Could you clarify what you mean?\r\n\r\n",
      "created_at" : "2022-09-16T08:39:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1249088030",
      "id" : 1249088030,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Kc5Ie",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249088030/reactions"
      },
      "updated_at" : "2022-09-16T08:39:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249088030",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Let's say you're building a transaction that pays two recipients to a P2SH and a P2WSH output. Your UTXO pool consists only of segwit UTXOs, and let's say we only find two input set candidates, one with a single P2SH-P2WSH input and one with two P2WSH inputs.\r\n\r\nThe weight of the transaction with two P2WSH inputs is:\r\n\r\n        2Ã272 + 42 + 124 + 172\r\n\r\nand the weight of the transaction with one P2SH-P2WSH input is:\r\n\r\n       1Ã364 + 42 + 124 + 172\r\n       \r\nAs you can see, whatever the current feerate in that calculation the cost stemming from the transaction header and the two outputs (`42 + 124 + 172`) will be the same across all evaluated input sets and is therefore irrelevant if we're just looking for the minimal waste score.",
      "created_at" : "2022-09-16T18:45:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1249693593",
      "id" : 1249693593,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585KfM-Z",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249693593/reactions"
      },
      "updated_at" : "2022-09-16T18:45:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249693593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Alright, I see what you mean.  The point is that the difference in feerate does not need to take into account the difference in feerate for different transaction types.  It's only important that the difference in fee changes the waste score in a way that sways the UTXO selection process, but shifting by a fixed value IE the difference in transaction weight isn't important for the selection to work.\r\n\r\nBack to the earlier conversation, maybe we can settle on a code change PR which changes the terminology to `waste_score` instead of `waste`.  Anything with `weight` in the name seems of of the question and a more radical change like `opportunity_cost` or `input_set_preference` would require too much change to existing documentation. ",
      "created_at" : "2022-09-17T08:27:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1250028616",
      "id" : 1250028616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585KgexI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250028616/reactions"
      },
      "updated_at" : "2022-09-17T08:27:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250028616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Alright, I see what you mean. The point is that the difference in feerate does not need to take into account the difference in feerate for different transaction types. \r\n\r\nI'm not sure I understand what you mean. The targeted feerate is fixed across the complete transaction building process. It's a user input before we start picking inputs.\r\n\r\n> It's only important that the difference in fee changes the waste score in a way that sways the UTXO selection process, but shifting by a fixed value IE the difference in transaction weight isn't important for the selection to work.\r\n\r\nThe different weights of different input types do matter, larger outputs have a more negative waste score at low feerates and a higher waste score at high feeratesâso legacy outputs get picked preferentially at low feerates, while they get selected less at high feerates.  \r\nIt's the transaction parts of the transaction that are preset (the header and recipient outputs) that are the same for each selection attempt. We can ignore their transaction weight because they are the same regardless of what input set we pick, and therefore they don't sway the input selection.\r\n\r\n> Back to the earlier conversation, maybe we can settle on a code change PR which changes the terminology to `waste_score` instead of `waste`. Anything with `weight` in the name seems of of the question and a more radical change like `opportunity_cost` or `input_set_preference` would require too much change to existing documentation.\r\n\r\nTBH, I'm not convinced that renaming `waste` to `waste_score` is that significant an improvement of readability. Perhaps it would be more useful to add a line or two to the documentation to explain that waste can be negative and how it works.",
      "created_at" : "2022-09-18T22:06:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1250395828",
      "id" : 1250395828,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Kh4a0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250395828/reactions"
      },
      "updated_at" : "2022-09-18T22:06:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250395828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The different weights of different input types do matter..\r\n\r\nThat makes sense, I see what you mean now.\r\n\r\n> TBH, I'm not convinced that renaming waste to waste_score is that significant an improvement of readability. \r\n\r\nAlright.  Thanks for entertaining the possibility.",
      "created_at" : "2022-09-19T07:39:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25495#issuecomment-1250674381",
      "id" : 1250674381,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25495",
      "node_id" : "IC_kwDOABII585Ki8bN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250674381/reactions"
      },
      "updated_at" : "2022-09-19T07:39:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250674381",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/817736?v=4",
         "events_url" : "https://api.github.com/users/yancyribbens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/yancyribbens/followers",
         "following_url" : "https://api.github.com/users/yancyribbens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/yancyribbens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/yancyribbens",
         "id" : 817736,
         "login" : "yancyribbens",
         "node_id" : "MDQ6VXNlcjgxNzczNg==",
         "organizations_url" : "https://api.github.com/users/yancyribbens/orgs",
         "received_events_url" : "https://api.github.com/users/yancyribbens/received_events",
         "repos_url" : "https://api.github.com/users/yancyribbens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/yancyribbens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/yancyribbens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/yancyribbens"
      }
   }
]
