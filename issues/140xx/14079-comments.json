[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#13360](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13360.html) ([Policy] Reject SIGHASH_SINGLE with output out of bound by jl2012)\n* [#13266](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13266.html) ([moveonly] privatize SignatureExtractorChecker by Empact)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-08-27T14:09:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#issuecomment-416239280",
      "id" : 416239280,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNjIzOTI4MA==",
      "updated_at" : "2019-03-04T11:20:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416239280",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jl2012 Would it be possible to generate some benchmarks to quantify the performance effect? :-)",
      "created_at" : "2018-08-27T15:41:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#issuecomment-416269856",
      "id" : 416269856,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNjI2OTg1Ng==",
      "updated_at" : "2018-08-27T15:41:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416269856",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Awesome!  I thought we already did that!",
      "created_at" : "2018-08-27T15:59:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#issuecomment-416275509",
      "id" : 416275509,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNjI3NTUwOQ==",
      "updated_at" : "2018-08-27T15:59:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416275509",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14079#discussion_r220328354"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220328354"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n2018-09-25 21:05:15 clang(pr=14079): script/interpreter.h:147:176: warning: unused parameter 'sighash_copy' [-Wunused-parameter]\r\n2018-09-25 21:05:15 clang(pr=14079): script/interpreter.h:147:195: warning: unused parameter 'sighash_copy_type' [-Wunused-parameter]\r\n```",
      "commit_id" : "0727e2bb70c6e0138021633ddda7ff7d89a1a953",
      "created_at" : "2018-09-25T19:40:13Z",
      "diff_hunk" : "@@ -144,7 +144,7 @@ uint256 SignatureHash(const CScript& scriptCode, const T& txTo, unsigned int nIn\n class BaseSignatureChecker\n {\n public:\n-    virtual bool CheckSig(const std::vector<unsigned char>& scriptSig, const std::vector<unsigned char>& vchPubKey, const CScript& scriptCode, SigVersion sigversion) const\n+    virtual bool CheckSig(const std::vector<unsigned char>& scriptSig, const std::vector<unsigned char>& vchPubKey, const CScript& scriptCode, SigVersion sigversion, uint256* sighash_copy, int* sighash_copy_type) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#discussion_r220328354",
      "id" : 220328354,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDMyODM1NA==",
      "original_commit_id" : "0727e2bb70c6e0138021633ddda7ff7d89a1a953",
      "original_position" : 5,
      "path" : "src/script/interpreter.h",
      "position" : 5,
      "pull_request_review_id" : 158711664,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14079",
      "updated_at" : "2018-09-25T19:40:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220328354",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--5d09a71f8925f3f132321140b44b946d-->The last travis run for this pull request was 253 days ago and is thus outdated. To trigger a fresh travis build, this pull request should be closed and re-opened.",
      "created_at" : "2019-05-07T17:06:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#issuecomment-490166420",
      "id" : 490166420,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5MDE2NjQyMA==",
      "updated_at" : "2019-05-07T17:06:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/490166420",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14079#discussion_r298369398"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/298369398"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, unused parameters could be commented.",
      "commit_id" : "0727e2bb70c6e0138021633ddda7ff7d89a1a953",
      "created_at" : "2019-06-27T21:03:51Z",
      "diff_hunk" : "@@ -282,12 +282,12 @@ class SignatureExtractorChecker final : public BaseSignatureChecker\n \n public:\n     SignatureExtractorChecker(SignatureData& sigdata, BaseSignatureChecker& checker) : sigdata(sigdata), checker(checker) {}\n-    bool CheckSig(const std::vector<unsigned char>& scriptSig, const std::vector<unsigned char>& vchPubKey, const CScript& scriptCode, SigVersion sigversion) const override;\n+    bool CheckSig(const std::vector<unsigned char>& scriptSig, const std::vector<unsigned char>& vchPubKey, const CScript& scriptCode, SigVersion sigversion, uint256* sighash_copy, int* sighash_copy_type) const override;\n };\n \n-bool SignatureExtractorChecker::CheckSig(const std::vector<unsigned char>& scriptSig, const std::vector<unsigned char>& vchPubKey, const CScript& scriptCode, SigVersion sigversion) const\n+bool SignatureExtractorChecker::CheckSig(const std::vector<unsigned char>& scriptSig, const std::vector<unsigned char>& vchPubKey, const CScript& scriptCode, SigVersion sigversion, uint256* sighash_copy, int* sighash_copy_type) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#discussion_r298369398",
      "id" : 298369398,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5ODM2OTM5OA==",
      "original_commit_id" : "0727e2bb70c6e0138021633ddda7ff7d89a1a953",
      "original_position" : 9,
      "path" : "src/script/sign.cpp",
      "position" : 9,
      "pull_request_review_id" : 255479446,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14079",
      "updated_at" : "2019-06-27T21:07:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/298369398",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14079#discussion_r298369542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14079"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/298369542"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, add braces please.",
      "commit_id" : "0727e2bb70c6e0138021633ddda7ff7d89a1a953",
      "created_at" : "2019-06-27T21:04:20Z",
      "diff_hunk" : "@@ -1307,20 +1309,30 @@ bool GenericTransactionSignatureChecker<T>::VerifySignature(const std::vector<un\n }\n \n template <class T>\n-bool GenericTransactionSignatureChecker<T>::CheckSig(const std::vector<unsigned char>& vchSigIn, const std::vector<unsigned char>& vchPubKey, const CScript& scriptCode, SigVersion sigversion) const\n+bool GenericTransactionSignatureChecker<T>::CheckSig(const std::vector<unsigned char>& vchSigIn, const std::vector<unsigned char>& vchPubKey, const CScript& scriptCode, SigVersion sigversion, uint256* sighash_copy, int* sighash_copy_type) const\n {\n     CPubKey pubkey(vchPubKey);\n     if (!pubkey.IsValid())\n         return false;\n \n-    // Hash type is one byte tacked on to the end of the signature\n+    // Hash type is one byte unsigned char tacked on to the end of the signature\n+    // The 'unsigned' attribute is consensus critical, as the unsigned char is cast to an int and serialized in SignatureHash()\n     std::vector<unsigned char> vchSig(vchSigIn);\n     if (vchSig.empty())\n         return false;\n     int nHashType = vchSig.back();\n     vchSig.pop_back();\n \n-    uint256 sighash = SignatureHash(scriptCode, *txTo, nIn, nHashType, amount, sigversion, this->txdata);\n+    uint256 sighash;\n+    if (sighash_copy_type && sighash_copy && *sighash_copy_type == nHashType)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#discussion_r298369542",
      "id" : 298369542,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5ODM2OTU0Mg==",
      "original_commit_id" : "0727e2bb70c6e0138021633ddda7ff7d89a1a953",
      "original_position" : 49,
      "path" : "src/script/interpreter.cpp",
      "position" : 49,
      "pull_request_review_id" : 255479446,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14079",
      "updated_at" : "2019-06-27T21:07:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/298369542",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Agree with @promag; I would like to see benchmark results indicating whether this actually has any effects.",
      "created_at" : "2019-07-28T11:36:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#issuecomment-515755276",
      "id" : 515755276,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNTc1NTI3Ng==",
      "updated_at" : "2019-07-28T11:36:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/515755276",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closing this as \"Up for grabs\". If anyone is interested in picking this up, as mentioned multiple times above, the best place to start is likely writing some benchmarks that would demonstrate any performance improvements.",
      "created_at" : "2019-08-14T09:07:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14079#issuecomment-521165904",
      "id" : 521165904,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14079",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMTE2NTkwNA==",
      "updated_at" : "2019-08-14T09:07:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/521165904",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
