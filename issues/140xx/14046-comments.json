[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212580275"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212580275"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "According to https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md these should be prefixed `m_`.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-24T10:00:08Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212580275",
      "id" : 212580275,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjU4MDI3NQ==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 21,
      "path" : "src/net_message.h",
      "position" : 21,
      "pull_request_review_id" : 149244665,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212580275",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/295504?v=4",
         "events_url" : "https://api.github.com/users/scravy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/scravy/followers",
         "following_url" : "https://api.github.com/users/scravy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/scravy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/scravy",
         "id" : 295504,
         "login" : "scravy",
         "node_id" : "MDQ6VXNlcjI5NTUwNA==",
         "organizations_url" : "https://api.github.com/users/scravy/orgs",
         "received_events_url" : "https://api.github.com/users/scravy/received_events",
         "repos_url" : "https://api.github.com/users/scravy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/scravy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/scravy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/scravy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Any reason to not use `unique_ptr` instead? I don't see sharing of message ownership.",
      "created_at" : "2018-08-24T10:01:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-415713817",
      "id" : 415713817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTcxMzgxNw==",
      "updated_at" : "2018-08-24T10:01:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415713817",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212581034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212581034"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I kept it because it is moved code and to simplify the review.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-24T10:02:27Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212581034",
      "id" : 212581034,
      "in_reply_to_id" : 212580275,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjU4MTAzNA==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 21,
      "path" : "src/net_message.h",
      "position" : 21,
      "pull_request_review_id" : 149245560,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212581034",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212581106"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212581106"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is moved code right?",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-24T10:02:48Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212581106",
      "id" : 212581106,
      "in_reply_to_id" : 212580275,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjU4MTEwNg==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 21,
      "path" : "src/net_message.h",
      "position" : 21,
      "pull_request_review_id" : 149245650,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212581106",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think shared is fine here and does allow more flexible handling in future with little cost (ref counting)",
      "created_at" : "2018-08-24T11:14:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-415729082",
      "id" : 415729082,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTcyOTA4Mg==",
      "updated_at" : "2018-08-24T11:14:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415729082",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16562](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16562.html) (Refactor message transport packaging by jonasschnelli)\n* [#16324](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16324.html) (Get cs_main out of the critical path in ProcessMessages by TheBlueMatt)\n* [#16323](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16323.html) (Call ProcessNewBlock() asynchronously by TheBlueMatt)\n* [#16273](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16273.html) (refactor: Remove unused includes by practicalswift)\n* [#16248](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16248.html) (Make whitebind/whitelist permissions more flexible by NicolasDorier)\n* [#16202](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16202.html) (Refactor network message deserialization by jonasschnelli)\n* [#15206](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15206.html) (Immediately disconnect on invalid net message checksum by jonasschnelli)\n* [#15197](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15197.html) (Refactor and slightly stricter p2p message processing by jonasschnelli)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-08-24T12:16:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-415741584",
      "id" : 415741584,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTc0MTU4NA==",
      "updated_at" : "2019-08-07T19:50:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415741584",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "created_at" : "2018-08-24T13:27:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-415758458",
      "id" : 415758458,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTc1ODQ1OA==",
      "updated_at" : "2018-08-24T13:27:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415758458",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Adding an extra memory allocation for every network message isn't free. I'm concerned that we may be falling into overusing sharedptr \"just in case\", which is bad because it leaks performance in a diffuse way that doesn't show up well in profiles.  Please don't use sharedptr where unique will work.  If something new comes in in the future that needs a sharedptr then we can switch then.",
      "created_at" : "2018-08-24T16:40:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-415814511",
      "id" : 415814511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTgxNDUxMQ==",
      "updated_at" : "2018-08-24T16:40:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415814511",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gmaxwell `unique_ptr` and `shared_ptr` have the same number of allocations (if `make_shared` is used, at least), though `shared_ptr` uses more memory (both for the pointer itself and for the allocated memory), and has atomics to update the refcounts (which may reduce performance).\r\n\r\nTo be clear, I agree we should avoid `shared_ptr` unless there is a good reason.",
      "created_at" : "2018-08-24T17:15:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-415823750",
      "id" : 415823750,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTgyMzc1MA==",
      "updated_at" : "2018-08-24T22:01:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415823750",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212699280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212699280"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: In commit \" Use shared pointers for CNetMessage handling \" you could keep this a plain reference to keep the diff smaller, I think.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-24T17:28:14Z",
      "diff_hunk" : "@@ -748,41 +748,40 @@ bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete\n     while (nBytes > 0) {\n \n         // get current incomplete message, or create a new one\n-        if (vRecvMsg.empty() ||\n-            vRecvMsg.back().complete())\n-            vRecvMsg.push_back(CNetMessage(Params().MessageStart(), SER_NETWORK, INIT_PROTO_VERSION));\n+        if (vRecvMsg.empty() || vRecvMsg.back()->complete()) {\n+            vRecvMsg.emplace_back(std::make_shared<CNetMessage>(Params().MessageStart(), SER_NETWORK, INIT_PROTO_VERSION));\n+        }\n \n-        CNetMessage& msg = vRecvMsg.back();\n+        CNetMessageRef msg = vRecvMsg.back();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212699280",
      "id" : 212699280,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjY5OTI4MA==",
      "original_commit_id" : "9f5702205df9caf5df3aec2f6e5127caf80c1ecc",
      "original_position" : 12,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 149391318,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212699280",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212699388"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212699388"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same here",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-24T17:28:32Z",
      "diff_hunk" : "@@ -3002,29 +3002,29 @@ bool PeerLogicValidation::ProcessMessages(CNode* pfrom, std::atomic<bool>& inter\n     if (pfrom->fPauseSend)\n         return false;\n \n-    std::list<CNetMessage> msgs;\n+    std::list<CNetMessageRef> msgs;\n     {\n         LOCK(pfrom->cs_vProcessMsg);\n         if (pfrom->vProcessMsg.empty())\n             return false;\n         // Just take one message\n         msgs.splice(msgs.begin(), pfrom->vProcessMsg, pfrom->vProcessMsg.begin());\n-        pfrom->nProcessQueueSize -= msgs.front().vRecv.size() + CMessageHeader::HEADER_SIZE;\n+        pfrom->nProcessQueueSize -= msgs.front()->vRecv.size() + CMessageHeader::HEADER_SIZE;\n         pfrom->fPauseRecv = pfrom->nProcessQueueSize > connman->GetReceiveFloodSize();\n         fMoreWork = !pfrom->vProcessMsg.empty();\n     }\n-    CNetMessage& msg(msgs.front());\n+    CNetMessageRef msg(msgs.front());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212699388",
      "id" : 212699388,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjY5OTM4OA==",
      "original_commit_id" : "9f5702205df9caf5df3aec2f6e5127caf80c1ecc",
      "original_position" : 18,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 149391318,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212699388",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838045"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838045"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Implement a virtual destructor to protect against undefined behavior in the event that an object of a derived `NetMessageBase` class with a destructor is destroyed through a pointer to this base class.\r\n \r\n```c++\r\nvirtual ~NetMessageBase() {}\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:31:04Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838045",
      "id" : 212838045,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODA0NQ==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 18,
      "path" : "src/net_message.h",
      "position" : 18,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838045",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838062"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838062"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Make `SetVersion` a virtual member function to be sure that derived implementations are called when called via a pointer to this base class.\r\n```c++\r\nvirtual void SetVersion(int nVersionIn)\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:31:40Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838062",
      "id" : 212838062,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODA2Mg==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 34,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838062",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838103"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838103"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The developer notes state that for new symbols it is preferred that: \"Class names, function names and method names are UpperCamelCase (PascalCase)\"\r\n\r\n```c++\r\n     virtual bool VerifyMessageStart() const = 0;\r\n     virtual bool VerifyHeader() const = 0;\r\n     virtual bool VerifyChecksum(std::string& error) const = 0;\r\n```\r\n\r\nCan you check if all the new method names are UpperCamelCase?",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:33:15Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838103",
      "id" : 212838103,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODEwMw==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 43,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838103",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838565"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838565"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Remove the `const CMessageHeader::MessageStartChars& pchMessageStartIn` argument from the constructor's argument list?\r\n```c++\r\nNetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\r\n```\r\n",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:50:54Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838565",
      "id" : 212838565,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODU2NQ==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 23,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838565",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838664"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838664"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Use `override` to ensure that these methods are overriding virtual methods from the base class.\r\n\r\n```c++\r\n    bool VerifyMessageStart() const override;\r\n    bool VerifyHeader() const override;\r\n    bool VerifyChecksum(std::string& error) const override;\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:55:13Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t getMessageSize() const\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t getMessageSizeWithHeader() const\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;\n+    }\n+\n+    std::string getCommandName() const\n+    {\n+        return hdr.pchCommand;\n+    }\n+\n+    const uint256& GetMessageHash() const;\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        hdrbuf.SetVersion(nVersionIn);\n+        NetMessageBase::SetVersion(nVersionIn);\n+    }\n+\n+    int read(const char* pch, unsigned int nBytes);\n+    int readHeader(const char* pch, unsigned int nBytes);\n+    int readData(const char* pch, unsigned int nBytes);\n+\n+    bool verifyMessageStart() const;\n+    bool verifyHeader() const;\n+    bool verifyChecksum(std::string& error) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838664",
      "id" : 212838664,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODY2NA==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 109,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838664",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838690"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838690"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Specify this method as `override`\r\n```c++\r\nbool complete() const override\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:56:14Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838690",
      "id" : 212838690,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODY5MA==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 70,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838690",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838700"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838700"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Specify this method as `override`\r\n```c++\r\nuint32_t getMessageSize() const override\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:56:37Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t getMessageSize() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838700",
      "id" : 212838700,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODcwMA==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 77,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838700",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838713"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838713"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Specify this method as `override`\r\n```c++\r\nuint32_t getMessageSizeWithHeader() const override\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:57:00Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t getMessageSize() const\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t getMessageSizeWithHeader() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838713",
      "id" : 212838713,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODcxMw==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 85,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838713",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838736"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838736"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Specify this method as `override`\r\n```c++\r\nstd::string getCommandName() const override\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:57:56Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t getMessageSize() const\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t getMessageSizeWithHeader() const\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;\n+    }\n+\n+    std::string getCommandName() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838736",
      "id" : 212838736,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODczNg==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 90,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838736",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838762"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838762"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Specify as `override`\r\n```c++\r\nvoid SetVersion(int nVersionIn) override\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:58:56Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t getMessageSize() const\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t getMessageSizeWithHeader() const\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;\n+    }\n+\n+    std::string getCommandName() const\n+    {\n+        return hdr.pchCommand;\n+    }\n+\n+    const uint256& GetMessageHash() const;\n+\n+    void SetVersion(int nVersionIn)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838762",
      "id" : 212838762,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODc2Mg==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 97,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838762",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838787"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838787"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Specify as `override`\r\n```c++\r\nint read(const char* pch, unsigned int nBytes) override;\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:59:34Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t getMessageSize() const\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t getMessageSizeWithHeader() const\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;\n+    }\n+\n+    std::string getCommandName() const\n+    {\n+        return hdr.pchCommand;\n+    }\n+\n+    const uint256& GetMessageHash() const;\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        hdrbuf.SetVersion(nVersionIn);\n+        NetMessageBase::SetVersion(nVersionIn);\n+    }\n+\n+    int read(const char* pch, unsigned int nBytes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838787",
      "id" : 212838787,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODc4Nw==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 103,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838787",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838793"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838793"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Prefer `using` over `typedef`?\r\n```c++\r\nusing NetMessageBaseRef = std::shared_ptr<NetMessageBase>;\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T20:59:46Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t getMessageSize() const\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t getMessageSizeWithHeader() const\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;\n+    }\n+\n+    std::string getCommandName() const\n+    {\n+        return hdr.pchCommand;\n+    }\n+\n+    const uint256& GetMessageHash() const;\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        hdrbuf.SetVersion(nVersionIn);\n+        NetMessageBase::SetVersion(nVersionIn);\n+    }\n+\n+    int read(const char* pch, unsigned int nBytes);\n+    int readHeader(const char* pch, unsigned int nBytes);\n+    int readData(const char* pch, unsigned int nBytes);\n+\n+    bool verifyMessageStart() const;\n+    bool verifyHeader() const;\n+    bool verifyChecksum(std::string& error) const;\n+};\n+\n+typedef std::shared_ptr<NetMessageBase> NetMessageBaseRef;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838793",
      "id" : 212838793,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODc5Mw==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 112,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838793",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838803"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838803"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`NetMessageRef` doesn't seem to be used. Can `NetMessageRef` be deleted? ",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-26T21:00:14Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+\n+    virtual bool complete() const = 0;\n+    virtual uint32_t getMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t getMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string getCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool verifyMessageStart() const = 0;\n+    virtual bool verifyHeader() const = 0;\n+    virtual bool verifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message after current used format\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+\n+public:\n+    bool in_data; // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf; // partially received header\n+    CMessageHeader hdr; // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(pchMessageStartIn, nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool complete() const\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t getMessageSize() const\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t getMessageSizeWithHeader() const\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;\n+    }\n+\n+    std::string getCommandName() const\n+    {\n+        return hdr.pchCommand;\n+    }\n+\n+    const uint256& GetMessageHash() const;\n+\n+    void SetVersion(int nVersionIn)\n+    {\n+        hdrbuf.SetVersion(nVersionIn);\n+        NetMessageBase::SetVersion(nVersionIn);\n+    }\n+\n+    int read(const char* pch, unsigned int nBytes);\n+    int readHeader(const char* pch, unsigned int nBytes);\n+    int readData(const char* pch, unsigned int nBytes);\n+\n+    bool verifyMessageStart() const;\n+    bool verifyHeader() const;\n+    bool verifyChecksum(std::string& error) const;\n+};\n+\n+typedef std::shared_ptr<NetMessageBase> NetMessageBaseRef;\n+typedef std::shared_ptr<NetMessage> NetMessageRef;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212838803",
      "id" : 212838803,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzODgwMw==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 113,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 149549535,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212838803",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa, @gmaxwell:\r\nThe reason why I used `shared_ptr` over `unique_ptr` is the polymorphism I'd like to use for the net messages and I once read that `shared_ptr` are recommended for polymorphic inheritance.\r\n\r\nHowever, I changed this PR now to use `unique_ptr`.\r\n\r\nThanks @251Labs for the review, implemented all your suggestions.",
      "created_at" : "2018-08-27T11:19:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-416194874",
      "id" : 416194874,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNjE5NDg3NA==",
      "updated_at" : "2018-08-27T11:19:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416194874",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212945210"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212945210"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-27T11:34:02Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r212945210",
      "id" : 212945210,
      "in_reply_to_id" : 212838045,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjk0NTIxMA==",
      "original_commit_id" : "59a7ce0f9de950b64c5e89dd29ebcd0b607b982e",
      "original_position" : 18,
      "path" : "src/net_message.h",
      "position" : 18,
      "pull_request_review_id" : 149674956,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212945210",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r213513348"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213513348"
         }
      },
      "author_association" : "MEMBER",
      "body" : "could move to init list `, nTime(0)`.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-08-29T00:29:20Z",
      "diff_hunk" : "@@ -567,9 +567,40 @@ class CNodeStats\n };\n \n \n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r213513348",
      "id" : 213513348,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMzUxMzM0OA==",
      "original_commit_id" : "df048171817f4004ec4ebbffacb412edfc1b6d15",
      "original_position" : 13,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 150365750,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213513348",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fixed commit message issue reported by @promag ",
      "created_at" : "2018-08-31T19:51:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-417772232",
      "id" : 417772232,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNzc3MjIzMg==",
      "updated_at" : "2018-08-31T19:51:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/417772232",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r214522463"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214522463"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: could be private",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-01T20:28:14Z",
      "diff_hunk" : "@@ -681,6 +633,7 @@ class CNode\n \n     mapMsgCmdSize mapSendBytesPerMsgCmd;\n     mapMsgCmdSize mapRecvBytesPerMsgCmd;\n+    void RecordRecvBytesPerMsgCmd(const std::string& cmd, uint32_t bytes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r214522463",
      "id" : 214522463,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUyMjQ2Mw==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 93,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 151602763,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214522463",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r214523034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214523034"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems these other `hdr` accesses be guarded against `!in_data`, as they're relatively uninitialized data in that case, e.g.`nMessageSize` could be `-1`.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-01T21:06:04Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string GetCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    virtual void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int Read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool VerifyMessageStart() const = 0;\n+    virtual bool VerifyHeader() const = 0;\n+    virtual bool VerifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message for the currently used unencryted p2p communication\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+public:\n+    bool in_data;                   // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf;             // partially received header\n+    CMessageHeader hdr;             // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool Complete() const override\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t GetMessageSize() const override\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t GetMessageSizeWithHeader() const override\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r214523034",
      "id" : 214523034,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUyMzAzNA==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 87,
      "path" : "src/net_message.h",
      "position" : 87,
      "pull_request_review_id" : 151603377,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214523034",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r214764425"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214764425"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@Empact looks like that would be a bad call, maybe `assert(in_data)` or `hdr.nMessageSize >= 0`?",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-04T00:18:15Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string GetCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    virtual void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int Read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool VerifyMessageStart() const = 0;\n+    virtual bool VerifyHeader() const = 0;\n+    virtual bool VerifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message for the currently used unencryted p2p communication\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+public:\n+    bool in_data;                   // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf;             // partially received header\n+    CMessageHeader hdr;             // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool Complete() const override\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t GetMessageSize() const override\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t GetMessageSizeWithHeader() const override\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r214764425",
      "id" : 214764425,
      "in_reply_to_id" : 214523034,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDc2NDQyNQ==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 87,
      "path" : "src/net_message.h",
      "position" : 87,
      "pull_request_review_id" : 151884050,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214764425",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r216404877"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216404877"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\nsrc/net_message.cpp:78:108: warning: redundant boolean literal in ternary expression result [readability-simplify-boolean-expr]\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-10T17:20:45Z",
      "diff_hunk" : "@@ -0,0 +1,96 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <net_message.h>\n+\n+#include <chainparams.h>\n+#include <tinyformat.h>\n+#include <utilstrencodings.h>\n+\n+int NetMessage::Read(const char* pch, unsigned int nBytes)\n+{\n+    return in_data ? ReadData(pch, nBytes) : ReadHeader(pch, nBytes);\n+}\n+\n+int NetMessage::ReadHeader(const char* pch, unsigned int nBytes)\n+{\n+    // copy data to temporary parsing buffer\n+    unsigned int nRemaining = 24 - nHdrPos;\n+    unsigned int nCopy = std::min(nRemaining, nBytes);\n+\n+    memcpy(&hdrbuf[nHdrPos], pch, nCopy);\n+    nHdrPos += nCopy;\n+\n+    // if header incomplete, exit\n+    if (nHdrPos < 24)\n+        return nCopy;\n+\n+    // deserialize to CMessageHeader\n+    try {\n+        hdrbuf >> hdr;\n+    }\n+    catch (const std::exception&) {\n+        return -1;\n+    }\n+\n+    // reject messages larger than MAX_SIZE\n+    if (hdr.nMessageSize > MAX_SIZE)\n+        return -1;\n+\n+    // switch state to reading message data\n+    in_data = true;\n+\n+    return nCopy;\n+}\n+\n+int NetMessage::ReadData(const char* pch, unsigned int nBytes)\n+{\n+    unsigned int nRemaining = hdr.nMessageSize - nDataPos;\n+    unsigned int nCopy = std::min(nRemaining, nBytes);\n+\n+    if (vRecv.size() < nDataPos + nCopy) {\n+        // Allocate up to 256 KiB ahead, but never more than the total message size.\n+        vRecv.resize(std::min(hdr.nMessageSize, nDataPos + nCopy + 256 * 1024));\n+    }\n+\n+    hasher.Write((const unsigned char*)pch, nCopy);\n+    memcpy(&vRecv[nDataPos], pch, nCopy);\n+    nDataPos += nCopy;\n+\n+    return nCopy;\n+}\n+\n+const uint256& NetMessage::GetMessageHash() const\n+{\n+    assert(Complete());\n+    if (data_hash.IsNull())\n+        hasher.Finalize(data_hash.begin());\n+    return data_hash;\n+}\n+\n+bool NetMessage::VerifyMessageStart() const\n+{\n+    return memcmp(hdr.pchMessageStart, Params().MessageStart(), CMessageHeader::MESSAGE_START_SIZE) == 0 ? true : false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r216404877",
      "id" : 216404877,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNjQwNDg3Nw==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 78,
      "path" : "src/net_message.cpp",
      "position" : null,
      "pull_request_review_id" : 153877570,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216404877",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r216405058"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216405058"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\nsrc/net_message.cpp:61:18: warning: C-style casts are discouraged; use reinterpret_cast [google-readability-casting]\r\nsrc/net_message.cpp:61:18: warning: do not use C-style cast to convert between unrelated types [cppcoreguidelines-pro-type-cstyle-cast]\r\n```",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-10T17:21:16Z",
      "diff_hunk" : "@@ -0,0 +1,96 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <net_message.h>\n+\n+#include <chainparams.h>\n+#include <tinyformat.h>\n+#include <utilstrencodings.h>\n+\n+int NetMessage::Read(const char* pch, unsigned int nBytes)\n+{\n+    return in_data ? ReadData(pch, nBytes) : ReadHeader(pch, nBytes);\n+}\n+\n+int NetMessage::ReadHeader(const char* pch, unsigned int nBytes)\n+{\n+    // copy data to temporary parsing buffer\n+    unsigned int nRemaining = 24 - nHdrPos;\n+    unsigned int nCopy = std::min(nRemaining, nBytes);\n+\n+    memcpy(&hdrbuf[nHdrPos], pch, nCopy);\n+    nHdrPos += nCopy;\n+\n+    // if header incomplete, exit\n+    if (nHdrPos < 24)\n+        return nCopy;\n+\n+    // deserialize to CMessageHeader\n+    try {\n+        hdrbuf >> hdr;\n+    }\n+    catch (const std::exception&) {\n+        return -1;\n+    }\n+\n+    // reject messages larger than MAX_SIZE\n+    if (hdr.nMessageSize > MAX_SIZE)\n+        return -1;\n+\n+    // switch state to reading message data\n+    in_data = true;\n+\n+    return nCopy;\n+}\n+\n+int NetMessage::ReadData(const char* pch, unsigned int nBytes)\n+{\n+    unsigned int nRemaining = hdr.nMessageSize - nDataPos;\n+    unsigned int nCopy = std::min(nRemaining, nBytes);\n+\n+    if (vRecv.size() < nDataPos + nCopy) {\n+        // Allocate up to 256 KiB ahead, but never more than the total message size.\n+        vRecv.resize(std::min(hdr.nMessageSize, nDataPos + nCopy + 256 * 1024));\n+    }\n+\n+    hasher.Write((const unsigned char*)pch, nCopy);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r216405058",
      "id" : 216405058,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNjQwNTA1OA==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 61,
      "path" : "src/net_message.cpp",
      "position" : 61,
      "pull_request_review_id" : 153877784,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216405058",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218327617"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218327617"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I basically moved this code part... I think its fine.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-18T07:43:02Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string GetCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    virtual void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int Read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool VerifyMessageStart() const = 0;\n+    virtual bool VerifyHeader() const = 0;\n+    virtual bool VerifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message for the currently used unencryted p2p communication\n+class NetMessage : public NetMessageBase\n+{\n+private:\n+    mutable CHash256 hasher;\n+    mutable uint256 data_hash;\n+public:\n+    bool in_data;                   // parsing header (false) or data (true)\n+\n+    CDataStream hdrbuf;             // partially received header\n+    CMessageHeader hdr;             // complete header\n+    unsigned int nHdrPos;\n+\n+    unsigned int nDataPos;\n+\n+    NetMessage(const CMessageHeader::MessageStartChars& pchMessageStartIn, int nTypeIn, int nVersionIn) : NetMessageBase(nTypeIn, nVersionIn), hdrbuf(nTypeIn, nVersionIn), hdr(pchMessageStartIn)\n+    {\n+        hdrbuf.resize(24);\n+        in_data = false;\n+        nHdrPos = 0;\n+        nDataPos = 0;\n+    }\n+\n+    bool Complete() const override\n+    {\n+        if (!in_data)\n+            return false;\n+        return (hdr.nMessageSize == nDataPos);\n+    }\n+\n+    uint32_t GetMessageSize() const override\n+    {\n+        if (!in_data) {\n+            return 0;\n+        }\n+        return hdr.nMessageSize;\n+    }\n+\n+    uint32_t GetMessageSizeWithHeader() const override\n+    {\n+        return hdr.nMessageSize + CMessageHeader::HEADER_SIZE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218327617",
      "id" : 218327617,
      "in_reply_to_id" : 214523034,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODMyNzYxNw==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 87,
      "path" : "src/net_message.h",
      "position" : 87,
      "pull_request_review_id" : 156238232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218327617",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218328681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218328681"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's moved code and the scope of this PR is not refactor.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-18T07:47:06Z",
      "diff_hunk" : "@@ -0,0 +1,96 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <net_message.h>\n+\n+#include <chainparams.h>\n+#include <tinyformat.h>\n+#include <utilstrencodings.h>\n+\n+int NetMessage::Read(const char* pch, unsigned int nBytes)\n+{\n+    return in_data ? ReadData(pch, nBytes) : ReadHeader(pch, nBytes);\n+}\n+\n+int NetMessage::ReadHeader(const char* pch, unsigned int nBytes)\n+{\n+    // copy data to temporary parsing buffer\n+    unsigned int nRemaining = 24 - nHdrPos;\n+    unsigned int nCopy = std::min(nRemaining, nBytes);\n+\n+    memcpy(&hdrbuf[nHdrPos], pch, nCopy);\n+    nHdrPos += nCopy;\n+\n+    // if header incomplete, exit\n+    if (nHdrPos < 24)\n+        return nCopy;\n+\n+    // deserialize to CMessageHeader\n+    try {\n+        hdrbuf >> hdr;\n+    }\n+    catch (const std::exception&) {\n+        return -1;\n+    }\n+\n+    // reject messages larger than MAX_SIZE\n+    if (hdr.nMessageSize > MAX_SIZE)\n+        return -1;\n+\n+    // switch state to reading message data\n+    in_data = true;\n+\n+    return nCopy;\n+}\n+\n+int NetMessage::ReadData(const char* pch, unsigned int nBytes)\n+{\n+    unsigned int nRemaining = hdr.nMessageSize - nDataPos;\n+    unsigned int nCopy = std::min(nRemaining, nBytes);\n+\n+    if (vRecv.size() < nDataPos + nCopy) {\n+        // Allocate up to 256 KiB ahead, but never more than the total message size.\n+        vRecv.resize(std::min(hdr.nMessageSize, nDataPos + nCopy + 256 * 1024));\n+    }\n+\n+    hasher.Write((const unsigned char*)pch, nCopy);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218328681",
      "id" : 218328681,
      "in_reply_to_id" : 216405058,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODMyODY4MQ==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 61,
      "path" : "src/net_message.cpp",
      "position" : 61,
      "pull_request_review_id" : 156239572,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218328681",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218329111"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218329111"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-18T07:48:48Z",
      "diff_hunk" : "@@ -0,0 +1,96 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <net_message.h>\n+\n+#include <chainparams.h>\n+#include <tinyformat.h>\n+#include <utilstrencodings.h>\n+\n+int NetMessage::Read(const char* pch, unsigned int nBytes)\n+{\n+    return in_data ? ReadData(pch, nBytes) : ReadHeader(pch, nBytes);\n+}\n+\n+int NetMessage::ReadHeader(const char* pch, unsigned int nBytes)\n+{\n+    // copy data to temporary parsing buffer\n+    unsigned int nRemaining = 24 - nHdrPos;\n+    unsigned int nCopy = std::min(nRemaining, nBytes);\n+\n+    memcpy(&hdrbuf[nHdrPos], pch, nCopy);\n+    nHdrPos += nCopy;\n+\n+    // if header incomplete, exit\n+    if (nHdrPos < 24)\n+        return nCopy;\n+\n+    // deserialize to CMessageHeader\n+    try {\n+        hdrbuf >> hdr;\n+    }\n+    catch (const std::exception&) {\n+        return -1;\n+    }\n+\n+    // reject messages larger than MAX_SIZE\n+    if (hdr.nMessageSize > MAX_SIZE)\n+        return -1;\n+\n+    // switch state to reading message data\n+    in_data = true;\n+\n+    return nCopy;\n+}\n+\n+int NetMessage::ReadData(const char* pch, unsigned int nBytes)\n+{\n+    unsigned int nRemaining = hdr.nMessageSize - nDataPos;\n+    unsigned int nCopy = std::min(nRemaining, nBytes);\n+\n+    if (vRecv.size() < nDataPos + nCopy) {\n+        // Allocate up to 256 KiB ahead, but never more than the total message size.\n+        vRecv.resize(std::min(hdr.nMessageSize, nDataPos + nCopy + 256 * 1024));\n+    }\n+\n+    hasher.Write((const unsigned char*)pch, nCopy);\n+    memcpy(&vRecv[nDataPos], pch, nCopy);\n+    nDataPos += nCopy;\n+\n+    return nCopy;\n+}\n+\n+const uint256& NetMessage::GetMessageHash() const\n+{\n+    assert(Complete());\n+    if (data_hash.IsNull())\n+        hasher.Finalize(data_hash.begin());\n+    return data_hash;\n+}\n+\n+bool NetMessage::VerifyMessageStart() const\n+{\n+    return memcmp(hdr.pchMessageStart, Params().MessageStart(), CMessageHeader::MESSAGE_START_SIZE) == 0 ? true : false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218329111",
      "id" : 218329111,
      "in_reply_to_id" : 216404877,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODMyOTExMQ==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 78,
      "path" : "src/net_message.cpp",
      "position" : null,
      "pull_request_review_id" : 156240152,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218329111",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218330036"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218330036"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-18T07:52:44Z",
      "diff_hunk" : "@@ -681,6 +633,7 @@ class CNode\n \n     mapMsgCmdSize mapSendBytesPerMsgCmd;\n     mapMsgCmdSize mapRecvBytesPerMsgCmd;\n+    void RecordRecvBytesPerMsgCmd(const std::string& cmd, uint32_t bytes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218330036",
      "id" : 218330036,
      "in_reply_to_id" : 214522463,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODMzMDAzNg==",
      "original_commit_id" : "689e20ddc505271f9b96af1bbb203bd6ee7e2151",
      "original_position" : 93,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 156241392,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218330036",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218463709"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218463709"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: missing space after `//` ?",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-18T14:47:20Z",
      "diff_hunk" : "@@ -567,9 +567,40 @@ class CNodeStats\n };\n \n \n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n \n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218463709",
      "id" : 218463709,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODQ2MzcwOQ==",
      "original_commit_id" : "1d294afb9f63b16a71fec4c282e9f37282bf7e6a",
      "original_position" : 18,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 156407372,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218463709",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218485000"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218485000"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could be `(*it)->Complete()` instead, but maybe what you've got is already clearer?",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-18T15:38:01Z",
      "diff_hunk" : "@@ -1372,9 +1306,9 @@ void CConnman::ThreadSocketHandler()\n                         size_t nSizeAdded = 0;\n                         auto it(pnode->vRecvMsg.begin());\n                         for (; it != pnode->vRecvMsg.end(); ++it) {\n-                            if (!it->complete())\n+                            if (!it->get()->Complete())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r218485000",
      "id" : 218485000,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODQ4NTAwMA==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 146,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 156407372,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218485000",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691342"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691342"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n2018-09-22 21:22:44 cpplint(pr=14046): src/net_message.h:30:  Should have a space between // and comment  [whitespace/comments] [4]\r\n```",
      "commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "created_at" : "2018-09-23T08:04:20Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691342",
      "id" : 219691342,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY5MTM0Mg==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 30,
      "path" : "src/net_message.h",
      "position" : 30,
      "pull_request_review_id" : 157931934,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2018-09-23T08:04:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691342",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691345"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691345"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n2018-09-22 21:22:44 cpplint(pr=14046): src/net_message.h:31:  Should have a space between // and comment  [whitespace/comments] [4]\r\n```",
      "commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "created_at" : "2018-09-23T08:04:32Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691345",
      "id" : 219691345,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY5MTM0NQ==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 31,
      "path" : "src/net_message.h",
      "position" : 31,
      "pull_request_review_id" : 157931938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2018-09-23T08:04:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691345",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691348"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691348"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n2018-09-22 21:22:44 cpplint(pr=14046): src/net_message.h:33:  Should have a space between // and comment  [whitespace/comments] [4]\r\n```",
      "commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "created_at" : "2018-09-23T08:04:44Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string GetCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691348",
      "id" : 219691348,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY5MTM0OA==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 33,
      "path" : "src/net_message.h",
      "position" : 33,
      "pull_request_review_id" : 157931942,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2018-09-23T08:04:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691348",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691353"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691353"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n2018-09-22 21:22:44 cpplint(pr=14046): src/net_message.h:40:  Should have a space between // and comment  [whitespace/comments] [4]\r\n```",
      "commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "created_at" : "2018-09-23T08:04:58Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string GetCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    virtual void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int Read(const char* pch, unsigned int nBytes) = 0; //parse bytes",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691353",
      "id" : 219691353,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY5MTM1Mw==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 40,
      "path" : "src/net_message.h",
      "position" : 40,
      "pull_request_review_id" : 157931947,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2018-09-23T08:04:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691353",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691376"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691376"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n2018-09-22 21:22:44 cpplint(pr=14046): src/net_message.h:47:  Should have a space between // and comment  [whitespace/comments] [4]\r\n```",
      "commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "created_at" : "2018-09-23T08:06:06Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string GetCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    virtual void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int Read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool VerifyMessageStart() const = 0;\n+    virtual bool VerifyHeader() const = 0;\n+    virtual bool VerifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message for the currently used unencryted p2p communication",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r219691376",
      "id" : 219691376,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY5MTM3Ng==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 47,
      "path" : "src/net_message.h",
      "position" : 47,
      "pull_request_review_id" : 157931977,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2018-09-23T08:06:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219691376",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220588444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220588444"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, `int64_t nTime{0};` and remove from the constructor.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-26T14:33:02Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220588444",
      "id" : 220588444,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDU4ODQ0NA==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 21,
      "path" : "src/net_message.h",
      "position" : 21,
      "pull_request_review_id" : 159029265,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220588444",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220705364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220705364"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "That's a nice nit @promag. Alternatively, `nTime` can be initialized with an empty initializer list `int64_t nTime {};`",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-26T20:07:07Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220705364",
      "id" : 220705364,
      "in_reply_to_id" : 220588444,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDcwNTM2NA==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 21,
      "path" : "src/net_message.h",
      "position" : 21,
      "pull_request_review_id" : 159176066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220705364",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13120787?v=4",
         "events_url" : "https://api.github.com/users/251Labs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/251Labs/followers",
         "following_url" : "https://api.github.com/users/251Labs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/251Labs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/251Labs",
         "id" : 13120787,
         "login" : "251Labs",
         "node_id" : "MDQ6VXNlcjEzMTIwNzg3",
         "organizations_url" : "https://api.github.com/users/251Labs/orgs",
         "received_events_url" : "https://api.github.com/users/251Labs/received_events",
         "repos_url" : "https://api.github.com/users/251Labs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/251Labs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/251Labs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/251Labs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220762330"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220762330"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I see the magic constant `24` here quite a bit. Would it be useful to extract this into an appropriately named constant? Perhaps `HEADER_NUM_BYTES` or equivalent?",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-27T00:23:25Z",
      "diff_hunk" : "@@ -0,0 +1,96 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <net_message.h>\n+\n+#include <chainparams.h>\n+#include <tinyformat.h>\n+#include <utilstrencodings.h>\n+\n+int NetMessage::Read(const char* pch, unsigned int nBytes)\n+{\n+    return in_data ? ReadData(pch, nBytes) : ReadHeader(pch, nBytes);\n+}\n+\n+int NetMessage::ReadHeader(const char* pch, unsigned int nBytes)\n+{\n+    // copy data to temporary parsing buffer\n+    unsigned int nRemaining = 24 - nHdrPos;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220762330",
      "id" : 220762330,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDc2MjMzMA==",
      "original_commit_id" : "f412d345039e7bb2888dd93f3139561f3c17a227",
      "original_position" : 23,
      "path" : "src/net_message.cpp",
      "position" : 23,
      "pull_request_review_id" : 159246276,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220762330",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/69561?v=4",
         "events_url" : "https://api.github.com/users/etscrivner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/etscrivner/followers",
         "following_url" : "https://api.github.com/users/etscrivner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/etscrivner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/etscrivner",
         "id" : 69561,
         "login" : "etscrivner",
         "node_id" : "MDQ6VXNlcjY5NTYx",
         "organizations_url" : "https://api.github.com/users/etscrivner/orgs",
         "received_events_url" : "https://api.github.com/users/etscrivner/received_events",
         "repos_url" : "https://api.github.com/users/etscrivner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/etscrivner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/etscrivner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/etscrivner"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "utACK c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "created_at" : "2018-09-27T01:13:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-424921952",
      "id" : 424921952,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNDkyMTk1Mg==",
      "updated_at" : "2018-09-27T01:13:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424921952",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/69561?v=4",
         "events_url" : "https://api.github.com/users/etscrivner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/etscrivner/followers",
         "following_url" : "https://api.github.com/users/etscrivner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/etscrivner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/etscrivner",
         "id" : 69561,
         "login" : "etscrivner",
         "node_id" : "MDQ6VXNlcjY5NTYx",
         "organizations_url" : "https://api.github.com/users/etscrivner/orgs",
         "received_events_url" : "https://api.github.com/users/etscrivner/received_events",
         "repos_url" : "https://api.github.com/users/etscrivner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/etscrivner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/etscrivner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/etscrivner"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220845678"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220845678"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree. Though I'd say scope of the PR is not to refactor code parts that where moved 1:1. Lets do further refactors in another PR.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-27T09:02:25Z",
      "diff_hunk" : "@@ -0,0 +1,96 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#include <net_message.h>\n+\n+#include <chainparams.h>\n+#include <tinyformat.h>\n+#include <utilstrencodings.h>\n+\n+int NetMessage::Read(const char* pch, unsigned int nBytes)\n+{\n+    return in_data ? ReadData(pch, nBytes) : ReadHeader(pch, nBytes);\n+}\n+\n+int NetMessage::ReadHeader(const char* pch, unsigned int nBytes)\n+{\n+    // copy data to temporary parsing buffer\n+    unsigned int nRemaining = 24 - nHdrPos;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220845678",
      "id" : 220845678,
      "in_reply_to_id" : 220762330,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDg0NTY3OA==",
      "original_commit_id" : "f412d345039e7bb2888dd93f3139561f3c17a227",
      "original_position" : 23,
      "path" : "src/net_message.cpp",
      "position" : 23,
      "pull_request_review_id" : 159347489,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220845678",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220845723"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220845723"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agree. Though I'd say scope of the PR is not to refactor code parts that where moved 1:1. Lets do further refactors in another PR.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-27T09:02:33Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220845723",
      "id" : 220845723,
      "in_reply_to_id" : 220588444,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDg0NTcyMw==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 21,
      "path" : "src/net_message.h",
      "position" : 21,
      "pull_request_review_id" : 159347549,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220845723",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220846998"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220846998"
         }
      },
      "author_association" : "MEMBER",
      "body" : "SGTM.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-09-27T09:06:55Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r220846998",
      "id" : 220846998,
      "in_reply_to_id" : 220588444,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDg0Njk5OA==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 21,
      "path" : "src/net_message.h",
      "position" : 21,
      "pull_request_review_id" : 159349174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220846998",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "ACK c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "created_at" : "2018-09-27T15:34:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-425138702",
      "id" : 425138702,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNTEzODcwMg==",
      "updated_at" : "2018-09-27T15:34:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425138702",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/69561?v=4",
         "events_url" : "https://api.github.com/users/etscrivner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/etscrivner/followers",
         "following_url" : "https://api.github.com/users/etscrivner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/etscrivner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/etscrivner",
         "id" : 69561,
         "login" : "etscrivner",
         "node_id" : "MDQ6VXNlcjY5NTYx",
         "organizations_url" : "https://api.github.com/users/etscrivner/orgs",
         "received_events_url" : "https://api.github.com/users/etscrivner/received_events",
         "repos_url" : "https://api.github.com/users/etscrivner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/etscrivner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/etscrivner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/etscrivner"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r225694659"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225694659"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should be \"unencrypted\" :-)",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-10-16T20:22:59Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string GetCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    virtual void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int Read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool VerifyMessageStart() const = 0;\n+    virtual bool VerifyHeader() const = 0;\n+    virtual bool VerifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message for the currently used unencryted p2p communication",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r225694659",
      "id" : 225694659,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY5NDY1OQ==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 47,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 165350839,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225694659",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r225956420"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225956420"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "c5816dcee369610ec8449032f339a11c426fb0dd",
      "created_at" : "2018-10-17T14:34:13Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_NET_MESSAGE_H\n+#define BITCOIN_NET_MESSAGE_H\n+\n+#include <hash.h>\n+#include <protocol.h>\n+#include <streams.h>\n+#include <uint256.h>\n+\n+/** Maximum length of incoming protocol messages (no message over 4 MB is currently acceptable). */\n+static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n+\n+// base class for format agnostic network messages\n+class NetMessageBase\n+{\n+public:\n+    CDataStream vRecv; // received message data\n+    int64_t nTime;     // time (in microseconds) of message receipt.\n+\n+    NetMessageBase(int nTypeIn, int nVersionIn) : vRecv(nTypeIn, nVersionIn)\n+    {\n+        nTime = 0;\n+    }\n+    virtual ~NetMessageBase() {}\n+\n+    virtual bool Complete() const = 0;\n+    virtual uint32_t GetMessageSize() const = 0;           //returns 0 when message has not yet been parsed\n+    virtual uint32_t GetMessageSizeWithHeader() const = 0; //return complete message size including header\n+\n+    virtual std::string GetCommandName() const = 0; //returns the command name. Returns an empty string when no command name is supported\n+\n+    virtual void SetVersion(int nVersionIn)\n+    {\n+        vRecv.SetVersion(nVersionIn);\n+    }\n+\n+    virtual int Read(const char* pch, unsigned int nBytes) = 0; //parse bytes\n+\n+    virtual bool VerifyMessageStart() const = 0;\n+    virtual bool VerifyHeader() const = 0;\n+    virtual bool VerifyChecksum(std::string& error) const = 0;\n+};\n+\n+//basic network message for the currently used unencryted p2p communication",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#discussion_r225956420",
      "id" : 225956420,
      "in_reply_to_id" : 225694659,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTk1NjQyMA==",
      "original_commit_id" : "c2f9c04583a3ffcae4a54d85bb49def58e79cef2",
      "original_position" : 47,
      "path" : "src/net_message.h",
      "position" : null,
      "pull_request_review_id" : 165664564,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
      "updated_at" : "2019-05-20T09:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225956420",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased.",
      "created_at" : "2018-10-17T14:34:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-430653486",
      "id" : 430653486,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMDY1MzQ4Ng==",
      "updated_at" : "2018-10-17T14:34:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430653486",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK c2f9c04.",
      "created_at" : "2018-10-19T07:14:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-431267791",
      "id" : 431267791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMTI2Nzc5MQ==",
      "updated_at" : "2018-10-19T07:14:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431267791",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is it really necessary to make `CNetMessage` a virtual class? This seems very much overkill. Only the network deserializers should change based on what protocol is used; we don't need to have that variability put a burden on every separate message.\r\n\r\nSeems like you could just create a CNetMessageSerializer class (with different instances), to which some of the current `CNetMessage` logic is moved. This class is then responsible for turning the network byte stream into packets, and the other way around, but the `CNetMessage` objects remain independent of the protocol used.",
      "created_at" : "2018-10-19T23:43:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-431528330",
      "id" : 431528330,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzMTUyODMzMA==",
      "updated_at" : "2018-10-19T23:48:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431528330",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jonasschnelli Mind to follow up on @sipa's question? I have removed this from high priority for now, but happy to add back when you addressed the question.",
      "created_at" : "2018-11-07T20:07:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-436759974",
      "id" : 436759974,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzNjc1OTk3NA==",
      "updated_at" : "2018-11-07T20:07:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436759974",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2018-11-28T16:41:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-442515883",
      "id" : 442515883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MjUxNTg4Mw==",
      "updated_at" : "2018-11-28T16:41:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/442515883",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-04-04T21:41:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-480074132",
      "id" : 480074132,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MDA3NDEzMg==",
      "updated_at" : "2019-04-04T21:41:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/480074132",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2019-05-20T09:53:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-493917759",
      "id" : 493917759,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5MzkxNzc1OQ==",
      "updated_at" : "2019-05-20T09:53:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/493917759",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Approach NACK. This is overkill; the message parsing/serializing logic can just move out of CNetMessage to avoid turning it into a virtual class.",
      "created_at" : "2019-05-20T18:56:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-494109722",
      "id" : 494109722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5NDEwOTcyMg==",
      "updated_at" : "2019-05-20T18:56:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/494109722",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sipa: Thanks for the review. Currently turning this into the approach you mentioned. I think it's doable though not super convinced right now due to the state necessary in parsing/serialization (hash, MAC).\r\nUntil I'm finished I keep this rebased to not lose testability of other elements in the pipeline.",
      "created_at" : "2019-05-20T19:04:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-494112431",
      "id" : 494112431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5NDExMjQzMQ==",
      "updated_at" : "2019-05-20T19:04:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/494112431",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "#16202 seems to a superior solution. Will close this PR as soon as #14032 is rebased on top of #16202.",
      "created_at" : "2019-06-13T10:01:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-501637062",
      "id" : 501637062,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwMTYzNzA2Mg==",
      "updated_at" : "2019-06-13T10:01:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/501637062",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-08-14T16:21:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-521316508",
      "id" : 521316508,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyMTMxNjUwOA==",
      "updated_at" : "2019-08-14T16:21:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/521316508",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Superseded. Closing.",
      "created_at" : "2020-05-07T07:38:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14046#issuecomment-625085988",
      "id" : 625085988,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNTA4NTk4OA==",
      "updated_at" : "2020-05-07T07:38:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/625085988",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
