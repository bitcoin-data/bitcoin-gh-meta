[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->No more conflicts as of last run.",
      "created_at" : "2018-08-22T14:56:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415061817",
      "id" : 415061817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTA2MTgxNw==",
      "updated_at" : "2018-08-23T18:33:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415061817",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-08-23T08:06:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415329237",
      "id" : 415329237,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTMyOTIzNw==",
      "updated_at" : "2018-08-23T08:06:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415329237",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK asserting on the contents of the debug log, but I don't understand why a new RPC method is needed. Why not read the debug log file directly?",
      "created_at" : "2018-08-23T14:04:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415425607",
      "id" : 415425607,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTQyNTYwNw==",
      "updated_at" : "2018-08-23T14:04:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415425607",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery I don't think it is possible to read from a file that is opened for writing on windows with python.",
      "created_at" : "2018-08-23T14:09:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415427103",
      "id" : 415427103,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTQyNzEwMw==",
      "updated_at" : "2018-08-23T14:09:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415427103",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I don't think it is possible to read from a file that is opened for writing on windows with python.\r\n\r\nI'm NACKish on this. I don't think we should be adding code to the product to work around a limitation in the test framework on a specific platform.",
      "created_at" : "2018-08-23T14:11:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415428006",
      "id" : 415428006,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTQyODAwNg==",
      "updated_at" : "2018-08-23T14:11:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415428006",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Removed rpc",
      "created_at" : "2018-08-23T15:29:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415459885",
      "id" : 415459885,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTQ1OTg4NQ==",
      "updated_at" : "2018-08-23T15:29:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415459885",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. \r\nSeems like you've solve the problem on Windows, I'm able to pass p2p_invalid_tx test on Windows",
      "created_at" : "2018-08-24T03:51:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415643158",
      "id" : 415643158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTY0MzE1OA==",
      "updated_at" : "2018-08-24T03:54:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415643158",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212662890"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212662890"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Passing in an escaped string means that the printed assert when this fails looks a bit weird, but no big deal:\r\n\r\n```\r\n    raise AssertionError(self._node_msg(msg))\r\nAssertionError: [node 0] Expected message \"8d7190866370e089916899a483a8df5ce7b495b04ffefc841ecd0d5779e9a0ca\\ asdf\\ from\\ peer\\=0\\ was\\ not\\ accepted\\:\\ mandatory\\-script\\-verify\\-flag\\-failed\\ \\(Invalid\\ OP_IF\\ construction\\)\\ \\(code\\ 16\\)\" does not partially match log:\r\n```",
      "commit_id" : "fa3e9f7627784ee00980590e5bf044a0e1249999",
      "created_at" : "2018-08-24T15:17:41Z",
      "diff_hunk" : "@@ -136,11 +139,16 @@ def run_test(self):\n \n         # restart node with sending BIP61 messages disabled, check that it disconnects without sending the reject message\n         self.log.info('Test a transaction that is rejected, with BIP61 disabled')\n-        self.restart_node(0, ['-enablebip61=0','-persistmempool=0'])\n+        self.restart_node(0, ['-enablebip61=0', '-persistmempool=0'])\n         self.reconnect_p2p(num_connections=1)\n-        node.p2p.send_txs_and_test([tx1], node, success=False, expect_disconnect=True)\n+        with node.assert_debug_log(expected_msgs=[\n+                re.escape(\"{} from peer=0 was not accepted: mandatory-script-verify-flag-failed (Invalid OP_IF construction) (code 16)\".format(tx1.hash)),\n+                re.escape(\"disconnecting peer=0\"),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212662890",
      "id" : 212662890,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjY2Mjg5MA==",
      "original_commit_id" : "fa5a71a1498f6934e3d30499c1e17e01903f5659",
      "original_position" : 20,
      "path" : "test/functional/p2p_invalid_tx.py",
      "position" : null,
      "pull_request_review_id" : 149346611,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024",
      "updated_at" : "2018-08-24T16:30:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212662890",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212664304"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212664304"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Printing the log excerpt out in the assert is a bit confusing for anything that's parsing the test_framework log (since the timestamps at the start of the line will be interpreted as new log lines. Can I convince you to make the following change:\r\n\r\n```\r\n@@ -242,9 +242,10 @@ class TestNode():\r\n             with open(debug_log, encoding='utf-8') as dl:\r\n                 dl.seek(prev_size)\r\n                 log = dl.read()\r\n+                print_log = \" - \" + \"\\n - \".join(log.splitlines())\r\n             for expected_msg in expected_msgs:\r\n                 if re.search(expected_msg, log, flags=re.MULTILINE) is None:\r\n-                    self._raise_assertion_error('Expected message \"{}\" does not partially match log:\\n\"{}\"\\n'.format(expected_msg, log))\r\n+                    self._raise_assertion_error('Expected message \"{}\" does not partially match log:\\n\\n{}\\n\\n'.format(expected_msg, print_log))\r\n```\r\n\r\nso that the printed log lines are prefixed with ` - `.\r\n\r\nI'd also be tempted to add a hint like:\r\n\r\n```\r\n        self.log.error(\"Expected Log not raised. Check that bitcoind log format output has not changed!\")\r\n```\r\n\r\nChanges to logging that cause tests to fail can be really annoying, so adding a hint is a friendly thing to do here.",
      "commit_id" : "fa3e9f7627784ee00980590e5bf044a0e1249999",
      "created_at" : "2018-08-24T15:21:52Z",
      "diff_hunk" : "@@ -229,6 +230,22 @@ def is_node_stopped(self):\n     def wait_until_stopped(self, timeout=BITCOIND_PROC_WAIT_TIMEOUT):\n         wait_until(self.is_node_stopped, timeout=timeout)\n \n+    @contextlib.contextmanager\n+    def assert_debug_log(self, expected_msgs):\n+        debug_log = os.path.join(self.datadir, 'regtest', 'debug.log')\n+        with open(debug_log, encoding='utf-8') as dl:\n+            dl.seek(0, 2)\n+            prev_size = dl.tell()\n+        try:\n+            yield\n+        finally:\n+            with open(debug_log, encoding='utf-8') as dl:\n+                dl.seek(prev_size)\n+                log = dl.read()\n+            for expected_msg in expected_msgs:\n+                if re.search(expected_msg, log, flags=re.MULTILINE) is None:\n+                    self._raise_assertion_error('Expected message \"{}\" does not partially match log:\\n\"{}\"\\n'.format(expected_msg, log))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212664304",
      "id" : 212664304,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjY2NDMwNA==",
      "original_commit_id" : "fa5a71a1498f6934e3d30499c1e17e01903f5659",
      "original_position" : 26,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 149346611,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024",
      "updated_at" : "2018-08-24T16:30:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212664304",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ping @ryanofsky for review",
      "created_at" : "2018-08-24T15:56:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415802607",
      "id" : 415802607,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTgwMjYwNw==",
      "updated_at" : "2018-08-24T15:56:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415802607",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212693677"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212693677"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Might be more efficient to move this line before the `_raise_assertion_error` call in case the variable is unused.",
      "commit_id" : "fa3e9f7627784ee00980590e5bf044a0e1249999",
      "created_at" : "2018-08-24T17:07:52Z",
      "diff_hunk" : "@@ -229,6 +230,23 @@ def is_node_stopped(self):\n     def wait_until_stopped(self, timeout=BITCOIND_PROC_WAIT_TIMEOUT):\n         wait_until(self.is_node_stopped, timeout=timeout)\n \n+    @contextlib.contextmanager\n+    def assert_debug_log(self, expected_msgs):\n+        debug_log = os.path.join(self.datadir, 'regtest', 'debug.log')\n+        with open(debug_log, encoding='utf-8') as dl:\n+            dl.seek(0, 2)\n+            prev_size = dl.tell()\n+        try:\n+            yield\n+        finally:\n+            with open(debug_log, encoding='utf-8') as dl:\n+                dl.seek(prev_size)\n+                log = dl.read()\n+            print_log = \" - \" + \"\\n - \".join(log.splitlines())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212693677",
      "id" : 212693677,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjY5MzY3Nw==",
      "original_commit_id" : "fa3e9f7627784ee00980590e5bf044a0e1249999",
      "original_position" : 24,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 24,
      "pull_request_review_id" : 149384552,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024",
      "updated_at" : "2018-08-24T17:35:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212693677",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212697280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212697280"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I was surprised to see that this code actually works without adding RPCs before and after the yield to flush the log. But apparently there is a `setbuf` call in the logging code which disables buffering. Might be worth noting in a comment.",
      "commit_id" : "fa3e9f7627784ee00980590e5bf044a0e1249999",
      "created_at" : "2018-08-24T17:21:01Z",
      "diff_hunk" : "@@ -229,6 +230,23 @@ def is_node_stopped(self):\n     def wait_until_stopped(self, timeout=BITCOIND_PROC_WAIT_TIMEOUT):\n         wait_until(self.is_node_stopped, timeout=timeout)\n \n+    @contextlib.contextmanager\n+    def assert_debug_log(self, expected_msgs):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212697280",
      "id" : 212697280,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjY5NzI4MA==",
      "original_commit_id" : "fa3e9f7627784ee00980590e5bf044a0e1249999",
      "original_position" : 13,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 13,
      "pull_request_review_id" : 149384552,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024",
      "updated_at" : "2018-08-24T17:35:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212697280",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212702884"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212702884"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we don't optimize for performance in the test framework, so this should be fine.",
      "commit_id" : "fa3e9f7627784ee00980590e5bf044a0e1249999",
      "created_at" : "2018-08-24T17:41:19Z",
      "diff_hunk" : "@@ -229,6 +230,23 @@ def is_node_stopped(self):\n     def wait_until_stopped(self, timeout=BITCOIND_PROC_WAIT_TIMEOUT):\n         wait_until(self.is_node_stopped, timeout=timeout)\n \n+    @contextlib.contextmanager\n+    def assert_debug_log(self, expected_msgs):\n+        debug_log = os.path.join(self.datadir, 'regtest', 'debug.log')\n+        with open(debug_log, encoding='utf-8') as dl:\n+            dl.seek(0, 2)\n+            prev_size = dl.tell()\n+        try:\n+            yield\n+        finally:\n+            with open(debug_log, encoding='utf-8') as dl:\n+                dl.seek(prev_size)\n+                log = dl.read()\n+            print_log = \" - \" + \"\\n - \".join(log.splitlines())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#discussion_r212702884",
      "id" : 212702884,
      "in_reply_to_id" : 212693677,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjcwMjg4NA==",
      "original_commit_id" : "fa3e9f7627784ee00980590e5bf044a0e1249999",
      "original_position" : 24,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 24,
      "pull_request_review_id" : 149395755,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14024",
      "updated_at" : "2018-08-24T17:41:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212702884",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK fa3e9f7627784ee00980590e5bf044a0e1249999",
      "created_at" : "2018-08-24T17:53:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14024#issuecomment-415834240",
      "id" : 415834240,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14024",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTgzNDI0MA==",
      "updated_at" : "2018-08-24T17:53:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415834240",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
