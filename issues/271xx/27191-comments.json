[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1478567703), [pinheadmz](https://github.com/bitcoin/bitcoin/pull/27191#pullrequestreview-1353171052), [ryanofsky](https://github.com/bitcoin/bitcoin/pull/27191#pullrequestreview-1385705001) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27125](https://github.com/bitcoin/bitcoin/pull/27125) (refactor, kernel: Decouple ArgsManager from blockstorage by TheCharlatan)\n* [#27039](https://github.com/bitcoin/bitcoin/pull/27039) (blockstorage: do not flush block to disk if it is already there by pinheadmz)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-03-02T17:13:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1452226921",
      "id" : 1452226921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27191",
      "node_id" : "IC_kwDOABII585Wjzlp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1452226921/reactions"
      },
      "updated_at" : "2023-04-18T18:37:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1452226921",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1123567195"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1123567195"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This cleanup is already addressed in #27039 ;-)",
      "commit_id" : "fe6d866c037bc12720d7362f595b56b45dde136c",
      "created_at" : "2023-03-02T18:47:35Z",
      "diff_hunk" : "@@ -601,7 +601,9 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        const unsigned int max_blockfile_size{gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 : MAX_BLOCKFILE_SIZE};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1123567195",
      "id" : 1123567195,
      "line" : 604,
      "node_id" : "PRRC_kwDOABII585C-EZb",
      "original_commit_id" : "fe6d866c037bc12720d7362f595b56b45dde136c",
      "original_line" : 604,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 5,
      "pull_request_review_id" : 1322425690,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1123567195/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-03-02T18:51:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1123567195",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1124047278"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1124047278"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good, should make rebasing easy! Here, it's not a cleanup but needed to use `max_blockfile_size` in the added assert.",
      "commit_id" : "d526dbb50fd546ec244be9194fa52bce92b24753",
      "created_at" : "2023-03-03T05:45:27Z",
      "diff_hunk" : "@@ -601,7 +601,9 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        const unsigned int max_blockfile_size{gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 : MAX_BLOCKFILE_SIZE};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1124047278",
      "id" : 1124047278,
      "in_reply_to_id" : 1123567195,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585C_5mu",
      "original_commit_id" : "fe6d866c037bc12720d7362f595b56b45dde136c",
      "original_line" : 604,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : null,
      "pull_request_review_id" : 1323130633,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1124047278/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-03-03T05:45:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1124047278",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It might also make sense to not allow `-fastprune` on anything besides regtest as well. I'm not sure if that is covered by `ArgsManager::DEBUG_ONLY`\r\n\r\nNot sure if suppressing options for specific networks is something we usually do  (are there any other examples for this?). But I added some more explanation to the `-fastprune` documentation in `init` with the latest push.\r\n\r\n",
      "created_at" : "2023-03-03T05:49:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1453010117",
      "id" : 1453010117,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27191",
      "node_id" : "IC_kwDOABII585WmyzF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453010117/reactions"
      },
      "updated_at" : "2023-03-03T05:49:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453010117",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Not sure how I feel about this change. It is trivial to create blocks exceeding this limit on regtest. If this happens, it should at least log a message explaining why it failed. The size limit constants used by fastprune seem arbitrary to me. What is their rationale, just fewer resources allocated/used while running the pruning functional tests? If so, why are the revision files not size restricted as well?",
      "created_at" : "2023-03-03T12:10:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1453440605",
      "id" : 1453440605,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27191",
      "node_id" : "IC_kwDOABII585Wob5d",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453440605/reactions"
      },
      "updated_at" : "2023-03-03T12:49:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453440605",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Not sure how I feel about this change. It is trivial to create blocks exceeding this limit on regtest. If this happens, it should at least log a message explaining why it failed.\r\n\r\nI'll add a log message with my next push.\r\n\r\n> The size limit constants used by fastprune seem arbitrary to me. What is their rationale, just fewer resources allocated/used while running the pruning functional tests? If so, why are the revision files not size restricted as well?\r\n\r\nIt was introduced in c286a22f7b63a8bd336d5d7606c339053ee0054b ([#15946](https://github.com/bitcoin/bitcoin/pull/15946)) without much discussion - I'd say it's a quick-and-dirty way to allow testing the pruning code in functional tests - tests like `feature_index_prune.py` would probably take hours without it.\r\n\r\nI stumbled upon this while reviewing #27125, when I had the great idea to quickly sync on signet with `-fastprune` to make sure that it still works the same, and after my system crashed due to running oom I thought this could be handled a bit better... ",
      "created_at" : "2023-03-03T16:46:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1453807035",
      "id" : 1453807035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27191",
      "node_id" : "IC_kwDOABII585Wp1W7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453807035/reactions"
      },
      "updated_at" : "2023-03-03T16:46:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1453807035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1125565424"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1125565424"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Instead of asserting, how about setting the block file size dynamically in case the block to be written exceeds the limit? Something like:\r\n```\r\n-        const unsigned int max_blockfile_size{gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE};\r\n+        unsigned int max_blockfile_size = MAX_BLOCKFILE_SIZE;\r\n+        if (gArgs.GetBoolArg(\"-fastprune\", false)) {\r\n+            max_blockfile_size = 0x10000; // 64kiB\r\n+            if (nAddSize >= max_blockfile_size) {\r\n+                max_blockfile_size = nAddSize + 1;\r\n+            }\r\n+        }\r\n```",
      "commit_id" : "d526dbb50fd546ec244be9194fa52bce92b24753",
      "created_at" : "2023-03-04T22:03:12Z",
      "diff_hunk" : "@@ -601,7 +601,9 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        const unsigned int max_blockfile_size{gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE};\n+        assert(nAddSize < max_blockfile_size); // otherwise (possible in debug-only -fastprune mode) the while loop wouldn't terminate",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1125565424",
      "id" : 1125565424,
      "line" : 605,
      "node_id" : "PRRC_kwDOABII585DFsPw",
      "original_commit_id" : "d526dbb50fd546ec244be9194fa52bce92b24753",
      "original_line" : 605,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 6,
      "pull_request_review_id" : 1325130146,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1125565424/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-03-04T22:03:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1125565424",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1132967989"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1132967989"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nice idea! I think that would work - I could do a full signet sync with it.\r\n\r\nI'm still a bit undecided on general grounds, i.e. if it's okay to add more logic to accommodate a test-only mode that doesn't make sense for anything else but easier testing of pruning in the functional and unit tests. One could also argue that if no one but a developer would ever have a reason to use it, it'd be ok to just tell them more clearly not to create large blocks alongside using this option and abort otherwise?\r\n\r\n@MarcoFalke : Do you have an opinion on this, or do you remember past discussions about test-only bitcoind options like this one?",
      "commit_id" : "d526dbb50fd546ec244be9194fa52bce92b24753",
      "created_at" : "2023-03-10T23:27:24Z",
      "diff_hunk" : "@@ -601,7 +601,9 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        const unsigned int max_blockfile_size{gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE};\n+        assert(nAddSize < max_blockfile_size); // otherwise (possible in debug-only -fastprune mode) the while loop wouldn't terminate",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1132967989",
      "id" : 1132967989,
      "in_reply_to_id" : 1125565424,
      "line" : 605,
      "node_id" : "PRRC_kwDOABII585Dh7g1",
      "original_commit_id" : "d526dbb50fd546ec244be9194fa52bce92b24753",
      "original_line" : 605,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 6,
      "pull_request_review_id" : 1335743331,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1132967989/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-03-10T23:27:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1132967989",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1133071807"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1133071807"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> @MarcoFalke : Do you have an opinion on this, or do you remember past discussions\r\n\r\nBoth no :)",
      "commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "created_at" : "2023-03-11T11:28:46Z",
      "diff_hunk" : "@@ -601,7 +601,9 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        const unsigned int max_blockfile_size{gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE};\n+        assert(nAddSize < max_blockfile_size); // otherwise (possible in debug-only -fastprune mode) the while loop wouldn't terminate",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1133071807",
      "id" : 1133071807,
      "in_reply_to_id" : 1125565424,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585DiU2_",
      "original_commit_id" : "d526dbb50fd546ec244be9194fa52bce92b24753",
      "original_line" : 605,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : null,
      "pull_request_review_id" : 1335854676,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1133071807/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-11T11:28:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1133071807",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I changed the approach to @TheCharlatan's idea (added you as coauthor) - now we don't assert anymore but raise the size of the blockfile to the size of the added block if needed. ",
      "created_at" : "2023-03-21T19:31:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1478469232",
      "id" : 1478469232,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27191",
      "node_id" : "IC_kwDOABII585YH6Zw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1478469232/reactions"
      },
      "updated_at" : "2023-03-21T19:31:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1478469232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1143907496"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143907496"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I switched to your suggestion, removing the assert!",
      "commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "created_at" : "2023-03-21T19:36:59Z",
      "diff_hunk" : "@@ -601,7 +601,9 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        const unsigned int max_blockfile_size{gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE};\n+        assert(nAddSize < max_blockfile_size); // otherwise (possible in debug-only -fastprune mode) the while loop wouldn't terminate",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1143907496",
      "id" : 1143907496,
      "in_reply_to_id" : 1125565424,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585ELqSo",
      "original_commit_id" : "d526dbb50fd546ec244be9194fa52bce92b24753",
      "original_line" : 605,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : null,
      "pull_request_review_id" : 1351262647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143907496/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-21T19:36:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1143907496",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK e930814fdb9261f180d5c436cefe52e9cf38fd67 fwiw :P\r\nThank you for following up on this @mzumsande.",
      "created_at" : "2023-03-21T20:55:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1478567703",
      "id" : 1478567703,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27191",
      "node_id" : "IC_kwDOABII585YIScX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1478567703/reactions"
      },
      "updated_at" : "2023-03-21T20:55:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1478567703",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1166995654"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1166995654"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"blockstorage: Adjust fastprune limit if block exceeds blockfile size\" (e930814fdb9261f180d5c436cefe52e9cf38fd67)\r\n\r\nWhat is the +1 for? Would be helpful to add a code comment saying what the extra byte is.\r\n",
      "commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "created_at" : "2023-04-14T15:42:52Z",
      "diff_hunk" : "@@ -601,7 +601,16 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        unsigned int max_blockfile_size = MAX_BLOCKFILE_SIZE;\n+        // Use smaller blockfiles in test-only -fastprune mode - but avoid\n+        // the possibility of having a block not fit into the block file.\n+        if (gArgs.GetBoolArg(\"-fastprune\", false)) {\n+            max_blockfile_size = 0x10000; // 64kiB\n+            if (nAddSize >= max_blockfile_size) {\n+                max_blockfile_size = nAddSize + 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1166995654",
      "id" : 1166995654,
      "line" : 610,
      "node_id" : "PRRC_kwDOABII585FjvDG",
      "original_commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "original_line" : 610,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 11,
      "pull_request_review_id" : 1385705001,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1166995654/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-14T15:57:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1166995654",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1167004409"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167004409"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"blockstorage: Adjust fastprune limit if block exceeds blockfile size\" (e930814fdb9261f180d5c436cefe52e9cf38fd67)\r\n\r\nWould be good to add to add `assert(nAddSize <= max_blockfile_size);` here to make it clear what this function is assuming and catch the problem instead of going into an infinite loop if outside code changes.",
      "commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "created_at" : "2023-04-14T15:49:34Z",
      "diff_hunk" : "@@ -601,7 +601,16 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        unsigned int max_blockfile_size = MAX_BLOCKFILE_SIZE;\n+        // Use smaller blockfiles in test-only -fastprune mode - but avoid\n+        // the possibility of having a block not fit into the block file.\n+        if (gArgs.GetBoolArg(\"-fastprune\", false)) {\n+            max_blockfile_size = 0x10000; // 64kiB\n+            if (nAddSize >= max_blockfile_size) {\n+                max_blockfile_size = nAddSize + 1;\n+            }\n+        }\n+        while (m_blockfile_info[nFile].nSize + nAddSize >= max_blockfile_size) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1167004409",
      "id" : 1167004409,
      "line" : 613,
      "node_id" : "PRRC_kwDOABII585FjxL5",
      "original_commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "original_line" : 613,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 14,
      "pull_request_review_id" : 1385705001,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167004409/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-14T15:57:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1167004409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think assert is the appropriate move here to prevent the infinite memory loop!\r\n\r\nI think throwing an exception or calling abort() would be ok, but better to reserve the assert macro for conditions which are actually impossible and not use it for error handling, because that would water down the meaning of other asserts.",
      "created_at" : "2023-04-14T16:07:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1508895445",
      "id" : 1508895445,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27191",
      "node_id" : "IC_kwDOABII585Z7-rV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508895445/reactions"
      },
      "updated_at" : "2023-04-14T16:07:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508895445",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1169737011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1169737011"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I checked this carefully again and don't think anymore that the `+ 1` is necessary.",
      "commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "created_at" : "2023-04-18T09:09:53Z",
      "diff_hunk" : "@@ -601,7 +601,16 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        unsigned int max_blockfile_size = MAX_BLOCKFILE_SIZE;\n+        // Use smaller blockfiles in test-only -fastprune mode - but avoid\n+        // the possibility of having a block not fit into the block file.\n+        if (gArgs.GetBoolArg(\"-fastprune\", false)) {\n+            max_blockfile_size = 0x10000; // 64kiB\n+            if (nAddSize >= max_blockfile_size) {\n+                max_blockfile_size = nAddSize + 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1169737011",
      "id" : 1169737011,
      "in_reply_to_id" : 1166995654,
      "line" : 610,
      "node_id" : "PRRC_kwDOABII585FuMUz",
      "original_commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "original_line" : 610,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 11,
      "pull_request_review_id" : 1389655909,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1169737011/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-18T09:09:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1169737011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8421793?v=4",
         "events_url" : "https://api.github.com/users/TheCharlatan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheCharlatan/followers",
         "following_url" : "https://api.github.com/users/TheCharlatan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheCharlatan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheCharlatan",
         "id" : 8421793,
         "login" : "TheCharlatan",
         "node_id" : "MDQ6VXNlcjg0MjE3OTM=",
         "organizations_url" : "https://api.github.com/users/TheCharlatan/orgs",
         "received_events_url" : "https://api.github.com/users/TheCharlatan/received_events",
         "repos_url" : "https://api.github.com/users/TheCharlatan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheCharlatan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheCharlatan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheCharlatan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1170234364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1170234364"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it is necessary, as long as the while condition says\r\n`while (m_blockfile_info[nFile].nSize + nAddSize >= max_blockfile_size)` \r\nit won't terminate if  `nAddSize == max_blockfile_size`, because `m_blockfile_info[nFile].nSize` will be 0 if we skip to the next block.\r\n\r\nMaybe we could lose the `+ 1` if we'd change the `>=` from the while loop into a `>`, however I really don't want to change this critical code in this PR because it would mean we'd try to squeeze another byte into all blocks, affecting blockstorage in normal operation as well, not just the test-only `-fastprune` mode.\r\nSo I'll add a comment.",
      "commit_id" : "19e9073c966aa1c4c8995587677008373c2d0cc3",
      "created_at" : "2023-04-18T15:45:01Z",
      "diff_hunk" : "@@ -601,7 +601,16 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        unsigned int max_blockfile_size = MAX_BLOCKFILE_SIZE;\n+        // Use smaller blockfiles in test-only -fastprune mode - but avoid\n+        // the possibility of having a block not fit into the block file.\n+        if (gArgs.GetBoolArg(\"-fastprune\", false)) {\n+            max_blockfile_size = 0x10000; // 64kiB\n+            if (nAddSize >= max_blockfile_size) {\n+                max_blockfile_size = nAddSize + 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1170234364",
      "id" : 1170234364,
      "in_reply_to_id" : 1166995654,
      "line" : 611,
      "node_id" : "PRRC_kwDOABII585FwFv8",
      "original_commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "original_line" : 611,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 12,
      "pull_request_review_id" : 1390432851,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1170234364/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-18T15:45:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1170234364",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1170436504"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1170436504"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done, although I think we should assert `nAddSize < max_blockfile_size;` - see explanation above.",
      "commit_id" : "19e9073c966aa1c4c8995587677008373c2d0cc3",
      "created_at" : "2023-04-18T18:37:30Z",
      "diff_hunk" : "@@ -601,7 +601,16 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        unsigned int max_blockfile_size = MAX_BLOCKFILE_SIZE;\n+        // Use smaller blockfiles in test-only -fastprune mode - but avoid\n+        // the possibility of having a block not fit into the block file.\n+        if (gArgs.GetBoolArg(\"-fastprune\", false)) {\n+            max_blockfile_size = 0x10000; // 64kiB\n+            if (nAddSize >= max_blockfile_size) {\n+                max_blockfile_size = nAddSize + 1;\n+            }\n+        }\n+        while (m_blockfile_info[nFile].nSize + nAddSize >= max_blockfile_size) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1170436504",
      "id" : 1170436504,
      "in_reply_to_id" : 1167004409,
      "line" : 615,
      "node_id" : "PRRC_kwDOABII585Fw3GY",
      "original_commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "original_line" : 615,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 16,
      "pull_request_review_id" : 1390722639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1170436504/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-04-18T18:37:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1170436504",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the reviews! I pushed an update to address the outstanding comments and added the test by @pinheadmz (thanks!).",
      "created_at" : "2023-04-18T18:39:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#issuecomment-1513632824",
      "id" : 1513632824,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27191",
      "node_id" : "IC_kwDOABII585aODQ4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 1,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1513632824/reactions"
      },
      "updated_at" : "2023-04-18T18:39:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1513632824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1181752551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181752551"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Makes sense the `+1` is needed to be consistent with `>=` below. It does look like there is a minor bug here that will cause block files to be at most `MAX_BLOCKFILE_SIZE-1` bytes and never reach the maximum size. But if this is a bug, it goes back to 5382bcf8cd23c36a435c29080770a79b5e28af42 when this code was introduced. Agree it would not be good to change that behavior here.",
      "commit_id" : "8f14fc86225d8fe77353f61ebd6b0bdda8d13aa9",
      "created_at" : "2023-05-01T17:45:43Z",
      "diff_hunk" : "@@ -601,7 +601,16 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        unsigned int max_blockfile_size = MAX_BLOCKFILE_SIZE;\n+        // Use smaller blockfiles in test-only -fastprune mode - but avoid\n+        // the possibility of having a block not fit into the block file.\n+        if (gArgs.GetBoolArg(\"-fastprune\", false)) {\n+            max_blockfile_size = 0x10000; // 64kiB\n+            if (nAddSize >= max_blockfile_size) {\n+                max_blockfile_size = nAddSize + 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1181752551",
      "id" : 1181752551,
      "in_reply_to_id" : 1166995654,
      "line" : 629,
      "node_id" : "PRRC_kwDOABII585GcBzn",
      "original_commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "original_line" : 629,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 12,
      "pull_request_review_id" : 1407882016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181752551/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-01T17:49:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181752551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1181780876"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181780876"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The functional test covers the `+1` nicely as well. Without the `+1` (and removing the assertion on L632) the test will hang until timed out at 30s",
      "commit_id" : "8f14fc86225d8fe77353f61ebd6b0bdda8d13aa9",
      "created_at" : "2023-05-01T18:25:07Z",
      "diff_hunk" : "@@ -601,7 +601,16 @@ bool BlockManager::FindBlockPos(FlatFilePos& pos, unsigned int nAddSize, unsigne\n \n     bool finalize_undo = false;\n     if (!fKnown) {\n-        while (m_blockfile_info[nFile].nSize + nAddSize >= (gArgs.GetBoolArg(\"-fastprune\", false) ? 0x10000 /* 64kb */ : MAX_BLOCKFILE_SIZE)) {\n+        unsigned int max_blockfile_size = MAX_BLOCKFILE_SIZE;\n+        // Use smaller blockfiles in test-only -fastprune mode - but avoid\n+        // the possibility of having a block not fit into the block file.\n+        if (gArgs.GetBoolArg(\"-fastprune\", false)) {\n+            max_blockfile_size = 0x10000; // 64kiB\n+            if (nAddSize >= max_blockfile_size) {\n+                max_blockfile_size = nAddSize + 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27191#discussion_r1181780876",
      "id" : 1181780876,
      "in_reply_to_id" : 1166995654,
      "line" : 629,
      "node_id" : "PRRC_kwDOABII585GcIuM",
      "original_commit_id" : "e930814fdb9261f180d5c436cefe52e9cf38fd67",
      "original_line" : 629,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.cpp",
      "position" : 12,
      "pull_request_review_id" : 1407924648,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27191",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181780876/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-05-01T18:25:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1181780876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2084648?v=4",
         "events_url" : "https://api.github.com/users/pinheadmz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pinheadmz/followers",
         "following_url" : "https://api.github.com/users/pinheadmz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pinheadmz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pinheadmz",
         "id" : 2084648,
         "login" : "pinheadmz",
         "node_id" : "MDQ6VXNlcjIwODQ2NDg=",
         "organizations_url" : "https://api.github.com/users/pinheadmz/orgs",
         "received_events_url" : "https://api.github.com/users/pinheadmz/received_events",
         "repos_url" : "https://api.github.com/users/pinheadmz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pinheadmz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pinheadmz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pinheadmz"
      }
   }
]
