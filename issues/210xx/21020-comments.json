[
   {
      "author_association" : "MEMBER",
      "body" : "I am not convinced it is worth to add 37 lines of obscure bash that no one understands (or a regexp with similar complexity), when a simple documentation (printed as part of the fail-error) can have the same benefit. See https://github.com/bitcoin/bitcoin/pull/21002#discussion_r564329169",
      "created_at" : "2021-01-28T07:53:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21020#issuecomment-768869873",
      "id" : 768869873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21020",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2ODg2OTg3Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-28T07:53:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/768869873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@MarcoFalke \r\n\r\nsed -i file1 -e 's/world/WORLD/' file2\r\n\r\nThis command will work without throwing error on both gnu and bsd sed, but will do different things.\r\n\r\nThis approach removes all commands from shell environment, adds a function that runs in place of sed and checks if the arguments are compatible. Second commit adds a check that prevents this issue. 'sed' function can be modified to check for any incompatibilities between sed versions.",
      "created_at" : "2021-01-28T09:03:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21020#issuecomment-768907003",
      "id" : 768907003,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21020",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2ODkwNzAwMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-28T09:03:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/768907003",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/58381615?v=4",
         "events_url" : "https://api.github.com/users/fctorial/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fctorial/followers",
         "following_url" : "https://api.github.com/users/fctorial/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fctorial/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fctorial",
         "id" : 58381615,
         "login" : "fctorial",
         "node_id" : "MDQ6VXNlcjU4MzgxNjE1",
         "organizations_url" : "https://api.github.com/users/fctorial/orgs",
         "received_events_url" : "https://api.github.com/users/fctorial/received_events",
         "repos_url" : "https://api.github.com/users/fctorial/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fctorial/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fctorial/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fctorial"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21020#discussion_r576277493"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/576277493"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why run `verify_script` twice when it fails (in both the `elif` condition and `else` branch)?",
      "commit_id" : "3fa487b42444350ad28705f74013a5ee7bcfe9e5",
      "created_at" : "2021-02-15T15:39:45Z",
      "diff_hunk" : "@@ -28,7 +62,11 @@ for commit in $(git rev-list --reverse $1); do\n             echo \"Error: missing script for: $commit\"\n             echo \"Failed\"\n             RET=1\n+        elif verify_script \"$SCRIPT\"; then\n+            echo ERROR: You are using BSD sed syntax for \"-i\" option, which is incompatible with GNU sed\n+            RET=1\n         else\n+            verify_script \"$SCRIPT\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21020#discussion_r576277493",
      "id" : 576277493,
      "line" : 69,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjI3NzQ5Mw==",
      "original_commit_id" : "3fa487b42444350ad28705f74013a5ee7bcfe9e5",
      "original_line" : 69,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "test/lint/commit-script-check.sh",
      "position" : 55,
      "pull_request_review_id" : 590583689,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21020",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-15T15:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/576277493",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21020#discussion_r576281894"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21020"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/576281894"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't see any examples where it'd be a problem, but that won't capture any builtin commands.\r\n\r\nThis will block processing of `git ls | xargs sed` so those cases won't be checked.",
      "commit_id" : "3fa487b42444350ad28705f74013a5ee7bcfe9e5",
      "created_at" : "2021-02-15T15:46:46Z",
      "diff_hunk" : "@@ -17,6 +17,40 @@ if test \"x$1\" = \"x\"; then\n     exit 1\n fi\n \n+function verify_script () {\n+  local SCRIPT=$1\n+  # use file to trigger error since pipe commands are executed in subshell (can't use vars)\n+  local FLAG_FILE=/tmp/CSC_ERROR_$$\n+  (\n+  export PATH='/invalid'\n+  # ignore commands other than 'sed'\n+  function command_not_found_handle () {\n+    return 0;\n+  }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21020#discussion_r576281894",
      "id" : 576281894,
      "line" : 29,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjI4MTg5NA==",
      "original_commit_id" : "3fa487b42444350ad28705f74013a5ee7bcfe9e5",
      "original_line" : 29,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "test/lint/commit-script-check.sh",
      "position" : 19,
      "pull_request_review_id" : 590583689,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21020",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-15T15:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/576281894",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I am not convinced it is worth to add 37 lines of obscure bash that no one understands (or a regexp with similar complexity),\r\n\r\nI tend to agree. I cannot review this at least, and very few active developers here can, so the general tendency is to keep the amount of advanced shell script in bitcoin core down.\r\nUsually in favor of Python, but maybe that's not really an option here.\r\n\r\nSo -0 on this.\r\n",
      "created_at" : "2021-03-03T12:23:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21020#issuecomment-789677138",
      "id" : 789677138,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21020",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4OTY3NzEzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-03T12:23:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789677138",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@fctorial thanks for the contribution. However I don't think this is the approach we are going to take to solve this particular issue, so I'm going to close this PR.",
      "created_at" : "2021-04-01T09:07:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21020#issuecomment-811768859",
      "id" : 811768859,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21020",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMTc2ODg1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-01T09:07:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811768859",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
