[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@kroese Have you checked that there are really no incoming connections from onion peers? I think this should be already working as you would like it to, but the RPC responses that you are seeing may be confusing. \"reachable\" false means only not reachable in the context of outbound, I think. And that the onion address is not in \"localaddresses\" seems to be the same issue noted in #25669.",
      "created_at" : "2022-07-24T16:28:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1193351937",
      "id" : 1193351937,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25336",
      "node_id" : "IC_kwDOABII585HIRsB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1193351937/reactions"
      },
      "updated_at" : "2022-07-24T16:28:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1193351937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`onion=` is only used to specify the SOCKS5 proxy for making outgoing connections to the Tor network. Because you do not want that you do not need to specify this option.\r\n\r\nJust `-externalip` should suffice to achieve your goal (or `-externalip` plus `-torcontrol` and `-torpassword` but I guess you already have those or the defaults work for you).\r\n\r\nThere are two ways to create a Tor service (for accepting incoming connections on the Tor network):\r\n\r\n1. Automatically using the Tor control API, I guess this is already happening in your case because you say \"Tor starts working...\". If `bitcoind` cannot find the Tor control, you would need to specify `-torcontrol` and `-torpassword`. See [Automatically create a Bitcoin Core onion service](https://github.com/bitcoin/bitcoin/blob/62c864605a3d082855dbbb839d969c2ffc7acace/doc/tor.md#2-automatically-create-a-bitcoin-core-onion-service) in `doc/tor.md`.\r\n2. Manually, by configuring the Tor daemon, described in [Manually create a Bitcoin Core onion service](https://github.com/bitcoin/bitcoin/blob/62c864605a3d082855dbbb839d969c2ffc7acace/doc/tor.md#3-manually-create-a-bitcoin-core-onion-service).\r\n\r\nAnd finally - you have found a bug! It will hopefully be resolved by https://github.com/bitcoin/bitcoin/pull/24835. `-onlynet` is supposed to only affect outgoing connections, but subtly, it also affects `-externalip` in a way that addresses supplied to `-externalip` are ignored if `-onlynet` is given and does not list the network of those addresses.\r\n\r\n@fjahr is right - the RPC output is confusing because reachable is only in the context of outbound. You should be able to get incoming Tor connections even now, but your Tor address is not advertised to the network, so nobody knows about it, which could be a reason why you do not see any incoming Tor connections.",
      "created_at" : "2022-07-28T11:51:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1198038378",
      "id" : 1198038378,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25336",
      "node_id" : "IC_kwDOABII585HaJ1q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198038378/reactions"
      },
      "updated_at" : "2022-07-28T11:55:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198038378",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@vasild Thanks for the confirmation. I described the issue not right, because I didn't mean to say that it disables the incoming Tor connections (which would be impossible, because the tor proxy is a seperate process), but just that `onlynet` disables the address advertisements for Tor, which was unexpected because `onlynet` should only affect outbound connections. Good to hear that this bug is on the list to be resolved.\r\n\r\nFor the other issue (limiting outbound to IPv4) I agree with you that it would make much more sense if I just leave out the `onion=` line. That would have made it unnecessary to use `onlynet` in the first place.\r\n\r\n@fjahr That issue seems very similar. Only in my case Im setting `onion=` explicitly, and still have my `externaladdress` ignored. But it could be that because `onlynet` is set, the end-result is the same is not setting `onion=` at all. In that case my issue is a duplicate of #25669 ",
      "created_at" : "2022-07-28T12:31:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1198078883",
      "id" : 1198078883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25336",
      "node_id" : "IC_kwDOABII585HaTuj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198078883/reactions"
      },
      "updated_at" : "2022-07-28T12:40:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198078883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5763256?v=4",
         "events_url" : "https://api.github.com/users/kroese/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kroese/followers",
         "following_url" : "https://api.github.com/users/kroese/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kroese/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kroese",
         "id" : 5763256,
         "login" : "kroese",
         "node_id" : "MDQ6VXNlcjU3NjMyNTY=",
         "organizations_url" : "https://api.github.com/users/kroese/orgs",
         "received_events_url" : "https://api.github.com/users/kroese/received_events",
         "repos_url" : "https://api.github.com/users/kroese/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kroese/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kroese/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kroese"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> if I just leave out the `onion=` line\r\n\r\nIf `bitcoind` manages to find the Tor control, it will ask it where is the SOCKS5 proxy and will enable outgoing connections to Tor peers via it. To prevent that you need to either set `-onion=0` or `-onlynet=...values.other.than.onion...`",
      "created_at" : "2022-07-28T13:45:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1198164617",
      "id" : 1198164617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25336",
      "node_id" : "IC_kwDOABII585HaoqJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198164617/reactions"
      },
      "updated_at" : "2022-07-28T13:45:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198164617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> If `bitcoind` manages to find the Tor control, it will ask it where is the SOCKS5 proxy and will enable outgoing connections to Tor peers via it. To prevent that you need to either set `-onion=0` or `-onlynet=...values.other.than.onion...`\r\n\r\nThanks, but I was not using `torcontrol=` at all (but a manually configured service).",
      "created_at" : "2022-07-28T13:47:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1198167425",
      "id" : 1198167425,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25336",
      "node_id" : "IC_kwDOABII585HapWB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198167425/reactions"
      },
      "updated_at" : "2022-07-28T13:48:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198167425",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5763256?v=4",
         "events_url" : "https://api.github.com/users/kroese/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kroese/followers",
         "following_url" : "https://api.github.com/users/kroese/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kroese/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kroese",
         "id" : 5763256,
         "login" : "kroese",
         "node_id" : "MDQ6VXNlcjU3NjMyNTY=",
         "organizations_url" : "https://api.github.com/users/kroese/orgs",
         "received_events_url" : "https://api.github.com/users/kroese/received_events",
         "repos_url" : "https://api.github.com/users/kroese/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kroese/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kroese/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kroese"
      }
   }
]
