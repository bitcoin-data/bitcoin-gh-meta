[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r898274243"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898274243"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Concept ACK. But if we're going to do this only once (which is a great idea), why not do it immediately after opening the database, instead of checking it for every batch? ",
      "commit_id" : "9f85f98003d48fd9176997501a33ed6417572fae",
      "created_at" : "2022-06-15T18:07:57Z",
      "diff_hunk" : "@@ -315,11 +315,17 @@ BerkeleyBatch::BerkeleyBatch(BerkeleyDatabase& database, const bool read_only, b\n     env = database.env.get();\n     pdb = database.m_db.get();\n     strFile = fs::PathToString(database.m_filename);\n-    if (!Exists(std::string(\"version\"))) {\n-        bool fTmp = fReadOnly;\n-        fReadOnly = false;\n-        Write(std::string(\"version\"), CLIENT_VERSION);\n-        fReadOnly = fTmp;\n+\n+    // At the first db open\n+    if (database.client_version == -1) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r898274243",
      "id" : 898274243,
      "line" : 320,
      "node_id" : "PRRC_kwDOABII5841ipPD",
      "original_commit_id" : "9f85f98003d48fd9176997501a33ed6417572fae",
      "original_line" : 320,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : 11,
      "pull_request_review_id" : 1007925655,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898274243/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-15T18:08:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898274243",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r898403224"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898403224"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Mainly because of how the flow is currently structured. We are actually checking if the db is open on every new batch, and opening it if not (that is done few lines above, at line 312).\r\n\r\nTo be a bit more specific: I was going to add it inside the `BerkeleyDatabase::Open()` method but.. as `BerkeleyBatch` contains the functions to access the db (Read/Write/Erase etc), was going to end up duplicating the code there (the `BerkeleyBatch::ReadKey` functionality).\r\n\r\nNot sure if I should include it here but I think that a good next step would be to decouple the db.open call from the `BerkeleyBatch` constructor, so it only receives an already opened database. And in that way, the client version read could be decoupled as well and not be part of the constructor.",
      "commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "created_at" : "2022-06-15T20:47:10Z",
      "diff_hunk" : "@@ -315,11 +315,17 @@ BerkeleyBatch::BerkeleyBatch(BerkeleyDatabase& database, const bool read_only, b\n     env = database.env.get();\n     pdb = database.m_db.get();\n     strFile = fs::PathToString(database.m_filename);\n-    if (!Exists(std::string(\"version\"))) {\n-        bool fTmp = fReadOnly;\n-        fReadOnly = false;\n-        Write(std::string(\"version\"), CLIENT_VERSION);\n-        fReadOnly = fTmp;\n+\n+    // At the first db open\n+    if (database.client_version == -1) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r898403224",
      "id" : 898403224,
      "in_reply_to_id" : 898274243,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841jIuY",
      "original_commit_id" : "9f85f98003d48fd9176997501a33ed6417572fae",
      "original_line" : 320,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1008108194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898403224/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T13:03:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898403224",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r898439645"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898439645"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fair enough. If you have a good reason for it it's okay with me. I was just asking.\r\nIt's \"only\" the legacy wallet so doing any large refactors is probably not worth it.",
      "commit_id" : "1f24a4f32216da6e81b0fdcf72c79399aac0e7d0",
      "created_at" : "2022-06-15T21:17:23Z",
      "diff_hunk" : "@@ -315,11 +315,17 @@ BerkeleyBatch::BerkeleyBatch(BerkeleyDatabase& database, const bool read_only, b\n     env = database.env.get();\n     pdb = database.m_db.get();\n     strFile = fs::PathToString(database.m_filename);\n-    if (!Exists(std::string(\"version\"))) {\n-        bool fTmp = fReadOnly;\n-        fReadOnly = false;\n-        Write(std::string(\"version\"), CLIENT_VERSION);\n-        fReadOnly = fTmp;\n+\n+    // At the first db open\n+    if (database.client_version == -1) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r898439645",
      "id" : 898439645,
      "in_reply_to_id" : 898274243,
      "line" : 320,
      "node_id" : "PRRC_kwDOABII5841jRnd",
      "original_commit_id" : "9f85f98003d48fd9176997501a33ed6417572fae",
      "original_line" : 320,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : 11,
      "pull_request_review_id" : 1008166294,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898439645/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-15T21:17:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/898439645",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Honestly this check doesn't even need to exist. I can't quite figure out why it was added in the first place as the code is actually traceable to the first commit in the project! I think it's related to something with using bdb as the transaction index back then. Nowadays, this record is only used to record the most recent client that has opened the wallet, and it is only relevant if the wallet was opened by 0.4 or 0.5 which had database encryption issues.\r\n\r\nAs the version record is updated in `LoadWallet`, I think it is safe to remove this code and just update `LoadWallet` to write the record if it doesn't already exist.",
      "created_at" : "2022-06-15T22:12:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#issuecomment-1157003238",
      "id" : 1157003238,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25383",
      "node_id" : "IC_kwDOABII585E9nfm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157003238/reactions"
      },
      "updated_at" : "2022-06-15T22:12:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157003238",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899067722"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899067722"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yeah, no problem. The question was great to be sync about following-up improvements. The SQLite flow has some similarities.. (the db constructor is, mostly, a no-op as the db is always opened etc..).\r\n\r\nplus, I'm grateful for your quick feedback :).",
      "commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "created_at" : "2022-06-16T13:12:08Z",
      "diff_hunk" : "@@ -315,11 +315,17 @@ BerkeleyBatch::BerkeleyBatch(BerkeleyDatabase& database, const bool read_only, b\n     env = database.env.get();\n     pdb = database.m_db.get();\n     strFile = fs::PathToString(database.m_filename);\n-    if (!Exists(std::string(\"version\"))) {\n-        bool fTmp = fReadOnly;\n-        fReadOnly = false;\n-        Write(std::string(\"version\"), CLIENT_VERSION);\n-        fReadOnly = fTmp;\n+\n+    // At the first db open\n+    if (database.client_version == -1) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899067722",
      "id" : 899067722,
      "in_reply_to_id" : 898274243,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841lq9K",
      "original_commit_id" : "9f85f98003d48fd9176997501a33ed6417572fae",
      "original_line" : 320,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1009018949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899067722/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T13:12:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899067722",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ha!, what an old gem hehe.\r\n\r\n> As the version record is updated in LoadWallet, I think it is safe to remove this code and just update LoadWallet to write the record if it doesn't already exist.\r\n\r\nYeah, that is cleaner ðð¼.",
      "created_at" : "2022-06-16T13:22:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#issuecomment-1157656946",
      "id" : 1157656946,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25383",
      "node_id" : "IC_kwDOABII585FAHFy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157656946/reactions"
      },
      "updated_at" : "2022-06-16T13:22:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157656946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed. Ready to go.",
      "created_at" : "2022-06-16T13:57:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#issuecomment-1157692888",
      "id" : 1157692888,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25383",
      "node_id" : "IC_kwDOABII585FAP3Y",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157692888/reactions"
      },
      "updated_at" : "2022-06-16T13:57:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157692888",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899144938"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899144938"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to keep this check? If yes, maybe rename `last_client` to `highest_client`?",
      "commit_id" : "bda8ebe608e6572eaaf40cd28dab6954241c9b0d",
      "created_at" : "2022-06-16T14:25:31Z",
      "diff_hunk" : "@@ -909,7 +909,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client < CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899144938",
      "id" : 899144938,
      "line" : 910,
      "node_id" : "PRRC_kwDOABII5841l9zq",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 910,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 18,
      "pull_request_review_id" : 1009133019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899144938/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T14:25:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899144938",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899149943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899149943"
         }
      },
      "author_association" : "MEMBER",
      "body" : "unrelated: Any reason for the `> 0` check? If the minimum version needed to read the wallet is `0`, it should probably be printed as-is?",
      "commit_id" : "bda8ebe608e6572eaaf40cd28dab6954241c9b0d",
      "created_at" : "2022-06-16T14:30:05Z",
      "diff_hunk" : "@@ -885,7 +885,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n \n     // Last client version to open this wallet, was previously the file version number\n     int last_client = CLIENT_VERSION;\n-    m_batch->Read(DBKeys::VERSION, last_client);\n+    bool has_last_client = m_batch->Read(DBKeys::VERSION, last_client);\n \n     int wallet_version = pwallet->GetVersion();\n     pwallet->WalletLogPrintf(\"Wallet File Version = %d\\n\", wallet_version > 0 ? wallet_version : last_client);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899149943",
      "id" : 899149943,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841l_B3",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 891,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1009140162,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899149943/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T14:30:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899149943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899188122"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899188122"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> Any reason to keep this check? \r\n\r\nThe purpose of this process is store (first condition) or update (second condition) the version of the last client who opened the wallet db. Plus, we don't want to write to db if the value is already there.\r\n\r\n> maybe rename last_client to highest_client?\r\n\r\nhmm, I don't think that `highest_client` represents what this variable really is. I mean, the comment that is above the variable declaration is already saying \"// Last client version to open this wallet, was previously the file version number\".\r\nWhich doesn't necessarily need to be the \"highest\" version.\r\n\r\nSo, I think that the name is fine. Maybe could change it to `last_client_version` but.. not sure, with the existent comment we should be fine.",
      "commit_id" : "bda8ebe608e6572eaaf40cd28dab6954241c9b0d",
      "created_at" : "2022-06-16T15:06:10Z",
      "diff_hunk" : "@@ -909,7 +909,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client < CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899188122",
      "id" : 899188122,
      "in_reply_to_id" : 899144938,
      "line" : 910,
      "node_id" : "PRRC_kwDOABII5841mIWa",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 910,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 18,
      "pull_request_review_id" : 1009194768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899188122/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T15:18:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899188122",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24914](https://github.com/bitcoin/bitcoin/pull/24914) (wallet: Load database records in a particular order by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-06-16T15:12:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#issuecomment-1157777657",
      "id" : 1157777657,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25383",
      "node_id" : "IC_kwDOABII585FAkj5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157777657/reactions"
      },
      "updated_at" : "2022-06-16T15:12:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157777657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899195552"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899195552"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yeah, that doesn't make sense. Even `0.4.0` wallet version was `40000`.",
      "commit_id" : "bda8ebe608e6572eaaf40cd28dab6954241c9b0d",
      "created_at" : "2022-06-16T15:12:53Z",
      "diff_hunk" : "@@ -885,7 +885,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n \n     // Last client version to open this wallet, was previously the file version number\n     int last_client = CLIENT_VERSION;\n-    m_batch->Read(DBKeys::VERSION, last_client);\n+    bool has_last_client = m_batch->Read(DBKeys::VERSION, last_client);\n \n     int wallet_version = pwallet->GetVersion();\n     pwallet->WalletLogPrintf(\"Wallet File Version = %d\\n\", wallet_version > 0 ? wallet_version : last_client);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899195552",
      "id" : 899195552,
      "in_reply_to_id" : 899149943,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841mKKg",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 891,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1009207088,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899195552/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T15:12:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899195552",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the feedback!\r\n\r\nSquashed https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899149943 inside bda8ebe.\r\n\r\nNow we will log both versions; the wallet version and the version of the last client who opened the db.",
      "created_at" : "2022-06-16T15:24:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#issuecomment-1157791927",
      "id" : 1157791927,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25383",
      "node_id" : "IC_kwDOABII585FAoC3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157791927/reactions"
      },
      "updated_at" : "2022-06-16T15:24:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1157791927",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899209961"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899209961"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, the comment seems wrong as well. If you open with Bitcoin Core 23.0, it will write the 23.0 CLIENT_VERSION. If you then open with 22.0, it will not update because `last_client < CLIENT_VERSION` evaluates to false?",
      "commit_id" : "bda8ebe608e6572eaaf40cd28dab6954241c9b0d",
      "created_at" : "2022-06-16T15:26:34Z",
      "diff_hunk" : "@@ -909,7 +909,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client < CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899209961",
      "id" : 899209961,
      "in_reply_to_id" : 899144938,
      "line" : 910,
      "node_id" : "PRRC_kwDOABII5841mNrp",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 910,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 18,
      "pull_request_review_id" : 1009227555,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899209961/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T15:26:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899209961",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899399988"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899399988"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "oh yeah, that is also wrong. Updating.. :)",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-16T18:21:49Z",
      "diff_hunk" : "@@ -909,7 +909,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client < CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899399988",
      "id" : 899399988,
      "in_reply_to_id" : 899144938,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841m8E0",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 910,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1009512376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899399988/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T18:21:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899399988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899400970"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899400970"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Hmm, indeed, that is a misnomer. The comment and variable name should be changed to reflect what it actually does.",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-16T18:23:08Z",
      "diff_hunk" : "@@ -909,7 +909,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client < CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899400970",
      "id" : 899400970,
      "in_reply_to_id" : 899144938,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841m8UK",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 910,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1009513713,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899400970/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T18:23:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899400970",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899408127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899408127"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the reason was that there was a belief that the version could be less than 0, particularly for super old wallets that did not have the `minversion` record yet. But looking through the old code, I don't think that can happen, and this is really just a log line so it doesn't really matter.",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-16T18:32:30Z",
      "diff_hunk" : "@@ -885,7 +885,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n \n     // Last client version to open this wallet, was previously the file version number\n     int last_client = CLIENT_VERSION;\n-    m_batch->Read(DBKeys::VERSION, last_client);\n+    bool has_last_client = m_batch->Read(DBKeys::VERSION, last_client);\n \n     int wallet_version = pwallet->GetVersion();\n     pwallet->WalletLogPrintf(\"Wallet File Version = %d\\n\", wallet_version > 0 ? wallet_version : last_client);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899408127",
      "id" : 899408127,
      "in_reply_to_id" : 899149943,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841m-D_",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 891,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1009523496,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899408127/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T18:32:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899408127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899412447"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899412447"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hmm, I was going into the opposite direction actually: update the client version value if it's different than the new version. So we always know (and can log) which soft version opened the wallet db last (something like this https://github.com/bitcoin/bitcoin/pull/25383/commits/c318211ddd48d44dd81dded553afeee3bc41c89e).\r\n\r\nWhich \"should\" be helpful to debug issues.",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-16T18:38:26Z",
      "diff_hunk" : "@@ -909,7 +909,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client < CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899412447",
      "id" : 899412447,
      "in_reply_to_id" : 899144938,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841m_Hf",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 910,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1009530046,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899412447/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T18:39:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899412447",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899425649"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899425649"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Looking through the history of the record, it's always been the highest version rather than the last client, although it also is never actually used for anything important except for the 0.4 and 0.5 encryption fixes. Changing this to actually be last client is probably fine, I don't feel strongly either way.",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-16T18:55:22Z",
      "diff_hunk" : "@@ -909,7 +909,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client < CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899425649",
      "id" : 899425649,
      "in_reply_to_id" : 899144938,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5841nCVx",
      "original_commit_id" : "80400e9bbe9e7af72acab142a2327511e8b0d036",
      "original_line" : 910,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 1009550964,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899425649/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-16T18:55:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/899425649",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-17T15:29:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#issuecomment-1158990563",
      "id" : 1158990563,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25383",
      "node_id" : "IC_kwDOABII585FFMrj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1158990563/reactions"
      },
      "updated_at" : "2022-06-17T15:29:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1158990563",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r901021309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901021309"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Looks like this is changing the semantics of \"last client\". It used to be the newest version ever used, but now it is the most recent version used, newer or not. I'm not sure the latter is preferable - and even if so, maybe it should use a new key.",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-18T22:12:18Z",
      "diff_hunk" : "@@ -909,7 +907,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client != CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r901021309",
      "id" : 901021309,
      "line" : 910,
      "node_id" : "PRRC_kwDOABII5841tH59",
      "original_commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "original_line" : 910,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 21,
      "pull_request_review_id" : 1011455180,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901021309/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-18T22:12:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901021309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r901022411"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901022411"
         }
      },
      "author_association" : "NONE",
      "body" : "ÙÙÙ Ø§ÙÙÙ Ø¨Ø³Ø­Ø¨ Ø§ÙØ§ÙÙØ§Ù",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-18T22:31:37Z",
      "diff_hunk" : "@@ -909,7 +907,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client != CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r901022411",
      "id" : 901022411,
      "in_reply_to_id" : 901021309,
      "line" : 910,
      "node_id" : "PRRC_kwDOABII5841tILL",
      "original_commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "original_line" : 910,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 21,
      "pull_request_review_id" : 1011455966,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901022411/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-18T22:31:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901022411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/106447746?v=4",
         "events_url" : "https://api.github.com/users/NawaraTafa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NawaraTafa/followers",
         "following_url" : "https://api.github.com/users/NawaraTafa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NawaraTafa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NawaraTafa",
         "id" : 106447746,
         "login" : "NawaraTafa",
         "node_id" : "U_kgDOBlhDgg",
         "organizations_url" : "https://api.github.com/users/NawaraTafa/orgs",
         "received_events_url" : "https://api.github.com/users/NawaraTafa/received_events",
         "repos_url" : "https://api.github.com/users/NawaraTafa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NawaraTafa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NawaraTafa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NawaraTafa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r901106923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901106923"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> Looks like this is changing the semantics of \"last client\". It used to be the newest version ever used, but now it is the most recent version used, newer or not. I'm not sure the latter is preferable\r\n\r\nyeah, not sure if you have checked it already but we had the discussion above: https://github.com/bitcoin/bitcoin/pull/25383#discussion_r899188122.\r\n\r\nComments there are very welcome, I'm fine either way.\r\nI moved forward with what seemed to be the desired workflow for this variable (based on the code comments). At the end, as achow101 said, this variable is never actually used for anything important except for the 0.4 and 0.5 encryption fixes (on which, this will still be fine).",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-19T13:27:29Z",
      "diff_hunk" : "@@ -909,7 +907,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client != CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r901106923",
      "id" : 901106923,
      "in_reply_to_id" : 901021309,
      "line" : 910,
      "node_id" : "PRRC_kwDOABII5841tczr",
      "original_commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "original_line" : 910,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 21,
      "pull_request_review_id" : 1011525757,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901106923/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-19T13:27:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901106923",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r901962399"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901962399"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@luke-jr I think the new behavior is actually an improvement and more correct than the previous. Arguably it's a bug fix.\r\n\r\nSuppose a user creates a wallet in a version more recent than 0.5. They then downgrade to 0.4 and load that wallet and encrypt it there. They then open the wallet again in a newer version.\r\n\r\nWhat we want to happen is that opening the wallet in the newer version will force a rewrite of the wallet because it was encrypted in 0.4 and has the bug where unencrypted keys are still in the database. However, because `version` is the most recent client that has opened the wallet, this does not happen and the wallet file contains the unencrypted keys perpetually. If 0.4 had the behavior implemented here, the `version` record would indicate that 0.4 had last opened the file and so the newer version would correctly do the database rewrite.\r\n\r\nIt is possible to test this by creating a wallet with 0.4, loading in a newer version, then loading it back into 0.4, encrypting it in 0.4, and loading it in a newer version. If you look at the data in the file, it will contain unencrypted keys in the slack space.\r\n\r\nWhile this is a rather contrived scenario, if we do have a similar problem in the future, having the record be the last client would be more correct as to how it is being used.",
      "commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "created_at" : "2022-06-20T19:44:23Z",
      "diff_hunk" : "@@ -909,7 +907,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (last_client < CLIENT_VERSION) // Update\n+    if (!has_last_client || last_client != CLIENT_VERSION) // Update",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25383#discussion_r901962399",
      "id" : 901962399,
      "in_reply_to_id" : 901021309,
      "line" : 910,
      "node_id" : "PRRC_kwDOABII5841wtqf",
      "original_commit_id" : "c318211ddd48d44dd81dded553afeee3bc41c89e",
      "original_line" : 910,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 21,
      "pull_request_review_id" : 1012694849,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25383",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901962399/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-06-20T19:45:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901962399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
