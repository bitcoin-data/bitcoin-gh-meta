[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The intermittently failing `BOOST_CHECK` is:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/9712f75746e3da73471da2e23a4bfc1382c69308/src/test/net_tests.cpp#L310-L312\r\n\r\nI don't understand why we test if `ToString()` output includes `%zone_index`: it clearly doesn't on some platforms, so we cannot rely on it anyways. Then why test it? :)",
      "created_at" : "2021-04-15T07:35:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820193361",
      "id" : 820193361,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDE5MzM2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T07:37:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820193361",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My understanding when working on this was that Apple might be going in its own direction with this starting with macOS 10.14 but it still seemed worthwhile to test our code on platforms like Linux and Windows where we can.",
      "created_at" : "2021-04-15T07:39:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820196586",
      "id" : 820196586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDE5NjU4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T07:39:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820196586",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "(Without the fallback, only the macOS 10.14 CI was failing. So coverage on the other CIs seemed good to have.)",
      "created_at" : "2021-04-15T07:42:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820198523",
      "id" : 820198523,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDE5ODUyMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T07:42:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820198523",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> My understanding when working on this was that Apple might be going in its own direction with this starting with macOS 10.14 but it still seemed worthwhile to test our code on platforms like Linux and Windows where we can.\r\n\r\nBut the test is not conditional on platform, so AFAICT we're testing that `ToString` either contains `%zone_id` (the `addr_str == scoped_addr` case) or that it _doesn't_ contain `%zone_id` (the `addr_str == \"fe80:0:0:0:0:0:0:1\"` case)? :)\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/9712f75746e3da73471da2e23a4bfc1382c69308/src/test/net_tests.cpp#L310-L312\r\n\r\nIn other words: we're effectively not testing anything meaningful in a test that is intermittently failing, no? :)\r\n\r\nIf so, why not simply remove it? :)",
      "created_at" : "2021-04-15T07:49:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820202947",
      "id" : 820202947,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDIwMjk0Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T07:49:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820202947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If you test only the fallback, I found that the change fails on all CIs except the macOS 10.14 one:\r\n```diff\r\n-    BOOST_CHECK(addr_str == scoped_addr || addr_str == \"fe80:0:0:0:0:0:0:1\");\r\n+    BOOST_CHECK(addr_str == \"fe80:0:0:0:0:0:0:1\");\r\n```\r\n\r\n$ src/test/test_bitcoin -t net_tests\r\nRunning 14 test cases...\r\ntest/net_tests.cpp(311): error: in \"net_tests/cnetaddr_basic\": check addr_str == \"fe80:0:0:0:0:0:0:1\" has failed\r\n\r\n*** 1 failure is detected in the test module \"Bitcoin Core Test Suite\"\r\n```\r\n",
      "created_at" : "2021-04-15T07:57:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820208946",
      "id" : 820208946,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDIwODk0Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T07:57:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820208946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Does this actually fix the issue or make it only less likely?",
      "created_at" : "2021-04-15T08:03:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820212819",
      "id" : 820212819,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDIxMjgxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T08:03:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820212819",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "As far as I know, the issue began appearing in the CI only this week, so it may be from some recent change in the CI setup, as the tested value of 32 wasn't very high. The CI is green here, so re-pushing now with a very high value (4096). If that causes a failure down the line, I guess we could drop the coverage as suggested above.",
      "created_at" : "2021-04-15T08:59:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820253961",
      "id" : 820253961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDI1Mzk2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T14:21:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820253961",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jonatack\r\n\r\nI didn't get if you agree with my statement that the intermittently failing `BOOST_CHECK` is basically doing:\r\n\r\n```\r\nBOOST_CHECK(to_string_does_contain_zone_id || to_string_does_not_contain_zone_id);\r\n```\r\n\r\nAnd if so, is there any point in keeping it around? :)\r\n\r\n---\r\n\r\nFWIW, patch against current `master` to show the issue more clearly:\r\n\r\n```diff\r\ndiff --git a/src/test/net_tests.cpp b/src/test/net_tests.cpp\r\nindex 8eab26f3d..e7c3475ef 100644\r\n--- a/src/test/net_tests.cpp\r\n+++ b/src/test/net_tests.cpp\r\n@@ -308,8 +308,9 @@ BOOST_AUTO_TEST_CASE(cnetaddr_basic)\r\n     BOOST_REQUIRE(addr.IsIPv6());\r\n     BOOST_CHECK(!addr.IsBindAny());\r\n     const std::string addr_str{addr.ToString()};\r\n-    BOOST_CHECK(addr_str == scoped_addr || addr_str == \"fe80:0:0:0:0:0:0:1\");\r\n-    // The fallback case \"fe80:0:0:0:0:0:0:1\" is needed for macOS 10.14/10.15 and (probably) later.\r\n+    const bool to_string_does_contain_zone_id = addr_str == scoped_addr;\r\n+    const bool to_string_does_not_contain_zone_id = addr_str == \"fe80:0:0:0:0:0:0:1\";\r\n+    BOOST_CHECK(to_string_does_contain_zone_id || to_string_does_not_contain_zone_id);\r\n     // Test that the delimiter \"%\" and default zone id of 0 can be omitted for the default scope.\r\n     BOOST_REQUIRE(LookupHost(link_local + \"%0\", addr, false));\r\n     BOOST_REQUIRE(addr.IsValid());\r\n```",
      "created_at" : "2021-04-15T10:54:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820331298",
      "id" : 820331298,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDMzMTI5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T11:00:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820331298",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@practicalswift It looks like I should document the test better to communicate the context and information. <strike>I'll propose that separately.</strike> Edit: and trying testing by platform to address your concerns.",
      "created_at" : "2021-04-15T12:51:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820397623",
      "id" : 820397623,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDM5NzYyMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T18:53:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820397623",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> It looks like I should document the test better to communicate the context and information. I'll propose that separately.\r\n\r\nWhy can't that be done as part of this change?",
      "created_at" : "2021-04-15T13:57:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820443297",
      "id" : 820443297,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDQ0MzI5Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T13:57:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820443297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok. The CI has been green, and #21696 showed that macOS remains the only CI that fails the `scoped_addr` case.\r\n\r\nLet's try (a) improving the documentation and (b) testing `scoped_addr` by platform.\r\n\r\nEdit: will update to `BOOST_CHECK_EQUAL` if this works.",
      "created_at" : "2021-04-15T15:28:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820519948",
      "id" : 820519948,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDUxOTk0OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T16:00:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820519948",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Great--the per-platform scoped address test is green along with the previous two CI runs.  Pushing an updated version with `BOOST_CHECK( == )` replaced by `BOOST_CHECK_EQUAL( , )` for a 4th CI run. I hope this addresses the feedback above while maintaining coverage and adding clarity and context.",
      "created_at" : "2021-04-15T18:49:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820656022",
      "id" : 820656022,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDY1NjAyMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T18:49:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820656022",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2021-04-15T19:35:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-820682274",
      "id" : 820682274,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDY4MjI3NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-17T20:45:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820682274",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase after https://github.com/bitcoin/bitcoin/pull/21689#issuecomment-821794629",
      "created_at" : "2021-04-17T09:20:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-821794929",
      "id" : 821794929,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTc5NDkyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-17T09:20:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821794929",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I should have updated the test in a separate PR from the one fixing the reported new issue.",
      "created_at" : "2021-04-17T09:32:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-821796213",
      "id" : 821796213,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTc5NjIxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-17T09:32:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821796213",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21690#discussion_r615234226"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615234226"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Is there a reference that 4096 is guaranteed to be unused or is this something that depends on the operating system and the programs currently running?",
      "commit_id" : "6ab76c0b9f07ca37a2a1f90d53b97bfaddc40b42",
      "created_at" : "2021-04-17T09:44:22Z",
      "diff_hunk" : "@@ -300,16 +300,21 @@ BOOST_AUTO_TEST_CASE(cnetaddr_basic)\n \n     // IPv6, scoped/link-local. See https://tools.ietf.org/html/rfc4007\n     // We support non-negative decimal integers (uint32_t) as zone id indices.\n-    // Test with a fairly-high value, e.g. 32, to avoid locally reserved ids.\n+    // Test with a high value, e.g. 4096, to avoid any local ids in use.\n     const std::string link_local{\"fe80::1\"};\n-    const std::string scoped_addr{link_local + \"%32\"};\n+    const std::string scoped_addr{link_local + \"%4096\"};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#discussion_r615234226",
      "id" : 615234226,
      "line" : 305,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTIzNDIyNg==",
      "original_commit_id" : "9005fb50051af9abafcc6c0d02041ee64655706e",
      "original_line" : 305,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/test/net_tests.cpp",
      "position" : 8,
      "pull_request_review_id" : 638214243,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T11:15:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615234226",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> If so, why not simply remove it? :)\r\n\r\nI think it is better to improve the test and contextual information it provides and I spent time in a way that I thought was constructive and helpful re-verifying and working to do that.  Unfortunately, it's an order of magnitude more work to refute statements like \"not very meaningful\" in the #21689 PR title and the comment above, than it is to say them and just erase coverage and (I think) valuable context.",
      "created_at" : "2021-04-17T09:52:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-821798318",
      "id" : 821798318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTc5ODMxOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-17T10:22:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821798318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased, added 6b0e879 for context since this change is not adding a test but hopefully improving it.",
      "created_at" : "2021-04-17T11:07:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-821806387",
      "id" : 821806387,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTgwNjM4Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-17T11:07:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821806387",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21690#discussion_r615264987"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615264987"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good question. From what I understand, the scope ids / zone indices depend on the number of local network interfaces when there are multiple on a single link-local address. Whereas many machines may have the first 8 or 16 decimal integer scope ids in use, the previous test value of 32 seems to be on the high end of the range. I'm not aware of one that is guaranteed to be free, but a value in the thousands (or tens of thousands) might be reasonably worth trying.\r\n\r\nResources:\r\n- https://en.wikipedia.org/wiki/IPv6_address#zone_index\r\n- https://tools.ietf.org/html/rfc4007#section-6\r\n- https://tools.ietf.org/html/rfc4007#section-11.2",
      "commit_id" : "6ab76c0b9f07ca37a2a1f90d53b97bfaddc40b42",
      "created_at" : "2021-04-17T14:59:12Z",
      "diff_hunk" : "@@ -300,16 +300,21 @@ BOOST_AUTO_TEST_CASE(cnetaddr_basic)\n \n     // IPv6, scoped/link-local. See https://tools.ietf.org/html/rfc4007\n     // We support non-negative decimal integers (uint32_t) as zone id indices.\n-    // Test with a fairly-high value, e.g. 32, to avoid locally reserved ids.\n+    // Test with a high value, e.g. 4096, to avoid any local ids in use.\n     const std::string link_local{\"fe80::1\"};\n-    const std::string scoped_addr{link_local + \"%32\"};\n+    const std::string scoped_addr{link_local + \"%4096\"};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#discussion_r615264987",
      "id" : 615264987,
      "in_reply_to_id" : 615234226,
      "line" : 305,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI2NDk4Nw==",
      "original_commit_id" : "9005fb50051af9abafcc6c0d02041ee64655706e",
      "original_line" : 305,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/test/net_tests.cpp",
      "position" : 8,
      "pull_request_review_id" : 638233711,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T14:59:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615264987",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@practicalswift does this now address your feedback?",
      "created_at" : "2021-04-28T19:29:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-828721405",
      "id" : 828721405,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyODcyMTQwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-28T19:29:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/828721405",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @practicalswift does this now address your feedback?\r\n\r\nThe `BOOST_CHECK(to_string_does_contain_zone_id || to_string_does_not_contain_zone_id)` issue has been addressed.\r\n\r\nI think the issue @MarcoFalke raised about the test outcome being dependent on the user's local configuration remains unfortunately.",
      "created_at" : "2021-04-29T19:56:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-829554919",
      "id" : 829554919,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyOTU1NDkxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-29T19:56:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/829554919",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21690#discussion_r623648469"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623648469"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    BOOST_CHECK(addr.ToString().starts_with(\"fe80:0:0:0:0:0:0:1\"));\r\n```\r\n\r\nMaybe just check the prefix if the suffix is unstable?",
      "commit_id" : "6ab76c0b9f07ca37a2a1f90d53b97bfaddc40b42",
      "created_at" : "2021-04-30T06:47:54Z",
      "diff_hunk" : "@@ -300,13 +300,21 @@ BOOST_AUTO_TEST_CASE(cnetaddr_basic)\n \n     // IPv6, scoped/link-local. See https://tools.ietf.org/html/rfc4007\n     // We support non-negative decimal integers (uint32_t) as zone id indices.\n-    // Test with a fairly-high value, e.g. 32, to avoid locally reserved ids.\n+    // Test with a high value, e.g. 4096, to avoid any local ids in use.\n     const std::string link_local{\"fe80::1\"};\n-    const std::string scoped_addr{link_local + \"%32\"};\n+    const std::string scoped_addr{link_local + \"%4096\"};\n     BOOST_REQUIRE(LookupHost(scoped_addr, addr, false));\n     BOOST_REQUIRE(addr.IsValid());\n     BOOST_REQUIRE(addr.IsIPv6());\n     BOOST_CHECK(!addr.IsBindAny());\n+    const std::string addr_str{addr.ToString()};\n+#ifdef MAC_OSX\n+    // Expect macOS to return the address in this format, without zone ids.\n+    BOOST_CHECK_EQUAL(addr_str, \"fe80:0:0:0:0:0:0:1\");\n+#else\n+    // Expect normal scoped address functionality on the other platforms.\n+    BOOST_CHECK_EQUAL(addr_str, scoped_addr);\n+#endif",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#discussion_r623648469",
      "id" : 623648469,
      "line" : 317,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzY0ODQ2OQ==",
      "original_commit_id" : "6ab76c0b9f07ca37a2a1f90d53b97bfaddc40b42",
      "original_line" : 317,
      "original_position" : 20,
      "original_start_line" : 310,
      "path" : "src/test/net_tests.cpp",
      "position" : 20,
      "pull_request_review_id" : 648923368,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21690",
      "side" : "RIGHT",
      "start_line" : 310,
      "start_side" : "RIGHT",
      "updated_at" : "2021-04-30T06:47:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623648469",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21690#discussion_r630040217"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/630040217"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The suffix is stable but if the first few scope ids are in use locally then they will be another string and not share the same prefix.",
      "commit_id" : "6ab76c0b9f07ca37a2a1f90d53b97bfaddc40b42",
      "created_at" : "2021-05-11T10:20:39Z",
      "diff_hunk" : "@@ -300,13 +300,21 @@ BOOST_AUTO_TEST_CASE(cnetaddr_basic)\n \n     // IPv6, scoped/link-local. See https://tools.ietf.org/html/rfc4007\n     // We support non-negative decimal integers (uint32_t) as zone id indices.\n-    // Test with a fairly-high value, e.g. 32, to avoid locally reserved ids.\n+    // Test with a high value, e.g. 4096, to avoid any local ids in use.\n     const std::string link_local{\"fe80::1\"};\n-    const std::string scoped_addr{link_local + \"%32\"};\n+    const std::string scoped_addr{link_local + \"%4096\"};\n     BOOST_REQUIRE(LookupHost(scoped_addr, addr, false));\n     BOOST_REQUIRE(addr.IsValid());\n     BOOST_REQUIRE(addr.IsIPv6());\n     BOOST_CHECK(!addr.IsBindAny());\n+    const std::string addr_str{addr.ToString()};\n+#ifdef MAC_OSX\n+    // Expect macOS to return the address in this format, without zone ids.\n+    BOOST_CHECK_EQUAL(addr_str, \"fe80:0:0:0:0:0:0:1\");\n+#else\n+    // Expect normal scoped address functionality on the other platforms.\n+    BOOST_CHECK_EQUAL(addr_str, scoped_addr);\n+#endif",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#discussion_r630040217",
      "id" : 630040217,
      "in_reply_to_id" : 623648469,
      "line" : 317,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMDA0MDIxNw==",
      "original_commit_id" : "6ab76c0b9f07ca37a2a1f90d53b97bfaddc40b42",
      "original_line" : 317,
      "original_position" : 20,
      "original_start_line" : 310,
      "path" : "src/test/net_tests.cpp",
      "position" : 20,
      "pull_request_review_id" : 656535523,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21690",
      "side" : "RIGHT",
      "start_line" : 310,
      "start_side" : "RIGHT",
      "updated_at" : "2021-05-11T10:20:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/630040217",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This test and informational context involved some trial and error and time to obtain, and I think it's a shame to throw out the coverage and information, particularly as it seems to be not well-known info and I tried to provide context about that. However, it seems like I'm swimming upstream to provide this coverage and information.",
      "created_at" : "2021-05-11T10:25:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-838227713",
      "id" : 838227713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgzODIyNzcxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-11T10:25:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/838227713",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The scoped id/zone indices functionality appears to have been dropped entirely by #21756.",
      "created_at" : "2021-05-17T11:54:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-842263221",
      "id" : 842263221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg0MjI2MzIyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-17T11:54:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/842263221",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The `Up for grabs` label on this pull can be removed following the merge of #21985.",
      "created_at" : "2021-12-21T13:42:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21690#issuecomment-998789719",
      "id" : 998789719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21690",
      "node_id" : "IC_kwDOABII5847iFJX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/998789719/reactions"
      },
      "updated_at" : "2021-12-21T13:42:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/998789719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
