[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r613882514"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613882514"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Err, there's already a test to \"Verify that the deployment windows of different deployment using the same bit are disjoint.\" wouldn't it make more sense to do:\r\n\r\n```diff\r\n+            BOOST_CHECK(VersionBitsMask(mainnetParams, static_cast<Consensus::DeploymentPos>(j)) != bitmask);\r\n-            if (VersionBitsMask(mainnetParams, static_cast<Consensus::DeploymentPos>(j)) == bitmask) {\r\n-                BOOST_CHECK(mainnetParams.vDeployments[j].nStartTime > mainnetParams.vDeployments[i].nTimeout ||\r\n-                        mainnetParams.vDeployments[i].nStartTime > mainnetParams.vDeployments[j].nTimeout);\r\n-            }\r\n```",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-15T08:54:53Z",
      "diff_hunk" : "@@ -443,8 +441,16 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n     // ACTIVE and FAILED states in roughly the way we expect\n     for (const auto& chain_name : {CBaseChainParams::MAIN, CBaseChainParams::TESTNET, CBaseChainParams::SIGNET, CBaseChainParams::REGTEST}) {\n         const auto chainParams = CreateChainParams(*m_node.args, chain_name);\n+        std::set<decltype(Consensus::BIP9Deployment::bit)> chain_bits;\n         for (int i = 0; i < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++i) {\n-            check_computeblockversion(chainParams->GetConsensus(), static_cast<Consensus::DeploymentPos>(i));\n+            const auto dep = static_cast<Consensus::DeploymentPos>(i);\n+            // Check that no bits are re-used (within the same chain). This is\n+            // disallowed because the transition to FAILED (on timeout) does\n+            // not take precedence over STARTED/LOCKED_IN. So all softforks on\n+            // the same bit might overlap, even when non-overlapping start-end\n+            // times are picked.\n+            BOOST_CHECK(chain_bits.insert(chainParams->GetConsensus().vDeployments[dep].bit).second);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r613882514",
      "id" : 613882514,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMzg4MjUxNA==",
      "original_commit_id" : "faac2e41008333ebe9acbead860fbd1589bcb750",
      "original_line" : 452,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 636432713,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T09:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613882514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I agree that https://github.com/bitcoin/bitcoin/pull/21691#discussion_r613882514 is a better way of adding this test.",
      "created_at" : "2021-04-15T09:18:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#issuecomment-820271112",
      "id" : 820271112,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21691",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDI3MTExMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T09:18:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820271112",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r613936337"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613936337"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is only run for the mainnetParams, but we want to run it for all chains.\r\n\r\nI've removed the redundant parts from versionbits_sanity and made the other parts run for all chains.",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-15T10:04:29Z",
      "diff_hunk" : "@@ -443,8 +441,16 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n     // ACTIVE and FAILED states in roughly the way we expect\n     for (const auto& chain_name : {CBaseChainParams::MAIN, CBaseChainParams::TESTNET, CBaseChainParams::SIGNET, CBaseChainParams::REGTEST}) {\n         const auto chainParams = CreateChainParams(*m_node.args, chain_name);\n+        std::set<decltype(Consensus::BIP9Deployment::bit)> chain_bits;\n         for (int i = 0; i < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++i) {\n-            check_computeblockversion(chainParams->GetConsensus(), static_cast<Consensus::DeploymentPos>(i));\n+            const auto dep = static_cast<Consensus::DeploymentPos>(i);\n+            // Check that no bits are re-used (within the same chain). This is\n+            // disallowed because the transition to FAILED (on timeout) does\n+            // not take precedence over STARTED/LOCKED_IN. So all softforks on\n+            // the same bit might overlap, even when non-overlapping start-end\n+            // times are picked.\n+            BOOST_CHECK(chain_bits.insert(chainParams->GetConsensus().vDeployments[dep].bit).second);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r613936337",
      "id" : 613936337,
      "in_reply_to_id" : 613882514,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMzkzNjMzNw==",
      "original_commit_id" : "faac2e41008333ebe9acbead860fbd1589bcb750",
      "original_line" : 452,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 636506965,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T09:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613936337",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r614114870"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614114870"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Do we have any guidance on whether we should avoid side-effects in `BOOST_CHECK()` expressions?  This can obviously be rewritten in a way that inserts and then checks the return value on the following line, but I'm not sure if that's preferred",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-15T14:22:17Z",
      "diff_hunk" : "@@ -443,8 +417,18 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n     // ACTIVE and FAILED states in roughly the way we expect\n     for (const auto& chain_name : {CBaseChainParams::MAIN, CBaseChainParams::TESTNET, CBaseChainParams::SIGNET, CBaseChainParams::REGTEST}) {\n         const auto chainParams = CreateChainParams(*m_node.args, chain_name);\n+        std::set<decltype(Consensus::BIP9Deployment::bit)> chain_bits;\n+        std::set<uint32_t> chain_masks;\n         for (int i = 0; i < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++i) {\n-            check_computeblockversion(chainParams->GetConsensus(), static_cast<Consensus::DeploymentPos>(i));\n+            const auto dep = static_cast<Consensus::DeploymentPos>(i);\n+            // Check that no bits are re-used (within the same chain). This is\n+            // disallowed because the transition to FAILED (on timeout) does\n+            // not take precedence over STARTED/LOCKED_IN. So all softforks on\n+            // the same bit might overlap, even when non-overlapping start-end\n+            // times are picked.\n+            BOOST_CHECK(chain_bits.insert(chainParams->GetConsensus().vDeployments[dep].bit).second);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r614114870",
      "id" : 614114870,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDExNDg3MA==",
      "original_commit_id" : "fa8016dd352b93783898c0112115f917ba036ac0",
      "original_line" : 429,
      "original_position" : 97,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 636749386,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T09:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614114870",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r614119156"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614119156"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Rather than adding to a `std::set<uint32_t>`, should we check set `chain_masks` to a uint32_t, and then check that there's no overlap between the signaled bits:\r\n\r\n```diff\r\n--- a/src/test/versionbits_tests.cpp\r\n+++ b/src/test/versionbits_tests.cpp\r\n@@ -418,7 +418,7 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\r\n     for (const auto& chain_name : {CBaseChainParams::MAIN, CBaseChainParams::TESTNET, CBaseChainParams::SIGNET, CBaseChainParams::REGTEST}) {\r\n         const auto chainParams = CreateChainParams(*m_node.args, chain_name);\r\n         std::set<decltype(Consensus::BIP9Deployment::bit)> chain_bits;\r\n-        std::set<uint32_t> chain_masks;\r\n+        uint32_t chain_masks{0};\r\n         for (int i = 0; i < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++i) {\r\n             const auto dep = static_cast<Consensus::DeploymentPos>(i);\r\n             // Check that no bits are re-used (within the same chain). This is\r\n@@ -427,7 +427,9 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\r\n             // the same bit might overlap, even when non-overlapping start-end\r\n             // times are picked.\r\n             BOOST_CHECK(chain_bits.insert(chainParams->GetConsensus().vDeployments[dep].bit).second);\r\n-            BOOST_CHECK(chain_masks.insert(VersionBitsMask(chainParams->GetConsensus(), dep)).second);\r\n+            const uint32_t chain_mask = VersionBitsMask(chainParams->GetConsensus(), dep);\r\n+            BOOST_CHECK(!(chain_masks & chain_mask));\r\n+            chain_masks |= chain_mask;\r\n             check_computeblockversion(chainParams->GetConsensus(), dep);\r\n         }\r\n     }\r\n```",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-15T14:27:01Z",
      "diff_hunk" : "@@ -443,8 +417,18 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n     // ACTIVE and FAILED states in roughly the way we expect\n     for (const auto& chain_name : {CBaseChainParams::MAIN, CBaseChainParams::TESTNET, CBaseChainParams::SIGNET, CBaseChainParams::REGTEST}) {\n         const auto chainParams = CreateChainParams(*m_node.args, chain_name);\n+        std::set<decltype(Consensus::BIP9Deployment::bit)> chain_bits;\n+        std::set<uint32_t> chain_masks;\n         for (int i = 0; i < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++i) {\n-            check_computeblockversion(chainParams->GetConsensus(), static_cast<Consensus::DeploymentPos>(i));\n+            const auto dep = static_cast<Consensus::DeploymentPos>(i);\n+            // Check that no bits are re-used (within the same chain). This is\n+            // disallowed because the transition to FAILED (on timeout) does\n+            // not take precedence over STARTED/LOCKED_IN. So all softforks on\n+            // the same bit might overlap, even when non-overlapping start-end\n+            // times are picked.\n+            BOOST_CHECK(chain_bits.insert(chainParams->GetConsensus().vDeployments[dep].bit).second);\n+            BOOST_CHECK(chain_masks.insert(VersionBitsMask(chainParams->GetConsensus(), dep)).second);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r614119156",
      "id" : 614119156,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDExOTE1Ng==",
      "original_commit_id" : "fa8016dd352b93783898c0112115f917ba036ac0",
      "original_line" : 430,
      "original_position" : 98,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 636749386,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T09:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614119156",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r614521127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614521127"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Seems like there's a few of these issues: https://github.com/bitcoin/bitcoin/pull/21701#pullrequestreview-637244766",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-16T02:34:01Z",
      "diff_hunk" : "@@ -314,7 +312,7 @@ static void check_computeblockversion(const Consensus::Params& params, Consensus\n     BOOST_REQUIRE(0 <= bit && bit < 32);\n     BOOST_REQUIRE(((1 << bit) & VERSIONBITS_TOP_MASK) == 0);\n     BOOST_REQUIRE(min_activation_height >= 0);\n-    BOOST_REQUIRE_EQUAL(min_activation_height % params.nMinerConfirmationWindow, 0);\n+    BOOST_REQUIRE_EQUAL(min_activation_height % params.nMinerConfirmationWindow, 0U);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r614521127",
      "id" : 614521127,
      "line" : 288,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDUyMTEyNw==",
      "original_commit_id" : "faac2e41008333ebe9acbead860fbd1589bcb750",
      "original_line" : 288,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 75,
      "pull_request_review_id" : 637286346,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T09:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614521127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "(not for backport, obviously)",
      "created_at" : "2021-04-16T09:14:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#issuecomment-821039709",
      "id" : 821039709,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21691",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTAzOTcwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-16T09:14:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821039709",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19438 (Introduce deploymentstatus by ajtowns)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-04-16T14:47:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#issuecomment-821229639",
      "id" : 821229639,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21691",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTIyOTYzOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-19T04:05:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821229639",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615228872"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615228872"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The other instance is removed in the next commit",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-17T08:48:36Z",
      "diff_hunk" : "@@ -314,7 +312,7 @@ static void check_computeblockversion(const Consensus::Params& params, Consensus\n     BOOST_REQUIRE(0 <= bit && bit < 32);\n     BOOST_REQUIRE(((1 << bit) & VERSIONBITS_TOP_MASK) == 0);\n     BOOST_REQUIRE(min_activation_height >= 0);\n-    BOOST_REQUIRE_EQUAL(min_activation_height % params.nMinerConfirmationWindow, 0);\n+    BOOST_REQUIRE_EQUAL(min_activation_height % params.nMinerConfirmationWindow, 0U);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615228872",
      "id" : 615228872,
      "in_reply_to_id" : 614521127,
      "line" : 288,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTIyODg3Mg==",
      "original_commit_id" : "faac2e41008333ebe9acbead860fbd1589bcb750",
      "original_line" : 288,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 75,
      "pull_request_review_id" : 638211055,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T09:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615228872",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615229143"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615229143"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed this line because I think it is redundant",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-17T08:51:43Z",
      "diff_hunk" : "@@ -443,8 +417,18 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n     // ACTIVE and FAILED states in roughly the way we expect\n     for (const auto& chain_name : {CBaseChainParams::MAIN, CBaseChainParams::TESTNET, CBaseChainParams::SIGNET, CBaseChainParams::REGTEST}) {\n         const auto chainParams = CreateChainParams(*m_node.args, chain_name);\n+        std::set<decltype(Consensus::BIP9Deployment::bit)> chain_bits;\n+        std::set<uint32_t> chain_masks;\n         for (int i = 0; i < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++i) {\n-            check_computeblockversion(chainParams->GetConsensus(), static_cast<Consensus::DeploymentPos>(i));\n+            const auto dep = static_cast<Consensus::DeploymentPos>(i);\n+            // Check that no bits are re-used (within the same chain). This is\n+            // disallowed because the transition to FAILED (on timeout) does\n+            // not take precedence over STARTED/LOCKED_IN. So all softforks on\n+            // the same bit might overlap, even when non-overlapping start-end\n+            // times are picked.\n+            BOOST_CHECK(chain_bits.insert(chainParams->GetConsensus().vDeployments[dep].bit).second);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615229143",
      "id" : 615229143,
      "in_reply_to_id" : 614114870,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTIyOTE0Mw==",
      "original_commit_id" : "fa8016dd352b93783898c0112115f917ba036ac0",
      "original_line" : 429,
      "original_position" : 97,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 638211218,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T09:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615229143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615229167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615229167"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, done that.",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-17T08:51:59Z",
      "diff_hunk" : "@@ -443,8 +417,18 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\n     // ACTIVE and FAILED states in roughly the way we expect\n     for (const auto& chain_name : {CBaseChainParams::MAIN, CBaseChainParams::TESTNET, CBaseChainParams::SIGNET, CBaseChainParams::REGTEST}) {\n         const auto chainParams = CreateChainParams(*m_node.args, chain_name);\n+        std::set<decltype(Consensus::BIP9Deployment::bit)> chain_bits;\n+        std::set<uint32_t> chain_masks;\n         for (int i = 0; i < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++i) {\n-            check_computeblockversion(chainParams->GetConsensus(), static_cast<Consensus::DeploymentPos>(i));\n+            const auto dep = static_cast<Consensus::DeploymentPos>(i);\n+            // Check that no bits are re-used (within the same chain). This is\n+            // disallowed because the transition to FAILED (on timeout) does\n+            // not take precedence over STARTED/LOCKED_IN. So all softforks on\n+            // the same bit might overlap, even when non-overlapping start-end\n+            // times are picked.\n+            BOOST_CHECK(chain_bits.insert(chainParams->GetConsensus().vDeployments[dep].bit).second);\n+            BOOST_CHECK(chain_masks.insert(VersionBitsMask(chainParams->GetConsensus(), dep)).second);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615229167",
      "id" : 615229167,
      "in_reply_to_id" : 614119156,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTIyOTE2Nw==",
      "original_commit_id" : "fa8016dd352b93783898c0112115f917ba036ac0",
      "original_line" : 430,
      "original_position" : 98,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 638211232,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-17T09:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615229167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-04-17T10:35:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#issuecomment-821802798",
      "id" : 821802798,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21691",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMTgwMjc5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-17T10:35:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821802798",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615503301"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615503301"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it would be better to keep the \"check the params make sense\" checks separate from the \"check ComputeBlockVersion does the right thing\" checks.",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-19T02:11:27Z",
      "diff_hunk" : "@@ -255,25 +255,6 @@ BOOST_AUTO_TEST_CASE(versionbits_test)\n     }\n }\n \n-BOOST_AUTO_TEST_CASE(versionbits_sanity)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615503301",
      "id" : 615503301,
      "line" : 260,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTUwMzMwMQ==",
      "original_commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "original_line" : 258,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 17,
      "pull_request_review_id" : 638415268,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-19T02:34:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615503301",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615557449"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615557449"
         }
      },
      "author_association" : "MEMBER",
      "body" : "the sanity checks are a requirement, so they need to be run as part of the same test case. Do you mean to split them up into a separate function? I think that'd be too verbose, but I am happy to take a diff if you happen to have one.",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-19T05:51:16Z",
      "diff_hunk" : "@@ -255,25 +255,6 @@ BOOST_AUTO_TEST_CASE(versionbits_test)\n     }\n }\n \n-BOOST_AUTO_TEST_CASE(versionbits_sanity)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615557449",
      "id" : 615557449,
      "in_reply_to_id" : 615503301,
      "line" : 260,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTU1NzQ0OQ==",
      "original_commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "original_line" : 258,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 17,
      "pull_request_review_id" : 638479997,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-19T05:51:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615557449",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615567369"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615567369"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, maybe you're right -- can't reliably test computeblockversion if some other deployment might start setting the bit in question as soon as it hits ACTIVE, even if they're not technically overlapping. No need to hold this up over it in any event.",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-19T06:19:13Z",
      "diff_hunk" : "@@ -255,25 +255,6 @@ BOOST_AUTO_TEST_CASE(versionbits_test)\n     }\n }\n \n-BOOST_AUTO_TEST_CASE(versionbits_sanity)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615567369",
      "id" : 615567369,
      "in_reply_to_id" : 615503301,
      "line" : 260,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTU2NzM2OQ==",
      "original_commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "original_line" : 258,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 17,
      "pull_request_review_id" : 638492995,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-19T06:19:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615567369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-19T12:51:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#issuecomment-822441568",
      "id" : 822441568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21691",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMjQ0MTU2OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-19T12:51:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/822441568",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615860603"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615860603"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```diff\r\n@@ -271,8 +367,7 @@ static void check_computeblockversion(const Consensus::Params& params, Consensus\r\n \r\n     // always/never active deployments shouldn't need to be tested further\r\n     if (nStartTime == Consensus::BIP9Deployment::ALWAYS_ACTIVE ||\r\n-        nStartTime == Consensus::BIP9Deployment::NEVER_ACTIVE)\r\n-    {\r\n+        nStartTime == Consensus::BIP9Deployment::NEVER_ACTIVE) {\r\n         BOOST_CHECK_EQUAL(min_activation_height, 0);\r\n         return;\r\n     }\r\n```",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-19T13:43:48Z",
      "diff_hunk" : "@@ -305,16 +270,25 @@ static void check_computeblockversion(const Consensus::Params& params, Consensus\n     BOOST_CHECK_EQUAL(ComputeBlockVersion(nullptr, params), VERSIONBITS_TOP_BITS);\n \n     // always/never active deployments shouldn't need to be tested further\n-    if (nStartTime == Consensus::BIP9Deployment::ALWAYS_ACTIVE) return;\n-    if (nStartTime == Consensus::BIP9Deployment::NEVER_ACTIVE) return;\n+    if (nStartTime == Consensus::BIP9Deployment::ALWAYS_ACTIVE ||\n+        nStartTime == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+    {\n+        BOOST_CHECK_EQUAL(min_activation_height, 0);\n+        return;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615860603",
      "id" : 615860603,
      "line" : 278,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTg2MDYwMw==",
      "original_commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "original_line" : 278,
      "original_position" : 64,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 64,
      "pull_request_review_id" : 638884586,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-19T13:43:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615860603",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Sanity check on the values in `versionbits_computeblockversion`\r\n```diff\r\n     for (const auto& chain_name : {CBaseChainParams::MAIN, CBaseChainParams::TESTNET, CBaseChainParams::SIGNET, CBaseChainParams::REGTEST}) {\r\n+        BOOST_TEST_MESSAGE(strprintf(\"chain: %s\", chain_name));\r\n         const auto chainParams = CreateChainParams(*m_node.args, chain_name);\r\n         uint32_t chain_all_vbits{0};\r\n         for (int i = 0; i < (int)Consensus::MAX_VERSION_BITS_DEPLOYMENTS; ++i) {\r\n@@ -426,8 +427,16 @@ BOOST_AUTO_TEST_CASE(versionbits_computeblockversion)\r\n             // the same bit might overlap, even when non-overlapping start-end\r\n             // times are picked.\r\n             const uint32_t dep_mask{VersionBitsMask(chainParams->GetConsensus(), dep)};\r\n+            BOOST_TEST_MESSAGE(strprintf(\"i: %d\", i));\r\n+            BOOST_TEST_MESSAGE(strprintf(\"dep_mask: %d\", dep_mask));\r\n+            BOOST_TEST_MESSAGE(strprintf(\"chain_all_vbits: %d\", chain_all_vbits));\r\n             BOOST_CHECK(!(chain_all_vbits & dep_mask));\r\n             chain_all_vbits |= dep_mask;\r\n+            if (i == 0) {\r\n+                BOOST_TEST_MESSAGE(strprintf(\"updated chain_all_vbits after |= dep_mask: %d\", chain_all_vbits));\r\n+            } else {\r\n+                BOOST_TEST_MESSAGE(\"\\n\");\r\n+            }\r\n             check_computeblockversion(chainParams->GetConsensus(), dep);\r\n         }\r\n     }\r\n```\r\n```\r\n$ src/test/test_bitcoin -t versionbits_tests -l message\r\nRunning 2 test cases...\r\nchain: main\r\ni: 0\r\ndep_mask: 268435456\r\nchain_all_vbits: 0\r\nupdated chain_all_vbits after |= dep_mask: 268435456\r\ni: 1\r\ndep_mask: 4\r\nchain_all_vbits: 268435456\r\n\r\n\r\nchain: test\r\ni: 0\r\ndep_mask: 268435456\r\nchain_all_vbits: 0\r\nupdated chain_all_vbits after |= dep_mask: 268435456\r\ni: 1\r\ndep_mask: 4\r\nchain_all_vbits: 268435456\r\n\r\n\r\nchain: signet\r\ni: 0\r\ndep_mask: 268435456\r\nchain_all_vbits: 0\r\nupdated chain_all_vbits after |= dep_mask: 268435456\r\ni: 1\r\ndep_mask: 4\r\nchain_all_vbits: 268435456\r\n\r\n\r\nchain: regtest\r\ni: 0\r\ndep_mask: 268435456\r\nchain_all_vbits: 0\r\nupdated chain_all_vbits after |= dep_mask: 268435456\r\ni: 1\r\ndep_mask: 4\r\nchain_all_vbits: 268435456\r\n\r\n\r\n*** No errors detected\r\n```\r\n",
      "created_at" : "2021-04-19T14:16:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#issuecomment-822502255",
      "id" : 822502255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21691",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMjUwMjI1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-19T14:16:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/822502255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615994551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615994551"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Personally I find it incredibly ugly to have the if-condition and the first if-branch continue with the same indentation as if they are one block. It might be good to update the clang-format to not do this.\r\n\r\nAlso this file is far from clang-format clean, so I am going to leave as is for now.",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-19T16:21:49Z",
      "diff_hunk" : "@@ -305,16 +270,25 @@ static void check_computeblockversion(const Consensus::Params& params, Consensus\n     BOOST_CHECK_EQUAL(ComputeBlockVersion(nullptr, params), VERSIONBITS_TOP_BITS);\n \n     // always/never active deployments shouldn't need to be tested further\n-    if (nStartTime == Consensus::BIP9Deployment::ALWAYS_ACTIVE) return;\n-    if (nStartTime == Consensus::BIP9Deployment::NEVER_ACTIVE) return;\n+    if (nStartTime == Consensus::BIP9Deployment::ALWAYS_ACTIVE ||\n+        nStartTime == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+    {\n+        BOOST_CHECK_EQUAL(min_activation_height, 0);\n+        return;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r615994551",
      "id" : 615994551,
      "in_reply_to_id" : 615860603,
      "line" : 278,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTk5NDU1MQ==",
      "original_commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "original_line" : 278,
      "original_position" : 64,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 64,
      "pull_request_review_id" : 639066607,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-19T16:21:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615994551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r616171540"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616171540"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke  **CONCEPT ACK**",
      "commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "created_at" : "2021-04-19T20:55:50Z",
      "diff_hunk" : "@@ -305,16 +270,25 @@ static void check_computeblockversion(const Consensus::Params& params, Consensus\n     BOOST_CHECK_EQUAL(ComputeBlockVersion(nullptr, params), VERSIONBITS_TOP_BITS);\n \n     // always/never active deployments shouldn't need to be tested further\n-    if (nStartTime == Consensus::BIP9Deployment::ALWAYS_ACTIVE) return;\n-    if (nStartTime == Consensus::BIP9Deployment::NEVER_ACTIVE) return;\n+    if (nStartTime == Consensus::BIP9Deployment::ALWAYS_ACTIVE ||\n+        nStartTime == Consensus::BIP9Deployment::NEVER_ACTIVE)\n+    {\n+        BOOST_CHECK_EQUAL(min_activation_height, 0);\n+        return;\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#discussion_r616171540",
      "id" : 616171540,
      "in_reply_to_id" : 615860603,
      "line" : 278,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjE3MTU0MA==",
      "original_commit_id" : "fa8eaee6a8531db970cc84436bf2ae8150a58642",
      "original_line" : 278,
      "original_position" : 64,
      "original_start_line" : null,
      "path" : "src/test/versionbits_tests.cpp",
      "position" : 64,
      "pull_request_review_id" : 639299676,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21691",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-19T20:55:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616171540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  to make these const \r\n\r\nLeft this as is for now to not invalidate reviews",
      "created_at" : "2021-04-20T05:15:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21691#issuecomment-822979511",
      "id" : 822979511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21691",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMjk3OTUxMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-20T05:15:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/822979511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
