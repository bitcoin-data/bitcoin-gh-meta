[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23704#discussion_r764824624"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23704"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/764824624"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`m_mempool` can be accessed directly.\r\n\r\n```suggestion\r\n    chainstate.m_mempool = &tx_pool;\r\n```",
      "commit_id" : "c1038a6d900e949460622e2d0310897bda00890b",
      "created_at" : "2021-12-08T12:33:07Z",
      "diff_hunk" : "@@ -143,7 +143,7 @@ FUZZ_TARGET_INIT(tx_pool_standard, initialize_tx_pool)\n     CTxMemPool tx_pool_{/*estimator=*/nullptr, /*check_ratio=*/1};\n     MockedTxPool& tx_pool = *static_cast<MockedTxPool*>(&tx_pool_);\n \n-    chainstate.SetMempool(&tx_pool);\n+    chainstate.SetMempool(tx_pool);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#discussion_r764824624",
      "id" : 764824624,
      "line" : 146,
      "node_id" : "PRRC_kwDOABII584tlkww",
      "original_commit_id" : "c1038a6d900e949460622e2d0310897bda00890b",
      "original_line" : 146,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/test/fuzz/tx_pool.cpp",
      "position" : 17,
      "pull_request_review_id" : 826374939,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23704",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/764824624/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-08T12:38:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/764824624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23704#discussion_r764825095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23704"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/764825095"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Since `m_mempool` is now public, there is no longer any need for the `class DummyChainState`.\r\n\r\nThe line 126 can also be changed.\r\n```diff\r\n- auto& chainstate{static_cast<DummyChainState&>(node.chainman->ActiveChainstate())};\r\n+ auto& chainstate{node.chainman->ActiveChainstate()};\r\n```",
      "commit_id" : "c1038a6d900e949460622e2d0310897bda00890b",
      "created_at" : "2021-12-08T12:33:49Z",
      "diff_hunk" : "@@ -32,9 +32,9 @@ struct MockedTxPool : public CTxMemPool {\n class DummyChainState final : public CChainState",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#discussion_r764825095",
      "id" : 764825095,
      "line" : 32,
      "node_id" : "PRRC_kwDOABII584tlk4H",
      "original_commit_id" : "c1038a6d900e949460622e2d0310897bda00890b",
      "original_line" : 32,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/fuzz/tx_pool.cpp",
      "position" : 1,
      "pull_request_review_id" : 826374939,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23704",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/764825095/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-08T12:40:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/764825095",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/84432093?v=4",
         "events_url" : "https://api.github.com/users/lsilva01/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lsilva01/followers",
         "following_url" : "https://api.github.com/users/lsilva01/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lsilva01/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lsilva01",
         "id" : 84432093,
         "login" : "lsilva01",
         "node_id" : "MDQ6VXNlcjg0NDMyMDkz",
         "organizations_url" : "https://api.github.com/users/lsilva01/orgs",
         "received_events_url" : "https://api.github.com/users/lsilva01/received_events",
         "repos_url" : "https://api.github.com/users/lsilva01/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lsilva01/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lsilva01/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lsilva01"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thank you @lsilva01, I've added a commit authored by you for the fuzz code simplifications.",
      "created_at" : "2021-12-08T13:12:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#issuecomment-988803254",
      "id" : 988803254,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23704",
      "node_id" : "IC_kwDOABII58467_C2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/988803254/reactions"
      },
      "updated_at" : "2021-12-08T13:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/988803254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm ~0 on this. I think a crucial difference between what is being proposed here and the advice in https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#c131-avoid-trivial-getters-and-setters is that here there was only a getter and no setter. Prior to this PR, only `CChainState` or a derived class could update `m_mempool`. Now, any client code can modify it. That's a change in the class's contract with its clients.",
      "created_at" : "2021-12-09T13:15:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#issuecomment-989842954",
      "id" : 989842954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23704",
      "node_id" : "IC_kwDOABII5846_84K",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989842954/reactions"
      },
      "updated_at" : "2021-12-09T13:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989842954",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hm. https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rh-public might be relevant. If we want it to be encapsulated, then it should be private. Public and protected are the same category (in that guideline).",
      "created_at" : "2021-12-09T14:32:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#issuecomment-989906698",
      "id" : 989906698,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23704",
      "node_id" : "IC_kwDOABII5847AMcK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989906698/reactions"
      },
      "updated_at" : "2021-12-09T15:07:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989906698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Hm. https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rh-public might be relevant. If we want it to be encapsulated, then it should be private. Public and protected are the same category.\r\n\r\nA reference is a non-nullable \"const\" pointer (For pointers there are two dimensions of `const`), so I don't think comparing m_mempool with m_blockman (or other references) is fair.",
      "created_at" : "2021-12-09T14:42:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#issuecomment-989916100",
      "id" : 989916100,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23704",
      "node_id" : "IC_kwDOABII5847AOvE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989916100/reactions"
      },
      "updated_at" : "2021-12-09T14:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989916100",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My thought isn't about comparison with the other data members, but rather that m_mempool would preferably be either public (with less and simpler code) as done here, or private with a setter if it is intended to be encapsulated.",
      "created_at" : "2021-12-09T15:05:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#issuecomment-989936296",
      "id" : 989936296,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23704",
      "node_id" : "IC_kwDOABII5847ATqo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989936296/reactions"
      },
      "updated_at" : "2021-12-09T15:05:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989936296",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My reply to that would be: https://github.com/bitcoin/bitcoin/pull/23465#discussion_r760832977",
      "created_at" : "2021-12-09T15:45:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#issuecomment-989972989",
      "id" : 989972989,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23704",
      "node_id" : "IC_kwDOABII5847Acn9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989972989/reactions"
      },
      "updated_at" : "2021-12-09T15:45:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989972989",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "After reading all the early review in #23465 I see that most of these options were previously proposed by @lsilva01; sorry about that.\r\n\r\nIf `m_mempool` should be encapsulated, I agree with @jnewbery and with @promag in  https://github.com/bitcoin/bitcoin/pull/23465#discussion_r756697995.\r\n\r\nAgree with avoiding test-only helpers. In this case there may be good counter-arguments:\r\n\r\n- making it `protected` instead of `private` appears to be only for the fuzz test as well (and isn't explicit as to why)\r\n- it is less safe and more complex to maintain than `private`\r\n- it seems simpler and less error-prone to grep the codebase for a setter than to hunt for workarounds (and `m_mempool` is used frequently, and there is also a `BlockAssembler::m_mempool` private data member) or than by manually making it `private` and then compiling to see what fails\r\n\r\nHowever, since I now see that @lsilva01 did (almost) propose for it to be private in https://github.com/bitcoin/bitcoin/commit/358f94a28176f766634d9701f1688abfcf761c28, I'm not going to update this pull to do it, but may support such a change in future review if/where makes sense. ",
      "created_at" : "2021-12-09T17:13:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23704#issuecomment-990051340",
      "id" : 990051340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23704",
      "node_id" : "IC_kwDOABII5847AvwM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/990051340/reactions"
      },
      "updated_at" : "2021-12-09T17:17:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/990051340",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
