{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "~~Importing a descriptor with a label, i expected to be able to use it to filter UTxOs per descriptor in `listunspent`. It's possible using the `addr()` descriptor but not with a non \"opaque\" one. I'm not sure what the expected behaviour here is, but it is inconsistent between the two and doesn't seem to be implied by the `help`:~~    -    **EDIT: labels are disabled for range descriptors, see the second comment.**\r\n> \"label\": \"str\",                    (string, optional, default=\"\") Label to assign to the address, only allowed with internal=false\r\n\r\nA repro on regtest follows.\r\n\r\n### With `multi()` (not active)\r\n\r\n```\r\ncreatewallet desc true true \"\" false true     \r\n\r\n{                                                                                                                                                                                    \r\n  \"name\": \"desc\",                                                                                                                                                                    \r\n  \"warning\": \"Empty string given as passphrase, wallet will not be encrypted.\\nWallet is an experimental descriptor wallet\"\r\n}\r\n```\r\n```\r\n-rpcwallet=desc importdescriptors '[{\"desc\":\"wsh(multi(1,tpubD6NzVbkrYhZ4X1zm1SuRG3uzkbjY5iVaDSZ8HfUDwEhMA5DtP6ebV1iR42eXKjxU7SAtf4PVHTVvbPqaTTisxH5Le8ynt2QSQNvZjTZWqwV/*,tpubD6NzVbkrYhZ4Wx4iTSmZQJWE6PsHR32TbeLGPoDNpoHHmeMR8RmHiAfco2npEzHLY8nmSNrKM5c7coGkaQwriSAnrXUfW6cQVw64Haj7aRv/*))#qw8vdw82\",\"timestamp\":\"now\",\"la\r\nbel\":\"testlabel\"}]'                                                                       \r\n\r\n[                                                                                                                                                                                    \r\n  {                                                                                                                                                                                  \r\n    \"success\": true,\r\n    \"warnings\": [                                                                         \r\n      \"Range not given, using default keypool range\"\r\n    ]                                                                                                                                                                                \r\n  }                                                                                                                                                                                  \r\n] \r\n```\r\n```\r\n-rpcwallet=desc deriveaddresses \"wsh(multi(1,tpubD6NzVbkrYhZ4X1zm1SuRG3uzkbjY5iVaDSZ8HfUDwEhMA5DtP6ebV1iR42eXKjxU7SAtf4PVHTVvbPqaTTisxH5Le8ynt2QSQNvZjTZWqwV/*,tpubD6NzVbkrYhZ4Wx4iTSmZQJWE6PsHR32TbeLGPoDNpoHHmeMR8RmHiAfco2npEzHLY8nmSNrKM5c7coGkaQwriSAnrXUfW6cQVw64Haj7aRv/*))#qw8vdw82\" 1           \r\n                     \r\n[                                                                                                                                                                                                                                                                                                                                                                          \r\n  \"bcrt1qmwhug9v6j9gehpwzv0vaan7qlv2dnhak2rjetuw0cwawe8d22p5qtj0xru\",                                                                                                                                                                                                                                                                                                      \r\n  \"bcrt1qhnzlvkn2cq3pq786j5l8vr23d4wv7hafumn87ysx7wckydcxyr4sxz53y7\"                                                                                                                                                                                                                                                                                                       \r\n]\r\n```\r\n```\r\nsendtoaddress bcrt1qhnzlvkn2cq3pq786j5l8vr23d4wv7hafumn87ysx7wckydcxyr4sxz53y7 1\r\n\r\nc06e372849ecb41ca879939d558dfd071451dd7ae37f82f8971885428fa0e2ac\r\n```\r\n```\r\n-rpcwallet=desc listunspent 0\r\n\r\n[\r\n  {\r\n    \"txid\": \"c06e372849ecb41ca879939d558dfd071451dd7ae37f82f8971885428fa0e2ac\",\r\n    \"vout\": 0,\r\n    \"address\": \"bcrt1qhnzlvkn2cq3pq786j5l8vr23d4wv7hafumn87ysx7wckydcxyr4sxz53y7\",\r\n    \"witnessScript\": \"512102002ce4dcd76b141d6fc3b87333bb487be0420a7b6c262486612e973ff67d480d210347c912c52c73fd5d9e676efae6daeceafb6d2e7e506e802a4d256d135b74b6d852ae\",\r\n    \"scriptPubKey\": \"0020bcc5f65a6ac0221078fa953e760d516d5ccf5fa9e6e67f1206f3b162370620eb\",\r\n    \"amount\": 1.00000000,\r\n    \"confirmations\": 0,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"desc\": \"wsh(multi(1,[cb5d6fba/1]02002ce4dcd76b141d6fc3b87333bb487be0420a7b6c262486612e973ff67d480d,[a5461cc7/1]0347c912c52c73fd5d9e676efae6daeceafb6d2e7e506e802a4d256d135b74b6d8))#hh5argze\",\r\n    \"safe\": false\r\n  }\r\n]\r\n```\r\nAnd once confirmed:\r\n```\r\n-rpcwallet=desc listunspent\r\n\r\n[\r\n  {\r\n    \"txid\": \"c06e372849ecb41ca879939d558dfd071451dd7ae37f82f8971885428fa0e2ac\",\r\n    \"vout\": 0,\r\n    \"address\": \"bcrt1qhnzlvkn2cq3pq786j5l8vr23d4wv7hafumn87ysx7wckydcxyr4sxz53y7\",\r\n    \"witnessScript\": \"512102002ce4dcd76b141d6fc3b87333bb487be0420a7b6c262486612e973ff67d480d210347c912c52c73fd5d9e676efae6daeceafb6d2e7e506e802a4d256d135b74b6d852ae\",\r\n    \"scriptPubKey\": \"0020bcc5f65a6ac0221078fa953e760d516d5ccf5fa9e6e67f1206f3b162370620eb\",\r\n    \"amount\": 1.00000000,\r\n    \"confirmations\": 1,\r\n    \"spendable\": true,\r\n    \"solvable\": true,\r\n    \"desc\": \"wsh(multi(1,[cb5d6fba/1]02002ce4dcd76b141d6fc3b87333bb487be0420a7b6c262486612e973ff67d480d,[a5461cc7/1]0347c912c52c73fd5d9e676efae6daeceafb6d2e7e506e802a4d256d135b74b6d8))#hh5argze\",\r\n    \"safe\": true\r\n  }\r\n]\r\n```\r\n\r\n### With `multi()`, imported as active\r\n\r\nInterestingly, the behaviour is slightly different if the descriptor was imported as active: the `label` gets set to the default.\r\n```\r\n-rpcwallet=desc listunspent 0\r\n                                                                                                                                                                                                                                                                                                 \r\n[                                                                                                                                                                                                                                                                                                                                                                          \r\n  {                                                                                                                                                                                                                                                                                                                                                                        \r\n    \"txid\": \"4d210ea111d4b195dbbb9ef9c41adbd593a15abd474186c1db1345adebfd6a29\",                                                                                                                                                                                                                                                                                            \r\n    \"vout\": 1,                                                                                                                                                                                                                                                                                                                                                             \r\n    \"address\": \"bcrt1qmwhug9v6j9gehpwzv0vaan7qlv2dnhak2rjetuw0cwawe8d22p5qtj0xru\",                                                                                                                                                                                                                                                                                         \r\n    \"label\": \"\",                                                                                                                                                                                                                                                                                                                                                           \r\n    \"witnessScript\": \"512102a52540cdedb82efaf7f2f2a95e1934fe69fd4d6b2c1e7875d29a71e751e35234210389887d9cc54cd6e1eaabd16cd003779882fa51d2c524741f38aae526211ec8ea52ae\",                                                                                                                                                                                                     \r\n    \"scriptPubKey\": \"0020dbafc4159a91519b85c263d9decfc0fb14d9dfb650e595f1cfc3baec9daa5068\",                                                                                                                                                                                                                                                                                \r\n    \"amount\": 1.00000000,                                                                                                                                                                                                                                                                                                                                                  \r\n    \"confirmations\": 0,                                                                                                                                                                                                                                                                                                                                                    \r\n    \"ancestorcount\": 1,                                                                                                                                                                                                                                                                                                                                                    \r\n    \"ancestorsize\": 165,                                                                                                                                                                                                                                                                                                                                                   \r\n    \"ancestorfees\": 165,                                                                                                                                                                                                                                                                                                                                                   \r\n    \"spendable\": true,                                                                                                                                                                                                                                                                                                                                                     \r\n    \"solvable\": true,                                                                                                                                                                                                                                                                                                                                                      \r\n    \"desc\": \"wsh(multi(1,[cb5d6fba/0]02a52540cdedb82efaf7f2f2a95e1934fe69fd4d6b2c1e7875d29a71e751e35234,[a5461cc7/0]0389887d9cc54cd6e1eaabd16cd003779882fa51d2c524741f38aae526211ec8ea))#e7u440ul\",                                                                                                                                                                        \r\n    \"safe\": false                                                                                                                                                                                                                                                                                                                                                          \r\n  }                                                                                                                                                                                                                                                                                                                                                                        \r\n]\r\n```\r\n\r\n### With `addr()` (inactive, but active status doesn't matter)\r\n\r\n```\r\ncreatewallet descaddr true true \"\" false true\r\n\r\n{\r\n  \"name\": \"descaddr\",\r\n  \"warning\": \"Empty string given as passphrase, wallet will not be encrypted.\\nWallet is an experimental descriptor wallet\"\r\n}\r\n```\r\n```\r\n-rpcwallet=descaddr importdescriptors '[{\"desc\":\"addr(bcrt1qhnzlvkn2cq3pq786j5l8vr23d4wv7hafumn87ysx7wckydcxyr4sxz53y7)#duqgr8lc\",\"timestamp\":0,\"label\":\"foraddrdescriptorsitworks\"}]'\r\n\r\n[\r\n  {\r\n    \"success\": true\r\n  }\r\n]\r\n```\r\n```\r\n-rpcwallet=descaddr listunspent\r\n\r\n[\r\n  {\r\n    \"txid\": \"c06e372849ecb41ca879939d558dfd071451dd7ae37f82f8971885428fa0e2ac\",\r\n    \"vout\": 0,\r\n    \"address\": \"bcrt1qhnzlvkn2cq3pq786j5l8vr23d4wv7hafumn87ysx7wckydcxyr4sxz53y7\",\r\n    \"label\": \"foraddrdescriptorsitworks\",\r\n    \"scriptPubKey\": \"0020bcc5f65a6ac0221078fa953e760d516d5ccf5fa9e6e67f1206f3b162370620eb\",\r\n    \"amount\": 1.00000000,\r\n    \"confirmations\": 1,\r\n    \"spendable\": true,\r\n    \"solvable\": false,\r\n    \"safe\": true\r\n  }\r\n]\r\n```",
   "closed_at" : "2022-01-29T08:49:15Z",
   "closed_by" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
      "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
      "followers_url" : "https://api.github.com/users/darosior/followers",
      "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
      "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/darosior",
      "id" : 22457751,
      "login" : "darosior",
      "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
      "organizations_url" : "https://api.github.com/users/darosior/orgs",
      "received_events_url" : "https://api.github.com/users/darosior/received_events",
      "repos_url" : "https://api.github.com/users/darosior/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/darosior"
   },
   "comments" : 3,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23749/comments",
   "created_at" : "2021-12-12T10:04:49Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23749/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/23749",
   "id" : 1077765590,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "description" : null,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23749/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII585APWXW",
   "number" : 23749,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23749/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "closed",
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23749/timeline",
   "title" : "No `label` field in `listunspent` entries in ranged descriptors",
   "updated_at" : "2022-01-29T08:49:15Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23749",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
      "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
      "followers_url" : "https://api.github.com/users/darosior/followers",
      "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
      "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/darosior",
      "id" : 22457751,
      "login" : "darosior",
      "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
      "organizations_url" : "https://api.github.com/users/darosior/orgs",
      "received_events_url" : "https://api.github.com/users/darosior/received_events",
      "repos_url" : "https://api.github.com/users/darosior/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/darosior"
   }
}
