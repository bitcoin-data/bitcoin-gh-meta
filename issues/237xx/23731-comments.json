[
   {
      "author_association" : "MEMBER",
      "body" : "Obviously this will fail tests and need docs fixed up. I'll do that unless there are NACKs.",
      "created_at" : "2021-12-10T09:08:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-990757338",
      "id" : 990757338,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847DcHa",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/990757338/reactions"
      },
      "updated_at" : "2021-12-10T09:08:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/990757338",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "(un?) related: According to https://transactionfee.info/charts/inputs-types-by-count/ about 80% of spends today are using the witness stack.",
      "created_at" : "2021-12-10T11:05:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-990875381",
      "id" : 990875381,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847D471",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/990875381/reactions"
      },
      "updated_at" : "2021-12-10T11:05:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/990875381",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Light concept ACK\r\n\r\nTalking about potential privacy loss, isn't the main concern here to consider how hard it is to deduce which one is the change output? (https://en.bitcoin.it/wiki/Privacy#Change_address_detection)\r\nFor the mentioned special scenario \"p2sh-witness as address type and there are no bech32(m) outputs.\" and a simple spend to a P2SH(-wrapped) destination:\r\n- On master, the change address is also P2SH(-wrapped) -> Perfect, both outputs are equally likely to be change.\r\n- On the PR branch, the change address is bech32(m). Is this slightly worse? (Or even better, as analyzers assume the change address type usually matches the input type and would wrongly deduce that the bech32(m) output is actually the destination?)\r\n\r\nJust thinking out loud, would be very interested to hear comments about this.",
      "created_at" : "2021-12-14T00:11:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-993026569",
      "id" : 993026569,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847MGIJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993026569/reactions"
      },
      "updated_at" : "2021-12-14T00:11:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993026569",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> On master, the change address is also P2SH(-wrapped) -> Perfect, both outputs are equally likely to be change.\r\n\r\nNot sure this is necessarily true. If the payment is unwrapped to be non-witness and our change is unwrapped to be witness (which is likely because ~80% of all spends are using the witness stack and also P2SH seems to be exclusively used for wrapping a witness program), then this can be combined with other leaks to determine the change address.\r\n\r\n> On the PR branch, the change address is bech32(m). Is this slightly worse? (Or even better, as analyzers assume the change address type usually matches the input type and would wrongly deduce that the bech32(m) output is actually the destination?)\r\n\r\nAs you say it might be slightly worse or slightly better, depending on the context. After all those are heuristics.\r\n\r\n",
      "created_at" : "2021-12-14T07:46:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-993246664",
      "id" : 993246664,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847M73I",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993246664/reactions"
      },
      "updated_at" : "2021-12-14T07:46:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993246664",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "An alternative approach I could think of would be to treat a wallet that can provide bech32m addresses as a taproot wallet. A wallet that can provide bech32 as a wpkh wallet.\r\n\r\n```py\r\nif tx_has_any_tr_output and wallet_has_tr:\r\n return bech32m\r\nif tx_has_any_wpkh and wallet_has_wpkh:\r\n return bech32\r\nif wallet_has_tr:\r\n return bech32m\r\nif wallet_has_wpkh:\r\n return bech32\r\n```\r\n\r\nObviously this will break again once we add output script descriptor support for v2 witness programs.\r\n\r\nHappy to implement this nonetheless if reviewers think it is useful.\r\n\r\n",
      "created_at" : "2021-12-14T07:54:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-993251510",
      "id" : 993251510,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847M9C2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993251510/reactions"
      },
      "updated_at" : "2021-12-14T07:54:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993251510",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23731#discussion_r769053860"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23731"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769053860"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "doesn't this need\r\n\r\n```cpp\r\n\r\nelse {\r\n  return m_default_address_type;\r\n}",
      "commit_id" : "a2ffb3537ba2c389c62a92f76cce43dc91a5c321",
      "created_at" : "2021-12-14T21:20:11Z",
      "diff_hunk" : "@@ -1935,27 +1935,15 @@ OutputType CWallet::TransactionChangeType(const std::optional<OutputType>& chang\n         return *change_type;\n     }\n \n-    // if m_default_address_type is legacy, use legacy address as change (even\n-    // if some of the outputs are P2WPKH or P2WSH).\n+    // if m_default_address_type is legacy, use legacy address as change.\n     if (m_default_address_type == OutputType::LEGACY) {\n         return OutputType::LEGACY;\n     }\n \n-    // if any destination is P2WPKH or P2WSH, use P2WPKH for the change\n-    // output.\n-    for (const auto& recipient : vecSend) {\n-        // Check if any destination contains a witness program:\n-        int witnessversion = 0;\n-        std::vector<unsigned char> witnessprogram;\n-        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n-            if (GetScriptPubKeyMan(OutputType::BECH32M, true)) {\n-                return OutputType::BECH32M;\n-            } else if (GetScriptPubKeyMan(OutputType::BECH32, true)) {\n-                return OutputType::BECH32;\n-            } else {\n-                return m_default_address_type;\n-            }\n-        }\n+    if (GetScriptPubKeyMan(OutputType::BECH32M, true)) {\n+        return OutputType::BECH32M;\n+    } else if (GetScriptPubKeyMan(OutputType::BECH32, true)) {\n+        return OutputType::BECH32;\n     }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#discussion_r769053860",
      "id" : 769053860,
      "line" : 1947,
      "node_id" : "PRRC_kwDOABII584t1tSk",
      "original_commit_id" : "a2ffb3537ba2c389c62a92f76cce43dc91a5c321",
      "original_line" : 1947,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 30,
      "pull_request_review_id" : 832053376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23731",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769053860/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-14T21:20:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769053860",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23731#discussion_r769057831"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23731"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769057831"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, and it is already in the code after the comment `// else use m_default_address_type for change`.",
      "commit_id" : "a2ffb3537ba2c389c62a92f76cce43dc91a5c321",
      "created_at" : "2021-12-14T21:26:29Z",
      "diff_hunk" : "@@ -1935,27 +1935,15 @@ OutputType CWallet::TransactionChangeType(const std::optional<OutputType>& chang\n         return *change_type;\n     }\n \n-    // if m_default_address_type is legacy, use legacy address as change (even\n-    // if some of the outputs are P2WPKH or P2WSH).\n+    // if m_default_address_type is legacy, use legacy address as change.\n     if (m_default_address_type == OutputType::LEGACY) {\n         return OutputType::LEGACY;\n     }\n \n-    // if any destination is P2WPKH or P2WSH, use P2WPKH for the change\n-    // output.\n-    for (const auto& recipient : vecSend) {\n-        // Check if any destination contains a witness program:\n-        int witnessversion = 0;\n-        std::vector<unsigned char> witnessprogram;\n-        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n-            if (GetScriptPubKeyMan(OutputType::BECH32M, true)) {\n-                return OutputType::BECH32M;\n-            } else if (GetScriptPubKeyMan(OutputType::BECH32, true)) {\n-                return OutputType::BECH32;\n-            } else {\n-                return m_default_address_type;\n-            }\n-        }\n+    if (GetScriptPubKeyMan(OutputType::BECH32M, true)) {\n+        return OutputType::BECH32M;\n+    } else if (GetScriptPubKeyMan(OutputType::BECH32, true)) {\n+        return OutputType::BECH32;\n     }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#discussion_r769057831",
      "id" : 769057831,
      "in_reply_to_id" : 769053860,
      "line" : 1947,
      "node_id" : "PRRC_kwDOABII584t1uQn",
      "original_commit_id" : "a2ffb3537ba2c389c62a92f76cce43dc91a5c321",
      "original_line" : 1947,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 30,
      "pull_request_review_id" : 832059081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23731",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769057831/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-14T21:26:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769057831",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23731#discussion_r769058395"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23731"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769058395"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh I see, was outside of the preview of github",
      "commit_id" : "a2ffb3537ba2c389c62a92f76cce43dc91a5c321",
      "created_at" : "2021-12-14T21:27:25Z",
      "diff_hunk" : "@@ -1935,27 +1935,15 @@ OutputType CWallet::TransactionChangeType(const std::optional<OutputType>& chang\n         return *change_type;\n     }\n \n-    // if m_default_address_type is legacy, use legacy address as change (even\n-    // if some of the outputs are P2WPKH or P2WSH).\n+    // if m_default_address_type is legacy, use legacy address as change.\n     if (m_default_address_type == OutputType::LEGACY) {\n         return OutputType::LEGACY;\n     }\n \n-    // if any destination is P2WPKH or P2WSH, use P2WPKH for the change\n-    // output.\n-    for (const auto& recipient : vecSend) {\n-        // Check if any destination contains a witness program:\n-        int witnessversion = 0;\n-        std::vector<unsigned char> witnessprogram;\n-        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n-            if (GetScriptPubKeyMan(OutputType::BECH32M, true)) {\n-                return OutputType::BECH32M;\n-            } else if (GetScriptPubKeyMan(OutputType::BECH32, true)) {\n-                return OutputType::BECH32;\n-            } else {\n-                return m_default_address_type;\n-            }\n-        }\n+    if (GetScriptPubKeyMan(OutputType::BECH32M, true)) {\n+        return OutputType::BECH32M;\n+    } else if (GetScriptPubKeyMan(OutputType::BECH32, true)) {\n+        return OutputType::BECH32;\n     }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#discussion_r769058395",
      "id" : 769058395,
      "in_reply_to_id" : 769053860,
      "line" : 1947,
      "node_id" : "PRRC_kwDOABII584t1uZb",
      "original_commit_id" : "a2ffb3537ba2c389c62a92f76cce43dc91a5c321",
      "original_line" : 1947,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 30,
      "pull_request_review_id" : 832059908,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23731",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769058395/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-14T21:27:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/769058395",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Instead of always using bech32(m), I feel like we should just do the inverse of the current implementation - prefer bech32(m) and use p2sh-segwit if there is a p2sh-segwit output.",
      "created_at" : "2021-12-15T18:23:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-995050335",
      "id" : 995050335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847T0Nf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995050335/reactions"
      },
      "updated_at" : "2021-12-15T18:23:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995050335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> prefer bech32(m) and use p2sh-segwit if there is a p2sh-segwit output.\r\n\r\nI don't think it is possible to see whether a p2sh is segwit or not. While it is likely that a p2sh is segwit, I don't see a benefit to pick p2sh-segwit change over native segwit change (potentially wpkh). (See OP for explanation).",
      "created_at" : "2021-12-15T19:05:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-995099586",
      "id" : 995099586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847UAPC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995099586/reactions"
      },
      "updated_at" : "2021-12-15T19:05:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995099586",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I don't think it is possible to see whether a p2sh is segwit or not. \r\n\r\np2sh-segwit if there are any p2sh outputs, rather.\r\n\r\n> While it is likely that a p2sh is segwit, I don't see a benefit to pick p2sh-segwit change over native segwit change (potentially wpkh). (See OP for explanation).\r\n\r\nI disagree that there is little or no benefit. Given that the majority of p2sh inputs [are nested segwit](https://transactionfee.info/charts/inputs-p2sh-type-distribution/), it is likely that when those outputs are eventually spent, they will be revealed to be segwit as well, so there is less information to be able to determine which is change. Furthermore, the change output would be less likely to be identified before the outputs are spent.",
      "created_at" : "2021-12-15T19:12:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-995108584",
      "id" : 995108584,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847UCbo",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995108584/reactions"
      },
      "updated_at" : "2021-12-15T19:12:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995108584",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, will try to propose an alternative",
      "created_at" : "2021-12-15T19:29:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-995129997",
      "id" : 995129997,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847UHqN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995129997/reactions"
      },
      "updated_at" : "2021-12-15T19:29:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995129997",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Done in https://github.com/bitcoin/bitcoin/pull/23789",
      "created_at" : "2021-12-15T20:17:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23731#issuecomment-995181470",
      "id" : 995181470,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23731",
      "node_id" : "IC_kwDOABII5847UUOe",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995181470/reactions"
      },
      "updated_at" : "2021-12-15T20:17:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/995181470",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
