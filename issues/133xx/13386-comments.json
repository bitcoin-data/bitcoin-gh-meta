[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r192607671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192607671"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What about\r\n```C++\r\n        ret = \"sse4\";\r\n#if defined(ENABLE_SSE41) && !defined(BUILD_BITCOIN_INTERNAL)\r\n        TransformD64_4way = sha256d64_sse41::Transform_4way;\r\n        ret += \",sse41\";\r\n#endif\r\n    }\r\n```\r\n?",
      "commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "created_at" : "2018-06-04T00:19:39Z",
      "diff_hunk" : "@@ -173,22 +484,76 @@ bool SelfTest(TransformType tr) {\n }\n \n TransformType Transform = sha256::Transform;\n+TransformD64Type TransformD64 = sha256::TransformD64;\n+TransformD64Type TransformD64_2way = nullptr;\n+TransformD64Type TransformD64_4way = nullptr;\n+TransformD64Type TransformD64_8way = nullptr;\n \n+#if defined(USE_ASM) && (defined(__x86_64__) || defined(__amd64__))\n+// We can't use cpuid.h's __get_cpuid as it does not support subleafs.\n+void inline cpuid(uint32_t leaf, uint32_t subleaf, uint32_t& a, uint32_t& b, uint32_t& c, uint32_t& d)\n+{\n+  __asm__ (\"cpuid\" : \"=a\"(a), \"=b\"(b), \"=c\"(c), \"=d\"(d) : \"0\"(leaf), \"2\"(subleaf));\n+}\n+#endif\n } // namespace\n \n+\n std::string SHA256AutoDetect()\n {\n+    std::string ret = \"standard\";\n #if defined(USE_ASM) && (defined(__x86_64__) || defined(__amd64__))\n+    bool have_sse4 = false;\n+    bool have_avx2 = false;\n+    bool have_shani = false;\n+\n+    (void)have_sse4;\n+    (void)have_avx2;\n+    (void)have_shani;\n+\n     uint32_t eax, ebx, ecx, edx;\n-    if (__get_cpuid(1, &eax, &ebx, &ecx, &edx) && (ecx >> 19) & 1) {\n+    cpuid(1, 0, eax, ebx, ecx, edx);\n+    have_sse4 = (ecx >> 19) & 1;\n+    if (have_sse4) {\n+        cpuid(7, 0, eax, ebx, ecx, edx);\n+        have_avx2 = (ebx >> 5) & 1;\n+        have_shani = (ebx >> 29) & 1;\n+    }\n+\n+#if defined(ENABLE_SHANI) && !defined(BUILD_BITCOIN_INTERNAL)\n+    if (have_shani) {\n+        Transform = sha256_shani::Transform;\n+        TransformD64 = TransformD64Wrapper<sha256_shani::Transform>;\n+        TransformD64_2way = sha256d64_shani::Transform_2way;\n+        ret = \"shani\";\n+        have_sse4 = false; // Disable SSE4/AVX2;\n+        have_avx2 = false;\n+    }\n+#endif\n+\n+    if (have_sse4) {\n         Transform = sha256_sse4::Transform;\n-        assert(SelfTest(Transform));\n-        return \"sse4\";\n+        TransformD64 = TransformD64Wrapper<sha256_sse4::Transform>;\n+        ret = \"sse4\";\n+    }\n+\n+#if defined(ENABLE_SSE41) && !defined(BUILD_BITCOIN_INTERNAL)\n+    if (have_sse4) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r192607671",
      "id" : 192607671,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MjYwNzY3MQ==",
      "original_commit_id" : "1773155bb23f160ec67f786223f6541823923e58",
      "original_position" : 542,
      "path" : "src/crypto/sha256.cpp",
      "position" : null,
      "pull_request_review_id" : 125413844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386",
      "updated_at" : "2018-06-12T19:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192607671",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r192608258"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192608258"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "created_at" : "2018-06-04T00:35:21Z",
      "diff_hunk" : "@@ -173,22 +484,76 @@ bool SelfTest(TransformType tr) {\n }\n \n TransformType Transform = sha256::Transform;\n+TransformD64Type TransformD64 = sha256::TransformD64;\n+TransformD64Type TransformD64_2way = nullptr;\n+TransformD64Type TransformD64_4way = nullptr;\n+TransformD64Type TransformD64_8way = nullptr;\n \n+#if defined(USE_ASM) && (defined(__x86_64__) || defined(__amd64__))\n+// We can't use cpuid.h's __get_cpuid as it does not support subleafs.\n+void inline cpuid(uint32_t leaf, uint32_t subleaf, uint32_t& a, uint32_t& b, uint32_t& c, uint32_t& d)\n+{\n+  __asm__ (\"cpuid\" : \"=a\"(a), \"=b\"(b), \"=c\"(c), \"=d\"(d) : \"0\"(leaf), \"2\"(subleaf));\n+}\n+#endif\n } // namespace\n \n+\n std::string SHA256AutoDetect()\n {\n+    std::string ret = \"standard\";\n #if defined(USE_ASM) && (defined(__x86_64__) || defined(__amd64__))\n+    bool have_sse4 = false;\n+    bool have_avx2 = false;\n+    bool have_shani = false;\n+\n+    (void)have_sse4;\n+    (void)have_avx2;\n+    (void)have_shani;\n+\n     uint32_t eax, ebx, ecx, edx;\n-    if (__get_cpuid(1, &eax, &ebx, &ecx, &edx) && (ecx >> 19) & 1) {\n+    cpuid(1, 0, eax, ebx, ecx, edx);\n+    have_sse4 = (ecx >> 19) & 1;\n+    if (have_sse4) {\n+        cpuid(7, 0, eax, ebx, ecx, edx);\n+        have_avx2 = (ebx >> 5) & 1;\n+        have_shani = (ebx >> 29) & 1;\n+    }\n+\n+#if defined(ENABLE_SHANI) && !defined(BUILD_BITCOIN_INTERNAL)\n+    if (have_shani) {\n+        Transform = sha256_shani::Transform;\n+        TransformD64 = TransformD64Wrapper<sha256_shani::Transform>;\n+        TransformD64_2way = sha256d64_shani::Transform_2way;\n+        ret = \"shani\";\n+        have_sse4 = false; // Disable SSE4/AVX2;\n+        have_avx2 = false;\n+    }\n+#endif\n+\n+    if (have_sse4) {\n         Transform = sha256_sse4::Transform;\n-        assert(SelfTest(Transform));\n-        return \"sse4\";\n+        TransformD64 = TransformD64Wrapper<sha256_sse4::Transform>;\n+        ret = \"sse4\";\n+    }\n+\n+#if defined(ENABLE_SSE41) && !defined(BUILD_BITCOIN_INTERNAL)\n+    if (have_sse4) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r192608258",
      "id" : 192608258,
      "in_reply_to_id" : 192607671,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MjYwODI1OA==",
      "original_commit_id" : "1773155bb23f160ec67f786223f6541823923e58",
      "original_position" : 542,
      "path" : "src/crypto/sha256.cpp",
      "position" : null,
      "pull_request_review_id" : 125414458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386",
      "updated_at" : "2018-06-12T19:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/192608258",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@sipa\r\n\r\nGreat works as usual!\r\n\r\nI just came cross this thread \r\n\r\nhttps://github.com/armfazh/flo-shani-aesni/blob/master/README.md\r\n\r\nI hope you will have time to look at what they did! ",
      "created_at" : "2018-06-04T09:08:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-394286339",
      "id" : 394286339,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDI4NjMzOQ==",
      "updated_at" : "2018-06-04T09:10:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394286339",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/22077313?v=4",
         "events_url" : "https://api.github.com/users/Kick1986/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Kick1986/followers",
         "following_url" : "https://api.github.com/users/Kick1986/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Kick1986/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Kick1986",
         "id" : 22077313,
         "login" : "Kick1986",
         "node_id" : "MDQ6VXNlcjIyMDc3MzEz",
         "organizations_url" : "https://api.github.com/users/Kick1986/orgs",
         "received_events_url" : "https://api.github.com/users/Kick1986/received_events",
         "repos_url" : "https://api.github.com/users/Kick1986/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Kick1986/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Kick1986/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Kick1986"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Needs rebase",
      "created_at" : "2018-06-04T12:41:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-394340846",
      "id" : 394340846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDM0MDg0Ng==",
      "updated_at" : "2018-06-04T12:41:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394340846",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, nice numbers.",
      "created_at" : "2018-06-04T12:45:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-394341839",
      "id" : 394341839,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDM0MTgzOQ==",
      "updated_at" : "2018-06-04T12:45:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394341839",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased.\r\n\r\n@Kick1986 Nice, I'll have a look.",
      "created_at" : "2018-06-04T16:54:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-394424685",
      "id" : 394424685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDQyNDY4NQ==",
      "updated_at" : "2018-06-04T16:54:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394424685",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #13442 (Convert the 1-way SSE4 SHA256 code from asm to intrinsics by sipa)\n* #13203 (Add POWER8 ASM for 4-way SHA256 by TheBlueMatt)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-06-05T00:49:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-394545161",
      "id" : 394545161,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDU0NTE2MQ==",
      "updated_at" : "2018-07-08T07:26:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394545161",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "For clang version, looks like they were added in 3.4, but never noted in the release notes.\r\nSource: went from commit date[1] to release date[2] to file in release version[3].\r\nDid not check for every intrinsic used.\r\n[1] https://github.com/llvm-mirror/clang/commit/b83f5a77335ca8a5b41ba4e17aa8d4bb6248c1e4#diff-c4f203a0f202bf56c364a657b0aecae9\r\n[2] http://releases.llvm.org/\r\n[3] https://github.com/llvm-mirror/clang/blob/release_34/lib/Headers/shaintrin.h\r\n",
      "created_at" : "2018-06-05T09:34:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-394645719",
      "id" : 394645719,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDY0NTcxOQ==",
      "updated_at" : "2018-06-05T09:35:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394645719",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r193212576"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/193212576"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think these could be ```_mm_load_si128``` if s[] was alignas(16).",
      "commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "created_at" : "2018-06-05T20:33:45Z",
      "diff_hunk" : "@@ -0,0 +1,363 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+// Based on https://github.com/noloader/SHA-Intrinsics/blob/master/sha256-x86.c,\n+// Written and placed in public domain by Jeffrey Walton.\n+// Based on code from Intel, and by Sean Gulley for the miTLS project.\n+\n+#ifdef ENABLE_SHANI\n+\n+#include <stdint.h>\n+#if defined(_MSC_VER)\n+#include <immintrin.h>\n+#elif defined(__GNUC__)\n+#include <x86intrin.h>\n+#endif\n+\n+#include \"crypto/common.h\"\n+\n+\n+namespace {\n+\n+const __m128i MASK = _mm_set_epi64x(0x0c0d0e0f08090a0bULL, 0x0405060700010203ULL);\n+const __m128i INIT0 = _mm_set_epi64x(0x6a09e667bb67ae85ull, 0x510e527f9b05688cull);\n+const __m128i INIT1 = _mm_set_epi64x(0x3c6ef372a54ff53aull, 0x1f83d9ab5be0cd19ull);\n+\n+void inline  __attribute__((always_inline)) QuadRound(__m128i& state0, __m128i& state1, uint64_t k1, uint64_t k0)\n+{\n+    const __m128i msg = _mm_set_epi64x(k1, k0);\n+    state1 = _mm_sha256rnds2_epu32(state1, state0, msg);\n+    state0 = _mm_sha256rnds2_epu32(state0, state1, _mm_shuffle_epi32(msg, 0x0e));\n+}\n+\n+void inline  __attribute__((always_inline)) QuadRound(__m128i& state0, __m128i& state1, __m128i m, uint64_t k1, uint64_t k0)\n+{\n+    const __m128i msg = _mm_add_epi32(m, _mm_set_epi64x(k1, k0));\n+    state1 = _mm_sha256rnds2_epu32(state1, state0, msg);\n+    state0 = _mm_sha256rnds2_epu32(state0, state1, _mm_shuffle_epi32(msg, 0x0e));\n+}\n+\n+void inline  __attribute__((always_inline)) ShiftMessageA(__m128i& m0, __m128i m1)\n+{\n+    m0 = _mm_sha256msg1_epu32(m0, m1);\n+}\n+\n+void inline  __attribute__((always_inline)) ShiftMessageC(__m128i& m0, __m128i m1, __m128i& m2)\n+{\n+    m2 = _mm_sha256msg2_epu32(_mm_add_epi32(m2, _mm_alignr_epi8(m1, m0, 4)), m1);\n+}\n+\n+void inline __attribute__((always_inline)) ShiftMessageB(__m128i& m0, __m128i m1, __m128i& m2)\n+{\n+    ShiftMessageC(m0, m1, m2);\n+    ShiftMessageA(m0, m1);\n+}\n+\n+void inline __attribute__((always_inline)) Shuffle(__m128i& s0, __m128i& s1)\n+{\n+    const __m128i t1 = _mm_shuffle_epi32(s0, 0xB1);\n+    const __m128i t2 = _mm_shuffle_epi32(s1, 0x1B);\n+    s0 = _mm_alignr_epi8(t1, t2, 0x08);\n+    s1 = _mm_blend_epi16(t2, t1, 0xF0);\n+}\n+\n+void inline __attribute__((always_inline)) Unshuffle(__m128i& s0, __m128i& s1)\n+{\n+    const __m128i t1 = _mm_shuffle_epi32(s0, 0x1B);\n+    const __m128i t2 = _mm_shuffle_epi32(s1, 0xB1);\n+    s0 = _mm_blend_epi16(t1, t2, 0xF0);\n+    s1 = _mm_alignr_epi8(t2, t1, 0x08);\n+}\n+\n+__m128i inline  __attribute__((always_inline)) Load(const unsigned char* in)\n+{\n+    return _mm_shuffle_epi8(_mm_loadu_si128((const __m128i*)in), MASK);\n+}\n+\n+void inline  __attribute__((always_inline)) Save(unsigned char* out, __m128i s)\n+{\n+    _mm_storeu_si128((__m128i*)out, _mm_shuffle_epi8(s, MASK));\n+}\n+}\n+\n+namespace sha256_shani {\n+void Transform(uint32_t* s, const unsigned char* chunk, size_t blocks)\n+{\n+    __m128i m0, m1, m2, m3, s0, s1, so0, so1;\n+\n+    /* Load state */\n+    s0 = _mm_loadu_si128((const __m128i*)s);\n+    s1 = _mm_loadu_si128((const __m128i*)(s + 4));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r193212576",
      "id" : 193212576,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MzIxMjU3Ng==",
      "original_commit_id" : "bb80ab25963f56cad9bb560e59c77d40f351901b",
      "original_position" : 91,
      "path" : "src/crypto/sha256_shani.cpp",
      "position" : 87,
      "pull_request_review_id" : 126141213,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386",
      "updated_at" : "2018-06-12T19:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/193212576",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r193217129"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/193217129"
         }
      },
      "author_association" : "MEMBER",
      "body" : "These are starting to get out of hand. I think we should take @TheBlueMatt's suggestion and treat LIBBITCOIN_CRYPTO as a collection of these helpers. That way we can just add ```$(LIBBITCOIN_CRYPTO)``` everywhere, and that will pull in the cpu-specific libs as well. Something like:\r\n```\r\n...\r\nLIBBITCOIN_CRYPTO=crypto/libbitcoin_crypto.a\r\nLIBBITCOIN_CRYPTO_AVX2=crypto/libbitcoin_crypto_avx2.a\r\nLIBBITCOIN_CRYPTO_SHANI=crypto/libbitcoin_crypto_shani.a\r\nLIBBITCOIN_CRYPTO+=$(LIBBITCOIN_CRYPTO_AVX2)\r\nLIBBITCOIN_CRYPTO+=$(LIBBITCOIN_CRYPTO_SHANI)\r\n...\r\n```\r\nThen the cpu-specific ones can be dropped from the LDADDs all over the place. I'm happy to do up a patch on top of this if you'd like.",
      "commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "created_at" : "2018-06-05T20:49:02Z",
      "diff_hunk" : "@@ -32,6 +32,7 @@ LIBBITCOIN_UTIL=libbitcoin_util.a\n LIBBITCOIN_CRYPTO=crypto/libbitcoin_crypto.a\n LIBBITCOIN_CRYPTO_SSE41=crypto/libbitcoin_crypto_sse41.a\n LIBBITCOIN_CRYPTO_AVX2=crypto/libbitcoin_crypto_avx2.a\n+LIBBITCOIN_CRYPTO_SHANI=crypto/libbitcoin_crypto_shani.a",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r193217129",
      "id" : 193217129,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MzIxNzEyOQ==",
      "original_commit_id" : "bb80ab25963f56cad9bb560e59c77d40f351901b",
      "original_position" : 4,
      "path" : "src/Makefile.am",
      "position" : null,
      "pull_request_review_id" : 126146873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386",
      "updated_at" : "2018-06-12T19:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/193217129",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "concept ACK.\r\n\r\nI noticed while testing #13400 that I added a bug, but bitcoind started up fine anyway, due to missing sanity checks for the double/4way/8way hashes. Mind adding those?",
      "created_at" : "2018-06-05T21:03:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-394859603",
      "id" : 394859603,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NDg1OTYwMw==",
      "updated_at" : "2018-06-05T21:03:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394859603",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r193263529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/193263529"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@theuni Actually, feel like PRing that as a separate PR, before this one goes in? Then @TheBlueMatt and I can both rebase ours on top of yours and not conflict with each other.",
      "commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "created_at" : "2018-06-06T00:43:35Z",
      "diff_hunk" : "@@ -32,6 +32,7 @@ LIBBITCOIN_UTIL=libbitcoin_util.a\n LIBBITCOIN_CRYPTO=crypto/libbitcoin_crypto.a\n LIBBITCOIN_CRYPTO_SSE41=crypto/libbitcoin_crypto_sse41.a\n LIBBITCOIN_CRYPTO_AVX2=crypto/libbitcoin_crypto_avx2.a\n+LIBBITCOIN_CRYPTO_SHANI=crypto/libbitcoin_crypto_shani.a",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r193263529",
      "id" : 193263529,
      "in_reply_to_id" : 193217129,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MzI2MzUyOQ==",
      "original_commit_id" : "bb80ab25963f56cad9bb560e59c77d40f351901b",
      "original_position" : 4,
      "path" : "src/Makefile.am",
      "position" : null,
      "pull_request_review_id" : 126201432,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386",
      "updated_at" : "2018-06-12T19:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/193263529",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r193621532"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/193621532"
         }
      },
      "author_association" : "NONE",
      "body" : "I believe including immintrin.h is enough for both platforms. x86intrin includes immintrin.h, and immintrin.h includes everything that is needed: https://github.com/gcc-mirror/gcc/blob/master/gcc/config/i386/immintrin.h\r\n\r\n**EDIT:** Tested on Linux GCC and Clang, including immintrin.h is enough for all platforms.",
      "commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "created_at" : "2018-06-07T04:12:06Z",
      "diff_hunk" : "@@ -0,0 +1,363 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+// Based on https://github.com/noloader/SHA-Intrinsics/blob/master/sha256-x86.c,\n+// Written and placed in public domain by Jeffrey Walton.\n+// Based on code from Intel, and by Sean Gulley for the miTLS project.\n+\n+#ifdef ENABLE_SHANI\n+\n+#include <stdint.h>\n+#if defined(_MSC_VER)\n+#include <immintrin.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r193621532",
      "id" : 193621532,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MzYyMTUzMg==",
      "original_commit_id" : "bb80ab25963f56cad9bb560e59c77d40f351901b",
      "original_position" : 13,
      "path" : "src/crypto/sha256_shani.cpp",
      "position" : null,
      "pull_request_review_id" : 126628239,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386",
      "updated_at" : "2018-06-12T19:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/193621532",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/23437045?v=4",
         "events_url" : "https://api.github.com/users/DesWurstes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DesWurstes/followers",
         "following_url" : "https://api.github.com/users/DesWurstes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DesWurstes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DesWurstes",
         "id" : 23437045,
         "login" : "DesWurstes",
         "node_id" : "MDQ6VXNlcjIzNDM3MDQ1",
         "organizations_url" : "https://api.github.com/users/DesWurstes/orgs",
         "received_events_url" : "https://api.github.com/users/DesWurstes/received_events",
         "repos_url" : "https://api.github.com/users/DesWurstes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DesWurstes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DesWurstes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DesWurstes"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased.",
      "created_at" : "2018-06-11T16:52:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-396310602",
      "id" : 396310602,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjMxMDYwMg==",
      "updated_at" : "2018-06-11T16:52:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396310602",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r194474911"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194474911"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, fixed.",
      "commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "created_at" : "2018-06-11T16:59:34Z",
      "diff_hunk" : "@@ -0,0 +1,363 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+// Based on https://github.com/noloader/SHA-Intrinsics/blob/master/sha256-x86.c,\n+// Written and placed in public domain by Jeffrey Walton.\n+// Based on code from Intel, and by Sean Gulley for the miTLS project.\n+\n+#ifdef ENABLE_SHANI\n+\n+#include <stdint.h>\n+#if defined(_MSC_VER)\n+#include <immintrin.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r194474911",
      "id" : 194474911,
      "in_reply_to_id" : 193621532,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NDQ3NDkxMQ==",
      "original_commit_id" : "bb80ab25963f56cad9bb560e59c77d40f351901b",
      "original_position" : 13,
      "path" : "src/crypto/sha256_shani.cpp",
      "position" : null,
      "pull_request_review_id" : 127654672,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386",
      "updated_at" : "2018-06-12T19:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/194474911",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2018-06-12T19:00:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-396698229",
      "id" : 396698229,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjY5ODIyOQ==",
      "updated_at" : "2018-06-12T19:00:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396698229",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased.",
      "created_at" : "2018-06-12T19:23:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-396704377",
      "id" : 396704377,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5NjcwNDM3Nw==",
      "updated_at" : "2018-06-12T19:23:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/396704377",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r195230580"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/195230580"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Linter is yelling about include style here.",
      "commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "created_at" : "2018-06-13T20:48:03Z",
      "diff_hunk" : "@@ -0,0 +1,359 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+// Based on https://github.com/noloader/SHA-Intrinsics/blob/master/sha256-x86.c,\n+// Written and placed in public domain by Jeffrey Walton.\n+// Based on code from Intel, and by Sean Gulley for the miTLS project.\n+\n+#ifdef ENABLE_SHANI\n+\n+#include <stdint.h>\n+#include <immintrin.h>\n+\n+#include \"crypto/common.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#discussion_r195230580",
      "id" : 195230580,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NTIzMDU4MA==",
      "original_commit_id" : "b318acd6ee0349aac6d990ba6836be094bcac946",
      "original_position" : 14,
      "path" : "src/crypto/sha256_shani.cpp",
      "position" : 14,
      "pull_request_review_id" : 128558107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13386",
      "updated_at" : "2018-06-13T20:48:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/195230580",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2018-06-24T14:19:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-399760046",
      "id" : 399760046,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5OTc2MDA0Ng==",
      "updated_at" : "2018-06-24T14:19:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399760046",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased after #13471 merge.\r\n\r\nAlso split up the CPU feature detection logic change into its own commit.\r\n\r\n> I noticed while testing #13400 that I added a bug, but bitcoind started up fine anyway, due to missing sanity checks for the double/4way/8way hashes. Mind adding those?\r\n\r\nThat was addressed in #13438.",
      "created_at" : "2018-06-24T17:56:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-399774881",
      "id" : 399774881,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5OTc3NDg4MQ==",
      "updated_at" : "2018-06-24T17:56:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399774881",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "~~~SelfTest() is now missing TransformD64_2way :(~~~\r\n\r\nutACK otherwise.",
      "created_at" : "2018-06-25T19:51:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-400073902",
      "id" : 400073902,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDA3MzkwMg==",
      "updated_at" : "2018-06-26T18:58:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400073902",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks! utACK 66b2cf1ccfad545a8ec3f2a854e23f647322bf30.",
      "created_at" : "2018-06-26T18:56:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-400425210",
      "id" : 400425210,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDQyNTIxMA==",
      "updated_at" : "2018-06-26T18:56:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400425210",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Not sure what compelled me to do this, and it's probably overkill... but...\r\n\r\nTested ACK 66b2cf1ccfad545a8ec3f2a854e23f647322bf30 with [100k rounds of quickcheck](https://github.com/jb55/sha256-quickcheck) at various optimization levels, but only with the non-two way transform for now. ",
      "created_at" : "2018-06-27T03:32:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-400532107",
      "id" : 400532107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDUzMjEwNw==",
      "updated_at" : "2018-06-27T03:32:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400532107",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just a nit from older pull requests: Now that it has a custom CPUID function\r\nhttps://github.com/bitcoin/bitcoin/blob/d96bdd78307bc5469cb8a4d5ca0e6cbc21fe4073/src/crypto/sha256.cpp#L534-L538\r\nincluding `<cpuid.h>` is not necessary now:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/d96bdd78307bc5469cb8a4d5ca0e6cbc21fe4073/src/crypto/sha256.cpp#L12-L16\r\n\r\nThank you for your awesome contributions!",
      "created_at" : "2018-06-27T11:54:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-400645360",
      "id" : 400645360,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDY0NTM2MA==",
      "updated_at" : "2018-06-27T11:54:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400645360",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/23437045?v=4",
         "events_url" : "https://api.github.com/users/DesWurstes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DesWurstes/followers",
         "following_url" : "https://api.github.com/users/DesWurstes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DesWurstes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DesWurstes",
         "id" : 23437045,
         "login" : "DesWurstes",
         "node_id" : "MDQ6VXNlcjIzNDM3MDQ1",
         "organizations_url" : "https://api.github.com/users/DesWurstes/orgs",
         "received_events_url" : "https://api.github.com/users/DesWurstes/received_events",
         "repos_url" : "https://api.github.com/users/DesWurstes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DesWurstes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DesWurstes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DesWurstes"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK",
      "created_at" : "2018-07-07T08:06:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-403197593",
      "id" : 403197593,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMzE5NzU5Mw==",
      "updated_at" : "2018-07-07T08:06:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/403197593",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 66b2cf1ccfad545a8ec3f2a854e23f647322bf30\r\ntested that build passes on FreeBSD+OpenBSD\r\n",
      "created_at" : "2018-07-09T19:10:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13386#issuecomment-403588506",
      "id" : 403588506,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13386",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMzU4ODUwNg==",
      "updated_at" : "2018-07-09T19:10:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/403588506",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
