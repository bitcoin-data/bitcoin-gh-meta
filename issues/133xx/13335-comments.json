[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't think it is a good idea to depends on programs. If it could depend on libraries, it would be better.",
      "created_at" : "2018-05-28T08:59:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13335#issuecomment-392465922",
      "id" : 392465922,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13335",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5MjQ2NTkyMg==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392465922/reactions"
      },
      "updated_at" : "2018-05-28T08:59:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392465922",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "node_id" : "MDQ6VXNlcjExMTU0MTE4",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\n> I don't think it is a good idea to depends on programs. If it could depend on libraries, it would be better.\r\n\r\nIn general I don't think that's bad advice. But, specifically, reading passphrases might be something that is preferable to do in a separate process address space, to minimize how much it sticks around.",
      "created_at" : "2018-05-28T13:15:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13335#issuecomment-392524261",
      "id" : 392524261,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13335",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5MjUyNDI2MQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392524261/reactions"
      },
      "updated_at" : "2018-05-28T13:17:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392524261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13335#discussion_r191519710"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13335"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/191519710"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Does it make sense to use SecureString type in some of these places?",
      "commit_id" : "06b238bb0cbca4156de07740ce6e144999886d22",
      "created_at" : "2018-05-29T18:03:32Z",
      "diff_hunk" : "@@ -0,0 +1,361 @@\n+// Copyright (c) 2009-2017 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <errno.h>\n+#include <getopt.h>\n+#include <sys/types.h>\n+#include <sys/wait.h>\n+#include <unistd.h>\n+\n+#include <cstdio>\n+#include <cstring>\n+#include <iostream>\n+#include <sstream>\n+\n+void xclose(int fd)\n+{\n+    if (close(fd) == -1) {\n+        std::ostringstream os;\n+        os << \"close(): \" << strerror(errno);\n+        throw std::runtime_error(os.str());\n+    }\n+}\n+\n+void xdup2(int oldfd, int newfd)\n+{\n+    if (dup2(oldfd, newfd) == -1) {\n+        std::ostringstream os;\n+        os << \"dup2(): \" << strerror(errno);\n+        throw std::runtime_error(os.str());\n+    }\n+}\n+\n+void xpipe(int pipefd[2])\n+{\n+    if (pipe(pipefd) == -1) {\n+        std::ostringstream os;\n+        os << \"pipe(): \" << strerror(errno);\n+        throw std::runtime_error(os.str());\n+    }\n+}\n+\n+pid_t xfork()\n+{\n+    pid_t pid = fork();\n+    if (pid == -1) {\n+        std::ostringstream os;\n+        os << \"fork(): \" << strerror(errno);\n+        throw std::runtime_error(os.str());\n+    }\n+    return pid;\n+}\n+\n+// Pinentry is a simple wrapper for pinentry, which communicates with its parent\n+// process using a simplified subset of the assuan protcol over stdin/stdout.\n+// The relevant aspects of the pinentry protocol are documented at\n+// http://info2html.sourceforge.net/cgi-bin/info2html-demo/info2html?%28pinentry%29Protocol\n+class Pinentry\n+{\n+public:\n+    Pinentry() = delete;\n+    Pinentry(const Pinentry& other) = delete;\n+    Pinentry(int read, int write)\n+        : read_(fdopen(read, \"r\")), write_(fdopen(write, \"w\")), line_(nullptr), line_sz_(0) {}\n+    ~Pinentry()\n+    {\n+        fclose(read_);\n+        fclose(write_);\n+        free(line_);\n+    }\n+\n+    void CheckOK()\n+    {\n+        ReadLine();\n+        if (strncmp(line_, \"OK\", 2) != 0) {\n+            throw std::runtime_error(\"pinentry protocol failure\");\n+        }\n+    }\n+\n+    std::string ReadData()\n+    {\n+        size_t sz = ReadLine();\n+        if (strncmp(line_, \"D \", 2) != 0) {\n+            throw std::runtime_error(\"pinentry protocol failure\");\n+        }\n+        return {&line_[2], sz - 3};\n+    }\n+\n+    void Command(const std::string& cmd)\n+    {\n+        fprintf(write_, \"%s\\n\", cmd.c_str());\n+        fflush(write_);\n+    }\n+\n+private:\n+    FILE* read_;\n+    FILE* write_;\n+    char* line_;\n+    size_t line_sz_;\n+\n+    ssize_t ReadLine()\n+    {\n+        ssize_t nread = getline(&line_, &line_sz_, read_);\n+        if (nread < 0) {\n+            throw std::runtime_error(\"failed to read data from pinentry\");\n+        }\n+        return nread;\n+    }\n+};\n+\n+// GetPinentryPassphrase invokes pinentry to get the wallet passphrase.\n+//\n+// If there were extra parameters not parsed by getopt_long() they will be\n+// forwarded to pinentry. Consider the following invocation:\n+//\n+//   bitcoin-wallet-unlock 300 -- -D :0\n+//\n+// This would cause pinentry to be invoked as:\n+//\n+//   pinentry -D :0\n+//\n+// Ordinarily this is not needed, but this can be useful in contexts where\n+// pinentry has to be explicitly told where to prompt for inputs (e.g. to force\n+// pinentry to use a TTY, or the opposite). In most cases they will need to be\n+// separated using -- as in the example above to prevent getopt_long() to\n+// interpret these arguments as program flags.\n+//\n+// These extra arguments are forwarded directly to execvp(), so there are no\n+// shell expansion or escaping issues to be aware of.\n+static std::string GetPinentryPassphrase(",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13335#discussion_r191519710",
      "id" : 191519710,
      "line" : 130,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5MTUxOTcxMA==",
      "original_commit_id" : "06b238bb0cbca4156de07740ce6e144999886d22",
      "original_line" : 130,
      "original_position" : 130,
      "original_start_line" : null,
      "path" : "src/bitcoin-wallet-unlock.cpp",
      "position" : 130,
      "pull_request_review_id" : 124107438,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13335",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/191519710/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2018-05-29T18:12:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/191519710",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It also occurred to me that maybe it would be more convenient for users if instead of providing a \"bitcoin-wallet-unlock\" tool that calls \"bitcoin-cli\", we provided a \"bitcoin-askpass\" tool that could get called by \"bitcoin-cli\" by default when a password wasn't provided.",
      "created_at" : "2018-05-29T18:22:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13335#issuecomment-392883826",
      "id" : 392883826,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13335",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5Mjg4MzgyNg==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392883826/reactions"
      },
      "updated_at" : "2018-05-29T18:22:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392883826",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It also occurred to me that maybe it would be more convenient for users if instead of providing a \"bitcoin-wallet-unlock\" tool that calls \"bitcoin-cli\", we provided a \"bitcoin-askpass\" tool that could get called by \"bitcoin-cli\" by default when a password wasn't provided.\r\n\r\nSomething like this sounds like a very good idea to me. I don't put `walletpassphrase` in my scripts and very often I forgot to run it manually and it's little bit annoying. :)\r\n\r\nProbably good idea would also be to ask for `walletpassphrase` and then automatically lock wallet again when the PID which called `bitcoin-cli`, which caused `walletpassphrase` prompt, has terminated.",
      "created_at" : "2018-05-29T21:16:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13335#issuecomment-392948153",
      "id" : 392948153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13335",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5Mjk0ODE1Mw==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392948153/reactions"
      },
      "updated_at" : "2018-05-29T21:16:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392948153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think providing users a way how to securely enter a passphrase on console level make sense.\r\nA couple of points/thoughts:\r\n\r\n* Unlocking the traditional, insecure way would still be possible, would it make sense to make users aware if they use an insecure way? Bitcoin-cli could integrate the pinentry process and use a `-insecure` option if one wants to use `walletpassphrase` with the insecure passphrase parameter. Using it on pure RPC level is another things (we don't want to handhold there).\r\n\r\n* Similar to the point above, I think it should be integrated into bitcoin-cli (not another executable, if, then combined with other wallet functions, see #8745)\r\n\r\n* If not integrated, could this be something that would be better in the contrib/ folder since there are other ways how to do this securely (see @ryanofsky comment)\r\n\r\n* Also, using external software for passphrase entry would move a critical part further away from our controlled stack (shell is not in our controlled stack, so not sure if this is an argument).\r\n\r\n* If this gets added to the main binaries, disable it by default (via configure.ac) for the first (or the first two) releases would probably make sense, since this is security critical and deserves more field test before defaulting to true.",
      "created_at" : "2018-05-30T08:34:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13335#issuecomment-393077641",
      "id" : 393077641,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13335",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5MzA3NzY0MQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/393077641/reactions"
      },
      "updated_at" : "2018-05-30T08:34:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/393077641",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No activity for 2 months and travis is failing, so I marked this up for grabs to be submitted in a new pull request.",
      "created_at" : "2018-07-29T15:05:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13335#issuecomment-408683899",
      "id" : 408683899,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13335",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwODY4Mzg5OQ==",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/408683899/reactions"
      },
      "updated_at" : "2018-07-29T15:05:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/408683899",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
